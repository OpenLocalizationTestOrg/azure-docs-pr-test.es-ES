### <a name="open-tcp-ports-in-the-windows-firewall-for-the-default-instance-of-the-database-engine"></a><span data-ttu-id="4eac0-101">Apertura de puertos TCP en el firewall de Windows para la instancia predeterminada del motor de base de datos</span><span class="sxs-lookup"><span data-stu-id="4eac0-101">Open TCP ports in the Windows firewall for the default instance of the Database Engine</span></span>
1. <span data-ttu-id="4eac0-102">Conéctese a la máquina virtual con Escritorio remoto.</span><span class="sxs-lookup"><span data-stu-id="4eac0-102">Connect to the virtual machine with Remote Desktop.</span></span> <span data-ttu-id="4eac0-103">Para obtener instrucciones detalladas acerca de cómo conectarse a la máquina virtual, consulte [Open a SQL VM with Remote Desktop](../articles/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision.md#open-the-vm-with-remote-desktop)(Apertura de una VM de SQL con Escritorio remoto).</span><span class="sxs-lookup"><span data-stu-id="4eac0-103">For detailed instructions on connecting to the VM, see [Open a SQL VM with Remote Desktop](../articles/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision.md#open-the-vm-with-remote-desktop).</span></span>
2. <span data-ttu-id="4eac0-104">Una vez que ha iniciado sesión, en la pantalla Inicio, escriba **WF.msc**y, a continuación, presione ENTRAR.</span><span class="sxs-lookup"><span data-stu-id="4eac0-104">Once logged in, at the Start screen, type **WF.msc**, and then hit ENTER.</span></span>
   
    ![Iniciar el programa de firewall](./media/virtual-machines-sql-server-connection-steps/12Open-WF.png)
3. <span data-ttu-id="4eac0-106">En **Firewall de Windows con seguridad avanzada**, en el panel de la izquierda, haga clic con el botón derecho en **Reglas de entrada** y, después, haga clic en **Nueva regla** en el panel de acciones.</span><span class="sxs-lookup"><span data-stu-id="4eac0-106">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule** in the action pane.</span></span>
   
    ![Nueva regla](./media/virtual-machines-sql-server-connection-steps/13New-FW-Rule.png)
4. <span data-ttu-id="4eac0-108">En el cuadro de diálogo **Asistente para nueva regla de entrada**, en **Tipo de regla**, seleccione **Puerto** y, a continuación, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-108">In the **New Inbound Rule Wizard** dialog box, under **Rule Type**, select **Port**, and then click **Next**.</span></span>
5. <span data-ttu-id="4eac0-109">En el cuadro de diálogo **Protocolo y puertos**, use el **TCP** predeterminado.</span><span class="sxs-lookup"><span data-stu-id="4eac0-109">In the **Protocol and Ports** dialog, use the default **TCP**.</span></span> <span data-ttu-id="4eac0-110">En el cuadro **Puertos locales específicos**, escriba el número de puerto de la instancia del motor de base de datos (**1433** para la instancia predeterminada que elija para el puerto privado en el paso del punto de conexión).</span><span class="sxs-lookup"><span data-stu-id="4eac0-110">In the **Specific local ports** box, then type the port number of the instance of the Database Engine (**1433** for the default instance or your choice for the private port in the endpoint step).</span></span>
   
    ![Puerto TCP 1433](./media/virtual-machines-sql-server-connection-steps/14Port-1433.png)
6. <span data-ttu-id="4eac0-112">Haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-112">Click **Next**.</span></span>
7. <span data-ttu-id="4eac0-113">En el cuadro de diálogo **Acción**, seleccione **Permitir la conexión** y haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-113">In the **Action** dialog box, select **Allow the connection**, and then click **Next**.</span></span>
   
    <span data-ttu-id="4eac0-114">**Nota de seguridad:** si selecciona **Permitir la conexión si es segura**, puede proporcionar una mayor seguridad.</span><span class="sxs-lookup"><span data-stu-id="4eac0-114">**Security Note:** Selecting **Allow the connection if it is secure** can provide additional security.</span></span> <span data-ttu-id="4eac0-115">Seleccione esta opción si desea configurar opciones de seguridad adicionales en el entorno.</span><span class="sxs-lookup"><span data-stu-id="4eac0-115">Select this option if you want to configure additional security options in your environment.</span></span>
   
    ![Permitir conexiones](./media/virtual-machines-sql-server-connection-steps/15Allow-Connection.png)
8. <span data-ttu-id="4eac0-117">En el cuadro de diálogo **Perfil**, seleccione **Público**, **Privado** y **Dominio**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-117">In the **Profile** dialog box, select **Public**, **Private**, and **Domain**.</span></span> <span data-ttu-id="4eac0-118">A continuación, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-118">Then click **Next**.</span></span>
   
    <span data-ttu-id="4eac0-119">**Nota de seguridad**: si se selecciona **Público**, se permite el acceso a través de Internet.</span><span class="sxs-lookup"><span data-stu-id="4eac0-119">**Security Note:**  Selecting **Public** allows access over the internet.</span></span> <span data-ttu-id="4eac0-120">Cuando sea posible, seleccione un perfil más restrictivo.</span><span class="sxs-lookup"><span data-stu-id="4eac0-120">Whenever possible, select a more restrictive profile.</span></span>
   
    ![Perfil público](./media/virtual-machines-sql-server-connection-steps/16Public-Private-Domain-Profile.png)
9. <span data-ttu-id="4eac0-122">En el cuadro de diálogo **Nombre**, escriba el nombre y la descripción de esta regla y haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-122">In the **Name** dialog box, type a name and description for this rule, and then click **Finish**.</span></span>
   
    ![Nombre de la regla](./media/virtual-machines-sql-server-connection-steps/17Rule-Name.png)

<span data-ttu-id="4eac0-124">Abra puertos adicionales para otros componentes cada vez que sea necesario.</span><span class="sxs-lookup"><span data-stu-id="4eac0-124">Open additional ports for other components as needed.</span></span> <span data-ttu-id="4eac0-125">Para obtener más información, consulte [Configurar Firewall de Windows para permitir el acceso a SQL Server](http://msdn.microsoft.com/library/cc646023.aspx).</span><span class="sxs-lookup"><span data-stu-id="4eac0-125">For more information, see [Configuring the Windows Firewall to Allow SQL Server Access](http://msdn.microsoft.com/library/cc646023.aspx).</span></span>

### <a name="configure-sql-server-to-listen-on-the-tcp-protocol"></a><span data-ttu-id="4eac0-126">Configuración de SQL Server para escuchar en el protocolo TCP</span><span class="sxs-lookup"><span data-stu-id="4eac0-126">Configure SQL Server to listen on the TCP protocol</span></span>

[!INCLUDE [Enable TCP](virtual-machines-sql-server-connection-tcp-protocol.md)]

### <a name="configure-sql-server-for-mixed-mode-authentication"></a><span data-ttu-id="4eac0-127">Configuración de SQL Server para autenticación de modo mixto</span><span class="sxs-lookup"><span data-stu-id="4eac0-127">Configure SQL Server for mixed mode authentication</span></span>
<span data-ttu-id="4eac0-128">El motor de base de datos de SQL Server no puede utilizar la autenticación de Windows sin un entorno de dominio.</span><span class="sxs-lookup"><span data-stu-id="4eac0-128">The SQL Server Database Engine cannot use Windows Authentication without domain environment.</span></span> <span data-ttu-id="4eac0-129">Para conectarse al motor de base de datos desde otro equipo, configure SQL Server para autenticación de modo mixto.</span><span class="sxs-lookup"><span data-stu-id="4eac0-129">To connect to the Database Engine from another computer, configure SQL Server for mixed mode authentication.</span></span> <span data-ttu-id="4eac0-130">La autenticación de modo mixto permite la autenticación de SQL Server y la autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="4eac0-130">Mixed mode authentication allows both SQL Server Authentication and Windows Authentication.</span></span>

> [!NOTE]
> <span data-ttu-id="4eac0-131">Si ha configurado una red virtual de Azure con un entorno de dominio configurado, es posible que no sea necesario configurar la autenticación de modo mixto.</span><span class="sxs-lookup"><span data-stu-id="4eac0-131">Configuring mixed mode authentication might not be necessary if you have configured an Azure Virtual Network with a configured domain environment.</span></span>
> 
> 

1. <span data-ttu-id="4eac0-132">Mientras está conectado a la máquina virtual, en la página de inicio, escriba **SQL Server Management Studio** y haga clic en el icono seleccionado.</span><span class="sxs-lookup"><span data-stu-id="4eac0-132">While connected to the virtual machine, on the Start page, type **SQL Server Management Studio** and click the selected icon.</span></span>
   
    <span data-ttu-id="4eac0-133">La primera vez que abra Management Studio se debe crear el entorno de Management Studio para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="4eac0-133">The first time you open Management Studio it must create the users Management Studio environment.</span></span> <span data-ttu-id="4eac0-134">Esta operación puede tardar unos minutos.</span><span class="sxs-lookup"><span data-stu-id="4eac0-134">This may take a few moments.</span></span>
2. <span data-ttu-id="4eac0-135">Management Studio presenta el cuadro de diálogo **Conectar con el servidor** .</span><span class="sxs-lookup"><span data-stu-id="4eac0-135">Management Studio presents the **Connect to Server** dialog box.</span></span> <span data-ttu-id="4eac0-136">En el cuadro **Nombre del servidor**, escriba el nombre de la máquina virtual para conectarse al motor de base de datos con el explorador de objetos [en lugar del nombre de la máquina virtual, se puede utilizar **(local)** o un punto (.) como **nombre del servidor**].</span><span class="sxs-lookup"><span data-stu-id="4eac0-136">In the **Server name** box, type the name of the virtual machine to connect to the Database Engine  with the Object Explorer (Instead of the virtual machine name you can also use **(local)** or a single period as the **Server name**).</span></span> <span data-ttu-id="4eac0-137">Seleccione **Autenticación de Windows** y deje ***nombre_de_su_MV*\su_administrador_local** en el cuadro **Nombre de usuario**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-137">Select **Windows Authentication**, and leave ***your_VM_name*\your_local_administrator** in the **User name** box.</span></span> <span data-ttu-id="4eac0-138">Haga clic en **Conectar**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-138">Click **Connect**.</span></span>
   
    ![Conectar con el servidor](./media/virtual-machines-sql-server-connection-steps/19Connect-to-Server.png)
3. <span data-ttu-id="4eac0-140">En el Explorador de objetos de SQL Server Management Studio, haga clic con el botón derecho en el nombre de la instancia de SQL Server (el nombre de la máquina virtual) y, a continuación, haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-140">In SQL Server Management Studio Object Explorer, right-click the name of the instance of SQL Server (the virtual machine name), and then click **Properties**.</span></span>
   
    ![Propiedades del servidor](./media/virtual-machines-sql-server-connection-steps/20Server-Properties.png)
4. <span data-ttu-id="4eac0-142">En la página **Seguridad**, en **Autenticación de servidor**, seleccione **Modo de autenticación de Windows y SQL Server** y, luego, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-142">On the **Security** page, under **Server authentication**, select **SQL Server and Windows Authentication mode**, and then click **OK**.</span></span>
   
    ![Seleccionar el modo de autenticación](./media/virtual-machines-sql-server-connection-steps/21Mixed-Mode.png)
5. <span data-ttu-id="4eac0-144">En el cuadro de diálogo de SQL Server Management Studio, haga clic en **Aceptar** para aceptar el requisito de reiniciar SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4eac0-144">In the SQL Server Management Studio dialog box, click **OK** to acknowledge the requirement to restart SQL Server.</span></span>
6. <span data-ttu-id="4eac0-145">En el Explorador de objetos, haga clic con el botón derecho en el servidor y, a continuación, haga clic en **Reiniciar**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-145">In Object Explorer, right-click your server, and then click **Restart**.</span></span> <span data-ttu-id="4eac0-146">(También se debe reiniciar Agente SQL Server si está en ejecución).</span><span class="sxs-lookup"><span data-stu-id="4eac0-146">(If SQL Server Agent is running, it must also be restarted.)</span></span>
   
    ![Reiniciar](./media/virtual-machines-sql-server-connection-steps/22Restart2.png)
7. <span data-ttu-id="4eac0-148">En el cuadro de diálogo de SQL Server Management Studio, haga clic en **Sí** para indicar que desea reiniciar SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4eac0-148">In the SQL Server Management Studio dialog box, click **Yes** to agree that you want to restart SQL Server.</span></span>

### <a name="create-sql-server-authentication-logins"></a><span data-ttu-id="4eac0-149">Creación de inicios de sesión para la autenticación de SQL Server</span><span class="sxs-lookup"><span data-stu-id="4eac0-149">Create SQL Server authentication logins</span></span>
<span data-ttu-id="4eac0-150">Para conectarse al motor de base de datos desde otro equipo, debe crear al menos un inicio de sesión para la autenticación de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4eac0-150">To connect to the Database Engine from another computer, you must create at least one SQL Server authentication login.</span></span>

1. <span data-ttu-id="4eac0-151">En el Explorador de objetos de SQL Server Management Studio, expanda la carpeta de la instancia de servidor en la que desea crear el nuevo inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="4eac0-151">In SQL Server Management Studio Object Explorer, expand the folder of the server instance in which you want to create the new login.</span></span>
2. <span data-ttu-id="4eac0-152">Haga clic con el botón derecho en la carpeta **Security**, apunte a **Nuevo** y seleccione **Inicio de sesión...**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-152">Right-click the **Security** folder, point to **New**, and select **Login...**.</span></span>
   
    ![Nuevo inicio de sesión](./media/virtual-machines-sql-server-connection-steps/23New-Login.png)
3. <span data-ttu-id="4eac0-154">En el cuadro de diálogo **Inicio de sesión - Nuevo**, en la página **General**, escriba el nombre del usuario nuevo en el cuadro **Nombre de inicio de sesión**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-154">In the **Login - New** dialog box, on the **General** page, enter the name of the new user in the **Login name** box.</span></span>
4. <span data-ttu-id="4eac0-155">Seleccione **Autenticación de SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-155">Select **SQL Server authentication**.</span></span>
5. <span data-ttu-id="4eac0-156">En el campo **Contraseña** , escriba una contraseña para el usuario nuevo.</span><span class="sxs-lookup"><span data-stu-id="4eac0-156">In the **Password** box, enter a password for the new user.</span></span> <span data-ttu-id="4eac0-157">Vuelva a escribir esa contraseña en el cuadro **Confirmar contraseña** .</span><span class="sxs-lookup"><span data-stu-id="4eac0-157">Enter that password again into the **Confirm Password** box.</span></span>
6. <span data-ttu-id="4eac0-158">Seleccione las opciones de cumplimiento de la contraseña requeridas (**Exigir directivas de contraseña**, **Exigir expiración de contraseña** y **El usuario debe cambiar la contraseña en el siguiente inicio de sesión**).</span><span class="sxs-lookup"><span data-stu-id="4eac0-158">Select the password enforcement options required (**Enforce password policy**, **Enforce password expiration**, and **User must change password at next login**).</span></span> <span data-ttu-id="4eac0-159">Si usa este inicio de sesión para usted mismo, no es necesario requerir un cambio de contraseña en el siguiente inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="4eac0-159">If you are using this login for yourself, you do not need to require a password change at the next login.</span></span>
7. <span data-ttu-id="4eac0-160">En la lista **Base de datos predeterminada** , seleccione una base de datos predeterminada para el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="4eac0-160">From the **Default database** list, select a default database for the login.</span></span> <span data-ttu-id="4eac0-161">**master** es el valor predeterminado para esta opción.</span><span class="sxs-lookup"><span data-stu-id="4eac0-161">**master** is the default for this option.</span></span> <span data-ttu-id="4eac0-162">Si todavía no ha creado una base de datos de usuario, deje este valor en **master**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-162">If you have not yet created a user database, leave this set to **master**.</span></span>
   
    ![Propiedades de inicio de sesión](./media/virtual-machines-sql-server-connection-steps/24Test-Login.png)
8. <span data-ttu-id="4eac0-164">Si este es el primer inicio de sesión que crea, es posible que desee designar este inicio de sesión como administrador de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4eac0-164">If this is the first login you are creating, you may want to designate this login as a SQL Server administrator.</span></span> <span data-ttu-id="4eac0-165">En ese caso, en la página **Roles de servidor**, active **sysadmin**.</span><span class="sxs-lookup"><span data-stu-id="4eac0-165">If so, on the **Server Roles** page, check **sysadmin**.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="4eac0-166">los miembros del rol del servidor fijo sysadmin tienen el control completo del motor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="4eac0-166">Members of the sysadmin fixed server role have complete control of the Database Engine.</span></span> <span data-ttu-id="4eac0-167">Deberá restringir cuidadosamente la suscripción en este rol.</span><span class="sxs-lookup"><span data-stu-id="4eac0-167">You should carefully restrict membership in this role.</span></span>
   > 
   > 
   
   ![sysadmin](./media/virtual-machines-sql-server-connection-steps/25sysadmin.png)
9. <span data-ttu-id="4eac0-169">Haga clic en Aceptar.</span><span class="sxs-lookup"><span data-stu-id="4eac0-169">Click OK.</span></span>

<span data-ttu-id="4eac0-170">Para ver más información acerca de los inicios de sesión de SQL Server, consulte [Crear un inicio de sesión](http://msdn.microsoft.com/library/aa337562.aspx).</span><span class="sxs-lookup"><span data-stu-id="4eac0-170">For more information about SQL Server logins, see [Create a Login](http://msdn.microsoft.com/library/aa337562.aspx).</span></span>

