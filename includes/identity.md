Administración de identidades es tan importante en la nube pública de hello sea de forma local. toohelp con esto, Azure admite varias tecnologías de identidad de nube diferente. Entre ellas se incluyen las siguientes:

* Puede ejecutar Windows Server Active Directory (generalmente conocido como simplemente AD) de la nube de hello mediante máquinas virtuales creadas con máquinas virtuales de Azure. Este enfoque tiene sentido cuando se usa Azure tooextend su centro de datos local en la nube de Hola.
* Puede utilizar toogive de Azure Active Directory a los usuarios solo inicio de sesión demasiado[Software como servicio (SaaS)](https://azure.microsoft.com/overview/what-is-saas/) aplicaciones. Por ejemplo, Microsoft Office 365 usa esta tecnología y las aplicaciones que se ejecutan en Azure u otras plataformas en la nube también pueden usarla.
* Aplicaciones que se ejecutan en hello en la nube o local puede usar Azure Active Directory Access Control toolet a los usuarios iniciar sesión mediante identidades de Facebook, Google, Microsoft y otros proveedores de identidad.

En este artículo se describen las tres opciones.

## <a name="table-of-contents"></a>Tabla de contenido
* [Ejecución de Windows Server Active Directory en máquinas virtuales](#adinvm)
* [Uso de Azure Active Directory](#ad)
* [Uso del control de acceso de Azure Active Directory](#ac)

## <a name="adinvm"></a>Ejecución de Windows Server Active Directory en máquinas virtuales
Ejecutar Windows Server AD en máquinas virtuales de Azure es muy parecido a hacerlo de manera local. [ilustración 1](#fig1) muestra un ejemplo típico de su apariencia.

![Azure Active Directory en máquina virtual](./media/identity/identity_01_ADinVM.png)

<a name="Fig1"></a>Figura 1: Puede ejecutar Windows Server Active Directory en el centro de datos de la organización de máquinas virtuales de Azure conectadas tooan local mediante red Virtual de Azure.

En el ejemplo de Hola que se muestra a continuación, Windows Server AD se ejecuta en máquinas virtuales creadas mediante máquinas virtuales de Azure, la tecnología de la plataforma de hello IaaS. Estas máquinas virtuales y otros se agrupan en un centro de datos local del tooan de red virtual conectado mediante la red Virtual de Azure. red virtual de Hello talla fuera de un grupo de máquinas virtuales de nube que interactúan con la red local de Hola a través de una conexión de red privada virtual (VPN). Hacer esta permite estas máquinas virtuales de Azure aspecto el centro de datos de otra subred toohello local. Como se muestra en la figura hello, dos de esas máquinas virtuales ejecutan controladores de dominio de Windows Server AD. Hello otras máquinas virtuales en la red virtual de hello podría ejecutar aplicaciones, como SharePoint, o que se usa de alguna otra manera, como para desarrollo y pruebas. Centro de datos de Hello local también está ejecutando dos controladores de dominio de Windows Server AD.

Hay varias opciones de conexión Hola para controladores de dominio en la nube de hello con los que se ejecutan de forma local:

* Hacer que todos formen parte de un dominio de Active Directory.
* Crear independiente AD dominios locales y en la nube de Hola que forman parte del programa Hola mismo bosque.
* Crear bosques de AD independientes en la nube de Hola y local y después conectar bosques Hola con confianzas entre bosques o Windows Server Active Directory Federation Services (AD FS), que también se puede ejecutar en máquinas virtuales en Azure.

Se realiza independientemente de la opción, un administrador debe asegurarse de que las solicitudes de autenticación de usuarios locales vayan toocloud controladores de dominio solo cuando sea necesario, puesto que en la nube Hola vínculo toohello es probable toobe más lenta que las redes locales. Otro tooconsider de factor de conexión en la nube y los controladores de dominio local es el tráfico de hello generado por la replicación. Controladores de dominio en la nube de hello suelen tener sus propios sitios de AD, lo que permite un tooschedule de administrador de la frecuencia con la replicación se realiza. Azure cobra por el tráfico enviado fuera de un centro de datos de Azure, aunque no se envían bytes de en, que podrían afectar a las opciones de replicación del Administrador de Hola. También cabe destacar que mientras Azure proporciona su propio soporte para el Sistema de nombres de dominio (DNS), al servicio le faltan las características necesarias para Active Directory (como soporte para registros de SRV y Dynamic DNS). Por este motivo, ejecuta Windows Server AD en Azure requiere la configuración de sus propios servidores DNS en la nube de Hola.

Ejecutar Windows Server AD en máquinas virtuales de Azure es recomendable en distintas situaciones determinadas. Estos son algunos ejemplos:

* Si usa máquinas virtuales de Azure como una extensión de su propio centro de datos, puede ejecutar aplicaciones en nube de Hola que necesita toohandle cosas de controladores de dominio local, como solicitudes de autenticación integrada de Windows o las consultas LDAP. Por ejemplo, SharePoint, interactúa con frecuencia con Active Directory y, por lo que aunque es posible toorun una granja de SharePoint en Azure con un directorio local, configurar controladores de dominio en la nube Hola mejorará significativamente el rendimiento. (Es importante toorealize que esto no es necesariamente requerida, sin embargo; una gran cantidad de aplicaciones puede ejecutar correctamente en la nube de hello con sólo los controladores de dominio local).
* Suponga que carece de una sucursal lejana Hola recursos toorun sus propios controladores de dominio. En la actualidad, los usuarios deben autenticarse toodomain controladores en hello otro lado de Hola a todos: inicios de sesión son lentos. Ejecuta Active Directory en Azure en un centro de datos más cerca de Microsoft puede acelerar esto sin necesidad de más servidores de sucursal de Hola.
* Una organización que utiliza Azure para la recuperación ante desastres puede mantener un pequeño conjunto de máquinas virtuales activas en la nube, hello, incluido un controlador de dominio. A continuación, puede ser preparados tooexpand este sitio como tootake necesario sobre errores en otra parte.

Existen también otras posibilidades. Por ejemplo, no es necesario tooconnect Windows Server AD en hello en la nube tooan centro de datos local. Si deseara toorun una granja de servidores de SharePoint que sirve un determinado conjunto de usuarios, por ejemplo, todos los cuales podrían iniciar una sesión solamente con identidades basadas en la nube, podría crear un bosque independiente en Azure. La forma en la que use esta tecnología depende de cuáles sean sus objetivos. (Para obtener información más detallada sobre cómo usar Windows Server AD con Azure, [consulte aquí](http://msdn.microsoft.com/library/windowsazure/jj156090.aspx)).

## <a name="ad"></a>Uso de Azure Active Directory
A medida que las aplicaciones SaaS se vuelven más frecuentes, se plantea una pregunta obvia: ¿qué tipo de servicio de directorio deben usar estas aplicaciones basadas en la nube? Pregunta de toothat de respuesta de Microsoft es Azure Active Directory.

Hay dos opciones principales para usar este servicio de directorio en la nube de hello:

* Las personas y las organizaciones que usan solo aplicaciones SaaS pueden confiar en Azure Active Directory como su único servicio de directorio.
* Las organizaciones que ejecutan Windows Server Active Directory pueden conectar su tooAzure de directorio local Active Directory y después usar toogive a los usuarios solo las aplicaciones de inicio de sesión tooSaaS.

[Figura 2](#fig2) muestra hello primera de estas dos opciones, en Azure Active Directory es todo lo que se necesita.

![Azure Active Directory en máquina virtual](./media/identity/identity_02_AD.png)

<a name="fig2"></a>Figura 2: Azure Active Directory ofrece a los usuarios de una organización aplicaciones de tooSaaS de inicio de sesión único, como Office 365.

Como se muestra en la figura hello, Azure AD es un servicio multiempresa. Esto significa que puede ofrecer asistencia simultáneamente a distintas organizaciones y almacenar la información de directorio sobre los usuarios en cada una de ellas. En este ejemplo, un usuario en la organización A consiste en intentar tooaccess una aplicación SaaS. Esta aplicación puede ser parte de Office 365, como SharePoint Online, o de otra solución; las aplicaciones que no son de Microsoft también pueden usar esta tecnología. Dado que Azure AD admite el protocolo de hello SAML 2.0, todo lo que ha requerido desde una aplicación Hola capacidad toointeract usa este estándar del sector. De hecho, las aplicaciones que usan Azure AD pueden ejecutarse en cualquier centro de datos, no solo en un centro de datos de Azure.

proceso de Hello comienza al usuario de hello tiene acceso a una aplicación de SaaS (paso 1). toouse esta aplicación, el usuario de hello debe presentar un token emitido por Azure AD.

Este token contiene información que identifica el usuario de Hola y está firmado digitalmente por Azure AD. símbolo (token) de hello tooget, Hola usuario autentica a sí mismo tooAzure AD proporcionando un nombre de usuario y una contraseña (paso 2). Azure AD, a continuación, devuelve el símbolo (token) de hello debe (paso 3).

Aplicación de SaaS toohello (paso 4), que valida la firma del token de Hola y usa su contenido (paso 5), a continuación, se envía a este token. Normalmente, aplicación hello usará información de identidad de hello token hello contiene toodecide qué usuario Hola de información puede tooaccess y quizás de otras maneras.

Si la aplicación hello necesita más información acerca del usuario de Hola que lo que se encuentra en el símbolo (token) de hello, puede solicitar esto directamente desde Azure AD utilizando la API de Azure AD Graph hello (paso 6). En la versión inicial de Hola de Azure AD, el esquema de directorio de hello es bastante sencillo: contiene solo usuarios y grupos y las relaciones entre ellas. Las aplicaciones pueden usar esta toolearn obtener información acerca de las conexiones entre los usuarios. Por ejemplo, suponga que una aplicación necesita tooknow que jefe de este usuario es toodecide si es fragmento de toosome permitirse el acceso de datos. Puede obtener consultando Azure AD a través de hello API Graph.

Hola API Graph usa un protocolo de RESTful normal, que resulta sencillo toouse desde la mayoría de los clientes, incluidos los dispositivos móviles. Hola API también admite las extensiones de hello definidas por OData, agregar elementos como un consulta lenguaje toolet los clientes acceder a los datos de las maneras más útiles. [Para más información acerca de OData, consulte [Introducing OData](http://download.microsoft.com/download/E/5/A/E5A59052-EE48-4D64-897B-5F7C608165B8/IntroducingOData.pdf)(Introducción a OData)]. Dado Hola API Graph puede ser utilizado toolearn acerca de las relaciones entre los usuarios, permite a las aplicaciones comprender gráfico sociales Hola que está incrustada en el esquema de hello Azure AD para una organización determinada (que es la razón por la que se denomina hello API Graph). Y tooauthenticate propio solicita tooAzure AD para API Graph, una aplicación usa OAuth 2.0.

Si una organización no usa Windows Server Active Directory, que no tiene servidores locales o dominios y se basa exclusivamente en las aplicaciones de nube que usan Azure AD, utilizando solo este directorio en la nube proporcionaría usuarios único inicio de sesión tooall la compañía de hello de ellos. A pesar de que este escenario es más común cada día, la mayor parte de las organizaciones siguen usando dominios locales creados con Windows Server Active Directory. Azure AD tiene una función útil tooplay aquí, como [figura 3](#fig3) muestra.

![Azure Active Directory en la máquina Virtual](./media/identity/identity_03_AD.png)
<a id="fig3"></a>figura 3: una organización puede federar Windows Server Active Directory con Azure Active Directory toogive sus aplicaciones de tooSaaS de inicio de sesión único de los usuarios.

En este escenario, un usuario en la organización B desea tooaccess una aplicación SaaS. Antes de que lo hace, los administradores de directorio de la organización de hello deben establecer una relación de federación con Azure AD mediante AD FS, como se muestra en la figura Hola. Los administradores también deben configurar la sincronización de datos entre local Windows Server la organización de hello AD y Azure AD. Esto copia automáticamente información de usuario y grupo del directorio tooAzure AD de hello local. Tenga en cuenta qué permite: en vigor, es la organización de hello ampliación de su directorio local en la nube de Hola. La combinación de Windows Server AD y Azure AD de esta manera, organización Hola ofrece un servicio de directorio que se pueden administrar como una entidad única, mientras se sigue teniendo una superficie tanto de forma local y en la nube de Hola.

toouse Azure AD, Hola usuario primero inicia sesión en el dominio de Active Directory local tooher como de costumbre (paso 1). Cuando intenta aplicación SaaS de hello tooaccess (paso 2), el proceso de federación de Hola se da en Azure AD le emite un token para esta aplicación (paso 3). [Para más información sobre cómo funciona la federación, consulte [Claims-Based Identity for Windows: Technologies and Scenarios](http://www.davidchappell.com/writing/white_papers/Claims-Based_Identity_for_Windows_v3.0--Chappell.docx) (Identidad basada en notificaciones para Windows: escenarios y tecnologías)]. Como antes, este token contiene información que identifica el usuario de Hola y está firmado digitalmente por Azure AD. Aplicación de SaaS toohello (paso 4), que valida la firma del token de Hola y usa su contenido (paso 5), a continuación, se envía a este token. Y se encuentra en el escenario anterior hello, Hola SaaS puede usar la aplicación hello toolearn de API Graph más información acerca de este usuario si es necesario (paso 6).

Actualmente, Azure AD no es una sustitución completa para Windows Server AD local. Como ya se ha mencionado, el directorio de nube de hello tiene un mucho más sencillo esquema, y también no tiene elementos como la directiva de grupo, información de toostore de capacidad de hello sobre máquinas y la compatibilidad con LDAP. (De hecho, una máquina de Windows no puede ser configurado toolet los usuarios iniciar sesión en tooit utilizando únicamente pero Azure AD, esto no es un escenario admitido.) En su lugar, objetivos inicial de Hola de Azure AD incluyen permitir que las aplicaciones de acceso de los usuarios empresariales en nube Hola sin mantener un inicio de sesión independiente y liberación local Administradores del directorio de sincronizar manualmente su directorio local con cada aplicación SaaS que utilice en su organización. Con el tiempo, sin embargo, hay que esperar este servicio de directorio en la nube tooaddress una gama más amplia de escenarios.

## <a name="ac"></a>Uso del control de acceso de Azure Active Directory
Tecnologías de identidad basado en la nube pueden ser usado toosolve una variedad de problemas. Azure Active Directory puede proporcionar a los usuarios de una organización aplicaciones de SaaS toomultiple de inicio de sesión único, por ejemplo. Pero también se pueden utilizar tecnologías de identidad en la nube de Hola de otras maneras.

Por ejemplo, suponga que una aplicación desea toolet sus usuarios inicie sesión con tokens emitidos por varios *proveedores de identidades (IdPs)*. Hoy en día existe un gran número de proveedores de identidad, como Facebook, Google, Microsoft y otros, y las aplicaciones permiten normalmente a los usuarios iniciar sesión con una de estas identidades. ¿Por qué debería una aplicación molestarse toomaintain su propia lista de usuarios y contraseñas cuando en su lugar puede depender de identidades que ya existen? Aceptar identidades existentes simplifica la vida tanto para los usuarios, que tienen una menor tooremember de nombre de usuario y contraseña y para las personas de Hola que crear sus propias listas de nombres de usuario y contraseñas de aplicación hello, que ya no necesitan toomaintain.

Sin embargo, si el proveedor de identidad emite algún tipo de token, estos no son estándar; cada IdP tiene su propio formato. Además, información de hello en esos tokens además no es estándar. Una aplicación que desea tooaccept los tokens emitidos por, diga, Facebook, Google y Microsoft se enfrentan reto hello de la escritura de código único toohandle cada uno de estos formatos diferentes.

¿Por qué hacer esto? ¿Por qué no crear un intermediario que pueda generar un formato de token único con una representación común de información de identidad? Este enfoque haría que vida más fácil para los programadores de Hola que crean las aplicaciones, ya que ahora deben toohandle solamente un tipo de símbolo (token). Azure Active Directory Access Control hace exactamente esto, proporciona a un intermediario en la nube de Hola para trabajar con diversos símbolos (tokens). [ilustración 4](#fig4) muestra su funcionamiento.

![Azure Active Directory en la máquina Virtual](./media/identity/identity_04_IdentityProviders.png)
<a id="fig4"></a>figura 4: Control de acceso de Azure Active Directory resulta más sencillo para aplicaciones tooaccept identidad tokens emitidos por distintos proveedores de identidades.

proceso de Hello comienza cuando un usuario intenta tooaccess aplicación de hello desde un explorador. aplicación Hello redirige su tooan IdP de su elección (y también confía en esa aplicación Hola). Autentica su propio toothis IdP, como, escriba un nombre de usuario y una contraseña (paso 1), y Hola IdP devuelve un símbolo (token) que contiene información sobre su (paso 2).

Como se muestra en la figura hello, Control de acceso admita una gama de diferentes IdPs basada en la nube, incluidas las cuentas creadas por Google, Yahoo, Facebook, Microsoft (anteriormente conocida como Windows Live ID) y los proveedores de OpenID. También es compatible con identidades creadas con Azure Active Directory y, a través de la federación con AD FS, con Windows Server Active Directory. objetivo de Hello es identidades de hello más frecuente de toocover en la actualidad, si está emitiendo IdPs en nube de Hola o de forma local.

Una vez que el explorador del usuario de hello tiene un token de IdP de su elección IdP, envía este token tooAccess Control (paso 3). Control de acceso valida el token de hello, asegurándose de que realmente fue emitido por este IdP, a continuación, se crea un nuevo token según las reglas de toohello que se han definido para esta aplicación. Como Azure Active Directory, Control de acceso es un servicio multiempresa, pero los inquilinos de hello son aplicaciones en lugar de organizaciones de clientes. Cada aplicación puede obtener su propio espacio de nombres, como se muestra en la figura hello y puede definir varias reglas sobre autorización y mucho más.

Estas reglas permiten a cada administrador de la aplicación definir cómo deben transformarse los tokens de varios IdP en un token de control de acceso. Por ejemplo, si IdP distintos utilizan tipos diferentes para la representación de nombres de usuario, las reglas del control de acceso pueden transformar todo esto en un tipo de nombre de usuario común. Control de acceso, a continuación, envía este nuevo explorador de token toohello atrás (paso 4), que lo envía la aplicación toohello (paso 5). Cuando tenga el token de Control de acceso de hello, aplicación hello comprueba que este token realmente fue emitido por el Control de acceso, a continuación, usa la información de hello contiene (paso 6).

Aunque este proceso puede parecer un poco complicado, realmente simplifica la vida significativamente para creador de Hola de aplicación hello. En lugar de controlar los distintos tokens que contiene información diferente, aplicación hello puede aceptar identidades emitidas por varios proveedores de identidad mientras se sigue recibiendo solo un token único con información familiar. También, en lugar de requieren que cada toobe de aplicación configurado tootrust IdPs distintos, estas relaciones de confianza en su lugar, se mantienen el Control de acceso y una aplicación solo necesita confiar en él.

Es necesario aclarar que nada sobre el Control de acceso está ligada tooWindows, tan bien se podía usar una aplicación de Linux que acepta sólo las identidades de Google y Facebook. Y, aunque el Control de acceso es parte del programa Hola familia de Azure Active Directory, se puede considerar como un servicio completamente distinto de lo que se describe en la sección anterior de Hola. Aunque ambas tecnologías funcionan con la identidad, abordan problemas muy diferentes (aunque Microsoft se dice que espera toointegrate Hola dos en algún momento).

Trabajar con identidades es importante en prácticamente cualquier aplicación. objetivo de Hola de Control de acceso es toomake resulta más sencillo para las aplicaciones de toocreate de los desarrolladores que aceptan las identidades de los proveedores de identidades diferentes. Al colocar este servicio en nube de hello, Microsoft ha convertido en aplicación tooany disponible que se ejecuta en cualquier plataforma.

## <a name="about-hello-author"></a>Acerca de hello autor
David Chappell es el director de Chappell & Associates [www.davidchappell.com](http://www.davidchappell.com) en San Francisco (California).

