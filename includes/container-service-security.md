# <a name="securing-docker-containers-in-azure-container-service"></a><span data-ttu-id="d1263-101">Protección de contenedores de Docker en Azure Container Service</span><span class="sxs-lookup"><span data-stu-id="d1263-101">Securing Docker containers in Azure Container Service</span></span>

<span data-ttu-id="d1263-102">Este artículo presenta consideraciones y recomendaciones para proteger los contenedores de Docker implementados en Azure Container Service.</span><span class="sxs-lookup"><span data-stu-id="d1263-102">This article introduces considerations and recommendations for securing Docker containers deployed in Azure Container Service.</span></span> <span data-ttu-id="d1263-103">Muchas de estas consideraciones aplican generalmente contenedores tooDocker implementados en Azure o en otros entornos.</span><span class="sxs-lookup"><span data-stu-id="d1263-103">Many of these considerations apply generally tooDocker containers deployed in Azure or other environments.</span></span> 

## <a name="image-security"></a><span data-ttu-id="d1263-104">Seguridad de imágenes</span><span class="sxs-lookup"><span data-stu-id="d1263-104">Image security</span></span>

<span data-ttu-id="d1263-105">Los contenedores se crean a partir de imágenes que están almacenadas en uno o varios repositorios.</span><span class="sxs-lookup"><span data-stu-id="d1263-105">Containers are built from images that are stored in one or more repositories.</span></span> <span data-ttu-id="d1263-106">Estos repositorios pueden pertenecer toopublic o registros de contenedor privado.</span><span class="sxs-lookup"><span data-stu-id="d1263-106">These repositories can belong toopublic or private container registries.</span></span> <span data-ttu-id="d1263-107">Un ejemplo de un registro público es [Docker Hub](https://hub.docker.com/).</span><span class="sxs-lookup"><span data-stu-id="d1263-107">An example of a public registry is [Docker Hub](https://hub.docker.com/).</span></span> <span data-ttu-id="d1263-108">Un ejemplo de un registro privado es hello [registro de confianza de Docker](https://docs.docker.com/datacenter/dtr/2.0/), lo que puede ser instalado de forma local o en una nube privada virtual.</span><span class="sxs-lookup"><span data-stu-id="d1263-108">An example of a private registry is hello [Docker Trusted Registry](https://docs.docker.com/datacenter/dtr/2.0/), which can be installed on-premises or in a virtual private cloud.</span></span> <span data-ttu-id="d1263-109">También hay servicios de registro privado de contenedores basados en la nube, incluido [Azure Container Registry](../articles/container-registry/container-registry-intro.md).</span><span class="sxs-lookup"><span data-stu-id="d1263-109">There are also cloud-based private container registry services including [Azure Container Registry](../articles/container-registry/container-registry-intro.md).</span></span>

### <a name="public-and-private-images"></a><span data-ttu-id="d1263-110">Imágenes públicas y privadas</span><span class="sxs-lookup"><span data-stu-id="d1263-110">Public and private images</span></span>
<span data-ttu-id="d1263-111">En general, al igual que con cualquier paquete de software publicado de forma pública, una imagen de contenedor disponible públicamente no garantiza la seguridad.</span><span class="sxs-lookup"><span data-stu-id="d1263-111">In general, as with any publicly published software package, a publicly available container image does not guarantee security.</span></span> <span data-ttu-id="d1263-112">Las imágenes de contenedor constan de varias capas de software, y cada capa de software podría tener vulnerabilidades.</span><span class="sxs-lookup"><span data-stu-id="d1263-112">Container images consist of multiple software layers, and each software layer could have vulnerabilities.</span></span> <span data-ttu-id="d1263-113">Sea toounderstand clave Hola origen de imagen del contenedor hello, incluyendo Hola propietario de imagen de hello (toodetermine si es un origen de confianza o no), Hola capas de software consta de y Hola versiones de software.</span><span class="sxs-lookup"><span data-stu-id="d1263-113">It is key toounderstand hello origin of hello container image, including hello owner of hello image (toodetermine if it is a reliable source or not), hello software layers it consists of, and hello software versions.</span></span> 

<span data-ttu-id="d1263-114">Por ejemplo, si va toohello oficial [nginx repositorio](https://hub.docker.com/_/nginx/) en Docker Hub y navegue toohello **etiquetas** pestaña, vea vulnerabilidades codificado por colores en cada imagen.</span><span class="sxs-lookup"><span data-stu-id="d1263-114">For example, if you go toohello official [nginx repository](https://hub.docker.com/_/nginx/) in Docker Hub and navigate toohello **Tags** tab, you see color-coded vulnerabilities in each image.</span></span> <span data-ttu-id="d1263-115">Cada color representa una vulnerabilidad de Hola de una capa de software de imagen de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-115">Each color depicts hello vulnerability of a software layer of hello image.</span></span> <span data-ttu-id="d1263-116">Para más información sobre el examen de vulnerabilidades en el Centro de Docker, consulte [Descripción de los repositorios oficiales en el Centro de Docker](https://blog.docker.com/2015/06/understanding-official-repos-docker-hub/).</span><span class="sxs-lookup"><span data-stu-id="d1263-116">For more about vulnerability scanning in Docker Hub, see [Understanding official repos on Docker Hub](https://blog.docker.com/2015/06/understanding-official-repos-docker-hub/).</span></span>

![Imágenes nginx en el Centro de Docker](./media/container-service-security/docker-hub-nginx.png)

<span data-ttu-id="d1263-118">Las empresas se encarga profundamente sobre seguridad y tooprotect por sí mismos contra los ataques de seguridad deben almacenar y recuperar imágenes desde un registro privado, como registro de contenedor de Azure o el registro de confianza de Docker.</span><span class="sxs-lookup"><span data-stu-id="d1263-118">Enterprises care deeply about security, and tooprotect themselves from security attack should store and retrieve images from a private registry, such as Azure Container Registry or Docker Trusted Registry.</span></span> <span data-ttu-id="d1263-119">En suma tooproviding un registro privado administrado, registro de contenedor de Azure es compatible con [autenticación basada en la entidad de seguridad del servicio](../articles/container-registry/container-registry-authentication.md) a través de Azure Active Directory para los flujos de autenticación básica, incluido el acceso basado en roles para de solo lectura, escritura y permisos de propietario.</span><span class="sxs-lookup"><span data-stu-id="d1263-119">In addition tooproviding a managed private registry, Azure Container Registry supports [service principal-based authentication](../articles/container-registry/container-registry-authentication.md) through Azure Active Directory for basic authentication flows, including role-based access for read-only, write, and owner permissions.</span></span>

### <a name="image-security-scanning"></a><span data-ttu-id="d1263-120">Examen de seguridad de imágenes</span><span class="sxs-lookup"><span data-stu-id="d1263-120">Image security scanning</span></span>

<span data-ttu-id="d1263-121">Incluso cuando se usa un registro privado, es una imagen de toouse buena idea análisis soluciones para la validación de seguridad adicional.</span><span class="sxs-lookup"><span data-stu-id="d1263-121">Even when using a private registry, it is a good idea toouse image scanning solutions for additional security validation.</span></span> <span data-ttu-id="d1263-122">Cada capa de software en una imagen de contenedor es potencialmente propenso toovulnerabilities independiente de otras capas de imagen de contenedor de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-122">Each software layer in a container image is potentially prone toovulnerabilities independent of other layers in hello container image.</span></span> <span data-ttu-id="d1263-123">Como cada vez más empresas empezar a implementar sus cargas de trabajo de producción que se basa en tecnologías de contenedor, digitalización de imágenes se convierte en tooensure importante prevención de amenazas de seguridad en sus organizaciones.</span><span class="sxs-lookup"><span data-stu-id="d1263-123">As increasingly companies start deploying their production workloads based on container technologies, image scanning becomes important tooensure prevention of security threats against their organizations.</span></span> 

<span data-ttu-id="d1263-124">Supervisión y análisis como soluciones de seguridad [Twistlock](https://www.twistlock.com/2016/11/07/twistlock-supports-azure-container-registry) y [aguamarina seguridad](http://blog.aquasec.com/image-vulnerability-scanning-in-azure-container-registry), entre otros, pueden tooscan usa imágenes de contenedor en un registro privada e identificar posibles vulnerabilidades.</span><span class="sxs-lookup"><span data-stu-id="d1263-124">Security monitoring and scanning solutions such as [Twistlock](https://www.twistlock.com/2016/11/07/twistlock-supports-azure-container-registry) and [Aqua Security](http://blog.aquasec.com/image-vulnerability-scanning-in-azure-container-registry), among others, can be used tooscan container images in a private registry and identify potential vulnerabilities.</span></span> <span data-ttu-id="d1263-125">Es importante proporcionar profundidad de hello toounderstand de recorrido que Hola diferentes soluciones.</span><span class="sxs-lookup"><span data-stu-id="d1263-125">It is important toounderstand hello depth of scanning that hello different solutions provide.</span></span> <span data-ttu-id="d1263-126">Por ejemplo, algunas soluciones podrían verificar las capas de imagen en comparación con vulnerabilidades conocidas.</span><span class="sxs-lookup"><span data-stu-id="d1263-126">For example, some solutions might only cross-verify image layers against known vulnerabilities.</span></span> <span data-ttu-id="d1263-127">Estas soluciones no sea capaz de tooverify software de capa de imagen creado a partir de determinado software de administrador de paquetes.</span><span class="sxs-lookup"><span data-stu-id="d1263-127">These solutions might not be able tooverify image-layer software built through certain package manager software.</span></span> <span data-ttu-id="d1263-128">Otras soluciones tienen una integración del análisis más profunda y pueden encontrar vulnerabilidades en cualquier software empaquetado.</span><span class="sxs-lookup"><span data-stu-id="d1263-128">Other solutions have deeper scanning integration and can find vulnerabilities in any packaged software.</span></span>

### <a name="production-deployment-rules-and-audit"></a><span data-ttu-id="d1263-129">Auditoría y reglas de implementación de producción</span><span class="sxs-lookup"><span data-stu-id="d1263-129">Production deployment rules and audit</span></span>
<span data-ttu-id="d1263-130">Una vez que una aplicación se implementa en producción, es esencial tooset tooensure algunas de las reglas que las imágenes que se usan en entornos de producción son seguras y no contener ninguna vulnerabilidad.</span><span class="sxs-lookup"><span data-stu-id="d1263-130">Once an application is deployed in production, it is essential tooset a few rules tooensure that images used in production environments are secure and contain no vulnerabilities.</span></span>

* <span data-ttu-id="d1263-131">Como norma, imágenes con vulnerabilidades, incluso los pequeños, no deberían estar permitidas toorun en un entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="d1263-131">As a rule, images with vulnerabilities, even minor, should not be allowed toorun in a production environment.</span></span> <span data-ttu-id="d1263-132">Además, todas las imágenes implementadas en producción lo ideal es que se deben guardar en una instrucción select tooa accesible de registro privada solo algunos.</span><span class="sxs-lookup"><span data-stu-id="d1263-132">In addition, all images deployed in production should ideally be saved in a private registry accessible tooa select few.</span></span> <span data-ttu-id="d1263-133">También es importante tookeep número de Hola de producción imágenes pequeñas tooensure que puedan administrarse eficazmente.</span><span class="sxs-lookup"><span data-stu-id="d1263-133">It is also important tookeep hello number of production images small tooensure that they can be managed effectively.</span></span>

* <span data-ttu-id="d1263-134">Puesto que es el origen de hello toopinpoint de disco duro de software desde una imagen de contenedor disponible públicamente, es una imagen de toobuild buenas prácticas a partir de datos de origen tooensure de origen de Hola de capa de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-134">Since it is hard toopinpoint hello origin of software from a publicly available container image, it is a good practice toobuild images from source tooensure knowledge of hello origin of hello layer.</span></span> <span data-ttu-id="d1263-135">Cuando superficies de una vulnerabilidad en una imagen de contenedor generada automáticamente, los clientes pueden encontrar una resolución más rápida de tooa de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="d1263-135">When a vulnerability surfaces in a self-built container image, customers can find a quicker path tooa resolution.</span></span> <span data-ttu-id="d1263-136">Con una imagen pública, los clientes tienen raíz hello toofind un toofix imágenes públicas, u obtener otra imagen segura del publicador de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-136">With a public image, customers would need toofind hello root of a public image toofix it or obtain another secure image from hello publisher.</span></span>

* <span data-ttu-id="d1263-137">Una imagen digitalizada exhaustivamente implementada en producción no está garantizada toobe seguridad toodate dure Hola de aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="d1263-137">A thoroughly scanned image deployed in production is not guaranteed toobe up toodate for hello lifetime of hello application.</span></span> <span data-ttu-id="d1263-138">Se puede notificar las vulnerabilidades de seguridad para las capas de imagen de Hola que no se conocían anteriormente o se introdujeron después de la implementación de producción de hello.</span><span class="sxs-lookup"><span data-stu-id="d1263-138">Security vulnerabilities might be reported for layers of hello image that were not previously known or were introduced after hello production deployment.</span></span> <span data-ttu-id="d1263-139">La auditoría periódica de imágenes implementadas en producción es necesario tooidentify imágenes que no están actualizados o no se han actualizado en unos instantes.</span><span class="sxs-lookup"><span data-stu-id="d1263-139">Periodic auditing of images deployed in production is necessary tooidentify images that are out of date or have not been updated in a while.</span></span> <span data-ttu-id="d1263-140">Uno puede usar metodologías de implementación de verde azulado y distribuir imágenes de contenedor de mecanismos de actualización tooupdate sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="d1263-140">One might use blue-green deployment methodologies and rolling upgrade mechanisms tooupdate container images without downtime.</span></span> <span data-ttu-id="d1263-141">Digitalización de imágenes puede realizarse con herramientas que se describen en la sección anterior de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-141">Image scanning can be done with tools described in hello preceding section.</span></span> 

* <span data-ttu-id="d1263-142">Una canalización de integración continua (CI) toobuild imágenes y el examen de la seguridad integrada pueden ayudar a mantener seguros registros privados con imágenes de contenedor seguro.</span><span class="sxs-lookup"><span data-stu-id="d1263-142">A continuous integration (CI) pipeline toobuild images and integrated security scanning can help maintain secure private registries with secure container images.</span></span> <span data-ttu-id="d1263-143">Hello examen de las vulnerabilidades integrado en la solución de integración continua de hello garantiza que las imágenes que superan todas las pruebas de Hola se insertan toohello privada registro de producción en donde se implementan las cargas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d1263-143">hello vulnerability scanning built into hello CI solution ensures that images that pass all hello tests are pushed toohello private registry from which production workloads are deployed.</span></span> <span data-ttu-id="d1263-144">Un error de canalización de CI garantiza que no se incluyen imágenes vulnerables en registro privada Hola usadas para las implementaciones de carga de trabajo de producción.</span><span class="sxs-lookup"><span data-stu-id="d1263-144">A CI pipeline failure ensures that vulnerable images are not pushed into hello private registry used for production workload deployments.</span></span> <span data-ttu-id="d1263-145">También automatiza el examen de seguridad de imágenes si hay un número significativo de imágenes.</span><span class="sxs-lookup"><span data-stu-id="d1263-145">It also automates image security scanning if there are a significant number of images.</span></span> <span data-ttu-id="d1263-146">De lo contrario, auditar las imágenes manualmente para buscar vulnerabilidades de seguridad puede ser bastante lento y estar propenso a errores.</span><span class="sxs-lookup"><span data-stu-id="d1263-146">Otherwise, manually auditing images for security vulnerabilities can be painstakingly lengthy and error prone.</span></span>

## <a name="host-level-container-isolation"></a><span data-ttu-id="d1263-147">Aislamiento de contenedor a nivel de host</span><span class="sxs-lookup"><span data-stu-id="d1263-147">Host-level container isolation</span></span>
<span data-ttu-id="d1263-148">Cuando un cliente implementa aplicaciones de contenedor en recursos de Azure, se implementan en un nivel de suscripción en grupos de recursos y no son tienen varios inquilinos.</span><span class="sxs-lookup"><span data-stu-id="d1263-148">When a customer deploys container applications on Azure resources, they are deployed at a subscription level in resource groups and are not multi-tenant.</span></span> <span data-ttu-id="d1263-149">Esto significa que si un cliente comparte una suscripción con otros usuarios, no hay ningún límite que puede crearse entre dos implementaciones en hello misma suscripción.</span><span class="sxs-lookup"><span data-stu-id="d1263-149">This means that if a customer shares a subscription with others, there are no boundaries that can be built between two deployments in hello same subscription.</span></span> <span data-ttu-id="d1263-150">Por lo tanto, no se garantiza la seguridad a nivel de contenedor.</span><span class="sxs-lookup"><span data-stu-id="d1263-150">Therefore, container-level security is not guaranteed.</span></span> 

<span data-ttu-id="d1263-151">También resulta crítico toounderstand que contenedores compartan kernel hello y recursos de Hola de host de hello (que en el servicio de contenedor de Azure es una VM de Azure en un clúster).</span><span class="sxs-lookup"><span data-stu-id="d1263-151">It is also critical toounderstand that containers share hello kernel and hello resources of hello host (which in Azure Container Service is an Azure VM in a cluster).</span></span> <span data-ttu-id="d1263-152">Por lo tanto, los contenedores que se ejecutan en producción se deben ejecutar en modo de usuario sin privilegios.</span><span class="sxs-lookup"><span data-stu-id="d1263-152">Therefore, containers running in production must be run in non-privileged user mode.</span></span> <span data-ttu-id="d1263-153">Ejecución de un contenedor con privilegios de raíz puede poner en peligro todo el entorno de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-153">Running a container with root privileges can compromise hello entire environment.</span></span> <span data-ttu-id="d1263-154">Con acceso de nivel de raíz en un contenedor, un pirata informático puede tener acceso toohello privilegios de raíz completa en el host de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-154">With root-level access in a container, a hacker can gain access toohello full root privileges on hello host.</span></span> <span data-ttu-id="d1263-155">Además, es importante toorun contenedores con sistemas de archivos de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="d1263-155">In addition, it is important toorun containers with read-only file systems.</span></span> <span data-ttu-id="d1263-156">Esto evita que alguien que tenga acceso toohello en peligro contenedor toowrite scripts malintencionados toohello sistema de archivos y obtener acceso a archivos tooother.</span><span class="sxs-lookup"><span data-stu-id="d1263-156">This prevents someone who has access toohello compromised container toowrite malicious scripts toohello file system and gain access tooother files.</span></span> <span data-ttu-id="d1263-157">De igual forma, es importante toolimit Hola los recursos (por ejemplo, memoria, CPU y ancho de banda de red) asignados tooa contenedor.</span><span class="sxs-lookup"><span data-stu-id="d1263-157">Similarly, it is important toolimit hello resources (such as memory, CPU, and network bandwidth) allocated tooa container.</span></span> <span data-ttu-id="d1263-158">Esto ayuda a impedir que piratas informáticos de estar sobrecargando los recursos y que ejerzan actividades ilegales como fraude con tarjetas de crédito o de minería de datos de bitcoin, lo que podría impedir que se ejecuten en clúster o host Hola otros contenedores.</span><span class="sxs-lookup"><span data-stu-id="d1263-158">This helps prevent hackers from hogging resources and pursuing illegal activities such as credit card fraud or bitcoin mining, which could prevent other containers from running on hello host or cluster.</span></span>

## <a name="orchestrator-considerations"></a><span data-ttu-id="d1263-159">Consideraciones sobre el orquestador</span><span class="sxs-lookup"><span data-stu-id="d1263-159">Orchestrator considerations</span></span>

<span data-ttu-id="d1263-160">Cada orquestador disponible en Azure Container Service tiene sus propias consideraciones de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d1263-160">Each orchestrator available in Azure Container Service has its own security considerations.</span></span> <span data-ttu-id="d1263-161">Por ejemplo, debe limitar los nodos de tooorchestrator de acceso de directo SSH en el servicio de contenedor.</span><span class="sxs-lookup"><span data-stu-id="d1263-161">For example, you should limit direct SSH access tooorchestrator nodes in Container Service.</span></span> <span data-ttu-id="d1263-162">En su lugar, debe usar la interfaz de usuario o herramientas de línea de comandos de cada orchestrator (como `kubectl` para Kubernetes) toomanage el entorno del contenedor de hello sin tener acceso a hosts de Hola.</span><span class="sxs-lookup"><span data-stu-id="d1263-162">Instead, you should use each orchestrator's UI or command-line tools (such as `kubectl` for Kubernetes) toomanage hello container environment without accessing hello hosts.</span></span> <span data-ttu-id="d1263-163">Para obtener más información, consulte [realizar una conexión remota tooa Kubernetes, DC/OS, Docker Swarm clúster o](../articles/container-service/kubernetes/container-service-connect.md).</span><span class="sxs-lookup"><span data-stu-id="d1263-163">For more information, see [Make a remote connection tooa Kubernetes, DC/OS, or Docker Swarm cluster](../articles/container-service/kubernetes/container-service-connect.md).</span></span>

<span data-ttu-id="d1263-164">Para obtener información de seguridad específicos de orchestrator adicional, vea Hola recursos siguientes:</span><span class="sxs-lookup"><span data-stu-id="d1263-164">For additional orchestrator-specific security information, see hello following resources:</span></span>

* <span data-ttu-id="d1263-165">**Kubernetes**: [prácticas recomendadas de seguridad para la implementación de Kubernetes](http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html)</span><span class="sxs-lookup"><span data-stu-id="d1263-165">**Kubernetes**: [Security Best Practices for Kubernetes Deployment](http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html)</span></span>

* <span data-ttu-id="d1263-166">**DC/OS**: [cómo asegurar su clúster](https://dcos.io/docs/1.8/administration/securing-your-cluster/)</span><span class="sxs-lookup"><span data-stu-id="d1263-166">**DC/OS**: [Securing Your Cluster](https://dcos.io/docs/1.8/administration/securing-your-cluster/)</span></span>

* <span data-ttu-id="d1263-167">**Docker Swarm**: [seguridad de Docker](https://www.docker.com/docker-security)</span><span class="sxs-lookup"><span data-stu-id="d1263-167">**Docker Swarm**: [Docker Security](https://www.docker.com/docker-security)</span></span>

## <a name="next-steps"></a><span data-ttu-id="d1263-168">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="d1263-168">Next steps</span></span>

* <span data-ttu-id="d1263-169">Para obtener más información acerca de la seguridad de arquitectura y el contenedor de Docker, consulte [Introducción tooContainer seguridad](https://www.docker.com/sites/default/files/WP_IntrotoContainerSecurity_08.19.2016.pdf).</span><span class="sxs-lookup"><span data-stu-id="d1263-169">For more about Docker architecture and container security, see [Introduction tooContainer Security](https://www.docker.com/sites/default/files/WP_IntrotoContainerSecurity_08.19.2016.pdf).</span></span>

* <span data-ttu-id="d1263-170">Para obtener información acerca de la seguridad de la plataforma Windows Azure, vea hello [Azure Security Center](https://www.microsoft.com/en-us/trustcenter/cloudservices/azure).</span><span class="sxs-lookup"><span data-stu-id="d1263-170">For information about Azure platform security, see hello [Azure Security Center](https://www.microsoft.com/en-us/trustcenter/cloudservices/azure).</span></span>
