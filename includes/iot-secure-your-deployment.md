# <a name="secure-your-iot-deployment"></a><span data-ttu-id="db96d-101">Proteger su implementación de IoT</span><span class="sxs-lookup"><span data-stu-id="db96d-101">Secure your IoT deployment</span></span>
<span data-ttu-id="db96d-102">En este artículo se proporciona el siguiente nivel de detalle para proteger la infraestructura de Internet de las cosas (IoT) basada en IoT de Azure.</span><span class="sxs-lookup"><span data-stu-id="db96d-102">This article provides the next level of detail for securing the Azure IoT-based Internet of Things (IoT) infrastructure.</span></span> <span data-ttu-id="db96d-103">Incluye vínculos a detalles de niveles de implementación para configurar e implementar cada componente.</span><span class="sxs-lookup"><span data-stu-id="db96d-103">It links to implementation level details for configuring and deploying each component.</span></span> <span data-ttu-id="db96d-104">También se proporcionan comparaciones y opciones entre diversos métodos que compiten entre sí.</span><span class="sxs-lookup"><span data-stu-id="db96d-104">It also provides comparisons and choices between various competing methods.</span></span>

<span data-ttu-id="db96d-105">La protección de la implementación de IoT de Azure se puede dividir en las siguientes tres áreas de seguridad:</span><span class="sxs-lookup"><span data-stu-id="db96d-105">Securing the Azure IoT deployment can be divided into the following three security areas:</span></span>

* <span data-ttu-id="db96d-106">**Seguridad del dispositivo**: la protección del dispositivo de IoT mientras se implementa en su entorno natural.</span><span class="sxs-lookup"><span data-stu-id="db96d-106">**Device Security**: Securing the IoT device while it is deployed in the wild.</span></span>
* <span data-ttu-id="db96d-107">**Seguridad de la conexión**: asegurar que todos los datos transmitidos entre el dispositivo IoT y el Centro de IoT son confidenciales y a prueba de manipulaciones.</span><span class="sxs-lookup"><span data-stu-id="db96d-107">**Connection Security**: Ensuring all data transmitted between the IoT device and IoT Hub is confidential and tamper-proof.</span></span>
* <span data-ttu-id="db96d-108">**Seguridad de la nube**: proporcionar un medio de proteger los datos mientras se trasladan a la nube y se almacenan allí.</span><span class="sxs-lookup"><span data-stu-id="db96d-108">**Cloud Security**: Providing a means to secure data while it moves through, and is stored in the cloud.</span></span>

![Tres áreas de seguridad][img-overview]

## <a name="secure-device-provisioning-and-authentication"></a><span data-ttu-id="db96d-110">Seguridad en el aprovisionamiento y la autenticación de dispositivos</span><span class="sxs-lookup"><span data-stu-id="db96d-110">Secure device provisioning and authentication</span></span>
<span data-ttu-id="db96d-111">El conjunto de aplicaciones de IoT de Azure protege los dispositivos IoT de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="db96d-111">The Azure IoT Suite secures IoT devices by the following two methods:</span></span>

* <span data-ttu-id="db96d-112">Proporciona una clave de identidad única (tokens de seguridad) para cada dispositivo, que puede usar el dispositivo para comunicarse con el Centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="db96d-112">By providing a unique identity key (security tokens) for each device, which can be used by the device to communicate with the IoT Hub.</span></span>
* <span data-ttu-id="db96d-113">Usa un [certificado X.509][lnk-x509] y una clave privada en el dispositivo como medio para autenticarlo en IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="db96d-113">By using an on-device [X.509 certificate][lnk-x509] and private key as a means to authenticate the device to the IoT Hub.</span></span> <span data-ttu-id="db96d-114">Este método de autenticación garantiza que la clave privada que lleva el dispositivo no se conoce externamente en ningún momento, lo que proporciona un nivel de seguridad más alto.</span><span class="sxs-lookup"><span data-stu-id="db96d-114">This authentication method ensures that the private key on the device is not known outside the device at any time, providing a higher level of security.</span></span>

<span data-ttu-id="db96d-115">El método de token de seguridad proporciona autenticación para cada llamada realizada por el dispositivo al Centro de IoT mediante la asociación de la clave simétrica a cada llamada.</span><span class="sxs-lookup"><span data-stu-id="db96d-115">The security token method provides authentication for each call made by the device to IoT Hub by associating the symmetric key to each call.</span></span> <span data-ttu-id="db96d-116">La autenticación basada en X.509 permite la autenticación de un dispositivo IoT en la capa física como parte del establecimiento de la conexión TLS.</span><span class="sxs-lookup"><span data-stu-id="db96d-116">X.509-based authentication allows authentication of an IoT device at the physical layer as part of the TLS connection establishment.</span></span> <span data-ttu-id="db96d-117">El método basado en tokens de seguridad se puede usar sin la autenticación de X.509, que es un patrón menos seguro.</span><span class="sxs-lookup"><span data-stu-id="db96d-117">The security-token-based method can be used without the X.509 authentication which is a less secure pattern.</span></span> <span data-ttu-id="db96d-118">La elección de un método u otro viene determinada principalmente por lo segura que deba ser la autenticación del dispositivo y la disponibilidad de almacenamiento seguro en este (para almacenar la clave privada de forma segura).</span><span class="sxs-lookup"><span data-stu-id="db96d-118">The choice between the two methods is primarily dictated by how secure the device authentication needs to be, and availability of secure storage on the device (to store the private key securely).</span></span>

## <a name="iot-hub-security-tokens"></a><span data-ttu-id="db96d-119">Tokens de seguridad del Centro de IoT</span><span class="sxs-lookup"><span data-stu-id="db96d-119">IoT Hub security tokens</span></span>
<span data-ttu-id="db96d-120">El Centro de IoT usa tokens de seguridad para autenticar dispositivos y servicios con el fin de evitar el envío de claves en la red.</span><span class="sxs-lookup"><span data-stu-id="db96d-120">IoT Hub uses security tokens to authenticate devices and services to avoid sending keys on the network.</span></span> <span data-ttu-id="db96d-121">Además, los tokens de seguridad están limitados en cuanto al ámbito y el período de validez.</span><span class="sxs-lookup"><span data-stu-id="db96d-121">Additionally, security tokens are limited in time validity and scope.</span></span> <span data-ttu-id="db96d-122">Los SDK de IoT de Azure generan automáticamente tokens sin necesidad de ninguna configuración especial.</span><span class="sxs-lookup"><span data-stu-id="db96d-122">Azure IoT SDKs automatically generate tokens without requiring any special configuration.</span></span> <span data-ttu-id="db96d-123">Algunos escenarios, sin embargo, requieren que el usuario genere y utilice directamente los tokens de seguridad.</span><span class="sxs-lookup"><span data-stu-id="db96d-123">Some scenarios, however, require the user to generate and use security tokens directly.</span></span> <span data-ttu-id="db96d-124">Estos incluyen el uso directo de las superficies MQTT, AMQP o HTTP o la implementación del patrón de servicio de token.</span><span class="sxs-lookup"><span data-stu-id="db96d-124">These include the direct use of the MQTT, AMQP, or HTTP surfaces, or the implementation of the token service pattern.</span></span>

<span data-ttu-id="db96d-125">Puede encontrar más detalles sobre la estructura del token de seguridad y su uso en los siguientes artículos:</span><span class="sxs-lookup"><span data-stu-id="db96d-125">More details on the structure of the security token and its usage can be found in the following articles:</span></span>

* <span data-ttu-id="db96d-126">[Estructura del token de seguridad][lnk-security-tokens]</span><span class="sxs-lookup"><span data-stu-id="db96d-126">[Security token structure][lnk-security-tokens]</span></span>
* <span data-ttu-id="db96d-127">[Uso de tokens de SAS como dispositivo][lnk-sas-tokens]</span><span class="sxs-lookup"><span data-stu-id="db96d-127">[Using SAS tokens as a device][lnk-sas-tokens]</span></span>

<span data-ttu-id="db96d-128">Cada instancia de IoT Hub tiene un [Registro de identidad][lnk-identity-registry] que se usa para crear recursos en el servicio para cada dispositivo, como una cola que contiene los mensajes de nube a dispositivo en curso, y para permitir el acceso a los puntos de conexión accesibles desde el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="db96d-128">Each IoT Hub has an [identity registry][lnk-identity-registry] that can be used to create per-device resources in the service, such as a queue that contains in-flight cloud-to-device messages, and to allow access to the device-facing endpoints.</span></span> <span data-ttu-id="db96d-129">El Registro de identidad del Centro de IoT proporciona un almacenamiento seguro de las identidades y las claves de seguridad de los dispositivos de una solución.</span><span class="sxs-lookup"><span data-stu-id="db96d-129">The IoT Hub identity registry provides secure storage of device identities and security keys for a solution.</span></span> <span data-ttu-id="db96d-130">Se pueden agregar identidades de dispositivo individuales o en grupo a una lista de elementos permitidos o bloqueados, de forma que se tiene un completo control sobre el acceso a los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="db96d-130">Individual or groups of device identities can be added to an allow list, or a block list, enabling complete control over device access.</span></span> <span data-ttu-id="db96d-131">En los artículos siguientes se proporcionan más detalles sobre la estructura del Registro de identidad y las operaciones admitidas.</span><span class="sxs-lookup"><span data-stu-id="db96d-131">The following articles provide more details on the structure of the identity registry and supported operations.</span></span>

<span data-ttu-id="db96d-132">[IoT Hub admite protocolos como MQTT, AMQP y HTTP][lnk-protocols].</span><span class="sxs-lookup"><span data-stu-id="db96d-132">[IoT Hub supports protocols such as MQTT, AMQP, and HTTP][lnk-protocols].</span></span> <span data-ttu-id="db96d-133">Cada uno de estos protocolos utilizan tokens de seguridad entre el dispositivo IoT y el Centro de IoT de manera diferente:</span><span class="sxs-lookup"><span data-stu-id="db96d-133">Each of these protocols use security tokens from the IoT device to IoT Hub differently:</span></span>

* <span data-ttu-id="db96d-134">AMQP: seguridad basada en notificaciones SASL PLAIN y AMQP ({policyName}@sas.root.{iothubName} en el caso de tokens de nivel de IoT Hub; {deviceId} en el caso de tokens con ámbito de dispositivo).</span><span class="sxs-lookup"><span data-stu-id="db96d-134">AMQP: SASL PLAIN and AMQP Claims-based security ({policyName}@sas.root.{iothubName} in the case of IoT hub-level tokens; {deviceId} in case of device-scoped tokens).</span></span>
* <span data-ttu-id="db96d-135">MQTT: el paquete CONNECT utiliza {deviceId} como {ClientId}, {IoThubhostname}/{deviceId} en el campo de **nombre de usuario** y un token SAS en el campo de **contraseña**.</span><span class="sxs-lookup"><span data-stu-id="db96d-135">MQTT: CONNECT packet uses {deviceId} as the {ClientId}, {IoThubhostname}/{deviceId} in the **Username** field and a SAS token in the **Password** field.</span></span>
* <span data-ttu-id="db96d-136">HTTP: el token válido está en el encabezado de la solicitud de autorización.</span><span class="sxs-lookup"><span data-stu-id="db96d-136">HTTP: Valid token is in the authorization request header.</span></span>

<span data-ttu-id="db96d-137">Puede usar el Registro de identidad de IoT Hub para configurar las credenciales de seguridad de cada dispositivo y el control de acceso.</span><span class="sxs-lookup"><span data-stu-id="db96d-137">IoT Hub identity registry can be used to configure per-device security credentials and access control.</span></span> <span data-ttu-id="db96d-138">Sin embargo, si una solución de IoT ya realizó una inversión importante en un [Registro de identidad del dispositivo o un esquema de autenticación personalizados][lnk-custom-auth], se puede integrar en una infraestructura existente con IoT Hub mediante la creación de un servicio de token.</span><span class="sxs-lookup"><span data-stu-id="db96d-138">However, if an IoT solution already has a significant investment in a [custom device identity registry and/or authentication scheme][lnk-custom-auth], it can be integrated into an existing infrastructure with IoT Hub by creating a token service.</span></span>

### <a name="x509-certificate-based-device-authentication"></a><span data-ttu-id="db96d-139">Autenticación de dispositivos basada en certificados X.509</span><span class="sxs-lookup"><span data-stu-id="db96d-139">X.509 certificate-based device authentication</span></span>
<span data-ttu-id="db96d-140">El uso de un [certificado X.509 basado en un dispositivo][lnk-use-x509] y su par de claves pública y privada asociado permite autenticación adicional en la capa física.</span><span class="sxs-lookup"><span data-stu-id="db96d-140">The use of a [device-based X.509 certificate][lnk-use-x509] and its associated private and public key pair allows additional authentication at the physical layer.</span></span> <span data-ttu-id="db96d-141">La clave privada se almacena de forma segura en el dispositivo y es imposible detectarla fuera de él.</span><span class="sxs-lookup"><span data-stu-id="db96d-141">The private key is stored securely in the device and is not discoverable outside the device.</span></span> <span data-ttu-id="db96d-142">El certificado X.509 contiene información sobre el dispositivo, como el identificador y otros detalles de la organización.</span><span class="sxs-lookup"><span data-stu-id="db96d-142">The X.509 certificate contains information about the device, such as device ID, and other organizational details.</span></span> <span data-ttu-id="db96d-143">Mediante la clave privada se genera una firma del certificado.</span><span class="sxs-lookup"><span data-stu-id="db96d-143">A signature of the certificate is generated by using the private key.</span></span>

<span data-ttu-id="db96d-144">Flujo de aprovisionamiento de dispositivos de alto nivel:</span><span class="sxs-lookup"><span data-stu-id="db96d-144">High-level device provisioning flow:</span></span>

* <span data-ttu-id="db96d-145">Asociar un identificador a un dispositivo físico: identidad del dispositivo o certificado X.509 asociado al dispositivo durante su fabricación o puesta en servicio.</span><span class="sxs-lookup"><span data-stu-id="db96d-145">Associate an identifier to a physical device – device identity and/or X.509 certificate associated to the device during device manufacturing or commissioning.</span></span>
* <span data-ttu-id="db96d-146">Crear una entrada de identidad correspondiente en IoT Hub: identidad del dispositivo e información del dispositivo asociada en el Registro de Identidad de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="db96d-146">Create a corresponding identity entry in IoT Hub – device identity and associated device information in the IoT Hub identity registry.</span></span>
* <span data-ttu-id="db96d-147">Almacenar la huella digital del certificado X.509 de forma segura en el Registro de identidad de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="db96d-147">Securely store X.509 certificate thumbprint in IoT Hub identity registry.</span></span>

### <a name="root-certificate-on-device"></a><span data-ttu-id="db96d-148">Certificado raíz en el dispositivo</span><span class="sxs-lookup"><span data-stu-id="db96d-148">Root certificate on device</span></span>
<span data-ttu-id="db96d-149">Al establecer una conexión TLS segura con el Centro de IoT, el dispositivo IoT autentica el Centro de IoT con un certificado raíz que forma parte de su SDK.</span><span class="sxs-lookup"><span data-stu-id="db96d-149">While establishing a secure TLS connection with IoT Hub, the IoT device authenticates IoT Hub using a root certificate which is part of the device SDK.</span></span> <span data-ttu-id="db96d-150">Para el SDK cliente de C el certificado se encuentra en la carpeta "\\c\\certs" en la raíz del repositorio.</span><span class="sxs-lookup"><span data-stu-id="db96d-150">For the C client SDK the certificate is located under the folder "\\c\\certs" under the root of the repo.</span></span> <span data-ttu-id="db96d-151">A pesar de que estos certificados raíz son de larga duración, puede caducar o revocarse.</span><span class="sxs-lookup"><span data-stu-id="db96d-151">Though these root certificates are long-lived, they still may expire or be revoked.</span></span> <span data-ttu-id="db96d-152">Si no hay forma de actualizar el certificado en el dispositivo, es posible que no se pueda conectar posteriormente al Centro de IoT (o a cualquier otro servicio en la nube).</span><span class="sxs-lookup"><span data-stu-id="db96d-152">If there is no way of updating the certificate on the device, the device may not be able to subsequently connect to the IoT Hub (or any other cloud service).</span></span> <span data-ttu-id="db96d-153">Contar con los medios para actualizar el certificado raíz una vez implementado el dispositivo IoT reducirá eficazmente este riesgo.</span><span class="sxs-lookup"><span data-stu-id="db96d-153">Having a means to update the root certificate once the IoT device is deployed will effectively mitigate this risk.</span></span>

## <a name="securing-the-connection"></a><span data-ttu-id="db96d-154">Protección de la conexión</span><span class="sxs-lookup"><span data-stu-id="db96d-154">Securing the connection</span></span>
<span data-ttu-id="db96d-155">La conexión a Internet entre el dispositivo IoT y el Centro de IoT está protegida mediante el estándar de Seguridad de capa de transporte (TLS).</span><span class="sxs-lookup"><span data-stu-id="db96d-155">Internet connection between the IoT device and IoT Hub is secured using the Transport Layer Security (TLS) standard.</span></span> <span data-ttu-id="db96d-156">IoT de Azure admite [TLS 1.2][lnk-tls12], TLS 1.1 y TLS 1.0, en este orden.</span><span class="sxs-lookup"><span data-stu-id="db96d-156">Azure IoT supports [TLS 1.2][lnk-tls12], TLS 1.1 and TLS 1.0, in this order.</span></span> <span data-ttu-id="db96d-157">La compatibilidad con TLS 1.0 solo se proporciona para permitir versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="db96d-157">Support for TLS 1.0 is provided for backward compatibility only.</span></span> <span data-ttu-id="db96d-158">Se recomienda usar TLS 1.2, ya que proporciona la máxima seguridad.</span><span class="sxs-lookup"><span data-stu-id="db96d-158">It is recommended to use TLS 1.2 since it provides the most security.</span></span>

<span data-ttu-id="db96d-159">El conjunto de aplicaciones de IoT de Azure admite los siguientes conjuntos de cifrado, en este orden.</span><span class="sxs-lookup"><span data-stu-id="db96d-159">Azure IoT Suite supports the following Cipher Suites, in this order.</span></span>

| <span data-ttu-id="db96d-160">Conjunto de cifrado</span><span class="sxs-lookup"><span data-stu-id="db96d-160">Cipher Suite</span></span> | <span data-ttu-id="db96d-161">Length</span><span class="sxs-lookup"><span data-stu-id="db96d-161">Length</span></span> |
| --- | --- |
| <span data-ttu-id="db96d-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="db96d-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="db96d-163">RSA de 7680 bits) FS</span><span class="sxs-lookup"><span data-stu-id="db96d-163">7680 bits RSA) FS</span></span> |<span data-ttu-id="db96d-164">256</span><span class="sxs-lookup"><span data-stu-id="db96d-164">256</span></span> |
| <span data-ttu-id="db96d-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="db96d-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="db96d-166">RSA de 3072 bits) FS</span><span class="sxs-lookup"><span data-stu-id="db96d-166">3072 bits RSA) FS</span></span> |<span data-ttu-id="db96d-167">128</span><span class="sxs-lookup"><span data-stu-id="db96d-167">128</span></span> |
| <span data-ttu-id="db96d-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="db96d-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="db96d-169">RSA de 7680 bits) FS</span><span class="sxs-lookup"><span data-stu-id="db96d-169">7680 bits RSA) FS</span></span> |<span data-ttu-id="db96d-170">256</span><span class="sxs-lookup"><span data-stu-id="db96d-170">256</span></span> |
| <span data-ttu-id="db96d-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="db96d-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="db96d-172">RSA de 3072 bits) FS</span><span class="sxs-lookup"><span data-stu-id="db96d-172">3072 bits RSA) FS</span></span> |<span data-ttu-id="db96d-173">128</span><span class="sxs-lookup"><span data-stu-id="db96d-173">128</span></span> |
| <span data-ttu-id="db96d-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span><span class="sxs-lookup"><span data-stu-id="db96d-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span></span> |<span data-ttu-id="db96d-175">256</span><span class="sxs-lookup"><span data-stu-id="db96d-175">256</span></span> |
| <span data-ttu-id="db96d-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span><span class="sxs-lookup"><span data-stu-id="db96d-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span></span> |<span data-ttu-id="db96d-177">128</span><span class="sxs-lookup"><span data-stu-id="db96d-177">128</span></span> |
| <span data-ttu-id="db96d-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span><span class="sxs-lookup"><span data-stu-id="db96d-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span></span> |<span data-ttu-id="db96d-179">256</span><span class="sxs-lookup"><span data-stu-id="db96d-179">256</span></span> |
| <span data-ttu-id="db96d-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span><span class="sxs-lookup"><span data-stu-id="db96d-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span></span> |<span data-ttu-id="db96d-181">128</span><span class="sxs-lookup"><span data-stu-id="db96d-181">128</span></span> |
| <span data-ttu-id="db96d-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span><span class="sxs-lookup"><span data-stu-id="db96d-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span></span> |<span data-ttu-id="db96d-183">256</span><span class="sxs-lookup"><span data-stu-id="db96d-183">256</span></span> |
| <span data-ttu-id="db96d-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span><span class="sxs-lookup"><span data-stu-id="db96d-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span></span> |<span data-ttu-id="db96d-185">128</span><span class="sxs-lookup"><span data-stu-id="db96d-185">128</span></span> |
| <span data-ttu-id="db96d-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span><span class="sxs-lookup"><span data-stu-id="db96d-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span></span> |<span data-ttu-id="db96d-187">112</span><span class="sxs-lookup"><span data-stu-id="db96d-187">112</span></span> |

## <a name="securing-the-cloud"></a><span data-ttu-id="db96d-188">Protección de la nube</span><span class="sxs-lookup"><span data-stu-id="db96d-188">Securing the cloud</span></span>
<span data-ttu-id="db96d-189">Azure IoT Hub permite la definición de [directivas de control de acceso][lnk-protocols] para cada clave de seguridad.</span><span class="sxs-lookup"><span data-stu-id="db96d-189">Azure IoT Hub allows definition of [access control policies][lnk-protocols] for each security key.</span></span> <span data-ttu-id="db96d-190">Para conceder acceso a cada uno de los puntos de conexión del Centro de IoT, se utiliza el siguiente conjunto de permisos.</span><span class="sxs-lookup"><span data-stu-id="db96d-190">It uses the following set of permissions to grant access to each of IoT Hub's endpoints.</span></span> <span data-ttu-id="db96d-191">Los permisos limitan el acceso a un Centro de IoT según la funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="db96d-191">Permissions limit the access to an IoT Hub based on functionality.</span></span>

* <span data-ttu-id="db96d-192">**RegistryRead**.</span><span class="sxs-lookup"><span data-stu-id="db96d-192">**RegistryRead**.</span></span> <span data-ttu-id="db96d-193">Concede acceso de lectura al Registro de identidad.</span><span class="sxs-lookup"><span data-stu-id="db96d-193">Grants read access to the identity registry.</span></span> <span data-ttu-id="db96d-194">Para más información, consulte [Registro de identidad][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="db96d-194">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="db96d-195">**RegistryReadWrite**.</span><span class="sxs-lookup"><span data-stu-id="db96d-195">**RegistryReadWrite**.</span></span> <span data-ttu-id="db96d-196">Concede acceso de lectura y escritura al Registro de identidad.</span><span class="sxs-lookup"><span data-stu-id="db96d-196">Grants read and write access to the identity registry.</span></span> <span data-ttu-id="db96d-197">Para más información, consulte [Registro de identidad][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="db96d-197">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="db96d-198">**ServiceConnect**.</span><span class="sxs-lookup"><span data-stu-id="db96d-198">**ServiceConnect**.</span></span> <span data-ttu-id="db96d-199">Concede acceso a los puntos de conexión de comunicación y supervisión accesibles desde el servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="db96d-199">Grants access to cloud service-facing communication and monitoring endpoints.</span></span> <span data-ttu-id="db96d-200">Por ejemplo, concede permiso a los servicios en la nube de back-end para recibir mensajes de dispositivo a la nube, enviar mensajes de nube a dispositivo y recuperar las confirmaciones de entrega correspondientes.</span><span class="sxs-lookup"><span data-stu-id="db96d-200">For example, it grants permission to back-end cloud services to receive device-to-cloud messages, send cloud-to-device messages, and retrieve the corresponding delivery acknowledgments.</span></span>
* <span data-ttu-id="db96d-201">**DeviceConnect**.</span><span class="sxs-lookup"><span data-stu-id="db96d-201">**DeviceConnect**.</span></span> <span data-ttu-id="db96d-202">Concede acceso a los puntos de conexión accesibles desde los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="db96d-202">Grants access to device-facing endpoints.</span></span> <span data-ttu-id="db96d-203">Por ejemplo, concede permiso para enviar mensajes de dispositivo a nube y recibir mensajes de nube a dispositivo.</span><span class="sxs-lookup"><span data-stu-id="db96d-203">For example, it grants permission to send device-to-cloud messages and receive cloud-to-device messages.</span></span> <span data-ttu-id="db96d-204">Este permiso lo usan los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="db96d-204">This permission is used by devices.</span></span>

<span data-ttu-id="db96d-205">Existen dos maneras de obtener permisos **DeviceConnect** con IoT Hub con [tokens de seguridad][lnk-sas-tokens]: mediante una clave de identidad de dispositivo o una clave de acceso compartido.</span><span class="sxs-lookup"><span data-stu-id="db96d-205">There are two ways to obtain **DeviceConnect** permissions with IoT Hub with [security tokens][lnk-sas-tokens]: using a device identity key, or a shared access key.</span></span> <span data-ttu-id="db96d-206">Además, es importante tener en cuenta que puede acceder a toda la funcionalidad desde los dispositivos expuestos por diseño en los puntos de conexión con el prefijo `/devices/{deviceId}`.</span><span class="sxs-lookup"><span data-stu-id="db96d-206">Moreover, it is important to note that all functionality accessible from devices is exposed by design on endpoints with prefix `/devices/{deviceId}`.</span></span>

<span data-ttu-id="db96d-207">Los [componentes de servicio solo pueden generar tokens de seguridad][lnk-service-tokens] mediante directivas de acceso compartido que conceden los permisos apropiados.</span><span class="sxs-lookup"><span data-stu-id="db96d-207">[Service components can only generate security tokens][lnk-service-tokens] using shared access policies granting the appropriate permissions.</span></span>

<span data-ttu-id="db96d-208">El Centro de IoT de Azure y otros servicios que pueden formar parte de la solución permiten la administración de usuarios mediante Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="db96d-208">Azure IoT Hub and other services which may be part of the solution allow management of users using the Azure Active Directory.</span></span>

<span data-ttu-id="db96d-209">Los datos consumidos por Azure IoT Hub se pueden usar en una gran variedad de servicios, como Azure Stream Analytics, Azure Blob Storage, etc.</span><span class="sxs-lookup"><span data-stu-id="db96d-209">Data ingested by Azure IoT Hub can be consumed by a variety of services such as Azure Stream Analytics and Azure blob storage.</span></span> <span data-ttu-id="db96d-210">Estos servicios permiten el acceso de administración.</span><span class="sxs-lookup"><span data-stu-id="db96d-210">These services allow management access.</span></span> <span data-ttu-id="db96d-211">Lea más sobre estos servicios y las opciones disponibles a continuación:</span><span class="sxs-lookup"><span data-stu-id="db96d-211">Read more about these services and available options below:</span></span>

* <span data-ttu-id="db96d-212">[Azure DocumentDB][lnk-docdb]: servicio de base de datos completamente indexado y escalable destinado a datos semiestructurados que administra los metadatos de los dispositivos aprovisionados, como los atributos, la configuración y las propiedades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="db96d-212">[Azure DocumentDB][lnk-docdb]: A scalable, fully-indexed database service for semi-structured data that manages metadata for the devices you provision, such as attributes, configuration, and security properties.</span></span> <span data-ttu-id="db96d-213">DocumentDB ofrece procesamiento de alto rendimiento, indexación de datos independiente del esquema y una completa interfaz de consultas SQL.</span><span class="sxs-lookup"><span data-stu-id="db96d-213">DocumentDB offers high-performance and high-throughput processing, schema-agnostic indexing of data, and a rich SQL query interface.</span></span>
* <span data-ttu-id="db96d-214">[Azure Stream Analytics][lnk-asa]: procesamiento de transmisiones en tiempo real en la nube que permite desarrollar e implementar rápidamente una solución de análisis de bajo costo para desvelar datos detallados en tiempo real de dispositivos, sensores, infraestructura y aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="db96d-214">[Azure Stream Analytics][lnk-asa]: Real-time stream processing in the cloud that enables you to rapidly develop and deploy a low-cost analytics solution to uncover real-time insights from devices, sensors, infrastructure, and applications.</span></span> <span data-ttu-id="db96d-215">Los datos de este servicio completamente administrado se pueden escalar a cualquier volumen, sin dejar de obtener alto rendimiento, baja latencia y resistencia.</span><span class="sxs-lookup"><span data-stu-id="db96d-215">The data from this fully-managed service can scale to any volume while still achieving high throughput, low latency, and resiliency.</span></span>
* <span data-ttu-id="db96d-216">[Azure App Services][lnk-appservices]: plataforma en la nube que sirve para crear sólidas aplicaciones web y móviles desde las que se puede acceder a datos en cualquier lugar, ya sea en la nube o desde la infraestructura local.</span><span class="sxs-lookup"><span data-stu-id="db96d-216">[Azure App Services][lnk-appservices]: A cloud platform to build powerful web and mobile apps that connect to data anywhere; in the cloud or on-premises.</span></span> <span data-ttu-id="db96d-217">Cree atractivas aplicaciones móviles para iOS, Android y Windows.</span><span class="sxs-lookup"><span data-stu-id="db96d-217">Build engaging mobile apps for iOS, Android, and Windows.</span></span> <span data-ttu-id="db96d-218">Realice integraciones con aplicaciones de Software como servicio (SaaS) y empresariales gracias a la conectividad de serie a docenas de aplicaciones empresariales y servicios basados en la nube.</span><span class="sxs-lookup"><span data-stu-id="db96d-218">Integrate with your Software as a Service (SaaS) and enterprise applications with out-of-the-box connectivity to dozens of cloud-based services and enterprise applications.</span></span> <span data-ttu-id="db96d-219">Codifique en su lenguaje e IDE (.NET, Node.js, PHP, Python o Java) preferidos para crear aplicaciones web y API con más rapidez que nunca.</span><span class="sxs-lookup"><span data-stu-id="db96d-219">Code in your favorite language and IDE (.NET, Node.js, PHP, Python, or Java) to build web apps and APIs faster than ever.</span></span>
* <span data-ttu-id="db96d-220">[Logic Apps][lnk-logicapps]: la característica Logic Apps de Azure App Service sirve para integrar la solución de IoT con los sistemas de línea de negocio existentes y para automatizar los procesos de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="db96d-220">[Logic Apps][lnk-logicapps]: The Logic Apps feature of Azure App Service helps integrate your IoT solution to your existing line-of-business systems and automate workflow processes.</span></span> <span data-ttu-id="db96d-221">Las aplicaciones lógicas permiten a los desarrolladores diseñar flujos de trabajo que se inician desde un desencadenador y ejecutan luego una serie de pasos: reglas y acciones que usan eficaces conectores para la integración con los procesos de negocio.</span><span class="sxs-lookup"><span data-stu-id="db96d-221">Logic Apps enables developers to design workflows that start from a trigger and then execute a series of steps—rules and actions that use powerful connectors to integrate with your business processes.</span></span> <span data-ttu-id="db96d-222">Las aplicaciones lógicas ofrecen conectividad de serie a un gran ecosistema de aplicaciones SaaS, basadas en la nube y locales.</span><span class="sxs-lookup"><span data-stu-id="db96d-222">Logic Apps offers out-of-the-box connectivity to a vast ecosystem of SaaS, cloud-based, and on-premises applications.</span></span>
* <span data-ttu-id="db96d-223">[Azure Blob Storage][lnk-blob]: almacenamiento en la nube de confianza y económico para los datos que los dispositivos envían a la nube.</span><span class="sxs-lookup"><span data-stu-id="db96d-223">[Azure blob storage][lnk-blob]: Reliable, economical cloud storage for the data that your devices send to the cloud.</span></span>

## <a name="conclusion"></a><span data-ttu-id="db96d-224">Conclusión</span><span class="sxs-lookup"><span data-stu-id="db96d-224">Conclusion</span></span>
<span data-ttu-id="db96d-225">En este artículo se proporciona información general sobre los detalles de los niveles de implementación para diseñar e implementar una infraestructura de IoT mediante IoT de Azure.</span><span class="sxs-lookup"><span data-stu-id="db96d-225">This article provides overview of implementation level details for designing and deploying an IoT infrastructure using Azure IoT.</span></span> <span data-ttu-id="db96d-226">La configuración de la seguridad de cada componente es clave para proteger la infraestructura general de IoT.</span><span class="sxs-lookup"><span data-stu-id="db96d-226">Configuring each component to be secure is key in securing the overall IoT infrastructure.</span></span> <span data-ttu-id="db96d-227">Las opciones de diseño disponibles en IoT de Azure proporcionan un cierto nivel de flexibilidad y elección; sin embargo, cada elección puede tener implicaciones para la seguridad.</span><span class="sxs-lookup"><span data-stu-id="db96d-227">The design choices available in Azure IoT provide some level of flexibility and choice; however, each choice may have security implications.</span></span> <span data-ttu-id="db96d-228">Se recomienda valorar cada una de estas opciones mediante una evaluación de riesgo y costo.</span><span class="sxs-lookup"><span data-stu-id="db96d-228">It is recommended that each of these choices be evaluated through a risk/cost assessment.</span></span>

[img-overview]: media/iot-secure-your-deployment/overview.png

[lnk-security-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#security-token-structure
[lnk-sas-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-sas-tokens-in-a-device-app
[lnk-identity-registry]: ../articles/iot-hub/iot-hub-devguide-identity-registry.md
[lnk-protocols]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-custom-auth]: ../articles/iot-hub/iot-hub-devguide-security.md#custom-device-authentication
[lnk-x509]: http://www.itu.int/rec/T-REC-X.509-201210-I/en
[lnk-use-x509]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-tls12]: https://tools.ietf.org/html/rfc5246
[lnk-service-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-security-tokens-from-service-components
[lnk-docdb]: https://azure.microsoft.com/services/documentdb/
[lnk-asa]: https://azure.microsoft.com/services/stream-analytics/
[lnk-appservices]: https://azure.microsoft.com/services/app-service/
[lnk-logicapps]: https://azure.microsoft.com/services/app-service/logic/
[lnk-blob]: https://azure.microsoft.com/services/storage/
