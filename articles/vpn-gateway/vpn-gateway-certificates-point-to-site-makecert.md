---
title: "Generación y exportación de certificados para conexiones de punto a sitio: MakeCert: Azure | Microsoft Docs"
description: "Este artículo contiene pasos para crear un certificado raíz autofirmado, exportar la clave pública y generar los certificados de cliente mediante MakeCert."
services: vpn-gateway
documentationcenter: na
author: cherylmc
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: vpn-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/09/2017
ms.author: cherylmc
ms.openlocfilehash: 4c51edac3b1cdafae8f9543bd0e3133b6a050f73
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/18/2017
---
# <a name="generate-and-export-certificates-for-point-to-site-connections-using-makecert"></a><span data-ttu-id="b9682-103">Generación y exportación de certificados para conexiones de punto a sitio con MakeCert</span><span class="sxs-lookup"><span data-stu-id="b9682-103">Generate and export certificates for Point-to-Site connections using MakeCert</span></span>

<span data-ttu-id="b9682-104">Las conexiones de punto a sitio utilizan certificados para realizar la autenticación.</span><span class="sxs-lookup"><span data-stu-id="b9682-104">Point-to-Site connections use certificates to authenticate.</span></span> <span data-ttu-id="b9682-105">En este artículo, se muestra cómo crear un certificado raíz autofirmado y generar certificados de cliente con MakeCert.</span><span class="sxs-lookup"><span data-stu-id="b9682-105">This article shows you how to create a self-signed root certificate and generate client certificates using MakeCert.</span></span> <span data-ttu-id="b9682-106">Si desea obtener los pasos de configuración de punto a sitio (por ejemplo, cómo cargar certificados raíz), seleccione uno de los artículos de "Configuración de punto a sitio" de la lista siguiente:</span><span class="sxs-lookup"><span data-stu-id="b9682-106">If you are looking for Point-to-Site configuration steps, such as how to upload root certificates, select one of the 'Configure Point-to-Site' articles from the following list:</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="b9682-107">Creación de certificados autofirmados: PowerShell</span><span class="sxs-lookup"><span data-stu-id="b9682-107">Create self-signed certificates - PowerShell</span></span>](vpn-gateway-certificates-point-to-site.md)
> * [<span data-ttu-id="b9682-108">Creación de certificados autofirmados: MakeCert</span><span class="sxs-lookup"><span data-stu-id="b9682-108">Create self-signed certificates - MakeCert</span></span>](vpn-gateway-certificates-point-to-site-makecert.md)
> * [<span data-ttu-id="b9682-109">Configuración de una conexión de punto a sitio: Resource Manager: Azure Portal</span><span class="sxs-lookup"><span data-stu-id="b9682-109">Configure Point-to-Site - Resource Manager - Azure portal</span></span>](vpn-gateway-howto-point-to-site-resource-manager-portal.md)
> * [<span data-ttu-id="b9682-110">Configuración de una conexión de punto a sitio - Resource Manager - PowerShell</span><span class="sxs-lookup"><span data-stu-id="b9682-110">Configure Point-to-Site - Resource Manager - PowerShell</span></span>](vpn-gateway-howto-point-to-site-rm-ps.md)
> * [<span data-ttu-id="b9682-111">Configuración de una conexión de punto a sitio: Clásico: Azure Portal</span><span class="sxs-lookup"><span data-stu-id="b9682-111">Configure Point-to-Site - Classic - Azure portal</span></span>](vpn-gateway-howto-point-to-site-classic-azure-portal.md)
> 
> 

<span data-ttu-id="b9682-112">Aunque se recomienda utilizar los [pasos de Windows 10 PowerShell](vpn-gateway-certificates-point-to-site.md) para crear los certificados, proporcionamos estas instrucciones de MakeCert como un método opcional.</span><span class="sxs-lookup"><span data-stu-id="b9682-112">While we recommend using the [Windows 10 PowerShell steps](vpn-gateway-certificates-point-to-site.md) to create your certificates, we provide these MakeCert instructions as an optional method.</span></span> <span data-ttu-id="b9682-113">Los certificados que genera mediante cualquiera de estos métodos pueden instalarse en [cualquier sistema operativo cliente compatible](vpn-gateway-howto-point-to-site-resource-manager-portal.md#faq).</span><span class="sxs-lookup"><span data-stu-id="b9682-113">The certificates that you generate using either method can be installed on [any supported client operating system](vpn-gateway-howto-point-to-site-resource-manager-portal.md#faq).</span></span> <span data-ttu-id="b9682-114">Sin embargo, MakeCert tiene la siguiente limitación:</span><span class="sxs-lookup"><span data-stu-id="b9682-114">However, MakeCert has the following limitation:</span></span>

* <span data-ttu-id="b9682-115">Makecert está en desuso.</span><span class="sxs-lookup"><span data-stu-id="b9682-115">MakeCert is deprecated.</span></span> <span data-ttu-id="b9682-116">Esto significa que se puede quitar esta herramienta en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="b9682-116">This means that this tool could be removed at any point.</span></span> <span data-ttu-id="b9682-117">Los certificados ya generados con MakeCert no se verán afectados si MakeCert ya no está disponible.</span><span class="sxs-lookup"><span data-stu-id="b9682-117">Any certificates that you already generated using MakeCert won't be affected when MakeCert is no longer available.</span></span> <span data-ttu-id="b9682-118">MakeCert solo se utiliza para generar los certificados, no como un mecanismo de validación.</span><span class="sxs-lookup"><span data-stu-id="b9682-118">MakeCert is only used to generate the certificates, not as a validating mechanism.</span></span>

## <span data-ttu-id="b9682-119"><a name="rootcert"></a>Creación de un certificado raíz autofirmado</span><span class="sxs-lookup"><span data-stu-id="b9682-119"><a name="rootcert"></a>Create a self-signed root certificate</span></span>

<span data-ttu-id="b9682-120">Los siguientes pasos le mostrarán cómo crear un certificado autofirmado mediante MakeCert.</span><span class="sxs-lookup"><span data-stu-id="b9682-120">The following steps show you how to create a self-signed certificate using MakeCert.</span></span> <span data-ttu-id="b9682-121">Estos pasos no son específicos del modelo de implementación.</span><span class="sxs-lookup"><span data-stu-id="b9682-121">These steps are not deployment-model specific.</span></span> <span data-ttu-id="b9682-122">Son válidos para el Administrador de recursos y la versión clásica.</span><span class="sxs-lookup"><span data-stu-id="b9682-122">They are valid for both Resource Manager and classic.</span></span>

1. <span data-ttu-id="b9682-123">Descargue e instale [MakeCert](https://msdn.microsoft.com/library/windows/desktop/aa386968(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="b9682-123">Download and install [MakeCert](https://msdn.microsoft.com/library/windows/desktop/aa386968(v=vs.85).aspx).</span></span>
2. <span data-ttu-id="b9682-124">Después de la instalación, la utilidad makecert.exe se encuentra normalmente en esta ruta de acceso: C:\Archivos de programa (x86)\Windows Kits\10\bin\<arch>.</span><span class="sxs-lookup"><span data-stu-id="b9682-124">After installation, you can typically find the makecert.exe utility under this path: 'C:\Program Files (x86)\Windows Kits\10\bin\<arch>'.</span></span> <span data-ttu-id="b9682-125">Sin embargo, es posible que se haya instalado en otra ubicación.</span><span class="sxs-lookup"><span data-stu-id="b9682-125">Although, it's possible that it was installed to another location.</span></span> <span data-ttu-id="b9682-126">Abra un símbolo del sistema como administrador y navegue hasta la ubicación de la utilidad MakeCert.</span><span class="sxs-lookup"><span data-stu-id="b9682-126">Open a command prompt as administrator and navigate to the location of the MakeCert utility.</span></span> <span data-ttu-id="b9682-127">Puede usar el siguiente ejemplo y ajustar la ubicación adecuada:</span><span class="sxs-lookup"><span data-stu-id="b9682-127">You can use the following example, adjusting for the proper location:</span></span>

  ```cmd
  cd C:\Program Files (x86)\Windows Kits\10\bin\x64
  ```
3. <span data-ttu-id="b9682-128">Después, cree e instale un certificado en el almacén de certificados personal de su equipo.</span><span class="sxs-lookup"><span data-stu-id="b9682-128">Create and install a certificate in the Personal certificate store on your computer.</span></span> <span data-ttu-id="b9682-129">En el ejemplo siguiente se crea un archivo *.cer* correspondiente que se carga en Azure al configurar P2S.</span><span class="sxs-lookup"><span data-stu-id="b9682-129">The following example creates a corresponding *.cer* file that you upload to Azure when configuring P2S.</span></span> <span data-ttu-id="b9682-130">Reemplace P2SRootCert y P2SRootCert.cer por el nombre que quiera usar para el certificado.</span><span class="sxs-lookup"><span data-stu-id="b9682-130">Replace 'P2SRootCert' and 'P2SRootCert.cer' with the name that you want to use for the certificate.</span></span> <span data-ttu-id="b9682-131">El certificado se encuentra en los certificados, en "Usuario actual\Personal\Certificados".</span><span class="sxs-lookup"><span data-stu-id="b9682-131">The certificate is located in your 'Certificates - Current User\Personal\Certificates'.</span></span>

  ```cmd
  makecert -sky exchange -r -n "CN=P2SRootCert" -pe -a sha256 -len 2048 -ss My
  ```

## <span data-ttu-id="b9682-132"><a name="cer"></a>Exportación de la clave pública (.cer)</span><span class="sxs-lookup"><span data-stu-id="b9682-132"><a name="cer"></a>Export the public key (.cer)</span></span>

[!INCLUDE [Export public key](../../includes/vpn-gateway-certificates-export-public-key-include.md)]

<span data-ttu-id="b9682-133">El archivo exported.cer debe cargarse en Azure.</span><span class="sxs-lookup"><span data-stu-id="b9682-133">The exported.cer file must be uploaded to Azure.</span></span> <span data-ttu-id="b9682-134">Para ver las instrucciones, consulte [Configuración de una conexión de punto a sitio](vpn-gateway-howto-point-to-site-resource-manager-portal.md#uploadfile).</span><span class="sxs-lookup"><span data-stu-id="b9682-134">For instructions, see [Configure a Point-to-Site connection](vpn-gateway-howto-point-to-site-resource-manager-portal.md#uploadfile).</span></span> <span data-ttu-id="b9682-135">Para agregar un certificado raíz de confianza adicional, vea [esta sección](vpn-gateway-howto-point-to-site-resource-manager-portal.md#add) del artículo.</span><span class="sxs-lookup"><span data-stu-id="b9682-135">To add an additional trusted root certificate, see [this section](vpn-gateway-howto-point-to-site-resource-manager-portal.md#add) of the article.</span></span>

### <a name="export-the-self-signed-certificate-and-private-key-to-store-it-optional"></a><span data-ttu-id="b9682-136">Exportación del certificado autofirmado y clave privada para almacenarlo (opcional)</span><span class="sxs-lookup"><span data-stu-id="b9682-136">Export the self-signed certificate and private key to store it (optional)</span></span>

<span data-ttu-id="b9682-137">Puede que desee exportar el certificado autofirmado y almacenarlo de manera segura.</span><span class="sxs-lookup"><span data-stu-id="b9682-137">You may want to export the self-signed root certificate and store it safely.</span></span> <span data-ttu-id="b9682-138">Si es necesario, más adelante puede instalarlo en otro equipo y generar más certificados de cliente o exportar otro archivo .cer.</span><span class="sxs-lookup"><span data-stu-id="b9682-138">If need be, you can later install it on another computer and generate more client certificates, or export another .cer file.</span></span> <span data-ttu-id="b9682-139">Para exportar el certificado raíz autofirmado como archivo .pfx, seleccione el certificado raíz y use los mismos pasos descritos en [Exportación de un certificado de cliente](#clientexport).</span><span class="sxs-lookup"><span data-stu-id="b9682-139">To export the self-signed root certificate as a .pfx, select the root certificate and use the same steps as described in [Export a client certificate](#clientexport).</span></span>

## <a name="create-and-install-client-certificates"></a><span data-ttu-id="b9682-140">Creación e instalación de certificados de cliente</span><span class="sxs-lookup"><span data-stu-id="b9682-140">Create and install client certificates</span></span>

<span data-ttu-id="b9682-141">No instale el certificado autofirmado directamente en el equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-141">You don't install the self-signed certificate directly on the client computer.</span></span> <span data-ttu-id="b9682-142">Debe generar un certificado de cliente a partir del certificado autofirmado.</span><span class="sxs-lookup"><span data-stu-id="b9682-142">You need to generate a client certificate from the self-signed certificate.</span></span> <span data-ttu-id="b9682-143">Luego, el certificado de cliente se exporta e instala en el equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-143">You then export and install the client certificate to the client computer.</span></span> <span data-ttu-id="b9682-144">Los siguientes pasos no son específicos del modelo de implementación.</span><span class="sxs-lookup"><span data-stu-id="b9682-144">The following steps are not deployment-model specific.</span></span> <span data-ttu-id="b9682-145">Son válidos para el Administrador de recursos y la versión clásica.</span><span class="sxs-lookup"><span data-stu-id="b9682-145">They are valid for both Resource Manager and classic.</span></span>

### <span data-ttu-id="b9682-146"><a name="clientcert"></a>Generación de un certificado de cliente</span><span class="sxs-lookup"><span data-stu-id="b9682-146"><a name="clientcert"></a>Generate a client certificate</span></span>

<span data-ttu-id="b9682-147">Cada equipo cliente que se conecta a una red virtual con una conexión de punto a sitio debe tener instalado un certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-147">Each client computer that connects to a VNet using Point-to-Site must have a client certificate installed.</span></span> <span data-ttu-id="b9682-148">Puede generarlo desde un certificado raíz autofirmado y, luego, exportar e instalar el certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-148">You generate a client certificate from the self-signed root certificate, and then export and install the client certificate.</span></span> <span data-ttu-id="b9682-149">Si no está instalado el certificado de cliente, se produce un error de autenticación.</span><span class="sxs-lookup"><span data-stu-id="b9682-149">If the client certificate is not installed, authentication fails.</span></span> 

<span data-ttu-id="b9682-150">Los pasos siguientes lo llevan por el proceso de generación de un certificado de cliente a partir de un certificado autofirmado.</span><span class="sxs-lookup"><span data-stu-id="b9682-150">The following steps walk you through generating a client certificate from a self-signed root certificate.</span></span> <span data-ttu-id="b9682-151">Puede generar varios certificados de cliente desde el mismo certificado raíz.</span><span class="sxs-lookup"><span data-stu-id="b9682-151">You may generate multiple client certificates from the same root certificate.</span></span> <span data-ttu-id="b9682-152">Al generar certificados de cliente mediante los pasos siguientes, el certificado de cliente se instala automáticamente en el equipo que se usó para generar el certificado.</span><span class="sxs-lookup"><span data-stu-id="b9682-152">When you generate client certificates using the steps below, the client certificate is automatically installed on the computer that you used to generate the certificate.</span></span> <span data-ttu-id="b9682-153">Si desea instalar un certificado de cliente en otro equipo cliente, puede exportar el certificado.</span><span class="sxs-lookup"><span data-stu-id="b9682-153">If you want to install a client certificate on another client computer, you can export the certificate.</span></span>
 
1. <span data-ttu-id="b9682-154">En el mismo equipo que usó para crear el certificado autofirmado, abra un símbolo del sistema como administrador.</span><span class="sxs-lookup"><span data-stu-id="b9682-154">On the same computer that you used to create the self-signed certificate, open a command prompt as administrator.</span></span>
2. <span data-ttu-id="b9682-155">Modifique y ejecute el ejemplo para generar un certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-155">Modify and run the sample to generate a client certificate.</span></span>
  * <span data-ttu-id="b9682-156">Cambie *"P2SRootCert"* por el nombre del certificado raíz autofirmado desde el que genera el certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-156">Change *"P2SRootCert"* to the name of the self-signed root that you are generating the client certificate from.</span></span> <span data-ttu-id="b9682-157">Asegúrese de que esté usando el nombre del certificado raíz, que será el valor de CN= que especificó cuando creó el certificado raíz autofirmado.</span><span class="sxs-lookup"><span data-stu-id="b9682-157">Make sure you are using the name of the root certificate, which is whatever the 'CN=' value was that you specified when you created the self-signed root.</span></span>
  * <span data-ttu-id="b9682-158">Cambie *P2SChildCert* por el nombre con el cual desea generar un certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="b9682-158">Change *P2SChildCert* to the name you want to generate a client certificate to be.</span></span>

  <span data-ttu-id="b9682-159">Si ejecuta el mismo ejemplo sin modificarlo, el resultado es un certificado de cliente denominado P2SChildcert en el almacén de certificados personal que se generó a partir del certificado raíz P2SRootCert.</span><span class="sxs-lookup"><span data-stu-id="b9682-159">If you run the following example without modifying it, the result is a client certificate named P2SChildcert in your Personal certificate store that was generated from root certificate P2SRootCert.</span></span>

  ```cmd
  makecert.exe -n "CN=P2SChildCert" -pe -sky exchange -m 96 -ss My -in "P2SRootCert" -is my -a sha256
  ```

### <span data-ttu-id="b9682-160"><a name="clientexport"></a>Exportación de un certificado de cliente</span><span class="sxs-lookup"><span data-stu-id="b9682-160"><a name="clientexport"></a>Export a client certificate</span></span>

[!INCLUDE [Export client certificate](../../includes/vpn-gateway-certificates-export-client-cert-include.md)]

### <span data-ttu-id="b9682-161"><a name="install"></a>Instalación de un certificado de cliente exportado</span><span class="sxs-lookup"><span data-stu-id="b9682-161"><a name="install"></a>Install an exported client certificate</span></span>

[!INCLUDE [Install client certificate](../../includes/vpn-gateway-certificates-install-client-cert-include.md)]

## <a name="next-steps"></a><span data-ttu-id="b9682-162">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="b9682-162">Next steps</span></span>

<span data-ttu-id="b9682-163">Continúe con la configuración de punto a sitio.</span><span class="sxs-lookup"><span data-stu-id="b9682-163">Continue with your Point-to-Site configuration.</span></span> 

* <span data-ttu-id="b9682-164">Para ver los pasos del modelo de implementación de **Resource Manager**, consulte [Configuración de una conexión de punto a sitio a una red virtual mediante una red virtual](vpn-gateway-howto-point-to-site-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="b9682-164">For **Resource Manager** deployment model steps, see [Configure a Point-to-Site connection to a VNet](vpn-gateway-howto-point-to-site-resource-manager-portal.md).</span></span>
* <span data-ttu-id="b9682-165">Para ver los pasos del modelo de implementación **clásica**, consulte el artículo [Configuración de una conexión VPN de punto a sitio a una red virtual mediante el Portal clásico](vpn-gateway-howto-point-to-site-classic-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="b9682-165">For **classic** deployment model steps, see [Configure a Point-to-Site VPN connection to a VNet (classic)](vpn-gateway-howto-point-to-site-classic-azure-portal.md).</span></span>
