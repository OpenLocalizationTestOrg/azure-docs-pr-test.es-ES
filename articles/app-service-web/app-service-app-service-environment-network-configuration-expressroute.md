---
title: "Detalles de configuración de red para trabajar con ExpressRoute"
description: "Detalles de configuración de red para ejecutar entornos del Servicio de aplicaciones en las redes virtuales conectadas a un circuito de ExpressRoute."
services: app-service
documentationcenter: 
author: stefsch
manager: nirma
editor: 
ms.assetid: 34b49178-2595-4d32-9b41-110c96dde6bf
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/14/2016
ms.author: stefsch
ms.openlocfilehash: de1d998ee86c127149dee18e9df577705054ddb4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="network-configuration-details-for-app-service-environments-with-expressroute"></a><span data-ttu-id="27b31-103">Detalles de configuración de red para entornos del Servicio de aplicaciones con ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="27b31-103">Network Configuration Details for App Service Environments with ExpressRoute</span></span>
## <a name="overview"></a><span data-ttu-id="27b31-104">Información general</span><span class="sxs-lookup"><span data-stu-id="27b31-104">Overview</span></span>
<span data-ttu-id="27b31-105">Los clientes pueden conectar un circuito de [Azure ExpressRoute][ExpressRoute] a su infraestructura de red virtual, lo que permite ampliar la red local a Azure.</span><span class="sxs-lookup"><span data-stu-id="27b31-105">Customers can connect an [Azure ExpressRoute][ExpressRoute] circuit to their virtual network infrastructure, thus extending their on-premises network to Azure.</span></span>  <span data-ttu-id="27b31-106">Se puede crear una instancia de App Service Environment en una subred de la infraestructura de esta [red virtual][virtualnetwork].</span><span class="sxs-lookup"><span data-stu-id="27b31-106">An App Service Environment can  be created in a subnet of this [virtual network][virtualnetwork] infrastructure.</span></span>  <span data-ttu-id="27b31-107">Las aplicaciones que se ejecutan en el entorno del Servicio de aplicaciones pueden establecer conexiones seguras con los recursos backend a los que solo se puede tener acceso través de la conexión ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="27b31-107">Apps running on the App Service Environment can then establish secure connections to back-end resources accessible only over the ExpressRoute connection.</span></span>  

<span data-ttu-id="27b31-108">Un entorno del Servicio de aplicaciones se puede crear **en** una red virtual de Azure Resource Manager **o en** una del modelo de implementación clásica.</span><span class="sxs-lookup"><span data-stu-id="27b31-108">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model virtual network.</span></span>  <span data-ttu-id="27b31-109">Tras el cambio reciente realizado en junio de 2016, los ASE también se pueden implementar en redes virtuales que usen intervalos de direcciones públicas o espacios de direcciones de RFC1918 (es decir,</span><span class="sxs-lookup"><span data-stu-id="27b31-109">With a recent change made in June 2016, ASEs can also now be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e.</span></span> <span data-ttu-id="27b31-110">direcciones privadas).</span><span class="sxs-lookup"><span data-stu-id="27b31-110">private addresses).</span></span> 

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="required-network-connectivity"></a><span data-ttu-id="27b31-111">Conectividad de red necesaria</span><span class="sxs-lookup"><span data-stu-id="27b31-111">Required Network Connectivity</span></span>
<span data-ttu-id="27b31-112">Existen requisitos de conectividad de red para entornos del Servicio de aplicaciones que no pueden cumplirse inicialmente en una red virtual conectada a ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="27b31-112">There are network connectivity requirements for App Service Environments that may not be initially met in a virtual network connected to an ExpressRoute.</span></span>  <span data-ttu-id="27b31-113">Los entornos del Servicio de aplicaciones requieren todas las opciones siguientes para funcionar correctamente:</span><span class="sxs-lookup"><span data-stu-id="27b31-113">App Service Environments require all of the following in order to function properly:</span></span>

* <span data-ttu-id="27b31-114">Conectividad de red saliente a los puntos de conexión de Almacenamiento de Azure en los puertos 80 y 443.</span><span class="sxs-lookup"><span data-stu-id="27b31-114">Outbound network connectivity to Azure Storage endpoints worldwide on both ports 80 and 443.</span></span>  <span data-ttu-id="27b31-115">Esto incluye los puntos de conexión situados en la misma región que el Entorno del Servicio de aplicaciones, así como los puntos de conexión de almacenamiento ubicados en **otras** regiones de Azure.</span><span class="sxs-lookup"><span data-stu-id="27b31-115">This includes endpoints located in the same region as the App Service Environment, as well as storage endpoints located in **other** Azure regions.</span></span>  <span data-ttu-id="27b31-116">Los puntos de conexión de Azure Storage se resuelven en los siguientes dominios de DNS: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net* y *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="27b31-116">Azure Storage endpoints resolve under the following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net* and *file.core.windows.net*.</span></span>  
* <span data-ttu-id="27b31-117">Conectividad de red saliente al servicio Archivos de Azure en el puerto 445.</span><span class="sxs-lookup"><span data-stu-id="27b31-117">Outbound network connectivity to the Azure Files service on port 445.</span></span>
* <span data-ttu-id="27b31-118">Conectividad de red saliente a los puntos de conexión de Base de datos SQL ubicados en la misma región que el entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-118">Outbound network connectivity to Sql DB endpoints located in the same region as the App Service Environment.</span></span>  <span data-ttu-id="27b31-119">Los puntos de conexión de SQL DB se resuelven en el dominio siguiente: *database.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="27b31-119">Sql DB endpoints resolve under the following domain:  *database.windows.net*.</span></span>  <span data-ttu-id="27b31-120">Para ello, hay que abrir el acceso a los puertos 1433, 11000 a 11999 y 14000 a 14999.</span><span class="sxs-lookup"><span data-stu-id="27b31-120">This requires opening access to ports 1433, 11000-11999 and 14000-14999.</span></span>  <span data-ttu-id="27b31-121">Para obtener más información, consulte [este artículo sobre el uso de puertos en la versión 12 de Base de datos SQL](../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).</span><span class="sxs-lookup"><span data-stu-id="27b31-121">For more details see [this article on Sql Database V12 port usage](../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).</span></span>
* <span data-ttu-id="27b31-122">Conectividad de la red saliente a los puntos de conexión del plano de administración de Azure (puntos de conexión ASM y ARM).</span><span class="sxs-lookup"><span data-stu-id="27b31-122">Outbound network connectivity to the Azure management plane endpoints (both ASM and ARM endpoints).</span></span>  <span data-ttu-id="27b31-123">Incluye conectividad saliente tanto a *management.core.windows.net* como a *management.azure.com*.</span><span class="sxs-lookup"><span data-stu-id="27b31-123">This includes outbound connectivity to both *management.core.windows.net* and *management.azure.com*.</span></span> 
* <span data-ttu-id="27b31-124">Conectividad de red saliente con *ocsp.msocsp.com*, *mscrl.microsoft.com* y *crl.microsoft.com*.</span><span class="sxs-lookup"><span data-stu-id="27b31-124">Outbound network connectivity to *ocsp.msocsp.com*, *mscrl.microsoft.com* and *crl.microsoft.com*.</span></span>  <span data-ttu-id="27b31-125">Es necesario para admitir la funcionalidad SSL.</span><span class="sxs-lookup"><span data-stu-id="27b31-125">This is needed to support SSL functionality.</span></span>
* <span data-ttu-id="27b31-126">La configuración de DNS para la red virtual debe ser capaz de resolver todos los puntos de conexión y dominios mencionados en los puntos anteriores.</span><span class="sxs-lookup"><span data-stu-id="27b31-126">The DNS configuration for the virtual network must be capable of resolving all of the endpoints and domains mentioned in the earlier points.</span></span>  <span data-ttu-id="27b31-127">Si estos puntos de conexión no se pueden resolver, se producirá un error en los intentos de creación del entorno del Servicio de aplicaciones y los entornos del Servicio de aplicaciones existentes se marcarán como incorrectos.</span><span class="sxs-lookup"><span data-stu-id="27b31-127">If these endpoints cannot be resolved, App Service Environment creation attempts will fail, and existing App Service Environments will be marked as unhealthy.</span></span>
* <span data-ttu-id="27b31-128">Se requiere acceso saliente en el puerto 53 para establecer la comunicación con los servidores DNS.</span><span class="sxs-lookup"><span data-stu-id="27b31-128">Outbound access on port 53 is required for communication with DNS servers.</span></span>
* <span data-ttu-id="27b31-129">Si existe un servidor DNS personalizado en el otro punto de conexión de una puerta de enlace de VPN, el servidor DNS debe estar accesible desde la subred que contiene el entorno de Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-129">If a custom DNS server exists on the other end of a VPN gateway, the DNS server must be reachable from the subnet containing the App Service Environment.</span></span> 
* <span data-ttu-id="27b31-130">La ruta de acceso de la red saliente no puede atravesar los servidores proxy corporativos internos, ni puede forzar la tunelización a local.</span><span class="sxs-lookup"><span data-stu-id="27b31-130">The outbound network path cannot travel through internal corporate proxies, nor can it be force tunneled to on-premises.</span></span>  <span data-ttu-id="27b31-131">Si lo hace, se cambiará la dirección NAT en vigor del tráfico de red saliente del entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-131">Doing so changes the effective NAT address of outbound network traffic from the App Service Environment.</span></span>  <span data-ttu-id="27b31-132">Al cambiar la dirección NAT del tráfico de red de salida de un entorno del Servicio de aplicaciones causará errores de conectividad a muchos de los puntos de conexión enumerados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="27b31-132">Changing the NAT address of an App Service Environment's outbound network traffic will cause connectivity failures to many of the endpoints listed above.</span></span>  <span data-ttu-id="27b31-133">Lo que da como resultado un error al intentar la creación del entorno del Servicio de aplicaciones, y además, los entornos del Servicio de aplicaciones previamente correctos estarán marcados como incorrectos.</span><span class="sxs-lookup"><span data-stu-id="27b31-133">This results in failed App Service Environment creation attempts, as well as previously healthy App Service Environments being marked as unhealthy.</span></span>  
* <span data-ttu-id="27b31-134">El acceso de red entrante a los puertos requeridos para las instancias de App Service Environment debe estar permitido, como se describe en este [artículo][requiredports].</span><span class="sxs-lookup"><span data-stu-id="27b31-134">Inbound network access to required ports for App Service Environments must be allowed as described in this [article][requiredports].</span></span>

<span data-ttu-id="27b31-135">Se cumplen los requisitos de DNS al asegurar que se configura y se mantiene una infraestructura DNS válida para la red virtual.</span><span class="sxs-lookup"><span data-stu-id="27b31-135">The DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for the virtual network.</span></span>  <span data-ttu-id="27b31-136">Si por algún motivo se cambia la configuración de DNS después de haber creado un entorno del Servicio de aplicaciones, los desarrolladores pueden forzar a un entorno del Servicio de aplicaciones para recoger la nueva configuración de DNS.</span><span class="sxs-lookup"><span data-stu-id="27b31-136">If for any reason the DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment to pick up the new DNS configuration.</span></span>  <span data-ttu-id="27b31-137">Si se desencadena un reinicio gradual del entorno mediante el icono de Reiniciar, ubicado en la parte superior de la hoja de administración del entorno de App Service en [Azure Portal][NewPortal], el entorno recogerá la nueva configuración de DNS.</span><span class="sxs-lookup"><span data-stu-id="27b31-137">Triggering a rolling environment reboot using the "Restart" icon located at the top of the App Service Environment management blade in the [Azure portal][NewPortal] will cause the environment to pick up the new DNS configuration.</span></span>

<span data-ttu-id="27b31-138">Los requisitos de acceso de red entrante se pueden cumplir mediante la configuración de un [grupo de seguridad de red][NetworkSecurityGroups] en la subred de App Service Environment, como se describe en este [artículo][requiredports].</span><span class="sxs-lookup"><span data-stu-id="27b31-138">The inbound network access requirements can be met by configuring a [network security group][NetworkSecurityGroups] on the App Service Environment's subnet to allow the required access as described in this [article][requiredports].</span></span>

## <a name="enabling-outbound-network-connectivity-for-an-app-service-environment"></a><span data-ttu-id="27b31-139">Habilitar la conectividad de red saliente para un entorno del Servicio de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="27b31-139">Enabling Outbound Network Connectivity for an App Service Environment</span></span>
<span data-ttu-id="27b31-140">De forma predeterminada, un circuito de ExpressRoute recién creado anuncia una ruta predeterminada que permite la conectividad saliente de Internet.</span><span class="sxs-lookup"><span data-stu-id="27b31-140">By default, a newly created ExpressRoute circuit advertises a default route that allows outbound Internet connectivity.</span></span>  <span data-ttu-id="27b31-141">Con esta configuración, un entorno del Servicio de aplicaciones podrá conectarse a otros extremos de Azure.</span><span class="sxs-lookup"><span data-stu-id="27b31-141">With this configuration an App Service Environment will be able to connect to other Azure endpoints.</span></span>

<span data-ttu-id="27b31-142">Sin embargo, una configuración de cliente común es definir su propia ruta predeterminada (0.0.0.0/0) que fuerza a que el tráfico saliente de Internet fluya a nivel local.</span><span class="sxs-lookup"><span data-stu-id="27b31-142">However a common customer configuration is to define their own default route (0.0.0.0/0) which forces outbound Internet traffic to instead flow on-premises.</span></span>  <span data-ttu-id="27b31-143">El flujo de tráfico interrumpe invariablemente entornos del Servicio de aplicaciones porque el tráfico saliente está bloqueado de forma local o NAT tendría un conjunto de direcciones irreconocibles que ya no funcionan con varios extremos de Azure.</span><span class="sxs-lookup"><span data-stu-id="27b31-143">This traffic flow invariably breaks App Service Environments because the outbound traffic is either blocked on-premises, or NAT'd to an unrecognizable set of addresses that no longer work with various Azure endpoints.</span></span>

<span data-ttu-id="27b31-144">La solución es definir una (o más) rutas definidas por el usuario (UDR) en la subred que contiene el entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-144">The solution is to define one (or more) user defined routes (UDRs) on the subnet that contains the App Service Environment.</span></span>  <span data-ttu-id="27b31-145">Una ruta definida por el usuario define las rutas de subred específica que se respetarán en lugar de la ruta predeterminada.</span><span class="sxs-lookup"><span data-stu-id="27b31-145">A UDR defines subnet-specific routes that will be honored instead of the default route.</span></span>

<span data-ttu-id="27b31-146">Si es posible, se recomienda usar la configuración siguiente:</span><span class="sxs-lookup"><span data-stu-id="27b31-146">If possible, it is recommended to use the following configuration:</span></span>

* <span data-ttu-id="27b31-147">La configuración de ExpressRoute anuncia 0.0.0.0/0 y, de manera predeterminada, fuerza la tunelización de todo el tráfico saliente a local.</span><span class="sxs-lookup"><span data-stu-id="27b31-147">The ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="27b31-148">La UDR aplicada a la subred que contiene el entorno del Servicio de aplicaciones define 0.0.0.0/0 con un tipo de salto siguiente de Internet (un ejemplo se muestra posteriormente en este artículo).</span><span class="sxs-lookup"><span data-stu-id="27b31-148">The UDR applied to the subnet containing the App Service Environment defines 0.0.0.0/0 with a next hop type of Internet (an example of this is farther down in this article).</span></span>

<span data-ttu-id="27b31-149">El efecto combinado de estos pasos es que la UDR a nivel de subred tendrá prioridad sobre la tunelización forzada de ExpressRoute, lo que garantiza el acceso a Internet saliente desde el entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-149">The combined effect of these steps is that the subnet level UDR will take precedence over the ExpressRoute forced tunneling, thus ensuring outbound Internet access from the App Service Environment.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="27b31-150">Las rutas definidas en una UDR **deben** ser lo suficientemente específicas como para que tengan prioridad sobre cualquier otra ruta anunciada por la configuración de ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="27b31-150">The routes defined in a UDR **must** be specific enough to  take precedence over any routes advertised by the ExpressRoute configuration.</span></span>  <span data-ttu-id="27b31-151">En el ejemplo siguiente se usa el intervalo de direcciones 0.0.0.0/0 amplio y como tal puede reemplazarse accidentalmente por los anuncios de ruta con intervalos de direcciones más específicos.</span><span class="sxs-lookup"><span data-stu-id="27b31-151">The example below uses the broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>
> 
> <span data-ttu-id="27b31-152">Las instancias de App Service Environment no son compatibles con las configuraciones de ExpressRoute que **anuncian rutas entre la ruta de acceso de los pares públicos y la ruta de acceso de los pares privados**.</span><span class="sxs-lookup"><span data-stu-id="27b31-152">App Service Environments are not supported with ExpressRoute configurations that **cross-advertise routes from the public peering path to the private peering path**.</span></span>  <span data-ttu-id="27b31-153">Las configuraciones de ExpressRoute con el emparejamiento público configurado recibirán anuncios de ruta de Microsoft para un amplio conjunto de intervalos de direcciones IP de Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="27b31-153">ExpressRoute configurations that have public peering configured, will receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span>  <span data-ttu-id="27b31-154">Si estos intervalos de direcciones se anuncian en la ruta de acceso de los pares privados, el resultado final es que se forzará la tunelización de todos los paquetes de red salientes desde la subred de App Service Environment a la infraestructura de red local de un cliente.</span><span class="sxs-lookup"><span data-stu-id="27b31-154">If these address ranges are cross-advertised on the private peering path, the end result is that all outbound network packets from the App Service Environment's subnet will be force-tunneled to a customer's on-premises network infrastructure.</span></span>  <span data-ttu-id="27b31-155">Actualmente, este flujo de red no es compatible con las instancias de App Service Environment.</span><span class="sxs-lookup"><span data-stu-id="27b31-155">This network flow is currently not supported with App Service Environments.</span></span>  <span data-ttu-id="27b31-156">La solución a este problema es dejar de anunciar rutas entre la ruta de acceso de los pares públicos y la ruta de acceso de los pares privados.</span><span class="sxs-lookup"><span data-stu-id="27b31-156">One solution to this problem is to stop cross-advertising routes from the public peering path to the private peering path.</span></span>
> 
> 

<span data-ttu-id="27b31-157">Se puede encontrar información de contexto sobre las rutas definidas por el usuario en esta [información general][UDROverview].</span><span class="sxs-lookup"><span data-stu-id="27b31-157">Background information on user defined routes is available in this [overview][UDROverview].</span></span>  

<span data-ttu-id="27b31-158">En esta [guía de procedimiento][UDRHowTo] se puede encontrar información acerca de la creación y configuración de rutas definidas por el usuario.</span><span class="sxs-lookup"><span data-stu-id="27b31-158">Details on creating and configuring user defined routes is available in this [How To Guide][UDRHowTo].</span></span>

## <a name="example-udr-configuration-for-an-app-service-environment"></a><span data-ttu-id="27b31-159">Ejemplo de configuración de rutas definidas por el usuario para un entorno del Servicio de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="27b31-159">Example UDR Configuration for an App Service Environment</span></span>
<span data-ttu-id="27b31-160">**Requisitos previos**</span><span class="sxs-lookup"><span data-stu-id="27b31-160">**Pre-requisites**</span></span>

1. <span data-ttu-id="27b31-161">Instale Azure PowerShell desde la [página de descargas de Azure][AzureDownloads] (fecha: junio de 2015 o posterior).</span><span class="sxs-lookup"><span data-stu-id="27b31-161">Install Azure Powershell from the [Azure Downloads page][AzureDownloads] (dated June 2015 or later).</span></span>  <span data-ttu-id="27b31-162">En "Herramientas de línea de comandos" hay un vínculo "Instalar" en "Windows Powershell" que instalará los cmdlets más recientes de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="27b31-162">Under "Command-line tools" there is an "Install" link under "Windows Powershell" that will install the latest Powershell cmdlets.</span></span>
2. <span data-ttu-id="27b31-163">Se recomienda crear una única subred para que el entorno del Servicio de aplicaciones lo utilice de manera exclusiva.</span><span class="sxs-lookup"><span data-stu-id="27b31-163">It is recommended that a unique subnet is created for exclusive use by an App Service Environment.</span></span>  <span data-ttu-id="27b31-164">Esto garantiza que las rutas definidas por el usuario aplicadas a la subred solo abrirán el tráfico saliente para el entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-164">This ensures that the UDRs applied to the subnet will only open outbound traffic for the App Service Environment.</span></span>
3. <span data-ttu-id="27b31-165">**Importante**: no implemente App Service Environment hasta **después** de haber completado los siguientes pasos de configuración.</span><span class="sxs-lookup"><span data-stu-id="27b31-165">**Important**:  do not deploy the App Service Environment until **after** the following configuration steps are followed.</span></span>  <span data-ttu-id="27b31-166">Esto garantiza que la conectividad de red saliente esté disponible antes de intentar implementar un entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-166">This ensures that outbound network connectivity is available before attempting to deploy an App Service Environment.</span></span>

<span data-ttu-id="27b31-167">**Paso 1: Crear una tabla de rutas con nombre**</span><span class="sxs-lookup"><span data-stu-id="27b31-167">**Step 1:  Create a named route table**</span></span>

<span data-ttu-id="27b31-168">El fragmento de código siguiente crea una tabla de ruta llamada "DirectInternetRouteTable" en la región Oeste de EE.UU. de Azure:</span><span class="sxs-lookup"><span data-stu-id="27b31-168">The following snippet creates a route table called "DirectInternetRouteTable" in the West US Azure region:</span></span>

    New-AzureRouteTable -Name 'DirectInternetRouteTable' -Location uswest

<span data-ttu-id="27b31-169">**Paso 2: Crear una o varias rutas en la tabla de rutas**</span><span class="sxs-lookup"><span data-stu-id="27b31-169">**Step 2:  Create one or more routes in the route table**</span></span>

<span data-ttu-id="27b31-170">Necesitará agregar una o varias rutas a la tabla de ruta para habilitar el acceso de salida a Internet.</span><span class="sxs-lookup"><span data-stu-id="27b31-170">You will need to add one or more routes to the route table in order to enable outbound Internet access.</span></span>  

<span data-ttu-id="27b31-171">El enfoque recomendado para configurar el acceso saliente a Internet es definir una ruta para 0.0.0.0/0, tal como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="27b31-171">The recommended approach for configuring outbound access to the Internet is to define a route for 0.0.0.0/0 as shown below.</span></span>

    Get-AzureRouteTable -Name 'DirectInternetRouteTable' | Set-AzureRoute -RouteName 'Direct Internet Range 0' -AddressPrefix 0.0.0.0/0 -NextHopType Internet

<span data-ttu-id="27b31-172">Recuerde que 0.0.0.0/0 es un intervalo de direcciones amplio y, como tal, lo reemplazarán intervalos de direcciones más específicos anunciados por ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="27b31-172">Remember that 0.0.0.0/0 is a broad address range, and as such will be overridden by more specific address ranges advertised by the ExpressRoute.</span></span>  <span data-ttu-id="27b31-173">Para repetir la recomendación anterior, debe usarse una UDR con una ruta 0.0.0.0/0 junto con una configuración de ExressRoute que solo anuncia 0.0.0.0/0 también.</span><span class="sxs-lookup"><span data-stu-id="27b31-173">To re-iterate the earlier recommendation, a UDR with a 0.0.0.0/0 route should be used in conjunction with an ExressRoute configuration that only advertises 0.0.0.0/0 as well.</span></span> 

<span data-ttu-id="27b31-174">Como alternativa, puede descargar una lista completa y actualizada de intervalos CIDR usados por Azure.</span><span class="sxs-lookup"><span data-stu-id="27b31-174">As an alternative, you can download a comprehensive and updated list of CIDR ranges in use by Azure.</span></span>  <span data-ttu-id="27b31-175">El archivo XML que contiene todos los intervalos de direcciones IP de Azure está disponible en el [Centro de descarga de Microsoft][DownloadCenterAddressRanges].</span><span class="sxs-lookup"><span data-stu-id="27b31-175">The Xml file containing all of the Azure IP address ranges is available from the [Microsoft Download Center][DownloadCenterAddressRanges].</span></span>  

<span data-ttu-id="27b31-176">Sin embargo, tenga en cuenta que estos intervalos cambian con el tiempo, por lo que se necesitan actualizaciones periódicas manuales de las rutas definidas por el usuario para conservar la sincronización.</span><span class="sxs-lookup"><span data-stu-id="27b31-176">Note though that these ranges change over time, thus necessitating periodic manual updates to the user defined routes to keep in sync.</span></span>  <span data-ttu-id="27b31-177">Además, como en una UDR individual hay un límite superior de 100 rutas, será preciso "resumir" los intervalos de direcciones IP de Azure para ajustarse a dicho límite, teniendo en cuenta que es necesario que las rutas de UDR definidas sean más específicas que las anunciadas por ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="27b31-177">Also, since there is a default upper limit of 100 routes in a single UDR, you will need to "summarize" the Azure IP address ranges to fit within the 100 route limit, keeping in mind that UDR defined routes need to be more specific than the routes advertised by your ExpressRoute.</span></span>  

<span data-ttu-id="27b31-178">**Paso 3: Asociar la tabla de rutas a la subred que contiene el entorno del Servicio de aplicaciones**</span><span class="sxs-lookup"><span data-stu-id="27b31-178">**Step 3:  Associate the route table to the subnet containing the App Service Environment**</span></span>

<span data-ttu-id="27b31-179">El último paso de la configuración es asociar la tabla de rutas a la subred en la que se implementará App Service Environment.</span><span class="sxs-lookup"><span data-stu-id="27b31-179">The last  configuration step is to associate the route table to the subnet where the App Service Environment will be deployed.</span></span>  <span data-ttu-id="27b31-180">El comando siguiente asocia "DirectInternetRouteTable" a la subred "ASESubnet" que, en última instancia, contendrá un entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-180">The following command associates the "DirectInternetRouteTable" to the "ASESubnet" that will eventually contain an App Service Environment.</span></span>

    Set-AzureSubnetRouteTable -VirtualNetworkName 'YourVirtualNetworkNameHere' -SubnetName 'ASESubnet' -RouteTableName 'DirectInternetRouteTable'


<span data-ttu-id="27b31-181">**Paso 4: Pasos finales**</span><span class="sxs-lookup"><span data-stu-id="27b31-181">**Step 4:  Final Steps**</span></span>

<span data-ttu-id="27b31-182">Una vez que la tabla de ruta está enlazada a la subred, se recomienda que primero pruebe y confirme el efecto deseado.</span><span class="sxs-lookup"><span data-stu-id="27b31-182">Once the route table is bound to the subnet, it is recommended to first test and confirm the intended effect.</span></span>  <span data-ttu-id="27b31-183">Por ejemplo, implemente una máquina virtual en la subred y confirme que:</span><span class="sxs-lookup"><span data-stu-id="27b31-183">For example, deploy a virtual machine into the subnet and confirm that:</span></span>

* <span data-ttu-id="27b31-184">El tráfico saliente a los puntos de conexión de Azure y los que no son de Azure mencionados anteriormente en este artículo **no** fluye de manera descendente al circuito de ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="27b31-184">Outbound traffic to both Azure and non-Azure endpoints mentioned earlier in this article is **not** flowing down the ExpressRoute circuit.</span></span>  <span data-ttu-id="27b31-185">Es muy importante comprobar este comportamiento, ya que si en el tráfico saliente de la subred se sigue forzando la tunelización local, siempre se producirá un error de creación del entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-185">It is very important to verify this behavior, since if outbound traffic from the subnet is still being forced tunneled on-premises, App Service Environment creation will always fail.</span></span> 
* <span data-ttu-id="27b31-186">Las búsquedas de DNS para los puntos de conexión mencionados anteriormente se están resolviendo correctamente.</span><span class="sxs-lookup"><span data-stu-id="27b31-186">DNS lookups for the endpoints mentioned earlier are all resolving properly.</span></span> 

<span data-ttu-id="27b31-187">Una vez confirmados los pasos anteriores, deberá eliminar la máquina virtual porque la subred debe estar "vacía" en el momento en que se crea el entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-187">Once the above steps are confirmed, you will need to delete the virtual machine because the subnet needs to be "empty" at the time the App Service Environment is created.</span></span>

<span data-ttu-id="27b31-188">Ahora, ya puede continuar con la creación de un entorno del Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="27b31-188">Then proceed with creating an App Service Environment!</span></span>

## <a name="getting-started"></a><span data-ttu-id="27b31-189">Introducción</span><span class="sxs-lookup"><span data-stu-id="27b31-189">Getting started</span></span>
<span data-ttu-id="27b31-190">Todos los artículos y procedimientos para los entornos del Servicio de aplicaciones están disponibles en el archivo [Léame para entornos del Servicio de aplicaciones](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="27b31-190">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="27b31-191">Para empezar a trabajar con los entornos de App Service, consulte [Introducción al entorno de App Service][IntroToAppServiceEnvironment].</span><span class="sxs-lookup"><span data-stu-id="27b31-191">To get started with App Service Environments, see [Introduction to App Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="27b31-192">Para obtener más información sobre la plataforma Azure App Service, consulte [Azure App Service][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="27b31-192">For more information about the Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

<!-- LINKS -->
[virtualnetwork]: http://azure.microsoft.com/services/virtual-network/
[ExpressRoute]: http://azure.microsoft.com/services/expressroute/
[requiredports]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-control-inbound-traffic/
[NetworkSecurityGroups]: http://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[UDROverview]: http://azure.microsoft.com/documentation/articles/virtual-networks-udr-overview/
[UDRHowTo]: http://azure.microsoft.com/documentation/articles/virtual-networks-udr-how-to/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[AzureDownloads]: http://azure.microsoft.com/en-us/downloads/ 
[DownloadCenterAddressRanges]: http://www.microsoft.com/download/details.aspx?id=41653  
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[NewPortal]:  https://portal.azure.com


<!-- IMAGES -->
