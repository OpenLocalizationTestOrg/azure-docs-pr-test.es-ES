---
title: "Escala distribuida geográficamente con entornos de Servicio de aplicaciones"
description: "Aprenda a escalar aplicaciones horizontalmente con distribución geográfica con el Administrador de tráfico y los entornos de Servicio de aplicaciones."
services: app-service
documentationcenter: 
author: stefsch
manager: erikre
editor: 
ms.assetid: c1b05ca8-3703-4d87-a9ae-819d741787fb
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/07/2016
ms.author: stefsch
ms.openlocfilehash: 505301b2650c9b8bafdad352055f30e55148ab0c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="geo-distributed-scale-with-app-service-environments"></a><span data-ttu-id="d19de-103">Escala distribuida geográficamente con entornos de Servicio de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="d19de-103">Geo Distributed Scale with App Service Environments</span></span>
## <a name="overview"></a><span data-ttu-id="d19de-104">Información general</span><span class="sxs-lookup"><span data-stu-id="d19de-104">Overview</span></span>
<span data-ttu-id="d19de-105">Aquellos escenarios de aplicaciones que requieren una escala muy elevada pueden superar la capacidad de recursos de proceso disponible para una sola implementación de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="d19de-105">Application scenarios which require very high scale can exceed the compute resource capacity available to a single deployment of an app.</span></span>  <span data-ttu-id="d19de-106">Algunos ejemplos de los escenarios que requieren una escala extremadamente alta son las aplicaciones de votación, los acontecimientos deportivos y los espectáculos televisados.</span><span class="sxs-lookup"><span data-stu-id="d19de-106">Voting applications, sporting events, and televised entertainment events are all examples of scenarios that require extremely high scale.</span></span> <span data-ttu-id="d19de-107">Se pueden cumplir los requisitos de gran escala mediante el escalado horizontal de las aplicaciones, con la realización de varias implementaciones de la aplicación en una única región, así como entre regiones, para afrontar los requisitos extremos de carga.</span><span class="sxs-lookup"><span data-stu-id="d19de-107">High scale requirements can be met by horizontally scaling out apps, with multiple app deployments being made within a single region, as well as across regions, to handle extreme load requirements.</span></span>

<span data-ttu-id="d19de-108">Los entornos de Servicio de aplicaciones son una plataforma ideal para el escalado horizontal.</span><span class="sxs-lookup"><span data-stu-id="d19de-108">App Service Environments are an ideal platform for horizontal scale out.</span></span>  <span data-ttu-id="d19de-109">Una vez seleccionado una configuración de entorno de Servicio de aplicaciones que admita una tasa de solicitudes conocida, los desarrolladores pueden implementar más entornos de Servicio de aplicaciones a modo de "plantilla" para lograr una capacidad de carga máxima deseada.</span><span class="sxs-lookup"><span data-stu-id="d19de-109">Once an App Service Environment configuration has been selected that can support a known request rate, developers can deploy additional App Service Environments in "cookie cutter" fashion to attain a desired peak load capacity.</span></span>

<span data-ttu-id="d19de-110">Por ejemplo, imagine una aplicación que se ejecuta en una configuración de entorno de Servicio de aplicaciones y en la que se probó el procesamiento de 20.000 solicitudes por segundo (RPS).</span><span class="sxs-lookup"><span data-stu-id="d19de-110">For example suppose an app running on an App Service Environment configuration has been tested to handle 20K requests per second (RPS).</span></span>  <span data-ttu-id="d19de-111">Si la capacidad de carga máxima deseada es 100.000 RPS, se pueden crear y configurar cinco (5) entornos de Servicio de aplicaciones para asegurarse de que la aplicación pueda afrontar la carga máxima prevista.</span><span class="sxs-lookup"><span data-stu-id="d19de-111">If the desired peak load capacity is 100K RPS, then five (5) App Service Environments can be created and configured to ensure the application can handle the maximum projected load.</span></span>

<span data-ttu-id="d19de-112">Puesto que los clientes suelen acceder a las aplicaciones mediante un dominio personalizado (o mnemónico), los desarrolladores necesitan una forma de distribuir las solicitudes de aplicaciones a todas las instancias del entorno de Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d19de-112">Since customers typically access apps using a custom (or vanity) domain, developers need a way to distribute app requests across all of the App Service Environment instances.</span></span>  <span data-ttu-id="d19de-113">Una excelente manera de lograr esto es resolver el dominio personalizado con un [perfil de Traffic Manager de Azure][AzureTrafficManagerProfile].</span><span class="sxs-lookup"><span data-stu-id="d19de-113">A great way to accomplish this is to resolve the custom domain using an [Azure Traffic Manager profile][AzureTrafficManagerProfile].</span></span>  <span data-ttu-id="d19de-114">El perfil de Traffic Manager puede configurarse para que apunte a todos los entornos de Servicio de aplicaciones individuales.</span><span class="sxs-lookup"><span data-stu-id="d19de-114">The Traffic Manager profile can be configured to point at all of the individual App Service Environments.</span></span>  <span data-ttu-id="d19de-115">Traffic Manager controlará automáticamente la distribución de los clientes por todos los entornos de Servicio de aplicaciones en función de la configuración de equilibrio de carga en el perfil de Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="d19de-115">Traffic Manager will automatically handle distributing customers across all of the App Service Environments based on the load balancing settings in the Traffic Manager profile.</span></span>  <span data-ttu-id="d19de-116">Este enfoque funciona independientemente de si todos los entornos de Servicio de aplicaciones están implementados en una sola región de Azure o en varias regiones de Azure del mundo.</span><span class="sxs-lookup"><span data-stu-id="d19de-116">This approach works regardless of whether all of the App Service Environments are deployed in a single Azure region, or deployed worldwide across multiple Azure regions.</span></span>

<span data-ttu-id="d19de-117">Además, como los clientes acceden a las aplicaciones a través del dominio mnemónico, desconocen el número de entornos de Servicio de aplicaciones que ejecutan una aplicación.</span><span class="sxs-lookup"><span data-stu-id="d19de-117">Furthermore, since customers access apps through the vanity domain, customers are unaware of the number of App Service Environments running an app.</span></span>  <span data-ttu-id="d19de-118">Como resultado, los desarrolladores pueden agregar y quitar rápida y fácilmente entornos de Servicio de aplicaciones según la carga de tráfico observada.</span><span class="sxs-lookup"><span data-stu-id="d19de-118">As a result developers can quickly and easily add, and remove, App Service Environments based on observed traffic load.</span></span>

<span data-ttu-id="d19de-119">En el siguiente diagrama conceptual, se muestra una aplicación escalada horizontalmente en tres entornos de Servicio de aplicaciones en una única región.</span><span class="sxs-lookup"><span data-stu-id="d19de-119">The conceptual diagram below depicts an app horizontally scaled out across three App Service Environments within a single region.</span></span>

![Arquitectura conceptual][ConceptualArchitecture] 

<span data-ttu-id="d19de-121">El resto de este tema lo guía por los pasos necesarios para configurar una topología distribuida para la aplicación de ejemplo usando varios entornos de App Service.</span><span class="sxs-lookup"><span data-stu-id="d19de-121">The remainder of this topic walks through the steps involved with setting up a distributed topology for the sample app using multiple App Service Environments.</span></span>

## <a name="planning-the-topology"></a><span data-ttu-id="d19de-122">Planeación de la topología</span><span class="sxs-lookup"><span data-stu-id="d19de-122">Planning the Topology</span></span>
<span data-ttu-id="d19de-123">Antes de crear la superficie de una aplicación distribuida, resulta útil tener algunos datos con antelación.</span><span class="sxs-lookup"><span data-stu-id="d19de-123">Before building out a distributed app footprint, it helps to have a few pieces information ahead of time.</span></span>

* <span data-ttu-id="d19de-124">**Dominio personalizado de la aplicación:** ¿cuál es el nombre del dominio personalizado que los clientes van a usar para acceder a la aplicación?</span><span class="sxs-lookup"><span data-stu-id="d19de-124">**Custom domain for the app:**  What is the custom domain name that customers will use to access the app?</span></span>  <span data-ttu-id="d19de-125">Para la aplicación de ejemplo, el nombre de dominio personalizado es *www.scalableasedemo.com*</span><span class="sxs-lookup"><span data-stu-id="d19de-125">For the sample app the custom domain name is *www.scalableasedemo.com*</span></span>
* <span data-ttu-id="d19de-126">**Dominio del Administrador de tráfico:** se debe elegir un nombre de dominio al crear un [perfil de Traffic Manager de Azure][AzureTrafficManagerProfile].</span><span class="sxs-lookup"><span data-stu-id="d19de-126">**Traffic Manager domain:**  A domain name needs to be chosen when creating an [Azure Traffic Manager profile][AzureTrafficManagerProfile].</span></span>  <span data-ttu-id="d19de-127">Este nombre se combinará con el sufijo *trafficmanager.net* para registrar una entrada de dominio que es administrada por el Administrador de tráfico.</span><span class="sxs-lookup"><span data-stu-id="d19de-127">This name will be combined with the *trafficmanager.net* suffix to register a domain entry that is managed by Traffic Manager.</span></span>  <span data-ttu-id="d19de-128">Para la aplicación de ejemplo, el nombre elegido es *scalable-ase-demo*.</span><span class="sxs-lookup"><span data-stu-id="d19de-128">For the sample app, the name chosen is *scalable-ase-demo*.</span></span>  <span data-ttu-id="d19de-129">Como resultado, el nombre de dominio completo administrado por el Administrador de tráfico es *scalable-ase-demo.trafficmanager.net*.</span><span class="sxs-lookup"><span data-stu-id="d19de-129">As a result the full domain name that is managed by Traffic Manager is *scalable-ase-demo.trafficmanager.net*.</span></span>
* <span data-ttu-id="d19de-130">**Estrategia para escalar la superficie de la aplicación**: ¿se va a distribuir la superficie de la aplicación entre varias instancias de App Service Environment de una sola región?</span><span class="sxs-lookup"><span data-stu-id="d19de-130">**Strategy for scaling the app footprint:**  Will the application footprint be distributed across multiple App Service Environments in a single region?</span></span>  <span data-ttu-id="d19de-131">¿Varias regiones?</span><span class="sxs-lookup"><span data-stu-id="d19de-131">Multiple regions?</span></span>  <span data-ttu-id="d19de-132">¿Una combinación de ambos enfoques?</span><span class="sxs-lookup"><span data-stu-id="d19de-132">A mix-and-match of both approaches?</span></span>  <span data-ttu-id="d19de-133">La decisión debería basarse en las expectativas de dónde se vaya a originar el tráfico del cliente, así como también en la medida en que el resto de la infraestructura de back-end de apoyo de una aplicación pueda escalarse.</span><span class="sxs-lookup"><span data-stu-id="d19de-133">The decision should be based on expectations of where customer traffic will originate, as well as how well the rest of an app's supporting back-end infrastructure can scale.</span></span>  <span data-ttu-id="d19de-134">Por ejemplo, con una aplicación totalmente sin estado, se puede escalar una aplicación de forma masiva mediante una combinación de varias instancias de App Service Environment por región de Azure, multiplicados por más instancias de App Service Environment implementadas en varias regiones de Azure.</span><span class="sxs-lookup"><span data-stu-id="d19de-134">For example, with a 100% stateless application, an app can be massively scaled using a combination of multiple App Service Environments per Azure region,  multiplied by App Service Environments deployed across multiple Azure regions.</span></span>  <span data-ttu-id="d19de-135">Con más de 15 regiones de Azure públicas entre las que elegir, los clientes pueden realmente crear una superficie de aplicación de gran escala en todo el mundo.</span><span class="sxs-lookup"><span data-stu-id="d19de-135">With 15+ public Azure regions available to choose from, customers can truly build a world-wide hyper-scale application footprint.</span></span>  <span data-ttu-id="d19de-136">Para la aplicación de ejemplo usada en este artículo, se crearon tres entornos de Servicio de aplicaciones en una sola región de Azure (Centro y Sur de EE. UU.).</span><span class="sxs-lookup"><span data-stu-id="d19de-136">For the sample app used for this article, three App Service Environments were created in a single Azure region (South Central US).</span></span>
* <span data-ttu-id="d19de-137">**Convención de nomenclatura para las instancias de App Service Environment:** cada instancia de App Service Environment requiere un nombre único.</span><span class="sxs-lookup"><span data-stu-id="d19de-137">**Naming convention for the App Service Environments:**  Each App Service Environment requires a unique name.</span></span>  <span data-ttu-id="d19de-138">Si existen más de uno o dos entornos de Servicio de aplicaciones, resulta útil disponer de una convención de nomenclatura para ayudar a identificar cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="d19de-138">Beyond one or two App Service Environments it is helpful to have a naming convention to help identify each App Service Environment.</span></span>  <span data-ttu-id="d19de-139">Para la aplicación de ejemplo, se usó una convención de nomenclatura sencilla.</span><span class="sxs-lookup"><span data-stu-id="d19de-139">For the sample app a simple naming convention was used.</span></span>  <span data-ttu-id="d19de-140">Los nombres de las tres instancias de App Service Environment son *fe1ase*, *fe2ase* y *fe3ase*.</span><span class="sxs-lookup"><span data-stu-id="d19de-140">The names of the three App Service Environments are *fe1ase*, *fe2ase*, and *fe3ase*.</span></span>
* <span data-ttu-id="d19de-141">**Convención de nomenclatura para las aplicaciones:** como se van a  implementar varias instancias de la aplicación, se necesita un nombre para cada instancia de la aplicación implementada.</span><span class="sxs-lookup"><span data-stu-id="d19de-141">**Naming convention for the apps:**  Since multiple instances of the app will be deployed, a name is needed for each instance of the deployed app.</span></span>  <span data-ttu-id="d19de-142">Una característica poco conocida pero muy cómoda de los entornos de Servicio de aplicaciones es que se puede usar el mismo nombre de aplicación en varios entornos de Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d19de-142">One little-known but very convenient feature of App Service Environments is that the same app name can be used across multiple App Service Environments.</span></span>  <span data-ttu-id="d19de-143">Dado que cada entorno de Servicio de aplicaciones tiene un sufijo de dominio único, los desarrolladores pueden reutilizar el mismo nombre de aplicación en cada entorno.</span><span class="sxs-lookup"><span data-stu-id="d19de-143">Since each App Service Environment has a unique domain suffix, developers can choose to re-use the exact same app name in each environment.</span></span>  <span data-ttu-id="d19de-144">Por ejemplo, un desarrollador podría asignar los siguientes nombres a las aplicaciones:*myapp.foo1.p.azurewebsites.net*, *myapp.foo2.p.azurewebsites.net*, *myapp.foo3.p.azurewebsites.net, etc*.  No obstante, para la aplicación de ejemplo, cada instancia tiene un nombre único.</span><span class="sxs-lookup"><span data-stu-id="d19de-144">For example a developer could have apps named as follows:  *myapp.foo1.p.azurewebsites.net*, *myapp.foo2.p.azurewebsites.net*, *myapp.foo3.p.azurewebsites.net*, etc.  For the sample app though each app instance also has a unique name.</span></span>  <span data-ttu-id="d19de-145">Los nombres de las instancias de aplicación usados son *webfrontend1*, *webfrontend2* y *webfrontend3*.</span><span class="sxs-lookup"><span data-stu-id="d19de-145">The app instance names used are *webfrontend1*, *webfrontend2*, and *webfrontend3*.</span></span>

## <a name="setting-up-the-traffic-manager-profile"></a><span data-ttu-id="d19de-146">Configuración de un perfil del Administrador de tráfico</span><span class="sxs-lookup"><span data-stu-id="d19de-146">Setting up the Traffic Manager Profile</span></span>
<span data-ttu-id="d19de-147">Una vez que se implementan varias instancias de una aplicación en varias instancias de App Service Environment, las instancias de aplicación individuales se pueden registrar en Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="d19de-147">Once multiple instances of an app are deployed on multiple App Service Environments, the  individual app instances can be registered with Traffic Manager.</span></span>  <span data-ttu-id="d19de-148">Para la aplicación de ejemplo, se necesita un perfil del Administrador de tráfico para *scalable-ase-demo.trafficmanager.net* que pueda enrutar a los clientes a cualquiera de las siguientes instancias de la aplicación implementadas:</span><span class="sxs-lookup"><span data-stu-id="d19de-148">For the sample app a Traffic Manager profile is needed for *scalable-ase-demo.trafficmanager.net* that can route customers to any of the following deployed app instances:</span></span>

* <span data-ttu-id="d19de-149">**webfrontend1.fe1ase.p.azurewebsites.net:** una instancia de la aplicación de ejemplo que se implementa en la primera instancia de App Service Environment.</span><span class="sxs-lookup"><span data-stu-id="d19de-149">**webfrontend1.fe1ase.p.azurewebsites.net:**  An instance of the sample app deployed on the first App Service Environment.</span></span>
* <span data-ttu-id="d19de-150">**webfrontend2.fe2ase.p.azurewebsites.net:** una instancia de la aplicación de ejemplo que se implementa en la segunda instancia de App Service Environment.</span><span class="sxs-lookup"><span data-stu-id="d19de-150">**webfrontend2.fe2ase.p.azurewebsites.net:**  An instance of the sample app deployed on the second App Service Environment.</span></span>
* <span data-ttu-id="d19de-151">**webfrontend3.fe3ase.p.azurewebsites.net:** una instancia de la aplicación de ejemplo que se implementa en la tercera instancia de App Service Environment.</span><span class="sxs-lookup"><span data-stu-id="d19de-151">**webfrontend3.fe3ase.p.azurewebsites.net:**  An instance of the sample app deployed on the third App Service Environment.</span></span>

<span data-ttu-id="d19de-152">La forma más sencilla de registrar varios puntos de conexión de Azure App Service, todos los cuales se ejecutan en la **misma** región de Azure, es usando la [compatibilidad de Azure Resource Manager con Traffic Manager de Azure][ARMTrafficManager].</span><span class="sxs-lookup"><span data-stu-id="d19de-152">The easiest way to register multiple Azure App Service endpoints, all running in the **same** Azure region, is with the Powershell [Azure Resource Manager Traffic Manager support][ARMTrafficManager].</span></span>  

<span data-ttu-id="d19de-153">El primer paso consiste en crear un perfil del Administrador de tráfico de Azure.</span><span class="sxs-lookup"><span data-stu-id="d19de-153">The first step is to create an Azure Traffic Manager profile.</span></span>  <span data-ttu-id="d19de-154">El código siguiente muestra cómo se creó el perfil para la aplicación de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d19de-154">The code below shows how the profile was created for the sample app:</span></span>

    $profile = New-AzureTrafficManagerProfile –Name scalableasedemo -ResourceGroupName yourRGNameHere -TrafficRoutingMethod Weighted -RelativeDnsName scalable-ase-demo -Ttl 30 -MonitorProtocol HTTP -MonitorPort 80 -MonitorPath "/"

<span data-ttu-id="d19de-155">Observe la forma en que el parámetro *RelativeDnsName* se ha establecido en *scalable-ase-demo*.</span><span class="sxs-lookup"><span data-stu-id="d19de-155">Notice how the *RelativeDnsName* parameter was set to *scalable-ase-demo*.</span></span>  <span data-ttu-id="d19de-156">Así es cómo se crea el nombre de dominio *scalable-ase-demo.trafficmanager.net* y se asocia con un perfil del Administrador de tráfico.</span><span class="sxs-lookup"><span data-stu-id="d19de-156">This is how the domain name *scalable-ase-demo.trafficmanager.net* is created and associated with a Traffic Manager profile.</span></span>

<span data-ttu-id="d19de-157">El parámetro *TrafficRoutingMethod* define la directiva de equilibrio de carga que el Administrador de tráfico usará para determinar cómo distribuir la carga de los clientes entre todos los extremos disponibles.</span><span class="sxs-lookup"><span data-stu-id="d19de-157">The *TrafficRoutingMethod* parameter defines the load balancing policy Traffic Manager will use to determine how to spread customer load across all of the available endpoints.</span></span>  <span data-ttu-id="d19de-158">En este ejemplo, se eligió el método *Weighted* .</span><span class="sxs-lookup"><span data-stu-id="d19de-158">In this example the *Weighted* method was chosen.</span></span>  <span data-ttu-id="d19de-159">Como resultado, las solicitudes de clientes se distribuirán entre todos los extremos de la aplicación registrados en función de las ponderaciones relativas asociadas con cada extremo.</span><span class="sxs-lookup"><span data-stu-id="d19de-159">This will result in customer requests being spread across all of the registered application endpoints based on the relative weights associated with each endpoint.</span></span> 

<span data-ttu-id="d19de-160">Con el perfil creado, se agrega cada instancia de la aplicación al perfil como un punto de conexión nativo de Azure.</span><span class="sxs-lookup"><span data-stu-id="d19de-160">With the profile created, each app instance is added to the profile as a native Azure endpoint.</span></span>  <span data-ttu-id="d19de-161">El código siguiente recupera una referencia a cada aplicación web front-end y, luego, agrega cada aplicación como un punto de conexión del Administrador de tráfico por medio del parámetro *TargetResourceId* .</span><span class="sxs-lookup"><span data-stu-id="d19de-161">The code below fetches a reference to each front end web app, and then adds each app as a Traffic Manager endpoint by way of the *TargetResourceId* parameter.</span></span>

    $webapp1 = Get-AzureRMWebApp -Name webfrontend1
    Add-AzureTrafficManagerEndpointConfig –EndpointName webfrontend1 –TrafficManagerProfile $profile –Type AzureEndpoints -TargetResourceId $webapp1.Id –EndpointStatus Enabled –Weight 10

    $webapp2 = Get-AzureRMWebApp -Name webfrontend2
    Add-AzureTrafficManagerEndpointConfig –EndpointName webfrontend2 –TrafficManagerProfile $profile –Type AzureEndpoints -TargetResourceId $webapp2.Id –EndpointStatus Enabled –Weight 10

    $webapp3 = Get-AzureRMWebApp -Name webfrontend3
    Add-AzureTrafficManagerEndpointConfig –EndpointName webfrontend3 –TrafficManagerProfile $profile –Type AzureEndpoints -TargetResourceId $webapp3.Id –EndpointStatus Enabled –Weight 10

    Set-AzureTrafficManagerProfile –TrafficManagerProfile $profile

<span data-ttu-id="d19de-162">Observe que existe una llamada a *Add-AzureTrafficManagerEndpointConfig* para cada instancia de aplicación individual.</span><span class="sxs-lookup"><span data-stu-id="d19de-162">Notice how there is one call to *Add-AzureTrafficManagerEndpointConfig* for each individual app instance.</span></span>  <span data-ttu-id="d19de-163">El parámetro *TargetResourceId* de cada comando de Powershell hace referencia a una de las tres instancias de la aplicación implementada.</span><span class="sxs-lookup"><span data-stu-id="d19de-163">The *TargetResourceId* parameter in each Powershell command references one of the three deployed app instances.</span></span>  <span data-ttu-id="d19de-164">El perfil de Traffic Manager repartirá la carga entre los tres puntos de conexión registrados en el perfil.</span><span class="sxs-lookup"><span data-stu-id="d19de-164">The Traffic Manager profile will spread load across all three endpoints registered in the profile.</span></span>

<span data-ttu-id="d19de-165">Los tres extremos usan el mismo valor (10) para el parámetro *Weight* .</span><span class="sxs-lookup"><span data-stu-id="d19de-165">All of the three endpoints use the same value (10) for the *Weight* parameter.</span></span>  <span data-ttu-id="d19de-166">Como resultado, el Administrador de tráfico distribuye las solicitudes de los clientes entre las tres instancias de la aplicación de forma relativamente uniforme.</span><span class="sxs-lookup"><span data-stu-id="d19de-166">This results in Traffic Manager spreading customer requests across all three app instances relatively evenly.</span></span> 

## <a name="pointing-the-apps-custom-domain-at-the-traffic-manager-domain"></a><span data-ttu-id="d19de-167">Hacer que el dominio personalizado de la aplicación apunte al dominio del Administrador de tráfico</span><span class="sxs-lookup"><span data-stu-id="d19de-167">Pointing the App's Custom Domain at the Traffic Manager Domain</span></span>
<span data-ttu-id="d19de-168">El último paso necesario es hacer que el dominio personalizado de la aplicación apunte al dominio del Administrador de tráfico.</span><span class="sxs-lookup"><span data-stu-id="d19de-168">The final step necessary is to point the custom domain of the app at the Traffic Manager domain.</span></span>  <span data-ttu-id="d19de-169">En el caso de la aplicación de ejemplo, esto significa que debe apuntar a *www.scalableasedemo.com* en *scalable-ase-demo.trafficmanager.net*.</span><span class="sxs-lookup"><span data-stu-id="d19de-169">For the sample app this means pointing *www.scalableasedemo.com* at *scalable-ase-demo.trafficmanager.net*.</span></span>  <span data-ttu-id="d19de-170">Este paso se debe completar con el registrador de dominios que administra el dominio personalizado.</span><span class="sxs-lookup"><span data-stu-id="d19de-170">This step needs to be completed with the domain registrar that manages the custom domain.</span></span>  

<span data-ttu-id="d19de-171">Usando las herramientas de administración de dominios del registrador, se debe crear un registro CNAME que apunte al dominio personalizado en el dominio del Administrador de tráfico.</span><span class="sxs-lookup"><span data-stu-id="d19de-171">Using your registrar's domain management tools, a CNAME records needs to be created which points the custom domain at the Traffic Manager domain.</span></span>  <span data-ttu-id="d19de-172">En la figura siguiente se muestra un ejemplo de esta configuración de CNAME:</span><span class="sxs-lookup"><span data-stu-id="d19de-172">The picture below shows an example of what this CNAME configuration looks like:</span></span>

![CNAME para el dominio personalizado][CNAMEforCustomDomain] 

<span data-ttu-id="d19de-174">Aunque no se trata en este tema, recuerde que cada instancia de aplicación individual debe tener el dominio personalizado registrado con ella también.</span><span class="sxs-lookup"><span data-stu-id="d19de-174">Although not covered in this topic, remember that each individual app instance needs to have the custom domain registered with it as well.</span></span>  <span data-ttu-id="d19de-175">De lo contrario, si una solicitud llega a una instancia de la aplicación y la aplicación no tiene el dominio personalizado registrado con la aplicación, la solicitud producirá un error.</span><span class="sxs-lookup"><span data-stu-id="d19de-175">Otherwise if a request makes it to an app instance, and the application does not have the custom domain registered with the app, the request will fail.</span></span>  

<span data-ttu-id="d19de-176">En este ejemplo, el dominio personalizado es *www.scalableasedemo.com*y cada instancia de la aplicación tiene el dominio personalizado asociado con él.</span><span class="sxs-lookup"><span data-stu-id="d19de-176">In this example the custom domain is *www.scalableasedemo.com*, and each application instance has the custom domain associated with it.</span></span>

![Dominio personalizado][CustomDomain] 

<span data-ttu-id="d19de-178">Como resumen del registro de un dominio personalizado con las aplicaciones de Azure App Service, consulte el siguiente artículo sobre el [registro de dominios personalizados][RegisterCustomDomain].</span><span class="sxs-lookup"><span data-stu-id="d19de-178">For a recap of of registering a custom domain with Azure App Service apps, see the following article on [registering custom domains][RegisterCustomDomain].</span></span>

## <a name="trying-out-the-distributed-topology"></a><span data-ttu-id="d19de-179">Prueba de la topología distribuida</span><span class="sxs-lookup"><span data-stu-id="d19de-179">Trying out the Distributed Topology</span></span>
<span data-ttu-id="d19de-180">El resultado final de la configuración del Administrador de tráfico y de DNS es que las solicitudes de *www.scalableasedemo.com* fluirán en la siguiente secuencia:</span><span class="sxs-lookup"><span data-stu-id="d19de-180">The end result of the Traffic Manager and DNS configuration is that requests for *www.scalableasedemo.com* will flow through the following sequence:</span></span>

1. <span data-ttu-id="d19de-181">Un dispositivo o explorador realizará una búsqueda DNS de *www.scalableasedemo.com*</span><span class="sxs-lookup"><span data-stu-id="d19de-181">A browser or device will make a DNS lookup for *www.scalableasedemo.com*</span></span>
2. <span data-ttu-id="d19de-182">La entrada CNAME en el registrador de dominios hace que la búsqueda DNS se redirija al Administrador de tráfico de Azure.</span><span class="sxs-lookup"><span data-stu-id="d19de-182">The CNAME entry at the domain registrar causes the DNS lookup to be redirected to Azure Traffic Manager.</span></span>
3. <span data-ttu-id="d19de-183">Se realiza una búsqueda DNS de *scalable-ase-demo.trafficmanager.net* en uno de los servidores DNS del Administrador de tráfico de Azure.</span><span class="sxs-lookup"><span data-stu-id="d19de-183">A DNS lookup is made for *scalable-ase-demo.trafficmanager.net* against one of the Azure Traffic Manager DNS servers.</span></span>
4. <span data-ttu-id="d19de-184">Según la directiva de equilibrio de carga (el parámetro *TrafficRoutingMethod* usado antes al crear el perfil del Administrador de tráfico), el Administrador de tráfico seleccionará uno de los extremos configurados y devolverá el FQDN de ese extremo al explorador o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d19de-184">Based on the load balancing policy (the *TrafficRoutingMethod* parameter used earlier when creating the Traffic Manager profile), Traffic Manager will select one of the configured endpoints and return the FQDN of that endpoint to the browser or device.</span></span>
5. <span data-ttu-id="d19de-185">Dado que el FQDN del extremo es la dirección URL de una instancia de la aplicación que se ejecuta en un entorno de Servicio de aplicaciones, el explorador o el dispositivo pedirá a un servidor DNS de Microsoft Azure que resuelva el FQDN en una dirección IP.</span><span class="sxs-lookup"><span data-stu-id="d19de-185">Since the FQDN of the endpoint is the Url of an app instance running on an App Service Environment, the browser or device will ask a Microsoft Azure DNS server to resolve the FQDN to an IP address.</span></span> 
6. <span data-ttu-id="d19de-186">El explorador o el dispositivo enviará la solicitud HTTP/S a la dirección IP.</span><span class="sxs-lookup"><span data-stu-id="d19de-186">The browser or device will send the HTTP/S request to the IP address.</span></span>  
7. <span data-ttu-id="d19de-187">La solicitud llegará a una de las instancias de la aplicación que se ejecutan en uno de los entornos de Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d19de-187">The request will arrive at one of the app instances running on one of the App Service Environments.</span></span>

<span data-ttu-id="d19de-188">En la imagen de consola siguiente, se muestra una búsqueda DNS para el dominio personalizado de la aplicación de ejemplo que se ha resuelto correctamente en una instancia de la aplicación que se ejecuta en uno de los tres entornos de Servicio de aplicaciones (en este caso, el segundo de los tres):</span><span class="sxs-lookup"><span data-stu-id="d19de-188">The console picture below shows a DNS lookup for the sample app's custom domain successfully resolving to an app instance running on one of the three sample App Service Environments (in this case the second of the three App Service Environments):</span></span>

![Búsqueda DNS][DNSLookup] 

## <a name="additional-links-and-information"></a><span data-ttu-id="d19de-190">Información y vínculos adicionales</span><span class="sxs-lookup"><span data-stu-id="d19de-190">Additional Links and Information</span></span>
<span data-ttu-id="d19de-191">Todos los artículos y procedimientos para los entornos del Servicio de aplicaciones están disponibles en el archivo [Léame para entornos del Servicio de aplicaciones](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="d19de-191">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="d19de-192">Documentación sobre [compatibilidad de Azure Resource Manager con Traffic Manager de Azure][ARMTrafficManager].</span><span class="sxs-lookup"><span data-stu-id="d19de-192">Documentation on the Powershell [Azure Resource Manager Traffic Manager support][ARMTrafficManager].</span></span>  

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[AzureTrafficManagerProfile]: ../traffic-manager/traffic-manager-manage-profiles.md
[ARMTrafficManager]: ../traffic-manager/traffic-manager-powershell-arm.md
[RegisterCustomDomain]: app-service-web-tutorial-custom-domain.md


<!-- IMAGES -->
[ConceptualArchitecture]: ./media/app-service-app-service-environment-geo-distributed-scale/ConceptualArchitecture-1.png
[CNAMEforCustomDomain]:  ./media/app-service-app-service-environment-geo-distributed-scale/CNAMECustomDomain-1.png
[DNSLookup]:  ./media/app-service-app-service-environment-geo-distributed-scale/DNSLookup-1.png
[CustomDomain]:  ./media/app-service-app-service-environment-geo-distributed-scale/CustomDomain-1.png 
