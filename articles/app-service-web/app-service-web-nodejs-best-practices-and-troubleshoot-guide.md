---
title: "Guía de procedimientos recomendados y solución de problemas para aplicaciones Node en Aplicaciones web de Azure"
description: "Aprenda los procedimientos recomendados y los pasos de solución de problemas para aplicaciones Node en Aplicaciones web de Azure."
services: app-service\web
documentationcenter: nodejs
author: ranjithr
manager: wadeh
editor: 
ms.assetid: 387ea217-7910-4468-8987-9a1022a99bef
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 06/06/2016
ms.author: ranjithr
ms.openlocfilehash: d820ef3438e13332657641b06b57fa277e79f811
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="best-practices-and-troubleshooting-guide-for-node-applications-on-azure-web-apps"></a><span data-ttu-id="c7ca7-103">Guía de procedimientos recomendados y solución de problemas para aplicaciones Node en Aplicaciones web de Azure</span><span class="sxs-lookup"><span data-stu-id="c7ca7-103">Best practices and troubleshooting guide for node applications on Azure Web Apps</span></span>
[!INCLUDE [tabs](../../includes/app-service-web-get-started-nav-tabs.md)]

<span data-ttu-id="c7ca7-104">En este artículo, aprenderá los procedimientos recomendados y los pasos para solucionar problemas de las [aplicaciones de Node](app-service-web-get-started-nodejs.md) que se ejecutan en Azure Webapps (con [iisnode](https://github.com/azure/iisnode)).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-104">In this article, you will learn the best practices and troubleshooting steps for [node applications](app-service-web-get-started-nodejs.md) running on Azure Webapps (with [iisnode](https://github.com/azure/iisnode)).</span></span>

> [!WARNING]
> <span data-ttu-id="c7ca7-105">Tenga cuidado cuando aplique los pasos para solucionar problemas en el sitio de producción.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-105">Use caution when using troubleshooting steps on your production site.</span></span> <span data-ttu-id="c7ca7-106">Se recomienda solucionar los problemas de la aplicación en una configuración que no sea de producción (por ejemplo, su espacio de ensayo) y, una vez corregido el problema, cambiar el espacio de ensayo por el de producción.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-106">Recommendation is to troubleshoot your app on a non-production setup for example your staging slot and when the issue is fixed, swap your staging slot with your production slot.</span></span>
> 
> 

## <a name="iisnode-configuration"></a><span data-ttu-id="c7ca7-107">Configuración de IISNODE</span><span class="sxs-lookup"><span data-stu-id="c7ca7-107">IISNODE configuration</span></span>
<span data-ttu-id="c7ca7-108">Este [archivo de esquema](https://github.com/Azure/iisnode/blob/master/src/config/iisnode_schema_x64.xml) muestra todas las configuraciones que se pueden establecer para iisnode.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-108">This [schema file](https://github.com/Azure/iisnode/blob/master/src/config/iisnode_schema_x64.xml) shows all the settings that can be configured for iisnode.</span></span> <span data-ttu-id="c7ca7-109">Algunas de las que le serán útiles para la aplicación son:</span><span class="sxs-lookup"><span data-stu-id="c7ca7-109">Some of the settings that will be useful for your application are:</span></span>

* <span data-ttu-id="c7ca7-110">nodeProcessCountPerApplication</span><span class="sxs-lookup"><span data-stu-id="c7ca7-110">nodeProcessCountPerApplication</span></span>
  
    <span data-ttu-id="c7ca7-111">Esta configuración controla el número de procesos de nodo que se inician por cada aplicación IIS.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-111">This setting controls the number of node processes that are launched per IIS application.</span></span> <span data-ttu-id="c7ca7-112">El valor predeterminado es 1.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-112">Default value is 1.</span></span> <span data-ttu-id="c7ca7-113">Puede iniciar tantos procesos node.exe como núcleos posea la máquina virtual si establece esta configuración en 0.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-113">You can launch as many node.exe’s as your VM core count by setting this to 0.</span></span> <span data-ttu-id="c7ca7-114">El valor recomendado es 0 para la mayoría de las aplicaciones, para que pueda usar todos los núcleos en la máquina.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-114">Recommended value is 0 for most application so you can utilize all of the cores on your machine.</span></span> <span data-ttu-id="c7ca7-115">Node.exe tiene un único subproceso, por lo que un proceso node.exe consumirá un máximo de 1 núcleo; para obtener el máximo rendimiento de la aplicación Node, debería utilizar todos los núcleos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-115">Node.exe is single threaded so one node.exe will consume a maximum of 1 core and to get maximum performance out of your node application you would want to utilize all cores.</span></span>
* <span data-ttu-id="c7ca7-116">nodeProcessCommandLine</span><span class="sxs-lookup"><span data-stu-id="c7ca7-116">nodeProcessCommandLine</span></span>
  
    <span data-ttu-id="c7ca7-117">Esta configuración controla la ruta de acceso al proceso node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-117">This setting controls the path to the node.exe.</span></span> <span data-ttu-id="c7ca7-118">Puede establecer este valor para que señale a su versión de node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-118">You can set this value to point to your node.exe version.</span></span>
* <span data-ttu-id="c7ca7-119">maxConcurrentRequestsPerProcess</span><span class="sxs-lookup"><span data-stu-id="c7ca7-119">maxConcurrentRequestsPerProcess</span></span>
  
    <span data-ttu-id="c7ca7-120">Esta configuración controla el número máximo de solicitudes simultáneas enviadas por iisnode a cada proceso node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-120">This setting controls the maximum number of concurrent requests sent by iisnode to each node.exe.</span></span> <span data-ttu-id="c7ca7-121">En Aplicaciones web de Azure, el valor predeterminado es Infinito.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-121">On azure webapps, the default value for this is Infinite.</span></span> <span data-ttu-id="c7ca7-122">No tendrá que preocuparse por esta configuración.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-122">You will not have to worry about this setting.</span></span> <span data-ttu-id="c7ca7-123">Fuera de Aplicaciones web de Azure, el valor predeterminado es 1024.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-123">Outside azure webapps, the default value is 1024.</span></span> <span data-ttu-id="c7ca7-124">Puede definir esta configuración en función de la cantidad de solicitudes que reciba la aplicación y la velocidad con que la aplicación procese cada una.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-124">You might want to configure this depending on how many requests your application gets and how fast your application processes each request.</span></span>
* <span data-ttu-id="c7ca7-125">maxNamedPipeConnectionRetry</span><span class="sxs-lookup"><span data-stu-id="c7ca7-125">maxNamedPipeConnectionRetry</span></span>
  
    <span data-ttu-id="c7ca7-126">Esta configuración controla el número máximo de veces que iisnode volverá a intentar establecer conexión en la canalización con nombre para enviar la solicitud a node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-126">This setting controls the maximum number of times iisnode will retry making connection on the named pipe to send the request over to node.exe.</span></span> <span data-ttu-id="c7ca7-127">Esta configuración, combinada con namedPipeConnectionRetryDelay, determina el tiempo de espera total de cada solicitud dentro de iisnode.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-127">This setting in combination with namedPipeConnectionRetryDelay determines the total timeout of each request within iisnode.</span></span> <span data-ttu-id="c7ca7-128">El valor predeterminado es 200 en Aplicaciones web de Azure.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-128">Default value is 200 on Azure Webapps.</span></span> <span data-ttu-id="c7ca7-129">Tiempo de espera total en segundos = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span><span class="sxs-lookup"><span data-stu-id="c7ca7-129">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span></span>
* <span data-ttu-id="c7ca7-130">namedPipeConnectionRetryDelay</span><span class="sxs-lookup"><span data-stu-id="c7ca7-130">namedPipeConnectionRetryDelay</span></span>
  
    <span data-ttu-id="c7ca7-131">Esta configuración controla la cantidad de tiempo (en milisegundos) que iisnode esperará entre cada reintento de enviar la solicitud a node.exe a través de la canalización con nombre.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-131">This setting controls the amount of time (in ms) iisnode will wait for between each retry to send request to node.exe over the named pipe.</span></span> <span data-ttu-id="c7ca7-132">El valor predeterminado es 250 ms.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-132">Default value is 250ms.</span></span>
    <span data-ttu-id="c7ca7-133">Tiempo de espera total en segundos = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span><span class="sxs-lookup"><span data-stu-id="c7ca7-133">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span></span>
  
    <span data-ttu-id="c7ca7-134">De forma predeterminada, el tiempo de espera total de iisnode en Azure Webapps es de 200 \* 250 ms = 50 segundos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-134">By default the total timeout in iisnode on azure webapps is 200 \* 250ms = 50 seconds.</span></span>
* <span data-ttu-id="c7ca7-135">logDirectory</span><span class="sxs-lookup"><span data-stu-id="c7ca7-135">logDirectory</span></span>
  
    <span data-ttu-id="c7ca7-136">Esta configuración controla el directorio donde iisnode registrará stdout y stderr.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-136">This setting controls the directory where iisnode will log stdout/stderr.</span></span> <span data-ttu-id="c7ca7-137">El valor predeterminado es iisnode, que es relativo al directorio de scripts principal (el directorio donde se encuentra el archivo server.js principal).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-137">Default value is iisnode which is relative to the main script directory (directory where main server.js is present)</span></span>
* <span data-ttu-id="c7ca7-138">debuggerExtensionDll</span><span class="sxs-lookup"><span data-stu-id="c7ca7-138">debuggerExtensionDll</span></span>
  
    <span data-ttu-id="c7ca7-139">Esta configuración controla la versión de node-inspector que iisnode usará para depurar su aplicación Node.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-139">This setting controls what version of node-inspector iisnode will use when debugging your node application.</span></span> <span data-ttu-id="c7ca7-140">Actualmente, los únicos dos valores válidos para esta configuración son iisnode-inspector-0.7.3.dll e iisnode-inspector.dll.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-140">Currently iisnode-inspector-0.7.3.dll and iisnode-inspector.dll are the only 2 valid values for this setting.</span></span> <span data-ttu-id="c7ca7-141">El valor predeterminado es iisnode-inspector-0.7.3.dll.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-141">Default value is iisnode-inspector-0.7.3.dll.</span></span> <span data-ttu-id="c7ca7-142">La versión iisnode-inspector-0.7.3.dll usa node-inspector-0.7.3 y WebSockets, por lo que deberá habilitar WebSockets en su aplicación web de Azure para utilizar esta versión.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-142">iisnode-inspector-0.7.3.dll version uses node-inspector-0.7.3 and uses websockets, so you will need to enable websockets on your azure webapp to use this version.</span></span> <span data-ttu-id="c7ca7-143">Consulte <http://www.ranjithr.com/?p=98> para más información sobre cómo configurar iisnode para que use la nueva versión de node-inspector.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-143">See <http://www.ranjithr.com/?p=98> for more details on how to configure iisnode to use the new node-inspector.</span></span>
* <span data-ttu-id="c7ca7-144">flushResponse</span><span class="sxs-lookup"><span data-stu-id="c7ca7-144">flushResponse</span></span>
  
    <span data-ttu-id="c7ca7-145">El comportamiento predeterminado de IIS es almacenar hasta 4 MB de datos de respuesta en el búfer antes de vaciarlo o hasta el final de la respuesta, lo que ocurra primero.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-145">The default behavior of IIS is that it buffers response data up to 4MB before flushing, or until the end of the response, whichever comes first.</span></span> <span data-ttu-id="c7ca7-146">iisnode ofrece una opción de configuración que invalida este comportamiento: para vaciar un fragmento del cuerpo de la entidad de respuesta en cuanto iisnode lo recibe de node.exe, es preciso establecer el atributo iisnode/@flushResponse de web.config en "true":</span><span class="sxs-lookup"><span data-stu-id="c7ca7-146">iisnode offers a configuration setting to override this behavior: to flush a fragment of the response entity body as soon as iisnode receives it from node.exe, you need to set the iisnode/@flushResponse attribute in web.config to 'true':</span></span>
  
    ```
    <configuration>    
        <system.webServer>    
            <!-- ... -->    
            <iisnode flushResponse="true" />    
        </system.webServer>    
    </configuration>
    ```
  
    <span data-ttu-id="c7ca7-147">La habilitación del vaciado de todos los fragmentos del cuerpo de la entidad de respuesta aumenta la sobrecarga de rendimiento y reduce el rendimiento del sistema aproximadamente en un 5 % (a partir de la versión 0.1.13), por lo que se recomienda definir el ámbito de esta configuración solo en los puntos de conexión que requieran streaming de respuestas (p.ej., mediante el uso del elemento <location> en web.config)</span><span class="sxs-lookup"><span data-stu-id="c7ca7-147">Enabling flushing of every fragment of the response entity body adds performance overhead that reduces the throughput of the system by ~5% (as of v0.1.13), so it is best to scope this setting only to endpoints that require response streaming (e.g. using the <location> element in the web.config)</span></span>
  
    <span data-ttu-id="c7ca7-148">Además, para las aplicaciones de streaming, debe establecer también el atributo responseBufferLimit del controlador de iisnode en 0.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-148">In addition to this, for streaming applications, you will need to also set responseBufferLimit of your iisnode handler to 0.</span></span>
  
    ```
    <handlers>    
        <add name="iisnode" path="app.js" verb="\*" modules="iisnode" responseBufferLimit="0"/>    
    </handlers>
    ```
* <span data-ttu-id="c7ca7-149">watchedFiles</span><span class="sxs-lookup"><span data-stu-id="c7ca7-149">watchedFiles</span></span>
  
    <span data-ttu-id="c7ca7-150">Se trata de una lista de archivos separados por punto y coma que se inspeccionarán para ver si hay cambios.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-150">This is a semi-colon separated list of files that will be watched for changes.</span></span> <span data-ttu-id="c7ca7-151">Cuando se produce un cambio en un archivo, se produce el reciclaje de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-151">A change to a file causes the application to recycle.</span></span> <span data-ttu-id="c7ca7-152">Cada entrada consta de un nombre de directorio opcional más el nombre de archivo necesario, que son relativos al directorio donde se encuentra el punto de entrada de la aplicación principal.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-152">Each entry consists of an optional directory name plus required file name which are relative to the directory where the main application entry point is located.</span></span> <span data-ttu-id="c7ca7-153">Solo se permiten comodines en la parte del nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-153">Wild cards are allowed in the file name portion only.</span></span> <span data-ttu-id="c7ca7-154">El valor predeterminado es "\*.js;web.config"</span><span class="sxs-lookup"><span data-stu-id="c7ca7-154">Default value is “\*.js;web.config”</span></span>
* <span data-ttu-id="c7ca7-155">recycleSignalEnabled</span><span class="sxs-lookup"><span data-stu-id="c7ca7-155">recycleSignalEnabled</span></span>
  
    <span data-ttu-id="c7ca7-156">El valor predeterminado es False.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-156">Default value is false.</span></span> <span data-ttu-id="c7ca7-157">Si está habilitado, la aplicación de Node puede conectarse a una canalización con nombre (variable de entorno IISNODE\_CONTROL\_PIPE) y enviar un mensaje de "reciclaje".</span><span class="sxs-lookup"><span data-stu-id="c7ca7-157">If enabled, your node application can connect to a named pipe (environment variable IISNODE\_CONTROL\_PIPE) and send a “recycle” message.</span></span> <span data-ttu-id="c7ca7-158">Esto hará que se recicle w3wp correctamente.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-158">This will cause the w3wp to recycle gracefully.</span></span>
* <span data-ttu-id="c7ca7-159">idlePageOutTimePeriod</span><span class="sxs-lookup"><span data-stu-id="c7ca7-159">idlePageOutTimePeriod</span></span>
  
    <span data-ttu-id="c7ca7-160">El valor predeterminado es 0, lo que significa que esta característica está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-160">Default value is 0 which means this feature is disabled.</span></span> <span data-ttu-id="c7ca7-161">Cuando se establece en un valor mayor que 0, iisnode quita páginas de todos sus procesos secundarios cada 'idlePageOutTimePeriod' milisegundos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-161">When set to some value greater than 0, iisnode will page out all its child processes every ‘idlePageOutTimePeriod’ milliseconds.</span></span> <span data-ttu-id="c7ca7-162">Para entender lo que significa quitar páginas, consulte esta [documentación](https://msdn.microsoft.com/library/windows/desktop/ms682606.aspx).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-162">To understand what page out means, please refer to this [documentation](https://msdn.microsoft.com/library/windows/desktop/ms682606.aspx).</span></span> <span data-ttu-id="c7ca7-163">Esta configuración será útil para las aplicaciones que consuman mucha memoria y que ocasionalmente deseen quitar páginas de memoria en disco para liberar algo de RAM.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-163">This setting will be useful for applications that consume a lot of memory and want to pageout memory to disk occasionally to free up some RAM.</span></span>

> [!WARNING]
> <span data-ttu-id="c7ca7-164">Tenga cuidado cuando habilite las siguientes opciones de configuración en aplicaciones de producción.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-164">Use caution when enabling the following configuration settings on production applications.</span></span> <span data-ttu-id="c7ca7-165">Se recomienda no habilitarlas en aplicaciones de producción.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-165">Recommendation is to not enable them on live production applications.</span></span>
> 
> 

* <span data-ttu-id="c7ca7-166">debugHeaderEnabled</span><span class="sxs-lookup"><span data-stu-id="c7ca7-166">debugHeaderEnabled</span></span>
  
    <span data-ttu-id="c7ca7-167">El valor predeterminado es false.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-167">The default value is false.</span></span> <span data-ttu-id="c7ca7-168">Si se establece en true, iisnode agregará un encabezado de respuesta HTTP iisnode-debug a cada respuesta HTTP que envía; el valor del encabezado iisnode-debug es una dirección URL.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-168">If set to true, iisnode will add an HTTP response header iisnode-debug to every HTTP response it sends the iisnode-debug header value is a URL.</span></span> <span data-ttu-id="c7ca7-169">Se pueden deducir partes individuales de la información de diagnóstico examinando el fragmento de dirección URL, pero se consigue una mejor visualización si se abre la dirección URL en el explorador.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-169">Individual pieces of diagnostic information can be gleaned by looking at the URL fragment, but a much better visualization is achieved by opening the URL in the browser.</span></span>
* <span data-ttu-id="c7ca7-170">loggingEnabled</span><span class="sxs-lookup"><span data-stu-id="c7ca7-170">loggingEnabled</span></span>
  
    <span data-ttu-id="c7ca7-171">Esta configuración controla el registro de stdout y stderr por parte de iisnode.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-171">This setting controls the logging of stdout and stderr by iisnode.</span></span> <span data-ttu-id="c7ca7-172">Iisnode capturará stdout y stderr de los procesos de nodo que inicie y escribirá en el directorio especificado en la configuración ‘logDirectory’.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-172">Iisnode will capture stdout/stderr from node processes it launches and write to the directory specified in the ‘logDirectory’ setting.</span></span> <span data-ttu-id="c7ca7-173">Una vez que este atributo esté habilitado, la aplicación escribirá registros en el sistema de archivos y, según la cantidad de entradas que registre la aplicación, el rendimiento podría verse afectado.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-173">Once this is enable, your application will be writing logs to the file system and depending on the amount of logging done by the application, there could be performance implications.</span></span>
* <span data-ttu-id="c7ca7-174">devErrorsEnabled</span><span class="sxs-lookup"><span data-stu-id="c7ca7-174">devErrorsEnabled</span></span>
  
    <span data-ttu-id="c7ca7-175">El valor predeterminado es False.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-175">Default value is false.</span></span> <span data-ttu-id="c7ca7-176">Cuando está establecido en true, iisnode mostrará el código de estado HTTP y el código de error Win32 en el explorador.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-176">When set to true, iisnode will display the HTTP status code and Win32 error code on your browser.</span></span> <span data-ttu-id="c7ca7-177">El código win32 le resultará útil al depurar determinados tipos de problemas.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-177">The win32 code will be helpful in debugging certain types of issues.</span></span>
* <span data-ttu-id="c7ca7-178">debuggingEnabled (no se debe habilitar en el sitio de producción)</span><span class="sxs-lookup"><span data-stu-id="c7ca7-178">debuggingEnabled (do not enable on live production site)</span></span>
  
    <span data-ttu-id="c7ca7-179">Esta configuración controla la característica de depuración.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-179">This setting controls debugging feature.</span></span> <span data-ttu-id="c7ca7-180">Iisnode está integrado con node-inspector.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-180">Iisnode is integrated with node-inspector.</span></span> <span data-ttu-id="c7ca7-181">Si habilita esta configuración, se habilitará la depuración de la aplicación Node.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-181">By enabling this setting, you enable debugging of your node application.</span></span> <span data-ttu-id="c7ca7-182">Una vez habilitada esta opción, iisnode preparará los archivos de node-inspector necesarios en el directorio 'debuggerVirtualDir' con la primera solicitud de depuración enviada a la aplicación Node.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-182">Once this setting is enabled, iisnode will layout the necessary node-inspector files in ‘debuggerVirtualDir’ directory on the first debug request to your node application.</span></span> <span data-ttu-id="c7ca7-183">Para cargar node-inspector, envíe una solicitud a http://yoursite/server.js/debug.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-183">You can load the node-inspector by sending a request to http://yoursite/server.js/debug.</span></span> <span data-ttu-id="c7ca7-184">Puede controlar el segmento de dirección URL de depuración con el valor 'debuggerPathSegment'.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-184">You can control the debug URL segment with ‘debuggerPathSegment’ setting.</span></span> <span data-ttu-id="c7ca7-185">De forma predeterminada, debuggerPathSegment es 'debug'.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-185">By default debuggerPathSegment=’debug’.</span></span> <span data-ttu-id="c7ca7-186">Puede establecerlo en un GUID, por ejemplo, para que resulte más difícil que otros usuarios lo detecten.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-186">You can set this to a GUID for example so that it is more difficult to be discovered by others.</span></span>
  
    <span data-ttu-id="c7ca7-187">Consulte este [vínculo](https://tomasz.janczuk.org/2011/11/debug-nodejs-applications-on-windows.html) para más información sobre la depuración.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-187">Check this [link](https://tomasz.janczuk.org/2011/11/debug-nodejs-applications-on-windows.html) for more details on debugging.</span></span>

## <a name="scenarios-and-recommendationstroubleshooting"></a><span data-ttu-id="c7ca7-188">Escenarios, recomendaciones y solución de problemas</span><span class="sxs-lookup"><span data-stu-id="c7ca7-188">Scenarios and recommendations/troubleshooting</span></span>
### <a name="my-node-application-is-making-too-many-outbound-calls"></a><span data-ttu-id="c7ca7-189">Mi aplicación Node realiza demasiadas llamadas salientes.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-189">My node application is making too many outbound calls.</span></span>
<span data-ttu-id="c7ca7-190">Muchas aplicaciones van a establecer conexiones salientes como parte de su funcionamiento normal.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-190">Many applications would want to make outbound connections as part of their regular operation.</span></span> <span data-ttu-id="c7ca7-191">Por ejemplo, cuando llega una solicitud, la aplicación Node va a establecer contacto con una API de REST en otro lugar y así obtener información para procesar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-191">For example, when a request comes in, your node app would want to contact a REST API elsewhere and get some information to process the request.</span></span> <span data-ttu-id="c7ca7-192">Debería utilizar un agente de conexión persistente al realizar llamadas HTTP o HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-192">You would want to use a keep alive agent when making http or https calls.</span></span> <span data-ttu-id="c7ca7-193">Por ejemplo, podría utilizar el módulo agentKeepAlive como agente de conexión persistente cuando realice estas llamadas salientes.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-193">For example, you could use the agentkeepalive module as your keep alive agent when making these outbound calls.</span></span> <span data-ttu-id="c7ca7-194">Esto garantiza que se reutilicen los sockets en la máquina virtual de su aplicación web de Azure, por lo que se reducirá la sobrecarga que supone crear sockets para cada solicitud saliente.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-194">This makes sure that the sockets are reused on your azure webapp VM and reducing the overhead of creating new sockets for every outbound request.</span></span> <span data-ttu-id="c7ca7-195">Además, garantiza que se usen menos sockets para realizar muchas solicitudes salientes y, por tanto, no se supere el valor maxSockets asignado para cada máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-195">Also, this makes sure that you are using less number of sockets to make many outbound requests and therefore you don’t exceed the maxSockets that are allocated per VM.</span></span> <span data-ttu-id="c7ca7-196">La recomendación en Aplicaciones web de Azure es establecer el valor maxSockets de agentKeepAlive en un total de 160 sockets por máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-196">Recommendation on Azure Webapps would be to set the agentKeepAlive maxSockets value to a total of 160 sockets per VM.</span></span> <span data-ttu-id="c7ca7-197">Esto significa que, si tiene cuatro procesos node.exe en ejecución en la máquina virtual, debería establecer el valor maxSockets de agentKeepAlive en 40 por node.exe, es decir, un total de 160 por máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-197">This means that if you have 4 node.exe running on the VM, you would want to set the agentKeepAlive maxSockets to 40 per node.exe which is 160 total per VM.</span></span>

<span data-ttu-id="c7ca7-198">Ejemplo de configuración de [agentKeepALive](https://www.npmjs.com/package/agentkeepalive):</span><span class="sxs-lookup"><span data-stu-id="c7ca7-198">Example [agentKeepALive](https://www.npmjs.com/package/agentkeepalive) configuration:</span></span>

```
var keepaliveAgent = new Agent({    
    maxSockets: 40,    
    maxFreeSockets: 10,    
    timeout: 60000,    
    keepAliveTimeout: 300000    
});
```

<span data-ttu-id="c7ca7-199">En este ejemplo se da por supuesto que tiene cuatro procesos node.exe en ejecución en la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-199">This example assumes you have 4 node.exe running on your VM.</span></span> <span data-ttu-id="c7ca7-200">Si tiene un número diferente de procesos node.exe ejecutándose en la máquina virtual, tendrá que modificar el valor maxSockets en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-200">If you have a different number of node.exe running on the VM, you will have to modify the maxSockets setting accordingly.</span></span>

### <a name="my-node-application-is-consuming-too-much-cpu"></a><span data-ttu-id="c7ca7-201">Mi aplicación Node consume demasiada CPU.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-201">My node application is consuming too much CPU.</span></span>
<span data-ttu-id="c7ca7-202">Probablemente recibirá una recomendación de Aplicaciones web de Azure en el portal sobre el elevado consumo de CPU.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-202">You will probably get a recommendation from Azure Webapps on your portal about high cpu consumption.</span></span> <span data-ttu-id="c7ca7-203">También puede configurar monitores para inspeccionar determinadas [métricas](web-sites-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-203">You can also setup monitors to watch for certain [metrics](web-sites-monitor.md).</span></span> <span data-ttu-id="c7ca7-204">Al comprobar el uso de la CPU en el [panel de Azure Portal](../application-insights/app-insights-web-monitor-performance.md), compruebe los valores MÁX. de la CPU para que no pase por alto los valores máximos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-204">When checking the CPU usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), please check the MAX values for CPU so you don’t miss out the peak values.</span></span>
<span data-ttu-id="c7ca7-205">En aquellos casos en que crea que su aplicación consume demasiada CPU y no se pueda explicar por qué, debe generar un perfil de la aplicación Node.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-205">In cases where you think your application is consuming too much CPU and you cannot explain why, you will need to profile your node application.</span></span>

### 
#### <a name="profiling-your-node-application-on-azure-webapps-with-v8-profiler"></a><span data-ttu-id="c7ca7-206">Generación del perfil de su aplicación Node en Aplicaciones web de Azure con V8-Profiler</span><span class="sxs-lookup"><span data-stu-id="c7ca7-206">Profiling your node application on azure webapps with V8-Profiler</span></span>
<span data-ttu-id="c7ca7-207">Por ejemplo, supongamos que tiene una aplicación "hello world" cuyo perfil desea generar, como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="c7ca7-207">For example, lets say you have a hello world app that you want to profile as shown below:</span></span>

```
var http = require('http');    
function WriteConsoleLog() {    
    for(var i=0;i<99999;++i) {    
        console.log('hello world');    
    }    
}

function HandleRequest() {    
    WriteConsoleLog();    
}

http.createServer(function (req, res) {    
    res.writeHead(200, {'Content-Type': 'text/html'});    
    HandleRequest();    
    res.end('Hello world!');    
}).listen(process.env.PORT);
```

<span data-ttu-id="c7ca7-208">Vaya a su sitio de SCM https://yoursite.scm.azurewebsites.net/DebugConsole</span><span class="sxs-lookup"><span data-stu-id="c7ca7-208">Go to your scm site https://yoursite.scm.azurewebsites.net/DebugConsole</span></span>

<span data-ttu-id="c7ca7-209">Verá un símbolo del sistema, como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-209">You will see a command prompt as shown below.</span></span> <span data-ttu-id="c7ca7-210">Vaya al directorio /wwwroot del sitio.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-210">Go into your site/wwwroot directory</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/scm_install_v8.png)

<span data-ttu-id="c7ca7-211">Ejecute el comando "npm install v8-profiler".</span><span class="sxs-lookup"><span data-stu-id="c7ca7-211">Run the command “npm install v8-profiler”</span></span>

<span data-ttu-id="c7ca7-212">Así se deberían instalar v8-profiler en el directorio node\_modules y todas sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-212">This should install v8-profiler under node\_modules directory and all of its dependencies.</span></span>
<span data-ttu-id="c7ca7-213">Ahora, edite el archivo server.js para generar el perfil de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-213">Now, edit your server.js to profile your application.</span></span>

```
var http = require('http');    
var profiler = require('v8-profiler');    
var fs = require('fs');

function WriteConsoleLog() {    
    for(var i=0;i<99999;++i) {    
        console.log('hello world');    
    }    
}

function HandleRequest() {    
    profiler.startProfiling('HandleRequest');    
    WriteConsoleLog();    
    fs.writeFileSync('profile.cpuprofile', JSON.stringify(profiler.stopProfiling('HandleRequest')));    
}

http.createServer(function (req, res) {    
    res.writeHead(200, {'Content-Type': 'text/html'});    
    HandleRequest();    
    res.end('Hello world!');    
}).listen(process.env.PORT);
```

<span data-ttu-id="c7ca7-214">Con los anteriores cambios, se generará el perfil de la función WriteConsoleLog y después se escribirá la salida de perfil en el archivo 'profile.cpuprofile' en el directorio wwwroot del sitio.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-214">The above changes will profile the WriteConsoleLog function and then write the profile output to ‘profile.cpuprofile’ file under your site wwwroot.</span></span> <span data-ttu-id="c7ca7-215">Envíe una solicitud a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-215">Send a request to your application.</span></span> <span data-ttu-id="c7ca7-216">Verá que se crea un archivo 'profile.cpuprofile' en el directorio wwwroot del sitio.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-216">You will see a ‘profile.cpuprofile’ file created under your site wwwroot.</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/scm_profile.cpuprofile.png)

<span data-ttu-id="c7ca7-217">Descargue este archivo y ábralo con las herramientas F12 de Chrome.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-217">Download this file and you will need to open this file with Chrome F12 Tools.</span></span> <span data-ttu-id="c7ca7-218">Presione F12 en Chrome y haga clic en la pestaña "Profiles" (Perfiles).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-218">Hit F12 on chrome, then click on the “Profiles Tab”.</span></span> <span data-ttu-id="c7ca7-219">Haga clic en el botón "Load" (Cargar).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-219">Click on “Load” Button.</span></span> <span data-ttu-id="c7ca7-220">Seleccione el archivo profile.cpuprofile que acaba de descargar.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-220">Select your profile.cpuprofile file that you just downloaded.</span></span> <span data-ttu-id="c7ca7-221">Haga clic en el perfil recién cargado.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-221">Click on the profile you just loaded.</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/chrome_tools_view.png)

<span data-ttu-id="c7ca7-222">Verá que el 95 % del tiempo lo consumió la función WriteConsoleLog, tal como se muestra.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-222">You will see that 95% of the time was consumed by WriteConsoleLog function as shown below.</span></span> <span data-ttu-id="c7ca7-223">También se muestran los números de línea y los archivos de código fuente exactos que causan el problema.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-223">This also shows you the exact line numbers and source files that cause the issue.</span></span>

### <a name="my-node-application-is-consuming-too-much-memory"></a><span data-ttu-id="c7ca7-224">Mi aplicación Node consume demasiada memoria.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-224">My node application is consuming too much memory.</span></span>
<span data-ttu-id="c7ca7-225">Probablemente recibirá una recomendación de Aplicaciones web de Azure en el portal sobre el elevado consumo de memoria.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-225">You will probably get a recommendation from Azure Webapps on your portal about high memory consumption.</span></span> <span data-ttu-id="c7ca7-226">También puede configurar monitores para inspeccionar determinadas [métricas](web-sites-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-226">You can also setup monitors to watch for certain [metrics](web-sites-monitor.md).</span></span> <span data-ttu-id="c7ca7-227">Al comprobar el uso de la memoria en el [panel de Azure Portal](../application-insights/app-insights-web-monitor-performance.md), compruebe los valores MAX. de la memoria, para que no pase por alto los valores máximos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-227">When checking the memory usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), please check the MAX values for memory so you don’t miss out the peak values.</span></span>

#### <a name="leak-detection-and-heap-diffing-for-nodejs"></a><span data-ttu-id="c7ca7-228">Detección de fugas y comparación de montones para node.js</span><span class="sxs-lookup"><span data-stu-id="c7ca7-228">Leak detection and Heap Diffing for node.js</span></span>
<span data-ttu-id="c7ca7-229">Podría usar [node-memwatch](https://github.com/lloyd/node-memwatch) como ayuda para identificar fugas de memoria.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-229">You could use [node-memwatch](https://github.com/lloyd/node-memwatch) to help you identify memory leaks.</span></span>
<span data-ttu-id="c7ca7-230">Puede instalar memwatch igual que v8-profiler y editar su código para que capture y compare montones a fin de identificar las fugas de memoria en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-230">You can install memwatch just like v8-profiler and edit your code to capture and diff heaps to identify the memory leaks in your application.</span></span>

### <a name="my-nodeexes-are-getting-killed-randomly"></a><span data-ttu-id="c7ca7-231">Los procesos node.exe se terminan de forma aleatoria</span><span class="sxs-lookup"><span data-stu-id="c7ca7-231">My node.exe’s are getting killed randomly</span></span>
<span data-ttu-id="c7ca7-232">Existen varias razones para que suceda esto:</span><span class="sxs-lookup"><span data-stu-id="c7ca7-232">There are a few reasons why this could be happening:</span></span>

1. <span data-ttu-id="c7ca7-233">La aplicación inicia excepciones no detectadas. Compruebe el archivo d:\\home\\LogFiles\\Application\\logging-errors.txt para ver detalles sobre la excepción iniciada.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-233">Your application is throwing uncaught exceptions – Please check d:\\home\\LogFiles\\Application\\logging-errors.txt file for the details on the exception thrown.</span></span> <span data-ttu-id="c7ca7-234">Este archivo contiene el seguimiento de la pila, así que puede corregir la aplicación en función de esto.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-234">This file has the stack trace so you can fix your application based on this.</span></span>
2. <span data-ttu-id="c7ca7-235">La aplicación consume demasiada memoria, lo cual afecta al inicio de otros procesos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-235">Your application is consuming too much memory which is affecting other processes from getting started.</span></span> <span data-ttu-id="c7ca7-236">Si la memoria total de la máquina virtual se acerca al 100 %, es posible que el Administrador de procesos termine su proceso node.exe para permitir que otros procesos lleguen a funcionar.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-236">If the total VM memory is close to 100%, your node.exe’s could be killed by the process manager to let other processes get a chance to do some work.</span></span> <span data-ttu-id="c7ca7-237">Para solucionar este problema, asegúrese de que la aplicación no tenga una fuga de memoria; o bien, si la aplicación realmente necesita usar gran cantidad de memoria, escale verticalmente a una máquina virtual más grande con mucha más memoria RAM.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-237">To fix this, either make sure your application is not leaking memory OR if you application really needs to use a lot of memory, please scale up to a larger VM with a lot more RAM.</span></span>

### <a name="my-node-application-does-not-start"></a><span data-ttu-id="c7ca7-238">Mi aplicación Node no se inicia</span><span class="sxs-lookup"><span data-stu-id="c7ca7-238">My node application does not start</span></span>
<span data-ttu-id="c7ca7-239">Si la aplicación devuelve errores 500 durante el inicio, pueden existir varias razones:</span><span class="sxs-lookup"><span data-stu-id="c7ca7-239">If your application is returning 500 Errors at startup, there could be a few reasons:</span></span>

1. <span data-ttu-id="c7ca7-240">Node.exe no se encuentra en la ubicación correcta.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-240">Node.exe is not present at the correct location.</span></span> <span data-ttu-id="c7ca7-241">Compruebe la configuración nodeProcessCommandLine.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-241">Check nodeProcessCommandLine setting.</span></span>
2. <span data-ttu-id="c7ca7-242">El archivo de script principal no se encuentra en la ubicación correcta.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-242">Main script file is not present at the correct location.</span></span> <span data-ttu-id="c7ca7-243">Compruebe web.config y asegúrese de que el nombre del archivo de script principal en la sección de controladores coincida con el archivo de script principal.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-243">Check web.config and make sure the name of the main script file in the handlers section matches the main script file.</span></span>
3. <span data-ttu-id="c7ca7-244">La configuración de web.config no es correcta: compruebe los nombres y los valores de configuración.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-244">Web.config configuration is not correct – check the settings names/values.</span></span>
4. <span data-ttu-id="c7ca7-245">Arranque en frío: la aplicación tarda demasiado tiempo en iniciarse.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-245">Cold Start – Your application is taking too long to startup.</span></span> <span data-ttu-id="c7ca7-246">Si la aplicación tarda más de (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000 segundos, iisnode devolverá un error 500.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-246">If your application takes longer than (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000 seconds, iisnode will return 500 error.</span></span> <span data-ttu-id="c7ca7-247">Aumente los valores de estas configuraciones para que coincidan con el tiempo de inicio de la aplicación, para evitar que se agote el tiempo de espera de iisnode y se devuelva el error 500.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-247">Increase the values of these settings to match your application start time to prevent iisnode from timing out and returning the 500 error.</span></span>

### <a name="my-node-application-crashed"></a><span data-ttu-id="c7ca7-248">Mi aplicación Node se ha bloqueado</span><span class="sxs-lookup"><span data-stu-id="c7ca7-248">My node application crashed</span></span>
<span data-ttu-id="c7ca7-249">La aplicación inicia excepciones no detectadas. Compruebe el archivo d:\\home\\LogFiles\\Application\\logging-errors.txt para ver detalles sobre la excepción iniciada.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-249">Your application is throwing uncaught exceptions – Please check d:\\home\\LogFiles\\Application\\logging-errors.txt file for the details on the exception thrown.</span></span> <span data-ttu-id="c7ca7-250">Este archivo contiene el seguimiento de la pila, así que puede corregir la aplicación en función de esto.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-250">This file has the stack trace so you can fix your application based on this.</span></span>

### <a name="my-node-application-takes-too-much-time-to-startup-cold-start"></a><span data-ttu-id="c7ca7-251">Mi aplicación Node tarda demasiado tiempo en iniciarse (arranque en frío)</span><span class="sxs-lookup"><span data-stu-id="c7ca7-251">My node application takes too much time to startup (Cold Start)</span></span>
<span data-ttu-id="c7ca7-252">La razón más común es que la aplicación tiene una gran cantidad de archivos en node\_modules e intenta cargar la mayoría de ellos durante el inicio.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-252">Most common reason for this is that the application has a lot of files in the node\_modules and the application tries to load most of these files during startup.</span></span> <span data-ttu-id="c7ca7-253">De forma predeterminada, puesto que los archivos residen en el recurso compartido de red en Aplicaciones web de Azure, se puede tardar bastante tiempo en cargar tantos archivos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-253">By default, since your files reside on the network share on Azure Webapps, loading so many files can take some time.</span></span>
<span data-ttu-id="c7ca7-254">Algunas soluciones para que este proceso sea más rápido son:</span><span class="sxs-lookup"><span data-stu-id="c7ca7-254">Some solutions to make this faster are:</span></span>

1. <span data-ttu-id="c7ca7-255">Asegúrese de tener una estructura de dependencias plana y sin dependencias duplicadas; para ello, use npm3 para instalar los módulos.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-255">Make sure you have a flat dependency structure and no duplicate dependencies by using npm3 to install your modules.</span></span>
2. <span data-ttu-id="c7ca7-256">Pruebe a cargar node\_modules en diferido y a no cargar todos los módulos durante el inicio.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-256">Try to lazy load your node\_modules and not load all of the modules at startup.</span></span> <span data-ttu-id="c7ca7-257">Esto significa que se debe realizar la llamada a require('módulo') cuando sea realmente necesario dentro de la función que intente para usar el módulo.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-257">This means that the call to require(‘module’) should be done when you actually need it within the function you try to use the module.</span></span>
3. <span data-ttu-id="c7ca7-258">Aplicaciones web de Azure ofrece una característica denominada caché local.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-258">Azure Webapps offers a feature called local cache.</span></span> <span data-ttu-id="c7ca7-259">Esta característica copia el contenido del recurso compartido de red en el disco local de la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-259">This feature copies your content from the network share to the local disk on the VM.</span></span> <span data-ttu-id="c7ca7-260">Como los archivos son locales, el tiempo de carga de node\_modules es mucho menor.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-260">Since the files are local, the load time of node\_modules is much faster.</span></span> <span data-ttu-id="c7ca7-261">En esta [documentación](../app-service/app-service-local-cache.md) se explica cómo usar Caché local con más detalle.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-261">- This [documentation](../app-service/app-service-local-cache.md) explains how to use Local Cache in more detail.</span></span>

## <a name="iisnode-http-status-and-substatus"></a><span data-ttu-id="c7ca7-262">Estado y subestado HTTP de IISNODE</span><span class="sxs-lookup"><span data-stu-id="c7ca7-262">IISNODE http status and substatus</span></span>
<span data-ttu-id="c7ca7-263">Este [archivo de código fuente](https://github.com/Azure/iisnode/blob/master/src/iisnode/cnodeconstants.h) enumera todas las combinaciones posibles de estado y subestado que iisnode puede devolver en caso de error.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-263">This [source file](https://github.com/Azure/iisnode/blob/master/src/iisnode/cnodeconstants.h) lists all the possible status/substatus combination iisnode can return in case of error.</span></span>

<span data-ttu-id="c7ca7-264">Habilite FREB para la aplicación a fin de ver el código de error win32 (asegúrese de habilitar FREB solo en sitios de no producción, por motivos de rendimiento).</span><span class="sxs-lookup"><span data-stu-id="c7ca7-264">Enable FREB for your application to see the win32 error code (please make sure you enable FREB only on non-production sites for performance reasons).</span></span>

| <span data-ttu-id="c7ca7-265">Estado HTTP</span><span class="sxs-lookup"><span data-stu-id="c7ca7-265">Http Status</span></span> | <span data-ttu-id="c7ca7-266">Subestado HTTP</span><span class="sxs-lookup"><span data-stu-id="c7ca7-266">Http SubStatus</span></span> | <span data-ttu-id="c7ca7-267">¿Posible razón?</span><span class="sxs-lookup"><span data-stu-id="c7ca7-267">Possible Reason?</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c7ca7-268">500</span><span class="sxs-lookup"><span data-stu-id="c7ca7-268">500</span></span> |<span data-ttu-id="c7ca7-269">1000</span><span class="sxs-lookup"><span data-stu-id="c7ca7-269">1000</span></span> |<span data-ttu-id="c7ca7-270">Se produjo algún problema al enviar la solicitud a IISNODE; compruebe si se inició node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-270">There was some issue dispatching the request to IISNODE – check if node.exe was started up.</span></span> <span data-ttu-id="c7ca7-271">Es posible que node.exe se haya bloqueado durante el inicio.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-271">Node.exe could have crashed on startup.</span></span> <span data-ttu-id="c7ca7-272">Compruebe si hay errores en la configuración de web.config.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-272">Check your web.config configuration for errors.</span></span> |
| <span data-ttu-id="c7ca7-273">500</span><span class="sxs-lookup"><span data-stu-id="c7ca7-273">500</span></span> |<span data-ttu-id="c7ca7-274">1001</span><span class="sxs-lookup"><span data-stu-id="c7ca7-274">1001</span></span> |<span data-ttu-id="c7ca7-275">- Win32Error 0x2: la aplicación no responde a la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-275">- Win32Error 0x2 - App is not responding to the URL.</span></span> <span data-ttu-id="c7ca7-276">Compruebe las reglas de reescritura de direcciones URL o si su aplicación express tiene definidas las rutas correctas.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-276">Check URL rewrite rules or if your express app has the correct routes defined.</span></span> <span data-ttu-id="c7ca7-277">-Win32Error 0x6d: la canalización con nombre está ocupada; node.exe no acepta solicitudes porque la canalización está ocupada.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-277">- Win32Error 0x6d – named pipe is busy – Node.exe is not accepting requests because the pipe is busy.</span></span> <span data-ttu-id="c7ca7-278">Compruebe el uso elevado de CPU.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-278">Check high cpu usage.</span></span> <span data-ttu-id="c7ca7-279">-Otros errores: compruebe si se bloqueó node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-279">- Other errors – check if node.exe crashed.</span></span> |
| <span data-ttu-id="c7ca7-280">500</span><span class="sxs-lookup"><span data-stu-id="c7ca7-280">500</span></span> |<span data-ttu-id="c7ca7-281">1002</span><span class="sxs-lookup"><span data-stu-id="c7ca7-281">1002</span></span> |<span data-ttu-id="c7ca7-282">Se bloqueó node.exe: compruebe el seguimiento de la pila en d:\\home\\LogFiles\\logging-errors.txt.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-282">Node.exe crashed – check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span></span> |
| <span data-ttu-id="c7ca7-283">500</span><span class="sxs-lookup"><span data-stu-id="c7ca7-283">500</span></span> |<span data-ttu-id="c7ca7-284">1003</span><span class="sxs-lookup"><span data-stu-id="c7ca7-284">1003</span></span> |<span data-ttu-id="c7ca7-285">Problema de configuración de canalización: no debería ver esto nunca pero, si lo ve, la configuración de canalización con nombre es incorrecta.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-285">Pipe configuration Issue – You should never see this but if you do, the named pipe configuration is incorrect.</span></span> |
| <span data-ttu-id="c7ca7-286">500</span><span class="sxs-lookup"><span data-stu-id="c7ca7-286">500</span></span> |<span data-ttu-id="c7ca7-287">1004-1018</span><span class="sxs-lookup"><span data-stu-id="c7ca7-287">1004-1018</span></span> |<span data-ttu-id="c7ca7-288">Se produjo un error al enviar la solicitud o al procesar la respuesta enviada a node.exe o recibida de él.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-288">There was some error while sending the request or processing the response to/from node.exe.</span></span> <span data-ttu-id="c7ca7-289">Compruebe si se bloqueó node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-289">Check if node.exe crashed.</span></span> <span data-ttu-id="c7ca7-290">compruebe el seguimiento de la pila en d:\\home\\LogFiles\\logging-errors.txt.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-290">check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span></span> |
| <span data-ttu-id="c7ca7-291">503</span><span class="sxs-lookup"><span data-stu-id="c7ca7-291">503</span></span> |<span data-ttu-id="c7ca7-292">1000</span><span class="sxs-lookup"><span data-stu-id="c7ca7-292">1000</span></span> |<span data-ttu-id="c7ca7-293">No hay memoria suficiente para asignar más conexiones de canalización con nombre.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-293">Not enough memory to allocate more named pipe connections.</span></span> <span data-ttu-id="c7ca7-294">Compruebe por qué la aplicación consume tanta memoria.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-294">Check why your app is consuming so much memory.</span></span> <span data-ttu-id="c7ca7-295">Compruebe el valor de la configuración maxConcurrentRequestsPerProcess.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-295">Check maxConcurrentRequestsPerProcess setting value.</span></span> <span data-ttu-id="c7ca7-296">Si no es infinito y tiene gran cantidad de solicitudes, auméntelo para evitar este error.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-296">If its not infinite and you have a lot of requests, increase this value to prevent this error.</span></span> |
| <span data-ttu-id="c7ca7-297">503</span><span class="sxs-lookup"><span data-stu-id="c7ca7-297">503</span></span> |<span data-ttu-id="c7ca7-298">1001</span><span class="sxs-lookup"><span data-stu-id="c7ca7-298">1001</span></span> |<span data-ttu-id="c7ca7-299">No se pudo enviar la solicitud a node.exe porque la aplicación se está reciclando.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-299">Request could not be dispatched to node.exe because the application is recycling.</span></span> <span data-ttu-id="c7ca7-300">Una vez reciclada la aplicación, se deberían atender las solicitudes normalmente.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-300">After the application has recycled, requests should be served normally.</span></span> |
| <span data-ttu-id="c7ca7-301">503</span><span class="sxs-lookup"><span data-stu-id="c7ca7-301">503</span></span> |<span data-ttu-id="c7ca7-302">1002</span><span class="sxs-lookup"><span data-stu-id="c7ca7-302">1002</span></span> |<span data-ttu-id="c7ca7-303">Compruebe la verdadera razón en el código de error win32; no se pudo enviar la solicitud a un proceso node.exe.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-303">Check win32 error code for actual reason – Request could not be dispatched to a node.exe.</span></span> |
| <span data-ttu-id="c7ca7-304">503</span><span class="sxs-lookup"><span data-stu-id="c7ca7-304">503</span></span> |<span data-ttu-id="c7ca7-305">1003</span><span class="sxs-lookup"><span data-stu-id="c7ca7-305">1003</span></span> |<span data-ttu-id="c7ca7-306">Canalización con nombre demasiado ocupada; compruebe si el nodo consume gran cantidad de CPU.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-306">Named pipe is too Busy – Check if node is consuming a lot of CPU</span></span> |

<span data-ttu-id="c7ca7-307">Existe una opción en NODE.exe denominada NODE\_PENDING\_PIPE\_INSTANCES.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-307">There is a setting within NODE.exe called NODE\_PENDING\_PIPE\_INSTANCES.</span></span> <span data-ttu-id="c7ca7-308">De forma predeterminada, fuera de Aplicaciones web de Azure, este valor es 4.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-308">By default outside of azure webapps this value is 4.</span></span> <span data-ttu-id="c7ca7-309">Esto significa que node.exe solo puede aceptar cuatro solicitudes a la vez en la canalización con nombre.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-309">This means that node.exe can only accept 4 requests at a time on the named pipe.</span></span> <span data-ttu-id="c7ca7-310">En Aplicaciones web de Azure, este valor se establece en 5000 y debería bastar para la mayoría de las aplicaciones Node que se ejecuten en Aplicaciones web de Azure.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-310">On Azure Webapps, this value is set to 5000 and this value should be good enough for most node applications running on azure webapps.</span></span> <span data-ttu-id="c7ca7-311">No debería ver 503.1003 en Azure Webapps, ya que el valor de NODE\_PENDING\_PIPE\_INSTANCES es elevado.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-311">You should not see 503.1003 on azure webapps because we have a high value for the NODE\_PENDING\_PIPE\_INSTANCES.</span></span>  |

## <a name="more-resources"></a><span data-ttu-id="c7ca7-312">Más recursos</span><span class="sxs-lookup"><span data-stu-id="c7ca7-312">More resources</span></span>
<span data-ttu-id="c7ca7-313">Siga estos vínculos para obtener más información acerca de las aplicaciones de node.js en el Servicio de aplicaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="c7ca7-313">Follow these links to learn more about node.js applications on Azure App Service.</span></span>

* [<span data-ttu-id="c7ca7-314">Introducción a las aplicaciones web Node.js en el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="c7ca7-314">Get started with Node.js web apps in Azure App Service</span></span>](app-service-web-get-started-nodejs.md)
* [<span data-ttu-id="c7ca7-315">Cómo depurar una aplicación web de Node.js en el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="c7ca7-315">How to debug a Node.js web app in Azure App Service</span></span>](web-sites-nodejs-debug.md)
* [<span data-ttu-id="c7ca7-316">Uso de módulos Node.js con aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="c7ca7-316">Using Node.js Modules with Azure applications</span></span>](../nodejs-use-node-modules-azure-apps.md)
* [<span data-ttu-id="c7ca7-317">Azure App Service Web Apps: Node.js (Aplicaciones web del Servicio de aplicaciones de Azure: Node.js)</span><span class="sxs-lookup"><span data-stu-id="c7ca7-317">Azure App Service Web Apps: Node.js</span></span>](https://blogs.msdn.microsoft.com/silverlining/2012/06/14/windows-azure-websites-node-js/)
* [<span data-ttu-id="c7ca7-318">Centro para desarrolladores de Node.js</span><span class="sxs-lookup"><span data-stu-id="c7ca7-318">Node.js Developer Center</span></span>](../nodejs-use-node-modules-azure-apps.md)
* [<span data-ttu-id="c7ca7-319">Exploring the Super Secret Kudu Debug Console (Exploración de la consola de depuración súper secreta de Kudu)</span><span class="sxs-lookup"><span data-stu-id="c7ca7-319">Exploring the Super Secret Kudu Debug Console</span></span>](https://azure.microsoft.com/documentation/videos/super-secret-kudu-debug-console-for-azure-web-sites/)

