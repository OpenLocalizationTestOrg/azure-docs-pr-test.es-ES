---
title: "implementación de aaaFlighting (beta prueba) en el servicio de aplicación de Azure"
description: "Obtenga información acerca de cómo tooflight nuevas características en su aplicación o la versión beta de probar las actualizaciones en este tutorial to-end. Reúne las características del Servicio de aplicaciones como publicación continua, ranuras, enrutamiento de tráfico y la integración de Application Insights."
services: app-service\web
documentationcenter: 
author: cephalin
manager: erikre
editor: 
ms.assetid: 17953c51-38f8-442d-bb0b-f69c1542f0e9
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/02/2016
ms.author: cephalin
ms.openlocfilehash: e83477b1fe46be09e5baa7bc2bd239b840b05cf7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="flighting-deployment-beta-testing-in-azure-app-service"></a><span data-ttu-id="620bc-104">Implementación de la distribución de paquetes piloto (pruebas beta) en el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="620bc-104">Flighting deployment (beta testing) in Azure App Service</span></span>
<span data-ttu-id="620bc-105">Este tutorial muestra cómo toodo *las implementaciones de programa Windows Insider* mediante la integración de Hola varias funciones de [servicio de aplicaciones de Azure](http://go.microsoft.com/fwlink/?LinkId=529714) y [Azure Application Insights](/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="620bc-105">This tutorial shows you how toodo *flighting deployments* by integrating hello various capabilities of [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714) and [Azure Application Insights](/services/application-insights/).</span></span>

<span data-ttu-id="620bc-106">*La distribución de paquetes piloto* es un proceso de implementación que valida una nueva característica o cambio con un número limitado de clientes reales, y es una prueba importante en el escenario de producción.</span><span class="sxs-lookup"><span data-stu-id="620bc-106">*Flighting* is a deployment process that validates a new feature or change with a limited number of real customers, and is a major testing in production scenario.</span></span> <span data-ttu-id="620bc-107">Es toobeta analogía pruebas y a veces se conoce como "vuelo de pruebas controlado".</span><span class="sxs-lookup"><span data-stu-id="620bc-107">It is akin toobeta testing and is sometimes known as "controlled test flight".</span></span> <span data-ttu-id="620bc-108">Muchas grandes empresas con una presencia web usan este enfoque para obtener validación temprana en las actualizaciones de sus aplicaciones dentro de su prácticas de [desarrollo ágil](https://en.wikipedia.org/wiki/Agile_software_development).</span><span class="sxs-lookup"><span data-stu-id="620bc-108">Many large enterprises with a web presence use this approach to get early validation on their app updates in their practice of [agile development](https://en.wikipedia.org/wiki/Agile_software_development).</span></span> <span data-ttu-id="620bc-109">Servicio de aplicaciones de Azure le permite toointegrate prueba en producción con la publicación continua y Application Insights tooimplement Hola mismo escenario de DevOps.</span><span class="sxs-lookup"><span data-stu-id="620bc-109">Azure App Service enables you toointegrate test in production with continous publishing and Application Insights tooimplement hello same DevOps scenario.</span></span> <span data-ttu-id="620bc-110">Las ventajas de este enfoque incluyen:</span><span class="sxs-lookup"><span data-stu-id="620bc-110">Benefits of this approach include:</span></span>

* <span data-ttu-id="620bc-111">**Obtener comentarios real *antes de* las actualizaciones están publicada tooproduction** -Hola solo lo mejor que tengan comentarios tan pronto como la versión está adquiriendo cada vez comentarios antes de liberar.</span><span class="sxs-lookup"><span data-stu-id="620bc-111">**Gain real feedback *before* updates are released tooproduction** - hello only thing better than gaining feedback as soon as you release is gaining feedback before you release.</span></span> <span data-ttu-id="620bc-112">Puede probar las actualizaciones con tráfico de usuario real y comportamientos tan pronto como se desee en el ciclo de vida de productos de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-112">You can test updates with real user traffic and behaviors as early as you desire in hello product life cycle.</span></span>
* <span data-ttu-id="620bc-113">**Mejora [del desarrollo continuo controlado por pruebas (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)** a través de la integración de pruebas en la producción, con integración continua e instrumentación con Application Insights, la validación de usuario se produce al principio y de forma automática dentro del ciclo de vida del producto.</span><span class="sxs-lookup"><span data-stu-id="620bc-113">**Enhance [continuous test-driven development (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)** - By integrating test in production with continuous integration and instrumentation with Application Insights, user validation happens early and automatically in your product life cycle.</span></span> <span data-ttu-id="620bc-114">Esto ayuda a reducir las inversiones de tiempo de ejecución de pruebas manuales.</span><span class="sxs-lookup"><span data-stu-id="620bc-114">This helps reduce time investments in manual test execution.</span></span>
* <span data-ttu-id="620bc-115">**Optimizar el flujo de trabajo de prueba** -mediante la automatización de prueba en producción con la instrumentación de supervisión continua, puede potencialmente lograr Hola objetivos de varias clases de pruebas en un único proceso, como [integración](https://en.wikipedia.org/wiki/Integration_testing), [regresión](https://en.wikipedia.org/wiki/Regression_testing), [facilidad de uso](https://en.wikipedia.org/wiki/Usability_testing), accesibilidad, localización, [rendimiento](https://en.wikipedia.org/wiki/Software_performance_testing), [seguridad](https://en.wikipedia.org/wiki/Security_testing), y [ aceptación](https://en.wikipedia.org/wiki/Acceptance_testing).</span><span class="sxs-lookup"><span data-stu-id="620bc-115">**Optimize test workflow** - By automating test in production with continuous monitoring instrumentation, you can potentially accomplish hello goals of various kinds of tests in a single process, such as [integration](https://en.wikipedia.org/wiki/Integration_testing), [regression](https://en.wikipedia.org/wiki/Regression_testing), [usability](https://en.wikipedia.org/wiki/Usability_testing), accessibility, localization, [performance](https://en.wikipedia.org/wiki/Software_performance_testing), [security](https://en.wikipedia.org/wiki/Security_testing), and [acceptance](https://en.wikipedia.org/wiki/Acceptance_testing).</span></span>

<span data-ttu-id="620bc-116">En una implementación de distribución de paquetes piloto, no se trata solamente del enrutamiento de tráfico real.</span><span class="sxs-lookup"><span data-stu-id="620bc-116">A flighting deployment is not just about routing live traffic.</span></span> <span data-ttu-id="620bc-117">En ese tipo de implementación que desee toogain una visión general de lo más rápido posible, ya sea un error inesperado, degradación del rendimiento, problemas de la experiencia de usuario.</span><span class="sxs-lookup"><span data-stu-id="620bc-117">In such a deployment you want toogain insight as quickly as possible, whether it be an unexpected bug, performance degradation, user experience issues.</span></span> <span data-ttu-id="620bc-118">Recuerde que se trata de los clientes reales.</span><span class="sxs-lookup"><span data-stu-id="620bc-118">Remember, you are dealing with real customers.</span></span> <span data-ttu-id="620bc-119">Toodo por lo que, a la derecha, debe asegurarse de que ha configurado el programa Windows Insider toogather implementación todos los datos de Hola que necesita en orden toomake una decisión informada para el paso siguiente.</span><span class="sxs-lookup"><span data-stu-id="620bc-119">So toodo it right, you must make sure that you have set up your flighting deployment toogather all hello data you need in order toomake an informed decision for your next step.</span></span> <span data-ttu-id="620bc-120">Este tutorial muestra cómo toocollect de datos con Application Insights, pero se puede utilizar New Relic u otras tecnologías que se adapte a su escenario.</span><span class="sxs-lookup"><span data-stu-id="620bc-120">This tutorial shows you how toocollect data with Application Insights, but you can use New Relic or other technologies that suits your scenario.</span></span>

## <a name="what-you-will-do"></a><span data-ttu-id="620bc-121">Lo que hará</span><span class="sxs-lookup"><span data-stu-id="620bc-121">What you will do</span></span>
<span data-ttu-id="620bc-122">En este tutorial, aprenderá cómo toobring Hola siguientes escenarios juntos tootest la aplicación de servicio de aplicaciones de producción:</span><span class="sxs-lookup"><span data-stu-id="620bc-122">In this tutorial, you will learn how toobring hello following scenarios together tootest your App Service app in production:</span></span>

* <span data-ttu-id="620bc-123">[Redirigir el tráfico de producción](app-service-web-test-in-production-get-start.md) tooyour beta aplicación</span><span class="sxs-lookup"><span data-stu-id="620bc-123">[Route production traffic](app-service-web-test-in-production-get-start.md) tooyour beta app</span></span>
* <span data-ttu-id="620bc-124">[Instrumentar la aplicación](../application-insights/app-insights-web-track-usage.md) tooobtain útil métricas</span><span class="sxs-lookup"><span data-stu-id="620bc-124">[Instrument your app](../application-insights/app-insights-web-track-usage.md) tooobtain useful metrics</span></span>
* <span data-ttu-id="620bc-125">Implementar la aplicación beta y realizar un seguimiento de las métricas de aplicación de forma continua</span><span class="sxs-lookup"><span data-stu-id="620bc-125">Continuously deploy your beta app and track live app metrics</span></span>
* <span data-ttu-id="620bc-126">Las métricas de comparación entre la aplicación de producción de hello y cómo cambia el código de hello beta aplicación toosee traducen tooresults</span><span class="sxs-lookup"><span data-stu-id="620bc-126">Compare metrics between hello production app and hello beta app toosee how code changes translate tooresults</span></span>

## <a name="what-you-will-need"></a><span data-ttu-id="620bc-127">Qué necesita</span><span class="sxs-lookup"><span data-stu-id="620bc-127">What you will need</span></span>
* <span data-ttu-id="620bc-128">Una cuenta de Azure</span><span class="sxs-lookup"><span data-stu-id="620bc-128">An Azure account</span></span>
* <span data-ttu-id="620bc-129">Una cuenta [GitHub](https://github.com/)</span><span class="sxs-lookup"><span data-stu-id="620bc-129">A [GitHub](https://github.com/) account</span></span>
* <span data-ttu-id="620bc-130">Visual Studio 2015: puede descargar hello [edición Community](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span><span class="sxs-lookup"><span data-stu-id="620bc-130">Visual Studio 2015 - you can download hello [Community edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span></span>
* <span data-ttu-id="620bc-131">GIT Shell (instalado con [GitHub para Windows](https://windows.github.com/))-Esto permite toorun ambos comandos de PowerShell y Git Hola Hola misma sesión</span><span class="sxs-lookup"><span data-stu-id="620bc-131">Git Shell (installed with [GitHub for Windows](https://windows.github.com/)) - this enables you toorun both hello Git and PowerShell commands in hello same session</span></span>
* <span data-ttu-id="620bc-132">Bits más recientes de [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi)</span><span class="sxs-lookup"><span data-stu-id="620bc-132">Latest [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi) bits</span></span>
* <span data-ttu-id="620bc-133">Conocimientos básicos de los siguientes hello:</span><span class="sxs-lookup"><span data-stu-id="620bc-133">Basic understanding of hello following:</span></span>
  * <span data-ttu-id="620bc-134">Implementación de plantillas de [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) (consulte [Aprovisionamiento e implementación predecibles de microservicios en Azure](app-service-deploy-complex-application-predictably.md))</span><span class="sxs-lookup"><span data-stu-id="620bc-134">[Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) template deployment (see [Deploy a complex application predictably in Azure](app-service-deploy-complex-application-predictably.md))</span></span>
  * [<span data-ttu-id="620bc-135">Git</span><span class="sxs-lookup"><span data-stu-id="620bc-135">Git</span></span>](http://git-scm.com/documentation)
  * [<span data-ttu-id="620bc-136">PowerShell</span><span class="sxs-lookup"><span data-stu-id="620bc-136">PowerShell</span></span>](https://technet.microsoft.com/library/bb978526.aspx)

> [!NOTE]
> <span data-ttu-id="620bc-137">Necesita una cuenta de Azure toocomplete este tutorial:</span><span class="sxs-lookup"><span data-stu-id="620bc-137">You need an Azure account toocomplete this tutorial:</span></span>
>
> * <span data-ttu-id="620bc-138">También puede [abrir una cuenta de Azure de forma gratuita](https://azure.microsoft.com/pricing/free-trial/) -obtendrá créditos puede usar tootry los servicios de Azure de pago e incluso después de que agoten puede mantener la cuenta de hello y libre de usar servicios de Azure, como las aplicaciones Web.</span><span class="sxs-lookup"><span data-stu-id="620bc-138">You can [open an Azure account for free](https://azure.microsoft.com/pricing/free-trial/) - You get credits you can use tootry out paid Azure services, and even after they're used up you can keep hello account and use free Azure services, such as Web Apps.</span></span>
> * <span data-ttu-id="620bc-139">Puede [activar las ventajas de suscriptor de Visual Studio](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) : su suscripción a Visual Studio le proporciona crédito todos los meses que puede usar con servicios de Azure de pago.</span><span class="sxs-lookup"><span data-stu-id="620bc-139">You can [activate Visual Studio subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) - Your Visual Studio subscription gives you credits every month that you can use for paid Azure services.</span></span>
>
> <span data-ttu-id="620bc-140">Si desea tooget iniciado con el servicio de aplicación de Azure antes de registrarse para una cuenta de Azure, vaya demasiado[pruebe el servicio de aplicaciones](https://azure.microsoft.com/try/app-service/), donde puede crear inmediatamente una aplicación web de inicio de corta duración en el servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="620bc-140">If you want tooget started with Azure App Service before signing up for an Azure account, go too[Try App Service](https://azure.microsoft.com/try/app-service/), where you can immediately create a short-lived starter web app in App Service.</span></span> <span data-ttu-id="620bc-141">No es necesario proporcionar ninguna tarjeta de crédito ni asumir ningún compromiso.</span><span class="sxs-lookup"><span data-stu-id="620bc-141">No credit cards required; no commitments.</span></span>
>
>

## <a name="set-up-your-production-web-app"></a><span data-ttu-id="620bc-142">Configuración de la aplicación web de producción</span><span class="sxs-lookup"><span data-stu-id="620bc-142">Set up your production web app</span></span>
> [!NOTE]
> <span data-ttu-id="620bc-143">script de Hola utilizado en este tutorial configurará automáticamente la publicación continua desde el repositorio de GitHub.</span><span class="sxs-lookup"><span data-stu-id="620bc-143">hello script used in this tutorial will automatically configure continuous publishing from your GitHub repository.</span></span> <span data-ttu-id="620bc-144">Esto requiere que las credenciales de GitHub ya están almacenadas en Azure, en caso contrario hello mediante secuencias de comandos se producirá un error al intentar tooconfigure configuración de control de código fuente para las aplicaciones web de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-144">This requires that your GitHub credentials are already stored in Azure, otherwise hello scripted deployment will fail when attempting tooconfigure source control settings for hello web apps.</span></span>
>
> <span data-ttu-id="620bc-145">toostore su GitHub credenciales de Azure, cree una aplicación web en hello [Portal de Azure](https://portal.azure.com/) y [configurar la implementación de GitHub](app-service-continuous-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="620bc-145">toostore your GitHub credentials in Azure, create a web app in hello [Azure Portal](https://portal.azure.com/) and [configure GitHub deployment](app-service-continuous-deployment.md).</span></span> <span data-ttu-id="620bc-146">Solo necesita esta vez toodo.</span><span class="sxs-lookup"><span data-stu-id="620bc-146">You only need toodo this once.</span></span>
>
>

<span data-ttu-id="620bc-147">En un escenario típico de DevOps, tiene una aplicación que se ejecuta en Azure y desea toomake cambios tooit a través de la publicación continua.</span><span class="sxs-lookup"><span data-stu-id="620bc-147">In a typical DevOps scenario, you have an application that’s running live in Azure, and you want toomake changes tooit through continuous publishing.</span></span> <span data-ttu-id="620bc-148">En este escenario, implementará tooproduction una plantilla que haya desarrollado y probado.</span><span class="sxs-lookup"><span data-stu-id="620bc-148">In this scenario, you will deploy tooproduction a template that you have developed and tested.</span></span>

1. <span data-ttu-id="620bc-149">Crear su propia bifurcación de hello [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repositorio.</span><span class="sxs-lookup"><span data-stu-id="620bc-149">Create your own fork of hello [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repository.</span></span> <span data-ttu-id="620bc-150">Para obtener información sobre la creación de la bifurcación, consulte [Bifurcación de un repositorio](https://help.github.com/articles/fork-a-repo/).</span><span class="sxs-lookup"><span data-stu-id="620bc-150">For information on creating your fork, see [Fork a Repo](https://help.github.com/articles/fork-a-repo/).</span></span> <span data-ttu-id="620bc-151">Una vez creada la bifurcación, puede verla en el explorador.</span><span class="sxs-lookup"><span data-stu-id="620bc-151">Once your fork is created, you can see it in your browser.</span></span>

   ![](./media/app-service-agile-software-development/production-1-private-repo.png)
2. <span data-ttu-id="620bc-152">Abra una sesión del Shell de Git.</span><span class="sxs-lookup"><span data-stu-id="620bc-152">Open a Git Shell session.</span></span> <span data-ttu-id="620bc-153">Si aún no tiene el Shell de Git, instale ahora [GitHub para Windows](https://windows.github.com/) .</span><span class="sxs-lookup"><span data-stu-id="620bc-153">If you don't have Git Shell yet, install [GitHub for Windows](https://windows.github.com/) now.</span></span>
3. <span data-ttu-id="620bc-154">Crear un clon de la bifurcación local mediante la ejecución de hello siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="620bc-154">Create a local clone of your fork by executing hello following command:</span></span>

     <span data-ttu-id="620bc-155">git clone https://github.com/<su_bifurcación>/ToDoApp.git</span><span class="sxs-lookup"><span data-stu-id="620bc-155">git clone https://github.com/<your_fork>/ToDoApp.git</span></span>
4. <span data-ttu-id="620bc-156">Una vez que tenga el clon local, vaya demasiado*&lt;repository_root >*\ARMTemplates y ejecución hello deploy.ps1 secuencia de comandos con un sufijo único, como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="620bc-156">Once you have your local clone, navigate too*&lt;repository_root>*\ARMTemplates, and run hello deploy.ps1 script with a unique suffix, as shown below:</span></span>

     <span data-ttu-id="620bc-157">.\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix></span><span class="sxs-lookup"><span data-stu-id="620bc-157">.\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix></span></span>
5. <span data-ttu-id="620bc-158">Cuando se le solicite, escriba el nombre de usuario de hello deseado y una contraseña para el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="620bc-158">When prompted, type in hello desired username and password for database access.</span></span> <span data-ttu-id="620bc-159">Recordar las credenciales de la base de datos ya que necesitará toospecify implementarlos de nuevo cuando la actualización Hola grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="620bc-159">Remember your database credentials because you will need toospecify them again when updating hello resource group.</span></span>

   <span data-ttu-id="620bc-160">Debería ver Hola aprovisionamiento progreso por varios recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="620bc-160">You should see hello provisioning progress of various Azure resources.</span></span> <span data-ttu-id="620bc-161">Cuando se completa la implementación, el script de Hola Iniciar aplicación hello en el Explorador de Hola y proporcionarle un bip descriptivo.</span><span class="sxs-lookup"><span data-stu-id="620bc-161">When deployment completes, hello script will launch hello application in hello browser and give you a friendly beep.</span></span>
   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.1-app-in-browser.png)
6. <span data-ttu-id="620bc-162">De nuevo en la sesión del Shell de Git, ejecute:</span><span class="sxs-lookup"><span data-stu-id="620bc-162">Back in your Git Shell session, run:</span></span>

     <span data-ttu-id="620bc-163">.\swap –Name ToDoApp<su_sufijo></span><span class="sxs-lookup"><span data-stu-id="620bc-163">.\swap –Name ToDoApp<your_suffix></span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.2-swap-to-production.png)
7. <span data-ttu-id="620bc-164">Cuando finaliza el script de Hola, vuelva atrás toobrowse toohello dirección del front-end (http://ToDoApp*&lt;your_suffix >*.azurewebsites.net/) toosee Hola ejecuta aplicación en producción.</span><span class="sxs-lookup"><span data-stu-id="620bc-164">When hello script finishes, go back toobrowse toohello frontend’s address (http://ToDoApp*&lt;your_suffix>*.azurewebsites.net/) toosee hello application running in production.</span></span>
8. <span data-ttu-id="620bc-165">Inicie sesión en hello [Portal de Azure](https://portal.azure.com/) y eche un vistazo a lo que se crea.</span><span class="sxs-lookup"><span data-stu-id="620bc-165">Log into hello [Azure Portal](https://portal.azure.com/) and take a look at what’s created.</span></span>

   <span data-ttu-id="620bc-166">Debe ser capaz de toosee dos aplicaciones de web Hola mismo grupo de recursos, uno con hello `Api` sufijo de nombre de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-166">You should be able toosee two web apps in hello same resource group, one with hello `Api` suffix in hello name.</span></span> <span data-ttu-id="620bc-167">Si observa en vista de grupo de recursos de hello, también verá Hola base de datos SQL y servidor, Hola plan de servicio de aplicaciones y zonas de ensayo de Hola para las aplicaciones web de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-167">If you look at hello resource group view, you will also see hello SQL Database and server, hello App Service plan, and hello staging slots for hello web apps.</span></span> <span data-ttu-id="620bc-168">Examine los distintos recursos de Hola y compararlos con  *&lt;repository_root >*toosee \ARMTemplates\ProdAndStage.json cómo estén configuradas en la plantilla de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-168">Browse through hello different resources and compare them with *&lt;repository_root>*\ARMTemplates\ProdAndStage.json toosee how they are configured in hello template.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.3-resource-group-view.png)

<span data-ttu-id="620bc-169">Ha configurado la aplicación de producción de hello.</span><span class="sxs-lookup"><span data-stu-id="620bc-169">You have set up hello production app.</span></span>  <span data-ttu-id="620bc-170">Ahora, imaginemos que recibe información que es insuficiente para la aplicación hello facilidad de uso.</span><span class="sxs-lookup"><span data-stu-id="620bc-170">Now, let's imagine that you receive feedback that usability is poor for hello app.</span></span> <span data-ttu-id="620bc-171">Por lo que decida tooinvestigate.</span><span class="sxs-lookup"><span data-stu-id="620bc-171">So you decide tooinvestigate.</span></span> <span data-ttu-id="620bc-172">Se vayan tooinstrument toogive de su aplicación, comentarios.</span><span class="sxs-lookup"><span data-stu-id="620bc-172">You're going tooinstrument your app toogive you feedback.</span></span>

## <a name="investigate-instrument-your-client-app-for-monitoringmetrics"></a><span data-ttu-id="620bc-173">Investigación: instrumentar la aplicación de cliente para supervisión y métricas</span><span class="sxs-lookup"><span data-stu-id="620bc-173">Investigate: Instrument your client app for monitoring/metrics</span></span>
1. <span data-ttu-id="620bc-174">Abra *&lt;raíz_repositorio>*\src\MultiChannelToDo.sln en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="620bc-174">Open *&lt;repository_root>*\src\MultiChannelToDo.sln in Visual Studio.</span></span>
2. <span data-ttu-id="620bc-175">Restaure todos los paquetes de Nuget haciendo clic con el botón derecho en la solución > **Administrar paquetes de NuGet para la solución** > **Restaurar**.</span><span class="sxs-lookup"><span data-stu-id="620bc-175">Restore all Nuget packages by right-clicking solution > **Manage NuGet Packages for Solution** > **Restore**.</span></span>
3. <span data-ttu-id="620bc-176">Haga clic en **MultiChannelToDo.Web** > **Agregar aplicación visión telemetría** > **configurar opciones de** > grupo de recursos de cambio tooToDoApp*&lt;your_suffix >* > **tooProject agregar Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="620bc-176">Right-click **MultiChannelToDo.Web** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
4. <span data-ttu-id="620bc-177">Hola Portal de Azure, abra hoja Hola para hello **MultiChannelToDo.Web** recursos Application Insight.</span><span class="sxs-lookup"><span data-stu-id="620bc-177">In hello Azure Portal, open hello blade for hello **MultiChannelToDo.Web** Application Insight resource.</span></span> <span data-ttu-id="620bc-178">A continuación, en hello **estado de la aplicación** parte, haga clic en **Obtenga información acerca de la página del explorador toocollect cargar datos** > Copiar el código.</span><span class="sxs-lookup"><span data-stu-id="620bc-178">Then in hello **Application health** part, click **Learn how toocollect browser page load data** > copy code.</span></span>
5. <span data-ttu-id="620bc-179">Agregar Hola copia código de instrumentación de JS demasiado*&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, justo antes de cerrarse de hello `<heading>` etiqueta.</span><span class="sxs-lookup"><span data-stu-id="620bc-179">Add hello copied JS instrumentation code too*&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, just before hello closing `<heading>` tag.</span></span> <span data-ttu-id="620bc-180">Debe incluir Hola Instrumental única clave del recurso Application Insight.</span><span class="sxs-lookup"><span data-stu-id="620bc-180">It should contain hello unique instrumentation key of your Application Insight resource.</span></span>

        <script type="text/javascript">
        var appInsights=window.appInsights||function(config){
            function s(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},r=document,f=window,e="script",o=r.createElement(e),i,u;for(o.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",r.getElementsByTagName(e)[0].parentNode.appendChild(o),t.cookie=r.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)s("track"+i.pop());return config.disableExceptionTracking||(i="onerror",s("_"+i),u=f[i],f[i]=function(config,r,f,e,o){var s=u&&u(config,r,f,e,o);return s!==!0&&t["_"+i](config,r,f,e,o),s}),t
        }({
            instrumentationKey:"<your_unique_instrumentation_key>"
        });

        window.appInsights=appInsights;
        appInsights.trackPageView();
        </script>
6. <span data-ttu-id="620bc-181">Enviar eventos personalizados tooApplication visión de clics del mouse mediante la adición de hello después de la parte inferior de toohello de código del cuerpo:</span><span class="sxs-lookup"><span data-stu-id="620bc-181">Send custom events tooApplication Insights for mouse clicks by adding hello following code toohello bottom of body:</span></span>

       <script>
           $(document.body).find("*").click(function(event) {

               appInsights.trackEvent(event.target.tagName + ": " + event.target.className);
           });
       </script>

   <span data-ttu-id="620bc-182">Este fragmento de código de JavaScript envía un evento personalizado tooApplication información cada vez que un usuario hace clic en cualquier lugar en la aplicación web de hello.</span><span class="sxs-lookup"><span data-stu-id="620bc-182">This JavaScript snippet sends a custom event tooApplication Insights every time a user clicks anywhere in hello web app.</span></span>
7. <span data-ttu-id="620bc-183">En el Shell de Git, confirme e inserte la bifurcación de tooyour cambios en GitHub.</span><span class="sxs-lookup"><span data-stu-id="620bc-183">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="620bc-184">A continuación, espere explorador toorefresh de los clientes.</span><span class="sxs-lookup"><span data-stu-id="620bc-184">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for client app"
       git push origin master
8. <span data-ttu-id="620bc-185">Hola de intercambio implementado tooproduction de cambios de aplicación:</span><span class="sxs-lookup"><span data-stu-id="620bc-185">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="620bc-186">.\swap –Name ToDoApp<su_sufijo></span><span class="sxs-lookup"><span data-stu-id="620bc-186">.\swap –Name ToDoApp<your_suffix></span></span>
9. <span data-ttu-id="620bc-187">Examinar los recursos de Application Insights toohello que ha configurado.</span><span class="sxs-lookup"><span data-stu-id="620bc-187">Browse toohello Application Insights resource that you configured.</span></span> <span data-ttu-id="620bc-188">Haga clic en Eventos personalizados</span><span class="sxs-lookup"><span data-stu-id="620bc-188">Click Custom events.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/01-custom-events.png)

   <span data-ttu-id="620bc-189">Si no ve las métricas para los eventos personalizados, espere unos minutos y haga clic en **Actualizar**.</span><span class="sxs-lookup"><span data-stu-id="620bc-189">If you don't see metrics for custom events, wait a few minutes and click **Refresh**.</span></span>

<span data-ttu-id="620bc-190">Supongamos que ve un gráfico como el siguiente:</span><span class="sxs-lookup"><span data-stu-id="620bc-190">Suppose you see a chart like below:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/02-custom-events-chart-view.png)

<span data-ttu-id="620bc-191">Y cuadrícula de eventos de Hola por debajo de él:</span><span class="sxs-lookup"><span data-stu-id="620bc-191">And hello event grid below it:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/03-custom-event-grid-view.png)

<span data-ttu-id="620bc-192">Según el código de la aplicación de tooyour ToDoApp, Hola **botón** evento corresponde hello y botón de envío de toohello **entrada** evento corresponde toohello cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="620bc-192">According tooyour ToDoApp application code, hello **BUTTON** event corresponds toohello submit button, and hello **INPUT** event corresponds toohello textbox.</span></span> <span data-ttu-id="620bc-193">Hasta aquí, todo está claro.</span><span class="sxs-lookup"><span data-stu-id="620bc-193">So far, things make sense.</span></span> <span data-ttu-id="620bc-194">Sin embargo, parece que hay una gran cantidad de clics y muy pocos clics en los elementos de tareas pendientes de hello (hello **LI** eventos).</span><span class="sxs-lookup"><span data-stu-id="620bc-194">However, it looks like there's a good amount of clicks and very few clicks on hello to-do items (hello **LI** events).</span></span>

<span data-ttu-id="620bc-195">A partir de este, formulario esas hipótesis que algunos usuarios confundir qué parte del programa Hola a interfaz de usuario es interactivo y es porque el estilo del cursor de hello para la selección de texto cuando mantiene el mouse sobre elementos de lista de Hola y sus iconos.</span><span class="sxs-lookup"><span data-stu-id="620bc-195">Based on this, you form your hypothesis that some users are confused which part of hello UI is clickable and it is because hello cursor is styled for text selection when it hovers on hello list items and their icons.</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/04-to-do-list-item-ui.png)

<span data-ttu-id="620bc-196">Este podría ser un ejemplo inventado.</span><span class="sxs-lookup"><span data-stu-id="620bc-196">This might be a contrived example.</span></span> <span data-ttu-id="620bc-197">No obstante, está continuo toomake una aplicación de tooyour mejora y, a continuación, realizar un programa Windows Insider comentarios de facilidad de uso de tooget de implementación de clientes en vivo.</span><span class="sxs-lookup"><span data-stu-id="620bc-197">Nevertheless, you're going toomake an improvement tooyour app, and then perform a flighting deployment tooget usability feedback from live customers.</span></span>

### <a name="instrument-your-server-app-for-monitoringmetrics"></a><span data-ttu-id="620bc-198">Instrumentación de la aplicación del servidor para supervisión y métricas</span><span class="sxs-lookup"><span data-stu-id="620bc-198">Instrument your server app for monitoring/metrics</span></span>
<span data-ttu-id="620bc-199">Se trata de una tangente puesto que el escenario de Hola que se muestran en este tutorial solo se ocupa de la aplicación de cliente de hello.</span><span class="sxs-lookup"><span data-stu-id="620bc-199">This is a tangent since hello scenario demonstrated in this tutorial only deals with hello client app.</span></span> <span data-ttu-id="620bc-200">Sin embargo, a efectos de integridad a configurar aplicación de servidor hello.</span><span class="sxs-lookup"><span data-stu-id="620bc-200">However, for completeness you will set up hello server-side app.</span></span>

1. <span data-ttu-id="620bc-201">Haga clic en **MultiChannelToDo** > **Agregar aplicación visión telemetría** > **configurar opciones de** > grupo de recursos de cambio tooToDoApp*&lt;your_suffix >* > **tooProject agregar Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="620bc-201">Right-click **MultiChannelToDo** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
2. <span data-ttu-id="620bc-202">En el Shell de Git, confirme e inserte la bifurcación de tooyour cambios en GitHub.</span><span class="sxs-lookup"><span data-stu-id="620bc-202">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="620bc-203">A continuación, espere explorador toorefresh de los clientes.</span><span class="sxs-lookup"><span data-stu-id="620bc-203">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for server app"
       git push origin master
3. <span data-ttu-id="620bc-204">Hola de intercambio implementado tooproduction de cambios de aplicación:</span><span class="sxs-lookup"><span data-stu-id="620bc-204">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="620bc-205">.\swap –Name ToDoApp<su_sufijo></span><span class="sxs-lookup"><span data-stu-id="620bc-205">.\swap –Name ToDoApp<your_suffix></span></span>

<span data-ttu-id="620bc-206">Eso es todo.</span><span class="sxs-lookup"><span data-stu-id="620bc-206">That's it!</span></span>

## <a name="investigate-add-slot-specific-tags-tooyour-client-app-metrics"></a><span data-ttu-id="620bc-207">Investigar: Agregar métricas de aplicación de cliente de etiquetas específicas de la ranura tooyour</span><span class="sxs-lookup"><span data-stu-id="620bc-207">Investigate: Add slot-specific tags tooyour client app metrics</span></span>
<span data-ttu-id="620bc-208">En esta sección, configurará Hola implementación diferentes ranuras toosend telemetría específica de la ranura toohello mismo recurso de Application Insights.</span><span class="sxs-lookup"><span data-stu-id="620bc-208">In this section, you will configure hello different deployment slots toosend slot-specific telemetry toohello same Application Insights resource.</span></span> <span data-ttu-id="620bc-209">De esta manera, puede comparar la telemetría datos entre el tráfico de ranuras diferentes (entornos de implementación) tooeasily ver el efecto de Hola de los cambios de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="620bc-209">This way, you can compare telemetry data between traffic from different slots (deployment environments) tooeasily see hello effect of your app changes.</span></span> <span data-ttu-id="620bc-210">Hola al mismo tiempo, puede separar el tráfico de producción de hello de rest de Hola para que pueda continuar toomonitor la aplicación de producción según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="620bc-210">At hello same time, you can separate hello production traffic from hello rest so you can continue toomonitor your production app as needed.</span></span>

<span data-ttu-id="620bc-211">Puesto que va a recopilar datos en el comportamiento del cliente, que se van a [agregar un tooyour de inicializador de telemetría código JavaScript](../application-insights/app-insights-api-filtering-sampling.md) en index.cshtml.</span><span class="sxs-lookup"><span data-stu-id="620bc-211">Since you're gathering data on client behavior, you will [add a telemetry initializer tooyour JavaScript code](../application-insights/app-insights-api-filtering-sampling.md) in index.cshtml.</span></span> <span data-ttu-id="620bc-212">Si desea que el rendimiento del servidor de tootest, por ejemplo, también puede hacer de forma similar en el código del servidor (consulte [API de visión de la aplicación para eventos personalizados y las métricas](../application-insights/app-insights-api-custom-events-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="620bc-212">If you want tootest server-side performance, for example, you can also do similarly in your server code (see [Application Insights API for custom events and metrics](../application-insights/app-insights-api-custom-events-metrics.md).</span></span>

1. <span data-ttu-id="620bc-213">En primer lugar, agregue Hola de fuente del código de hello dos `//` comentarios a continuación en el bloque de JavaScript de Hola que ha agregado toohello `<heading>` etiqueta anteriormente.</span><span class="sxs-lookup"><span data-stu-id="620bc-213">First, add hello code bewteen hello two `//` comments below in hello JavaScript block that you added toohello `<heading>` tag earlier.</span></span>

        window.appInsights = appInsights;

        // Begin new code
        appInsights.queue.push(function () {
            appInsights.context.addTelemetryInitializer(function (envelope) {
                var telemetryItem = envelope.data.baseData;
                telemetryItem.properties = telemetryItem.properties || {};
                telemetryItem.properties["Environment"] = "@System.Configuration.ConfigurationManager.AppSettings["environment"]";
            });
        });
        // End new code

        appInsights.trackPageView();

    <span data-ttu-id="620bc-214">Este código de inicializador hace hello `appInsights` tooadd objeto Hola una propiedad personalizada denominada `Environment` tooevery parte de telemetría envía.</span><span class="sxs-lookup"><span data-stu-id="620bc-214">This initializer code causes hello `appInsights` object tooadd hello a custom property called `Environment` tooevery piece of telemetry it sends.</span></span>
2. <span data-ttu-id="620bc-215">A continuación, agregue esta propiedad personalizada como una [configuración de ranura](web-sites-staged-publishing.md#AboutConfiguration) para la aplicación web en Azure.</span><span class="sxs-lookup"><span data-stu-id="620bc-215">Next, add this custom property as a [slot setting](web-sites-staged-publishing.md#AboutConfiguration) for your web app in Azure.</span></span> <span data-ttu-id="620bc-216">toodo, Hola ejecución siga los comandos en la sesión de Git Shell.</span><span class="sxs-lookup"><span data-stu-id="620bc-216">toodo this, run hello following commands in your Git Shell session.</span></span>

        $app = Get-AzureWebsite -Name todoapp<your_suffix> -Slot production
        $app.AppSettings.Add("environment", "Production")
        $app.SlotStickyAppSettingNames.Add("environment")
        $app | Set-AzureWebsite -Name todoapp<your_suffix> -Slot production

    <span data-ttu-id="620bc-217">Hola Web.config en el proyecto ya define hello `environment` configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="620bc-217">hello Web.config in your project already defines hello `environment` app setting.</span></span> <span data-ttu-id="620bc-218">Con esta configuración, al probar la aplicación hello localmente, las métricas se etiqueta con `VS Debugger`.</span><span class="sxs-lookup"><span data-stu-id="620bc-218">With this setting, when you test hello app locally, your metrics will be tagged with `VS Debugger`.</span></span> <span data-ttu-id="620bc-219">Sin embargo, cuando realice una inserción su tooAzure cambios, Azure se encuentra y usar hello `environment` aplicación establecer en la configuración de la aplicación hello web en su lugar y la métrica se etiqueta con `Production`.</span><span class="sxs-lookup"><span data-stu-id="620bc-219">However, when you push your changes tooAzure, Azure will find and use hello `environment` app setting in hello web app's configuration instead, and your metrics will be tagged with `Production`.</span></span>
3. <span data-ttu-id="620bc-220">Confirmar inserción la bifurcación de tooyour de cambios de código en GitHub y esperar a que la aplicación nueva de los usuarios toouse Hola (necesidad toorefresh Hola explorador).</span><span class="sxs-lookup"><span data-stu-id="620bc-220">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="620bc-221">Ocupe Hola nueva propiedad tooshow unos 15 minutos en la información de la aplicación `MultiChannelToDo.Web` recursos.</span><span class="sxs-lookup"><span data-stu-id="620bc-221">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo.Web` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for client app"
        git push origin master
4. <span data-ttu-id="620bc-222">Ahora, vaya toohello **eventos personalizados** hoja nuevo y filtro Hola métricas en `Environment=Production`.</span><span class="sxs-lookup"><span data-stu-id="620bc-222">Now, go toohello **Custom events** blade again and filter hello metrics on `Environment=Production`.</span></span> <span data-ttu-id="620bc-223">Ahora debe ser capaz de toosee todos los Hola nuevos eventos personalizados en producción de hello zona con este filtro.</span><span class="sxs-lookup"><span data-stu-id="620bc-223">You should now be able toosee all hello new custom events in hello production slot with this filter.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/05-filter-on-production-environment.png)
5. <span data-ttu-id="620bc-224">Haga clic en hello **favoritos** como botón toosave Hola actual explorador métricas configuración toosomething **eventos personalizados: producción**.</span><span class="sxs-lookup"><span data-stu-id="620bc-224">Click hello **Favorites** button toosave hello current Metrics Explorer settings toosomething like **Custom events: Production**.</span></span> <span data-ttu-id="620bc-225">Más adelante puede cambiar fácilmente entre esta vista y la vista de una ranura de implementación.</span><span class="sxs-lookup"><span data-stu-id="620bc-225">You can easily switch between this view and a deployment slot view later.</span></span>

   > [!TIP]
   > <span data-ttu-id="620bc-226">Para realizar análisis aún más eficaces, considere la posibilidad de la [integración de los recursos de Application Insights con Power BI](../application-insights/app-insights-export-power-bi.md).</span><span class="sxs-lookup"><span data-stu-id="620bc-226">For even more powerful analytics, consider [integrating your Application Insights resource with Power BI](../application-insights/app-insights-export-power-bi.md).</span></span>
   >
   >

### <a name="add-slot-specific-tags-tooyour-server-app-metrics"></a><span data-ttu-id="620bc-227">Agregar etiquetas específicas de la ranura tooyour server aplicación métricas</span><span class="sxs-lookup"><span data-stu-id="620bc-227">Add slot-specific tags tooyour server app metrics</span></span>
<span data-ttu-id="620bc-228">Una vez más, por integridad, se establecerá una aplicación de servidor hello.</span><span class="sxs-lookup"><span data-stu-id="620bc-228">Again, for completeness you will set up hello server-side app.</span></span> <span data-ttu-id="620bc-229">A diferencia de la aplicación de cliente de hello que se indique en JavaScript, etiquetas específicos de la ranura de aplicación de servidor hello se ha instrumentado con código. NET.</span><span class="sxs-lookup"><span data-stu-id="620bc-229">Unlike hello client app which is instrumented in JavaScript, slot-specific tags for hello server app is instrumented with .NET code.</span></span>

1. <span data-ttu-id="620bc-230">Abra *&lt;raíz_repositorio>*\src\MultiChannelToDo\Global.asax.cs.</span><span class="sxs-lookup"><span data-stu-id="620bc-230">Open *&lt;repository_root>*\src\MultiChannelToDo\Global.asax.cs.</span></span> <span data-ttu-id="620bc-231">Agregar bloque de código de hello a continuación, justo antes de hello Cerrar llave de espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="620bc-231">Add hello code block below, just before hello closing namespace curly brace.</span></span>

        namespace MultiChannelToDo
        {
                ...

                // Begin new code
            public class ConfigInitializer
            : ITelemetryInitializer
            {
                void ITelemetryInitializer.Initialize(ITelemetry telemetry)
                {
                    telemetry.Context.Properties["Environment"] = System.Configuration.ConfigurationManager.AppSettings["environment"];
                }
            }
                // End new code
        }
2. <span data-ttu-id="620bc-232">Corregir errores de resolución de nombres de hello agregando hello `using` instrucciones a continuación toohello a partir del archivo hello:</span><span class="sxs-lookup"><span data-stu-id="620bc-232">Correct hello name resolution errors by adding hello `using` statements below toohello beginning of hello file:</span></span>

        using Microsoft.ApplicationInsights.Channel;
        using Microsoft.ApplicationInsights.Extensibility;
3. <span data-ttu-id="620bc-233">Agregue código de hello debajo toohello a partir de hello `Application_Start()` método:</span><span class="sxs-lookup"><span data-stu-id="620bc-233">Add hello code below toohello beginning of hello `Application_Start()` method:</span></span>

        TelemetryConfiguration.Active.TelemetryInitializers.Add(new ConfigInitializer());
4. <span data-ttu-id="620bc-234">Confirmar inserción la bifurcación de tooyour de cambios de código en GitHub y esperar a que la aplicación nueva de los usuarios toouse Hola (necesidad toorefresh Hola explorador).</span><span class="sxs-lookup"><span data-stu-id="620bc-234">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="620bc-235">Ocupe Hola nueva propiedad tooshow unos 15 minutos en la información de la aplicación `MultiChannelToDo` recursos.</span><span class="sxs-lookup"><span data-stu-id="620bc-235">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for server app"
        git push origin master

## <a name="update-set-up-your-beta-branch"></a><span data-ttu-id="620bc-236">Actualización: configurar la bifurcación de la versión beta</span><span class="sxs-lookup"><span data-stu-id="620bc-236">Update: Set up your beta branch</span></span>
1. <span data-ttu-id="620bc-237">Abra  *&lt;repository_root >*\ARMTemplates\ProdAndStagetest.json y buscar hello `appsettings` recursos (buscar `"name": "appsettings"`).</span><span class="sxs-lookup"><span data-stu-id="620bc-237">Open *&lt;repository_root>*\ARMTemplates\ProdAndStagetest.json and find hello `appsettings` resources (search for `"name": "appsettings"`).</span></span> <span data-ttu-id="620bc-238">Hay 4 de ellos, uno para cada ranura.</span><span class="sxs-lookup"><span data-stu-id="620bc-238">There are 4 of them, one for each slot.</span></span>
2. <span data-ttu-id="620bc-239">Para cada `appsettings` recursos, agregue un `"environment": "[parameters('slotName')]"` toohello final de configuración de aplicación de hello `properties` matriz.</span><span class="sxs-lookup"><span data-stu-id="620bc-239">For each `appsettings` resource, add an  `"environment": "[parameters('slotName')]"` app setting toohello end of hello `properties` array.</span></span> <span data-ttu-id="620bc-240">No olvide la línea anterior de hello tooend con una coma.</span><span class="sxs-lookup"><span data-stu-id="620bc-240">Don't forget tooend hello previous line with a comma.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/06-arm-app-setting-with-slot-name.png)

    <span data-ttu-id="620bc-241">Acaba de agregar hello `environment` aplicación establecer tooall ranuras de hello en plantilla Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-241">You have just added hello `environment` app setting tooall hello slots in hello template.</span></span>
3. <span data-ttu-id="620bc-242">En Hola el mismo archivo, busque hello `slotconfignames` recursos (buscar `"name": "slotconfignames"`).</span><span class="sxs-lookup"><span data-stu-id="620bc-242">In hello same file, find hello `slotconfignames` resources (search for `"name": "slotconfignames"`).</span></span> <span data-ttu-id="620bc-243">Hay 2 de ellos, uno para cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="620bc-243">There are 2 of them, one for each app.</span></span>
4. <span data-ttu-id="620bc-244">Para cada `slotconfignames` recursos, agregue `"environment"` toohello final de hello `appSettingNames` matriz.</span><span class="sxs-lookup"><span data-stu-id="620bc-244">For each `slotconfignames` resource, add `"environment"` toohello end of hello `appSettingNames` array.</span></span> <span data-ttu-id="620bc-245">No olvide la línea anterior de hello tooend con una coma.</span><span class="sxs-lookup"><span data-stu-id="620bc-245">Don't forget tooend hello previous line with a comma.</span></span>

    <span data-ttu-id="620bc-246">Acaba de crear hello `environment` configuración stick tooits implementación respectivos la ranura de aplicación para las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="620bc-246">You have just made hello `environment` app setting stick tooits respective deployment slot for both apps.</span></span>  
5. <span data-ttu-id="620bc-247">En la sesión de Git Shell, siguiente ejecución Hola comandos con hello mismo sufijo de grupo de recursos que usó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="620bc-247">In your Git Shell session, run hello following commands with hello same resource group suffix that you used before.</span></span>

        git checkout -b beta
        git push origin beta
        .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch beta
6. <span data-ttu-id="620bc-248">Cuando se le solicite, especifique Hola mismas credenciales de base de datos SQL como antes.</span><span class="sxs-lookup"><span data-stu-id="620bc-248">When prompted, specify hello same SQL database credentials as before.</span></span> <span data-ttu-id="620bc-249">A continuación, cuando solicita el grupo de recursos de hello tooupdate, tipo `Y`, a continuación, `ENTER`.</span><span class="sxs-lookup"><span data-stu-id="620bc-249">Then, when asked tooupdate hello resource group, type `Y`, then `ENTER`.</span></span>

    <span data-ttu-id="620bc-250">Una vez que finaliza el script de Hola, se conservan todos los recursos en el grupo de recursos de hello original, pero una ranura nueva denominada "beta" que se crea en él con hello mismo configuración como ranura de "Ensayo" hello que se creó en el principio de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-250">Once hello script finishes, all your resources in hello original resource group are retained, but a new slot named "beta" is created in it with hello same configuration as hello "Staging" slot that was created in hello beginning.</span></span>

   > [!NOTE]
   > <span data-ttu-id="620bc-251">Este método de creación de diferentes entornos de implementación es diferente del método hello en [desarrollo de software ágil con el servicio de aplicación de Azure](app-service-agile-software-development.md).</span><span class="sxs-lookup"><span data-stu-id="620bc-251">This method of creating different deployment environments is different from hello method in [Agile software development with Azure App Service](app-service-agile-software-development.md).</span></span> <span data-ttu-id="620bc-252">Aquí puede crear entornos de implementación con las ranuras de implementación, mientras que en el otro caso los entornos de implementación se crean con grupos de recursos.</span><span class="sxs-lookup"><span data-stu-id="620bc-252">Here, you create deployment environments with deployment slots, where as there you create deployment environments with resource groups.</span></span> <span data-ttu-id="620bc-253">La administración de entornos de implementación con grupos de recursos permite toodevelopers off-limits del entorno de producción hello tookeep, pero no resulta fácil toodo pruebas en producción, lo que puede hacer fácilmente con ranuras.</span><span class="sxs-lookup"><span data-stu-id="620bc-253">Managing deployment environments with resource groups enables you tookeep hello production environment off-limits toodevelopers, but it's not easy toodo testing in production, which you can do easily with slots.</span></span>
   >
   >

<span data-ttu-id="620bc-254">Si lo desea, también puede crear una aplicación alfa ejecutando</span><span class="sxs-lookup"><span data-stu-id="620bc-254">If you wish, you can also create an alpha app by running</span></span>

    git checkout -b alpha
    git push origin alpha
    .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch alpha

<span data-ttu-id="620bc-255">Para este tutorial, continúe usando la aplicación beta.</span><span class="sxs-lookup"><span data-stu-id="620bc-255">For this tutorial, you will just keep using your beta app.</span></span>

## <a name="update-push-your-updates-toohello-beta-app"></a><span data-ttu-id="620bc-256">Actualización: La aplicación de actualizaciones toohello beta de inserción</span><span class="sxs-lookup"><span data-stu-id="620bc-256">Update: Push your updates toohello beta app</span></span>
<span data-ttu-id="620bc-257">Realice una copia de aplicación de tooyour que desea que se tooimprove.</span><span class="sxs-lookup"><span data-stu-id="620bc-257">Back tooyour app that you want tooimprove.</span></span>

1. <span data-ttu-id="620bc-258">Asegúrese de que se encuentra ahora en la bifurcación de la versión beta</span><span class="sxs-lookup"><span data-stu-id="620bc-258">Make sure you're now in your beta branch</span></span>

        git checkout beta
2. <span data-ttu-id="620bc-259">En  *&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, buscar hello `<li>` etiquetar y agregar hello `style="cursor:pointer"` atributo, tal y como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="620bc-259">In *&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, find hello `<li>` tag and add hello `style="cursor:pointer"` attribute, as shown below.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/07-change-cursor-style-on-li.png)
3. <span data-ttu-id="620bc-260">Confirme e inserte tooAzure.</span><span class="sxs-lookup"><span data-stu-id="620bc-260">commit and push tooAzure.</span></span>
4. <span data-ttu-id="620bc-261">Comprobar que el cambio de Hola se reflejan en la ranura de la versión beta de hello desplazándose toohttp://todoapp*&lt;your_suffix >*-beta.azurewebsites.net/.</span><span class="sxs-lookup"><span data-stu-id="620bc-261">Verify that hello change is now reflected in hello beta slot by navigating toohttp://todoapp*&lt;your_suffix>*-beta.azurewebsites.net/.</span></span> <span data-ttu-id="620bc-262">Si no ve Hola cambiar todavía, actualice el explorador tooget Hola nuevo código de javascript.</span><span class="sxs-lookup"><span data-stu-id="620bc-262">If you don't see hello change yet, refresh your browser tooget hello new javascript code.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/08-verify-change-in-beta-site.png)

<span data-ttu-id="620bc-263">Ahora que tiene el cambio que se ejecuta en la ranura de la versión beta de hello, está listo tooperform una implementación programa Windows Insider.</span><span class="sxs-lookup"><span data-stu-id="620bc-263">Now that you have your change running in hello beta slot, you are ready tooperform a flighting deployment.</span></span>

## <a name="validate-route-traffic-toohello-beta-app"></a><span data-ttu-id="620bc-264">Validar: Enrutar el tráfico toohello beta aplicación</span><span class="sxs-lookup"><span data-stu-id="620bc-264">Validate: Route traffic toohello beta app</span></span>
<span data-ttu-id="620bc-265">En esta sección, enrutará el tráfico toohello beta aplicación.</span><span class="sxs-lookup"><span data-stu-id="620bc-265">In this section, you will route traffic toohello beta app.</span></span> <span data-ttu-id="620bc-266">Por motivos de claridad de la demostración, va tooroute una parte significativa de tooit de tráfico de usuario de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-266">For sake of clarity of demonstration, you're going tooroute a significant portion of hello user traffic tooit.</span></span> <span data-ttu-id="620bc-267">En realidad, Hola cantidad de tráfico que desee tooroute dependerá de su situación concreta.</span><span class="sxs-lookup"><span data-stu-id="620bc-267">In reality, hello amount of traffic you want tooroute will depend on your specific situation.</span></span> <span data-ttu-id="620bc-268">Por ejemplo, si el sitio está a escala Hola de microsoft.com, a continuación, deberá menor que uno por ciento del tráfico total de datos útiles de orden toogain.</span><span class="sxs-lookup"><span data-stu-id="620bc-268">For example, if your site is at hello scale of microsoft.com, then you may need less than one percent of your total traffic in order toogain useful data.</span></span>

1. <span data-ttu-id="620bc-269">En la sesión de Git Shell, ejecute hello después comandos tooroute la mitad de la ranura beta toohello tráfico de producción de hello:</span><span class="sxs-lookup"><span data-stu-id="620bc-269">In your Git Shell session, run hello following commands tooroute half of hello production traffic toohello beta slot:</span></span>

        $siteName = "ToDoApp<your suffix>"
        $rule = New-Object Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.RampUpRule
        $rule.ActionHostName = "$siteName-beta.azurewebsites.net"
        $rule.ReroutePercentage = 50
        $rule.Name = "beta"
        Set-AzureWebsite $siteName -Slot Production -RoutingRules $rule

   <span data-ttu-id="620bc-270">Hola `ReroutePercentage=50` propiedad especifica que el 50% del tráfico de producción de hello será URL de la aplicación de toohello enrutado beta (especificado por hello `ActionHostName` propiedad).</span><span class="sxs-lookup"><span data-stu-id="620bc-270">hello `ReroutePercentage=50` property specifies that 50% of hello production traffic will be routed toohello beta app's URL (specified by hello `ActionHostName` property).</span></span>
2. <span data-ttu-id="620bc-271">Ahora, explore toohttp://ToDoApp*&lt;your_suffix >*. azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="620bc-271">Now navigate toohttp://ToDoApp*&lt;your_suffix>*.azurewebsites.net.</span></span> <span data-ttu-id="620bc-272">50% del tráfico de hello ahora debería ranura de beta toohello redirigida.</span><span class="sxs-lookup"><span data-stu-id="620bc-272">50% of hello traffic should now be redirected toohello beta slot.</span></span>
3. <span data-ttu-id="620bc-273">En el recurso de Application Insights, filtrar las métricas de hello entorno = "beta".</span><span class="sxs-lookup"><span data-stu-id="620bc-273">In your Application Insights resource, filter hello metrics by environment="beta".</span></span>

   > [!NOTE]
   > <span data-ttu-id="620bc-274">Si guarda esta vista filtrada como favorito otro, puede examinar fácilmente vistas del explorador de métrica de hello entre producción y vistas de la versión beta.</span><span class="sxs-lookup"><span data-stu-id="620bc-274">If you save this filtered view as another favorite, then you can easily flip hello metric explorer views between production and beta views.</span></span>
   >
   >

<span data-ttu-id="620bc-275">Suponga que en Application Insights ve toohello algo similar a continuación:</span><span class="sxs-lookup"><span data-stu-id="620bc-275">Suppose in Application Insights you see something similar toohello following:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/09-test-beta-site-in-production.png)

<span data-ttu-id="620bc-276">No solo Esto muestra que hay muchos más clics en hello `<li>` etiquetas, pero parece que hay toobe una sobrecarga de clics en `<li>` etiquetas.</span><span class="sxs-lookup"><span data-stu-id="620bc-276">Not only is this showing that there are many more clicks on hello `<li>` tags, but there seems toobe a surge of clicks on `<li>` tags.</span></span> <span data-ttu-id="620bc-277">A continuación, puede estar seguro de que personas han descubierto Hola nuevo `<li>` las etiquetas son seleccionables y ahora está borrando todas sus tareas completados anteriormente en la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="620bc-277">You can then conclude that people have discovered hello new `<li>` tags are clickable and are now clearing all their previously-completed tasks in hello app.</span></span>

<span data-ttu-id="620bc-278">En función de datos de saludo de la implementación del programa Windows Insider, decide que la nueva interfaz de usuario está listo para producción.</span><span class="sxs-lookup"><span data-stu-id="620bc-278">Based on hello data of your flighting deployment, you decide that your new UI is ready for production.</span></span>

## <a name="go-live-move-your-new-code-into-production"></a><span data-ttu-id="620bc-279">Puesta en marcha: mover el código nuevo a producción</span><span class="sxs-lookup"><span data-stu-id="620bc-279">Go live: Move your new code into production</span></span>
<span data-ttu-id="620bc-280">Se está ahora listo toomove su tooproduction de actualización.</span><span class="sxs-lookup"><span data-stu-id="620bc-280">You're now ready toomove your update tooproduction.</span></span> <span data-ttu-id="620bc-281">¿Qué es grande es que ahora sabe que la actualización ya se ha validado *antes de* se inserta tooproduction.</span><span class="sxs-lookup"><span data-stu-id="620bc-281">What's great is that now you know that your update has already been validated *before* it is pushed tooproduction.</span></span> <span data-ttu-id="620bc-282">Ahora puede implementarlo con confianza.</span><span class="sxs-lookup"><span data-stu-id="620bc-282">So now you can confidently deploy it.</span></span> <span data-ttu-id="620bc-283">Desde que realizó una aplicación de cliente de actualización toohello AngularJS, sólo se valida el código del lado cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="620bc-283">Since you made an update toohello AngularJS client app, you only validated hello client-side code.</span></span> <span data-ttu-id="620bc-284">Si se encontraba aplicaciones de API Web de back-end de toomake cambios toohello, pudo validar los cambios de forma similar y sencilla.</span><span class="sxs-lookup"><span data-stu-id="620bc-284">If you were toomake changes toohello back-end Web API app, you could validate your changes similarly and easily.</span></span>

1. <span data-ttu-id="620bc-285">En el Shell de Git, quite la regla de enrutamiento de tráfico de hello ejecutando Hola siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="620bc-285">In Git Shell, remove hello traffic routing rule by running hello following command:</span></span>

        Set-AzureWebsite $siteName -Slot Production -RoutingRules @()
2. <span data-ttu-id="620bc-286">Ejecute comandos de Git de hello:</span><span class="sxs-lookup"><span data-stu-id="620bc-286">Run hello Git commands:</span></span>

        git checkout master
        git pull origin master
        git merge beta
        git push origin master
3. <span data-ttu-id="620bc-287">Espere unos minutos para hello nuevo código toohello toobe implementado ranura de ensayo y vuelva a iniciar http://ToDoApp*&lt;your_suffix >*-tooverify staging.azurewebsites.net que Hola nueva actualización se activa en almacenamiento provisional de Hola ranura.</span><span class="sxs-lookup"><span data-stu-id="620bc-287">Wait for a few minutes for hello new code toobe deployed toohello staging slot, then launch http://ToDoApp*&lt;your_suffix>*-staging.azurewebsites.net tooverify that hello new update is warmed up in hello staging slot.</span></span> <span data-ttu-id="620bc-288">Recuerde que Hola bifurcación principal de la bifurcación está vinculado toohello ensayo ranura de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="620bc-288">Remember that hello your fork's master branch is linked toohello staging slot of your app.</span></span>
4. <span data-ttu-id="620bc-289">Ahora, intercambiar Hola ranura de ensayo a producción</span><span class="sxs-lookup"><span data-stu-id="620bc-289">Now, swap hello staging slot into production</span></span>

        cd <ROOT>\ToDoApp\ARMTemplates
        .\swap.ps1 -Name todoapp<your_suffix>

## <a name="summary"></a><span data-ttu-id="620bc-290">Resumen</span><span class="sxs-lookup"><span data-stu-id="620bc-290">Summary</span></span>
<span data-ttu-id="620bc-291">Servicio de aplicaciones de Azure facilita toomedium pequeña empresas tootest sus aplicaciones orientado al cliente en producción, algo que se ha realizado tradicionalmente en grandes empresas.</span><span class="sxs-lookup"><span data-stu-id="620bc-291">Azure App Service makes it easy for small- toomedium-sized businesses tootest their customer-facing apps in production, something that has been traditionally done in big enterprises.</span></span> <span data-ttu-id="620bc-292">Con suerte, este tutorial le ha concedido Hola conocimientos necesarios toobring juntos servicio de aplicaciones y Application Insights toomake programa Windows Insider implementación posibles e incluso otros escenarios de prueba en producción, en el mundo de DevOps.</span><span class="sxs-lookup"><span data-stu-id="620bc-292">Hopefully, this tutorial has given you hello knowledge you need toobring together App Service and Application Insights toomake possible flighting deployment, and even other test-in-production scenarios, in your DevOps world.</span></span>

## <a name="more-resources"></a><span data-ttu-id="620bc-293">Más recursos</span><span class="sxs-lookup"><span data-stu-id="620bc-293">More resources</span></span>
* [<span data-ttu-id="620bc-294">Agile Software Development con el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="620bc-294">Agile software development with Azure App Service</span></span>](app-service-agile-software-development.md)
* [<span data-ttu-id="620bc-295">Configuración de entornos de ensayo para aplicaciones web en el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="620bc-295">Set up staging environments for web apps in Azure App Service</span></span>](web-sites-staged-publishing.md)
* [<span data-ttu-id="620bc-296">Implementación predecible de una aplicación compleja en Azure</span><span class="sxs-lookup"><span data-stu-id="620bc-296">Deploy a complex application predictably in Azure</span></span>](app-service-deploy-complex-application-predictably.md)
* [<span data-ttu-id="620bc-297">Creación de plantillas del Administrador de recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="620bc-297">Authoring Azure Resource Manager Templates</span></span>](../azure-resource-manager/resource-group-authoring-templates.md)
* [<span data-ttu-id="620bc-298">JSONLint - Hola validador de JSON</span><span class="sxs-lookup"><span data-stu-id="620bc-298">JSONLint - hello JSON Validator</span></span>](http://jsonlint.com/)
* [<span data-ttu-id="620bc-299">Creación de ramas de Git: combinación y creación de ramas básicas</span><span class="sxs-lookup"><span data-stu-id="620bc-299">Git Branching – Basic Branching and Merging</span></span>](http://www.git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)
* [<span data-ttu-id="620bc-300">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="620bc-300">Azure PowerShell</span></span>](/powershell/azure/overview)
* [<span data-ttu-id="620bc-301">Wiki de Project Kudu</span><span class="sxs-lookup"><span data-stu-id="620bc-301">Project Kudu Wiki</span></span>](https://github.com/projectkudu/kudu/wiki)
