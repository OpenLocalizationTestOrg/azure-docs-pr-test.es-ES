---
title: "mensajería asíncrona del Bus aaaService | Documentos de Microsoft"
description: "Descripción de la mensajería asincrónica de Azure Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: f1435549-e1f2-40cb-a280-64ea07b39fc7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/19/2017
ms.author: sethm
ms.openlocfilehash: 5ab6ddf052155a9dd975b413cfaf393119c1999d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="asynchronous-messaging-patterns-and-high-availability"></a><span data-ttu-id="c92ec-103">Patrones de mensajería asincrónica y alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="c92ec-103">Asynchronous messaging patterns and high availability</span></span>

<span data-ttu-id="c92ec-104">La mensajería asincrónica se puede implementar de varias maneras.</span><span class="sxs-lookup"><span data-stu-id="c92ec-104">Asynchronous messaging can be implemented in a variety of different ways.</span></span> <span data-ttu-id="c92ec-105">Con colas, temas y suscripciones, Azure Service Bus admite la asincronía a través de un mecanismo de almacenamiento y reenvío.</span><span class="sxs-lookup"><span data-stu-id="c92ec-105">With queues, topics, and subscriptions, Azure Service Bus supports asynchronism via a store and forward mechanism.</span></span> <span data-ttu-id="c92ec-106">Durante el funcionamiento normal (sincrónico), enviar temas y tooqueues de mensajes y recibir mensajes de colas y suscripciones.</span><span class="sxs-lookup"><span data-stu-id="c92ec-106">In normal (synchronous) operation, you send messages tooqueues and topics, and receive messages from queues and subscriptions.</span></span> <span data-ttu-id="c92ec-107">Las aplicaciones que escriba dependen de que estas entidades estén siempre disponibles.</span><span class="sxs-lookup"><span data-stu-id="c92ec-107">Applications you write depend on these entities always being available.</span></span> <span data-ttu-id="c92ec-108">Cuando cambia el estado de la entidad de hello, debido tooa variedad de circunstancias, es necesario un tooprovide forma una entidad de capacidad reducida que pueda satisfacer la mayoría de las necesidades.</span><span class="sxs-lookup"><span data-stu-id="c92ec-108">When hello entity health changes, due tooa variety of circumstances, you need a way tooprovide a reduced capability entity that can satisfy most needs.</span></span>

<span data-ttu-id="c92ec-109">Las aplicaciones normalmente utilizan tooenable de patrones de mensajería asincrónica un número de escenarios de comunicación.</span><span class="sxs-lookup"><span data-stu-id="c92ec-109">Applications typically use asynchronous messaging patterns tooenable a number of communication scenarios.</span></span> <span data-ttu-id="c92ec-110">Puede crear aplicaciones en el que los clientes pueden enviar mensajes tooservices, incluso cuando no se está ejecutando el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-110">You can build applications in which clients can send messages tooservices, even when hello service is not running.</span></span> <span data-ttu-id="c92ec-111">Las aplicaciones que presentan ráfagas de comunicaciones, una cola puede ayudar a nivel Hola carga proporcionando una lugar las comunicaciones toobuffer.</span><span class="sxs-lookup"><span data-stu-id="c92ec-111">For applications that experience bursts of communications, a queue can help level hello load by providing a place toobuffer communications.</span></span> <span data-ttu-id="c92ec-112">Por último, puede obtener una carga simple pero eficaz mensajes de toodistribute equilibrador entre varias máquinas.</span><span class="sxs-lookup"><span data-stu-id="c92ec-112">Finally, you can get a simple but effective load balancer toodistribute messages across multiple machines.</span></span>

<span data-ttu-id="c92ec-113">En orden toomaintain la disponibilidad de cualquiera de estas entidades, considere la posibilidad de varias maneras diferentes en que estas entidades pueden aparecer no disponibles para un sistema de mensajería duradero.</span><span class="sxs-lookup"><span data-stu-id="c92ec-113">In order toomaintain availability of any of these entities, consider a number of different ways in which these entities can appear unavailable for a durable messaging system.</span></span> <span data-ttu-id="c92ec-114">Por lo general, vemos entidad Hola se convierten en tooapplications disponible que escribimos de hello después de maneras diferentes:</span><span class="sxs-lookup"><span data-stu-id="c92ec-114">Generally speaking, we see hello entity become unavailable tooapplications we write in hello following different ways:</span></span>

* <span data-ttu-id="c92ec-115">No se puede toosend mensajes.</span><span class="sxs-lookup"><span data-stu-id="c92ec-115">Unable toosend messages.</span></span>
* <span data-ttu-id="c92ec-116">No se puede tooreceive mensajes.</span><span class="sxs-lookup"><span data-stu-id="c92ec-116">Unable tooreceive messages.</span></span>
* <span data-ttu-id="c92ec-117">No se puede toomanage entidades (crear, recuperar, actualizar o eliminar entidades).</span><span class="sxs-lookup"><span data-stu-id="c92ec-117">Unable toomanage entities (create, retrieve, update, or delete entities).</span></span>
* <span data-ttu-id="c92ec-118">Servicio de hello toocontact no se puede.</span><span class="sxs-lookup"><span data-stu-id="c92ec-118">Unable toocontact hello service.</span></span>

<span data-ttu-id="c92ec-119">Para cada uno de estos errores, distintos modos de error hay que habilitar un trabajo de aplicación toocontinue tooperform en algún nivel de capacidad reducida.</span><span class="sxs-lookup"><span data-stu-id="c92ec-119">For each of these failures, different failure modes exist that enable an application toocontinue tooperform work at some level of reduced capability.</span></span> <span data-ttu-id="c92ec-120">Por ejemplo, un sistema que puede enviar mensajes, pero no recibirlos, puede recibir pedidos de clientes pero no procesarlos.</span><span class="sxs-lookup"><span data-stu-id="c92ec-120">For example, a system that can send messages but not receive them can still receive orders from customers but cannot process those orders.</span></span> <span data-ttu-id="c92ec-121">En este tema se tratan los posibles problemas que se pueden producir y cómo se mitigan.</span><span class="sxs-lookup"><span data-stu-id="c92ec-121">This topic discusses potential issues that can occur, and how those issues are mitigated.</span></span> <span data-ttu-id="c92ec-122">Bus de servicio ha presentado a una serie de procedimientos para mitigar problemas que deben participar en y, en este tema también explica hello las reglas que rigen Hola usan de esas mitigaciones participar en.</span><span class="sxs-lookup"><span data-stu-id="c92ec-122">Service Bus has introduced a number of mitigations which you must opt into, and this topic also discusses hello rules governing hello use of those opt-in mitigations.</span></span>

## <a name="reliability-in-service-bus"></a><span data-ttu-id="c92ec-123">Confiabilidad en Service Bus</span><span class="sxs-lookup"><span data-stu-id="c92ec-123">Reliability in Service Bus</span></span>
<span data-ttu-id="c92ec-124">Hay varias maneras de problemas de mensajes y entidad toohandle y hay directrices que rigen el uso adecuado de Hola de esas mitigaciones.</span><span class="sxs-lookup"><span data-stu-id="c92ec-124">There are several ways toohandle message and entity issues, and there are guidelines governing hello appropriate use of those mitigations.</span></span> <span data-ttu-id="c92ec-125">directrices de hello toounderstand, primero debe entender lo que puede producir un error en el Bus de servicio.</span><span class="sxs-lookup"><span data-stu-id="c92ec-125">toounderstand hello guidelines, you must first understand what can fail in Service Bus.</span></span> <span data-ttu-id="c92ec-126">Pagar toohello diseño de los sistemas de Azure, todos estos problemas suelen toobe corta duración.</span><span class="sxs-lookup"><span data-stu-id="c92ec-126">Due toohello design of Azure systems, all of these issues tend toobe short-lived.</span></span> <span data-ttu-id="c92ec-127">En un nivel alto, distintas causas de falta de disponibilidad de hello aparecerán como sigue:</span><span class="sxs-lookup"><span data-stu-id="c92ec-127">At a high level, hello different causes of unavailability appear as follows:</span></span>

* <span data-ttu-id="c92ec-128">Limitación desde un sistema externo del que depende Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c92ec-128">Throttling from an external system on which Service Bus depends.</span></span> <span data-ttu-id="c92ec-129">Se produce una limitación de las interacciones con los recursos de proceso y almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="c92ec-129">Throttling occurs from interactions with storage and compute resources.</span></span>
* <span data-ttu-id="c92ec-130">Problema en un sistema del que depende Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c92ec-130">Issue for a system on which Service Bus depends.</span></span> <span data-ttu-id="c92ec-131">Por ejemplo, pueden aparecer problemas en una parte determinada del almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="c92ec-131">For example, a given part of storage can encounter issues.</span></span>
* <span data-ttu-id="c92ec-132">Error de Service Bus en un subsistema individual.</span><span class="sxs-lookup"><span data-stu-id="c92ec-132">Failure of Service Bus on single subsystem.</span></span> <span data-ttu-id="c92ec-133">En esta situación, un nodo de proceso puede entrar en un estado incoherente y debe reiniciarse, haciendo que todas las entidades usa equilibrio tooload tooother nodos.</span><span class="sxs-lookup"><span data-stu-id="c92ec-133">In this situation, a compute node can get into an inconsistent state and must restart itself, causing all entities it serves tooload balance tooother nodes.</span></span> <span data-ttu-id="c92ec-134">A su vez, esto puede provocar que los mensajes se procesen más lentamente durante un breve periodo.</span><span class="sxs-lookup"><span data-stu-id="c92ec-134">This in turn can cause a short period of slow message processing.</span></span>
* <span data-ttu-id="c92ec-135">Error de Service Bus en un centro de datos de Azure.</span><span class="sxs-lookup"><span data-stu-id="c92ec-135">Failure of Service Bus within an Azure datacenter.</span></span> <span data-ttu-id="c92ec-136">Se trata de un "error catastrófico" durante el cual, sistema de hello es inalcanzable durante muchos minutos o unas pocas horas.</span><span class="sxs-lookup"><span data-stu-id="c92ec-136">This is a "catastrophic failure" during which hello system is unreachable for many minutes or a few hours.</span></span>

> [!NOTE]
> <span data-ttu-id="c92ec-137">término de Hello **almacenamiento** puede significar almacenamiento de Azure y SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="c92ec-137">hello term **storage** can mean both Azure Storage and SQL Azure.</span></span>
> 
> 

<span data-ttu-id="c92ec-138">Service Bus contiene varios procedimientos para mitigar estos problemas.</span><span class="sxs-lookup"><span data-stu-id="c92ec-138">Service Bus contains a number of mitigations for these issues.</span></span> <span data-ttu-id="c92ec-139">Hola las secciones siguientes tratan cada problema y sus respectivos procedimientos para solucionarlos.</span><span class="sxs-lookup"><span data-stu-id="c92ec-139">hello following sections discuss each issue and their respective mitigations.</span></span>

### <a name="throttling"></a><span data-ttu-id="c92ec-140">Limitaciones</span><span class="sxs-lookup"><span data-stu-id="c92ec-140">Throttling</span></span>
<span data-ttu-id="c92ec-141">Con Service Bus, la limitación permite la administración cooperativa de la velocidad de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="c92ec-141">With Service Bus, throttling enables cooperative message rate management.</span></span> <span data-ttu-id="c92ec-142">Cada nodo individual de Service Bus alberga muchas entidades.</span><span class="sxs-lookup"><span data-stu-id="c92ec-142">Each individual Service Bus node houses many entities.</span></span> <span data-ttu-id="c92ec-143">Cada una de esas entidades realiza demandas en sistema de hello en cuanto a CPU, memoria, almacenamiento y otras facetas.</span><span class="sxs-lookup"><span data-stu-id="c92ec-143">Each of those entities makes demands on hello system in terms of CPU, memory, storage, and other facets.</span></span> <span data-ttu-id="c92ec-144">Si cualquiera de estas facetas detecta un uso que supera los umbrales definidos, Service Bus puede denegar una solicitud determinada.</span><span class="sxs-lookup"><span data-stu-id="c92ec-144">When any of these facets detects usage that exceeds defined thresholds, Service Bus can deny a given request.</span></span> <span data-ttu-id="c92ec-145">Hola llamador recibe una [ServerBusyException] [ ServerBusyException] y reintentos después de 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="c92ec-145">hello caller receives a [ServerBusyException][ServerBusyException] and retries after 10 seconds.</span></span>

<span data-ttu-id="c92ec-146">Como una mitigación, código de hello debe leer error hello y detener los reintentos del mensaje de bienvenida de al menos 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="c92ec-146">As a mitigation, hello code must read hello error and halt any retries of hello message for at least 10 seconds.</span></span> <span data-ttu-id="c92ec-147">Puesto que el error de hello puede ocurrir en fragmentos de aplicación de cliente de hello, se espera que cada pieza de forma independiente ejecuta lógica de reintento de Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-147">Since hello error can happen across pieces of hello customer application, it is expected that each piece independently executes hello retry logic.</span></span> <span data-ttu-id="c92ec-148">código de Hello puede reducir la probabilidad de Hola de limitarse al habilitar la creación de particiones en una cola o tema.</span><span class="sxs-lookup"><span data-stu-id="c92ec-148">hello code can reduce hello probability of being throttled by enabling partitioning on a queue or topic.</span></span>

### <a name="issue-for-an-azure-dependency"></a><span data-ttu-id="c92ec-149">Problema en una dependencia de Azure</span><span class="sxs-lookup"><span data-stu-id="c92ec-149">Issue for an Azure dependency</span></span>
<span data-ttu-id="c92ec-150">Otros componentes de Azure en ocasiones pueden tener problemas de servicio ocasionalmente.</span><span class="sxs-lookup"><span data-stu-id="c92ec-150">Other components within Azure can occasionally have service issues.</span></span> <span data-ttu-id="c92ec-151">Por ejemplo, cuando se actualiza un sistema que usa Service Bus, dicho sistema puede experimentar temporalmente la reducción de sus funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="c92ec-151">For example, when a system that Service Bus uses is being upgraded, that system can temporarily experience reduced capabilities.</span></span> <span data-ttu-id="c92ec-152">toowork alrededor de estos tipos de problemas, Service Bus con regularidad investiga e implementa las mitigaciones.</span><span class="sxs-lookup"><span data-stu-id="c92ec-152">toowork around these types of issues, Service Bus regularly investigates and implements mitigations.</span></span> <span data-ttu-id="c92ec-153">Aparecen los efectos secundarios de estas mitigaciones.</span><span class="sxs-lookup"><span data-stu-id="c92ec-153">Side effects of these mitigations do appear.</span></span> <span data-ttu-id="c92ec-154">Por ejemplo, toohandle transitorio problemas con el almacenamiento, Bus de servicio implementa un sistema que permite toowork de operaciones de envío de mensaje de forma coherente.</span><span class="sxs-lookup"><span data-stu-id="c92ec-154">For example, toohandle transient issues with storage, Service Bus implements a system that allows message send operations toowork consistently.</span></span> <span data-ttu-id="c92ec-155">Debido a la naturaleza toohello de mitigación de hello, un mensaje enviado puede tardar hasta too15 minutos tooappear en hello afectado cola o suscripción y está listo para una operación de recepción.</span><span class="sxs-lookup"><span data-stu-id="c92ec-155">Due toohello nature of hello mitigation, a sent message can take up too15 minutes tooappear in hello affected queue or subscription and be ready for a receive operation.</span></span> <span data-ttu-id="c92ec-156">Por lo general, la mayoría de las entidades no sufrirán este problema.</span><span class="sxs-lookup"><span data-stu-id="c92ec-156">Generally speaking, most entities will not experience this issue.</span></span> <span data-ttu-id="c92ec-157">Sin embargo, dado el número de Hola de entidades de Bus de servicio dentro de Azure, esta solución provisional a veces es necesario para un pequeño subconjunto de clientes de Bus de servicio.</span><span class="sxs-lookup"><span data-stu-id="c92ec-157">However, given hello number of entities in Service Bus within Azure, this mitigation is sometimes needed for a small subset of Service Bus customers.</span></span>

### <a name="service-bus-failure-on-a-single-subsystem"></a><span data-ttu-id="c92ec-158">Error de Service Bus en un subsistema individual</span><span class="sxs-lookup"><span data-stu-id="c92ec-158">Service Bus failure on a single subsystem</span></span>
<span data-ttu-id="c92ec-159">Con cualquier aplicación, circunstancias pueden hacer que un componente interno de Service Bus toobecome incoherente.</span><span class="sxs-lookup"><span data-stu-id="c92ec-159">With any application, circumstances can cause an internal component of Service Bus toobecome inconsistent.</span></span> <span data-ttu-id="c92ec-160">Al Bus de servicio detecta esto, recopila datos de tooaid de aplicación Hola diagnosticar qué ocurrió.</span><span class="sxs-lookup"><span data-stu-id="c92ec-160">When Service Bus detects this, it collects data from hello application tooaid in diagnosing what happened.</span></span> <span data-ttu-id="c92ec-161">Una vez que se recopilan los datos de hello, aplicación hello es reinicia en un intento tooreturn se tooa de estado coherente.</span><span class="sxs-lookup"><span data-stu-id="c92ec-161">Once hello data is collected, hello application is restarted in an attempt tooreturn it tooa consistent state.</span></span> <span data-ttu-id="c92ec-162">Este proceso tiene lugar con bastante rapidez y resultados en una entidad parezca toobe no está disponible para la tooa varios minutos, aunque típico tiempos de inactividad son mucho más cortas.</span><span class="sxs-lookup"><span data-stu-id="c92ec-162">This process happens fairly quickly, and results in an entity appearing toobe unavailable for up tooa few minutes, though typical down times are much shorter.</span></span>

<span data-ttu-id="c92ec-163">En estos casos, se genera la aplicación de cliente de hello un [System.TimeoutException] [ System.TimeoutException] o [MessagingException] [ MessagingException] excepción.</span><span class="sxs-lookup"><span data-stu-id="c92ec-163">In these cases, hello client application generates a [System.TimeoutException][System.TimeoutException] or [MessagingException][MessagingException] exception.</span></span> <span data-ttu-id="c92ec-164">Bus de servicio contiene una solución para este problema en forma de Hola de lógica de reintento de cliente automatizada.</span><span class="sxs-lookup"><span data-stu-id="c92ec-164">Service Bus contains a mitigation for this issue in hello form of automated client retry logic.</span></span> <span data-ttu-id="c92ec-165">Una vez que se agota el período de reintento de hello y no se entrega el mensaje de bienvenida, puede explorar con otras características como [emparejar los espacios de nombres][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="c92ec-165">Once hello retry period is exhausted and hello message is not delivered, you can explore using other features such as [paired namespaces][paired namespaces].</span></span> <span data-ttu-id="c92ec-166">Estos espacios de nombres tienen otros riesgos que se describen en este artículo.</span><span class="sxs-lookup"><span data-stu-id="c92ec-166">Paired namespaces have other caveats that are discussed in that article.</span></span>

### <a name="failure-of-service-bus-within-an-azure-datacenter"></a><span data-ttu-id="c92ec-167">Error de Service Bus en un centro de datos de Azure</span><span class="sxs-lookup"><span data-stu-id="c92ec-167">Failure of Service Bus within an Azure datacenter</span></span>
<span data-ttu-id="c92ec-168">motivo más probable de Hola de un error en un centro de datos de Azure es una implementación de actualización incorrecta del Bus de servicio o un sistema dependiente.</span><span class="sxs-lookup"><span data-stu-id="c92ec-168">hello most probable reason for a failure in an Azure datacenter is a failed upgrade deployment of Service Bus or a dependent system.</span></span> <span data-ttu-id="c92ec-169">Como Hola plataforma ha madurado, ha disminuido probabilidad Hola de este tipo de error.</span><span class="sxs-lookup"><span data-stu-id="c92ec-169">As hello platform has matured, hello likelihood of this type of failure has diminished.</span></span> <span data-ttu-id="c92ec-170">También puede producir un error en el centro por motivos como Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="c92ec-170">A datacenter failure can also happen for reasons that include hello following:</span></span>

* <span data-ttu-id="c92ec-171">Interrupción del suministro eléctrico (desaparecen la fuente de alimentación y la generación de energía).</span><span class="sxs-lookup"><span data-stu-id="c92ec-171">Electrical outage (power supply and generating power disappear).</span></span>
* <span data-ttu-id="c92ec-172">Conectividad (interrupción de Internet entre los clientes y Azure).</span><span class="sxs-lookup"><span data-stu-id="c92ec-172">Connectivity (internet break between your clients and Azure).</span></span>

<span data-ttu-id="c92ec-173">En ambos casos, un desastre natural o provocado por el hombre causó el problema de Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-173">In both cases, a natural or man-made disaster caused hello issue.</span></span> <span data-ttu-id="c92ec-174">toowork resolver este problema y asegurarse de que todavía puede enviar mensajes, puede usar [emparejar los espacios de nombres] [ paired namespaces] tooenable mensajes toobe enviado tooa segunda ubicación mientras Hola ubicación principal vuelve a correcto nuevo.</span><span class="sxs-lookup"><span data-stu-id="c92ec-174">toowork around this and make sure that you can still send messages, you can use [paired namespaces][paired namespaces] tooenable messages toobe sent tooa second location while hello primary location is made healthy again.</span></span> <span data-ttu-id="c92ec-175">Para más información, consulte [Procedimientos recomendados para aislar aplicaciones ante desastres e interrupciones de Service Bus][Best practices for insulating applications against Service Bus outages and disasters].</span><span class="sxs-lookup"><span data-stu-id="c92ec-175">For more information, see [Best practices for insulating applications against Service Bus outages and disasters][Best practices for insulating applications against Service Bus outages and disasters].</span></span>

## <a name="paired-namespaces"></a><span data-ttu-id="c92ec-176">Espacios de nombres emparejados</span><span class="sxs-lookup"><span data-stu-id="c92ec-176">Paired namespaces</span></span>
<span data-ttu-id="c92ec-177">Hola [emparejar los espacios de nombres] [ paired namespaces] característica admite escenarios en los que una entidad de Bus de servicio o implementación en un centro de datos deja de estar disponible.</span><span class="sxs-lookup"><span data-stu-id="c92ec-177">hello [paired namespaces][paired namespaces] feature supports scenarios in which a Service Bus entity or deployment within a data center becomes unavailable.</span></span> <span data-ttu-id="c92ec-178">Este evento se produce con poca frecuencia, los sistemas distribuidos todavía deben estar preparados toohandle peores casos posibles.</span><span class="sxs-lookup"><span data-stu-id="c92ec-178">While this event occurs infrequently, distributed systems still must be prepared toohandle worst case scenarios.</span></span> <span data-ttu-id="c92ec-179">Normalmente, este evento se produce porque algún elemento del que depende Service Bus sufre un problema temporal.</span><span class="sxs-lookup"><span data-stu-id="c92ec-179">Typically, this event happens because some element on which Service Bus depends is experiencing a short-term issue.</span></span> <span data-ttu-id="c92ec-180">disponibilidad de las aplicaciones toomaintain durante una interrupción, los usuarios de Bus de servicio pueden utilizar dos espacios de nombres independientes, preferiblemente en centros de datos independientes, toohost sus entidades de mensajería.</span><span class="sxs-lookup"><span data-stu-id="c92ec-180">toomaintain application availability during an outage, Service Bus users can use two separate namespaces, preferably in separate data centers, toohost their messaging entities.</span></span> <span data-ttu-id="c92ec-181">resto de Hola de esta sección utiliza Hola siguiente terminología:</span><span class="sxs-lookup"><span data-stu-id="c92ec-181">hello remainder of this section uses hello following terminology:</span></span>

* <span data-ttu-id="c92ec-182">Espacio de nombres principal: Hola espacio de nombres con el que interactúa la aplicación de envío y las operaciones de recepción.</span><span class="sxs-lookup"><span data-stu-id="c92ec-182">Primary namespace: hello namespace with which your application interacts, for send and receive operations.</span></span>
* <span data-ttu-id="c92ec-183">Espacio de nombres secundario: Hola espacio de nombres que actúa como un espacio de nombres principal toohello copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="c92ec-183">Secondary namespace: hello namespace that acts as a backup toohello primary namespace.</span></span> <span data-ttu-id="c92ec-184">La lógica de la aplicación no interactúa con este espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="c92ec-184">Application logic does not interact with this namespace.</span></span>
* <span data-ttu-id="c92ec-185">Intervalo de conmutación por error: cantidad de Hola de errores normales de tooaccept de tiempo antes de la aplicación hello cambia del espacio de nombres secundario de hello espacio de nombres principal toohello.</span><span class="sxs-lookup"><span data-stu-id="c92ec-185">Failover interval: hello amount of time tooaccept normal failures before hello application switches from hello primary namespace toohello secondary namespace.</span></span>

<span data-ttu-id="c92ec-186">Los espacios de nombres emparejados admiten la *disponibilidad de envío*.</span><span class="sxs-lookup"><span data-stu-id="c92ec-186">Paired namespaces support *send availability*.</span></span> <span data-ttu-id="c92ec-187">Enviar mensajes de Hola capacidad toosend conserva la disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="c92ec-187">Send availability preserves hello ability toosend messages.</span></span> <span data-ttu-id="c92ec-188">disponibilidad de envío toouse, la aplicación debe cumplir Hola según los requisitos:</span><span class="sxs-lookup"><span data-stu-id="c92ec-188">toouse send availability, your application must meet hello following requirements:</span></span>

1. <span data-ttu-id="c92ec-189">Solo se reciben mensajes de Hola espacio de nombres principal.</span><span class="sxs-lookup"><span data-stu-id="c92ec-189">Messages are only received from hello primary namespace.</span></span>
2. <span data-ttu-id="c92ec-190">Dada la cola o tema de tooa de mensajes enviados puede llegar desordenados.</span><span class="sxs-lookup"><span data-stu-id="c92ec-190">Messages sent tooa given queue or topic might arrive out of order.</span></span>
3. <span data-ttu-id="c92ec-191">Los mensajes de una sesión pueden llegar desordenados.</span><span class="sxs-lookup"><span data-stu-id="c92ec-191">Messages within a session might arrive out of order.</span></span> <span data-ttu-id="c92ec-192">Esto no es algo habitual en el funcionamiento normal de las sesiones,</span><span class="sxs-lookup"><span data-stu-id="c92ec-192">This is a break from normal functionality of sessions.</span></span> <span data-ttu-id="c92ec-193">Esto significa que la aplicación usa toologically agrupar mensajes de las sesiones.</span><span class="sxs-lookup"><span data-stu-id="c92ec-193">This means that your application uses sessions toologically group messages.</span></span>
4. <span data-ttu-id="c92ec-194">Solo se mantiene el estado de sesión en el espacio de nombres principal Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-194">Session state is only maintained on hello primary namespace.</span></span>
5. <span data-ttu-id="c92ec-195">cola principal Hola puede ponerse en línea y empezar a Aceptar mensajes antes de que la cola secundaria Hola ofrece todos los mensajes en cola principal Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-195">hello primary queue can come online and start accepting messages before hello secondary queue delivers all messages into hello primary queue.</span></span>

<span data-ttu-id="c92ec-196">Hola las secciones siguientes tratan Hola API, cómo se implementan las API de Hola y muestra código de ejemplo que usa la característica de Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-196">hello following sections discuss hello APIs, how hello APIs are implemented, and shows sample code that uses hello feature.</span></span> <span data-ttu-id="c92ec-197">Tenga en cuenta que esta característica tiene asociadas unos costos.</span><span class="sxs-lookup"><span data-stu-id="c92ec-197">Note that there are billing implications associated with this feature.</span></span>

### <a name="hello-messagingfactorypairnamespaceasync-api"></a><span data-ttu-id="c92ec-198">Hola API de MessagingFactory.PairNamespaceAsync</span><span class="sxs-lookup"><span data-stu-id="c92ec-198">hello MessagingFactory.PairNamespaceAsync API</span></span>
<span data-ttu-id="c92ec-199">característica de espacios de nombres emparejados Hola incluye hello [PairNamespaceAsync] [ PairNamespaceAsync] método en hello [Microsoft.ServiceBus.Messaging.MessagingFactory] [ Microsoft.ServiceBus.Messaging.MessagingFactory] clase:</span><span class="sxs-lookup"><span data-stu-id="c92ec-199">hello paired namespaces feature includes hello [PairNamespaceAsync][PairNamespaceAsync] method on hello [Microsoft.ServiceBus.Messaging.MessagingFactory][Microsoft.ServiceBus.Messaging.MessagingFactory] class:</span></span>

```csharp
public Task PairNamespaceAsync(PairedNamespaceOptions options);
```

<span data-ttu-id="c92ec-200">Cuando se completa la tarea hello, Hola emparejamiento del espacio de nombres también es tooact al completo y listo para cualquier [MessageReceiver][MessageReceiver], [QueueClient] [ QueueClient], o [TopicClient] [ TopicClient] creado con hello [MessagingFactory] [ MessagingFactory] instancia.</span><span class="sxs-lookup"><span data-stu-id="c92ec-200">When hello task completes, hello namespace pairing is also complete and ready tooact upon for any [MessageReceiver][MessageReceiver], [QueueClient][QueueClient], or [TopicClient][TopicClient] created with hello [MessagingFactory][MessagingFactory] instance.</span></span> <span data-ttu-id="c92ec-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] [ Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] es la clase de base de Hola para hello diferentes tipos de emparejamiento disponibles con un [MessagingFactory] [ MessagingFactory] objeto.</span><span class="sxs-lookup"><span data-stu-id="c92ec-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions][Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] is hello base class for hello different types of pairing that are available with a [MessagingFactory][MessagingFactory] object.</span></span> <span data-ttu-id="c92ec-202">Actualmente, Hola solo clase derivada es una denominada [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], que implementa los requisitos de disponibilidad de envío de Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-202">Currently, hello only derived class is one named [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], which implements hello send availability requirements.</span></span> <span data-ttu-id="c92ec-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] tiene un conjunto de constructores que se compilan entre sí.</span><span class="sxs-lookup"><span data-stu-id="c92ec-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] has a set of constructors that build on each other.</span></span> <span data-ttu-id="c92ec-204">Examinando el constructor de hello con hello mayoría de los parámetros, puede conocer Hola comportamiento del programa Hola a otros constructores.</span><span class="sxs-lookup"><span data-stu-id="c92ec-204">Looking at hello constructor with hello most parameters, you can understand hello behavior of hello other constructors.</span></span>

```csharp
public SendAvailabilityPairedNamespaceOptions(
    NamespaceManager secondaryNamespaceManager,
    MessagingFactory messagingFactory,
    int backlogQueueCount,
    TimeSpan failoverInterval,
    bool enableSyphon)
```

<span data-ttu-id="c92ec-205">Estos parámetros tienen Hola siguientes significados:</span><span class="sxs-lookup"><span data-stu-id="c92ec-205">These parameters have hello following meanings:</span></span>

* <span data-ttu-id="c92ec-206">*secondaryNamespaceManager*: un inicializado [NamespaceManager] [ NamespaceManager] instancia para el espacio de nombres secundario Hola ese hello [PairNamespaceAsync] [ PairNamespaceAsync] pueden utilizar el método tooset Hola espacio de nombres secundario.</span><span class="sxs-lookup"><span data-stu-id="c92ec-206">*secondaryNamespaceManager*: An initialized [NamespaceManager][NamespaceManager] instance for hello secondary namespace that hello [PairNamespaceAsync][PairNamespaceAsync] method can use tooset up hello secondary namespace.</span></span> <span data-ttu-id="c92ec-207">Administrador de espacio de nombres de Hello es la lista de Hola de tooobtain usado de colas de espacio de nombres de Hola y toomake seguro de que existen las colas de trabajo pendiente de hello necesario.</span><span class="sxs-lookup"><span data-stu-id="c92ec-207">hello namespace manager is used tooobtain hello list of queues in hello namespace and toomake sure that hello required backlog queues exist.</span></span> <span data-ttu-id="c92ec-208">Si no existen, se crearán.</span><span class="sxs-lookup"><span data-stu-id="c92ec-208">If those queues do not exist, they are created.</span></span> <span data-ttu-id="c92ec-209">[NamespaceManager] [ NamespaceManager] requiere Hola capacidad toocreate un token con hello **administrar** de notificación.</span><span class="sxs-lookup"><span data-stu-id="c92ec-209">[NamespaceManager][NamespaceManager] requires hello ability toocreate a token with hello **Manage** claim.</span></span>
* <span data-ttu-id="c92ec-210">*messagingFactory*: Hola [MessagingFactory] [ MessagingFactory] instancia para el espacio de nombres secundario Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-210">*messagingFactory*: hello [MessagingFactory][MessagingFactory] instance for hello secondary namespace.</span></span> <span data-ttu-id="c92ec-211">Hola [MessagingFactory] [ MessagingFactory] objeto es toosend utilizado y, si hello [EnableSyphon] [ EnableSyphon] propiedad se establece demasiado**true** , recibir mensajes desde las colas de trabajo pendiente de Hola.</span><span class="sxs-lookup"><span data-stu-id="c92ec-211">hello [MessagingFactory][MessagingFactory] object is used toosend and, if hello [EnableSyphon][EnableSyphon] property is set too**true**, receive messages from hello backlog queues.</span></span>
* <span data-ttu-id="c92ec-212">*backlogQueueCount*: número de Hola de trabajo pendiente pone en cola toocreate.</span><span class="sxs-lookup"><span data-stu-id="c92ec-212">*backlogQueueCount*: hello number of backlog queues toocreate.</span></span> <span data-ttu-id="c92ec-213">Este valor debe ser al menos 1.</span><span class="sxs-lookup"><span data-stu-id="c92ec-213">This value must be at least 1.</span></span> <span data-ttu-id="c92ec-214">Al enviar el trabajo pendiente de toohello de mensajes, se elige aleatoriamente una de estas colas.</span><span class="sxs-lookup"><span data-stu-id="c92ec-214">When sending messages toohello backlog, one of these queues is randomly chosen.</span></span> <span data-ttu-id="c92ec-215">Si establece Hola valor too1, sólo una cola nunca puede utilizarse.</span><span class="sxs-lookup"><span data-stu-id="c92ec-215">If you set hello value too1, then only one queue can ever be used.</span></span> <span data-ttu-id="c92ec-216">Cuando esto sucede y cola de hello un pedido pendiente genera errores, el cliente de hello no es capaz de tootry una cola de pedidos pendientes diferente y puede producir un error toosend el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c92ec-216">When this happens and hello one backlog queue generates errors, hello client is not able tootry a different backlog queue and may fail toosend your message.</span></span> <span data-ttu-id="c92ec-217">Se recomienda establecer este valor toosome mayor valor y predeterminado Hola valor too10.</span><span class="sxs-lookup"><span data-stu-id="c92ec-217">We recommend setting this value toosome larger value and default hello value too10.</span></span> <span data-ttu-id="c92ec-218">Puede cambiar este tooa superior o la aplicación envía a un valor inferior según la cantidad de datos por día.</span><span class="sxs-lookup"><span data-stu-id="c92ec-218">You can change this tooa higher or lower value depending on how much data your application sends per day.</span></span> <span data-ttu-id="c92ec-219">Cada cola de trabajos pendientes puede contener una too5 GB de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c92ec-219">Each backlog queue can hold up too5 GB of messages.</span></span>
* <span data-ttu-id="c92ec-220">*failoverInterval*: Hola cantidad de tiempo durante los cuales aceptará errores en el espacio de nombres principal Hola antes de cambiar cualquier entidad única a través del espacio de nombres secundario toohello.</span><span class="sxs-lookup"><span data-stu-id="c92ec-220">*failoverInterval*: hello amount of time during which you will accept failures on hello primary namespace before switching any single entity over toohello secondary namespace.</span></span> <span data-ttu-id="c92ec-221">Las conmutaciones por error se producen entidad por entidad.</span><span class="sxs-lookup"><span data-stu-id="c92ec-221">Failovers occur on an entity-by-entity basis.</span></span> <span data-ttu-id="c92ec-222">Con frecuencia,  las entidades de un espacio de nombres individual residen en nodos diferentes de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c92ec-222">Entities in a single namespace frequently live in different nodes within Service Bus.</span></span> <span data-ttu-id="c92ec-223">Un error en una de las entidades no implica un error en otra.</span><span class="sxs-lookup"><span data-stu-id="c92ec-223">A failure in one entity does not imply a failure in another.</span></span> <span data-ttu-id="c92ec-224">Puede establecer este valor demasiado[System.TimeSpan.Zero] [ System.TimeSpan.Zero] toofailover toohello secundaria inmediatamente después de su primer error no transitorio.</span><span class="sxs-lookup"><span data-stu-id="c92ec-224">You can set this value too[System.TimeSpan.Zero][System.TimeSpan.Zero] toofailover toohello secondary immediately after your first, non-transient failure.</span></span> <span data-ttu-id="c92ec-225">Los errores que desencadenan el temporizador de conmutación por error de hello son cualquiera [MessagingException] [ MessagingException] en qué hello [IsTransient] [ IsTransient] propiedad es false, o un [System.TimeoutException][System.TimeoutException].</span><span class="sxs-lookup"><span data-stu-id="c92ec-225">Failures that trigger hello failover timer are any [MessagingException][MessagingException] in which hello [IsTransient][IsTransient] property is false, or a [System.TimeoutException][System.TimeoutException].</span></span> <span data-ttu-id="c92ec-226">Otras excepciones como [UnauthorizedAccessException] [ UnauthorizedAccessException] hacen que la conmutación por error, porque indican que el cliente hello está configurado incorrectamente.</span><span class="sxs-lookup"><span data-stu-id="c92ec-226">Other exceptions, such as [UnauthorizedAccessException][UnauthorizedAccessException] do not cause failover, because they indicate that hello client is configured incorrectly.</span></span> <span data-ttu-id="c92ec-227">A [ServerBusyException] [ ServerBusyException] no causa conmutación por error porque es de procedimiento correcto de hello toowait 10 segundos, a continuación, enviar mensaje de bienvenida de nuevo.</span><span class="sxs-lookup"><span data-stu-id="c92ec-227">A [ServerBusyException][ServerBusyException] does not cause failover because hello correct pattern is toowait 10 seconds, then send hello message again.</span></span>
* <span data-ttu-id="c92ec-228">*enableSyphon*: indica que este emparejamiento concreto también debe desviar mensajes del espacio de nombres principal de hello espacio de nombres secundario toohello atrás.</span><span class="sxs-lookup"><span data-stu-id="c92ec-228">*enableSyphon*: Indicates that this particular pairing should also syphon messages from hello secondary namespace back toohello primary namespace.</span></span> <span data-ttu-id="c92ec-229">En general, las aplicaciones que envían mensajes deben establecer este valor demasiado**false**; las aplicaciones que reciben mensajes deben establecer este valor demasiado**true**.</span><span class="sxs-lookup"><span data-stu-id="c92ec-229">In general, applications that send messages should set this value too**false**; applications that receive messages should set this value too**true**.</span></span> <span data-ttu-id="c92ec-230">motivo Hello es que con frecuencia, hay menos receptores de mensajes que remitentes.</span><span class="sxs-lookup"><span data-stu-id="c92ec-230">hello reason for this is that frequently, there are fewer message receivers than message senders.</span></span> <span data-ttu-id="c92ec-231">Según el número de Hola de destinatarios, puede elegir toohave un deberes de sifón única aplicación Hola de identificador de instancia.</span><span class="sxs-lookup"><span data-stu-id="c92ec-231">Depending on hello number of receivers, you can choose toohave a single application instance handle hello syphon duties.</span></span> <span data-ttu-id="c92ec-232">El uso de muchos destinatarios conlleva costos por cada cola de trabajos pendientes.</span><span class="sxs-lookup"><span data-stu-id="c92ec-232">Using many receivers has billing implications for each backlog queue.</span></span>

<span data-ttu-id="c92ec-233">toouse Hola código, cree un elemento principal [MessagingFactory] [ MessagingFactory] instancia, una base de datos secundaria [MessagingFactory] [ MessagingFactory] instancia, una base de datos secundaria [NamespaceManager] [ NamespaceManager] instancia y un [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instancia.</span><span class="sxs-lookup"><span data-stu-id="c92ec-233">toouse hello code, create a primary [MessagingFactory][MessagingFactory] instance, a secondary [MessagingFactory][MessagingFactory] instance, a secondary [NamespaceManager][NamespaceManager] instance, and a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="c92ec-234">llamada de Hello puede ser tan simple como siguiente hello:</span><span class="sxs-lookup"><span data-stu-id="c92ec-234">hello call can be as simple as hello following:</span></span>

```csharp
SendAvailabilityPairedNamespaceOptions sendAvailabilityOptions = new SendAvailabilityPairedNamespaceOptions(secondaryNamespaceManager, secondary);
primary.PairNamespaceAsync(sendAvailabilityOptions).Wait();
```

<span data-ttu-id="c92ec-235">Hola cuando la tarea devuelta por hello [PairNamespaceAsync] [ PairNamespaceAsync] método finaliza, todo está configurado y listo toouse.</span><span class="sxs-lookup"><span data-stu-id="c92ec-235">When hello task returned by hello [PairNamespaceAsync][PairNamespaceAsync] method completes, everything is set up and ready toouse.</span></span> <span data-ttu-id="c92ec-236">Antes de que se devuelva la tarea hello, que no ha completado todos de trabajo en segundo plano Hola necesario para hello emparejamiento toowork derecha.</span><span class="sxs-lookup"><span data-stu-id="c92ec-236">Before hello task is returned, you may not have completed all of hello background work necessary for hello pairing toowork right.</span></span> <span data-ttu-id="c92ec-237">Como resultado, no debería empezar a enviar mensajes hasta que devuelva la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="c92ec-237">As a result, you should not start sending messages until hello task returns.</span></span> <span data-ttu-id="c92ec-238">Si se produjeron errores, por ejemplo, credenciales no válidas o colas de trabajo pendiente de error toocreate hello, esas excepciones se producirá una vez finalizada la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="c92ec-238">If any failures occurred, such as bad credentials, or failure toocreate hello backlog queues, those exceptions will be thrown once hello task completes.</span></span> <span data-ttu-id="c92ec-239">Una vez que se devuelve la tarea hello, compruebe que las colas de Hola se encuentra o se crearon mediante el examen de hello [BacklogQueueCount] [ BacklogQueueCount] propiedad en su [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instancia.</span><span class="sxs-lookup"><span data-stu-id="c92ec-239">Once hello task returns, verify that hello queues were found or created by examining hello [BacklogQueueCount][BacklogQueueCount] property on your [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="c92ec-240">Para el anterior código de hello, esa operación aparece como sigue:</span><span class="sxs-lookup"><span data-stu-id="c92ec-240">For hello preceding code, that operation appears as follows:</span></span>

```csharp
if (sendAvailabilityOptions.BacklogQueueCount < 1)
{
    // Handle case where no queues were created.
}
```

## <a name="next-steps"></a><span data-ttu-id="c92ec-241">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="c92ec-241">Next steps</span></span>
<span data-ttu-id="c92ec-242">Ahora que conoce los fundamentos de Hola de mensajería asíncrona de Bus de servicio, conozca más detalles [emparejar los espacios de nombres][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="c92ec-242">Now that you've learned hello basics of asynchronous messaging in Service Bus, read more details about [paired namespaces][paired namespaces].</span></span>

[ServerBusyException]: /dotnet/api/microsoft.servicebus.messaging.serverbusyexception
[System.TimeoutException]: https://msdn.microsoft.com/library/system.timeoutexception.aspx
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[Best practices for insulating applications against Service Bus outages and disasters]: service-bus-outages-disasters.md
[Microsoft.ServiceBus.Messaging.MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[MessageReceiver]: /dotnet/api/microsoft.servicebus.messaging.messagereceiver
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager
[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[EnableSyphon]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_EnableSyphon
[System.TimeSpan.Zero]: https://msdn.microsoft.com/library/system.timespan.zero.aspx
[IsTransient]: /dotnet/api/microsoft.servicebus.messaging.messagingexception#Microsoft_ServiceBus_Messaging_MessagingException_IsTransient
[UnauthorizedAccessException]: https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx
[BacklogQueueCount]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_BacklogQueueCount
[paired namespaces]: service-bus-paired-namespaces.md
