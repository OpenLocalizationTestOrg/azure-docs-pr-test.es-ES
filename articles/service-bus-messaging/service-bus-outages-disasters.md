---
title: las aplicaciones de Azure Service Bus de aaaInsulating frente a desastres e interrupciones | Documentos de Microsoft
description: "Describe técnicas que puede usar las aplicaciones de tooprotect frente a una posible interrupción de Bus de servicio."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: 349b4968456c9f15375753d83495246f5a3ddfdb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="7eceb-103">Procedimientos recomendados para aislar aplicaciones ante desastres e interrupciones de Bus de servicio</span><span class="sxs-lookup"><span data-stu-id="7eceb-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="7eceb-104">Las aplicaciones críticas deben funcionar de manera continua, incluso en presencia de Hola de interrupciones o desastres imprevistos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-104">Mission-critical applications must operate continuously, even in hello presence of unplanned outages or disasters.</span></span> <span data-ttu-id="7eceb-105">En este tema se describe técnicas que puede usar las aplicaciones de Bus de servicio de tooprotect frente a un desastre o una interrupción del servicio posibles.</span><span class="sxs-lookup"><span data-stu-id="7eceb-105">This topic describes techniques you can use tooprotect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="7eceb-106">Una interrupción del servicio se define como indisponibilidad temporal de Hola de Bus de servicio de Azure.</span><span class="sxs-lookup"><span data-stu-id="7eceb-106">An outage is defined as hello temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="7eceb-107">interrupción de Hello puede afectar a algunos componentes de Bus de servicio, como el almacén de mensajería o incluso Hola todo el centro de datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-107">hello outage can affect some components of Service Bus, such as a messaging store, or even hello entire datacenter.</span></span> <span data-ttu-id="7eceb-108">Una vez resuelto el problema de hello, Bus de servicio vuelve a estar disponible.</span><span class="sxs-lookup"><span data-stu-id="7eceb-108">After hello problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="7eceb-109">Normalmente, una interrupción no provoca la pérdida de mensajes ni otros datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="7eceb-110">Un ejemplo de un error de componente es indisponibilidad de Hola de un almacén de mensajería determinado.</span><span class="sxs-lookup"><span data-stu-id="7eceb-110">An example of a component failure is hello unavailability of a particular messaging store.</span></span> <span data-ttu-id="7eceb-111">Un ejemplo de una interrupción de todo el centro de datos es un error de alimentación del centro de datos de Hola o un conmutador de red defectuoso del centro de datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-111">An example of a datacenter-wide outage is a power failure of hello datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="7eceb-112">Una interrupción puede durar desde unos tooa minutos pocos días.</span><span class="sxs-lookup"><span data-stu-id="7eceb-112">An outage can last from a few minutes tooa few days.</span></span>

<span data-ttu-id="7eceb-113">Un desastre se define como la pérdida permanente de Hola de una unidad de escala de Bus de servicio o el centro de datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-113">A disaster is defined as hello permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="7eceb-114">Centro de datos de Hello puede o puede no estar disponible de nuevo.</span><span class="sxs-lookup"><span data-stu-id="7eceb-114">hello datacenter may or may not become available again.</span></span> <span data-ttu-id="7eceb-115">Normalmente, un desastre provoca la pérdida de algunos o todos los mensajes u otros datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="7eceb-116">Algunos ejemplos de desastres son los incendios, las inundaciones o los terremotos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="7eceb-117">Arquitectura actual</span><span class="sxs-lookup"><span data-stu-id="7eceb-117">Current architecture</span></span>
<span data-ttu-id="7eceb-118">Bus de servicio usa varios almacenes toostore mensajes de mensajería se envían tooqueues o temas.</span><span class="sxs-lookup"><span data-stu-id="7eceb-118">Service Bus uses multiple messaging stores toostore messages that are sent tooqueues or topics.</span></span> <span data-ttu-id="7eceb-119">Una cola sin particiones o tema se asigna tooone almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="7eceb-119">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="7eceb-120">Si este almacén de mensajería no está disponible, se producirá un error en todas las operaciones de esa cola o tema.</span><span class="sxs-lookup"><span data-stu-id="7eceb-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="7eceb-121">Todas las entidades de mensajería de Service Bus (colas, temas, retransmisiones) residen en un espacio de nombres de servicio, asociado con un centro de datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="7eceb-122">Bus de servicio no habilita la replicación geográfica automática de datos, ni tampoco permite un espacio de nombres toospan varios centros de datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace toospan multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="7eceb-123">Protección contra interrupciones de ACS</span><span class="sxs-lookup"><span data-stu-id="7eceb-123">Protecting against ACS outages</span></span>
<span data-ttu-id="7eceb-124">Si está usando credenciales de ACS y este deja de estar disponible, los clientes ya no pueden obtener tokens.</span><span class="sxs-lookup"><span data-stu-id="7eceb-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="7eceb-125">Los clientes que tienen un token en tiempo de hello que ACS deja de funcionar pueden continuar toouse Bus de servicio hasta que expiran los tokens de Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-125">Clients that have a token at hello time ACS goes down can continue toouse Service Bus until hello tokens expire.</span></span> <span data-ttu-id="7eceb-126">duración del token Hola predeterminado es de 3 horas.</span><span class="sxs-lookup"><span data-stu-id="7eceb-126">hello default token lifetime is 3 hours.</span></span>

<span data-ttu-id="7eceb-127">tooprotect contra los cortes de ACS, use tokens de firma de acceso compartido (SAS).</span><span class="sxs-lookup"><span data-stu-id="7eceb-127">tooprotect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="7eceb-128">En este caso, cliente hello autentica directamente con el Bus de servicio mediante la firma de un token autogenerado con una clave secreta.</span><span class="sxs-lookup"><span data-stu-id="7eceb-128">In this case, hello client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="7eceb-129">Llamadas tooACS ya no son necesarias.</span><span class="sxs-lookup"><span data-stu-id="7eceb-129">Calls tooACS are no longer required.</span></span> <span data-ttu-id="7eceb-130">Para obtener más información sobre los tokens SAS, consulte [Autenticación y autorización de Service Bus][Service Bus authentication].</span><span class="sxs-lookup"><span data-stu-id="7eceb-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="7eceb-131">Protección de colas y temas contra errores en el almacén de mensajería</span><span class="sxs-lookup"><span data-stu-id="7eceb-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="7eceb-132">Una cola sin particiones o tema se asigna tooone almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="7eceb-132">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="7eceb-133">Si este almacén de mensajería no está disponible, se producirá un error en todas las operaciones de esa cola o tema.</span><span class="sxs-lookup"><span data-stu-id="7eceb-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="7eceb-134">A particiones cola en hello en otra parte, consta de varios fragmentos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-134">A partitioned queue, on hello other hand, consists of multiple fragments.</span></span> <span data-ttu-id="7eceb-135">Cada fragmento se guarda en un almacén de mensajería diferente.</span><span class="sxs-lookup"><span data-stu-id="7eceb-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="7eceb-136">Cuando se envía un mensaje tooa cola o tema particionado, Service Bus asigna tooone de mensaje Hola de fragmentos de Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-136">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="7eceb-137">Si no está disponible el almacén de mensajería correspondiente hello, Bus de servicio escribe otro fragmento de hello mensaje tooa, si es posible.</span><span class="sxs-lookup"><span data-stu-id="7eceb-137">If hello corresponding messaging store is unavailable, Service Bus writes hello message tooa different fragment, if possible.</span></span> <span data-ttu-id="7eceb-138">Para obtener más información sobre las entidades con particiones, consulte [Entidades de mensajería con particiones][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="7eceb-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="7eceb-139">Protección contra desastres o interrupciones del centro de datos</span><span class="sxs-lookup"><span data-stu-id="7eceb-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="7eceb-140">tooallow para una conmutación por error entre dos centros de datos, puede crear un espacio de nombres del servicio de Bus de servicio en cada centro de datos.</span><span class="sxs-lookup"><span data-stu-id="7eceb-140">tooallow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="7eceb-141">Hola, por ejemplo, el espacio de nombres de servicio de Bus de servicio **contosoPrimary.servicebus.windows.net** es posible que encuentre en la región Norte/Central de Estados Unidos de hello, y **contosoSecondary.servicebus.windows.net**podría encontrarse en la región sur/Central nos de Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-141">For example, hello Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in hello United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in hello US South/Central region.</span></span> <span data-ttu-id="7eceb-142">Si una entidad de mensajería de Service Bus debe permanecer accesible en presencia de Hola de una interrupción del centro de datos, puede crear esa entidad en ambos espacios de nombres.</span><span class="sxs-lookup"><span data-stu-id="7eceb-142">If a Service Bus messaging entity must remain accessible in hello presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="7eceb-143">Para obtener más información, vea Hola sección "Error de Bus de servicio dentro de un centro de datos de Azure" [asincrónica de alta disponibilidad y patrones de mensajería][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="7eceb-143">For more information, see hello "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="7eceb-144">Protección de los extremos de retransmisión contra desastres o interrupciones del centro de datos</span><span class="sxs-lookup"><span data-stu-id="7eceb-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="7eceb-145">Replicación geográfica de extremos de retransmisión permite que un servicio que expone un toobe de extremo de retransmisión accesible en presencia de Hola de interrupciones del Bus de servicio.</span><span class="sxs-lookup"><span data-stu-id="7eceb-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint toobe reachable in hello presence of Service Bus outages.</span></span> <span data-ttu-id="7eceb-146">servicio de Hola tooachieve replicación geográfica, debe crear dos extremos de retransmisión en diferentes espacios de nombres.</span><span class="sxs-lookup"><span data-stu-id="7eceb-146">tooachieve geo-replication, hello service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="7eceb-147">espacios de nombres de Hello deben residir en distintos centros de datos y Hola dos extremos deben tener nombres diferentes.</span><span class="sxs-lookup"><span data-stu-id="7eceb-147">hello namespaces must reside in different datacenters and hello two endpoints must have different names.</span></span> <span data-ttu-id="7eceb-148">Por ejemplo, se puede acceder a un punto de conexión principal en **contosoPrimary.servicebus.windows.net/myPrimaryService**, mientras que su equivalente secundario resulta accesible en **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span><span class="sxs-lookup"><span data-stu-id="7eceb-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="7eceb-149">el servicio de Hello, a continuación, escucha en ambos extremos y un cliente puede invocar el servicio de Hola a través de cualquier punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="7eceb-149">hello service then listens on both endpoints, and a client can invoke hello service via either endpoint.</span></span> <span data-ttu-id="7eceb-150">Una aplicación cliente aleatoriamente elige uno de hello retransmisiones como extremo principal de Hola y envía su extremo activo toohello de solicitud.</span><span class="sxs-lookup"><span data-stu-id="7eceb-150">A client application randomly picks one of hello relays as hello primary endpoint, and sends its request toohello active endpoint.</span></span> <span data-ttu-id="7eceb-151">Si se produce un error en la operación de hello con un código de error, este error indica que ese extremo de retransmisión hello no está disponible.</span><span class="sxs-lookup"><span data-stu-id="7eceb-151">If hello operation fails with an error code, this failure indicates that hello relay endpoint is not available.</span></span> <span data-ttu-id="7eceb-152">aplicación Hello abre un extremo de copia de seguridad de canal toohello y vuelve a solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="7eceb-152">hello application opens a channel toohello backup endpoint and reissues hello request.</span></span> <span data-ttu-id="7eceb-153">En ese momento Hola active y extremos de reserva de hello intercambian sus roles: aplicación de cliente de hello considera Hola antiguo extremo activo toobe Hola nuevo extremo de copia de seguridad y toobe de extremo de reserva anterior de Hola Hola nuevo extremo activo.</span><span class="sxs-lookup"><span data-stu-id="7eceb-153">At that point hello active and hello backup endpoints switch roles: hello client application considers hello old active endpoint toobe hello new backup endpoint, and hello old backup endpoint toobe hello new active endpoint.</span></span> <span data-ttu-id="7eceb-154">Si ambas operaciones producen un error, roles de Hola de dos entidades de hello permanecen sin cambios y se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="7eceb-154">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="7eceb-155">Hola [replicación geográfica con Bus de servicio retransmite mensajes] [ Geo-replication with Service Bus relayed Messages] ejemplo muestra cómo se retransmite tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="7eceb-155">hello [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how tooreplicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="7eceb-156">Protección de colas y temas contra desastres o interrupciones del centro de datos</span><span class="sxs-lookup"><span data-stu-id="7eceb-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="7eceb-157">tooachieve resistencia frente a interrupciones del centro de datos cuando se usa mensajería asíncrona, Bus de servicio admite dos métodos: *active* y *pasivo* replicación.</span><span class="sxs-lookup"><span data-stu-id="7eceb-157">tooachieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="7eceb-158">Para cada enfoque, si una determinada cola o tema debe permanecer accesible en presencia de Hola de una interrupción del centro de datos, puede crearlo en ambos espacios de nombres.</span><span class="sxs-lookup"><span data-stu-id="7eceb-158">For each approach, if a given queue or topic must remain accessible in hello presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="7eceb-159">Ambas entidades pueden tener Hola mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="7eceb-159">Both entities can have hello same name.</span></span> <span data-ttu-id="7eceb-160">Por ejemplo, se puede acceder a una cola principal en **contosoPrimary.servicebus.windows.net/myQueue**, mientras que su equivalente secundaria resulta accesible en **contosoSecondary.servicebus.windows.net/myQueue**.</span><span class="sxs-lookup"><span data-stu-id="7eceb-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="7eceb-161">Si la aplicación hello no requiere comunicación permanente de remitente al receptor, aplicación hello puede implementar una cola del lado cliente duradera tooprevent pérdida y tooshield Hola remitente del mensaje de los errores transitorios de Bus de servicio.</span><span class="sxs-lookup"><span data-stu-id="7eceb-161">If hello application does not require permanent sender-to-receiver communication, hello application can implement a durable client-side queue tooprevent message loss and tooshield hello sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="7eceb-162">Replicación activa</span><span class="sxs-lookup"><span data-stu-id="7eceb-162">Active replication</span></span>
<span data-ttu-id="7eceb-163">La replicación activa usa entidades en ambos espacios de nombres para cada operación.</span><span class="sxs-lookup"><span data-stu-id="7eceb-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="7eceb-164">Cualquier cliente que envía un mensaje envía dos copias de hello mismo mensaje.</span><span class="sxs-lookup"><span data-stu-id="7eceb-164">Any client that sends a message sends two copies of hello same message.</span></span> <span data-ttu-id="7eceb-165">Hola primera copia se envía la entidad primaria toohello (por ejemplo, **contosoPrimary.servicebus.windows.net/sales**), y la segunda copia del mensaje de bienvenida de Hola se envía la entidad secundaria toohello (por ejemplo,  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="7eceb-165">hello first copy is sent toohello primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and hello second copy of hello message is sent toohello secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="7eceb-166">Un cliente recibe mensajes de ambas colas.</span><span class="sxs-lookup"><span data-stu-id="7eceb-166">A client receives messages from both queues.</span></span> <span data-ttu-id="7eceb-167">procesos de receptor de Hola Hola primera copia de un mensaje, y se suprime la segunda copia de Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-167">hello receiver processes hello first copy of a message, and hello second copy is suppressed.</span></span> <span data-ttu-id="7eceb-168">toosuppress mensajes duplicados, el remitente de hello debe etiquetar cada mensaje con un identificador único.</span><span class="sxs-lookup"><span data-stu-id="7eceb-168">toosuppress duplicate messages, hello sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="7eceb-169">Ambas copias del mensaje de saludo deben estar etiquetados con hello mismo identificador.</span><span class="sxs-lookup"><span data-stu-id="7eceb-169">Both copies of hello message must be tagged with hello same identifier.</span></span> <span data-ttu-id="7eceb-170">Puede usar hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] o [BrokeredMessage.Label] [ BrokeredMessage.Label] propiedades, o un hello de tootag de propiedad personalizada Mensaje.</span><span class="sxs-lookup"><span data-stu-id="7eceb-170">You can use hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property tootag hello message.</span></span> <span data-ttu-id="7eceb-171">receptor de Hello debe mantener una lista de mensajes que ya ha recibido.</span><span class="sxs-lookup"><span data-stu-id="7eceb-171">hello receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="7eceb-172">Hola [replicación geográfica con mensajes asíncronos del Bus de servicio] [ Geo-replication with Service Bus Brokered Messages] muestra la replicación activa de entidades de mensajería.</span><span class="sxs-lookup"><span data-stu-id="7eceb-172">hello [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="7eceb-173">enfoque de Hello replicación activa dobla el número de Hola de operaciones, por lo tanto, este enfoque puede suponer toohigher costo.</span><span class="sxs-lookup"><span data-stu-id="7eceb-173">hello active replication approach doubles hello number of operations, therefore this approach can lead toohigher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="7eceb-174">Replicación pasiva</span><span class="sxs-lookup"><span data-stu-id="7eceb-174">Passive replication</span></span>
<span data-ttu-id="7eceb-175">En caso de hello sin errores, replicación pasiva solo usa una de dos entidades de mensajería Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-175">In hello fault-free case, passive replication uses only one of hello two messaging entities.</span></span> <span data-ttu-id="7eceb-176">Un cliente envía la entidad activa de hello mensaje toohello.</span><span class="sxs-lookup"><span data-stu-id="7eceb-176">A client sends hello message toohello active entity.</span></span> <span data-ttu-id="7eceb-177">Si se produce un error en la operación de hello en entidad activa Hola con un código de error que indica el centro de datos de Hola que entidad activa de hosts Hola podría no estar disponible, el cliente de hello envía una copia de la entidad de seguridad de toohello de mensaje de Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-177">If hello operation on hello active entity fails with an error code that indicates hello datacenter that hosts hello active entity might be unavailable, hello client sends a copy of hello message toohello backup entity.</span></span> <span data-ttu-id="7eceb-178">En ese momento Hola activa y las entidades de copia de seguridad de hello intercambian sus roles: Hola antigua entidad activa toobe Hola nueva entidad de seguridad considera que el cliente remitente hello y entidad de seguridad anterior de hello es la nueva entidad activa de Hola.</span><span class="sxs-lookup"><span data-stu-id="7eceb-178">At that point hello active and hello backup entities switch roles: hello sending client considers hello old active entity toobe hello new backup entity, and hello old backup entity is hello new active entity.</span></span> <span data-ttu-id="7eceb-179">Si ambas operaciones producen un error, roles de Hola de dos entidades de hello permanecen sin cambios y se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="7eceb-179">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="7eceb-180">Un cliente recibe mensajes de ambas colas.</span><span class="sxs-lookup"><span data-stu-id="7eceb-180">A client receives messages from both queues.</span></span> <span data-ttu-id="7eceb-181">Porque no hay posibilidad de dicho receptor Hola recibe dos copias del mismo mensaje, hello de hello receptor debe suprimir los mensajes duplicados.</span><span class="sxs-lookup"><span data-stu-id="7eceb-181">Because there is a chance that hello receiver receives two copies of hello same message, hello receiver must suppress duplicate messages.</span></span> <span data-ttu-id="7eceb-182">Puede suprimir duplicados en hello misma forma en que se ha descrito para la replicación activa.</span><span class="sxs-lookup"><span data-stu-id="7eceb-182">You can suppress duplicates in hello same way as described for active replication.</span></span>

<span data-ttu-id="7eceb-183">En general, la replicación pasiva es más económica que la activa porque en la mayoría de los casos se realiza una única operación.</span><span class="sxs-lookup"><span data-stu-id="7eceb-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="7eceb-184">Latencia, el rendimiento y coste económico son idénticos toohello no replicada escenario.</span><span class="sxs-lookup"><span data-stu-id="7eceb-184">Latency, throughput, and monetary cost are identical toohello non-replicated scenario.</span></span>

<span data-ttu-id="7eceb-185">Cuando se utiliza la replicación pasiva, Hola mensajes de los escenarios siguientes se pueden perder o recibirse dos veces:</span><span class="sxs-lookup"><span data-stu-id="7eceb-185">When using passive replication, in hello following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="7eceb-186">**Pérdida o retraso de mensaje**: suponga que remitente Hola enviado correctamente una cola de mensajes m1 toohello principal, y, a continuación, cola de hello deja de estar disponible antes de que el receptor de hello reciba m1.</span><span class="sxs-lookup"><span data-stu-id="7eceb-186">**Message delay or loss**: Assume that hello sender successfully sent a message m1 toohello primary queue, and then hello queue becomes unavailable before hello receiver receives m1.</span></span> <span data-ttu-id="7eceb-187">remitente de Hello envía una cola de mensajes posteriores m2 toohello secundaria.</span><span class="sxs-lookup"><span data-stu-id="7eceb-187">hello sender sends a subsequent message m2 toohello secondary queue.</span></span> <span data-ttu-id="7eceb-188">Si la cola principal hello no está disponible temporalmente, receptor Hola recibe m1 después de cola de hello vuelva a estar disponible.</span><span class="sxs-lookup"><span data-stu-id="7eceb-188">If hello primary queue is temporarily unavailable, hello receiver receives m1 after hello queue becomes available again.</span></span> <span data-ttu-id="7eceb-189">En el caso de un desastre, es no posible que receptor Hola nunca reciba m1.</span><span class="sxs-lookup"><span data-stu-id="7eceb-189">In case of a disaster, hello receiver may never receive m1.</span></span>
* <span data-ttu-id="7eceb-190">**Recepción duplicada**: suponga ese remitente Hola envía una cola principal de mensaje m toohello.</span><span class="sxs-lookup"><span data-stu-id="7eceb-190">**Duplicate reception**: Assume that hello sender sends a message m toohello primary queue.</span></span> <span data-ttu-id="7eceb-191">Bus de servicio correctamente procesa m, pero se produce un error toosend una respuesta.</span><span class="sxs-lookup"><span data-stu-id="7eceb-191">Service Bus successfully processes m but fails toosend a response.</span></span> <span data-ttu-id="7eceb-192">Una vez Hola enviar agota el tiempo de operación, remitente Hola envía una copia idéntica de la cola de m toohello secundaria.</span><span class="sxs-lookup"><span data-stu-id="7eceb-192">After hello send operation times out, hello sender sends an identical copy of m toohello secondary queue.</span></span> <span data-ttu-id="7eceb-193">Si receptor Hola primera copia de Hola de tooreceive capaz de m antes de cola de hello principal deja de estar disponible, receptor Hola recibe ambas copias de m en aproximadamente Hola mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="7eceb-193">If hello receiver is able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver receives both copies of m at approximately hello same time.</span></span> <span data-ttu-id="7eceb-194">Si receptor hello no es primera copia de Hola de tooreceive capaz de m antes de cola de hello principal deja de estar disponible, receptor Hola recibe inicialmente solo Hola segunda copia de m, pero, a continuación, recibe una segunda copia de m cuando la cola principal Hola deja de estar disponible.</span><span class="sxs-lookup"><span data-stu-id="7eceb-194">If hello receiver is not able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver initially receives only hello second copy of m, but then receives a second copy of m when hello primary queue becomes available.</span></span>

<span data-ttu-id="7eceb-195">Hola [replicación geográfica con Bus de servicio asíncrona mensajes] [ Geo-replication with Service Bus Brokered Messages] ejemplo muestra la replicación pasiva de entidades de mensajería.</span><span class="sxs-lookup"><span data-stu-id="7eceb-195">hello [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7eceb-196">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="7eceb-196">Next steps</span></span>
<span data-ttu-id="7eceb-197">toolearn más información acerca de la recuperación ante desastres, vea estos artículos:</span><span class="sxs-lookup"><span data-stu-id="7eceb-197">toolearn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="7eceb-198">[Continuidad de negocio de SQL Database de Azure][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="7eceb-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="7eceb-199">[Diseño de aplicaciones resistentes de Azure][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="7eceb-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
