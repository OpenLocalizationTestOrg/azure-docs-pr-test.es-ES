---
title: Colas de mensajes fallidos de Service Bus | Microsoft Docs
description: "Información general de colas de mensajes fallidos del Bus de servicio de Azure"
services: service-bus-messaging
documentationcenter: .net
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 68b2aa38-dba7-491a-9c26-0289bc15d397
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/17/2017
ms.author: clemensv;sethm
ms.openlocfilehash: c16bcf30ab96f79e59404a41852e4cd227e28b08
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="overview-of-service-bus-dead-letter-queues"></a><span data-ttu-id="531a1-103">Información general de colas de mensajes fallidos del Bus de servicio</span><span class="sxs-lookup"><span data-stu-id="531a1-103">Overview of Service Bus dead-letter queues</span></span>

<span data-ttu-id="531a1-104">Las colas de Service Bus y las suscripciones a temas proporcionan una subcola secundaria, llamada *cola de mensajes fallidos* (DLQ).</span><span class="sxs-lookup"><span data-stu-id="531a1-104">Service Bus queues and topic subscriptions provide a secondary sub-queue, called a *dead-letter queue* (DLQ).</span></span> <span data-ttu-id="531a1-105">La cola de mensajes fallidos no se necesita crear explícitamente y no se puede eliminar o administrar independientemente de la entidad principal.</span><span class="sxs-lookup"><span data-stu-id="531a1-105">The dead-letter queue does not need to be explicitly created and cannot be deleted or otherwise managed independent of the main entity.</span></span>

<span data-ttu-id="531a1-106">En este artículo se describen las colas de mensajes fallidos de Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="531a1-106">This article discusses dead-letter queues in Azure Service Bus.</span></span> <span data-ttu-id="531a1-107">Gran parte de la descripción se muestra en el [ejemplo de colas de mensajes fallidos](https://github.com/Azure/azure-service-bus/tree/master/samples/DotNet/Microsoft.ServiceBus.Messaging/DeadletterQueue) en GitHub.</span><span class="sxs-lookup"><span data-stu-id="531a1-107">Much of the discussion is illustrated by the [Dead-Letter Queues sample](https://github.com/Azure/azure-service-bus/tree/master/samples/DotNet/Microsoft.ServiceBus.Messaging/DeadletterQueue) on GitHub.</span></span>
 
## <a name="the-dead-letter-queue"></a><span data-ttu-id="531a1-108">Cola de mensajes fallidos</span><span class="sxs-lookup"><span data-stu-id="531a1-108">The dead-letter queue</span></span>

<span data-ttu-id="531a1-109">La finalidad de la cola de mensajes fallidos es mantener los mensajes que no se pueden entregar a ningún destinatario o los mensajes que no se pudieron procesar.</span><span class="sxs-lookup"><span data-stu-id="531a1-109">The purpose of the dead-letter queue is to hold messages that cannot be delivered to any receiver, or messages that could not be processed.</span></span> <span data-ttu-id="531a1-110">Después, los mensajes se quitan de la cola de mensajes fallidos y se inspeccionan.</span><span class="sxs-lookup"><span data-stu-id="531a1-110">Messages can then be removed from the DLQ and inspected.</span></span> <span data-ttu-id="531a1-111">Una aplicación podría, con ayuda de un operador, corregir los problemas y volver a enviar el mensaje, registrar el hecho de que se produjo un error y llevar a cabo medidas correctivas.</span><span class="sxs-lookup"><span data-stu-id="531a1-111">An application might, with help of an operator, correct issues and resubmit the message, log the fact that there was an error, and take corrective action.</span></span> 

<span data-ttu-id="531a1-112">Desde el punto de vista de API y protocolo, la cola de mensajes fallidos es muy similar a cualquier otra cola, salvo que los mensajes solo se pueden enviar a través del gesto de mensajes fallidos de la entidad primaria.</span><span class="sxs-lookup"><span data-stu-id="531a1-112">From an API and protocol perspective, the DLQ is mostly similar to any other queue, except that messages can only be submitted via the dead-letter gesture of the parent entity.</span></span> <span data-ttu-id="531a1-113">Además, no se observa el período de vida, y no puede tratar como fallido un mensaje desde una cola de mensajes fallidos.</span><span class="sxs-lookup"><span data-stu-id="531a1-113">In addition, time-to-live is not observed, and you can't dead-letter a message from a DLQ.</span></span> <span data-ttu-id="531a1-114">La cola de mensajes fallidos es totalmente compatible con las operaciones transaccionales y de entrega de bloqueo de información.</span><span class="sxs-lookup"><span data-stu-id="531a1-114">The dead-letter queue fully supports peek-lock delivery and transactional operations.</span></span>

<span data-ttu-id="531a1-115">Tenga en cuenta que no hay limpieza automática de la cola de mensajes fallidos.</span><span class="sxs-lookup"><span data-stu-id="531a1-115">Note that there is no automatic cleanup of the DLQ.</span></span> <span data-ttu-id="531a1-116">Los mensajes permanecen en la cola de mensajes fallidos hasta que los recupera explícitamente de dicha cola y llama a [Complete()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_CompleteAsync) en el mensaje fallido.</span><span class="sxs-lookup"><span data-stu-id="531a1-116">Messages remain in the DLQ until you explicitly retrieve them from the DLQ and call [Complete()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_CompleteAsync) on the dead-letter message.</span></span>

## <a name="moving-messages-to-the-dlq"></a><span data-ttu-id="531a1-117">Movimiento de mensajes a la cola de mensajes fallidos</span><span class="sxs-lookup"><span data-stu-id="531a1-117">Moving messages to the DLQ</span></span>

<span data-ttu-id="531a1-118">Hay varias actividades en el Bus de servicio que provocan que los mensajes se inserten en la cola de mensajes fallidos desde dentro del propio motor de mensajería.</span><span class="sxs-lookup"><span data-stu-id="531a1-118">There are several activities in Service Bus that cause messages to get pushed to the DLQ from within the messaging engine itself.</span></span> <span data-ttu-id="531a1-119">Una aplicación también puede mover mensajes explícitamente a la cola de mensajes fallidos.</span><span class="sxs-lookup"><span data-stu-id="531a1-119">An application can also explicitly move messages to the DLQ.</span></span> 

<span data-ttu-id="531a1-120">Como el agente mueve el mensaje, se agregan dos propiedades a dicho mensaje dado que el agente llama a su versión interna del método [DeadLetter](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_DeadLetter_System_String_System_String_) en el mensaje: `DeadLetterReason` y `DeadLetterErrorDescription`.</span><span class="sxs-lookup"><span data-stu-id="531a1-120">As the message gets moved by the broker, two properties are added to the message as the broker calls its internal version of the [DeadLetter](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_DeadLetter_System_String_System_String_) method on the message: `DeadLetterReason` and `DeadLetterErrorDescription`.</span></span>

<span data-ttu-id="531a1-121">Las aplicaciones pueden definir sus propios códigos para la propiedad `DeadLetterReason`, pero el sistema establece los valores siguientes.</span><span class="sxs-lookup"><span data-stu-id="531a1-121">Applications can define their own codes for the `DeadLetterReason` property, but the system sets the following values.</span></span>

| <span data-ttu-id="531a1-122">Condición</span><span class="sxs-lookup"><span data-stu-id="531a1-122">Condition</span></span> | <span data-ttu-id="531a1-123">DeadLetterReason</span><span class="sxs-lookup"><span data-stu-id="531a1-123">DeadLetterReason</span></span> | <span data-ttu-id="531a1-124">DeadLetterErrorDescription</span><span class="sxs-lookup"><span data-stu-id="531a1-124">DeadLetterErrorDescription</span></span> |
| --- | --- | --- |
| <span data-ttu-id="531a1-125">Siempre</span><span class="sxs-lookup"><span data-stu-id="531a1-125">Always</span></span> |<span data-ttu-id="531a1-126">HeaderSizeExceeded</span><span class="sxs-lookup"><span data-stu-id="531a1-126">HeaderSizeExceeded</span></span> |<span data-ttu-id="531a1-127">Se superó la cuota de tamaño de esta transmisión.</span><span class="sxs-lookup"><span data-stu-id="531a1-127">The size quota for this stream has been exceeded.</span></span> |
| <span data-ttu-id="531a1-128">!TopicDescription.</span><span class="sxs-lookup"><span data-stu-id="531a1-128">!TopicDescription.</span></span><br /><span data-ttu-id="531a1-129">EnableFilteringMessagesBeforePublishing and SubscriptionDescription.</span><span class="sxs-lookup"><span data-stu-id="531a1-129">EnableFilteringMessagesBeforePublishing and SubscriptionDescription.</span></span><br /><span data-ttu-id="531a1-130">EnableDeadLetteringOnFilterEvaluationExceptions</span><span class="sxs-lookup"><span data-stu-id="531a1-130">EnableDeadLetteringOnFilterEvaluationExceptions</span></span> |<span data-ttu-id="531a1-131">exception.GetType().Name</span><span class="sxs-lookup"><span data-stu-id="531a1-131">exception.GetType().Name</span></span> |<span data-ttu-id="531a1-132">exception.Message</span><span class="sxs-lookup"><span data-stu-id="531a1-132">exception.Message</span></span> |
| <span data-ttu-id="531a1-133">EnableDeadLetteringOnMessageExpiration</span><span class="sxs-lookup"><span data-stu-id="531a1-133">EnableDeadLetteringOnMessageExpiration</span></span> |<span data-ttu-id="531a1-134">TTLExpiredException</span><span class="sxs-lookup"><span data-stu-id="531a1-134">TTLExpiredException</span></span> |<span data-ttu-id="531a1-135">El mensaje expiró y se consideró fallido.</span><span class="sxs-lookup"><span data-stu-id="531a1-135">The message expired and was dead lettered.</span></span> |
| <span data-ttu-id="531a1-136">SubscriptionDescription.RequiresSession</span><span class="sxs-lookup"><span data-stu-id="531a1-136">SubscriptionDescription.RequiresSession</span></span> |<span data-ttu-id="531a1-137">El identificador de sesión es null.</span><span class="sxs-lookup"><span data-stu-id="531a1-137">Session id is null.</span></span> |<span data-ttu-id="531a1-138">La entidad habilitada por sesión no permite un mensaje cuyo identificador de sesión es null.</span><span class="sxs-lookup"><span data-stu-id="531a1-138">Session enabled entity doesn't allow a message whose session identifier is null.</span></span> |
| <span data-ttu-id="531a1-139">!cola de mensajes fallidos</span><span class="sxs-lookup"><span data-stu-id="531a1-139">!dead letter queue</span></span> |<span data-ttu-id="531a1-140">MaxTransferHopCountExceeded</span><span class="sxs-lookup"><span data-stu-id="531a1-140">MaxTransferHopCountExceeded</span></span> |<span data-ttu-id="531a1-141">Null</span><span class="sxs-lookup"><span data-stu-id="531a1-141">Null</span></span> |
| <span data-ttu-id="531a1-142">Mensajes fallidos explícitos de aplicación</span><span class="sxs-lookup"><span data-stu-id="531a1-142">Application explicit dead lettering</span></span> |<span data-ttu-id="531a1-143">Especificado por la aplicación</span><span class="sxs-lookup"><span data-stu-id="531a1-143">Specified by application</span></span> |<span data-ttu-id="531a1-144">Especificado por la aplicación</span><span class="sxs-lookup"><span data-stu-id="531a1-144">Specified by application</span></span> |

## <a name="exceeding-maxdeliverycount"></a><span data-ttu-id="531a1-145">Superación de MaxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="531a1-145">Exceeding MaxDeliveryCount</span></span>
<span data-ttu-id="531a1-146">Las colas y las suscripciones tienen las propiedades [QueueDescription.MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MaxDeliveryCount) y [SubscriptionDescription.MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.subscriptiondescription#Microsoft_ServiceBus_Messaging_SubscriptionDescription_MaxDeliveryCount), respectivamente; el valor predeterminado es 10.</span><span class="sxs-lookup"><span data-stu-id="531a1-146">Queues and subscriptions each have a [QueueDescription.MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MaxDeliveryCount) and [SubscriptionDescription.MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.subscriptiondescription#Microsoft_ServiceBus_Messaging_SubscriptionDescription_MaxDeliveryCount) property respectively; the default value is 10.</span></span> <span data-ttu-id="531a1-147">Siempre que un mensaje se ha entregado bajo un bloqueo ([ReceiveMode.PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode)), pero se ha abandonado explícitamente o el bloqueo ha expirado, la propiedad [BrokeredMessage.DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_DeliveryCount) del mensaje se incrementa.</span><span class="sxs-lookup"><span data-stu-id="531a1-147">Whenever a message has been delivered under a lock ([ReceiveMode.PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode)), but has been either explicitly abandoned or the lock has expired, the message's [BrokeredMessage.DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_DeliveryCount) is incremented.</span></span> <span data-ttu-id="531a1-148">Cuando [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_DeliveryCount) supera a [MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MaxDeliveryCount), el mensaje se mueve a la cola de mensajes fallidos, y se especifica el código de motivo `MaxDeliveryCountExceeded`.</span><span class="sxs-lookup"><span data-stu-id="531a1-148">When [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_DeliveryCount) exceeds [MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MaxDeliveryCount), the message is moved to the DLQ, specifying the `MaxDeliveryCountExceeded` reason code.</span></span>

<span data-ttu-id="531a1-149">Este comportamiento no se puede deshabilitar, pero puede establecer [MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MaxDeliveryCount) en un número muy grande.</span><span class="sxs-lookup"><span data-stu-id="531a1-149">This behavior cannot be disabled, but you can set [MaxDeliveryCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MaxDeliveryCount) to a very large number.</span></span>

## <a name="exceeding-timetolive"></a><span data-ttu-id="531a1-150">Superación de TimeToLive</span><span class="sxs-lookup"><span data-stu-id="531a1-150">Exceeding TimeToLive</span></span>
<span data-ttu-id="531a1-151">Cuando las propiedades [QueueDescription.EnableDeadLetteringOnMessageExpiration](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnableDeadLetteringOnMessageExpiration) o [SubscriptionDescription.EnableDeadLetteringOnMessageExpiration](/dotnet/api/microsoft.servicebus.messaging.subscriptiondescription#Microsoft_ServiceBus_Messaging_SubscriptionDescription_EnableDeadLetteringOnMessageExpiration) están establecidas en **true** (el valor predeterminado es **false**), todos los mensajes que expiran se mueven a la cola de mensajes fallidos y se especifica el código de motivo `TTLExpiredException`.</span><span class="sxs-lookup"><span data-stu-id="531a1-151">When the [QueueDescription.EnableDeadLetteringOnMessageExpiration](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnableDeadLetteringOnMessageExpiration) or [SubscriptionDescription.EnableDeadLetteringOnMessageExpiration](/dotnet/api/microsoft.servicebus.messaging.subscriptiondescription#Microsoft_ServiceBus_Messaging_SubscriptionDescription_EnableDeadLetteringOnMessageExpiration) property is set to **true** (the default is **false**), all expiring messages are moved to the DLQ, specifying the  `TTLExpiredException` reason code.</span></span>

<span data-ttu-id="531a1-152">Tenga en cuenta que los mensajes expirados solo se purgan y, por tanto, se mueven a la cola de mensajes fallidos cuando hay al menos un receptor activo tirando en la cola principal o suscripción; este comportamiento se produce por diseño.</span><span class="sxs-lookup"><span data-stu-id="531a1-152">Note that expired messages are only purged and therefore moved to the DLQ when there is at least one active receiver pulling on the main queue or subscription; that behavior is by design.</span></span>

## <a name="errors-while-processing-subscription-rules"></a><span data-ttu-id="531a1-153">Errores al procesar reglas de suscripción</span><span class="sxs-lookup"><span data-stu-id="531a1-153">Errors while processing subscription rules</span></span>
<span data-ttu-id="531a1-154">Cuando la propiedad [SubscriptionDescription.EnableDeadLetteringOnFilterEvaluationExceptions](/dotnet/api/microsoft.servicebus.messaging.subscriptiondescription#Microsoft_ServiceBus_Messaging_SubscriptionDescription_EnableDeadLetteringOnFilterEvaluationExceptions) está habilitada en una suscripción, todos los errores que se producen mientras se ejecuta la regla de filtro SQL de una suscripción se capturan en la cola de mensajes fallidos junto con el mensaje infractor.</span><span class="sxs-lookup"><span data-stu-id="531a1-154">When the [SubscriptionDescription.EnableDeadLetteringOnFilterEvaluationExceptions](/dotnet/api/microsoft.servicebus.messaging.subscriptiondescription#Microsoft_ServiceBus_Messaging_SubscriptionDescription_EnableDeadLetteringOnFilterEvaluationExceptions) property is enabled for a subscription, any errors that occur while a subscription's SQL filter rule executes are captured in the DLQ along with the offending message.</span></span>

## <a name="application-level-dead-lettering"></a><span data-ttu-id="531a1-155">Mensajes fallidos de nivel de aplicación</span><span class="sxs-lookup"><span data-stu-id="531a1-155">Application-level dead-lettering</span></span>
<span data-ttu-id="531a1-156">Además de las características de mensajes fallidos proporcionadas por el sistema, las aplicaciones pueden usar la cola de mensajes fallidos para rechazar explícitamente mensajes inaceptables.</span><span class="sxs-lookup"><span data-stu-id="531a1-156">In addition to the system-provided dead-lettering features, applications can use the DLQ to explicitly reject unacceptable messages.</span></span> <span data-ttu-id="531a1-157">Esto puede incluir mensajes que no se puede procesar correctamente debido a cualquier tipo problema del sistema, mensajes que mantienen cargas con formato incorrecto o mensajes que no superan la autenticación cuando se utiliza algún esquema de seguridad de nivel de mensaje.</span><span class="sxs-lookup"><span data-stu-id="531a1-157">This may include messages that cannot be properly processed due to any sort of system issue, messages that hold malformed payloads, or messages that fail authentication when some message-level security scheme is used.</span></span>

## <a name="dead-lettering-in-forwardto-or-sendvia-scenarios"></a><span data-ttu-id="531a1-158">Colas de mensajes fallidos en escenarios ForwardTo o SendVia</span><span class="sxs-lookup"><span data-stu-id="531a1-158">Dead-lettering in ForwardTo or SendVia scenarios</span></span>

<span data-ttu-id="531a1-159">Los mensajes se enviarán a la cola de mensajes fallidos de transferencia en las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="531a1-159">Messages will be sent to the transfer dead-letter queue under the following conditions:</span></span>

- <span data-ttu-id="531a1-160">Un mensaje pasa a través de más de 3 colas o temas que están [encadenados](service-bus-auto-forwarding.md).</span><span class="sxs-lookup"><span data-stu-id="531a1-160">A message passes through more than 3 queues or topics that are [chained together](service-bus-auto-forwarding.md).</span></span>
- <span data-ttu-id="531a1-161">La cola de destino o el tema se han deshabilitado o eliminado.</span><span class="sxs-lookup"><span data-stu-id="531a1-161">The destination queue or topic is disabled or deleted.</span></span>
- <span data-ttu-id="531a1-162">El tema o la cola de destino superan el tamaño máximo de entidad.</span><span class="sxs-lookup"><span data-stu-id="531a1-162">The destination queue or topic exceeds the maximum entity size.</span></span>

<span data-ttu-id="531a1-163">Para recuperar estos mensajes fallidos, puede crear un receptor con el método de utilidad [FormatTransferDeadletterPath](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_FormatTransferDeadLetterPath_System_String_).</span><span class="sxs-lookup"><span data-stu-id="531a1-163">To retrieve these dead-lettered messages, you can create a receiver using the [FormatTransferDeadletterPath](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_FormatTransferDeadLetterPath_System_String_) utility method.</span></span>

## <a name="example"></a><span data-ttu-id="531a1-164">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="531a1-164">Example</span></span>
<span data-ttu-id="531a1-165">El siguiente fragmento de código crea un receptor de mensajes.</span><span class="sxs-lookup"><span data-stu-id="531a1-165">The following code snippet creates a message receiver.</span></span> <span data-ttu-id="531a1-166">En el bucle de recepción de la cola principal, el código recupera el mensaje con [Receive(TimeSpan.Zero)](/dotnet/api/microsoft.servicebus.messaging.messagereceiver#Microsoft_ServiceBus_Messaging_MessageReceiver_Receive_System_TimeSpan_), que solicita al agente que devuelva al instante cualquier mensaje disponible, o que vuelva sin ningún resultado.</span><span class="sxs-lookup"><span data-stu-id="531a1-166">In the receive loop for the main queue, the code retrieves the message with [Receive(TimeSpan.Zero)](/dotnet/api/microsoft.servicebus.messaging.messagereceiver#Microsoft_ServiceBus_Messaging_MessageReceiver_Receive_System_TimeSpan_), which asks the broker to instantly return any message readily available, or to return with no result.</span></span> <span data-ttu-id="531a1-167">Si el código recibe un mensaje, inmediatamente lo abandona, lo que incrementa `DeliveryCount`.</span><span class="sxs-lookup"><span data-stu-id="531a1-167">If the code receives a message, it immediately abandons it, which increments the  `DeliveryCount`.</span></span> <span data-ttu-id="531a1-168">Una vez que el sistema mueve el mensaje a la cola de mensajes fallidos, la cola principal se vacía y se sale del bucle, dado que [ReceiveAsync](/dotnet/api/microsoft.servicebus.messaging.messagereceiver#Microsoft_ServiceBus_Messaging_MessageReceiver_ReceiveAsync_System_TimeSpan_) devuelve **null**.</span><span class="sxs-lookup"><span data-stu-id="531a1-168">Once the system moves the message to the DLQ, the main queue is empty and the loop exits, as [ReceiveAsync](/dotnet/api/microsoft.servicebus.messaging.messagereceiver#Microsoft_ServiceBus_Messaging_MessageReceiver_ReceiveAsync_System_TimeSpan_) returns **null**.</span></span>

```csharp
var receiver = await receiverFactory.CreateMessageReceiverAsync(queueName, ReceiveMode.PeekLock);
while(true)
{
    var msg = await receiver.ReceiveAsync(TimeSpan.Zero);
    if (msg != null)
    {
        Console.WriteLine("Picked up message; DeliveryCount {0}", msg.DeliveryCount);
        await msg.AbandonAsync();
    }
    else
    {
        break;
    }
}
```

## <a name="next-steps"></a><span data-ttu-id="531a1-169">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="531a1-169">Next steps</span></span>
<span data-ttu-id="531a1-170">Consulte los siguientes artículos para más información sobre las colas de Bus de servicio:</span><span class="sxs-lookup"><span data-stu-id="531a1-170">See the following articles for more information about Service Bus queues:</span></span>

* [<span data-ttu-id="531a1-171">Introducción a las colas de Service Bus</span><span class="sxs-lookup"><span data-stu-id="531a1-171">Get started with Service Bus queues</span></span>](service-bus-dotnet-get-started-with-queues.md)
* [<span data-ttu-id="531a1-172">Comparación de colas de Azure y colas de Service Bus</span><span class="sxs-lookup"><span data-stu-id="531a1-172">Azure Queues and Service Bus queues compared</span></span>](service-bus-azure-and-service-bus-queues-compared-contrasted.md)

