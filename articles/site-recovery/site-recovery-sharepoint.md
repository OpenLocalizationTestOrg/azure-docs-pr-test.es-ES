---
title: "una aplicación de SharePoint de varios niveles con Azure Site Recovery aaaReplicate | Documentos de Microsoft"
description: "Este artículo se describe cómo tooreplicate una aplicación de SharePoint de varios niveles con capacidades de Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: d856034ac2a3c95b0c1f0cf85e62c4e7a5a3210f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="b1e74-103">Replicación de una aplicación de SharePoint de niveles múltiples para una recuperación ante desastres mediante Azure Site Recovery | Microsoft Docs</span><span class="sxs-lookup"><span data-stu-id="b1e74-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="b1e74-104">Este artículo se describen en detalle cómo tooprotect una aplicación de SharePoint con [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b1e74-104">This article describes in detail how tooprotect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="b1e74-105">Información general</span><span class="sxs-lookup"><span data-stu-id="b1e74-105">Overview</span></span>

<span data-ttu-id="b1e74-106">Microsoft SharePoint es una aplicación eficaz que puede ayudar a un grupo o departamento a organizarse, colaborar y compartir información.</span><span class="sxs-lookup"><span data-stu-id="b1e74-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="b1e74-107">SharePoint proporciona portales de intranet, administración de archivos y documentos, colaboración, redes sociales, extranets, sitios web, motor de búsqueda Enterprise Search e inteligencia empresarial.</span><span class="sxs-lookup"><span data-stu-id="b1e74-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="b1e74-108">También dispone de integración de sistemas, integración de procesos y funcionalidades de automatización de flujos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="b1e74-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="b1e74-109">Normalmente, las organizaciones consideran como una nivel 1 aplicación confidencial toodowntime y pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="b1e74-109">Typically, organizations consider it as a Tier-1 application sensitive toodowntime and data loss.</span></span>

<span data-ttu-id="b1e74-110">En la actualidad, la aplicación Microsoft SharePoint no tiene integrada ninguna funcionalidad de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="b1e74-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="b1e74-111">Independientemente del tipo hello y la escala de un desastre, la recuperación implica usar Hola de un centro de datos en espera que se puede recuperar la granja de servidores de Hola a.</span><span class="sxs-lookup"><span data-stu-id="b1e74-111">Regardless of hello type and scale of a disaster, recovery involves hello use of a standby data center that you can recover hello farm to.</span></span> <span data-ttu-id="b1e74-112">Centros de datos en espera se requieren en escenarios donde no se pueden recuperar los sistemas locales de redundancia y copias de seguridad de interrupción de hello en el centro de datos principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from hello outage at hello primary data center.</span></span>

<span data-ttu-id="b1e74-113">Una solución de recuperación ante desastres conveniente debe permitir que el modelo de planes de recuperación alrededor de arquitecturas de aplicación compleja de hello como SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-113">A good disaster recovery solution should allow modeling of recovery plans around hello  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="b1e74-114">También debe tener Hola capacidad tooadd personalizar pasos toohandle aplicación asignaciones entre los distintos niveles y, por tanto, proporcionar un solo clic, conmutación por error con un RTO inferior en caso de hello de un desastre.</span><span class="sxs-lookup"><span data-stu-id="b1e74-114">It should also have hello ability tooadd customized steps toohandle application mappings between various tiers and hence providing a single-click failover with a lower RTO in hello event of a disaster.</span></span>

<span data-ttu-id="b1e74-115">Este artículo se describen en detalle cómo tooprotect una aplicación de SharePoint con [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b1e74-115">This article describes in detail how tooprotect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="b1e74-116">Este artículo explica las prácticas recomendadas para la replicación de una tooAzure de aplicación de SharePoint de tres niveles, cómo se puede hacer una exploración de recuperación ante desastres y cómo puede tooAzure de aplicación Hola de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b1e74-116">This article will cover best practices for replicating a three tier SharePoint application tooAzure, how you can do a disaster recovery drill, and how you can failover hello application tooAzure.</span></span>

<span data-ttu-id="b1e74-117">Puede ver hello debajo de vídeo acerca de cómo recuperar un tooAzure de aplicación de varios niveles.</span><span class="sxs-lookup"><span data-stu-id="b1e74-117">You can watch hello below video about recovering a multi tier application tooAzure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="b1e74-118">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="b1e74-118">Prerequisites</span></span>

<span data-ttu-id="b1e74-119">Antes de empezar, asegúrese de que comprende siguiente hello:</span><span class="sxs-lookup"><span data-stu-id="b1e74-119">Before you start, make sure you understand hello following:</span></span>

1. [<span data-ttu-id="b1e74-120">Replicar una máquina virtual tooAzure</span><span class="sxs-lookup"><span data-stu-id="b1e74-120">Replicating a virtual machine tooAzure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="b1e74-121">Cómo demasiado[el diseño de una red de recuperación](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="b1e74-121">How too[design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="b1e74-122">Realizar una tooAzure de conmutación por error de prueba</span><span class="sxs-lookup"><span data-stu-id="b1e74-122">Doing a test failover tooAzure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="b1e74-123">Realizar una conmutación por error tooAzure</span><span class="sxs-lookup"><span data-stu-id="b1e74-123">Doing a failover tooAzure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="b1e74-124">Cómo demasiado[replicar un controlador de dominio](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="b1e74-124">How too[replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="b1e74-125">Cómo demasiado[replicar SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="b1e74-125">How too[replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="b1e74-126">Arquitectura de SharePoint</span><span class="sxs-lookup"><span data-stu-id="b1e74-126">SharePoint architecture</span></span>

<span data-ttu-id="b1e74-127">SharePoint se puede implementar en uno o más servidores usando topologías por niveles y roles de servidor tooimplement un diseño de granja de servidores que satisfaga determinados objetivos.</span><span class="sxs-lookup"><span data-stu-id="b1e74-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles tooimplement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="b1e74-128">Una granja de servidores de SharePoint típica de gran tamaño y alta demanda que admita un número elevado de usuarios simultáneos y elementos de contenido utiliza la agrupación de servicios como parte de su estrategia de escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="b1e74-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="b1e74-129">Este enfoque implica ejecutar servicios en servidores dedicados, agrupando estos servicios y, a continuación, escalar horizontalmente los servidores de Hola como un grupo.</span><span class="sxs-lookup"><span data-stu-id="b1e74-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out hello servers as a group.</span></span> <span data-ttu-id="b1e74-130">Hello topología siguiente ilustra el servicio de Hola y agrupaciones de servidores para una granja de servidores de SharePoint de tres niveles.</span><span class="sxs-lookup"><span data-stu-id="b1e74-130">hello following topology illustrates hello service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="b1e74-131">Consulte tooSharePoint documentación y las arquitecturas de línea de producto para obtener instrucciones detalladas sobre diferentes topologías de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-131">Please refer tooSharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="b1e74-132">Encontrará más detalles sobre la implementación de SharePoint 2013 en [este documento](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="b1e74-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Modelo de implementación 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="b1e74-134">Compatibilidad de Site Recovery</span><span class="sxs-lookup"><span data-stu-id="b1e74-134">Site Recovery support</span></span>

<span data-ttu-id="b1e74-135">Para elaborar este artículo, se utilizaron máquinas virtuales de VMware con Windows Server 2012 R2 Enterprise.</span><span class="sxs-lookup"><span data-stu-id="b1e74-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="b1e74-136">Se utilizaron SharePoint 2013 Enterprise y SQL server 2014 Enterprise.</span><span class="sxs-lookup"><span data-stu-id="b1e74-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="b1e74-137">Replicación de Site Recovery sea independiente de la aplicación, proporcionan recomendaciones de hello aquí son toohold esperado en para así los escenarios siguientes.</span><span class="sxs-lookup"><span data-stu-id="b1e74-137">As Site Recovery replication is application agnostic, hello recommendations provided here are expected toohold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="b1e74-138">Origen y destino</span><span class="sxs-lookup"><span data-stu-id="b1e74-138">Source and target</span></span>

<span data-ttu-id="b1e74-139">**Escenario**</span><span class="sxs-lookup"><span data-stu-id="b1e74-139">**Scenario**</span></span> | <span data-ttu-id="b1e74-140">**sitio secundario tooa**</span><span class="sxs-lookup"><span data-stu-id="b1e74-140">**tooa secondary site**</span></span> | <span data-ttu-id="b1e74-141">**tooAzure**</span><span class="sxs-lookup"><span data-stu-id="b1e74-141">**tooAzure**</span></span>
--- | --- | ---
<span data-ttu-id="b1e74-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="b1e74-142">**Hyper-V**</span></span> | <span data-ttu-id="b1e74-143">Sí</span><span class="sxs-lookup"><span data-stu-id="b1e74-143">Yes</span></span> | <span data-ttu-id="b1e74-144">Sí</span><span class="sxs-lookup"><span data-stu-id="b1e74-144">Yes</span></span>
<span data-ttu-id="b1e74-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="b1e74-145">**VMware**</span></span> | <span data-ttu-id="b1e74-146">Sí</span><span class="sxs-lookup"><span data-stu-id="b1e74-146">Yes</span></span> | <span data-ttu-id="b1e74-147">Sí</span><span class="sxs-lookup"><span data-stu-id="b1e74-147">Yes</span></span>
<span data-ttu-id="b1e74-148">**Servidor físico**</span><span class="sxs-lookup"><span data-stu-id="b1e74-148">**Physical server**</span></span> | <span data-ttu-id="b1e74-149">Sí</span><span class="sxs-lookup"><span data-stu-id="b1e74-149">Yes</span></span> | <span data-ttu-id="b1e74-150">Sí</span><span class="sxs-lookup"><span data-stu-id="b1e74-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="b1e74-151">Versiones de SharePoint</span><span class="sxs-lookup"><span data-stu-id="b1e74-151">SharePoint Versions</span></span>
<span data-ttu-id="b1e74-152">se admite Hola después de las versiones de servidor de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-152">hello following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="b1e74-153">SharePoint Server 2013 Standard</span><span class="sxs-lookup"><span data-stu-id="b1e74-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="b1e74-154">SharePoint Server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="b1e74-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="b1e74-155">SharePoint Server 2016 Standard</span><span class="sxs-lookup"><span data-stu-id="b1e74-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="b1e74-156">SharePoint Server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="b1e74-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-tookeep-in-mind"></a><span data-ttu-id="b1e74-157">Tookeep de cosas en cuenta</span><span class="sxs-lookup"><span data-stu-id="b1e74-157">Things tookeep in mind</span></span>

<span data-ttu-id="b1e74-158">Si está utilizando un clúster basado en el disco compartido como cualquier nivel de la aplicación y no podrá ser tooreplicate de replicación de Site Recovery toouse capaz de esas máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="b1e74-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able toouse Site Recovery replication tooreplicate those virtual machines.</span></span> <span data-ttu-id="b1e74-159">Puede usar replicación nativa proporcionada por la aplicación hello y, a continuación, usar un [plan de recuperación](site-recovery-create-recovery-plans.md) toofailover todas las capas.</span><span class="sxs-lookup"><span data-stu-id="b1e74-159">You can use native replication provided by hello application and then use a [recovery plan](site-recovery-create-recovery-plans.md) toofailover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="b1e74-160">Replicación de máquinas virtuales</span><span class="sxs-lookup"><span data-stu-id="b1e74-160">Replicating virtual machines</span></span>

<span data-ttu-id="b1e74-161">Siga [esta guía](site-recovery-vmware-to-azure.md) toostart replicar hello tooAzure de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="b1e74-161">Follow [this guidance](site-recovery-vmware-to-azure.md) toostart replicating hello virtual machine tooAzure.</span></span>

* <span data-ttu-id="b1e74-162">Una vez completada la replicación de hello, asegúrese de que vaya tooeach virtual machine de cada capa y seleccione el mismo conjunto de disponibilidad en ' replicadas elemento > Configuración > Propiedades > de proceso y de red '.</span><span class="sxs-lookup"><span data-stu-id="b1e74-162">Once hello replication is complete, make sure you go tooeach virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="b1e74-163">Por ejemplo, si el nivel web tiene 3 máquinas virtuales, asegúrese de hello todos los 3 máquinas virtuales están configurados toobe parte del mismo conjunto de disponibilidad en Azure.</span><span class="sxs-lookup"><span data-stu-id="b1e74-163">For example, if your web tier has 3 VMs, ensure all hello 3 VMs are configured toobe part of same availability set in Azure.</span></span>

    ![Configuración de conjuntos de disponibilidad](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="b1e74-165">Para obtener instrucciones sobre la protección de Active Directory y DNS, consulte demasiado[proteger Active Directory y DNS](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="b1e74-165">For guidance on protecting Active Directory and DNS, refer too[Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="b1e74-166">Para obtener instrucciones sobre la protección de nivel de base de datos que se ejecuta en SQL server, consulte demasiado[proteger SQL Server](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="b1e74-166">For guidance on protecting database tier running on SQL server, refer too[Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="b1e74-167">Configuración de red</span><span class="sxs-lookup"><span data-stu-id="b1e74-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="b1e74-168">Propiedades de red</span><span class="sxs-lookup"><span data-stu-id="b1e74-168">Network properties</span></span>

* <span data-ttu-id="b1e74-169">Hello aplicación y las máquinas virtuales de nivel de Web, configurar configuración de red en el portal de Azure para que las máquinas virtuales de Hola obtener toohello adjunto red de recuperación ante desastres apropiado después de la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b1e74-169">For hello App and Web tier VMs, configure network settings in Azure portal so that hello VMs get attached toohello right DR network after failover.</span></span>

    ![Selección de la red](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="b1e74-171">Si usa una dirección IP estática, a continuación, especifique la IP de Hola que desee Hola tootake de máquina virtual en hello **IP de destino** campo</span><span class="sxs-lookup"><span data-stu-id="b1e74-171">If you are using a static IP, then specify hello IP that you want hello virtual machine tootake in hello **Target IP** field</span></span>

    ![Configuración de direcciones IP estáticas](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="b1e74-173">Enrutamiento de tráfico y DNS</span><span class="sxs-lookup"><span data-stu-id="b1e74-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="b1e74-174">Para orientado a sitios, internet [crear un perfil de Traffic Manager del tipo 'Priority'](../traffic-manager/traffic-manager-create-profile.md) Hola suscripción de Azure.</span><span class="sxs-lookup"><span data-stu-id="b1e74-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in hello Azure subscription.</span></span> <span data-ttu-id="b1e74-175">Y, a continuación, configurar el perfil de DNS y el Administrador de tráfico en hello siguiente manera.</span><span class="sxs-lookup"><span data-stu-id="b1e74-175">And then configure your DNS and Traffic Manager profile in hello following manner.</span></span>


| <span data-ttu-id="b1e74-176">**Where**</span><span class="sxs-lookup"><span data-stu-id="b1e74-176">**Where**</span></span> | <span data-ttu-id="b1e74-177">**Origen**</span><span class="sxs-lookup"><span data-stu-id="b1e74-177">**Source**</span></span> | <span data-ttu-id="b1e74-178">**Destino**</span><span class="sxs-lookup"><span data-stu-id="b1e74-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="b1e74-179">DNS público</span><span class="sxs-lookup"><span data-stu-id="b1e74-179">Public DNS</span></span> | <span data-ttu-id="b1e74-180">DNS público para sitios de SharePoint</span><span class="sxs-lookup"><span data-stu-id="b1e74-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="b1e74-181">Por ejemplo: sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="b1e74-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="b1e74-182">Administrador de tráfico</span><span class="sxs-lookup"><span data-stu-id="b1e74-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="b1e74-183">contososharepoint.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="b1e74-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="b1e74-184">DNS local</span><span class="sxs-lookup"><span data-stu-id="b1e74-184">On-premises DNS</span></span> | <span data-ttu-id="b1e74-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="b1e74-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="b1e74-186">Dirección IP pública en hello granja local</span><span class="sxs-lookup"><span data-stu-id="b1e74-186">Public IP on hello on-premises farm</span></span> |


<span data-ttu-id="b1e74-187">Hola perfil de Traffic Manager, [crear puntos de conexión principal y de recuperación de hello](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="b1e74-187">In hello Traffic Manager profile, [create hello primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="b1e74-188">Usar extremo externo hello para el extremo local y la dirección IP pública para el extremo de Azure.</span><span class="sxs-lookup"><span data-stu-id="b1e74-188">Use hello external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="b1e74-189">Comprobar si prioridad Hola está establecido el punto de conexión mayor tooon local.</span><span class="sxs-lookup"><span data-stu-id="b1e74-189">Ensure that hello priority is set higher tooon-premises endpoint.</span></span>

<span data-ttu-id="b1e74-190">Host de una página de prueba en un puerto específico (por ejemplo, 800) en el nivel de web de SharePoint de hello en orden para Traffic Manager tooautomatically detectar conmutación por error de publicación de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b1e74-190">Host a test page on a specific port (for example, 800) in hello SharePoint web tier in order for Traffic Manager tooautomatically detect availability post failover.</span></span> <span data-ttu-id="b1e74-191">Se trata de una solución alternativa en caso de que no se puede habilitar la autenticación anónima en alguno de los sitios de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="b1e74-192">[Configurar perfil de Traffic Manager de hello](../traffic-manager/traffic-manager-configure-priority-routing-method.md) con hello por debajo de la configuración.</span><span class="sxs-lookup"><span data-stu-id="b1e74-192">[Configure hello Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with hello below settings.</span></span>

* <span data-ttu-id="b1e74-193">Método de enrutamiento: Prioridad</span><span class="sxs-lookup"><span data-stu-id="b1e74-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="b1e74-194">DNS tiempo toolive (TTL) - 30 ' segundos'</span><span class="sxs-lookup"><span data-stu-id="b1e74-194">DNS time toolive (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="b1e74-195">Configuración del monitor del punto de conexión: Si se puede habilitar la autenticación anónima, puede proporcionar un punto de conexión de sitio web específico.</span><span class="sxs-lookup"><span data-stu-id="b1e74-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="b1e74-196">También puede usar una página de prueba en un puerto específico (por ejemplo, 800).</span><span class="sxs-lookup"><span data-stu-id="b1e74-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="b1e74-197">Creación de un plan de recuperación</span><span class="sxs-lookup"><span data-stu-id="b1e74-197">Creating a recovery plan</span></span>

<span data-ttu-id="b1e74-198">Un plan de recuperación permite secuenciación Hola conmutación por error de distintos niveles de una aplicación de varios niveles, por lo tanto, mantener la coherencia de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-198">A recovery plan allows sequencing hello failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="b1e74-199">Siga Hola pasos siguientes al crear un plan de recuperación para una aplicación web de varios niveles.</span><span class="sxs-lookup"><span data-stu-id="b1e74-199">Follow hello below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="b1e74-200">[Aprenda más sobre la creación de un plan de recuperación](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="b1e74-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-toofailover-groups"></a><span data-ttu-id="b1e74-201">Agregar grupos de toofailover de máquinas virtuales</span><span class="sxs-lookup"><span data-stu-id="b1e74-201">Adding virtual machines toofailover groups</span></span>

1. <span data-ttu-id="b1e74-202">Crear un plan de recuperación Hola agregar aplicaciones y las máquinas virtuales de nivel de Web.</span><span class="sxs-lookup"><span data-stu-id="b1e74-202">Create a recovery plan by adding hello App and Web tier VMs.</span></span>
2. <span data-ttu-id="b1e74-203">Haga clic en 'Personalizar' toogroup hello las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="b1e74-203">Click on 'Customize' toogroup hello VMs.</span></span> <span data-ttu-id="b1e74-204">De forma predeterminada, todas las máquinas virtuales forman parte del grupo 1.</span><span class="sxs-lookup"><span data-stu-id="b1e74-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Personalizar RP](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="b1e74-206">Cree otro grupo (grupo 2) y mover el nivel de Web de hello las máquinas virtuales en el nuevo grupo de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-206">Create another Group (Group 2) and move hello Web tier VMs into hello new group.</span></span> <span data-ttu-id="b1e74-207">Las máquinas virtuales de nivel de aplicación deben formar parte del grupo 1, mientras que las máquinas virtuales de nivel web deben formar parte del grupo 2.</span><span class="sxs-lookup"><span data-stu-id="b1e74-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="b1e74-208">Se trata de tooensure que Hola aplicación arrancan las máquinas virtuales del nivel primero, seguido por máquinas virtuales del nivel de Web.</span><span class="sxs-lookup"><span data-stu-id="b1e74-208">This is tooensure that hello App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-toohello-recovery-plan"></a><span data-ttu-id="b1e74-209">Agregar plan de recuperación de toohello de secuencias de comandos</span><span class="sxs-lookup"><span data-stu-id="b1e74-209">Adding scripts toohello recovery plan</span></span>

<span data-ttu-id="b1e74-210">Puede implementar secuencias de comandos de Azure Site Recovery Hola suelen usada en su cuenta de automatización botón hello 'Implementar tooAzure' a continuación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-210">You can deploy hello most commonly used Azure Site Recovery scripts into your Automation account clicking hello 'Deploy tooAzure' button below.</span></span> <span data-ttu-id="b1e74-211">Cuando se utiliza cualquier secuencia de comandos publicado, asegúrese de que seguir instrucciones hello en el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-211">When you are using any published script, ensure you follow hello guidance in hello script.</span></span>

<span data-ttu-id="b1e74-212">[![Implementar tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="b1e74-212">[![Deploy tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="b1e74-213">Agregar un script de acción previa too'Group 1' toofailover SQL grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b1e74-213">Add a pre-action script too'Group 1' toofailover SQL Availability group.</span></span> <span data-ttu-id="b1e74-214">Usar script de 'ASR-SQL-FailoverAG' hello publicado en los scripts de ejemplo de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-214">Use hello 'ASR-SQL-FailoverAG' script published in hello sample scripts.</span></span> <span data-ttu-id="b1e74-215">Asegúrese de seguir las instrucciones de hello en el script de Hola y realizar cambios de hello necesario en el script de Hola adecuadamente.</span><span class="sxs-lookup"><span data-stu-id="b1e74-215">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Paso 1 para agregar el script AG](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Paso 2 para agregar el script AG](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="b1e74-218">Agregue un tooattach de script de acción de entrada de un equilibrador de carga en hello conmutado por error máquinas virtuales del nivel de Web (grupo 2).</span><span class="sxs-lookup"><span data-stu-id="b1e74-218">Add a post action script tooattach a load balancer on hello failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="b1e74-219">Usar script de 'ASR AddSingleLoadBalancer' hello publicado en los scripts de ejemplo de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-219">Use hello 'ASR-AddSingleLoadBalancer' script published in hello sample scripts.</span></span> <span data-ttu-id="b1e74-220">Asegúrese de seguir las instrucciones de hello en el script de Hola y realizar cambios de hello necesario en el script de Hola adecuadamente.</span><span class="sxs-lookup"><span data-stu-id="b1e74-220">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Paso 1 para agregar el script LB](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Paso 2 para agregar el script LB](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="b1e74-223">Agregar un paso manual tooupdate Hola DNS registros toopoint toohello nueva granja de servidores en Azure.</span><span class="sxs-lookup"><span data-stu-id="b1e74-223">Add a manual step tooupdate hello DNS records toopoint toohello new farm in Azure.</span></span>

    * <span data-ttu-id="b1e74-224">En sitios orientados a Internet no se requieren las actualizaciones DNS son posteriores a la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b1e74-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="b1e74-225">Siga los pasos de hello descritos en hello 'Guía de red' sección tooconfigure Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="b1e74-225">Follow hello steps described in hello 'Networking guidance' section tooconfigure Traffic Manager.</span></span> <span data-ttu-id="b1e74-226">Si Hola perfil de Traffic Manager se ha configurado como se describe en la sección anterior de hello, agregar un puerto ficticio (800 en el ejemplo de Hola) tooopen de secuencia de comandos en Hola VM de Azure.</span><span class="sxs-lookup"><span data-stu-id="b1e74-226">If hello Traffic Manager profile has been set up as described in hello previous section, add a script tooopen dummy port (800 in hello example) on hello Azure VM.</span></span>

    * <span data-ttu-id="b1e74-227">Para los sitios internos orientados al público, agregar IP de equilibrador de carga de paso manual tooupdate Hola DNS toopoint registros toohello nueva Web capa la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="b1e74-227">For internal facing sites, add a manual step tooupdate hello DNS record toopoint toohello new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="b1e74-228">Agregar una aplicación de búsqueda de toorestore paso manual desde una copia de seguridad o iniciar un nuevo servicio de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b1e74-228">Add a manual step toorestore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="b1e74-229">Para restaurar la aplicación de servicio de búsqueda desde una copia de seguridad, siga los pasos indicados a continuación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="b1e74-230">Este método supone que se realizó una copia de seguridad de la aplicación de servicio de búsqueda de hello antes del evento grave hello y esa copia de seguridad de hello está disponible en el sitio de recuperación ante desastres de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-230">This method assumes that a backup of hello Search Service Application was performed before hello catastrophic event and that hello backup is available at hello DR site.</span></span>
    * <span data-ttu-id="b1e74-231">Esto puede lograrse fácilmente programar copia de seguridad de hello (por ejemplo, una vez al día) y usando una copia de seguridad de hello tooplace de procedimiento en el sitio de recuperación ante desastres de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-231">This can easily be achieved by scheduling hello backup (for example, once daily) and using a copy procedure tooplace hello backup at hello DR site.</span></span> <span data-ttu-id="b1e74-232">Los procedimientos de copia pueden incluir programas con scripts, como AzCopy (Azure Copy), o la configuración de DFSR (replicación de servicios de archivos distribuida).</span><span class="sxs-lookup"><span data-stu-id="b1e74-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="b1e74-233">Ahora que Hola SharePoint granja está ejecutando, vaya Hola Administración Central, 'Copia de seguridad y restauración' y seleccione restauración.</span><span class="sxs-lookup"><span data-stu-id="b1e74-233">Now that hello SharePoint farm is running, navigate hello Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="b1e74-234">restauración Hello interroga ubicación de copia de seguridad de hello especificada (puede que tenga valor de hello tooupdate).</span><span class="sxs-lookup"><span data-stu-id="b1e74-234">hello restore interrogates hello backup location specified (you may need tooupdate hello value).</span></span> <span data-ttu-id="b1e74-235">Seleccione la copia de seguridad de aplicación de servicio de búsqueda de hello le gustaría toorestore.</span><span class="sxs-lookup"><span data-stu-id="b1e74-235">Select hello Search Service Application backup you would like toorestore.</span></span>
    * <span data-ttu-id="b1e74-236">Se restaura la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b1e74-236">Search is restored.</span></span> <span data-ttu-id="b1e74-237">Tenga en cuenta que Hola restauración espera toofind Hola misma topología (el mismo número de servidores) y las mismas unidad de disco duro letras toothose servidores asignados.</span><span class="sxs-lookup"><span data-stu-id="b1e74-237">Keep in mind that hello restore expects toofind hello same topology (same number of servers) and same hard drive letters assigned toothose servers.</span></span> <span data-ttu-id="b1e74-238">Para obtener más información, consulte el documento [Restaurar las aplicaciones de servicio de búsqueda en SharePoint 2013](https://technet.microsoft.com/library/ee748654.aspx).</span><span class="sxs-lookup"><span data-stu-id="b1e74-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="b1e74-239">Para iniciar con una nueva aplicación de servicio de búsqueda, siga los pasos indicados a continuación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="b1e74-240">Este método supone que una copia de seguridad de base de datos de "Administración de búsqueda" hello está disponible en el sitio de recuperación ante desastres de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-240">This method assumes that a backup of hello “Search Administration” database is available at hello DR site.</span></span>
    * <span data-ttu-id="b1e74-241">Puesto que hello otras bases de datos de aplicación de servicio de búsqueda no se replican, deben toobe vuelve a crear.</span><span class="sxs-lookup"><span data-stu-id="b1e74-241">Since hello other Search Service Application databases are not replicated, they need toobe re-created.</span></span> <span data-ttu-id="b1e74-242">por lo tanto, toodo navegue tooCentral administración y eliminar Hola aplicación de servicio de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b1e74-242">toodo so, navigate tooCentral Administration and delete hello Search Service Application.</span></span> <span data-ttu-id="b1e74-243">En todos los servidores que Hola host índice de búsqueda, elimine los archivos de índice de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-243">On any servers which host hello Search Index, delete hello index files.</span></span>
    * <span data-ttu-id="b1e74-244">Hola volver a crear la aplicación de servicio de búsqueda y, por lo vuelve a crear las bases de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-244">Re-create hello Search Service Application and this re-creates hello databases.</span></span> <span data-ttu-id="b1e74-245">Se recomienda toohave una secuencia de comandos preparada que vuelve a crea esta aplicación de servicio ya que no es posible tooperform todas las acciones a través de hello GUI.</span><span class="sxs-lookup"><span data-stu-id="b1e74-245">It is recommended toohave a prepared script that re-creates this service application since it is not possible tooperform all actions via hello GUI.</span></span> <span data-ttu-id="b1e74-246">Por ejemplo, ubicación de unidad de índice de Hola y configuración de la topología de búsqueda de hello son sólo es posible mediante el uso de cmdlets de PowerShell de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-246">For example, setting hello index drive location and configuring hello search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="b1e74-247">Use el cmdlet de Windows PowerShell de hello SPEnterpriseSearchServiceApplication de restauración y especifique Hola trasvase de registros y de base de datos de administración de búsqueda, Search_Service__DB replicada.</span><span class="sxs-lookup"><span data-stu-id="b1e74-247">Use hello Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify hello log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="b1e74-248">Este cmdlet ofrece configuración de búsqueda de hello, esquema, propiedades administradas, reglas y orígenes y crea un conjunto predeterminado de hello otros componentes.</span><span class="sxs-lookup"><span data-stu-id="b1e74-248">This cmdlet gives hello search configuration, schema, managed properties, rules, and sources and creates a default set of hello other components.</span></span>
    * <span data-ttu-id="b1e74-249">Una vez hello que tiene la aplicación de servicio de búsqueda se volverá a crear, debe iniciar un rastreo completo para cada Hola de toorestore servicio de búsqueda de origen de contenido.</span><span class="sxs-lookup"><span data-stu-id="b1e74-249">Once hello Search Service Application has be re-created, you must start a full crawl for each content source toorestore hello Search Service.</span></span> <span data-ttu-id="b1e74-250">Perder cierta información de análisis de hello local granja de servidores, como recomendaciones para la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b1e74-250">You lose some analytics information from hello on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="b1e74-251">Una vez completados todos los pasos de hello, Guardar plan de recuperación de Hola y plan de recuperación final Hola tendrá un aspecto similar a siguiente.</span><span class="sxs-lookup"><span data-stu-id="b1e74-251">Once all hello steps are completed, save hello recovery plan and hello final recovery plan will look like following.</span></span>

    ![RP guardado](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="b1e74-253">Realización de una conmutación por error de prueba</span><span class="sxs-lookup"><span data-stu-id="b1e74-253">Doing a test failover</span></span>
<span data-ttu-id="b1e74-254">Siga [esta guía](site-recovery-test-failover-to-azure.md) toodo una conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="b1e74-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) toodo a test failover.</span></span>

1.  <span data-ttu-id="b1e74-255">Vaya tooAzure portal y seleccione el almacén del servicio de recuperación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-255">Go tooAzure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="b1e74-256">Haga clic en el plan de recuperación de hello creado para la aplicación de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-256">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="b1e74-257">Haga clic en 'Probar conmutación por error'.</span><span class="sxs-lookup"><span data-stu-id="b1e74-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="b1e74-258">Seleccione el punto de recuperación y el proceso de conmutación por error de prueba de red virtual de Azure toostart Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-258">Select recovery point and Azure virtual network toostart hello test failover process.</span></span>
5.  <span data-ttu-id="b1e74-259">Una vez que el entorno secundario hello es hacia arriba, puede realizar sus validaciones.</span><span class="sxs-lookup"><span data-stu-id="b1e74-259">Once hello secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="b1e74-260">Una vez validaciones de hello están completadas, puede hacer clic en 'Limpieza de conmutación por error de prueba' en el plan de recuperación de Hola y se limpia el entorno de conmutación por error de prueba de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1e74-260">Once hello validations are complete, you can click 'Cleanup test failover' on hello recovery plan and hello test failover environment is cleaned.</span></span>

<span data-ttu-id="b1e74-261">Para obtener instrucciones sobre cómo realizar la conmutación por error para AD y DNS, consulte demasiado[probar consideraciones de conmutación por error para AD y DNS](site-recovery-active-directory.md#test-failover-considerations) documento.</span><span class="sxs-lookup"><span data-stu-id="b1e74-261">For guidance on doing test failover for AD and DNS, refer too[Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="b1e74-262">Para obtener instrucciones sobre cómo realizar la conmutación por error de SQL siempre en grupos de disponibilidad, consulte demasiado[realizando probar conmutación por error de SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) documento.</span><span class="sxs-lookup"><span data-stu-id="b1e74-262">For guidance on doing test failover for SQL Always ON availability groups, refer too[Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="b1e74-263">Realización de una conmutación por error</span><span class="sxs-lookup"><span data-stu-id="b1e74-263">Doing a failover</span></span>
<span data-ttu-id="b1e74-264">Siga [estas directrices](site-recovery-failover.md) cuando realice una conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b1e74-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="b1e74-265">Vaya tooAzure portal y seleccione el almacén de servicios de recuperación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-265">Go tooAzure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="b1e74-266">Haga clic en el plan de recuperación de hello creado para la aplicación de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b1e74-266">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="b1e74-267">Haga clic en 'Conmutación por error'.</span><span class="sxs-lookup"><span data-stu-id="b1e74-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="b1e74-268">Seleccione el proceso de conmutación por error de Hola de toostart de punto de recuperación.</span><span class="sxs-lookup"><span data-stu-id="b1e74-268">Select recovery point toostart hello failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b1e74-269">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="b1e74-269">Next steps</span></span>
<span data-ttu-id="b1e74-270">Puede obtener más información sobre la [replicación de otras aplicaciones](site-recovery-workload.md) a través de Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="b1e74-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
