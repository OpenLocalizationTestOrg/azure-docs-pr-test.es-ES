---
title: "arquitectura de hello aaaReview para tooAzure de replicación de servidor físico con Azure Site Recovery | Documentos de Microsoft"
description: "Este artículo proporciona información general de componentes y arquitectura que se usa cuando se replican local tooAzure de servidores físicos con hello servicio Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: 09c9b136-35f5-465e-8d0f-f4c5d5d9f880
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: raynew
ms.openlocfilehash: 4f334c181fa6f0821adf978ebe9dbd7d36a3c753
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-physical-server-replication-tooazure"></a><span data-ttu-id="d33ac-103">Paso 1: Revisar la arquitectura de Hola para tooAzure de replicación del servidor físico</span><span class="sxs-lookup"><span data-stu-id="d33ac-103">Step 1: Review hello architecture for physical server replication tooAzure</span></span>

<span data-ttu-id="d33ac-104">Este artículo describe los componentes de Hola y procesos que se utilizan cuando se replica en local tooAzure de servidores físicos de Windows o Linux, mediante hello [Azure Site Recovery](site-recovery-overview.md) servicio.</span><span class="sxs-lookup"><span data-stu-id="d33ac-104">This article describes hello components and processes used when you replicate on-premises Windows/Linux physical servers tooAzure, using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="d33ac-105">Registrar los comentarios de la parte inferior de Hola de este artículo, o formular alguna pregunta en hello [foro de servicios de recuperación de Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="d33ac-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="d33ac-106">Componentes de la arquitectura</span><span class="sxs-lookup"><span data-stu-id="d33ac-106">Architectural components</span></span>

<span data-ttu-id="d33ac-107">tabla de Hello resume componentes Hola que necesita.</span><span class="sxs-lookup"><span data-stu-id="d33ac-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="d33ac-108">**Componente**</span><span class="sxs-lookup"><span data-stu-id="d33ac-108">**Component**</span></span> | <span data-ttu-id="d33ac-109">**Requisito**</span><span class="sxs-lookup"><span data-stu-id="d33ac-109">**Requirement**</span></span> | <span data-ttu-id="d33ac-110">**Detalles**</span><span class="sxs-lookup"><span data-stu-id="d33ac-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="d33ac-111">**Las tablas de Azure**</span><span class="sxs-lookup"><span data-stu-id="d33ac-111">**Azure**</span></span> | <span data-ttu-id="d33ac-112">Se necesita una cuenta de Azure, una cuenta de Azure Storage y una red de Azure.</span><span class="sxs-lookup"><span data-stu-id="d33ac-112">You need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="d33ac-113">Los datos replicados se almacenan en la cuenta de almacenamiento de Hola y máquinas virtuales de Azure se crean con datos saludo replican Cuando se produce la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="d33ac-113">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover occurs.</span></span> <span data-ttu-id="d33ac-114">Máquinas virtuales de Azure conectan toohello red virtual de Azure cuando se crean.</span><span class="sxs-lookup"><span data-stu-id="d33ac-114">Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="d33ac-115">**Servidor de configuración**</span><span class="sxs-lookup"><span data-stu-id="d33ac-115">**Configuration server**</span></span> | <span data-ttu-id="d33ac-116">Un único servidor de administración (servidor físico o VM de VMware) que se ejecuta todos los Hola local componentes de Site Recovery en local.</span><span class="sxs-lookup"><span data-stu-id="d33ac-116">A single on-premises management server (physical server or VMware VM) that runs all hello on-premises Site Recovery components.</span></span> <span data-ttu-id="d33ac-117">Estos incluyen un servidor de configuración, un servidor de procesos y un servidor de destino maestro.</span><span class="sxs-lookup"><span data-stu-id="d33ac-117">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="d33ac-118">componente de servidor de configuración de Hello coordina las comunicaciones entre local y Azure y administra la replicación de datos.</span><span class="sxs-lookup"><span data-stu-id="d33ac-118">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="d33ac-119">**Servidor de proceso**</span><span class="sxs-lookup"><span data-stu-id="d33ac-119">**Process server**</span></span>  | <span data-ttu-id="d33ac-120">Se instala de forma predeterminada en el servidor de configuración de Hola.</span><span class="sxs-lookup"><span data-stu-id="d33ac-120">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="d33ac-121">Actúa como puerta de enlace de replicación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-121">Acts as a replication gateway.</span></span> <span data-ttu-id="d33ac-122">Recibe datos de replicación, optimiza con almacenamiento en caché, la compresión y cifrado y lo envía tooAzure almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d33ac-122">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="d33ac-123">servidor de procesos de Hello también controla la instalación de inserción de las máquinas de tooprotected de servicio de movilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="d33ac-123">hello process server also handles push installation of hello Mobility service tooprotected machines.</span></span><br/><br/> <span data-ttu-id="d33ac-124">Puede agregar servidores de proceso dedicado independiente adicionales, toohandle aumentar volúmenes de tráfico de replicación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-124">You can add additional separate dedicated process servers, toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="d33ac-125">**Servidor de destino principal**</span><span class="sxs-lookup"><span data-stu-id="d33ac-125">**Master target server**</span></span> | <span data-ttu-id="d33ac-126">Se instala de forma predeterminada en el servidor de configuración local de Hola.</span><span class="sxs-lookup"><span data-stu-id="d33ac-126">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="d33ac-127">Controla los datos de replicación durante la conmutación por recuperación desde Azure.</span><span class="sxs-lookup"><span data-stu-id="d33ac-127">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="d33ac-128">Si los volúmenes de tráfico de la conmutación por recuperación son altos, puede implementar un servidor de destino maestro independiente para la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-128">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="d33ac-129">**Servidores replicados**</span><span class="sxs-lookup"><span data-stu-id="d33ac-129">**Replicated servers**</span></span> | <span data-ttu-id="d33ac-130">Hello componente del servicio de movilidad está instalado en cada servidor de Windows/Linux desea tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="d33ac-130">hello Mobility service component is installed on each Windows/Linux server you want tooreplicate.</span></span> <span data-ttu-id="d33ac-131">Se puede instalar manualmente en cada equipo o con una instalación de inserción Hola del servidor de procesos.</span><span class="sxs-lookup"><span data-stu-id="d33ac-131">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>
<span data-ttu-id="d33ac-132">**Conmutación por recuperación**</span><span class="sxs-lookup"><span data-stu-id="d33ac-132">**Failback**</span></span> | <span data-ttu-id="d33ac-133">Para la conmutación por recuperación se requiere una infraestructura de VMware.</span><span class="sxs-lookup"><span data-stu-id="d33ac-133">For failback a VMware infrastructure is required.</span></span> <span data-ttu-id="d33ac-134">No se producirá un error de servidor físico de back-tooa.</span><span class="sxs-lookup"><span data-stu-id="d33ac-134">You can't fail back tooa physical server.</span></span>


<span data-ttu-id="d33ac-135">**Figura 1: TooAzure físico componentes**</span><span class="sxs-lookup"><span data-stu-id="d33ac-135">**Figure 1: Physical tooAzure components**</span></span>

![Componentes](./media/physical-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="d33ac-137">Proceso de replicación</span><span class="sxs-lookup"><span data-stu-id="d33ac-137">Replication process</span></span>

1. <span data-ttu-id="d33ac-138">Configurar la implementación de hello, incluidos los componentes de Azure y local.</span><span class="sxs-lookup"><span data-stu-id="d33ac-138">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="d33ac-139">En el almacén de servicios de recuperación de hello, especificar origen de replicación de Hola y de destino, configurar el servidor de configuración de hello, crear una directiva de replicación, implementación el servicio de movilidad de hello, habilitan la replicación y ejecutan una prueba de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="d33ac-139">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="d33ac-140">Replicar máquinas con arreglo a la directiva de replicación de hello y una copia inicial de datos de hello es almacenamiento tooAzure replicada.</span><span class="sxs-lookup"><span data-stu-id="d33ac-140">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
4. <span data-ttu-id="d33ac-141">Una vez finalizada la replicación inicial, comienza la replicación de diferencias cambios tooAzure.</span><span class="sxs-lookup"><span data-stu-id="d33ac-141">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="d33ac-142">Las marcas de revisión de una máquina se conservan en un archivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="d33ac-142">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="d33ac-143">Replicación de máquinas comunican con el servidor de configuración de hello en el puerto HTTPS 443 entrante para la administración de replicación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-143">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="d33ac-144">Replicación máquinas envían servidor de procesos de toohello de datos de replicación en el puerto HTTPS 9443 entrante (pueden modificarse).</span><span class="sxs-lookup"><span data-stu-id="d33ac-144">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="d33ac-145">servidor de configuración de Hello organiza la administración de la replicación con Azure en el puerto HTTPS 443 saliente.</span><span class="sxs-lookup"><span data-stu-id="d33ac-145">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="d33ac-146">servidor de procesos de Hello recibe datos de máquinas de origen, optimiza y cifra y lo envía tooAzure almacenamiento en el puerto 443 saliente.</span><span class="sxs-lookup"><span data-stu-id="d33ac-146">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="d33ac-147">Si habilita la coherencia entre varias VM, a continuación, equipos del grupo de replicación de hello comunican entre sí a través del puerto 20004.</span><span class="sxs-lookup"><span data-stu-id="d33ac-147">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="d33ac-148">La implementación de varias máquinas virtuales se usa si agrupa varias máquinas en grupos de replicación que tienen puntos de recuperación coherentes con los bloqueos y coherentes con la aplicación cuando conmutan por error.</span><span class="sxs-lookup"><span data-stu-id="d33ac-148">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="d33ac-149">Esto es útil si las máquinas ejecutan Hola la misma carga de trabajo y necesita toobe coherente.</span><span class="sxs-lookup"><span data-stu-id="d33ac-149">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
5. <span data-ttu-id="d33ac-150">Tráfico está replicada tooAzure extremos públicos de almacenamiento, en Hola internet.</span><span class="sxs-lookup"><span data-stu-id="d33ac-150">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="d33ac-151">Como alternativa, puede usar el [emparejamiento público](../expressroute/expressroute-circuit-peerings.md#public-peering) de Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="d33ac-151">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="d33ac-152">No se admite la replicación del tráfico a través de una VPN de sitio a sitio desde un tooAzure de sitio local.</span><span class="sxs-lookup"><span data-stu-id="d33ac-152">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>

<span data-ttu-id="d33ac-153">**Figura 2: TooAzure físico replicación**</span><span class="sxs-lookup"><span data-stu-id="d33ac-153">**Figure 2: Physical tooAzure replication**</span></span>

![Mejorada](./media/physical-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="d33ac-155">Proceso de conmutación por error y conmutación por recuperación</span><span class="sxs-lookup"><span data-stu-id="d33ac-155">Failover and failback process</span></span>

<span data-ttu-id="d33ac-156">Después de comprobar que la conmutación por error funciona según lo previsto, puede ejecutar las conmutaciones por error no planeada tooAzure según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="d33ac-156">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="d33ac-157">Cuando se ejecuta una conmutación por error, se crean máquinas virtuales de Azure a partir de los datos replicados.</span><span class="sxs-lookup"><span data-stu-id="d33ac-157">When you run a failover, Azure VMs are created from replicated data.</span></span> <span data-ttu-id="d33ac-158">Luego, cuando el sitio local principal esté disponible de nuevo, podrá realizar una conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-158">Then, when your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="d33ac-159">Observe lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="d33ac-159">Note that:</span></span>

- <span data-ttu-id="d33ac-160">No se admite la conmutación por error planeada.</span><span class="sxs-lookup"><span data-stu-id="d33ac-160">Planned failover isn't supported.</span></span>
- <span data-ttu-id="d33ac-161">Puede conmutar por error un único equipo, o crear [planes de recuperación](site-recovery-create-recovery-plans.md), toofail en varios equipos juntos.</span><span class="sxs-lookup"><span data-stu-id="d33ac-161">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple machines together.</span></span>
- <span data-ttu-id="d33ac-162">Confirmar toostart una conmutación por error al acceder a cargas de trabajo de Hola de réplica de hello VM de Azure.</span><span class="sxs-lookup"><span data-stu-id="d33ac-162">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
- <span data-ttu-id="d33ac-163">Al sitio primario de hello esté disponible de nuevo, replicar máquina Hola de sitio primario de hello toohello secundaria.</span><span class="sxs-lookup"><span data-stu-id="d33ac-163">When hello primary site is available again, you replicate hello machine from hello secondary toohello primary site.</span></span> <span data-ttu-id="d33ac-164">A continuación, ejecute una conmutación por error no planeada desde el sitio secundario de Hola.</span><span class="sxs-lookup"><span data-stu-id="d33ac-164">Then, run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="d33ac-165">Tras confirmar esta conmutación por error, datos será local atrás y necesitará tooenable replicación tooAzure de nuevo.</span><span class="sxs-lookup"><span data-stu-id="d33ac-165">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span>

<span data-ttu-id="d33ac-166">Entre los componentes de la conmutación por recuperación se incluyen:</span><span class="sxs-lookup"><span data-stu-id="d33ac-166">Failback components include:</span></span>

- <span data-ttu-id="d33ac-167">**Servidor de procesos temporales en Azure**: necesita tooset un tooact de máquina virtual de Azure como un servidor de procesos, la replicación de toohandle de Azure.</span><span class="sxs-lookup"><span data-stu-id="d33ac-167">**Temporary process server in Azure**: You need tooset up an Azure VM tooact as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="d33ac-168">Dicha máquina virtual se puede eliminar cuando finalice la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="d33ac-169">**Conexión VPN**: necesita una conexión VPN (o ExpressRoute de Azure) de sitio local de hello Azure red toohello.</span><span class="sxs-lookup"><span data-stu-id="d33ac-169">**VPN connection**: You need a VPN connection (or Azure ExpressRoute) from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="d33ac-170">**Servidor de destino maestro local independiente**: servidor de destino maestro local hello (que se instala de forma predeterminada en el servidor de configuración de hello) controla la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-170">**Separate on-premises master target server**: hello on-premises master target server (installed by default on hello configuration server) handles failback.</span></span> <span data-ttu-id="d33ac-171">Si se realiza la conmutación por recuperación en grandes volúmenes de tráfico, debe configurar un servidor de destino maestro local independiente para este propósito.</span><span class="sxs-lookup"><span data-stu-id="d33ac-171">If you fail back large volumes of traffic, you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="d33ac-172">**Directiva de conmutación por recuperación**: necesita una directiva de conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-172">**Failback policy**: You need a failback policy.</span></span> <span data-ttu-id="d33ac-173">Esta se crea automáticamente al crear la directiva de replicación.</span><span class="sxs-lookup"><span data-stu-id="d33ac-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="d33ac-174">**Infraestructura de VMware**: debe realizar conmutación por recuperación tooan VM de VMware locales.</span><span class="sxs-lookup"><span data-stu-id="d33ac-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="d33ac-175">Esto significa que necesita una infraestructura de VMware en local, incluso si replica tooAzure de servidores físicos locales.</span><span class="sxs-lookup"><span data-stu-id="d33ac-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="d33ac-176">**Ilustración 3: Conmutación por recuperación de servidor físico**</span><span class="sxs-lookup"><span data-stu-id="d33ac-176">**Figure 3: Physical server failback**</span></span>

![Conmutación por recuperación](./media/physical-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="d33ac-178">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="d33ac-178">Next steps</span></span>

<span data-ttu-id="d33ac-179">Vaya demasiado[paso 2: comprobar los requisitos previos y limitaciones](physical-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="d33ac-179">Go too[Step 2: Verify prerequisites and limitations](physical-walkthrough-prerequisites.md)</span></span>
