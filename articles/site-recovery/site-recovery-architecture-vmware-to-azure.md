---
title: "¿aaaHow funciona VMware replicación tooAzure en Azure Site Recovery? | Microsoft Docs"
description: "Este artículo proporciona información general de componentes y arquitectura que se usa al replicar locales máquinas virtuales de VMware y servidores físicos tooAzure con hello servicio Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/29/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: vmware-walkthrough-architecture
ms.openlocfilehash: f0fb834f8b251640f97e4d0163b2b9e54de691e1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-vmware-replication-tooazure-work-in-site-recovery"></a><span data-ttu-id="7e381-104">¿Cómo funciona VMware replicación tooAzure en Site Recovery?</span><span class="sxs-lookup"><span data-stu-id="7e381-104">How does VMware replication tooAzure work in Site Recovery?</span></span>

<span data-ttu-id="7e381-105">Este artículo describen los componentes de Hola y procesos que tienen lugar cuando se replican de forma local tooAzure de máquinas virtuales y servidores físicos de Windows o Linux, VMware mediante hello [Azure Site Recovery](site-recovery-overview.md) servicio.</span><span class="sxs-lookup"><span data-stu-id="7e381-105">This article describes hello components and processes involved when replicating on-premises VMware virtual machines, and Windows/Linux physical servers, tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="7e381-106">Cuando se replica tooAzure de servidores física local, que utiliza la replicación también Hola mismo componentes y procesos como la replicación de VM de VMware, con estas diferencias:</span><span class="sxs-lookup"><span data-stu-id="7e381-106">When you replicate physical on-premises servers tooAzure, replication uses also hello same components and processes as VMware VM replication, with these differences:</span></span>

- <span data-ttu-id="7e381-107">Puede usar un servidor físico para el servidor de configuración de hello, en lugar de una VM de VMware.</span><span class="sxs-lookup"><span data-stu-id="7e381-107">You can use a physical server for hello configuration server, instead of a VMware VM.</span></span>
- <span data-ttu-id="7e381-108">Necesitará una infraestructura de VMware local para la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-108">You will need an on-premises VMware infrastructure for failback.</span></span> <span data-ttu-id="7e381-109">No se producirá un error de máquina física tooa atrás.</span><span class="sxs-lookup"><span data-stu-id="7e381-109">You can't fail back tooa physical machine.</span></span>

<span data-ttu-id="7e381-110">Registrar los comentarios de la parte inferior de Hola de este artículo, o formular alguna pregunta en hello [foro de servicios de recuperación de Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="7e381-110">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="7e381-111">Componentes de la arquitectura</span><span class="sxs-lookup"><span data-stu-id="7e381-111">Architectural components</span></span>

<span data-ttu-id="7e381-112">Hay una serie de componentes implicados al replicar las máquinas virtuales de VMware y servidores físicos tooAzure.</span><span class="sxs-lookup"><span data-stu-id="7e381-112">There are a number of components involved when replicating VMware VMs and physical servers tooAzure.</span></span>

<span data-ttu-id="7e381-113">**Componente**</span><span class="sxs-lookup"><span data-stu-id="7e381-113">**Component**</span></span> | <span data-ttu-id="7e381-114">**Ubicación**</span><span class="sxs-lookup"><span data-stu-id="7e381-114">**Location**</span></span> | <span data-ttu-id="7e381-115">**Detalles**</span><span class="sxs-lookup"><span data-stu-id="7e381-115">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="7e381-116">**Las tablas de Azure**</span><span class="sxs-lookup"><span data-stu-id="7e381-116">**Azure**</span></span> | <span data-ttu-id="7e381-117">En Azure, necesitará una cuenta de Azure, una cuenta de Azure Storage y una red de Azure.</span><span class="sxs-lookup"><span data-stu-id="7e381-117">In Azure you need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="7e381-118">Los datos replicados se almacenan en la cuenta de almacenamiento de Hola y máquinas virtuales de Azure se crean con datos saludo replican Cuando se produce la conmutación por error desde el sitio local.</span><span class="sxs-lookup"><span data-stu-id="7e381-118">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="7e381-119">Hola máquinas virtuales de Azure Conéctese toohello red virtual de Azure cuando se crean.</span><span class="sxs-lookup"><span data-stu-id="7e381-119">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="7e381-120">**Servidor de configuración**</span><span class="sxs-lookup"><span data-stu-id="7e381-120">**Configuration server**</span></span> | <span data-ttu-id="7e381-121">Un único servidor de administración (VMWare VM) que se ejecuta todos los componentes locales de Hola que son necesarios para la implementación de hello, incluido el servidor de configuración de hello, el servidor de proceso de servidor de destino maestro local</span><span class="sxs-lookup"><span data-stu-id="7e381-121">A single on-premises management server (VMWare VM) that runs all hello on-premises components that are needed for hello deployment, including hello configuration server, process server, master target server</span></span> | <span data-ttu-id="7e381-122">componente de servidor de configuración de Hello coordina las comunicaciones entre local y Azure y administra la replicación de datos.</span><span class="sxs-lookup"><span data-stu-id="7e381-122">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="7e381-123">**Servidor de proceso**:</span><span class="sxs-lookup"><span data-stu-id="7e381-123">**Process server**:</span></span>  | <span data-ttu-id="7e381-124">Se instala de forma predeterminada en el servidor de configuración de Hola.</span><span class="sxs-lookup"><span data-stu-id="7e381-124">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="7e381-125">Actúa como puerta de enlace de replicación.</span><span class="sxs-lookup"><span data-stu-id="7e381-125">Acts as a replication gateway.</span></span> <span data-ttu-id="7e381-126">Recibe datos de replicación, optimiza con almacenamiento en caché, la compresión y cifrado y lo envía tooAzure almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7e381-126">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="7e381-127">servidor de procesos de Hello también controla la instalación de inserción de las máquinas de tooprotected de servicio de movilidad de Hola y realiza la detección automática de máquinas virtuales de VMware.</span><span class="sxs-lookup"><span data-stu-id="7e381-127">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="7e381-128">A medida que crece la implementación puede agregar toohandle de servidores adicionales proceso dedicado independiente aumentar volúmenes de tráfico de replicación.</span><span class="sxs-lookup"><span data-stu-id="7e381-128">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="7e381-129">**Servidor de destino principal**</span><span class="sxs-lookup"><span data-stu-id="7e381-129">**Master target server**</span></span> | <span data-ttu-id="7e381-130">Se instala de forma predeterminada en el servidor de configuración local de Hola.</span><span class="sxs-lookup"><span data-stu-id="7e381-130">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="7e381-131">Controla los datos de replicación durante la conmutación por recuperación desde Azure.</span><span class="sxs-lookup"><span data-stu-id="7e381-131">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="7e381-132">Si los volúmenes de tráfico de la conmutación por recuperación son altos, puede implementar un servidor de destino maestro independiente para la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-132">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="7e381-133">**Servidores de VMware**</span><span class="sxs-lookup"><span data-stu-id="7e381-133">**VMware servers**</span></span> | <span data-ttu-id="7e381-134">Máquinas virtuales de VMware se hospedan en servidores de vSphere ESXi y se recomienda un vCenter hosts de servidor toomanage Hola.</span><span class="sxs-lookup"><span data-stu-id="7e381-134">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="7e381-135">Agregue el almacén de servicios de recuperación de tooyour de servidores de VMware.</span><span class="sxs-lookup"><span data-stu-id="7e381-135">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="7e381-136">**Máquinas replicadas**</span><span class="sxs-lookup"><span data-stu-id="7e381-136">**Replicated machines**</span></span> | <span data-ttu-id="7e381-137">servicio de movilidad de Hola se instalará en cada máquina virtual que desee tooreplicate de VMware.</span><span class="sxs-lookup"><span data-stu-id="7e381-137">hello Mobility service will be installed on each VMware VM you want tooreplicate.</span></span> <span data-ttu-id="7e381-138">Se puede instalar manualmente en cada equipo o con una instalación de inserción Hola del servidor de procesos.</span><span class="sxs-lookup"><span data-stu-id="7e381-138">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="7e381-139">Obtenga información acerca de los requisitos previos de implementación de Hola y requisitos para cada uno de estos componentes en hello [matriz de compatibilidad](site-recovery-support-matrix-to-azure.md).</span><span class="sxs-lookup"><span data-stu-id="7e381-139">Learn about hello deployment prerequisites and requirements for each of these components in hello [support matrix](site-recovery-support-matrix-to-azure.md).</span></span>

<span data-ttu-id="7e381-140">**Figura 1: VMware tooAzure componentes**</span><span class="sxs-lookup"><span data-stu-id="7e381-140">**Figure 1: VMware tooAzure components**</span></span>

![Componentes](./media/site-recovery-components/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="7e381-142">Proceso de replicación</span><span class="sxs-lookup"><span data-stu-id="7e381-142">Replication process</span></span>

1. <span data-ttu-id="7e381-143">Configurar la implementación de hello, incluidos los componentes de Azure y un almacén de servicios de recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-143">You set up hello deployment, including Azure components, and a Recovery Services vault.</span></span> <span data-ttu-id="7e381-144">En el almacén de hello especificar origen de replicación de Hola y de destino, configurar el servidor de configuración de hello, agregar servidores de VMware, cree una directiva de replicación, implementación el servicio de movilidad de hello, habilitan la replicación y ejecutan una prueba de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="7e381-144">In hello vault you specify hello replication source and target, set up hello configuration server, add VMware servers, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="7e381-145">Máquinas empiece a replicar con arreglo a la directiva de replicación de hello y una copia inicial de datos de hello es almacenamiento tooAzure replicada.</span><span class="sxs-lookup"><span data-stu-id="7e381-145">Machines start replicating in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
4. <span data-ttu-id="7e381-146">La replicación de diferencias cambios tooAzure comienza después de que finalice la replicación inicial de Hola.</span><span class="sxs-lookup"><span data-stu-id="7e381-146">Replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="7e381-147">Las marcas de revisión de una máquina se conservan en un archivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="7e381-147">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="7e381-148">Replicación de máquinas comunican con el servidor de configuración de hello en el puerto HTTPS 443 entrante para la administración de replicación.</span><span class="sxs-lookup"><span data-stu-id="7e381-148">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="7e381-149">Replicación máquinas envían servidor de procesos de toohello de datos de replicación en el puerto HTTPS 9443 entrante (puede estar configurado).</span><span class="sxs-lookup"><span data-stu-id="7e381-149">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be configured).</span></span>
    - <span data-ttu-id="7e381-150">servidor de configuración de Hello organiza la administración de la replicación con Azure en el puerto HTTPS 443 saliente.</span><span class="sxs-lookup"><span data-stu-id="7e381-150">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="7e381-151">servidor de procesos de Hello recibe datos de máquinas de origen, optimiza y cifra y lo envía tooAzure almacenamiento en el puerto 443 saliente.</span><span class="sxs-lookup"><span data-stu-id="7e381-151">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="7e381-152">Si habilita la coherencia entre varias VM, a continuación, equipos del grupo de replicación de hello comunican entre sí a través del puerto 20004.</span><span class="sxs-lookup"><span data-stu-id="7e381-152">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="7e381-153">La implementación de varias máquinas virtuales se usa si agrupa varias máquinas en grupos de replicación que tienen puntos de recuperación coherentes con los bloqueos y coherentes con la aplicación cuando conmutan por error.</span><span class="sxs-lookup"><span data-stu-id="7e381-153">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="7e381-154">Esto es útil si las máquinas ejecutan Hola la misma carga de trabajo y necesita toobe coherente.</span><span class="sxs-lookup"><span data-stu-id="7e381-154">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
5. <span data-ttu-id="7e381-155">Tráfico está replicada tooAzure extremos públicos de almacenamiento, en Hola internet.</span><span class="sxs-lookup"><span data-stu-id="7e381-155">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="7e381-156">Como alternativa, puede usar el [emparejamiento público](../expressroute/expressroute-circuit-peerings.md#public-peering) de Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="7e381-156">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="7e381-157">No se admite la replicación del tráfico a través de una VPN de sitio a sitio desde un tooAzure de sitio local.</span><span class="sxs-lookup"><span data-stu-id="7e381-157">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>

<span data-ttu-id="7e381-158">**Figura 2: VMware tooAzure replicación**</span><span class="sxs-lookup"><span data-stu-id="7e381-158">**Figure 2: VMware tooAzure replication**</span></span>

![Mejorada](./media/site-recovery-components/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="7e381-160">Proceso de conmutación por error y conmutación por recuperación</span><span class="sxs-lookup"><span data-stu-id="7e381-160">Failover and failback process</span></span>

1. <span data-ttu-id="7e381-161">Después de comprobar que la conmutación por error funciona según lo previsto, puede ejecutar las conmutaciones por error no planeada tooAzure según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="7e381-161">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="7e381-162">No se admite la conmutación por error planeada.</span><span class="sxs-lookup"><span data-stu-id="7e381-162">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="7e381-163">Puede conmutar por error un único equipo, o crear [planes de recuperación](site-recovery-create-recovery-plans.md), toofail a varias máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="7e381-163">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="7e381-164">Cuando se ejecuta una conmutación por error, las máquinas virtuales de la réplica se crean en Azure.</span><span class="sxs-lookup"><span data-stu-id="7e381-164">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="7e381-165">Confirmar toostart una conmutación por error al acceder a cargas de trabajo de Hola de réplica de hello VM de Azure.</span><span class="sxs-lookup"><span data-stu-id="7e381-165">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="7e381-166">Cuando el sitio local principal esté disponible de nuevo, podrá realizar una conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-166">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="7e381-167">Configurar una infraestructura de conmutación por recuperación, empiece a replicar máquina Hola de hello sitio secundario toohello principal y ejecutar una conmutación por error no planeada desde el sitio secundario de Hola.</span><span class="sxs-lookup"><span data-stu-id="7e381-167">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="7e381-168">Tras confirmar esta conmutación por error, datos será local atrás y necesitará tooenable replicación tooAzure de nuevo.</span><span class="sxs-lookup"><span data-stu-id="7e381-168">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="7e381-169">Más información</span><span class="sxs-lookup"><span data-stu-id="7e381-169">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="7e381-170">Hay varios requisitos para la conmutación por recuperación:</span><span class="sxs-lookup"><span data-stu-id="7e381-170">There are a few failback requirements:</span></span>


- <span data-ttu-id="7e381-171">**Servidor de procesos temporales en Azure**: si desea que toofail de Azure después de la conmutación por error, necesitará tooset una VM de Azure configurado como un servidor de procesos, replicación de toohandle de Azure.</span><span class="sxs-lookup"><span data-stu-id="7e381-171">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="7e381-172">Dicha máquina virtual se puede eliminar cuando finalice la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-172">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="7e381-173">**Conexión VPN**: conmutación por recuperación necesitará una conexión VPN (o ExpressRoute de Azure) configurar de sitio local de hello Azure red toohello.</span><span class="sxs-lookup"><span data-stu-id="7e381-173">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="7e381-174">**Servidor de destino maestro local independiente**: servidor de destino maestro local Hola controla la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-174">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="7e381-175">servidor de destino maestro Hola se instala de forma predeterminada en el servidor de administración de hello, pero si está experimentando problemas volver mayores volúmenes de tráfico debe configurar un servidor de destino maestro local independiente para este propósito.</span><span class="sxs-lookup"><span data-stu-id="7e381-175">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="7e381-176">**Directiva de conmutación por recuperación**: tooreplicate atrás tooyour sitio local, deberá aplicar una directiva de conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="7e381-176">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="7e381-177">Esta se crea automáticamente al crear la directiva de replicación.</span><span class="sxs-lookup"><span data-stu-id="7e381-177">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="7e381-178">**Infraestructura de VMware**: debe realizar conmutación por recuperación tooan VM de VMware locales.</span><span class="sxs-lookup"><span data-stu-id="7e381-178">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="7e381-179">Esto significa que necesita una infraestructura de VMware en local, incluso si replica tooAzure de servidores físicos locales.</span><span class="sxs-lookup"><span data-stu-id="7e381-179">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="7e381-180">**Figura 3: VMware y conmutación por recuperación física**</span><span class="sxs-lookup"><span data-stu-id="7e381-180">**Figure 3: VMware/physical failback**</span></span>

![Conmutación por recuperación](./media/site-recovery-components/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="7e381-182">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="7e381-182">Next steps</span></span>

<span data-ttu-id="7e381-183">Hola de revisión [matriz de compatibilidad](site-recovery-support-matrix-to-azure.md)</span><span class="sxs-lookup"><span data-stu-id="7e381-183">Review hello [support matrix](site-recovery-support-matrix-to-azure.md)</span></span>
