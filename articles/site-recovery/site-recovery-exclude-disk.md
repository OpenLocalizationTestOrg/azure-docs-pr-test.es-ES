---
title: "Exclusión de discos de la protección con Azure Site Recovery | Microsoft Docs"
description: "Describe por qué y cómo excluir discos de máquina virtual de la replicación en escenarios de VMware a Azure y de Hyper-V a Azure."
services: site-recovery
documentationcenter: 
author: nsoneji
manager: garavd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 06/05/2017
ms.author: nisoneji
ms.openlocfilehash: fccbe88e3c0c2b2f3e9958f5f2f27adc017e4d03
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="exclude-disks-from-replication"></a><span data-ttu-id="9c9a0-103">Excluir discos de la replicación</span><span class="sxs-lookup"><span data-stu-id="9c9a0-103">Exclude disks from replication</span></span>
<span data-ttu-id="9c9a0-104">En este artículo se describe cómo excluir discos de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-104">This article describes how to exclude disks from replication.</span></span> <span data-ttu-id="9c9a0-105">Esta exclusión puede optimizar el ancho de banda consumido con la replicación u optimizar los recursos del lado del destino que utilizan estos discos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-105">This exclusion can optimize the consumed replication bandwidth or optimize the target-side resources that such disks utilize.</span></span> <span data-ttu-id="9c9a0-106">La característica es compatible con escenarios de VMware a Azure y de Hyper-V a Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-106">The feature is supported for scenarios of VMware to Azure and Hyper-V to Azure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="9c9a0-107">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="9c9a0-107">Prerequisites</span></span>

<span data-ttu-id="9c9a0-108">De manera predeterminada, se replican todos los discos de una máquina.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-108">By default, all disks on a machine are replicated.</span></span> <span data-ttu-id="9c9a0-109">Si se va a replicar de VMware a Azure, para excluir un disco, la instancia de Mobility Service debe instalarse manualmente en la máquina antes de habilitar la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-109">To exclude a disk from replication, you must manually install the Mobility service on the machine before you enable replication if you are replicating from VMware to Azure.</span></span>


## <a name="why-exclude-disks-from-replication"></a><span data-ttu-id="9c9a0-110">¿Por qué excluir discos de la replicación?</span><span class="sxs-lookup"><span data-stu-id="9c9a0-110">Why exclude disks from replication?</span></span>
<span data-ttu-id="9c9a0-111">A menudo es necesario excluir discos de replicación porque:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-111">Excluding disks from replication is often necessary because:</span></span>

- <span data-ttu-id="9c9a0-112">Los datos renovados en el disco excluido no son importantes o no es necesario replicarlos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-112">The data that's churned on the excluded disk is not important or doesn’t need to be replicated.</span></span>

- <span data-ttu-id="9c9a0-113">No quiere replicar la renovación para ahorrar recursos de almacenamiento y de red.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-113">You want to save storage and network resources by not replicating this churn.</span></span>

## <a name="what-are-the-typical-scenarios"></a><span data-ttu-id="9c9a0-114">¿Cuáles son los escenarios típicos?</span><span class="sxs-lookup"><span data-stu-id="9c9a0-114">What are the typical scenarios?</span></span>
<span data-ttu-id="9c9a0-115">Encontrará ejemplos específicos de datos renovados que son estupendos candidatos para la exclusión.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-115">You can identify specific examples of data churn that are great candidates for exclusion.</span></span> <span data-ttu-id="9c9a0-116">Algunos de ellos podrían ser operaciones de escritura en un archivo de paginación (pagefile.sys) y entradas en el archivo de tempdb de Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-116">Examples might include writes to a paging file (pagefile.sys) and writes to the tempdb file of Microsoft SQL Server.</span></span> <span data-ttu-id="9c9a0-117">Según la carga de trabajo y el subsistema de almacenamiento, el archivo de paginación puede registrar una renovación considerable.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-117">Depending on the workload and the storage subsystem, the paging file can register a significant amount of churn.</span></span> <span data-ttu-id="9c9a0-118">Sin embargo, esta réplica de datos del sitio principal a Azure consumiría muchos recursos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-118">However, replicating this data from the primary site to Azure would be resource intensive.</span></span> <span data-ttu-id="9c9a0-119">Por lo tanto, puede usar los siguientes pasos para optimizar la replicación de una máquina virtual con un único disco virtual que contenga tanto el sistema operativo como el archivo de paginación:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-119">Thus, you can use the following steps to optimize replication of a virtual machine with a single virtual disk that has both the operating system and the paging file:</span></span>

1. <span data-ttu-id="9c9a0-120">Divida el disco virtual único en dos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-120">Split the single virtual disk into two virtual disks.</span></span> <span data-ttu-id="9c9a0-121">Uno para el sistema operativo y el otro para el archivo de paginación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-121">One virtual disk has the operating system, and the other has the paging file.</span></span>
2. <span data-ttu-id="9c9a0-122">Excluya el disco del archivo de paginación de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-122">Exclude the paging file disk from replication.</span></span>

<span data-ttu-id="9c9a0-123">De forma similar, puede usar los siguientes pasos para optimizar un disco que tenga el archivo de la base de datos tempbd de Microsoft SQL Server y el de la base de datos del sistema:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-123">Similarly, you can use the following steps to optimize a disk that has both the Microsoft SQL Server tempdb fie and the system database file:</span></span>

1. <span data-ttu-id="9c9a0-124">Guarde la base de datos del sistema y tempdb en dos discos diferentes.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-124">Keep the system database and tempdb on two different disks.</span></span>
2. <span data-ttu-id="9c9a0-125">Excluya el disco de tempdb de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-125">Exclude the tempdb disk from replication.</span></span>

## <a name="how-to-exclude-disks-from-replication"></a><span data-ttu-id="9c9a0-126">¿Cómo se excluyen discos de la replicación?</span><span class="sxs-lookup"><span data-stu-id="9c9a0-126">How to exclude disks from replication?</span></span>

### <a name="vmware-to-azure"></a><span data-ttu-id="9c9a0-127">VMware en Azure</span><span class="sxs-lookup"><span data-stu-id="9c9a0-127">VMware to Azure</span></span>
<span data-ttu-id="9c9a0-128">Siga el flujo de trabajo de [Habilitación de la replicación](site-recovery-vmware-to-azure.md) para proteger una máquina virtual desde el portal de Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-128">Follow the [Enable replication](site-recovery-vmware-to-azure.md) workflow to protect a virtual machine from the Azure Site Recovery portal.</span></span> <span data-ttu-id="9c9a0-129">En el cuarto paso del flujo de trabajo, use la columna **DISCOS PARA REPLICAR** para excluir los discos de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-129">In the fourth step of the workflow, use the **DISK TO REPLICATE** column to exclude disks from replication.</span></span> <span data-ttu-id="9c9a0-130">De forma predeterminada se seleccionan todos los discos para la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-130">By default, all disks are selected for replication.</span></span> <span data-ttu-id="9c9a0-131">Anule la selección de la casilla del disco que desee excluir y complete los pasos para habilitar la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-131">Clear the check box of disks that you want to exclude from replication, and then complete the steps to enable replication.</span></span>

![Exclusión de discos y habilitación de la replicación de VMware en la conmutación por recuperación de Azure](./media/site-recovery-exclude-disk/v2a-enable-replication-exclude-disk1.png)


>[!NOTE]
>
> * <span data-ttu-id="9c9a0-133">Solo puede excluir discos que tengan instalado Mobility Service.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-133">You can exclude only disks that already have the Mobility service installed.</span></span> <span data-ttu-id="9c9a0-134">Mobility Service se instala manualmente, ya que la instalación solo se puede hacer con el mecanismo de notificación push una vez habilitada la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-134">You need to manually install the Mobility service, because the Mobility service is only installed by using the push mechanism after replication is enabled.</span></span>
> * <span data-ttu-id="9c9a0-135">Solo se pueden excluir los discos básicos de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-135">Only basic disks can be excluded from replication.</span></span> <span data-ttu-id="9c9a0-136">No se pueden excluir los discos dinámicos ni del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-136">You can't exclude operating system or dynamic disks.</span></span>
> * <span data-ttu-id="9c9a0-137">Una vez habilitada la replicación, no puede agregar ni quitar discos de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-137">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="9c9a0-138">Si desea agregar o excluir un disco, deberá deshabilitar la protección de la máquina y volver a habilitarla.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-138">If you want to add or exclude a disk, you need to disable protection for the machine and then enable it again.</span></span>
> * <span data-ttu-id="9c9a0-139">Si excluye un disco necesario para que una aplicación funcione, después de la conmutación por error a Azure, debe crearlo manualmente en Azure para poder ejecutar la aplicación replicada.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-139">If you exclude a disk that's needed for an application to operate, after failover to Azure, you’ll need to create the disk manually in Azure so that the replicated application can run.</span></span> <span data-ttu-id="9c9a0-140">También puede integrar Azure Automation en un plan de recuperación para crear el disco durante la conmutación por error de la máquina.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-140">Alternatively, you can integrate Azure automation into a recovery plan to create the disk during failover of the machine.</span></span>
> * <span data-ttu-id="9c9a0-141">Máquina virtual Windows: no se producirá una conmutación por recuperación de los discos creados manualmente en Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-141">Window virtual machine: Disks that you create manually in Azure are not failed back.</span></span> <span data-ttu-id="9c9a0-142">Por ejemplo, si realiza la conmutación por error de tres discos y crea dos directamente en Azure Virtual Machines, solo los tres discos que se conmutaran por error se conmutarán por recuperación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-142">For example, if you fail over three disks and create two disk directly in Azure Virtual Machines, only three disks that were failed over are failed back.</span></span> <span data-ttu-id="9c9a0-143">No puede incluir los discos creados manualmente en la conmutación por recuperación ni volver a protegerlos de un entorno local a Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-143">You can't include disks that you created manually in failback or in reprotect from on-premises to Azure.</span></span>
> * <span data-ttu-id="9c9a0-144">Máquina virtual Linux: se producirá una conmutación por recuperación de los discos creados manualmente en Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-144">Linux virtual machine: Disks that you create manually in Azure are failed back.</span></span> <span data-ttu-id="9c9a0-145">Por ejemplo, si realiza una conmutación por error de tres discos y crea dos directamente en Azure Virtual Machines, los cinco experimentarán conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-145">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, all five will be failed back.</span></span> <span data-ttu-id="9c9a0-146">No se pueden excluir discos creados manualmente de la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-146">You can't exclude disks that were created manually from failback.</span></span>
>

### <a name="hyper-v-to-azure"></a><span data-ttu-id="9c9a0-147">Hyper-V en Azure</span><span class="sxs-lookup"><span data-stu-id="9c9a0-147">Hyper-V to Azure</span></span>
<span data-ttu-id="9c9a0-148">Siga el flujo de trabajo de [Habilitación de la replicación](site-recovery-hyper-v-site-to-azure.md) para proteger una máquina virtual desde el portal de Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-148">Follow the [Enable replication](site-recovery-hyper-v-site-to-azure.md) workflow to protect a virtual machine from the Azure Site Recovery portal.</span></span> <span data-ttu-id="9c9a0-149">En el cuarto paso del flujo de trabajo, use la columna **DISCOS PARA REPLICAR** para excluir los discos de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-149">In the fourth step of the workflow, use the **DISK TO REPLICATE** column to exclude disks from replication.</span></span> <span data-ttu-id="9c9a0-150">De forma predeterminada se seleccionan todos los discos para la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-150">By default, all disks are selected for replication.</span></span> <span data-ttu-id="9c9a0-151">Anule la selección de la casilla del disco que desee excluir y complete los pasos para habilitar la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-151">Clear the check box of disks that you want to exclude from replication, and then complete the steps to enable replication.</span></span>

![Exclusión de discos y habilitación de la replicación de Hyper-V en la conmutación por recuperación de Azure](./media/site-recovery-vmm-to-azure/enable-replication6-with-exclude-disk.png)

>[!NOTE]
>
> * <span data-ttu-id="9c9a0-153">De la replicación solo se pueden excluir discos básicos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-153">You can exclude only basic disks from replication.</span></span> <span data-ttu-id="9c9a0-154">No se pueden excluir los discos del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-154">You can't exclude operating system disks.</span></span> <span data-ttu-id="9c9a0-155">Se recomienda no excluir discos dinámicos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-155">We recommend that you do not exclude dynamic disks.</span></span> <span data-ttu-id="9c9a0-156">Azure Site Recovery no puede identificar qué disco duro virtual (VHD) es básico o dinámico en la máquina virtual invitada.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-156">Azure Site Recovery cannot identify which virtual hard disk (VHD) is basic or dynamic in the guest virtual machine.</span></span>  <span data-ttu-id="9c9a0-157">Si no se excluye ningún disco del volumen dinámico dependiente, el disco dinámico protegido aparecerá como erróneo en la máquina virtual de conmutación por error y no se podrá acceder a los datos de ese disco.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-157">If all dependent dynamic volume disks are not excluded, the protected dynamic disk becomes a failed disk on a failover virtual machine, and the data on that disk is not accessible.</span></span>
> * <span data-ttu-id="9c9a0-158">Una vez habilitada la replicación, no puede agregar ni quitar discos de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-158">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="9c9a0-159">Si desea agregar o excluir un disco, deberá deshabilitar la protección de la máquina virtual y volver a habilitarla.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-159">If you want to add or exclude a disk, you need to disable protection for the virtual machine and then enable it again.</span></span>
> * <span data-ttu-id="9c9a0-160">Si excluye un disco necesario para que una aplicación funcione, después de la conmutación por error a Azure, debe crearlo manualmente en Azure para poder ejecutar la aplicación replicada.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-160">If you exclude a disk that's needed for an application to operate, after failover to Azure you’ll need to create the disk manually in Azure so that the replicated application can run.</span></span> <span data-ttu-id="9c9a0-161">También puede integrar Azure Automation en un plan de recuperación para crear el disco durante la conmutación por error de la máquina.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-161">Alternatively, you can integrate Azure automation into a recovery plan to create the disk during failover of the machine.</span></span>
> * <span data-ttu-id="9c9a0-162">No se producirá una conmutación por recuperación de los discos creados manualmente en Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-162">Disks that you create manually in Azure will not be failed back.</span></span> <span data-ttu-id="9c9a0-163">Por ejemplo, si realiza la conmutación por error de tres discos y crea dos directamente en Azure Virtual Machines, solo los tres discos que se conmutaron por error se conmutarán por recuperación de Azure a Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-163">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, only three disks that were failed over will be failed back from Azure to Hyper-V.</span></span> <span data-ttu-id="9c9a0-164">No puede incluir los discos creados manualmente en la conmutación por recuperación ni en la replicación inversa de Hyper-V a Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-164">You can't include disks that were created manually in failback or in reverse replication from Hyper-V to Azure.</span></span>



## <a name="end-to-end-scenarios-of-exclude-disks"></a><span data-ttu-id="9c9a0-165">Escenarios completos de exclusión de discos</span><span class="sxs-lookup"><span data-stu-id="9c9a0-165">End-to-end scenarios of exclude disks</span></span>
<span data-ttu-id="9c9a0-166">Veamos dos escenarios para comprender la característica de exclusión de discos:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-166">Let's consider two scenarios to understand the exclude disk feature:</span></span>

- <span data-ttu-id="9c9a0-167">Disco de la base de datos tempdb de SQL Server</span><span class="sxs-lookup"><span data-stu-id="9c9a0-167">SQL Server tempdb disk</span></span>
- <span data-ttu-id="9c9a0-168">Disco del archivo de paginación (pagefile.sys)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-168">Paging file (pagefile.sys) disk</span></span>

### <a name="exclude-the-sql-server-tempdb-disk"></a><span data-ttu-id="9c9a0-169">Exclusión del disco de la base de datos tempdb de SQL Server</span><span class="sxs-lookup"><span data-stu-id="9c9a0-169">Exclude the SQL Server tempdb disk</span></span>
<span data-ttu-id="9c9a0-170">Veamos una máquina virtual de SQL Server con una base de datos tempdb que se puede excluir.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-170">Let's consider a SQL Server virtual machine that has a tempdb that can be excluded.</span></span>

<span data-ttu-id="9c9a0-171">El nombre del disco virtual es SalesDB.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-171">The name of the virtual disk is SalesDB.</span></span>

<span data-ttu-id="9c9a0-172">Los discos de la máquina virtual de origen son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-172">Disks on the source virtual machine are as follows:</span></span>


<span data-ttu-id="9c9a0-173">**Nombre del disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-173">**Disk name**</span></span> | <span data-ttu-id="9c9a0-174">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-174">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-175">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-175">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-176">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-176">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="9c9a0-177">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="9c9a0-177">DB-Disk0-OS</span></span> | <span data-ttu-id="9c9a0-178">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-178">DISK0</span></span> | <span data-ttu-id="9c9a0-179">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-179">C:\\</span></span> | <span data-ttu-id="9c9a0-180">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-180">Operating system disk</span></span>
<span data-ttu-id="9c9a0-181">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-181">DB-Disk1</span></span>| <span data-ttu-id="9c9a0-182">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-182">Disk1</span></span> | <span data-ttu-id="9c9a0-183">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-183">D:\\</span></span> | <span data-ttu-id="9c9a0-184">Base de datos del sistema SQL y Database1 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-184">SQL system database and User Database1</span></span>
<span data-ttu-id="9c9a0-185">DB-Disk2 (disco excluido de la protección)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-185">DB-Disk2 (Excluded the disk from protection)</span></span> | <span data-ttu-id="9c9a0-186">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-186">Disk2</span></span> | <span data-ttu-id="9c9a0-187">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-187">E:\\</span></span> | <span data-ttu-id="9c9a0-188">Archivos temporales</span><span class="sxs-lookup"><span data-stu-id="9c9a0-188">Temp files</span></span>
<span data-ttu-id="9c9a0-189">DB-Disk3 (disco excluido de la protección)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-189">DB-Disk3 (Excluded the disk from protection)</span></span> | <span data-ttu-id="9c9a0-190">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-190">Disk3</span></span> | <span data-ttu-id="9c9a0-191">F:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-191">F:\\</span></span> | <span data-ttu-id="9c9a0-192">Base de datos tempdb de SQL (ruta de acceso de carpeta) F:\MSSQL\Data\) </br /> </br />Anote la ruta de acceso de la carpeta antes de la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-192">SQL tempdb database (folder path(F:\MSSQL\Data\) </br /> </br />Write down the folder path before failover.</span></span>
<span data-ttu-id="9c9a0-193">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="9c9a0-193">DB-Disk4</span></span> | <span data-ttu-id="9c9a0-194">Disk4</span><span class="sxs-lookup"><span data-stu-id="9c9a0-194">Disk4</span></span> |<span data-ttu-id="9c9a0-195">G:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-195">G:\\</span></span> |<span data-ttu-id="9c9a0-196">Database2 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-196">User Database2</span></span>

<span data-ttu-id="9c9a0-197">Dado que la renovación de datos en dos discos de la máquina virtual es temporal, al mismo tiempo que protege la máquina virtual de SalesDB, excluya Disk2 y Disk3 de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-197">Because data churn on two disks of the virtual machine is temporary, while you protect the SalesDB virtual machine, exclude Disk2 and Disk3 from replication.</span></span> <span data-ttu-id="9c9a0-198">Azure Site Recovery no replicará esos discos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-198">Azure Site Recovery will not replicate those disks.</span></span> <span data-ttu-id="9c9a0-199">En la conmutación por error, esos discos no estarán presentes en la máquina virtual de conmutación por error de Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-199">On failover, those disks will not be present on the failover virtual machine on Azure.</span></span>

<span data-ttu-id="9c9a0-200">Los discos de la máquina virtual de Azure después de la conmutación por error son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-200">Disks on the Azure virtual machine after failover are as follows:</span></span>

<span data-ttu-id="9c9a0-201">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-201">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-202">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-202">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-203">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-203">**Data type on the disk**</span></span>
--- | --- | ---
<span data-ttu-id="9c9a0-204">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-204">DISK0</span></span> | <span data-ttu-id="9c9a0-205">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-205">C:\\</span></span> | <span data-ttu-id="9c9a0-206">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-206">Operating system disk</span></span>
<span data-ttu-id="9c9a0-207">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-207">Disk1</span></span> | <span data-ttu-id="9c9a0-208">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-208">E:\\</span></span> | <span data-ttu-id="9c9a0-209">Almacenamiento temporal</br /> </br />Azure agrega este disco y asigna la primera unidad disponible.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-209">Temporary storage</br /> </br />Azure adds this disk and assigns the first available drive letter.</span></span>
<span data-ttu-id="9c9a0-210">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-210">Disk2</span></span> | <span data-ttu-id="9c9a0-211">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-211">D:\\</span></span> | <span data-ttu-id="9c9a0-212">Base de datos del sistema SQL y Database1 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-212">SQL system database and User Database1</span></span>
<span data-ttu-id="9c9a0-213">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-213">Disk3</span></span> | <span data-ttu-id="9c9a0-214">G:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-214">G:\\</span></span> | <span data-ttu-id="9c9a0-215">Database2 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-215">User Database2</span></span>

<span data-ttu-id="9c9a0-216">Puesto que Disk2 y Disk3 se excluyeron de la máquina virtual de SalesDB, E: es la primera unidad disponible de la lista.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-216">Because Disk2 and Disk3 were excluded from the SalesDB virtual machine, E: is the first drive letter from the available list.</span></span> <span data-ttu-id="9c9a0-217">Azure la asigna al volumen de almacenamiento temporal.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-217">Azure assigns E: to the temporary storage volume.</span></span> <span data-ttu-id="9c9a0-218">Para todos los discos replicados, la unidad permanece igual.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-218">For all the replicated disks, the drive letters remain the same.</span></span>

<span data-ttu-id="9c9a0-219">Disk3, que era el disco de la base de datos tempdb de SQL (ruta de acceso de carpeta de tempdb F:\MSSQL\Data\), se ha excluido de la replicación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-219">Disk3, which was the SQL tempdb disk (tempdb folder path F:\MSSQL\Data\), was excluded from replication.</span></span> <span data-ttu-id="9c9a0-220">El disco no está disponible en la máquina virtual de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-220">The disk is not available on the failover virtual machine.</span></span> <span data-ttu-id="9c9a0-221">Como resultado, el servicio SQL está detenido y necesita la ruta de acceso F:\MSSQL\Data.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-221">As a result, the SQL service is in a stopped state, and it needs the F:\MSSQL\Data path.</span></span>

<span data-ttu-id="9c9a0-222">Hay dos maneras de crear esta ruta de acceso:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-222">There are two ways to create this path:</span></span>

- <span data-ttu-id="9c9a0-223">Agregar un disco nuevo y asignar la ruta de acceso de carpeta de tempdb.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-223">Add a new disk and assign tempdb folder path.</span></span>
- <span data-ttu-id="9c9a0-224">Usar un disco de almacenamiento temporal existente para la ruta de acceso de carpeta de tempdb.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-224">Use an existing temporary storage disk for the tempdb folder path.</span></span>

#### <a name="add-a-new-disk"></a><span data-ttu-id="9c9a0-225">Incorporación de un disco nuevo:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-225">Add a new disk:</span></span>

1. <span data-ttu-id="9c9a0-226">Anote las rutas de acceso de tempdb.mdf y tempdb.ldf de SQL antes de la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-226">Write down the paths of SQL tempdb.mdf and tempdb.ldf before failover.</span></span>
2. <span data-ttu-id="9c9a0-227">Desde Azure Portal, agregue un disco nuevo a la máquina virtual de conmutación por error con el mismo o mayor tamaño que el del disco de la base de datos tempdb de SQL de origen (Disk3).</span><span class="sxs-lookup"><span data-stu-id="9c9a0-227">From the Azure portal, add a new disk to the failover virtual machine with the same or more size as that of the source SQL tempdb disk (Disk3).</span></span>
3. <span data-ttu-id="9c9a0-228">Inicie sesión en la máquina virtual de Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-228">Sign in to the Azure virtual machine.</span></span> <span data-ttu-id="9c9a0-229">Desde la consola de administración de disco (diskmgmt.msc), inicialice y formatee el disco recién agregado.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-229">From the disk management (diskmgmt.msc) console, initialize and format the newly added disk.</span></span>
4. <span data-ttu-id="9c9a0-230">Asigne la misma unidad del disco de la base de datos tempdb de SQL (F:).</span><span class="sxs-lookup"><span data-stu-id="9c9a0-230">Assign the same drive letter that was used by the SQL tempdb disk (F:).</span></span>
5. <span data-ttu-id="9c9a0-231">Cree la carpeta para tempdb en el volumen F: (F:\MSSQL\Data).</span><span class="sxs-lookup"><span data-stu-id="9c9a0-231">Create a tempdb folder on the F: volume (F:\MSSQL\Data).</span></span>
6. <span data-ttu-id="9c9a0-232">Inicie el servicio SQL desde la consola de servicio.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-232">Start the SQL service from the service console.</span></span>

#### <a name="use-an-existing-temporary-storage-disk-for-the-sql-tempdb-folder-path"></a><span data-ttu-id="9c9a0-233">Uso de un disco de almacenamiento temporal existente para la ruta de acceso de carpeta de tempdb de SQL:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-233">Use an existing temporary storage disk for the SQL tempdb folder path:</span></span>

1. <span data-ttu-id="9c9a0-234">Abra el símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-234">Open a command prompt.</span></span>
2. <span data-ttu-id="9c9a0-235">Ejecute SQL Server en modo de recuperación desde el símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-235">Run SQL Server in recovery mode from the command prompt.</span></span>

        Net start MSSQLSERVER /f / T3608

3. <span data-ttu-id="9c9a0-236">Ejecute el siguiente sqlcmd para cambiar a la nueva ruta de acceso de tempdb.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-236">Run the following sqlcmd to change the tempdb path to the new path.</span></span>

        sqlcmd -A -S SalesDB        **Use your SQL DBname**
        USE master;     
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = tempdev, FILENAME = 'E:\MSSQL\tempdata\tempdb.mdf');
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = templog, FILENAME = 'E:\MSSQL\tempdata\templog.ldf');       
        GO


4. <span data-ttu-id="9c9a0-237">Detenga el servicio Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-237">Stop the Microsoft SQL Server service.</span></span>

        Net stop MSSQLSERVER
5. <span data-ttu-id="9c9a0-238">Inicie el servicio Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-238">Start the Microsoft SQL Server service.</span></span>

        Net start MSSQLSERVER

<span data-ttu-id="9c9a0-239">Consulte las siguientes directrices de Azure para el disco de almacenamiento temporal:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-239">Refer to the following Azure guideline for temporary storage disk:</span></span>

* <span data-ttu-id="9c9a0-240">[Using SSDs in Azure VMs to store SQL Server TempDB and Buffer Pool Extensions](https://blogs.technet.microsoft.com/dataplatforminsider/2014/09/25/using-ssds-in-azure-vms-to-store-sql-server-tempdb-and-buffer-pool-extensions/) (Uso de SSD en máquinas virtuales de Azure para almacenar la base de datos TempDB de SQL Server y las extensiones del grupo de búferes)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-240">[Using SSDs in Azure VMs to store SQL Server TempDB and Buffer Pool Extensions](https://blogs.technet.microsoft.com/dataplatforminsider/2014/09/25/using-ssds-in-azure-vms-to-store-sql-server-tempdb-and-buffer-pool-extensions/)</span></span>
* [<span data-ttu-id="9c9a0-241">Procedimientos recomendados para SQL Server en Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="9c9a0-241">Performance best practices for SQL Server in Azure Virtual Machines</span></span>](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-performance)

### <a name="failback-from-azure-to-an-on-premises-host"></a><span data-ttu-id="9c9a0-242">Conmutación por recuperación (de Azure a un host local)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-242">Failback (from Azure to an on-premises host)</span></span>
<span data-ttu-id="9c9a0-243">Ahora debemos conocer los discos que se replican al realizar la conmutación por error de Azure al host de Hyper-V o VMware locales.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-243">Now let's understand the disks that are replicated when you fail over from Azure to your on-premises VMware or Hyper-V host.</span></span> <span data-ttu-id="9c9a0-244">Los discos creados manualmente en Azure no se replicarán.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-244">Disks that you create manually in Azure will not be replicated.</span></span> <span data-ttu-id="9c9a0-245">Por ejemplo, si realiza la conmutación por error de tres discos y crea dos directamente en Azure Virtual Machines, solo los tres discos que se conmutaran por error se conmutarán por recuperación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-245">For example, if you fail over three disks and create two directly in Azure Virtual Machines, only three disks that were failed over will be failed back.</span></span> <span data-ttu-id="9c9a0-246">No puede incluir los discos creados manualmente en la conmutación por recuperación ni volver a protegerlos de un entorno local a Azure.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-246">You can't include disks that were created manually in failback or in reprotect from on-premises to Azure.</span></span> <span data-ttu-id="9c9a0-247">Tampoco se replicará el disco de almacenamiento temporal en el host local.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-247">It also does not replicate the temporary storage disk to on-premises hosts.</span></span>

#### <a name="failback-to-original-location-recovery"></a><span data-ttu-id="9c9a0-248">Conmutación por recuperación en la ubicación original</span><span class="sxs-lookup"><span data-stu-id="9c9a0-248">Failback to original location recovery</span></span>

<span data-ttu-id="9c9a0-249">En el ejemplo anterior, la configuración del disco de la máquina virtual de Azure es la siguiente:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-249">In the previous example, the Azure virtual machine disk configuration is as follows:</span></span>

<span data-ttu-id="9c9a0-250">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-250">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-251">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-251">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-252">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-252">**Data type on the disk**</span></span>
--- | --- | ---
<span data-ttu-id="9c9a0-253">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-253">DISK0</span></span> | <span data-ttu-id="9c9a0-254">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-254">C:\\</span></span> | <span data-ttu-id="9c9a0-255">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-255">Operating system disk</span></span>
<span data-ttu-id="9c9a0-256">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-256">Disk1</span></span> | <span data-ttu-id="9c9a0-257">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-257">E:\\</span></span> | <span data-ttu-id="9c9a0-258">Almacenamiento temporal</br /> </br />Azure agrega este disco y asigna la primera unidad disponible.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-258">Temporary storage</br /> </br />Azure adds this disk and assigns the first available drive letter.</span></span>
<span data-ttu-id="9c9a0-259">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-259">Disk2</span></span> | <span data-ttu-id="9c9a0-260">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-260">D:\\</span></span> | <span data-ttu-id="9c9a0-261">Base de datos del sistema SQL y Database1 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-261">SQL system database and User Database1</span></span>
<span data-ttu-id="9c9a0-262">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-262">Disk3</span></span> | <span data-ttu-id="9c9a0-263">G:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-263">G:\\</span></span> | <span data-ttu-id="9c9a0-264">Database2 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-264">User Database2</span></span>


#### <a name="vmware-to-azure"></a><span data-ttu-id="9c9a0-265">VMware en Azure</span><span class="sxs-lookup"><span data-stu-id="9c9a0-265">VMware to Azure</span></span>
<span data-ttu-id="9c9a0-266">Cuando se realiza la conmutación por recuperación en la ubicación original, la configuración del disco de la máquina virtual de conmutación por recuperación no tiene exclusiones.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-266">When failback is done to the original location, the failback virtual machine disk configuration does not have excluded disks.</span></span> <span data-ttu-id="9c9a0-267">Los discos que excluyeran de VMware a Azure, no estarán disponibles en la máquina virtual de conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-267">Disks that were excluded from VMware to Azure  will not be available on the failback virtual machine.</span></span>

<span data-ttu-id="9c9a0-268">Discos de la máquina virtual de VMWare (ubicación original) después de la conmutación por error planeada de Azure a VMware local:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-268">After planned failover from Azure to on-premises VMware, disks on the VMWare virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="9c9a0-269">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-269">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-270">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-270">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-271">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-271">**Data type on the disk**</span></span>
--- | --- | ---
<span data-ttu-id="9c9a0-272">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-272">DISK0</span></span> | <span data-ttu-id="9c9a0-273">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-273">C:\\</span></span> | <span data-ttu-id="9c9a0-274">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-274">Operating system disk</span></span>
<span data-ttu-id="9c9a0-275">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-275">Disk1</span></span> | <span data-ttu-id="9c9a0-276">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-276">D:\\</span></span> | <span data-ttu-id="9c9a0-277">Base de datos del sistema SQL y Database1 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-277">SQL system database and User Database1</span></span>
<span data-ttu-id="9c9a0-278">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-278">Disk2</span></span> | <span data-ttu-id="9c9a0-279">G:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-279">G:\\</span></span> | <span data-ttu-id="9c9a0-280">Database2 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-280">User Database2</span></span>

#### <a name="hyper-v-to-azure"></a><span data-ttu-id="9c9a0-281">Hyper-V en Azure</span><span class="sxs-lookup"><span data-stu-id="9c9a0-281">Hyper-V to Azure</span></span>
<span data-ttu-id="9c9a0-282">Cuando se realiza la conmutación por recuperación en la ubicación original, la configuración del disco de la máquina virtual de conmutación por recuperación es la misma que la original del disco de la máquina virtual para Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-282">When failback is to the original location, the failback virtual machine disk configuration remains the same as that of original virtual machine disk configuration for Hyper-V.</span></span> <span data-ttu-id="9c9a0-283">Los discos que se excluyeran del sitio de Hyper-V a Azure no estarán disponibles en la máquina virtual de conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-283">Disks that were excluded from Hyper-V site to Azure are available on the failback virtual machine.</span></span>

<span data-ttu-id="9c9a0-284">Discos de la máquina virtual de Hyper-V (ubicación original) después de la conmutación por error planeada de Azure a Hyper-V local:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-284">After planned failover from Azure to on-premises Hyper-V, disks on the Hyper-V virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="9c9a0-285">**Nombre del disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-285">**Disk Name**</span></span> | <span data-ttu-id="9c9a0-286">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-286">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-287">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-287">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-288">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-288">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="9c9a0-289">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="9c9a0-289">DB-Disk0-OS</span></span> | <span data-ttu-id="9c9a0-290">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-290">DISK0</span></span> |   <span data-ttu-id="9c9a0-291">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-291">C:\\</span></span> | <span data-ttu-id="9c9a0-292">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-292">Operating system disk</span></span>
<span data-ttu-id="9c9a0-293">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-293">DB-Disk1</span></span> | <span data-ttu-id="9c9a0-294">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-294">Disk1</span></span> | <span data-ttu-id="9c9a0-295">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-295">D:\\</span></span> | <span data-ttu-id="9c9a0-296">Base de datos del sistema SQL y Database1 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-296">SQL system database and User Database1</span></span>
<span data-ttu-id="9c9a0-297">DB-Disk2 (disco excluido)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-297">DB-Disk2 (Excluded disk)</span></span> | <span data-ttu-id="9c9a0-298">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-298">Disk2</span></span> | <span data-ttu-id="9c9a0-299">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-299">E:\\</span></span> | <span data-ttu-id="9c9a0-300">Archivos temporales</span><span class="sxs-lookup"><span data-stu-id="9c9a0-300">Temp files</span></span>
<span data-ttu-id="9c9a0-301">DB-Disk3 (disco excluido)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-301">DB-Disk3 (Excluded disk)</span></span> | <span data-ttu-id="9c9a0-302">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-302">Disk3</span></span> | <span data-ttu-id="9c9a0-303">F:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-303">F:\\</span></span> | <span data-ttu-id="9c9a0-304">Base de datos tempdb de SQL (ruta de acceso de carpeta): F:\MSSQL\Data\)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-304">SQL tempdb database (folder path(F:\MSSQL\Data\)</span></span>
<span data-ttu-id="9c9a0-305">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="9c9a0-305">DB-Disk4</span></span> | <span data-ttu-id="9c9a0-306">Disk4</span><span class="sxs-lookup"><span data-stu-id="9c9a0-306">Disk4</span></span> | <span data-ttu-id="9c9a0-307">G:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-307">G:\\</span></span> | <span data-ttu-id="9c9a0-308">Database2 del usuario</span><span class="sxs-lookup"><span data-stu-id="9c9a0-308">User Database2</span></span>


#### <a name="exclude-the-paging-file-pagefilesys-disk"></a><span data-ttu-id="9c9a0-309">Exclusión del disco del archivo de paginación (pagefile.sys)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-309">Exclude the paging file (pagefile.sys) disk</span></span>

<span data-ttu-id="9c9a0-310">Veamos una máquina virtual con un disco del archivo de paginación que se puede excluir.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-310">Let's consider a virtual machine that has a paging file disk that can be excluded.</span></span>
<span data-ttu-id="9c9a0-311">Hay dos casos.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-311">There are two cases.</span></span>

#### <a name="case-1-the-paging-file-is-configured-on-the-d-drive"></a><span data-ttu-id="9c9a0-312">Caso 1: el archivo de paginación está configurado en la unidad D:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-312">Case 1: The paging file is configured on the D: drive</span></span>
<span data-ttu-id="9c9a0-313">Configuración del disco:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-313">Here's the disk configuration:</span></span>


<span data-ttu-id="9c9a0-314">**Nombre del disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-314">**Disk name**</span></span> | <span data-ttu-id="9c9a0-315">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-315">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-316">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-316">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-317">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-317">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="9c9a0-318">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="9c9a0-318">DB-Disk0-OS</span></span> | <span data-ttu-id="9c9a0-319">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-319">DISK0</span></span> | <span data-ttu-id="9c9a0-320">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-320">C:\\</span></span> | <span data-ttu-id="9c9a0-321">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-321">Operating system disk</span></span>
<span data-ttu-id="9c9a0-322">DB-Disk1 (disco excluido de la protección)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-322">DB-Disk1 (Excluded the disk from the protection)</span></span> | <span data-ttu-id="9c9a0-323">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-323">Disk1</span></span> | <span data-ttu-id="9c9a0-324">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-324">D:\\</span></span> | <span data-ttu-id="9c9a0-325">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="9c9a0-325">pagefile.sys</span></span>
<span data-ttu-id="9c9a0-326">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-326">DB-Disk2</span></span> | <span data-ttu-id="9c9a0-327">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-327">Disk2</span></span> | <span data-ttu-id="9c9a0-328">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-328">E:\\</span></span> | <span data-ttu-id="9c9a0-329">Datos del usuario 1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-329">User data 1</span></span>
<span data-ttu-id="9c9a0-330">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-330">DB-Disk3</span></span> | <span data-ttu-id="9c9a0-331">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-331">Disk3</span></span> | <span data-ttu-id="9c9a0-332">F:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-332">F:\\</span></span> | <span data-ttu-id="9c9a0-333">Datos del usuario 2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-333">User data 2</span></span>

<span data-ttu-id="9c9a0-334">Esta es la configuración del archivo de paginación en la máquina virtual de origen:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-334">Here are the paging file settings on the source virtual machine:</span></span>

![Configuración del archivo de paginación en la máquina virtual de origen](./media/site-recovery-exclude-disk/pagefile-on-d-drive-sourceVM.png)


<span data-ttu-id="9c9a0-336">Después de la conmutación por error de la máquina virtual de VMware o Hyper-V a Azure, los discos de la máquina virtual de Azure son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-336">After failover of the virtual machine from VMware to Azure or Hyper-V to Azure, disks on the Azure virtual machine are as follows:</span></span>

<span data-ttu-id="9c9a0-337">**Nombre del disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-337">**Disk name**</span></span> | <span data-ttu-id="9c9a0-338">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-338">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-339">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-339">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-340">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-340">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="9c9a0-341">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="9c9a0-341">DB-Disk0-OS</span></span> | <span data-ttu-id="9c9a0-342">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-342">DISK0</span></span> | <span data-ttu-id="9c9a0-343">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-343">C:\\</span></span> | <span data-ttu-id="9c9a0-344">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-344">Operating system disk</span></span>
<span data-ttu-id="9c9a0-345">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-345">DB-Disk1</span></span> | <span data-ttu-id="9c9a0-346">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-346">Disk1</span></span> | <span data-ttu-id="9c9a0-347">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-347">D:\\</span></span> | <span data-ttu-id="9c9a0-348">Almacenamiento temporal</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="9c9a0-348">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="9c9a0-349">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-349">DB-Disk2</span></span> | <span data-ttu-id="9c9a0-350">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-350">Disk2</span></span> | <span data-ttu-id="9c9a0-351">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-351">E:\\</span></span> | <span data-ttu-id="9c9a0-352">Datos del usuario 1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-352">User data 1</span></span>
<span data-ttu-id="9c9a0-353">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-353">DB-Disk3</span></span> | <span data-ttu-id="9c9a0-354">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-354">Disk3</span></span> | <span data-ttu-id="9c9a0-355">F:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-355">F:\\</span></span> | <span data-ttu-id="9c9a0-356">Datos del usuario 2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-356">User data 2</span></span>

<span data-ttu-id="9c9a0-357">Dado que se ha excluido Disk1 (D:), D: es la primera unidad disponible de la lista.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-357">Because Disk1 (D:) was excluded, D: is the first drive letter from the available list.</span></span> <span data-ttu-id="9c9a0-358">Azure la asigna al volumen de almacenamiento temporal.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-358">Azure assigns D: to the temporary storage volume.</span></span> <span data-ttu-id="9c9a0-359">Dado que D: está disponible en la máquina virtual de Azure, la configuración del archivo de paginación de la máquina virtual sigue siendo el mismo.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-359">Because D: is available on the Azure virtual machine, the paging file setting of the virtual machine remains the same.</span></span>

<span data-ttu-id="9c9a0-360">Esta es la configuración del archivo de paginación en la máquina virtual de Azure:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-360">Here are the paging file settings on the Azure virtual machine:</span></span>

![Configuración del archivo de paginación en la máquina virtual de Azure](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover.png)

#### <a name="case-2-the-paging-file-is-configured-on-another-drive-other-than-d-drive"></a><span data-ttu-id="9c9a0-362">Caso 2: el archivo de paginación está configurado en otra unidad (que no sea D:)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-362">Case 2: The paging file is configured on another drive (other than D: drive)</span></span>

<span data-ttu-id="9c9a0-363">Esta es la configuración del disco de la máquina virtual de origen:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-363">Here's the source virtual machine disk configuration:</span></span>

<span data-ttu-id="9c9a0-364">**Nombre del disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-364">**Disk name**</span></span> | <span data-ttu-id="9c9a0-365">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-365">**Guest operating system disk#**</span></span> | <span data-ttu-id="9c9a0-366">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-366">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-367">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-367">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="9c9a0-368">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="9c9a0-368">DB-Disk0-OS</span></span> | <span data-ttu-id="9c9a0-369">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-369">DISK0</span></span> | <span data-ttu-id="9c9a0-370">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-370">C:\\</span></span> | <span data-ttu-id="9c9a0-371">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-371">Operating system disk</span></span>
<span data-ttu-id="9c9a0-372">DB-Disk1 (disco excluido de la protección)</span><span class="sxs-lookup"><span data-stu-id="9c9a0-372">DB-Disk1 (Excluded the disk from protection)</span></span> | <span data-ttu-id="9c9a0-373">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-373">Disk1</span></span> | <span data-ttu-id="9c9a0-374">G:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-374">G:\\</span></span> | <span data-ttu-id="9c9a0-375">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="9c9a0-375">pagefile.sys</span></span>
<span data-ttu-id="9c9a0-376">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-376">DB-Disk2</span></span> | <span data-ttu-id="9c9a0-377">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-377">Disk2</span></span> | <span data-ttu-id="9c9a0-378">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-378">E:\\</span></span> | <span data-ttu-id="9c9a0-379">Datos del usuario 1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-379">User data 1</span></span>
<span data-ttu-id="9c9a0-380">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-380">DB-Disk3</span></span> | <span data-ttu-id="9c9a0-381">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-381">Disk3</span></span> | <span data-ttu-id="9c9a0-382">F:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-382">F:\\</span></span> | <span data-ttu-id="9c9a0-383">Datos del usuario 2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-383">User data 2</span></span>

<span data-ttu-id="9c9a0-384">Esta es la configuración del archivo de paginación en la máquina virtual local:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-384">Here are the paging file settings on the on-premises virtual machine:</span></span>

![Configuración del archivo de paginación en la máquina virtual local](./media/site-recovery-exclude-disk/pagefile-on-g-drive-sourceVM.png)

<span data-ttu-id="9c9a0-386">Después de la conmutación por error de la máquina virtual de VMware o Hyper-V a Azure, los discos de la máquina virtual de Azure son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-386">After failover of the virtual machine from VMware/Hyper-V to Azure, disks on the Azure virtual machine are as follows:</span></span>

<span data-ttu-id="9c9a0-387">**Nombre del disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-387">**Disk name**</span></span>| <span data-ttu-id="9c9a0-388">**Sistema operativo invitado**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-388">**Guest operating system disk#**</span></span>| <span data-ttu-id="9c9a0-389">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-389">**Drive letter**</span></span> | <span data-ttu-id="9c9a0-390">**Tipo de datos en el disco**</span><span class="sxs-lookup"><span data-stu-id="9c9a0-390">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="9c9a0-391">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="9c9a0-391">DB-Disk0-OS</span></span> | <span data-ttu-id="9c9a0-392">DISK0</span><span class="sxs-lookup"><span data-stu-id="9c9a0-392">DISK0</span></span>  |<span data-ttu-id="9c9a0-393">C:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-393">C:\\</span></span> |<span data-ttu-id="9c9a0-394">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="9c9a0-394">Operating system disk</span></span>
<span data-ttu-id="9c9a0-395">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-395">DB-Disk1</span></span> | <span data-ttu-id="9c9a0-396">Disk1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-396">Disk1</span></span> | <span data-ttu-id="9c9a0-397">D:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-397">D:\\</span></span> | <span data-ttu-id="9c9a0-398">Almacenamiento temporal</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="9c9a0-398">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="9c9a0-399">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-399">DB-Disk2</span></span> | <span data-ttu-id="9c9a0-400">Disk2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-400">Disk2</span></span> | <span data-ttu-id="9c9a0-401">E:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-401">E:\\</span></span> | <span data-ttu-id="9c9a0-402">Datos del usuario 1</span><span class="sxs-lookup"><span data-stu-id="9c9a0-402">User data 1</span></span>
<span data-ttu-id="9c9a0-403">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-403">DB-Disk3</span></span> | <span data-ttu-id="9c9a0-404">Disk3</span><span class="sxs-lookup"><span data-stu-id="9c9a0-404">Disk3</span></span> | <span data-ttu-id="9c9a0-405">F:\\</span><span class="sxs-lookup"><span data-stu-id="9c9a0-405">F:\\</span></span> | <span data-ttu-id="9c9a0-406">Datos del usuario 2</span><span class="sxs-lookup"><span data-stu-id="9c9a0-406">User data 2</span></span>

<span data-ttu-id="9c9a0-407">Como D: es la primera unidad disponible en la lista, Azure la asigna al volumen de almacenamiento temporal.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-407">Because D: is the first drive letter from available the list, Azure assigns D: to the temporary storage volume.</span></span> <span data-ttu-id="9c9a0-408">Para todos los discos replicados, la unidad permanece igual.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-408">For all the replicated disks, the drive letter remains the same.</span></span> <span data-ttu-id="9c9a0-409">Dado que el disco de G: no está disponible, el sistema usará la unidad C: para el archivo de paginación.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-409">Because the G: disk is not available, the system will use the C: drive for the paging file.</span></span>

<span data-ttu-id="9c9a0-410">Esta es la configuración del archivo de paginación en la máquina virtual de Azure:</span><span class="sxs-lookup"><span data-stu-id="9c9a0-410">Here are the paging file settings on the Azure virtual machine:</span></span>

![Configuración del archivo de paginación en la máquina virtual de Azure](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover-2.png)

## <a name="next-steps"></a><span data-ttu-id="9c9a0-412">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="9c9a0-412">Next steps</span></span>
<span data-ttu-id="9c9a0-413">Después de que la implementación esté configurada y en ejecución, [obtenga más información](site-recovery-failover.md) sobre los diferentes tipos de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="9c9a0-413">After your deployment is set up and running, [learn more](site-recovery-failover.md) about different types of failover.</span></span>
