---
title: "Conmutación por error de prueba (VMM a VMM) en Azure Site Recovery | Microsoft Docs"
description: "Azure Site Recovery coordina la replicación, la conmutación por error y la recuperación de máquinas virtuales y servidores físicos. Obtenga información acerca de la conmutación por error en Azure o en un centro de datos secundario."
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 06/05/2017
ms.author: pratshar
ms.openlocfilehash: afc4790d5714ce7145c8f4291a05acc2e9882a9b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="test-failover-vmm-to-vmm-in-site-recovery"></a><span data-ttu-id="e47c2-104">Conmutación por error de prueba (VMM a VMM) en Site Recovery</span><span class="sxs-lookup"><span data-stu-id="e47c2-104">Test failover (VMM to VMM) in Site Recovery</span></span>


<span data-ttu-id="e47c2-105">En este artículo se proporcionan información e instrucciones para realizar una conmutación por error de prueba o una exploración de recuperación ante desastres de máquinas virtuales y servidores físicos protegidos con Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="e47c2-105">This article provides information and instructions for doing a test failover or a disaster recovery (DR) drill of virtual machines (VMs) and physical servers that are protected with Azure Site Recovery.</span></span> <span data-ttu-id="e47c2-106">Deberá usar un sitio administrado de System Center Virtual Machine Manager (VMM) local como sitio de recuperación.</span><span class="sxs-lookup"><span data-stu-id="e47c2-106">You'll use a System Center Virtual Machine Manager (VMM)-managed on-premises site as the recovery site.</span></span>

<span data-ttu-id="e47c2-107">La conmutación por error de prueba se ejecuta para validar la estrategia de replicación o para realizar una exploración de la recuperación ante desastres sin perder datos ni tiempo de actividad.</span><span class="sxs-lookup"><span data-stu-id="e47c2-107">You run a test failover to validate your replication strategy or perform a DR drill without any data loss or downtime.</span></span> <span data-ttu-id="e47c2-108">La conmutación por error de prueba no afecta a la replicación en curso ni al entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="e47c2-108">A test failover doesn't have any impact on the ongoing replication or on your production environment.</span></span> <span data-ttu-id="e47c2-109">Puede ejecutarla en una máquina virtual o en un [plan de recuperación](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="e47c2-109">You can run it on either a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="e47c2-110">Al desencadenar una conmutación por error de prueba, debe especificar la red a la que deben conectarse las máquinas virtuales de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-110">When you're triggering a test failover, you need to specify the network that the test virtual machines will connect to.</span></span> <span data-ttu-id="e47c2-111">Puede seguir el progreso de la conmutación por error de prueba en la página **Trabajos**.</span><span class="sxs-lookup"><span data-stu-id="e47c2-111">You can track the progress of the test failover on the **Jobs** page.</span></span>  

<span data-ttu-id="e47c2-112">Si tiene cualquier comentario o pregunta, publíquelos en la parte inferior de este artículo o en el [foro de Azure Recovery Services](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="e47c2-112">If you have any comments or questions, post them at the bottom of this article or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="prepare-the-infrastructure-for-test-failover"></a><span data-ttu-id="e47c2-113">Preparación de la infraestructura para la conmutación por error de prueba</span><span class="sxs-lookup"><span data-stu-id="e47c2-113">Prepare the infrastructure for test failover</span></span>
<span data-ttu-id="e47c2-114">Si desea ejecutar una conmutación por error de prueba con una red existente, prepare Active Directory, DHCP y DNS en esa red.</span><span class="sxs-lookup"><span data-stu-id="e47c2-114">If you want to run a test failover by using an existing network, prepare Active Directory, DHCP, and DNS in that network.</span></span>

<span data-ttu-id="e47c2-115">Si desea ejecutar una conmutación por error de prueba mediante la creación automática de redes de máquinas virtuales, agregue un paso manual antes del grupo 1 en el plan de recuperación que vaya a utilizar para la prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-115">If you want to run a test failover by using the option to create VM networks automatically, add a manual step before Group-1 in the recovery plan that you’re going to use for the test failover.</span></span> <span data-ttu-id="e47c2-116">A continuación, agregue los recursos de infraestructura a la red creada automáticamente antes de ejecutar la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-116">Then, add the infrastructure resources to the automatically created network before you run the test failover.</span></span>

### <a name="things-to-note"></a><span data-ttu-id="e47c2-117">Puntos a tener en cuenta</span><span class="sxs-lookup"><span data-stu-id="e47c2-117">Things to note</span></span>
<span data-ttu-id="e47c2-118">Cuando se replica a un sitio secundario, no es necesario que el tipo de red que utiliza la máquina de réplica coincida con el tipo de red lógica que se usa para la conmutación por error de prueba; sin embargo, es posible que algunas combinaciones no funcionen.</span><span class="sxs-lookup"><span data-stu-id="e47c2-118">When you're replicating to a secondary site, the type of network that the replica machine uses doesn’t need to match the type of logical network used for test failover, but some combinations might not work.</span></span> <span data-ttu-id="e47c2-119">Si la réplica utiliza DHCP y aislamiento basado en VLAN, la red de máquina virtual para la réplica no necesita un grupo de direcciones IP estáticas.</span><span class="sxs-lookup"><span data-stu-id="e47c2-119">If the replica uses DHCP and VLAN-based isolation, the VM network for the replica doesn't need a static IP address pool.</span></span> <span data-ttu-id="e47c2-120">Por lo tanto, el uso de la virtualización de red de Windows para la conmutación por error de prueba no funcionaría, ya que no hay grupos de direcciones disponibles.</span><span class="sxs-lookup"><span data-stu-id="e47c2-120">So using Windows Network Virtualization for the test failover won't work because no address pools are available.</span></span> 

<span data-ttu-id="e47c2-121">Además, la conmutación por error de prueba no funcionará si la red de réplica no tiene aislamiento y la red de prueba utiliza la virtualización de red de Windows.</span><span class="sxs-lookup"><span data-stu-id="e47c2-121">In addition, the test failover won't work if the replica network uses no isolation and the test network uses Windows Network Virtualization.</span></span> <span data-ttu-id="e47c2-122">Esto se debe a que una red sin aislamiento no tiene las subredes necesarias para crear una red de virtualización de red de Windows.</span><span class="sxs-lookup"><span data-stu-id="e47c2-122">This is because the no-isolation network doesn't have the subnets required to create a Windows Network Virtualization network.</span></span>

<span data-ttu-id="e47c2-123">La manera en que las máquinas virtuales de réplica se conectan a las redes de máquinas virtuales asignadas después de la conmutación por error depende de cómo se configure la red de máquinas virtuales en la consola VMM.</span><span class="sxs-lookup"><span data-stu-id="e47c2-123">How replica virtual machines are connected to mapped VM networks after failover depends on how the VM network is configured in the VMM console.</span></span>

#### <a name="vm-network-configured-with-no-isolation-or-vlan-isolation"></a><span data-ttu-id="e47c2-124">Red de máquinas virtuales configurada sin aislamiento o con aislamiento de VLAN</span><span class="sxs-lookup"><span data-stu-id="e47c2-124">VM network configured with no isolation or VLAN isolation</span></span>
<span data-ttu-id="e47c2-125">Si se define DHCP para la red de máquinas virtuales, la máquina virtual de réplica se conectará al identificador de VLAN mediante la configuración especificada para el sitio de red en la red lógica asociada.</span><span class="sxs-lookup"><span data-stu-id="e47c2-125">If DHCP is defined for the VM network, the replica virtual machine is connected to the VLAN ID through the settings that are specified for the network site in the associated logical network.</span></span> <span data-ttu-id="e47c2-126">La máquina virtual recibe su dirección IP del servidor DHCP disponible.</span><span class="sxs-lookup"><span data-stu-id="e47c2-126">The virtual machine receives its IP address from the available DHCP server.</span></span> 

<span data-ttu-id="e47c2-127">No es necesario definir un grupo de direcciones IP estáticas para la red de máquinas virtuales de destino.</span><span class="sxs-lookup"><span data-stu-id="e47c2-127">You don't need to define a static IP address pool for the target VM network.</span></span> <span data-ttu-id="e47c2-128">Si se utiliza un grupo de direcciones IP estáticas para la red de máquinas virtuales, la máquina virtual de réplica se conecta al identificador de VLAN mediante la configuración especificada para el sitio de red en la red lógica asociada.</span><span class="sxs-lookup"><span data-stu-id="e47c2-128">If a static IP address pool is used for the VM network, the replica virtual machine is connected to the VLAN ID through the settings that are specified for the network site in the associated logical network.</span></span>

<span data-ttu-id="e47c2-129">La máquina virtual recibe su dirección IP del grupo definido para la red de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="e47c2-129">The virtual machine receives its IP address from the pool that's defined for the VM network.</span></span> <span data-ttu-id="e47c2-130">Si no se ha definido un grupo de direcciones IP estáticas en la red de máquina virtual de destino, se producirá un error en la asignación de direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="e47c2-130">If a static IP address pool isn't defined on the target VM network, IP address allocation will fail.</span></span> <span data-ttu-id="e47c2-131">Cree el grupo de direcciones IP en los servidores VMM de origen y de destino que se vayan a usar para la protección y la recuperación.</span><span class="sxs-lookup"><span data-stu-id="e47c2-131">Create the IP address pool on both the source and target VMM servers that you will use for protection and recovery.</span></span>

#### <a name="vm-network-with-windows-network-virtualization"></a><span data-ttu-id="e47c2-132">Red de máquinas virtuales con virtualización de red de Windows</span><span class="sxs-lookup"><span data-stu-id="e47c2-132">VM network with Windows Network Virtualization</span></span>
<span data-ttu-id="e47c2-133">Si se establece una red de máquinas virtuales con virtualización de red de Windows, debe definirse un grupo estático para la red de máquinas virtuales de destino, independientemente de si la red de máquinas virtuales de origen se ha configurado para DHCP o un grupo de direcciones IP estáticas.</span><span class="sxs-lookup"><span data-stu-id="e47c2-133">If a VM network is configured with Windows Network Virtualization, you should define a static pool for the target VM network, regardless of whether the source VM network is configured to use DHCP or a static IP address pool.</span></span> 

<span data-ttu-id="e47c2-134">Si se define DHCP, el servidor VMM de destino actúa como servidor DHCP e indica una dirección IP del grupo definido para la red de máquinas virtuales de destino.</span><span class="sxs-lookup"><span data-stu-id="e47c2-134">If you define DHCP, the target VMM server acts as a DHCP server and provides an IP address from the pool that's defined for the target VM network.</span></span> <span data-ttu-id="e47c2-135">Si se define el uso de un grupo de direcciones IP estáticas para el servidor de origen, el servidor VMM de destino asigna una dirección IP del grupo.</span><span class="sxs-lookup"><span data-stu-id="e47c2-135">If use of a static IP address pool is defined for the source server, the target VMM server allocates an IP address from the pool.</span></span> <span data-ttu-id="e47c2-136">En ambos casos, se producirá un error en la asignación de direcciones IP si no se define un grupo de direcciones IP estáticas.</span><span class="sxs-lookup"><span data-stu-id="e47c2-136">In both cases, IP address allocation will fail if a static IP address pool is not defined.</span></span>


### <a name="prepare-dhcp"></a><span data-ttu-id="e47c2-137">Preparación de DHCP</span><span class="sxs-lookup"><span data-stu-id="e47c2-137">Prepare DHCP</span></span>
<span data-ttu-id="e47c2-138">Si las máquinas virtuales implicadas en la conmutación por error de prueba usan DHCP, cree un servidor DHCP de prueba dentro de la red aislada para la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-138">If the virtual machines involved in test failover use DHCP, create a test DHCP server within the isolated network for the purpose of test failover.</span></span>

### <a name="prepare-active-directory"></a><span data-ttu-id="e47c2-139">Preparación de Active Directory</span><span class="sxs-lookup"><span data-stu-id="e47c2-139">Prepare Active Directory</span></span>
<span data-ttu-id="e47c2-140">Para ejecutar una conmutación por error de prueba con el fin de probar la aplicación, necesita una copia del entorno de Active Directory de producción en el entorno de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-140">To run a test failover for application testing, you need a copy of the production Active Directory environment in your test environment.</span></span> <span data-ttu-id="e47c2-141">Para más información, consulte las [consideraciones sobre la conmutación por error de prueba para Active Directory](site-recovery-active-directory.md#test-failover-considerations).</span><span class="sxs-lookup"><span data-stu-id="e47c2-141">For more information, review the [test failover considerations for Active Directory](site-recovery-active-directory.md#test-failover-considerations).</span></span>

### <a name="prepare-dns"></a><span data-ttu-id="e47c2-142">Preparación de DNS</span><span class="sxs-lookup"><span data-stu-id="e47c2-142">Prepare DNS</span></span>
<span data-ttu-id="e47c2-143">Prepare un servidor DNS para la conmutación por error de prueba de la forma siguiente:</span><span class="sxs-lookup"><span data-stu-id="e47c2-143">Prepare a DNS server for the test failover as follows:</span></span>

* <span data-ttu-id="e47c2-144">**DHCP**: si las máquinas virtuales usan DHCP, debe actualizarse la dirección IP del DNS de prueba en el servidor DHCP de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-144">**DHCP**: If virtual machines use DHCP, the IP address of the test DNS should be updated on the test DHCP server.</span></span> <span data-ttu-id="e47c2-145">Si utiliza un tipo de red de virtualización de red de Windows, el servidor VMM actúa como servidor DHCP.</span><span class="sxs-lookup"><span data-stu-id="e47c2-145">If you’re using a network type of Windows Network Virtualization, the VMM server acts as the DHCP server.</span></span> <span data-ttu-id="e47c2-146">Por lo tanto, la dirección IP de DNS debe actualizarse en la red de conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-146">Therefore, the IP address of DNS should be updated in the test failover network.</span></span> <span data-ttu-id="e47c2-147">En este caso, las máquinas virtuales se registran a sí mismas en el servidor DNS correspondiente.</span><span class="sxs-lookup"><span data-stu-id="e47c2-147">In this case, the virtual machines register themselves to the relevant DNS server.</span></span>
* <span data-ttu-id="e47c2-148">**Dirección estática**: si las máquinas virtuales utilizan una dirección IP estática, la dirección IP del servidor DNS de prueba debe actualizarse en la red de conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-148">**Static address**: If virtual machines use a static IP address, the IP address of the test DNS server should be updated in test failover network.</span></span> <span data-ttu-id="e47c2-149">Es  posible que deba actualizar el DNS con la dirección IP de las máquinas virtuales de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-149">You might need to update DNS with the IP address of the test virtual machines.</span></span> <span data-ttu-id="e47c2-150">Puede usar el siguiente script de ejemplo para este propósito:</span><span class="sxs-lookup"><span data-stu-id="e47c2-150">You can use the following sample script for this purpose:</span></span>

        Param(
        [string]$Zone,
        [string]$name,
        [string]$IP
        )
        $Record = Get-DnsServerResourceRecord -ZoneName $zone -Name $name
        $newrecord = $record.clone()
        $newrecord.RecordData[0].IPv4Address  =  $IP
        Set-DnsServerResourceRecord -zonename $zone -OldInputObject $record -NewInputObject $Newrecord



## <a name="run-a-test-failover"></a><span data-ttu-id="e47c2-151">Ejecución de una conmutación por error de prueba</span><span class="sxs-lookup"><span data-stu-id="e47c2-151">Run a test failover</span></span>
<span data-ttu-id="e47c2-152">En este procedimiento se describe cómo ejecutar una conmutación por error de prueba para un plan de recuperación.</span><span class="sxs-lookup"><span data-stu-id="e47c2-152">This procedure describes how to run a test failover for a recovery plan.</span></span> <span data-ttu-id="e47c2-153">También puede ejecutar la conmutación por error para una única máquina virtual en la pestaña **Máquinas virtuales**.</span><span class="sxs-lookup"><span data-stu-id="e47c2-153">Alternatively, you can run the failover for a single virtual machine on the **Virtual Machines** tab.</span></span>

![Hoja de la conmutación por error de prueba](./media/site-recovery-test-failover-vmm-to-vmm/TestFailover.png)

1. <span data-ttu-id="e47c2-155">Seleccione **Recovery Plans** > *nombreDePlanDeRecuperación*.</span><span class="sxs-lookup"><span data-stu-id="e47c2-155">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="e47c2-156">Haga clic en **Conmutación por error** > **Test Conmutación por error**.</span><span class="sxs-lookup"><span data-stu-id="e47c2-156">Click **Failover** > **Test Failover**.</span></span>
1. <span data-ttu-id="e47c2-157">En la hoja **Conmutación por error de prueba**, especifique cómo se deben conectar las máquinas virtuales a las redes después de la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-157">On the **Test Failover** blade, specify how virtual machines should be connected to networks after the test failover.</span></span> <span data-ttu-id="e47c2-158">Para más información, consulte las [opciones de red](#network-options-in-site-recovery).</span><span class="sxs-lookup"><span data-stu-id="e47c2-158">For more information, see the [network options](#network-options-in-site-recovery).</span></span>
1. <span data-ttu-id="e47c2-159">Realice el seguimiento del progreso de la conmutación por error en la pestaña **Trabajos** .</span><span class="sxs-lookup"><span data-stu-id="e47c2-159">Track failover progress on the **Jobs** tab.</span></span>
1. <span data-ttu-id="e47c2-160">Cuando haya terminado la conmutación por error, compruebe que las máquinas virtuales se inician correctamente.</span><span class="sxs-lookup"><span data-stu-id="e47c2-160">After failover is complete, verify that the virtual machines start successfully.</span></span>
1. <span data-ttu-id="e47c2-161">Cuando haya terminado, haga clic en **Cleanup test failover** (Limpieza de conmutación por error de prueba) en el plan de recuperación.</span><span class="sxs-lookup"><span data-stu-id="e47c2-161">When you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="e47c2-162">En **Notas**, registre y guarde las observaciones asociadas a la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-162">In **Notes**, record and save any observations associated with the test failover.</span></span> <span data-ttu-id="e47c2-163">En este paso se eliminan las máquinas virtuales y las redes que se crearon durante la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-163">This step deletes the virtual machines and networks that were created during test failover.</span></span>


## <a name="network-options-in-site-recovery"></a><span data-ttu-id="e47c2-164">Opciones de red en Site Recovery</span><span class="sxs-lookup"><span data-stu-id="e47c2-164">Network options in Site Recovery</span></span>

<span data-ttu-id="e47c2-165">Al ejecutar una conmutación por error de prueba se le pide que seleccione la configuración de red de las máquinas de réplica de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-165">When you run a test failover, you're asked to select network settings for test replica machines.</span></span> <span data-ttu-id="e47c2-166">Existen varias opciones.</span><span class="sxs-lookup"><span data-stu-id="e47c2-166">You have multiple options.</span></span>  

| <span data-ttu-id="e47c2-167">**Opción de conmutación por error de prueba**</span><span class="sxs-lookup"><span data-stu-id="e47c2-167">**Test failover option**</span></span> | <span data-ttu-id="e47c2-168">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="e47c2-168">**Description**</span></span> | <span data-ttu-id="e47c2-169">**Verificación de la conmutación por error**</span><span class="sxs-lookup"><span data-stu-id="e47c2-169">**Failover check**</span></span> | <span data-ttu-id="e47c2-170">**Detalles**</span><span class="sxs-lookup"><span data-stu-id="e47c2-170">**Details**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e47c2-171">**Fail over to a secondary VMM site--without network** (Conmutación por error a un sitio secundario de VMM, sin red)</span><span class="sxs-lookup"><span data-stu-id="e47c2-171">**Fail over to a secondary VMM site--without network**</span></span> |<span data-ttu-id="e47c2-172">No seleccione una red de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="e47c2-172">Don't select a VM network.</span></span> |<span data-ttu-id="e47c2-173">La conmutación por error comprueba que se crean las máquinas de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-173">Failover checks that test machines are created.</span></span><br/><br/><span data-ttu-id="e47c2-174">La máquina virtual de prueba se crea en el host donde existe la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-174">The test virtual machine is created on the host where the replica virtual machine exists.</span></span> <span data-ttu-id="e47c2-175">No se agrega a la nube en la que se encuentra la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-175">It isn’t added to the cloud where the replica virtual machine is located.</span></span> |<p><span data-ttu-id="e47c2-176">La máquina que ha conmutado por error no se conecta a ninguna red.</span><span class="sxs-lookup"><span data-stu-id="e47c2-176">The failed-over machine isn’t connected to any network.</span></span><br/><br/><span data-ttu-id="e47c2-177">La máquina puede conectarse a una red de máquinas virtuales una vez creada.</span><span class="sxs-lookup"><span data-stu-id="e47c2-177">The machine can be connected to a VM network after it has been created.</span></span> |
| <span data-ttu-id="e47c2-178">**Fail over to a secondary VMM site--with network** (Conmutación por error a un sitio secundario de VMM, con red)</span><span class="sxs-lookup"><span data-stu-id="e47c2-178">**Fail over to a secondary VMM site--with network**</span></span> |<span data-ttu-id="e47c2-179">Seleccione una red de máquinas virtuales existente.</span><span class="sxs-lookup"><span data-stu-id="e47c2-179">Select an existing VM network.</span></span> |<span data-ttu-id="e47c2-180">La conmutación por error comprueba que se crean las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="e47c2-180">Failover checks that virtual machines are created.</span></span> |<span data-ttu-id="e47c2-181">La máquina virtual de prueba se crea en el host donde existe la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-181">The test virtual machine is created on the host where the replica virtual machine exists.</span></span> <span data-ttu-id="e47c2-182">No se agrega a la nube en la que se encuentra la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-182">It isn’t added to the cloud where the replica virtual machine is located.</span></span><br/><br/><span data-ttu-id="e47c2-183">Cree una red de máquinas virtuales aislada de la red de producción.</span><span class="sxs-lookup"><span data-stu-id="e47c2-183">Create a VM network that's isolated from your production network.</span></span><br/><br/><span data-ttu-id="e47c2-184">Si utiliza una red basada en VLAN, se recomienda crear una red lógica independiente en VMM para este propósito (no se utiliza en producción).</span><span class="sxs-lookup"><span data-stu-id="e47c2-184">If you're using a VLAN-based network, we recommend that you create a separate logical network (not used in production) in VMM for this purpose.</span></span> <span data-ttu-id="e47c2-185">Esta red lógica se utiliza para crear redes de máquinas virtuales para la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-185">This logical network is used to create VM networks for test failovers.</span></span><br/><br/><span data-ttu-id="e47c2-186">La red lógica debe asociarse con al menos uno de los adaptadores de red de todos los servidores de Hyper-V que hospeden máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="e47c2-186">The logical network should be associated with at least one of the network adapters of all the Hyper-V servers that are hosting virtual machines.</span></span><br/><br/><span data-ttu-id="e47c2-187">En el caso de las redes lógicas de VLAN, deben aislarse los sitios de red que agregue a la red lógica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-187">For VLAN logical networks, the network sites that you add to the logical network should be isolated.</span></span><br/><br/><span data-ttu-id="e47c2-188">Si utiliza una red lógica basada en virtualización de red de Windows, Azure Site Recovery crea automáticamente redes de máquinas virtuales aisladas.</span><span class="sxs-lookup"><span data-stu-id="e47c2-188">If you’re using a Windows Network Virtualization–based logical network, Azure Site Recovery automatically creates isolated VM networks.</span></span> |
| <span data-ttu-id="e47c2-189">**Fail over to a secondary VMM site--create a network** (Conmutación por error a un sitio secundario de VMM, crear red)</span><span class="sxs-lookup"><span data-stu-id="e47c2-189">**Fail over to a secondary VMM site--create a network**</span></span> |<span data-ttu-id="e47c2-190">Se crea automáticamente una red de prueba temporal en función de la configuración especificada en **Red lógica** y de sus sitios de red asociados.</span><span class="sxs-lookup"><span data-stu-id="e47c2-190">A temporary test network is created automatically based on the setting that you specify in **Logical Network** and its related network sites.</span></span> |<span data-ttu-id="e47c2-191">La conmutación por error comprueba que se crean las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="e47c2-191">Failover checks that virtual machines are created.</span></span> |<span data-ttu-id="e47c2-192">Utilice esta opción si el plan de recuperación usa más de una red de VM.</span><span class="sxs-lookup"><span data-stu-id="e47c2-192">Use this option if the recovery plan uses more than one VM network.</span></span> <span data-ttu-id="e47c2-193">Si utiliza redes de virtualización de red de Windows, esta opción permite crear automáticamente redes de máquinas virtuales con la misma configuración (subredes y grupos de direcciones IP) en la red de la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-193">If you're using Windows Network Virtualization networks, this option can automatically create VM networks with the same settings (subnets and IP address pools) in the network of the replica virtual machine.</span></span> <span data-ttu-id="e47c2-194">Estas redes de máquinas virtuales se limpian automáticamente una vez completada la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-194">These VM networks are cleaned up automatically after the test failover is complete.</span></span></p><p><span data-ttu-id="e47c2-195">La máquina virtual de prueba se crea en el host donde existe la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-195">The test virtual machine is created on the host where the replica virtual machine exists.</span></span> <span data-ttu-id="e47c2-196">No se agrega a la nube en la que se encuentra la máquina virtual de réplica.</span><span class="sxs-lookup"><span data-stu-id="e47c2-196">It isn’t added to the cloud where the replica virtual machine is located.</span></span> |

> [!TIP]
> <span data-ttu-id="e47c2-197">La dirección IP que se asigna a una máquina virtual durante la conmutación por error de prueba es la misma que obtendría la máquina virtual al realizar una conmutación por error planeada o no planeada (siempre que la dirección IP esté disponible en la red de conmutación por error de prueba).</span><span class="sxs-lookup"><span data-stu-id="e47c2-197">The IP address given to a virtual machine during test failover is the same IP address that the virtual machine would receive for a planned or unplanned failover (presuming that the IP address is available in the test failover network).</span></span> <span data-ttu-id="e47c2-198">Si la misma dirección IP no está disponible en la red de conmutación por error de prueba, la máquina virtual recibe otra dirección IP que esté disponible en la red de conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-198">If the same IP address isn't available in the test failover network, the virtual machine receives another IP address that's available in the test failover network.</span></span>
>
>


## <a name="test-failover-to-a-production-network-on-a-recovery-site"></a><span data-ttu-id="e47c2-199">Conmutación por error de prueba a una red de producción en un sitio de recuperación</span><span class="sxs-lookup"><span data-stu-id="e47c2-199">Test failover to a production network on a recovery site</span></span>
<span data-ttu-id="e47c2-200">Se recomienda que, al realizar una conmutación por error de prueba, elija una red diferente de la del sitio de recuperación de producción que proporcionara en la [asignación de red](https://docs.microsoft.com/azure/site-recovery/site-recovery-network-mapping).</span><span class="sxs-lookup"><span data-stu-id="e47c2-200">We recommend that when you're doing a test failover, you choose a network that is different from your production recovery site network that you provided in [network mapping](https://docs.microsoft.com/azure/site-recovery/site-recovery-network-mapping).</span></span> <span data-ttu-id="e47c2-201">Sin embargo, si realmente desea validar la conectividad de un extremo a otro de la red en una máquina virtual que se ha conmutado por error, tenga en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e47c2-201">But if you really want to validate end-to-end network connectivity in a failed-over virtual machine, note the following points:</span></span>

* <span data-ttu-id="e47c2-202">Asegúrese de que la máquina virtual principal está apagada al realizar la conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-202">Make sure that the primary virtual machine is shut down when you're doing the test failover.</span></span> <span data-ttu-id="e47c2-203">Si no lo hace, dos máquinas virtuales con la misma identidad se ejecutarán en la misma red al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="e47c2-203">If you don't, two virtual machines with the same identity will be running in the same network at the same time.</span></span> <span data-ttu-id="e47c2-204">Esta situación puede provocar consecuencias no deseadas.</span><span class="sxs-lookup"><span data-stu-id="e47c2-204">That situation can lead to undesired consequences.</span></span>
* <span data-ttu-id="e47c2-205">Al limpiar las máquinas virtuales de conmutación por error de prueba, se perderán los cambios realizados en las máquinas virtuales de conmutación por error de prueba.</span><span class="sxs-lookup"><span data-stu-id="e47c2-205">Any changes that you make to the test failover virtual machines are lost when you clean up the test failover virtual machines.</span></span> <span data-ttu-id="e47c2-206">Estos cambios no se replican en la máquina virtual principal.</span><span class="sxs-lookup"><span data-stu-id="e47c2-206">These changes are not replicated back to the primary virtual machine.</span></span>
* <span data-ttu-id="e47c2-207">Esta forma de realizar pruebas provoca un tiempo de inactividad de la aplicación de producción.</span><span class="sxs-lookup"><span data-stu-id="e47c2-207">This way of doing testing leads to downtime for your production application.</span></span> <span data-ttu-id="e47c2-208">Solicite a los usuarios de la aplicación que no la usen con la exploración de la recuperación ante desastres en curso.</span><span class="sxs-lookup"><span data-stu-id="e47c2-208">Ask users of the application not to use the application when the DR drill is in progress.</span></span>  


## <a name="next-steps"></a><span data-ttu-id="e47c2-209">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="e47c2-209">Next steps</span></span>
<span data-ttu-id="e47c2-210">Después de ejecutar correctamente una conmutación por error de prueba, puede intentar una [conmutación por error](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="e47c2-210">After you have successfully run a test failover, you can try a [failover](site-recovery-failover.md).</span></span>
