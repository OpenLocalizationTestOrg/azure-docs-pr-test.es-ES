---
title: "arquitectura de hello aaaReview para VMware replicación tooAzure | Documentos de Microsoft"
description: "Este artículo proporciona información general de componentes y arquitectura que se usa cuando se replican local tooAzure de máquinas virtuales VMware con hello servicio Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27.017
ms.author: raynew
ms.openlocfilehash: 7acb1d8e83a846dca79e175fd1af9324f2c31e65
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-vmware-replication-tooazure"></a><span data-ttu-id="f3795-103">Paso 1: Revisar la arquitectura de Hola para tooAzure de replicación de VMware</span><span class="sxs-lookup"><span data-stu-id="f3795-103">Step 1: Review hello architecture for VMware replication tooAzure</span></span>

<span data-ttu-id="f3795-104">Este artículo describen los componentes de Hola y procesos que se utilizan al replicar locales tooAzure de máquinas virtuales de VMware con hello [Azure Site Recovery](site-recovery-overview.md) servicio.</span><span class="sxs-lookup"><span data-stu-id="f3795-104">This article describes hello components and processes used when replicating on-premises VMware virtual machines tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="f3795-105">Registrar los comentarios de la parte inferior de Hola de este artículo, o formular alguna pregunta en hello [foro de servicios de recuperación de Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="f3795-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="f3795-106">Componentes de la arquitectura</span><span class="sxs-lookup"><span data-stu-id="f3795-106">Architectural components</span></span>

<span data-ttu-id="f3795-107">tabla de Hello resume componentes Hola que necesita.</span><span class="sxs-lookup"><span data-stu-id="f3795-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="f3795-108">**Componente**</span><span class="sxs-lookup"><span data-stu-id="f3795-108">**Component**</span></span> | <span data-ttu-id="f3795-109">**Requisito**</span><span class="sxs-lookup"><span data-stu-id="f3795-109">**Requirement**</span></span> | <span data-ttu-id="f3795-110">**Detalles**</span><span class="sxs-lookup"><span data-stu-id="f3795-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="f3795-111">**Las tablas de Azure**</span><span class="sxs-lookup"><span data-stu-id="f3795-111">**Azure**</span></span> | <span data-ttu-id="f3795-112">Necesita una suscripción de Azure, una cuenta de Azure Storage y una red de Azure.</span><span class="sxs-lookup"><span data-stu-id="f3795-112">You need an Azure subscription, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="f3795-113">Los datos replicados se almacenan en la cuenta de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="f3795-113">Replicated data is stored in hello storage account.</span></span> <span data-ttu-id="f3795-114">Máquinas virtuales de Azure se crean con datos saludo replican Cuando se produce la conmutación por error desde el sitio local.</span><span class="sxs-lookup"><span data-stu-id="f3795-114">Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="f3795-115">Hola máquinas virtuales de Azure Conéctese toohello red virtual de Azure cuando se crean.</span><span class="sxs-lookup"><span data-stu-id="f3795-115">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="f3795-116">**Servidor de configuración**</span><span class="sxs-lookup"><span data-stu-id="f3795-116">**Configuration server**</span></span> | <span data-ttu-id="f3795-117">Un único servidor de administración (VMware VM) que se ejecuta todos los Hola local componentes de Site Recovery para la implementación de hello en local.</span><span class="sxs-lookup"><span data-stu-id="f3795-117">A single on-premises management server (VMware VM) that runs all hello on-premises Site Recovery components for hello deployment.</span></span> <span data-ttu-id="f3795-118">Estos incluyen un servidor de configuración, un servidor de procesos y un servidor de destino maestro.</span><span class="sxs-lookup"><span data-stu-id="f3795-118">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="f3795-119">componente de servidor de configuración de Hello coordina las comunicaciones entre local y Azure y administra la replicación de datos.</span><span class="sxs-lookup"><span data-stu-id="f3795-119">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="f3795-120">**Servidor de proceso**:</span><span class="sxs-lookup"><span data-stu-id="f3795-120">**Process server**:</span></span>  | <span data-ttu-id="f3795-121">Se instala de forma predeterminada en el servidor de configuración de Hola.</span><span class="sxs-lookup"><span data-stu-id="f3795-121">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="f3795-122">Actúa como puerta de enlace de replicación.</span><span class="sxs-lookup"><span data-stu-id="f3795-122">Acts as a replication gateway.</span></span> <span data-ttu-id="f3795-123">Recibe datos de replicación, optimiza con almacenamiento en caché, la compresión y cifrado y lo envía tooAzure almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="f3795-123">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="f3795-124">servidor de procesos de Hello también controla la instalación de inserción de las máquinas de tooprotected de servicio de movilidad de Hola y realiza la detección automática de máquinas virtuales de VMware.</span><span class="sxs-lookup"><span data-stu-id="f3795-124">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="f3795-125">A medida que crece la implementación puede agregar toohandle de servidores adicionales proceso dedicado independiente aumentar volúmenes de tráfico de replicación.</span><span class="sxs-lookup"><span data-stu-id="f3795-125">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="f3795-126">**Servidor de destino principal**</span><span class="sxs-lookup"><span data-stu-id="f3795-126">**Master target server**</span></span> | <span data-ttu-id="f3795-127">Se instala de forma predeterminada en el servidor de configuración local de Hola.</span><span class="sxs-lookup"><span data-stu-id="f3795-127">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="f3795-128">Controla los datos de replicación durante la conmutación por recuperación desde Azure.</span><span class="sxs-lookup"><span data-stu-id="f3795-128">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="f3795-129">Si los volúmenes de tráfico de la conmutación por recuperación son altos, puede implementar un servidor de destino maestro independiente para la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="f3795-129">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="f3795-130">**Servidores de VMware**</span><span class="sxs-lookup"><span data-stu-id="f3795-130">**VMware servers**</span></span> | <span data-ttu-id="f3795-131">Máquinas virtuales de VMware se hospedan en servidores de vSphere ESXi y se recomienda un vCenter hosts de servidor toomanage Hola.</span><span class="sxs-lookup"><span data-stu-id="f3795-131">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="f3795-132">Agregue el almacén de servicios de recuperación de tooyour de servidores de VMware.</span><span class="sxs-lookup"><span data-stu-id="f3795-132">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="f3795-133">**Máquinas replicadas**</span><span class="sxs-lookup"><span data-stu-id="f3795-133">**Replicated machines**</span></span> | <span data-ttu-id="f3795-134">servicio de movilidad de Hola se instalará en cada VM de VMware que replica.</span><span class="sxs-lookup"><span data-stu-id="f3795-134">hello Mobility service will be installed on each VMware VM you replicate.</span></span> <span data-ttu-id="f3795-135">Se puede instalar manualmente en cada equipo o con una instalación de inserción Hola del servidor de procesos.</span><span class="sxs-lookup"><span data-stu-id="f3795-135">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="f3795-136">**Figura 1: VMware tooAzure componentes**</span><span class="sxs-lookup"><span data-stu-id="f3795-136">**Figure 1: VMware tooAzure components**</span></span>

![Componentes](./media/vmware-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="f3795-138">Proceso de replicación</span><span class="sxs-lookup"><span data-stu-id="f3795-138">Replication process</span></span>

1. <span data-ttu-id="f3795-139">Configurar la implementación de hello, incluidos los componentes de Azure y local.</span><span class="sxs-lookup"><span data-stu-id="f3795-139">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="f3795-140">En el almacén de servicios de recuperación de hello, especificar origen de replicación de Hola y de destino, configurar el servidor de configuración de hello, crear una directiva de replicación, implementación el servicio de movilidad de hello, habilitan la replicación y ejecutan una prueba de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="f3795-140">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2. <span data-ttu-id="f3795-141">Replicar máquinas con arreglo a la directiva de replicación de hello y una copia inicial de datos de hello es almacenamiento tooAzure replicada.</span><span class="sxs-lookup"><span data-stu-id="f3795-141">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
3. <span data-ttu-id="f3795-142">Una vez finalizada la replicación inicial, comienza la replicación de diferencias cambios tooAzure.</span><span class="sxs-lookup"><span data-stu-id="f3795-142">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="f3795-143">Las marcas de revisión de una máquina se conservan en un archivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="f3795-143">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="f3795-144">Replicación de máquinas comunican con el servidor de configuración de hello en el puerto HTTPS 443 entrante para la administración de replicación.</span><span class="sxs-lookup"><span data-stu-id="f3795-144">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="f3795-145">Replicación máquinas envían servidor de procesos de toohello de datos de replicación en el puerto HTTPS 9443 entrante (pueden modificarse).</span><span class="sxs-lookup"><span data-stu-id="f3795-145">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="f3795-146">servidor de configuración de Hello organiza la administración de la replicación con Azure en el puerto HTTPS 443 saliente.</span><span class="sxs-lookup"><span data-stu-id="f3795-146">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="f3795-147">servidor de procesos de Hello recibe datos de máquinas de origen, optimiza y cifra y lo envía tooAzure almacenamiento en el puerto 443 saliente.</span><span class="sxs-lookup"><span data-stu-id="f3795-147">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="f3795-148">Si habilita la coherencia entre varias VM, a continuación, equipos del grupo de replicación de hello comunican entre sí a través del puerto 20004.</span><span class="sxs-lookup"><span data-stu-id="f3795-148">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="f3795-149">La implementación de varias máquinas virtuales se usa si agrupa varias máquinas en grupos de replicación que tienen puntos de recuperación coherentes con los bloqueos y coherentes con la aplicación cuando conmutan por error.</span><span class="sxs-lookup"><span data-stu-id="f3795-149">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="f3795-150">Esto es útil si las máquinas ejecutan Hola la misma carga de trabajo y necesita toobe coherente.</span><span class="sxs-lookup"><span data-stu-id="f3795-150">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
4. <span data-ttu-id="f3795-151">Tráfico está replicada tooAzure extremos públicos de almacenamiento, en Hola internet.</span><span class="sxs-lookup"><span data-stu-id="f3795-151">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="f3795-152">Como alternativa, puede usar el [emparejamiento público](../expressroute/expressroute-circuit-peerings.md#public-peering) de Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="f3795-152">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="f3795-153">No se admite la replicación del tráfico a través de una VPN de sitio a sitio desde un tooAzure de sitio local.</span><span class="sxs-lookup"><span data-stu-id="f3795-153">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>


<span data-ttu-id="f3795-154">**Figura 2: VMware tooAzure replicación**</span><span class="sxs-lookup"><span data-stu-id="f3795-154">**Figure 2: VMware tooAzure replication**</span></span>

![Mejorada](./media/vmware-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="f3795-156">Proceso de conmutación por error y conmutación por recuperación</span><span class="sxs-lookup"><span data-stu-id="f3795-156">Failover and failback process</span></span>

1. <span data-ttu-id="f3795-157">Después de comprobar que la conmutación por error funciona según lo previsto, puede ejecutar las conmutaciones por error no planeada tooAzure según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="f3795-157">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="f3795-158">No se admite la conmutación por error planeada.</span><span class="sxs-lookup"><span data-stu-id="f3795-158">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="f3795-159">Puede conmutar por error un único equipo, o crear [planes de recuperación](site-recovery-create-recovery-plans.md), toofail a varias máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="f3795-159">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="f3795-160">Cuando se ejecuta una conmutación por error, las máquinas virtuales de la réplica se crean en Azure.</span><span class="sxs-lookup"><span data-stu-id="f3795-160">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="f3795-161">Confirmar toostart una conmutación por error al acceder a cargas de trabajo de Hola de réplica de hello VM de Azure.</span><span class="sxs-lookup"><span data-stu-id="f3795-161">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="f3795-162">Cuando el sitio local principal esté disponible de nuevo, podrá realizar una conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="f3795-162">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="f3795-163">Configurar una infraestructura de conmutación por recuperación, empiece a replicar máquina Hola de hello sitio secundario toohello principal y ejecutar una conmutación por error no planeada desde el sitio secundario de Hola.</span><span class="sxs-lookup"><span data-stu-id="f3795-163">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="f3795-164">Tras confirmar esta conmutación por error, datos será local atrás y necesitará tooenable replicación tooAzure de nuevo.</span><span class="sxs-lookup"><span data-stu-id="f3795-164">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="f3795-165">Más información</span><span class="sxs-lookup"><span data-stu-id="f3795-165">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="f3795-166">Hay varios requisitos para la conmutación por recuperación:</span><span class="sxs-lookup"><span data-stu-id="f3795-166">There are a few failback requirements:</span></span>


- <span data-ttu-id="f3795-167">**Servidor de procesos temporales en Azure**: si desea que toofail de Azure después de la conmutación por error, necesitará tooset una VM de Azure configurado como un servidor de procesos, replicación de toohandle de Azure.</span><span class="sxs-lookup"><span data-stu-id="f3795-167">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="f3795-168">Dicha máquina virtual se puede eliminar cuando finalice la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="f3795-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="f3795-169">**Conexión VPN**: conmutación por recuperación necesitará una conexión VPN (o ExpressRoute de Azure) configurar de sitio local de hello Azure red toohello.</span><span class="sxs-lookup"><span data-stu-id="f3795-169">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="f3795-170">**Servidor de destino maestro local independiente**: servidor de destino maestro local Hola controla la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="f3795-170">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="f3795-171">servidor de destino maestro Hola se instala de forma predeterminada en el servidor de administración de hello, pero si está experimentando problemas volver mayores volúmenes de tráfico debe configurar un servidor de destino maestro local independiente para este propósito.</span><span class="sxs-lookup"><span data-stu-id="f3795-171">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="f3795-172">**Directiva de conmutación por recuperación**: tooreplicate atrás tooyour sitio local, deberá aplicar una directiva de conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="f3795-172">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="f3795-173">Esta se crea automáticamente al crear la directiva de replicación.</span><span class="sxs-lookup"><span data-stu-id="f3795-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="f3795-174">**Infraestructura de VMware**: debe realizar conmutación por recuperación tooan VM de VMware locales.</span><span class="sxs-lookup"><span data-stu-id="f3795-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="f3795-175">Esto significa que necesita una infraestructura de VMware en local, incluso si replica tooAzure de servidores físicos locales.</span><span class="sxs-lookup"><span data-stu-id="f3795-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="f3795-176">**Figura 3: VMware y conmutación por recuperación física**</span><span class="sxs-lookup"><span data-stu-id="f3795-176">**Figure 3: VMware/physical failback**</span></span>

![Conmutación por recuperación](./media/vmware-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="f3795-178">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="f3795-178">Next steps</span></span>

<span data-ttu-id="f3795-179">Vaya demasiado[paso 2: comprobar los requisitos previos y limitaciones](vmware-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="f3795-179">Go too[Step 2: Verify prerequisites and limitations](vmware-walkthrough-prerequisites.md)</span></span>
