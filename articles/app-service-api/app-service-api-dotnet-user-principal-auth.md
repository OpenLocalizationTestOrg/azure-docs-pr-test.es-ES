---
title: "autenticación de aaaUser para las aplicaciones de API de servicio de aplicaciones de Azure | Documentos de Microsoft"
description: "Obtenga información acerca de cómo tooprotect una aplicación de API de servicio de aplicaciones de Azure por lo que permite tener acceso a tooauthenticated solo a los usuarios."
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: 3896760d-46ff-4b67-b98a-edd233f24758
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 06/30/2016
ms.author: alkarche
ms.openlocfilehash: 4702fc77fcfe736405e22b033c35d22ae3c5a300
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="user-authentication-for-api-apps-in-azure-app-service"></a><span data-ttu-id="668ab-103">Autenticación de usuario para aplicaciones de API en el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="668ab-103">User authentication for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="668ab-104">Información general</span><span class="sxs-lookup"><span data-stu-id="668ab-104">Overview</span></span>
<span data-ttu-id="668ab-105">Este artículo muestra cómo puede llamarlo tooprotect una aplicación de API de Azure para solo los usuarios autenticados.</span><span class="sxs-lookup"><span data-stu-id="668ab-105">This article shows how tooprotect an Azure API app so that only authenticated users can call it.</span></span> <span data-ttu-id="668ab-106">Hello artículo se da por supuesto que ha leído hello [información general de la autenticación de servicio de aplicaciones de Azure](../app-service/app-service-authentication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="668ab-106">hello article assumes that you have read hello [Azure App Service authentication overview](../app-service/app-service-authentication-overview.md).</span></span>

<span data-ttu-id="668ab-107">Aprenderá a realizar los siguientes procedimientos:</span><span class="sxs-lookup"><span data-stu-id="668ab-107">You'll learn:</span></span>

* <span data-ttu-id="668ab-108">¿Cómo tooconfigure un proveedor de autenticación, con detalles de Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="668ab-108">How tooconfigure an authentication provider, with details for Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="668ab-109">Cómo tooconsume una aplicación de API protegida mediante el uso de Hola [Active Directory Authentication Library (ADAL) para JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="668ab-109">How tooconsume a protected API app by using hello [Active Directory Authentication Library (ADAL) for JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>

<span data-ttu-id="668ab-110">artículo de Hello contiene dos secciones:</span><span class="sxs-lookup"><span data-stu-id="668ab-110">hello article contains two sections:</span></span>

* <span data-ttu-id="668ab-111">Hola [cómo tooconfigure autenticación de usuario en el servicio de aplicación de Azure](#authconfig) sección se explica cómo general tooconfigure de autenticación de usuario para cualquier aplicación de API y se aplica por igual marcos tooall compatibles con el servicio de aplicación, incluidos los. NET, Node.js y Java.</span><span class="sxs-lookup"><span data-stu-id="668ab-111">hello [How tooconfigure user authentication in Azure App Service](#authconfig) section explains in general how tooconfigure user authentication for any API app and applies equally tooall frameworks supported by App Service, including .NET, Node.js, and Java.</span></span>
* <span data-ttu-id="668ab-112">A partir de hello [continuar tutoriales de aplicaciones de API de .NET de hello](#tutorialstart) sección, Hola guías de artículo a través de la configuración de una aplicación de ejemplo con .NET crear final y un front-end de AngularJS que usa Azure Active Directory para el usuario autenticación.</span><span class="sxs-lookup"><span data-stu-id="668ab-112">Starting with hello [Continuing hello .NET API Apps tutorials](#tutorialstart) section, hello article guides you through configuring a sample application with a .NET back end and an AngularJS front end so that it uses Azure Active Directory for user authentication.</span></span> 

## <span data-ttu-id="668ab-113"><a id="authconfig"></a>¿Cómo tooconfigure autenticación de usuario en el servicio de aplicación de Azure</span><span class="sxs-lookup"><span data-stu-id="668ab-113"><a id="authconfig"></a> How tooconfigure user authentication in Azure App Service</span></span>
<span data-ttu-id="668ab-114">Esta sección proporciona instrucciones generales que se aplican a la aplicación de API de tooany.</span><span class="sxs-lookup"><span data-stu-id="668ab-114">This section provides general instructions that apply tooany API app.</span></span> <span data-ttu-id="668ab-115">Para pasos específicos toohello tooDo aplicación de ejemplo de .NET de la lista, vaya demasiado[continuar tutoriales de introducción a .NET de hello](#tutorialstart).</span><span class="sxs-lookup"><span data-stu-id="668ab-115">For steps specific toohello tooDo List .NET sample application, go too[Continuing hello .NET getting-started tutorials](#tutorialstart).</span></span>

1. <span data-ttu-id="668ab-116">Hola [portal de Azure](https://portal.azure.com/), navegue toohello **configuración** hoja de aplicación Hola API que desea tooprotect, buscar hello **características** sección y, a continuación, haga clic en  **Autenticación / autorización**.</span><span class="sxs-lookup"><span data-stu-id="668ab-116">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you want tooprotect, find hello **Features** section, and then click **Authentication/ Authorization**.</span></span>
   
    ![Autenticación/autorización del Portal de Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="668ab-118">Hola **autenticación / autorización** hoja, haga clic en **en**.</span><span class="sxs-lookup"><span data-stu-id="668ab-118">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="668ab-119">Seleccione una de las opciones de Hola de hello **tootake de acción cuando no se autentica la solicitud** lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="668ab-119">Select one of hello options from hello **Action tootake when request is not authenticated** drop-down list.</span></span>
   
   * <span data-ttu-id="668ab-120">Si desea que sólo llamadas autenticadas tooreach la aplicación de API, elija uno de hello **iniciar sesión con...**  opciones.</span><span class="sxs-lookup"><span data-stu-id="668ab-120">If you want only authenticated calls tooreach your API app, choose one of hello **Log in with ...** options.</span></span> <span data-ttu-id="668ab-121">Esta opción permite tooprotect API aplicación hello sin escribir ningún código que se ejecuta en él.</span><span class="sxs-lookup"><span data-stu-id="668ab-121">This option enables you tooprotect hello API app without writing any code that runs in it.</span></span>
   * <span data-ttu-id="668ab-122">Elija si desea que todas las llamadas tooreach la aplicación de API, **Permitir solicitud (ninguna acción)**.</span><span class="sxs-lookup"><span data-stu-id="668ab-122">If you want all calls tooreach your API app, choose **Allow request (no action)**.</span></span> <span data-ttu-id="668ab-123">Puede usar esta opción de tooa opción toodirect sin autenticar los llamadores de proveedores de autenticación.</span><span class="sxs-lookup"><span data-stu-id="668ab-123">You can use this option toodirect unauthenticated callers tooa choice of authentication providers.</span></span> <span data-ttu-id="668ab-124">Con esta opción tiene autorización de toowrite código toohandle.</span><span class="sxs-lookup"><span data-stu-id="668ab-124">With this option you have toowrite code toohandle authorization.</span></span>
     
     <span data-ttu-id="668ab-125">Para más información, consulte [Autenticación y autorización para Aplicaciones de API en el Servicio de aplicaciones de Azure](app-service-api-authentication.md#multiple-protection-options).</span><span class="sxs-lookup"><span data-stu-id="668ab-125">For more information, see [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span></span>
4. <span data-ttu-id="668ab-126">Seleccione uno o varios de hello **proveedores de autenticación**.</span><span class="sxs-lookup"><span data-stu-id="668ab-126">Select one or more of hello **Authentication Providers**.</span></span>
   
    <span data-ttu-id="668ab-127">imagen de Hello muestra las opciones que requieren todos los toobe de los llamadores autentica Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-127">hello image shows    choices that require all callers toobe authenticated by Azure AD.</span></span>
   
    ![Hoja Autenticación/autorización del Portal de Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
   
    <span data-ttu-id="668ab-129">Al elegir un proveedor de autenticación, el portal de hello muestra una hoja de configuración para dicho proveedor.</span><span class="sxs-lookup"><span data-stu-id="668ab-129">When you choose an authentication provider, hello portal displays a configuration blade for that provider.</span></span> 
   
    <span data-ttu-id="668ab-130">Para obtener instrucciones detalladas que explican cómo tooconfigure Hola hojas de configuración de proveedor de autenticación, vea [cómo tooconfigure su inicio de sesión de Azure Active Directory de servicio de aplicaciones aplicación toouse](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="668ab-130">For detailed instructions that explain how tooconfigure hello authentication provider configuration blades, see [How tooconfigure your App Service application toouse Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="668ab-131">(vínculo de hello queda tooan artículo sobre Azure AD, pero artículo Hola propio contiene las pestañas que vinculan tooarticles para hello otros proveedores de autenticación).</span><span class="sxs-lookup"><span data-stu-id="668ab-131">(hello link goes tooan article about Azure AD, but hello article itself contains tabs that link tooarticles for hello other authentication providers.)</span></span>
5. <span data-ttu-id="668ab-132">Cuando haya terminado con la hoja de configuración de proveedor de autenticación de hello, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-132">When you're done with hello authentication provider configuration blade, click **OK**.</span></span>
6. <span data-ttu-id="668ab-133">Hola **autenticación / autorización** hoja, haga clic en **guardar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-133">In hello **Authentication / Authorization** blade, click **Save**.</span></span>

<span data-ttu-id="668ab-134">Cuando esto sucede, el servicio de aplicación autentica todas las llamadas API antes de alcanzar la aplicación de API de Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-134">When this is done, App Service authenticates all API calls before they reach hello API app.</span></span> <span data-ttu-id="668ab-135">trabajo de servicios de autenticación de Hola Hola igual para todos los idiomas que admite el servicio de aplicaciones, incluido. NET, Node.js y Java.</span><span class="sxs-lookup"><span data-stu-id="668ab-135">hello authentication services work hello same for all languages that App service supports, including .NET, Node.js, and Java.</span></span> 

<span data-ttu-id="668ab-136">toomake había autenticado llamadas a la API, llamador Hola incluye el token de portador de OAuth 2.0 del proveedor de autenticación de Hola Hola encabezado de autorización de solicitudes HTTP.</span><span class="sxs-lookup"><span data-stu-id="668ab-136">toomake authenticated API calls, hello caller includes hello authentication provider's OAuth 2.0 bearer token in hello Authorization header of HTTP requests.</span></span> <span data-ttu-id="668ab-137">símbolo (token) de Hello puede ser adquirida mediante el uso SDK del proveedor de autenticación de hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-137">hello token can be acquired by using hello authentication provider's SDK.</span></span>

## <span data-ttu-id="668ab-138"><a id="tutorialstart"></a>Tutoriales de aplicaciones de API de .NET de hello ininterrumpidos</span><span class="sxs-lookup"><span data-stu-id="668ab-138"><a id="tutorialstart"></a> Continuing hello .NET API Apps tutorials</span></span>
<span data-ttu-id="668ab-139">Si está siguiendo los tutoriales de Node.js o Java de Hola para aplicaciones de API, omitir toohello siguiente artículo, [autenticación principal del servicio para las aplicaciones de la API](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="668ab-139">If you are following hello Node.js or Java tutorials for API apps, skip toohello next article, [service principal authentication for API apps](app-service-api-dotnet-service-principal-auth.md).</span></span> 

<span data-ttu-id="668ab-140">Si está siguiendo la serie de tutoriales de hello .NET para aplicaciones de API y ya se ha implementado la aplicación de ejemplo de Hola como se indica en hello [primer](app-service-api-dotnet-get-started.md) y [segundo](app-service-api-cors-consume-javascript.md) tutoriales, omitir toohello [configurar la autenticación en el servicio de aplicaciones y Azure AD](#azureauth) sección.</span><span class="sxs-lookup"><span data-stu-id="668ab-140">If you are following hello .NET tutorial series for API apps and have already deployed hello sample application as directed in hello [first](app-service-api-dotnet-get-started.md) and [second](app-service-api-cors-consume-javascript.md) tutorials, skip toohello [Set up authentication in App Service and Azure AD](#azureauth) section.</span></span>

<span data-ttu-id="668ab-141">Si desea toofollow este tutorial sin tener que pasar a través de tutoriales primeros y segunda hello, Hola siguiendo los pasos que explican cómo tooget se inicia con una aplicación de ejemplo de Hola de toodeploy proceso automatizado.</span><span class="sxs-lookup"><span data-stu-id="668ab-141">If you want toofollow this tutorial without going through hello first and second tutorials, do hello following steps which explain how tooget started by using an automated process toodeploy hello sample application.</span></span>

> [!NOTE]
> <span data-ttu-id="668ab-142">Hello pasos siguientes permiten toohello como si Hola los dos primeros tutoriales, con una excepción de punto de partida mismo: Visual Studio ya no sabe qué aplicación web o una aplicación de API que cada proyecto se implementa en.</span><span class="sxs-lookup"><span data-stu-id="668ab-142">hello following steps get you toohello same starting point as if you did hello first two tutorials, with one exception: Visual Studio won't already know which web app or API app that each project gets deployed to.</span></span> <span data-ttu-id="668ab-143">Eso significa que no tiene las instrucciones exactas en este tutorial que explican cómo toodeploy toohello derecho destinos.</span><span class="sxs-lookup"><span data-stu-id="668ab-143">That means you won't have exact instructions in this tutorial that explain how toodeploy toohello right targets.</span></span> <span data-ttu-id="668ab-144">Si no le convencen pensar en cómo los pasos en su propia implementación de hello toodo, es mejor serie de tutoriales de hello toofollow de hello [primer tutorial](app-service-api-dotnet-get-started.md) que toostart con este automatizar el proceso de implementación.</span><span class="sxs-lookup"><span data-stu-id="668ab-144">If you're not comfortable with figuring out how toodo hello deployment steps on your own, it's better toofollow hello tutorial series from hello [first tutorial](app-service-api-dotnet-get-started.md) than toostart with this automated deployment process.</span></span>
> 
> 

1. <span data-ttu-id="668ab-145">Asegúrese de que dispone de todos los requisitos previos de hello descritos en hello [primer tutorial](app-service-api-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="668ab-145">Make sure that you have all of hello prerequisites listed in hello [first tutorial](app-service-api-dotnet-get-started.md).</span></span> <span data-ttu-id="668ab-146">En suma toohello requisitos previos descritos estos tutoriales de autenticación se supone que ha trabajado con aplicaciones de servicio de aplicaciones web y aplicaciones de API en Visual Studio y Hola portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="668ab-146">In addition toohello prerequisites listed, these authentication tutorials assume that you have worked with App Service web apps and API apps in Visual Studio and hello Azure portal.</span></span>
2. <span data-ttu-id="668ab-147">Haga clic en hello **implementar tooAzure** botón en hello [archivo Léame de tooDo lista sample repositorio](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) hello y aplicaciones de API de hello toodeploy de aplicación web.</span><span class="sxs-lookup"><span data-stu-id="668ab-147">Click hello **Deploy tooAzure** button in hello [tooDo List sample repository readme file](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps and hello web app.</span></span> <span data-ttu-id="668ab-148">Tome nota del grupo de recursos de Azure de Hola que se crea, ya puede usar este toolook más adelante la aplicación web y los nombres de aplicación de API.</span><span class="sxs-lookup"><span data-stu-id="668ab-148">Make a note of hello Azure resource group that gets created, as you can use this later toolook up web app and API app names.</span></span>
3. <span data-ttu-id="668ab-149">Descarga u Hola clon [repositorio de ejemplo de lista de tooDo](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) código de hello tooget que trabajará con localmente en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="668ab-149">Download or clone hello [tooDo List sample repository](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello code that you'll work with locally in Visual Studio.</span></span>

## <span data-ttu-id="668ab-150"><a id="azureauth"></a> Configuración de la autenticación en el Servicio de aplicaciones y Azure AD</span><span class="sxs-lookup"><span data-stu-id="668ab-150"><a id="azureauth"></a> Set up authentication in App Service and Azure AD</span></span>
<span data-ttu-id="668ab-151">Ahora dispone de aplicación Hola que se ejecuta en el servicio de aplicación de Azure sin necesidad de que los usuarios se autentiquen.</span><span class="sxs-lookup"><span data-stu-id="668ab-151">You now have hello application running in Azure App Service without requiring that users be authenticated.</span></span> <span data-ttu-id="668ab-152">En esta sección agregará autenticación haciendo Hola siguientes tareas:</span><span class="sxs-lookup"><span data-stu-id="668ab-152">In this section you add authentication by doing hello following tasks:</span></span>

* <span data-ttu-id="668ab-153">Configurar la autenticación de Azure Active Directory (Azure AD) toorequire de servicio de aplicaciones para llamar a la aplicación de API de nivel intermedio de hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-153">Configure App Service toorequire Azure Active Directory (Azure AD) authentication for calling hello middle tier API app.</span></span>
* <span data-ttu-id="668ab-154">Crear una aplicación de Azure.</span><span class="sxs-lookup"><span data-stu-id="668ab-154">Create an Azure AD application.</span></span>
* <span data-ttu-id="668ab-155">Configurar el token portador hello Azure AD aplicación toosend Hola después de front-end de inicio de sesión toohello AngularJS.</span><span class="sxs-lookup"><span data-stu-id="668ab-155">Configure hello Azure AD application toosend hello bearer token after logon toohello AngularJS front end.</span></span> 

<span data-ttu-id="668ab-156">Si experimenta problemas al siguiente instrucciones de tutorial de hello, vea hello [solución de problemas](#troubleshooting) sección al final de hello del tutorial Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-156">If you run into problems while following hello tutorial directions, see hello [Troubleshooting](#troubleshooting) section at hello end of hello tutorial.</span></span> 

### <a name="configure-authentication-for-hello-middle-tier-api-app"></a><span data-ttu-id="668ab-157">Configurar la autenticación de nivel intermedio de hello aplicación de API</span><span class="sxs-lookup"><span data-stu-id="668ab-157">Configure authentication for hello middle tier API app</span></span>
1. <span data-ttu-id="668ab-158">Hola [portal de Azure](https://portal.azure.com/), navegue toohello **configuración** hoja de aplicación Hola API que creó para el proyecto de ToDoListAPI hello, encontrar Hola **características** sección y, a continuación, Haga clic en **autenticación / autorización**.</span><span class="sxs-lookup"><span data-stu-id="668ab-158">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you created for hello ToDoListAPI project, find hello **Features** section, and then click **Authentication / Authorization**.</span></span>
   
    ![Autenticación/autorización del Portal de Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="668ab-160">Hola **autenticación / autorización** hoja, haga clic en **en**.</span><span class="sxs-lookup"><span data-stu-id="668ab-160">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="668ab-161">Hola **tootake de acción cuando no se autentica la solicitud** lista desplegable, seleccione **iniciar sesión con Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="668ab-161">In hello **Action tootake when request is not authenticated** drop-down list, select **Log in with Azure Active Directory**.</span></span>
   
    <span data-ttu-id="668ab-162">Esta opción garantiza que ninguna solicitud unauathenticated alcanzará la aplicación de API de hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-162">This option ensures that no unauathenticated requests will reach hello API app.</span></span> 
4. <span data-ttu-id="668ab-163">En **Proveedores de autenticación**, haga clic en **Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="668ab-163">Under **Authentication Providers**, click **Azure Active Directory**.</span></span>
   
    ![Hoja Autenticación/autorización del Portal de Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
5. <span data-ttu-id="668ab-165">Hola **configuración de Azure Active Directory** hoja, haga clic en **Express**</span><span class="sxs-lookup"><span data-stu-id="668ab-165">In hello **Azure Active Directory Settings** blade, click **Express**</span></span>
   
    ![Opción Express de Autenticación/autorización del Portal de Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings.png)
   
    <span data-ttu-id="668ab-167">Con hello **Express** opción, servicio de aplicaciones puede crear automáticamente una aplicación de Azure AD en Azure AD [inquilino](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span><span class="sxs-lookup"><span data-stu-id="668ab-167">With hello **Express** option, App Service can automatically create an Azure AD application in your Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span></span> 
   
    <span data-ttu-id="668ab-168">No tienes toocreate un inquilino, porque cada cuenta de Azure automáticamente tiene uno.</span><span class="sxs-lookup"><span data-stu-id="668ab-168">You don't have toocreate a tenant, because every Azure account automatically has one.</span></span>
6. <span data-ttu-id="668ab-169">En **modo de administración**, haga clic en **crear nueva aplicación de AD** si no está ya seleccionada y observe el valor de Hola Hola **crear aplicación** cuadro de texto; podrá buscar este AAD aplicación Hola portal de Azure clásico más adelante.</span><span class="sxs-lookup"><span data-stu-id="668ab-169">Under **Management mode**, click **Create New AD App** if it isn't already selected, and notice hello value that is in hello **Create App** text box; you'll look up this AAD application in hello Azure classic portal later.</span></span>
   
    ![Configuración de Azure AD del Portal de Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings2.png)
   
    <span data-ttu-id="668ab-171">Azure creará automáticamente una aplicación de Azure AD con el nombre indicado de hello en el inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-171">Azure will automatically create an Azure AD application with hello indicated name in your Azure AD tenant.</span></span> <span data-ttu-id="668ab-172">De forma predeterminada, se denomina aplicación de Azure AD Hola Hola igual como aplicación hello API.</span><span class="sxs-lookup"><span data-stu-id="668ab-172">By default, hello Azure AD application is named hello same as hello API app.</span></span> <span data-ttu-id="668ab-173">Si lo prefiere, escriba un nombre diferente.</span><span class="sxs-lookup"><span data-stu-id="668ab-173">If you prefer, you can enter a different name.</span></span>
7. <span data-ttu-id="668ab-174">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-174">Click **OK**.</span></span>
8. <span data-ttu-id="668ab-175">Hola **autenticación / autorización** hoja, haga clic en **guardar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-175">In hello **Authentication / Authorization** blade, click **Save**.</span></span>
   
    ![Haga clic en Guardar](./media/app-service-api-dotnet-user-principal-auth/authsave.png)

<span data-ttu-id="668ab-177">Ahora solo los usuarios de su inquilino de Azure AD pueden llamar a la aplicación de API de Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-177">Now only users in your Azure AD tenant can call hello API app.</span></span>

### <a name="optional-test-hello-api-app"></a><span data-ttu-id="668ab-178">Opcional: Probar la aplicación hello API</span><span class="sxs-lookup"><span data-stu-id="668ab-178">Optional: Test hello API app</span></span>
1. <span data-ttu-id="668ab-179">En un explorador, vaya toohello URL de aplicación hello API: Hola **aplicación de API** hoja Hola portal de Azure, haga clic en vínculo hello en **URL**.</span><span class="sxs-lookup"><span data-stu-id="668ab-179">In a browser go toohello URL of hello API app: in hello **API app** blade in hello Azure portal, click hello link under **URL**.</span></span>  
   
    <span data-ttu-id="668ab-180">Son redirigidos tooa pantalla de inicio de sesión dado que las solicitudes no autenticadas no se permiten la aplicación de API de hello tooreach.</span><span class="sxs-lookup"><span data-stu-id="668ab-180">You are redirected tooa login screen because unauthenticated requests are not allowed tooreach hello API app.</span></span>
   
    <span data-ttu-id="668ab-181">Si el explorador deja de página toohello "se creó correctamente", ya se podría registrar explorador hello en--en ese caso, abra una ventana de InPrivate o de incógnito y vaya URL de la aplicación toohello API.</span><span class="sxs-lookup"><span data-stu-id="668ab-181">If your browser goes toohello "successfully created" page, hello browser might already be logged on -- in that case, open an InPrivate or Incognito window and go toohello API app's URL.</span></span>
2. <span data-ttu-id="668ab-182">Inicie sesión con las credenciales de un usuario en su inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-182">Log on using credentials for a user in your Azure AD tenant.</span></span>
   
    <span data-ttu-id="668ab-183">Cuando ha iniciado sesión, Hola "se creó correctamente" página aparece en el Explorador de Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-183">When you're logged on, hello "successfully created" page appears in hello browser.</span></span>
3. <span data-ttu-id="668ab-184">Explorador de hello cerrar.</span><span class="sxs-lookup"><span data-stu-id="668ab-184">Close hello browser.</span></span>

### <a name="configure-hello-azure-ad-application"></a><span data-ttu-id="668ab-185">Configurar la aplicación hello Azure AD</span><span class="sxs-lookup"><span data-stu-id="668ab-185">Configure hello Azure AD application</span></span>
<span data-ttu-id="668ab-186">Cuando se configuró la autenticación de Azure AD, el Servicio de aplicaciones creó automáticamente una aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-186">When you configured Azure AD authentication, App Service created an Azure AD application for you.</span></span> <span data-ttu-id="668ab-187">De forma predeterminada la aplicación hello nuevo Azure AD era URL de la aplicación de tooprovide configurado Hola portador token toohello API.</span><span class="sxs-lookup"><span data-stu-id="668ab-187">By default hello new Azure AD application was configured tooprovide hello bearer token toohello API app's URL.</span></span> <span data-ttu-id="668ab-188">En esta sección configurará hello Azure AD aplicación tooprovide Hola portador token toohello AngularJS front-end en lugar de la aplicación de API de nivel intermedio de toohello directamente.</span><span class="sxs-lookup"><span data-stu-id="668ab-188">In this section you configure hello Azure AD application tooprovide hello bearer token toohello AngularJS front end instead of directly toohello middle tier API app.</span></span> <span data-ttu-id="668ab-189">front-end de Hello AngularJS enviará Hola token toohello API aplicación cuando llama a la aplicación de API de Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-189">hello AngularJS front end will send hello token toohello API app when it calls hello API app.</span></span>

> [!NOTE]
> <span data-ttu-id="668ab-190">proceso de hello tookeep tan simple como sea posible, este tutorial usa un único Azure AD aplicación front-end de Hola y aplicación de API de nivel intermedio de hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-190">tookeep hello process as simple as possible, this tutorial uses a single Azure AD application for both hello front end and hello middle tier API app.</span></span> <span data-ttu-id="668ab-191">Otra opción es toouse dos aplicaciones de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-191">Another option is toouse two Azure AD applications.</span></span> <span data-ttu-id="668ab-192">En ese caso tendría de toogive Hola front-end Azure AD aplicación permiso toocall Hola de Azure AD aplicación de nivel medio.</span><span class="sxs-lookup"><span data-stu-id="668ab-192">In that case you would have toogive hello front end's Azure AD application permission toocall hello middle tier's Azure AD application.</span></span> <span data-ttu-id="668ab-193">Este enfoque de varias aplicaciones proporcionaría más control granular sobre el nivel de permisos tooeach.</span><span class="sxs-lookup"><span data-stu-id="668ab-193">This multi-application approach would give you more granular control over permissions tooeach tier.</span></span>
> 
> 

1. <span data-ttu-id="668ab-194">Hola [portal de Azure clásico](https://manage.windowsazure.com/), vaya demasiado**Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="668ab-194">In hello [Azure classic portal](https://manage.windowsazure.com/), go too**Azure Active Directory**.</span></span>
   
   <span data-ttu-id="668ab-195">Tener portal clásico de hello toouse porque ciertas opciones de Azure Active Directory que necesita tener acceso a tooare no está disponible todavía en el portal de Azure actual Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-195">You have toouse hello classic portal because certain Azure Active Directory settings that you need access tooare not yet available in hello current Azure portal.</span></span>
2. <span data-ttu-id="668ab-196">En hello **directorio** , haga clic en su inquilino de AAD.</span><span class="sxs-lookup"><span data-stu-id="668ab-196">On hello **Directory** tab, click your AAD tenant.</span></span>
   
   ![Azure AD en el Portal clásico](./media/app-service-api-dotnet-user-principal-auth/selecttenant.png)
3. <span data-ttu-id="668ab-198">Haga clic en **aplicaciones > las aplicaciones que tiene mi compañía**y, a continuación, haga clic en la casilla de verificación Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-198">Click **Applications > Applications my company owns**, and then click hello check mark.</span></span>
   
   <span data-ttu-id="668ab-199">También tendrá la nueva aplicación de toorefresh Hola página toosee Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-199">You might also have toorefresh hello page toosee hello new application.</span></span>
4. <span data-ttu-id="668ab-200">En la lista Hola de aplicaciones, haga clic en Hola Hola uno que Azure crea automáticamente cuando se ha habilitado la autenticación de la aplicación de API.</span><span class="sxs-lookup"><span data-stu-id="668ab-200">In hello list of applications, click hello name of hello one that Azure created for you when you enabled authentication for your API app.</span></span>
   
   ![Pestaña Aplicaciones de Azure AD](./media/app-service-api-dotnet-user-principal-auth/appstab.png)
5. <span data-ttu-id="668ab-202">Haga clic en **Configurar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-202">Click **Configure**.</span></span>
   
   ![Pestaña Configurar de Azure AD](./media/app-service-api-dotnet-user-principal-auth/configure.png)
6. <span data-ttu-id="668ab-204">Establecer **dirección URL de inicio de sesión** toohello URL de la aplicación web de AngularJS, ninguna barra diagonal final.</span><span class="sxs-lookup"><span data-stu-id="668ab-204">Set **Sign-on URL** toohello URL for your AngularJS web app, no trailing slash.</span></span>
   
   <span data-ttu-id="668ab-205">Por ejemplo, https://todolistangular.azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="668ab-205">For example: https://todolistangular.azurewebsites.net</span></span>
   
   ![URL de inicio de sesión](./media/app-service-api-dotnet-user-principal-auth/signonurlazure.png)
7. <span data-ttu-id="668ab-207">Establecer **dirección URL de respuesta** toohello URL de la aplicación web, ninguna barra diagonal final.</span><span class="sxs-lookup"><span data-stu-id="668ab-207">Set **Reply URL** toohello URL for your web app, no trailing slash.</span></span>
   
   <span data-ttu-id="668ab-208">Por ejemplo: https://todolistsangular.azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="668ab-208">For example: https://todolistsangular.azurewebsites.net</span></span>
8. <span data-ttu-id="668ab-209">Haga clic en **Save**.</span><span class="sxs-lookup"><span data-stu-id="668ab-209">Click **Save**.</span></span>
   
   ![URL de respuesta](./media/app-service-api-dotnet-user-principal-auth/replyurlazure.png)
9. <span data-ttu-id="668ab-211">En la parte inferior de Hola de página de hello, haga clic en **administrar manifiesto > descarga manifiesto**.</span><span class="sxs-lookup"><span data-stu-id="668ab-211">At hello bottom of hello page, click **Manage manifest > Download manifest**.</span></span>
   
   ![Descargar el manifiesto](./media/app-service-api-dotnet-user-principal-auth/downloadmanifest.png)
10. <span data-ttu-id="668ab-213">Descargar la ubicación del archivo de hello tooa donde se puede editar.</span><span class="sxs-lookup"><span data-stu-id="668ab-213">Download hello file tooa location where you can edit it.</span></span>
11. <span data-ttu-id="668ab-214">Hola Descargar archivo de manifiesto, busque hello `oauth2AllowImplicitFlow` propiedad.</span><span class="sxs-lookup"><span data-stu-id="668ab-214">In hello downloaded manifest file, search for hello  `oauth2AllowImplicitFlow` property.</span></span> <span data-ttu-id="668ab-215">Cambiar valor Hola de esta propiedad desde `false` demasiado`true`y, a continuación, guarde el archivo hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-215">Change hello value of this property from `false` too`true`, and then save hello file.</span></span>
    
    <span data-ttu-id="668ab-216">Esta configuración es necesaria para el acceso desde una aplicación de una página de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="668ab-216">This setting is required for access from a JavaScript single-page application.</span></span> <span data-ttu-id="668ab-217">Permite devuelto en el fragmento de dirección URL de Hola Hola Oauth 2.0 portador token toobe.</span><span class="sxs-lookup"><span data-stu-id="668ab-217">It enables hello Oauth 2.0 bearer token toobe returned in hello URL fragment.</span></span>
12. <span data-ttu-id="668ab-218">Haga clic en **administrar manifiesto > cargar manifiesto**y el archivo de Hola de carga que actualizaron en hello anterior paso.</span><span class="sxs-lookup"><span data-stu-id="668ab-218">Click **Manage manifest > Upload manifest**, and upload hello file that you updated in hello preceding step.</span></span>
    
    ![Cargar el manifiesto](./media/app-service-api-dotnet-user-principal-auth/uploadmanifest.png)
13. <span data-ttu-id="668ab-220">Hola copia **Id. de cliente** valor y guárdelo en algún lugar puede obtener desde más tarde.</span><span class="sxs-lookup"><span data-stu-id="668ab-220">Copy hello **Client ID** value and save it somewhere you can get it from later.</span></span>

## <a name="configure-hello-todolistangular-project-toouse-authentication"></a><span data-ttu-id="668ab-221">Configurar la autenticación de hello ToDoListAngular proyecto toouse</span><span class="sxs-lookup"><span data-stu-id="668ab-221">Configure hello ToDoListAngular project toouse authentication</span></span>
<span data-ttu-id="668ab-222">En esta sección Cambiar front-end de hello AngularJS para que use la biblioteca de autenticación de Active Directory (ADAL) de JS tooacquire un token de portador de hello usuario que inició sesión de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-222">In this section you change hello AngularJS front end so that it uses Active Directory Authentication Library (ADAL) for JS tooacquire a bearer token for hello logged-on user from Azure AD.</span></span> <span data-ttu-id="668ab-223">código de Hello incluirá token hello en las solicitudes HTTP enviadas toohello nivel intermedio, como se muestra en hello siguiente diagrama.</span><span class="sxs-lookup"><span data-stu-id="668ab-223">hello code will include hello token in HTTP requests sent toohello middle tier, as shown in hello following diagram.</span></span> 

![Diagrama de autenticación de usuario](./media/app-service-api-dotnet-user-principal-auth/appdiagram.png)

<span data-ttu-id="668ab-225">Asegúrese de hello después toofiles cambios en el proyecto de ToDoListAngular Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-225">Make hello following changes toofiles in hello ToDoListAngular project.</span></span>

1. <span data-ttu-id="668ab-226">Abra hello *index.cshtml* archivo.</span><span class="sxs-lookup"><span data-stu-id="668ab-226">Open hello *index.cshtml* file.</span></span>
2. <span data-ttu-id="668ab-227">Quite el comentario de las líneas de Hola que hacen referencia a hello biblioteca de autenticación de Active Directory (ADAL) para las secuencias de comandos JS.</span><span class="sxs-lookup"><span data-stu-id="668ab-227">Uncomment hello lines that reference hello Active Directory Authentication Library (ADAL) for JS scripts.</span></span>
   
        <script src="app/scripts/adal.js"></script>
        <script src="app/scripts/adal-angular.js"></script>
3. <span data-ttu-id="668ab-228">Abra hello *app/scripts/app.js* archivo.</span><span class="sxs-lookup"><span data-stu-id="668ab-228">Open hello *app/scripts/app.js* file.</span></span>
4. <span data-ttu-id="668ab-229">Comenta bloque Hola de código marcado para "sin autenticación" y quite el bloque de Hola de código marcado para "con la autenticación".</span><span class="sxs-lookup"><span data-stu-id="668ab-229">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
   
    <span data-ttu-id="668ab-230">Este cambio hace referencia a proveedor de autenticación de ADAL JS hello y proporciona tooit de valores de configuración.</span><span class="sxs-lookup"><span data-stu-id="668ab-230">This change references hello ADAL JS authentication provider and provides configuration values tooit.</span></span> <span data-ttu-id="668ab-231">Hola siguiendo los pasos debe establecer valores de configuración de Hola para su aplicación de API y la aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-231">In hello following steps you set hello configuration values for your API app and Azure AD application.</span></span>
5. <span data-ttu-id="668ab-232">En el código de hello establece hello `endpoints` URL de la API de hello variable, establezca toohello dirección URL de aplicación Hola API que se crean para hello ToDoListAPI proyecto y establecer hello Azure AD aplicación identificador toohello Id. de cliente que copió de hello portal de Azure clásico.</span><span class="sxs-lookup"><span data-stu-id="668ab-232">In hello code that sets hello `endpoints` variable, set hello API URL toohello URL of hello API app that you created for hello ToDoListAPI project, and set hello Azure AD application ID toohello client ID that you copied from hello Azure classic portal.</span></span>
   
    <span data-ttu-id="668ab-233">código de Hello está similar toohello siguiente ejemplo.</span><span class="sxs-lookup"><span data-stu-id="668ab-233">hello code is now similar toohello following example.</span></span>
   
        var endpoints = {
            "https://todolistapi0121.azurewebsites.net/": "1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3"
        };
6. <span data-ttu-id="668ab-234">Hola llamar demasiado`adalProvider.init`, establezca `tenant` tooyour nombre del inquilino y `clientId` valor toosame que utilizó en el paso anterior de Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-234">In hello call too`adalProvider.init`, set `tenant` tooyour tenant name and `clientId` toosame value you used in hello previous step.</span></span>
   
    <span data-ttu-id="668ab-235">código de Hello está similar toohello siguiente ejemplo.</span><span class="sxs-lookup"><span data-stu-id="668ab-235">hello code is now similar toohello following example.</span></span>
   
        adalProvider.init(
            {
                instance: 'https://login.microsoftonline.com/', 
                tenant: 'contoso.onmicrosoft.com',
                clientId: '1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3',
                extraQueryParameter: 'nux=1',
                endpoints: endpoints
            },
            $httpProvider
            );
   
    <span data-ttu-id="668ab-236">Estos cambios se demasiado`app.js` especificar que código de llamada de Hola y Hola denominado API están en aplicación hello misma instancia de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-236">These changes too`app.js` specify that hello calling code and hello called API are in hello same Azure AD application.</span></span>
7. <span data-ttu-id="668ab-237">Abra hello *app/scripts/homeCtrl.js* archivo.</span><span class="sxs-lookup"><span data-stu-id="668ab-237">Open hello *app/scripts/homeCtrl.js* file.</span></span>
8. <span data-ttu-id="668ab-238">Comenta bloque Hola de código marcado para "sin autenticación" y quite el bloque de Hola de código marcado para "con la autenticación".</span><span class="sxs-lookup"><span data-stu-id="668ab-238">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
9. <span data-ttu-id="668ab-239">Abra hello *app/scripts/indexCtrl.js* archivo.</span><span class="sxs-lookup"><span data-stu-id="668ab-239">Open hello *app/scripts/indexCtrl.js* file.</span></span>
10. <span data-ttu-id="668ab-240">Comenta bloque Hola de código marcado para "sin autenticación" y quite el bloque de Hola de código marcado para "con la autenticación".</span><span class="sxs-lookup"><span data-stu-id="668ab-240">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>

### <a name="deploy-hello-todolistangular-project-tooazure"></a><span data-ttu-id="668ab-241">Implementar hello ToDoListAngular proyecto tooAzure</span><span class="sxs-lookup"><span data-stu-id="668ab-241">Deploy hello ToDoListAngular project tooAzure</span></span>
1. <span data-ttu-id="668ab-242">En **el Explorador de soluciones**, haga clic en proyecto de hello ToDoListAngular y, a continuación, haga clic en **publicar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-242">In **Solution Explorer**, right-click hello ToDoListAngular project, and then click **Publish**.</span></span>
2. <span data-ttu-id="668ab-243">Haga clic en **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-243">Click **Publish**.</span></span>
   
    <span data-ttu-id="668ab-244">Visual Studio implementa Hola proyecto y abre la dirección URL base de la aplicación web de toohello de explorador.</span><span class="sxs-lookup"><span data-stu-id="668ab-244">Visual Studio deploys hello project and opens a browser toohello web app's base URL.</span></span> <span data-ttu-id="668ab-245">Esto mostrará una página de 403 error, que es normal que un intento de toogo tooa API Web dirección URL base desde un explorador.</span><span class="sxs-lookup"><span data-stu-id="668ab-245">This will show a 403 error page, which is normal for an attempt toogo tooa Web API base URL from a browser.</span></span>
   
    <span data-ttu-id="668ab-246">También tendrá toomake un nivel intermedio de toohello de cambio de aplicación de API para poder probar la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-246">You still have toomake a change toohello middle tier API app before you can test hello application.</span></span>
3. <span data-ttu-id="668ab-247">Explorador de hello cerrar.</span><span class="sxs-lookup"><span data-stu-id="668ab-247">Close hello browser.</span></span>

## <a name="configure-hello-todolistapi-project-toouse-authentication"></a><span data-ttu-id="668ab-248">Configurar la autenticación de hello ToDoListAPI proyecto toouse</span><span class="sxs-lookup"><span data-stu-id="668ab-248">Configure hello ToDoListAPI project toouse authentication</span></span>
<span data-ttu-id="668ab-249">Hola actualmente envíos de proyecto ToDoListAPI "*" como hello `owner` tooToDoListDataAPI de valor.</span><span class="sxs-lookup"><span data-stu-id="668ab-249">Currently hello ToDoListAPI project sends "*" as hello `owner` value tooToDoListDataAPI.</span></span> <span data-ttu-id="668ab-250">En esta sección Cambiar Hola código toosend Hola ID de usuario que inició sesión Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-250">In this section you change hello code toosend hello ID of hello logged-on user.</span></span>

<span data-ttu-id="668ab-251">Asegúrese de hello siguientes cambios en el proyecto de ToDoListAPI Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-251">Make hello following changes in hello ToDoListAPI project.</span></span>

1. <span data-ttu-id="668ab-252">Abra hello *Controllers/ToDoListController.cs* de archivos y quite el comentario de línea de hello en cada método de acción que establece `owner` toohello Azure AD `NameIdentifier` valor de notificación.</span><span class="sxs-lookup"><span data-stu-id="668ab-252">Open hello *Controllers/ToDoListController.cs* file, and uncomment hello line in each action method that sets `owner` toohello Azure AD `NameIdentifier` claim value.</span></span> <span data-ttu-id="668ab-253">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="668ab-253">For example:</span></span>
   
        owner = ((ClaimsIdentity)User.Identity).FindFirst(ClaimTypes.NameIdentifier).Value;
   
    <span data-ttu-id="668ab-254">**Importante**: no quite comentarios del código de hello `ToDoListDataAPI` método; lo hará más adelante para el tutorial de autenticación principal de servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-254">**Important**: Don't uncomment code in hello `ToDoListDataAPI` method; you'll do that later for hello service principal authentication tutorial.</span></span>

### <a name="deploy-hello-todolistapi-project-tooazure"></a><span data-ttu-id="668ab-255">Implementar hello ToDoListAPI proyecto tooAzure</span><span class="sxs-lookup"><span data-stu-id="668ab-255">Deploy hello ToDoListAPI project tooAzure</span></span>
1. <span data-ttu-id="668ab-256">En **el Explorador de soluciones**, haga clic en proyecto de hello ToDoListAPI y, a continuación, haga clic en **publicar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-256">In **Solution Explorer**, right-click hello ToDoListAPI project, and then click **Publish**.</span></span>
2. <span data-ttu-id="668ab-257">Haga clic en **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="668ab-257">Click **Publish**.</span></span>
   
    <span data-ttu-id="668ab-258">Visual Studio implementa Hola proyecto y abre la dirección URL base de la aplicación API de toohello de explorador.</span><span class="sxs-lookup"><span data-stu-id="668ab-258">Visual Studio deploys hello project and opens a browser toohello API app's base URL.</span></span>
3. <span data-ttu-id="668ab-259">Explorador de hello cerrar.</span><span class="sxs-lookup"><span data-stu-id="668ab-259">Close hello browser.</span></span>

### <a name="test-hello-application"></a><span data-ttu-id="668ab-260">Probar la aplicación hello</span><span class="sxs-lookup"><span data-stu-id="668ab-260">Test hello application</span></span>
1. <span data-ttu-id="668ab-261">Ir a dirección URL de toohello de aplicación web de hello, **mediante HTTPS y no HTTP**.</span><span class="sxs-lookup"><span data-stu-id="668ab-261">Go toohello URL of hello web app, **using HTTPS, not HTTP**.</span></span>
2. <span data-ttu-id="668ab-262">Haga clic en hello **tooDo lista** ficha.</span><span class="sxs-lookup"><span data-stu-id="668ab-262">Click hello **tooDo List** tab.</span></span>
   
    <span data-ttu-id="668ab-263">Son toolog solicitada en.</span><span class="sxs-lookup"><span data-stu-id="668ab-263">You are prompted toolog in.</span></span>
3. <span data-ttu-id="668ab-264">Inicie sesión con credenciales de Hola de un usuario en su inquilino de AAD.</span><span class="sxs-lookup"><span data-stu-id="668ab-264">Log in with hello credentials of a user in your AAD tenant.</span></span>
4. <span data-ttu-id="668ab-265">Hola **tooDo lista** aparecerá la página.</span><span class="sxs-lookup"><span data-stu-id="668ab-265">hello **tooDo List** page appears.</span></span>
   
   ![página de lista tooDo](./media/app-service-api-dotnet-user-principal-auth/webappindex.png)
   
   <span data-ttu-id="668ab-267">No se muestran tareas pendientes porque hasta todas han sido para el propietario "*".</span><span class="sxs-lookup"><span data-stu-id="668ab-267">No to-do items are displayed because until now they have all been for owner "*".</span></span> <span data-ttu-id="668ab-268">Ahora nivel intermedio Hola solicita elementos para el usuario que inició sesión hello y no se ha creado aún.</span><span class="sxs-lookup"><span data-stu-id="668ab-268">Now hello middle tier is requesting items for hello logged-on user, and none have been created yet.</span></span>
5. <span data-ttu-id="668ab-269">Agregar nueva tooverify de elementos de tarea que funciona la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="668ab-269">Add new to-do items tooverify that hello application is working.</span></span>
6. <span data-ttu-id="668ab-270">En otra ventana del explorador, vaya toohello Swagger dirección URL de interfaz de usuario para la aplicación de API de ToDoListDataAPI hello y haga clic en **ToDoList > obtener**.</span><span class="sxs-lookup"><span data-stu-id="668ab-270">In another browser window, go toohello Swagger UI URL for hello ToDoListDataAPI API app and click **ToDoList > Get**.</span></span> <span data-ttu-id="668ab-271">Escriba un asterisco para hello `owner` parámetro y, a continuación, haga clic en **Pruébelo**.</span><span class="sxs-lookup"><span data-stu-id="668ab-271">Enter an asterisk for hello `owner` parameter, and then click **Try it out**.</span></span>
   
   <span data-ttu-id="668ab-272">respuesta de Hello muestra que elementos pendientes de la nueva Hola tienen Id. de usuario de hello real AD de Azure en la propiedad Owner Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-272">hello response shows that hello new to-do items have hello actual Azure AD user ID in hello Owner property.</span></span>
   
   ![Id. de propietario en respuesta JSON](./media/app-service-api-dotnet-user-principal-auth/todolistapiauth.png)

## <a name="building-hello-projects-from-scratch"></a><span data-ttu-id="668ab-274">Compilar proyectos de Hola desde el principio</span><span class="sxs-lookup"><span data-stu-id="668ab-274">Building hello projects from scratch</span></span>
<span data-ttu-id="668ab-275">proyectos de Hello dos API Web se crearon con hello **aplicación de API de Azure** de proyectos de plantilla y reemplazando Hola valores de controlador predeterminado con un controlador ToDoList.</span><span class="sxs-lookup"><span data-stu-id="668ab-275">hello two Web API projects were created by using hello **Azure API App** project template and replacing hello default Values controller with a ToDoList controller.</span></span> 

<span data-ttu-id="668ab-276">Para obtener información acerca de cómo crear demasiado una aplicación de página de AngularJS con un API Web 2 back-end, vea [manos en laboratorio: compilar una aplicación de página única (SPA) con ASP.NET Web API y Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span><span class="sxs-lookup"><span data-stu-id="668ab-276">For information about how too create an AngularJS single-page application with a Web API 2 back end, see  [Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span></span> <span data-ttu-id="668ab-277">Para obtener información acerca de cómo tooadd código de autenticación de Azure AD, vea Hola recursos siguientes:</span><span class="sxs-lookup"><span data-stu-id="668ab-277">For information about how tooadd Azure AD authentication code, see hello following resources:</span></span>

* <span data-ttu-id="668ab-278">[Seguridad de las aplicaciones de una sola página AngularJS con Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span><span class="sxs-lookup"><span data-stu-id="668ab-278">[Securing AngularJS Single Page Apps with Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span></span>
* [<span data-ttu-id="668ab-279">Introducing ADAL JS v1 (Presentación de ADAL JS v1)</span><span class="sxs-lookup"><span data-stu-id="668ab-279">Introducing ADAL JS v1</span></span>](http://www.cloudidentity.com/blog/2015/02/19/introducing-adal-js-v1/)

## <a name="troubleshooting"></a><span data-ttu-id="668ab-280">Solución de problemas</span><span class="sxs-lookup"><span data-stu-id="668ab-280">Troubleshooting</span></span>
[!INCLUDE [troubleshooting](../../includes/app-service-api-auth-troubleshooting.md)]

* <span data-ttu-id="668ab-281">Asegúrese de no confundir ToDoListAPI (nivel intermedio) con ToDoListDataAPI (capa de datos).</span><span class="sxs-lookup"><span data-stu-id="668ab-281">Make sure that you don't confuse ToDoListAPI (middle tier) and ToDoListDataAPI (data tier).</span></span> <span data-ttu-id="668ab-282">Por ejemplo, compruebe que ha agregado la aplicación de API de nivel intermedio de toohello autenticación, no la capa de datos Hola.</span><span class="sxs-lookup"><span data-stu-id="668ab-282">For example, verify that you added authentication toohello middle tier API app, not hello data tier.</span></span> 
* <span data-ttu-id="668ab-283">Asegúrese de que hello y URL de la aplicación de API de nivel intermedio de AngularJS origen código referencias Hola Hola (ToDoListAPI, no ToDoListDataAPI) corrijan identificador de cliente de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="668ab-283">Make sure that hello AngularJS source code references hello middle tier API app URL (ToDoListAPI, not ToDoListDataAPI)and hello correct Azure AD client ID.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="668ab-284">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="668ab-284">Next steps</span></span>
<span data-ttu-id="668ab-285">En este tutorial ha aprendido cómo toouse autenticación de servicio de aplicaciones para una aplicación de API y cómo toocall Hola aplicación de API mediante el uso de Hola biblioteca de AAL JS.</span><span class="sxs-lookup"><span data-stu-id="668ab-285">In this tutorial you learned how toouse App Service authentication for an API app and how toocall hello API app by using hello ADAL JS library.</span></span> <span data-ttu-id="668ab-286">En el tutorial siguiente Hola aprenderá cómo demasiado[un acceso seguro tooyour API de aplicación para los escenarios de servicio a servicio](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="668ab-286">In hello next tutorial you'll learn how too[secure access tooyour API app for service-to-service scenarios](app-service-api-dotnet-service-principal-auth.md).</span></span>

