---
title: "Autenticación y autorización para API Apps en Azure App Service | Microsoft Docs"
description: "Obtenga información acerca de los servicios de autenticación y autorización que el Servicio de aplicaciones de Azure proporciona para Aplicaciones de API."
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: d620b53a-5a6f-41c9-84c7-f7ef5ff02ae7
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/23/2016
ms.author: alkarche
ms.openlocfilehash: f9fd533dfbd54517232f9dae5000ed4779baebd4
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="authentication-and-authorization-for-api-apps-in-azure-app-service"></a><span data-ttu-id="c38de-103">Autenticación y autorización para Aplicaciones de API en el Servicio de aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="c38de-103">Authentication and authorization for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="c38de-104">Información general</span><span class="sxs-lookup"><span data-stu-id="c38de-104">Overview</span></span>
> [!NOTE]
> <span data-ttu-id="c38de-105">Este tema se migrará al artículo consolidado [Autenticación y autorización en el Servicio de aplicaciones de Azure](../app-service/app-service-authentication-overview.md) , que abarca las aplicaciones web, móviles y de API.</span><span class="sxs-lookup"><span data-stu-id="c38de-105">This topic will be migrated to a consolidated [App Service Authentication / Authorization](../app-service/app-service-authentication-overview.md) topic, which covers Web, Mobile, and API Apps.</span></span>
> 
> 

<span data-ttu-id="c38de-106">Azure App Service ofrece servicios de autenticación y autorización integrados que implementan [OAuth 2.0](#oauth) y [OpenID Connect](#oauth).</span><span class="sxs-lookup"><span data-stu-id="c38de-106">Azure App Service offers built-in authentication and authorization services that implement [OAuth 2.0](#oauth) and [OpenID Connect](#oauth).</span></span> <span data-ttu-id="c38de-107">Este artículo describe los servicios y las opciones que están disponibles para aplicaciones de API en el Servicio de aplicaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="c38de-107">This article describes the services and options that are available for API Apps in Azure App Service.</span></span>

<span data-ttu-id="c38de-108">El siguiente diagrama ilustra algunas de las características clave de la autenticación de Servicio de aplicaciones:</span><span class="sxs-lookup"><span data-stu-id="c38de-108">The following diagram illustrates some key characteristics of App Service authentication:</span></span>

* <span data-ttu-id="c38de-109">Preprocesa las solicitudes entrantes de API, lo que significa que funciona con cualquier lenguaje o marco admitido por el Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="c38de-109">It preprocesses incoming API requests, which means it works with any language or framework supported by App Service.</span></span>
* <span data-ttu-id="c38de-110">Le ofrece varias opciones para elegir cuánto trabajo de autenticación desea realizar en su propio código.</span><span class="sxs-lookup"><span data-stu-id="c38de-110">It gives you several options for how much authentication work you want to do in your own code.</span></span>
* <span data-ttu-id="c38de-111">Funciona para la autenticación tanto del usuario final como de la cuenta de servicio.</span><span class="sxs-lookup"><span data-stu-id="c38de-111">It works for both end user and service account authentication.</span></span> 
* <span data-ttu-id="c38de-112">Admite cinco proveedores de identidades: Azure Active Directory, Facebook, Google, Twitter y cuenta de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c38de-112">It supports five identity providers: Azure Active Directory, Facebook, Google, Twitter, and Microsoft Account.</span></span>
* <span data-ttu-id="c38de-113">Funciona igual para Aplicaciones de API, Aplicaciones Web y Aplicaciones móviles.</span><span class="sxs-lookup"><span data-stu-id="c38de-113">It works the same for API Apps, Web Apps, and Mobile Apps.</span></span>

![](./media/app-service-api-authentication/api-apps-overview.png)

## <a name="language-agnostic"></a><span data-ttu-id="c38de-114">Independencia de lenguajes</span><span class="sxs-lookup"><span data-stu-id="c38de-114">Language agnostic</span></span>
<span data-ttu-id="c38de-115">El procesamiento de la autenticación de Servicio de aplicaciones se produce antes de que las solicitudes lleguen a su aplicación de API, lo que significa que las características de autenticación funcionan para las aplicaciones de API escritas en cualquier lenguaje o marco.</span><span class="sxs-lookup"><span data-stu-id="c38de-115">App Service authentication processing happens before requests reach your API app, which means that the authentication features work for API apps written in any language or framework.</span></span>  <span data-ttu-id="c38de-116">La API se puede basar en ASP.NET, Java, Node.js o en cualquier marco compatible con el Servicio de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="c38de-116">Your API can be based on ASP.NET, Java, Node.js, or any framework that App Service supports.</span></span>

<span data-ttu-id="c38de-117">El Servicio de aplicaciones pasa el token web JSON (JWT) en el encabezado de autorización de una solicitud HTTP y el código escrito en cualquier lenguaje o marco puede obtener la información que necesita del token.</span><span class="sxs-lookup"><span data-stu-id="c38de-117">App Service passes on the JSON web token (JWT) in the Authorization header of an HTTP request, and code written in any language or framework can get the information it needs from the token.</span></span> <span data-ttu-id="c38de-118">Además, el Servicio de aplicaciones facilita el acceso a las notificaciones más utilizadas, para lo que establece algunos encabezados especiales como:</span><span class="sxs-lookup"><span data-stu-id="c38de-118">In addition, App Service gives you easier access to the most commonly used claims by setting some special headers, such as the following:</span></span>

* <span data-ttu-id="c38de-119">X-MS-CLIENT-PRINCIPAL-NAME</span><span class="sxs-lookup"><span data-stu-id="c38de-119">X-MS-CLIENT-PRINCIPAL-NAME</span></span>
* <span data-ttu-id="c38de-120">X-MS-CLIENT-PRINCIPAL-ID</span><span class="sxs-lookup"><span data-stu-id="c38de-120">X-MS-CLIENT-PRINCIPAL-ID</span></span>
* <span data-ttu-id="c38de-121">X-MS-TOKEN-FACEBOOK-ACCESS-TOKEN</span><span class="sxs-lookup"><span data-stu-id="c38de-121">X-MS-TOKEN-FACEBOOK-ACCESS-TOKEN</span></span>
* <span data-ttu-id="c38de-122">X-MS-TOKEN-FACEBOOK-EXPIRES-ON</span><span class="sxs-lookup"><span data-stu-id="c38de-122">X-MS-TOKEN-FACEBOOK-EXPIRES-ON</span></span>

<span data-ttu-id="c38de-123">En una API de .NET se puede usar el atributo `Authorize` y, en el caso de una autorización específica, se puede escribir fácilmente código según las notificaciones, ya que la información de las notificaciones se rellena automáticamente en las clases .NET.</span><span class="sxs-lookup"><span data-stu-id="c38de-123">In a .NET API, you can use the `Authorize` attribute, and for fine-grained authorization you can easily write code based on claims because claims information is populated for you in .NET classes.</span></span>

## <a name="multiple-protection-options"></a><span data-ttu-id="c38de-124">Varias opciones de protección</span><span class="sxs-lookup"><span data-stu-id="c38de-124">Multiple protection options</span></span>
<span data-ttu-id="c38de-125">El Servicio de aplicaciones puede impedir que las solicitudes anónimas de HTTP lleguen a su aplicación de API, puede pasar todas las solicitudes y validar los tokens para las solicitudes que los incluyen o puede dejar pasar todas las solicitudes sin realizar ninguna acción en ellas:</span><span class="sxs-lookup"><span data-stu-id="c38de-125">App Service can prevent anonymous HTTP requests from reaching your API app, it can pass on all requests and validate tokens for requests that include them, or it can let through all requests without taking any action on them:</span></span>

1. <span data-ttu-id="c38de-126">Permitir que solo lleguen a la aplicaciones de API las solicitudes autenticadas.</span><span class="sxs-lookup"><span data-stu-id="c38de-126">Allow only authenticated requests to reach your API app.</span></span>
   
    <span data-ttu-id="c38de-127">Si se recibe una solicitud anónima desde un explorador, el Servicio de aplicaciones le redirigirá a una página de inicio de sesión para el proveedor de autenticación (Azure AD, Google, Twitter, etc.) que elija.</span><span class="sxs-lookup"><span data-stu-id="c38de-127">If an anonymous request is received from a browser, App Service will redirect to a logon page for the authentication provider (Azure AD, Google, Twitter, etc.) that you choose.</span></span> 
   
    <span data-ttu-id="c38de-128">Con esta opción, no es preciso escribir código de autenticación en la aplicación y el código de autorización se simplifica, ya que las notificaciones más importantes se proporcionan en los encabezados HTTP.</span><span class="sxs-lookup"><span data-stu-id="c38de-128">With this option, you don't need to write any authentication code at all in your app, and authorization code is simplified because the most important claims are provided in the HTTP headers.</span></span>
2. <span data-ttu-id="c38de-129">Permitir que todas las solicitudes lleguen a la aplicación de API, pero validar las solicitudes autenticadas y pasar la información de autenticación en los encabezados HTTP.</span><span class="sxs-lookup"><span data-stu-id="c38de-129">Allow all requests to reach your API app, but validate authenticated requests and pass along authentication information in the HTTP headers.</span></span>
   
    <span data-ttu-id="c38de-130">Esta opción le proporciona más flexibilidad en el tratamiento de solicitudes anónimas, pero tendrá que escribir código si desea impedir que los usuarios anónimos utilicen la API.</span><span class="sxs-lookup"><span data-stu-id="c38de-130">This option gives you more flexibility in handling anonymous requests, but you have to write code if you want to prevent anonymous users from using your API.</span></span> <span data-ttu-id="c38de-131">Puesto que las notificaciones más populares se pasan en los encabezados de solicitudes HTTP, el código de autorización es relativamente sencillo.</span><span class="sxs-lookup"><span data-stu-id="c38de-131">Since the most popular claims are passed in the headers of HTTP requests, authorization code is relatively simple.</span></span>
3. <span data-ttu-id="c38de-132">Permitir que todas las solicitudes lleguen a la API, no realizar acciones relativas a la información de autenticación de las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="c38de-132">Allow all requests to reach your API, take no action on authentication information in the requests.</span></span>
   
    <span data-ttu-id="c38de-133">Esta opción deja las tareas de autenticación y autorización totalmente en manos del código de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c38de-133">This option leaves the tasks of authentication and authorization entirely up to your application code.</span></span>

<span data-ttu-id="c38de-134">En el [Portal de Azure](https://portal.azure.com/), seleccione la opción que desee en la hoja **Autenticación o autorización** .</span><span class="sxs-lookup"><span data-stu-id="c38de-134">In the [Azure portal](https://portal.azure.com/), you select the option you want on the **Authentication / Authorization** blade.</span></span>

![](./media/app-service-api-authentication/authblade.png)

<span data-ttu-id="c38de-135">Para las opciones 1 y 2, active **Autenticación de App Service** y en la lista desplegable **Acción necesaria cuando la solicitud no está autenticada** elija **Iniciar sesión** o **Permitir solicitud (ninguna acción)**.</span><span class="sxs-lookup"><span data-stu-id="c38de-135">For options 1 and 2, turn on **App Service Authentication**, and in the **Action to take when request is not authenticated** drop-down list choose **Log in** or **Allow request (no action)**.</span></span>  <span data-ttu-id="c38de-136">Si elige **Iniciar sesión**, tendrá que elegir un proveedor de autenticación y configurarlo.</span><span class="sxs-lookup"><span data-stu-id="c38de-136">If you choose **Log in**, you have to choose an authentication provider and configure that provider.</span></span>

![](./media/app-service-api-authentication/actiontotake.png)

<span data-ttu-id="c38de-137">Para más información sobre cómo configurar la autenticación, consulte [Configuración de la aplicación del Servicio de aplicaciones para usar el inicio de sesión de Azure Active Directory](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="c38de-137">For detailed information about how to configure authentication, see [How to configure your App Service application to use Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="c38de-138">El artículo se aplica a aplicaciones de API, así como a aplicaciones móviles, e incluye vínculos a otros artículos para los demás proveedores de autenticación.</span><span class="sxs-lookup"><span data-stu-id="c38de-138">The article applies to API apps as well as mobile apps, and it links to other articles for the other authentication providers.</span></span>

## <span data-ttu-id="c38de-139"><a id="internal"></a> Autenticación de cuentas de servicio</span><span class="sxs-lookup"><span data-stu-id="c38de-139"><a id="internal"></a> Service account authentication</span></span>
<span data-ttu-id="c38de-140">La autenticación del Servicio de aplicaciones también funciona en escenarios internos, como para la realización de llamadas de una aplicación de API a otra.</span><span class="sxs-lookup"><span data-stu-id="c38de-140">App Service authentication works for internal scenarios such as for calling from one API app to another API app.</span></span> <span data-ttu-id="c38de-141">En este escenario se puede obtener un token mediante credenciales para una cuenta de servicio, en lugar de las credenciales de usuario final.</span><span class="sxs-lookup"><span data-stu-id="c38de-141">In this scenario you get a token by using credentials for a service account instead of end user credentials.</span></span> <span data-ttu-id="c38de-142">Las cuentas de servicio también se conocen como *entidades de servicio* en Azure Active Directory y la autenticación que usa dichas cuenta también se conoce como escenario entre servicios.</span><span class="sxs-lookup"><span data-stu-id="c38de-142">A service account is also known as a *service principal* in Azure Active Directory, and authentication using such an account is also known as a service-to-service scenario.</span></span> 

<span data-ttu-id="c38de-143">En los escenarios entre servicios, proteja la aplicación de API llamada mediante Azure Active Directory y proporcione un token de autorización de la entidad de servicio de AAD al llamar a la aplicación de API.</span><span class="sxs-lookup"><span data-stu-id="c38de-143">For service-to-service scenarios, protect the called API app by using Azure Active Directory, and provide an AAD service principal authorization token when you call the API app.</span></span> <span data-ttu-id="c38de-144">Puede obtener un token mediante la especificación del identificador de cliente y el secreto de cliente desde la aplicación de AAD.</span><span class="sxs-lookup"><span data-stu-id="c38de-144">You get a token by providing the client ID and client secret from the AAD application.</span></span> <span data-ttu-id="c38de-145">No se necesita ningún código especial solo para Azure, como el que se solía usar para controlar el token de Zumo de Servicios móviles.</span><span class="sxs-lookup"><span data-stu-id="c38de-145">No special Azure-only code is required, such as used to be true for handling the Mobile Services Zumo token.</span></span> <span data-ttu-id="c38de-146">Un ejemplo del uso de este escenario por parte de aplicaciones de API de ASP.NET puede encontrarse en el tutorial [Autenticación de entidad de servicio para Aplicaciones de API en el Servicio de aplicaciones de Azure](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="c38de-146">An example of this scenario using ASP.NET API apps is covered by the tutorial [Service principal authentication for API Apps](app-service-api-dotnet-service-principal-auth.md).</span></span>

<span data-ttu-id="c38de-147">Si desea administrar un escenario de servicio a servicio sin usar la autenticación del Servicio de aplicaciones, puede usar certificados de cliente o una autenticación básica.</span><span class="sxs-lookup"><span data-stu-id="c38de-147">If you want to handle a service-to-service scenario without using App Service authentication, you can use client certificates or basic authentication.</span></span> <span data-ttu-id="c38de-148">Para obtener información acerca de los certificados de cliente en Azure, consulte [Configuración de la autenticación mutua de TLS para una aplicación web](../app-service-web/app-service-web-configure-tls-mutual-auth.md).</span><span class="sxs-lookup"><span data-stu-id="c38de-148">For information about client certificates in Azure, see [How To Configure TLS Mutual Authentication for Web Apps](../app-service-web/app-service-web-configure-tls-mutual-auth.md).</span></span> <span data-ttu-id="c38de-149">Para más información sobre la autenticación básica en ASP.NET, consulte [Authentication Filters in ASP.NET Web API 2](http://www.asp.net/web-api/overview/security/authentication-filters)(Filtros de autenticación en ASP.NET Web API 2).</span><span class="sxs-lookup"><span data-stu-id="c38de-149">For information about basic authentication in ASP.NET, see [Authentication Filters in ASP.NET Web API 2](http://www.asp.net/web-api/overview/security/authentication-filters).</span></span>

<span data-ttu-id="c38de-150">La autenticación de cuentas de servicio desde una aplicación lógica de Servicio de aplicaciones en una aplicación de API es un caso especial que se explica en [Uso de la API personalizada hospedada en Servicio de aplicaciones con aplicaciones lógicas](../logic-apps/logic-apps-custom-hosted-api.md).</span><span class="sxs-lookup"><span data-stu-id="c38de-150">Service account authentication from an App Service logic app to an API app is a special case that is explained in [Using your custom API hosted on App Service with Logic apps](../logic-apps/logic-apps-custom-hosted-api.md).</span></span>

## <a name="mobile-client-authentication"></a><span data-ttu-id="c38de-151">Autenticación de cliente móvil</span><span class="sxs-lookup"><span data-stu-id="c38de-151">Mobile client authentication</span></span>
<span data-ttu-id="c38de-152">Para más información sobre cómo controlar la autenticación desde clientes móviles, consulte la [documentación sobre la autenticación para aplicaciones móviles](../app-service-mobile/app-service-mobile-ios-get-started-users.md).</span><span class="sxs-lookup"><span data-stu-id="c38de-152">For information about how to handle authentication from mobile clients, see the [documentation on authentication for mobile apps](../app-service-mobile/app-service-mobile-ios-get-started-users.md).</span></span> <span data-ttu-id="c38de-153">La autenticación de Servicio de aplicaciones funciona igual para aplicaciones móviles y aplicaciones de API.</span><span class="sxs-lookup"><span data-stu-id="c38de-153">App Service authentication works the same way for mobile apps and API apps.</span></span>

## <a name="more-information"></a><span data-ttu-id="c38de-154">Más información</span><span class="sxs-lookup"><span data-stu-id="c38de-154">More information</span></span>
<span data-ttu-id="c38de-155">Para más información sobre la autenticación y la autorización del Servicio de aplicaciones de Azure, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="c38de-155">For more information about authentication and authorization in Azure App Service, see the following resources:</span></span>

* [<span data-ttu-id="c38de-156">Expanding App Service authentication / authorization</span><span class="sxs-lookup"><span data-stu-id="c38de-156">Expanding App Service authentication / authorization</span></span>](https://azure.microsoft.com/blog/announcing-app-service-authentication-authorization/)
* <span data-ttu-id="c38de-157">[How to configure your App Service application to use Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md) (Cómo configurar la aplicación del Servicio de aplicaciones para usar el inicio de sesión de Azure Active Directory), con vínculos a otros proveedores de autenticación en la parte superior de la página.</span><span class="sxs-lookup"><span data-stu-id="c38de-157">[How to configure your App Service application to use Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md) (Includes links for other authentication providers at the top of the page.)</span></span> 

<span data-ttu-id="c38de-158">Para obtener más información sobre OAuth 2.0, OpenID Connect y JSON Web Tokens (JWT), consulte los siguientes recursos.</span><span class="sxs-lookup"><span data-stu-id="c38de-158">For more information about OAuth 2.0, OpenID Connect, and JSON Web Tokens (JWT), see the following resources.</span></span>

* [<span data-ttu-id="c38de-159">Introducción a OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="c38de-159">Getting started with OAuth 2.0</span></span>](http://shop.oreilly.com/product/0636920021810.do "Getting Started with OAuth 2.0") 
* [<span data-ttu-id="c38de-160">Introducción a OAuth2, OpenID Connect y JSON Web Tokens (JWT): curso de Pluralsight</span><span class="sxs-lookup"><span data-stu-id="c38de-160">Introduction to OAuth2, OpenID Connect and JSON Web Tokens (JWT) - Pluralsight Course</span></span>](http://www.pluralsight.com/courses/oauth2-json-web-tokens-openid-connect-introduction) 
* [<span data-ttu-id="c38de-161">Cómo compilar una API de RESTful y garantizar su seguridad para varios clientes en ASP.NET: curso de PluralSight</span><span class="sxs-lookup"><span data-stu-id="c38de-161">Building and Securing a RESTful API for Multiple Clients in ASP.NET - Pluralsight course</span></span>](http://www.pluralsight.com/courses/building-securing-restful-api-aspdotnet)

<span data-ttu-id="c38de-162">Para más información acerca de Azure Active Directory, consulte los siguientes recursos.</span><span class="sxs-lookup"><span data-stu-id="c38de-162">For more information about Azure Active Directory, see the following resources.</span></span>

* [<span data-ttu-id="c38de-163">Escenarios de Azure AD</span><span class="sxs-lookup"><span data-stu-id="c38de-163">Azure AD scenarios</span></span>](http://aka.ms/aadscenarios)
* [<span data-ttu-id="c38de-164">Guía para desarrolladores de Azure AD</span><span class="sxs-lookup"><span data-stu-id="c38de-164">Azure AD developers' guide</span></span>](http://aka.ms/aaddev)
* [<span data-ttu-id="c38de-165">Ejemplos de Azure AD</span><span class="sxs-lookup"><span data-stu-id="c38de-165">Azure AD samples</span></span>](http://aka.ms/aadsamples)

## <a name="next-steps"></a><span data-ttu-id="c38de-166">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="c38de-166">Next steps</span></span>
<span data-ttu-id="c38de-167">En este artículo se han explicado las características de autenticación y autorización del Servicio de aplicaciones que puede utilizar para las aplicaciones de API.</span><span class="sxs-lookup"><span data-stu-id="c38de-167">This article has explained authentication and authorization features of App Service that you can use for API apps.</span></span> <span data-ttu-id="c38de-168">En el siguiente tutorial de la serie de introducción, aprenderá a implementar la [autenticación de usuario para aplicaciones de API del Servicio de aplicaciones](app-service-api-dotnet-user-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="c38de-168">The next tutorial in the getting started series shows how to implement [user authentication in App Service API Apps](app-service-api-dotnet-user-principal-auth.md).</span></span>

