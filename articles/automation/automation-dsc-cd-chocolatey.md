---
title: "aaaAzure implementación continua de DSC de automatización con Chocolatey | Documentos de Microsoft"
description: "Implementación continua de DevOps mediante DSC de Automatización de Azure y el administrador de paquetes Chocolatey.  Ejemplo con plantilla de ARM JSON completa y código fuente de PowerShell."
services: automation
documentationcenter: 
author: eslesar
manager: carmonm
editor: tysonn
ms.assetid: c0baa411-eb76-4f91-8d14-68f68b4805b6
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: na
ms.date: 10/29/2016
ms.author: golive
ms.openlocfilehash: 60af52af5f834fd48e3a0dc4677919397b53f0f4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="usage-example-continuous-deployment-toovirtual-machines-using-automation-dsc-and-chocolatey"></a><span data-ttu-id="0df47-104">Ejemplo de uso: La implementación continua tooVirtual máquinas con DSC de automatización y Chocolatey</span><span class="sxs-lookup"><span data-stu-id="0df47-104">Usage Example: Continuous deployment tooVirtual Machines using Automation DSC and Chocolatey</span></span>
<span data-ttu-id="0df47-105">En un mundo de DevOps hay muchos tooassist de herramientas con varios puntos de canalización de integración continua de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-105">In a DevOps world there are many tools tooassist with various points in hello Continuous Integration pipeline.</span></span>  <span data-ttu-id="0df47-106">Configuración de estado deseado de automatización de Azure (DSC) es un asistente nuevas suma toohello opciones que pueden emplear los equipos de DevOps.</span><span class="sxs-lookup"><span data-stu-id="0df47-106">Azure Automation Desired State Configuration (DSC) is a welcome new addition toohello options that DevOps teams can employ.</span></span>  <span data-ttu-id="0df47-107">En este artículo, se muestra cómo configurar la implementación continua (CD) para un equipo de Windows.</span><span class="sxs-lookup"><span data-stu-id="0df47-107">This article demonstrates setting up Continuous Deployment (CD) for a Windows computer.</span></span>  <span data-ttu-id="0df47-108">Puede ampliar fácilmente Hola técnica tooinclude tantos equipos de Windows según sea necesario en función de hello (por ejemplo, un sitio web) y desde ahí tooadditional roles así.</span><span class="sxs-lookup"><span data-stu-id="0df47-108">You can easily extend hello technique tooinclude as many Windows computers as necessary in hello role (a web site, for example), and from there tooadditional roles as well.</span></span>

![Implementación continua para máquinas virtuales IaaS](./media/automation-dsc-cd-chocolatey/cdforiaasvm.png)

## <a name="at-a-high-level"></a><span data-ttu-id="0df47-110">A nivel general</span><span class="sxs-lookup"><span data-stu-id="0df47-110">At a high level</span></span>
<span data-ttu-id="0df47-111">Aunque todo esto pueda parecer bastante complicado, afortunadamente puede dividirse en dos procesos principales:</span><span class="sxs-lookup"><span data-stu-id="0df47-111">There is quite a bit going on here, but fortunately it can be broken into two main processes:</span></span> 

* <span data-ttu-id="0df47-112">Escribir código y probarlo, crear y publicar paquetes de instalación para las versiones principales y secundarias del sistema de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-112">Writing code and testing it, then creating and publishing installation packages for major and minor versions of hello system.</span></span> 
* <span data-ttu-id="0df47-113">Crear y administrar las máquinas virtuales que se instale y ejecute código de hello en paquetes de saludo.</span><span class="sxs-lookup"><span data-stu-id="0df47-113">Creating and managing VMs that will install and execute hello code in hello packages.</span></span>  

<span data-ttu-id="0df47-114">Una vez que ambos de estos procesos principales están en vigor, es un paquete de Hola de actualización de paso corta tooautomatically con cualquier máquina virtual concreta según las nuevas versiones creadas e implementadas.</span><span class="sxs-lookup"><span data-stu-id="0df47-114">Once both of these core processes are in place, it’s a short step tooautomatically update hello package running on any particular VM as new versions are created and deployed.</span></span>

## <a name="component-overview"></a><span data-ttu-id="0df47-115">Información general sobre los componentes</span><span class="sxs-lookup"><span data-stu-id="0df47-115">Component overview</span></span>
<span data-ttu-id="0df47-116">Administradores del paquete como [apt get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) son muy conocidos en Linux Hola a todos, pero no tanto en el mundo de Windows hello.</span><span class="sxs-lookup"><span data-stu-id="0df47-116">Package managers such as [apt-get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) are pretty well known in hello Linux world, but not so much in hello Windows world.</span></span>  <span data-ttu-id="0df47-117">[Chocolatey](https://chocolatey.org/) es una cosa, como y de Scott Hanselman [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) en hello tema es una introducción excelente.</span><span class="sxs-lookup"><span data-stu-id="0df47-117">[Chocolatey](https://chocolatey.org/) is such a thing, and Scott Hanselman’s [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) on hello topic is a great intro.</span></span>  <span data-ttu-id="0df47-118">En pocas palabras, Chocolatey permite tooinstall paquetes desde un repositorio central de los paquetes en un sistema de Windows mediante la línea de comandos de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-118">In a nutshell, Chocolatey allows you tooinstall packages from a central repository of packages into a Windows system using hello command line.</span></span>  <span data-ttu-id="0df47-119">Puede crear y administrar su propio repositorio y Chocolatey puede instalar paquetes desde cualquier número de repositorios que designe.</span><span class="sxs-lookup"><span data-stu-id="0df47-119">You can create and manage your own repository, and Chocolatey can install packages from any number of repositories that you designate.</span></span>

<span data-ttu-id="0df47-120">Estado de la configuración deseado (DSC) ([Introducción](https://technet.microsoft.com/library/dn249912.aspx)) es una herramienta de PowerShell que permite la configuración de hello toodeclare que desea para una máquina.</span><span class="sxs-lookup"><span data-stu-id="0df47-120">Desired State Configuration (DSC) ([overview](https://technet.microsoft.com/library/dn249912.aspx)) is a PowerShell tool that allows you toodeclare hello configuration that you want for a machine.</span></span>  <span data-ttu-id="0df47-121">Por ejemplo, puede indicar "Quiero instalar Chocolatey, quiero instalar IIS, necesito abrir el puerto 80, quiero instalar la versión 1.0.0 de mi sitio web".</span><span class="sxs-lookup"><span data-stu-id="0df47-121">For example, you can say, “I want Chocolatey installed, I want IIS installed, I want port 80 opened, I want version 1.0.0 of my website installed.”</span></span>  <span data-ttu-id="0df47-122">Administrador de configuración Hello DSC Local (LCM) implementa dicha configuración.</span><span class="sxs-lookup"><span data-stu-id="0df47-122">hello DSC Local Configuration Manager (LCM) implements that configuration.</span></span> <span data-ttu-id="0df47-123">Un servidor de extracción de DSC contiene un repositorio de configuraciones para los equipos.</span><span class="sxs-lookup"><span data-stu-id="0df47-123">A DSC Pull Server holds a repository of configurations for your machines.</span></span> <span data-ttu-id="0df47-124">Hola LCM en cada equipo protege toosee periódicamente si su configuración coincide con la configuración almacenada Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-124">hello LCM on each machine checks in periodically toosee if its configuration matches hello stored configuration.</span></span> <span data-ttu-id="0df47-125">Puede informar del estado o intente toobring máquina de hello en alineación con la configuración almacenada Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-125">It can either report status or attempt toobring hello machine back into alignment with hello stored configuration.</span></span> <span data-ttu-id="0df47-126">Puede editar Hola configuración almacenada en toocause de servidor de extracción de hello una máquina o un conjunto de máquinas toocome en alineación con la configuración de hello cambiado.</span><span class="sxs-lookup"><span data-stu-id="0df47-126">You can edit hello stored configuration on hello pull server toocause a machine or set of machines toocome into alignment with hello changed configuration.</span></span>

<span data-ttu-id="0df47-127">Automatización de Azure es un servicio administrado de Microsoft Azure que le permite tooautomate diversas tareas mediante runbooks, nodos, las credenciales, los recursos y activos como programaciones y las variables globales.</span><span class="sxs-lookup"><span data-stu-id="0df47-127">Azure Automation is a managed service in Microsoft Azure that allows you tooautomate various tasks using runbooks, nodes, credentials, resources and assets such as schedules and global variables.</span></span> <span data-ttu-id="0df47-128">DSC de automatización de Azure amplía esta automatización herramientas de capacidad tooinclude DSC de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0df47-128">Azure Automation DSC extends this automation capability tooinclude PowerShell DSC tools.</span></span>  <span data-ttu-id="0df47-129">Aquí hay una [introducción](automation-dsc-overview.md)muy buena.</span><span class="sxs-lookup"><span data-stu-id="0df47-129">Here’s a great [overview](automation-dsc-overview.md).</span></span>

<span data-ttu-id="0df47-130">Un recurso de DSC es un módulo de código con capacidades específicas, como la administración de redes, Active Directory o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0df47-130">A DSC Resource is a module of code that has specific capabilities, such as managing networking, Active Directory, or SQL Server.</span></span>  <span data-ttu-id="0df47-131">Hola Chocolatey recurso de DSC sabe cómo tooaccess un servidor de NuGet (entre otras cosas), descargar los paquetes, instalar paquetes y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="0df47-131">hello Chocolatey DSC Resource knows how tooaccess a NuGet Server (among others), download packages, install packages, and so on.</span></span>  <span data-ttu-id="0df47-132">Hay muchos otros recursos de DSC en hello [Galería de PowerShell](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span><span class="sxs-lookup"><span data-stu-id="0df47-132">There are many other DSC Resources in hello [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span></span>  <span data-ttu-id="0df47-133">Estos módulos se instalan en el servidor de extracción de DSC de Automatización de Azure (manualmente) para que se puedan usar con sus configuraciones.</span><span class="sxs-lookup"><span data-stu-id="0df47-133">These modules are installed into your Azure Automation DSC Pull Server (by you) so they can be used by your configurations.</span></span>

<span data-ttu-id="0df47-134">Las plantillas de Resource Manager proporcionan una forma declarativa de generar la infraestructura: como las redes, las subredes, la seguridad de red y el enrutamiento, los equilibradores de carga, las NIC, las máquinas virtuales, etc.</span><span class="sxs-lookup"><span data-stu-id="0df47-134">Resource Manager templates provide a declarative way of generating your infrastructure - things like networks, subnets, network security and routing, load balancers, NICs, VMs, and so on.</span></span>  <span data-ttu-id="0df47-135">Este es un [artículo](../azure-resource-manager/resource-manager-deployment-model.md) que compara Hola modelo de implementación del Administrador de recursos (declarativo) con hello administración de servicios de Azure (ASM o estándar) implementación modelo (imperativo) y se describen los recursos principales de hello proveedores, proceso, almacenamiento y red.</span><span class="sxs-lookup"><span data-stu-id="0df47-135">Here’s an [article](../azure-resource-manager/resource-manager-deployment-model.md) that compares hello Resource Manager deployment model (declarative) with hello Azure Service Management (ASM, or classic) deployment model (imperative), and discusses hello core resource providers, compute, storage and network.</span></span>

<span data-ttu-id="0df47-136">Una característica clave de una plantilla de administrador de recursos es su tooinstall capacidad una extensión de máquina virtual en hello VM tal y como se aprovisiona.</span><span class="sxs-lookup"><span data-stu-id="0df47-136">One key feature of an Resource Manager template is its ability tooinstall a VM extension into hello VM as it’s provisioned.</span></span>  <span data-ttu-id="0df47-137">Una extensión de máquina virtual posee capacidades específicas, como ejecutar un script personalizado, instalar software antivirus o ejecutar un script de configuración de DSC.</span><span class="sxs-lookup"><span data-stu-id="0df47-137">A VM extension has specific capabilities such as running a custom script, installing anti-virus software, or running a DSC configuration script.</span></span>  <span data-ttu-id="0df47-138">Existen muchos otros tipos de extensiones de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="0df47-138">There are many other types of VM extensions.</span></span>

## <a name="quick-trip-around-hello-diagram"></a><span data-ttu-id="0df47-139">Recorrido rápido por diagrama Hola</span><span class="sxs-lookup"><span data-stu-id="0df47-139">Quick trip around hello diagram</span></span>
<span data-ttu-id="0df47-140">Comenzando por la parte superior de hello, escribir el código, compilar y probar, a continuación, crear un paquete de instalación.</span><span class="sxs-lookup"><span data-stu-id="0df47-140">Starting at hello top, you write your code, build and test, then create an installation package.</span></span>  <span data-ttu-id="0df47-141">Chocolatey admite diversos tipos de paquetes de instalación, como MSI, MSU o ZIP.</span><span class="sxs-lookup"><span data-stu-id="0df47-141">Chocolatey can handle various types of installation packages, such as MSI, MSU, ZIP.</span></span>  <span data-ttu-id="0df47-142">Y tiene toda la potencia de instalación real de PowerShell toodo Hola Hola si las capacidades nativas de Chocolatey no están bastante seguridad tooit.</span><span class="sxs-lookup"><span data-stu-id="0df47-142">And you have hello full power of PowerShell toodo hello actual installation if Chocolatey’s native capabilities aren’t quite up tooit.</span></span>  <span data-ttu-id="0df47-143">Coloque el paquete de hello en un lugar accesible: un repositorio de paquetes.</span><span class="sxs-lookup"><span data-stu-id="0df47-143">Put hello package into someplace reachable – a package repository.</span></span>  <span data-ttu-id="0df47-144">En este ejemplo de uso se emplea una carpeta pública en una cuenta de almacenamiento de blobs de Azure, pero vale cualquier lugar.</span><span class="sxs-lookup"><span data-stu-id="0df47-144">This usage example uses a public folder in an Azure blob storage account, but it can be anywhere.</span></span>  <span data-ttu-id="0df47-145">Chocolatey funciona de forma nativa con los servidores NuGet y otros para administrar los metadatos de los paquetes.</span><span class="sxs-lookup"><span data-stu-id="0df47-145">Chocolatey works natively with NuGet servers and a few others for management of package metadata.</span></span>  <span data-ttu-id="0df47-146">[En este artículo](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) se describen las opciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-146">[This article](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) describes hello options.</span></span>  <span data-ttu-id="0df47-147">Este ejemplo de uso utiliza NuGet.</span><span class="sxs-lookup"><span data-stu-id="0df47-147">This usage example uses NuGet.</span></span>  <span data-ttu-id="0df47-148">Nuspec son los metadatos de los paquetes.</span><span class="sxs-lookup"><span data-stu-id="0df47-148">A Nuspec is metadata about your packages.</span></span>  <span data-ttu-id="0df47-149">Hello Nuspec es "compila" en del NuPkg y almacenado en un servidor de NuGet.</span><span class="sxs-lookup"><span data-stu-id="0df47-149">hello Nuspec’s are “compiled” into NuPkg’s and stored in a NuGet server.</span></span>  <span data-ttu-id="0df47-150">Cuando la configuración solicita un paquete por su nombre y haga referencia a un servidor de NuGet, hello Chocolatey recurso de DSC (ahora en Hola VM) toma paquete hello y lo instala automáticamente.</span><span class="sxs-lookup"><span data-stu-id="0df47-150">When your configuration requests a package by name, and references a NuGet server, hello Chocolatey DSC Resource (now on hello VM) grabs hello package and installs it for you.</span></span>  <span data-ttu-id="0df47-151">También se puede solicitar una versión específica de un paquete.</span><span class="sxs-lookup"><span data-stu-id="0df47-151">You can also request a specific version of a package.</span></span>

<span data-ttu-id="0df47-152">En hello parte inferior izquierda de la imagen de hello, hay una plantilla de Azure Resource Manager (ARM).</span><span class="sxs-lookup"><span data-stu-id="0df47-152">In hello bottom left portion of hello picture, there is an Azure Resource Manager (ARM) template.</span></span>  <span data-ttu-id="0df47-153">En este ejemplo de uso, Hola extensión de máquina virtual registra Hola VM con hello servidor de extracción de DSC de automatización de Azure (es decir, un servidor de extracción) como un nodo.</span><span class="sxs-lookup"><span data-stu-id="0df47-153">In this usage example, hello VM extension registers hello VM with hello Azure Automation DSC Pull Server (that is, a pull server) as a Node.</span></span>  <span data-ttu-id="0df47-154">configuración de Hola se almacena en el servidor de extracción de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-154">hello configuration is stored in hello pull server.</span></span>  <span data-ttu-id="0df47-155">En realidad, se almacena dos veces: una vez como texto sin formato y otra como archivo MOF (para aquellos a quienes les interese).  En el portal de hello, Hola MOF es una configuración de nodo de"" (como toosimply lugar "configuración").</span><span class="sxs-lookup"><span data-stu-id="0df47-155">Actually, it’s stored twice: once as plain text and once compiled as an MOF file (for those that know about such things.)  In hello portal, hello MOF is a “node configuration” (as opposed toosimply “configuration”).</span></span>  <span data-ttu-id="0df47-156">Su Hola artefacto que está asociado con un nodo para que el nodo de hello sepa su configuración.</span><span class="sxs-lookup"><span data-stu-id="0df47-156">It’s hello artifact that’s associated with a Node so hello node will know its configuration.</span></span>  <span data-ttu-id="0df47-157">Detalles a continuación muestran cómo tooassign Hola nodo toohello de configuración.</span><span class="sxs-lookup"><span data-stu-id="0df47-157">Details below show how tooassign hello node configuration toohello node.</span></span>

<span data-ttu-id="0df47-158">Supuestamente ya está realizando bit de hello en la parte superior de Hola o la mayoría de los datos.</span><span class="sxs-lookup"><span data-stu-id="0df47-158">Presumably you’re already doing hello bit at hello top, or most of it.</span></span>  <span data-ttu-id="0df47-159">Creación de hello nuspec, compilar y almacenar en un servidor de NuGet son algo pequeño.</span><span class="sxs-lookup"><span data-stu-id="0df47-159">Creating hello nuspec, compiling and storing it in a NuGet server is a small thing.</span></span>  <span data-ttu-id="0df47-160">además, ya está administrando máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="0df47-160">And you’re already managing VMs.</span></span>  <span data-ttu-id="0df47-161">Tomar Hola siguiente paso toocontinuous implementación requiere la configuración de servidor de extracción de hello (una vez), registrar los nodos con él (una vez) y crear y almacenar la configuración de Hola allí (inicialmente).</span><span class="sxs-lookup"><span data-stu-id="0df47-161">Taking hello next step toocontinuous deployment requires setting up hello pull server (once), registering your nodes with it (once), and creating and storing hello configuration there (initially).</span></span>  <span data-ttu-id="0df47-162">A continuación, tal y como se actualizan los paquetes e implementan toohello repositorio, actualice Hola configuración y la configuración de nodo en el servidor de extracción de hello (Repita según sea necesario).</span><span class="sxs-lookup"><span data-stu-id="0df47-162">Then as packages are upgraded and deployed toohello repository, refresh hello Configuration and Node Configuration in hello pull server (repeat as needed).</span></span>

<span data-ttu-id="0df47-163">No comenzar con una plantilla de ARM también es perfectamente válido.</span><span class="sxs-lookup"><span data-stu-id="0df47-163">If you’re not starting with an ARM template, that’s also OK.</span></span>  <span data-ttu-id="0df47-164">Hay PowerShell cmdlets diseñados toohelp registrar las máquinas virtuales con servidor de extracción de Hola y todos de rest de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-164">There are PowerShell cmdlets designed toohelp you register your VMs with hello pull server and all of hello rest.</span></span> <span data-ttu-id="0df47-165">Para obtener más detalles, vea este artículo: [Incorporación de máquinas para administrarlas con DSC de Automatización de Azure](automation-dsc-onboarding.md)</span><span class="sxs-lookup"><span data-stu-id="0df47-165">For more details, see this article: [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md)</span></span>

## <a name="step-1-setting-up-hello-pull-server-and-automation-account"></a><span data-ttu-id="0df47-166">Paso 1: Configurar cuenta de servidor y la automatización de la extracción de Hola</span><span class="sxs-lookup"><span data-stu-id="0df47-166">Step 1: Setting up hello pull server and automation account</span></span>
<span data-ttu-id="0df47-167">En una línea de comandos de PowerShell (Add-AzureRmAccount) autenticada: (puede tardar unos minutos mientras se configura el servidor de extracción de hello)</span><span class="sxs-lookup"><span data-stu-id="0df47-167">At an authenticated (Add-AzureRmAccount) PowerShell command line:  (can take a few minutes while hello pull server is set up)</span></span>

    New-AzureRmResourceGroup –Name MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES
    New-AzureRmAutomationAccount –ResourceGroupName MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES –Name MY-AUTOMATION-ACCOUNT 

<span data-ttu-id="0df47-168">Puede colocar su cuenta de automatización en cualquiera de hello después regiones (también conocido como ubicación): este de EE. 2, Ee.uu. Central sur, nos Gov Virginia, Europa occidental, sudeste de Asia, este de Japón, India Central y sudeste Australia, Canadá Central, Europa del Norte.</span><span class="sxs-lookup"><span data-stu-id="0df47-168">You can put your automation account into any of hello following regions (aka location):  East US 2, South Central US, US Gov Virginia, West Europe, Southeast Asia, Japan East, Central India and Australia Southeast, Canada Central, North Europe.</span></span>

## <a name="step-2-vm-extension-tweaks-toohello-arm-template"></a><span data-ttu-id="0df47-169">Paso 2: Plantilla de ARM toohello de ajustes de extensión de máquina virtual</span><span class="sxs-lookup"><span data-stu-id="0df47-169">Step 2: VM extension tweaks toohello ARM template</span></span>
<span data-ttu-id="0df47-170">Detalles de registro de máquina virtual (con la extensión de máquina virtual de DSC de PowerShell de Hola) de este [plantilla de inicio rápido de Azure](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span><span class="sxs-lookup"><span data-stu-id="0df47-170">Details for VM registration (using hello PowerShell DSC VM extension) provided in this [Azure Quickstart Template](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span></span>  <span data-ttu-id="0df47-171">Este paso registra su nueva máquina virtual con el servidor de extracción de hello en la lista de Hola de nodos de DSC.</span><span class="sxs-lookup"><span data-stu-id="0df47-171">This step registers your new VM with hello pull server in hello list of DSC Nodes.</span></span>  <span data-ttu-id="0df47-172">Parte de este registro es especifica Hola nodo Configuración toobe aplica toohello.</span><span class="sxs-lookup"><span data-stu-id="0df47-172">Part of this registration is specifying hello node configuration toobe applied toohello node.</span></span>  <span data-ttu-id="0df47-173">Esta configuración de nodo aún no tiene tooexist en el servidor de extracción de hello, por lo que es aceptar que paso 4 es donde esto se lleva a cabo para hello primera vez.</span><span class="sxs-lookup"><span data-stu-id="0df47-173">This node configuration doesn't have tooexist yet in hello pull server, so it's OK that Step 4 is where this is done for hello first time.</span></span>  <span data-ttu-id="0df47-174">Pero aquí en el paso 2 es necesario nombre de Hola decidido de toohave del nodo de Hola y Hola de configuración de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-174">But here in Step 2 you do need toohave decided hello name of hello node and hello name of hello configuration.</span></span>  <span data-ttu-id="0df47-175">En este ejemplo de uso, nodo de hello es 'isvbox' y configuración de hello es 'ISVBoxConfig'.</span><span class="sxs-lookup"><span data-stu-id="0df47-175">In this usage example, hello node is 'isvbox' and hello configuration is 'ISVBoxConfig'.</span></span>  <span data-ttu-id="0df47-176">Por lo que el nombre de configuración de nodo de hello (toobe especificado en DeploymentTemplate.json) es 'ISVBoxConfig.isvbox'.</span><span class="sxs-lookup"><span data-stu-id="0df47-176">So hello node configuration name (toobe specified in DeploymentTemplate.json) is 'ISVBoxConfig.isvbox'.</span></span>  

## <a name="step-3-adding-required-dsc-resources-toohello-pull-server"></a><span data-ttu-id="0df47-177">Paso 3: Agregar servidor de extracción de toohello de recursos de DSC necesarios</span><span class="sxs-lookup"><span data-stu-id="0df47-177">Step 3: Adding required DSC resources toohello pull server</span></span>
<span data-ttu-id="0df47-178">Hola Galería de PowerShell es instrumentada tooinstall los recursos de DSC en su cuenta de automatización de Azure.</span><span class="sxs-lookup"><span data-stu-id="0df47-178">hello PowerShell Gallery is instrumented tooinstall DSC resources into your Azure Automation account.</span></span>  <span data-ttu-id="0df47-179">Navegar toohello recurso que desee y haga clic en el botón de "Implementar tooAzure automatización" Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-179">Navigate toohello resource you want and click hello “Deploy tooAzure Automation” button.</span></span>

![Ejemplo de la Galería de PowerShell](./media/automation-dsc-cd-chocolatey/xNetworking.PNG)

<span data-ttu-id="0df47-181">Otra técnica agregado recientemente toohello Portal de Azure permite toopull en nuevos módulos o módulos de actualización existente.</span><span class="sxs-lookup"><span data-stu-id="0df47-181">Another technique recently added toohello Azure Portal allows you toopull in new modules or update existing modules.</span></span> <span data-ttu-id="0df47-182">Desplazarse por los recursos de la cuenta de automatización de hello, mosaico de activos de hello y, finalmente, mosaico de módulos de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-182">Click through hello Automation Account resource, hello Assets tile, and finally hello Modules tile.</span></span>  <span data-ttu-id="0df47-183">icono de examinar la Galería de Hello permite lista de hello toosee de módulos en la Galería de hello, profundizar en los detalles e importar en última instancia a la cuenta de automatización.</span><span class="sxs-lookup"><span data-stu-id="0df47-183">hello Browse Gallery icon allows you toosee hello list of modules in hello gallery, drill down into details and ultimately import into your Automation Account.</span></span> <span data-ttu-id="0df47-184">Esto es una excelente manera tookeep los módulos de seguridad toodate de tootime de tiempo.</span><span class="sxs-lookup"><span data-stu-id="0df47-184">This is a great way tookeep your modules up toodate from time tootime.</span></span> <span data-ttu-id="0df47-185">Además, la característica de importación de hello comprueba las dependencias con otro tooensure módulos que nada obtiene no está sincronizado.</span><span class="sxs-lookup"><span data-stu-id="0df47-185">And, hello import feature checks dependencies with other modules tooensure nothing gets out of sync.</span></span>

<span data-ttu-id="0df47-186">O bien, hay enfoque manual Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-186">Or, there’s hello manual approach.</span></span>  <span data-ttu-id="0df47-187">estructura de carpetas de Hola de un módulo de integración de PowerShell para un equipo de Windows es un poco diferente de la estructura de carpetas de hello esperada Hola automatización de Azure.</span><span class="sxs-lookup"><span data-stu-id="0df47-187">hello folder structure of a PowerShell Integration Module for a Windows computer is a little different from hello folder structure expected by hello Azure Automation.</span></span>  <span data-ttu-id="0df47-188">Por tanto, es necesario hacer algunos ajustes.</span><span class="sxs-lookup"><span data-stu-id="0df47-188">This requires a little tweaking on your part.</span></span>  <span data-ttu-id="0df47-189">Pero no es difícil, y se realiza una sola vez por recurso (a menos que desee tooupgrade que en el futuro.)  Para más información sobre la creación de módulos de integración de PowerShell, consulte este artículo: [Creación de módulos de integración para Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/).</span><span class="sxs-lookup"><span data-stu-id="0df47-189">But it’s not hard, and it’s done only once per resource (unless you want tooupgrade it in future.)  For more information on authoring PowerShell Integration Modules, see this article: [Authoring Integration Modules for Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span></span>

* <span data-ttu-id="0df47-190">Instalar el módulo de Hola que necesita en la estación de trabajo, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="0df47-190">Install hello module that you need on your workstation, as follows:</span></span>
  * <span data-ttu-id="0df47-191">Instale [Windows Management Framework, v5](http://aka.ms/wmf5latest) (no es necesario para Windows 10).</span><span class="sxs-lookup"><span data-stu-id="0df47-191">Install [Windows Management Framework, v5](http://aka.ms/wmf5latest) (not needed for Windows 10)</span></span>
  * <span data-ttu-id="0df47-192">`Install-Module –Name MODULE-NAME`<: grabs Hola módulo desde la Galería de PowerShell de Hola</span><span class="sxs-lookup"><span data-stu-id="0df47-192">`Install-Module –Name MODULE-NAME`    <—grabs hello module from hello PowerShell Gallery</span></span> 
* <span data-ttu-id="0df47-193">Desde la carpeta de copia Hola módulo `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` carpeta temporal tooa</span><span class="sxs-lookup"><span data-stu-id="0df47-193">Copy hello module folder from `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa temp folder</span></span> 
* <span data-ttu-id="0df47-194">Retire la carpeta principal de Hola de documentación y ejemplos</span><span class="sxs-lookup"><span data-stu-id="0df47-194">Delete samples and documentation from hello main folder</span></span> 
* <span data-ttu-id="0df47-195">Carpeta principal de ZIP hello, nombres de archivo ZIP de hello exactamente igual Hola como carpeta de Hola</span><span class="sxs-lookup"><span data-stu-id="0df47-195">Zip hello main folder, naming hello ZIP file exactly hello same as hello folder</span></span> 
* <span data-ttu-id="0df47-196">Coloque el archivo ZIP de hello en una ubicación accesible de HTTP, como almacenamiento de blobs en una cuenta de almacenamiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="0df47-196">Put hello ZIP file into a reachable HTTP location, such as blob storage in an Azure Storage Account.</span></span>
* <span data-ttu-id="0df47-197">Ejecute este código de PowerShell:</span><span class="sxs-lookup"><span data-stu-id="0df47-197">Run this PowerShell:</span></span>
  
      New-AzureRmAutomationModule `
          -ResourceGroupName MY-AUTOMATION-RG -AutomationAccountName MY-AUTOMATION-ACCOUNT `
          -Name MODULE-NAME –ContentLink "https://STORAGE-URI/CONTAINERNAME/MODULE-NAME.zip"

<span data-ttu-id="0df47-198">ejemplo de Hola incluida realiza estos pasos para cChoco y xNetworking.</span><span class="sxs-lookup"><span data-stu-id="0df47-198">hello included example performs these steps for cChoco and xNetworking.</span></span> <span data-ttu-id="0df47-199">Vea hello [notas](#notes) para un control especial para cChoco.</span><span class="sxs-lookup"><span data-stu-id="0df47-199">See hello [Notes](#notes) for special handling for cChoco.</span></span>

## <a name="step-4-adding-hello-node-configuration-toohello-pull-server"></a><span data-ttu-id="0df47-200">Paso 4: Agregar servidor de extracción de hello nodo Configuración toohello</span><span class="sxs-lookup"><span data-stu-id="0df47-200">Step 4: Adding hello node configuration toohello pull server</span></span>
<span data-ttu-id="0df47-201">No hay nada especial acerca de hello primera vez que importar la configuración en el servidor de extracción de Hola y de compilación.</span><span class="sxs-lookup"><span data-stu-id="0df47-201">There’s nothing special about hello first time you import your configuration into hello pull server and compile.</span></span>  <span data-ttu-id="0df47-202">Compilaciones de importación posteriores todos de hello mismo aspecto configuración Hola exactamente igual.</span><span class="sxs-lookup"><span data-stu-id="0df47-202">All subsequent import/compiles of hello same configuration look exactly hello same.</span></span>  <span data-ttu-id="0df47-203">Cada vez que el paquete de actualización y necesita toopush horizontal tooproduction que realice este paso después de asegurarse de archivo de configuración de hello es correcta: incluidos Hola nueva versión del paquete.</span><span class="sxs-lookup"><span data-stu-id="0df47-203">Each time you update your package and need toopush it out tooproduction you do this step after ensuring hello configuration file is correct – including hello new version of your package.</span></span>  <span data-ttu-id="0df47-204">Este es el archivo de configuración de Hola y PowerShell:</span><span class="sxs-lookup"><span data-stu-id="0df47-204">Here’s hello configuration file and PowerShell:</span></span>

<span data-ttu-id="0df47-205">ISVBoxConfig.ps1:</span><span class="sxs-lookup"><span data-stu-id="0df47-205">ISVBoxConfig.ps1:</span></span>

    Configuration ISVBoxConfig 
    { 
        Import-DscResource -ModuleName cChoco 
        Import-DscResource -ModuleName xNetworking

        Node "isvbox" {   

            cChocoInstaller installChoco 
            { 
                InstallDir = "C:\choco" 
            }

            WindowsFeature installIIS 
            { 
                Ensure="Present" 
                Name="Web-Server" 
            }

            xFirewall WebFirewallRule 
            { 
                Direction = "Inbound" 
                Name = "Web-Server-TCP-In" 
                DisplayName = "Web Server (TCP-In)" 
                Description = "IIS allow incoming web site traffic." 
                DisplayGroup = "IIS Incoming Traffic" 
                State = "Enabled" 
                Access = "Allow" 
                Protocol = "TCP" 
                LocalPort = "80" 
                Ensure = "Present" 
            }

            cChocoPackageInstaller trivialWeb 
            {            
                Name = "trivialweb" 
                Version = "1.0.0" 
                Source = “MY-NUGET-V2-SERVER-ADDRESS” 
                DependsOn = "[cChocoInstaller]installChoco", 
                "[WindowsFeature]installIIS" 
            } 
        }    
    }

<span data-ttu-id="0df47-206">New-ConfigurationScript.ps1:</span><span class="sxs-lookup"><span data-stu-id="0df47-206">New-ConfigurationScript.ps1:</span></span>

    Import-AzureRmAutomationDscConfiguration ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -SourcePath C:\temp\AzureAutomationDsc\ISVBoxConfig.ps1 ` 
        -Published –Force

    $jobData = Start-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -ConfigurationName ISVBoxConfig 

    $compilationJobId = $jobData.Id

    Get-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -Id $compilationJobId

<span data-ttu-id="0df47-207">Estos resultados de pasos en una nueva configuración de nodo denominan "ISVBoxConfig.isvbox" que se ubican en el servidor de extracción de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-207">These steps result in a new node configuration named “ISVBoxConfig.isvbox” being placed on hello pull server.</span></span>  <span data-ttu-id="0df47-208">nombre de configuración de nodo de Hola se compila como "configurationName.nodeName".</span><span class="sxs-lookup"><span data-stu-id="0df47-208">hello node configuration name is built as “configurationName.nodeName”.</span></span>

## <a name="step-5-creating-and-maintaining-package-metadata"></a><span data-ttu-id="0df47-209">Paso 5: Crear y mantener los metadatos del paquete</span><span class="sxs-lookup"><span data-stu-id="0df47-209">Step 5: Creating and maintaining package metadata</span></span>
<span data-ttu-id="0df47-210">Para cada paquete que incluya en el repositorio de paquetes de saludo, necesita un nuspec que lo describe.</span><span class="sxs-lookup"><span data-stu-id="0df47-210">For each package that you put into hello package repository, you need a nuspec that describes it.</span></span>  <span data-ttu-id="0df47-211">Ese nuspec se debe compilar y almacenar en el servidor NuGet.</span><span class="sxs-lookup"><span data-stu-id="0df47-211">That nuspec must be compiled and stored in your NuGet server.</span></span> <span data-ttu-id="0df47-212">Este proceso se describe [aquí](http://docs.nuget.org/create/creating-and-publishing-a-package).</span><span class="sxs-lookup"><span data-stu-id="0df47-212">This process is described [here](http://docs.nuget.org/create/creating-and-publishing-a-package).</span></span>  <span data-ttu-id="0df47-213">Puede usar MyGet.org como servidor NuGet.</span><span class="sxs-lookup"><span data-stu-id="0df47-213">You can use MyGet.org as a NuGet server.</span></span>  <span data-ttu-id="0df47-214">Se vende este servicio, pero también se ofrece una SKU de inicio gratuita.</span><span class="sxs-lookup"><span data-stu-id="0df47-214">They sell this service, but have a starter SKU that’s free.</span></span>  <span data-ttu-id="0df47-215">En NuGet.org encontrará instrucciones para instalar su propio servidor NuGet para los paquetes privados.</span><span class="sxs-lookup"><span data-stu-id="0df47-215">At NuGet.org you’ll find instructions on installing your own NuGet server for your private packages.</span></span>

## <a name="step-6-tying-it-all-together"></a><span data-ttu-id="0df47-216">Paso 6: Unión de todos los elementos</span><span class="sxs-lookup"><span data-stu-id="0df47-216">Step 6: Tying it all together</span></span>
<span data-ttu-id="0df47-217">Cada vez que pasa el control de calidad de una versión y se aprueba para la implementación, se crea el paquete de hello, nuspec nupkg y actualizan había implementado toohello NuGet servidor.</span><span class="sxs-lookup"><span data-stu-id="0df47-217">Each time a version passes QA and is approved for deployment, hello package is created, nuspec and nupkg updated and deployed toohello NuGet server.</span></span>  <span data-ttu-id="0df47-218">Además, Hola configuración (paso 4 anterior) debe estar tooagree actualizada con nuevo número de versión de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-218">In addition, hello configuration (Step 4 above) must be updated tooagree with hello new version number.</span></span>  <span data-ttu-id="0df47-219">Se debe enviar toohello servidor de extracción y compilado.</span><span class="sxs-lookup"><span data-stu-id="0df47-219">It must be sent toohello pull server and compiled.</span></span>  <span data-ttu-id="0df47-220">Desde ese momento, resulta las máquinas virtuales de toohello dependen de esa actualización de configuración toopull Hola e instalarlo.</span><span class="sxs-lookup"><span data-stu-id="0df47-220">From that point on, it's up toohello VMs that depend on that configuration toopull hello update and install it.</span></span>  <span data-ttu-id="0df47-221">Cada una de estas actualizaciones son sencillas: solo una línea o dos de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0df47-221">Each of these updates are simple - just a line or two of PowerShell.</span></span>  <span data-ttu-id="0df47-222">En caso de hello de Visual Studio Team Services, algunas de ellas se encapsulan en tareas de compilación que se pueden encadenar juntas en una compilación.</span><span class="sxs-lookup"><span data-stu-id="0df47-222">In hello case of Visual Studio Team Services, some of them are encapsulated in build tasks that can be chained together in a build.</span></span>  <span data-ttu-id="0df47-223">En [este artículo](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) se ofrecen más detalles.</span><span class="sxs-lookup"><span data-stu-id="0df47-223">This [article](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) provides more details.</span></span>  <span data-ttu-id="0df47-224">Esto [repositorio de GitHub](https://github.com/Microsoft/vso-agent-tasks) detalles Hola diversas tareas de compilación disponible.</span><span class="sxs-lookup"><span data-stu-id="0df47-224">This [GitHub repo](https://github.com/Microsoft/vso-agent-tasks) details hello various available build tasks.</span></span>

## <a name="notes"></a><span data-ttu-id="0df47-225">Notas</span><span class="sxs-lookup"><span data-stu-id="0df47-225">Notes</span></span>
<span data-ttu-id="0df47-226">Este ejemplo de uso se inicia con una máquina virtual desde una imagen de Windows Server 2012 R2 genérica de hello Galería de Azure.</span><span class="sxs-lookup"><span data-stu-id="0df47-226">This usage example starts with a VM from a generic Windows Server 2012 R2 image from hello Azure gallery.</span></span>  <span data-ttu-id="0df47-227">Puede iniciar desde cualquier imagen almacenada y, a continuación, ajustar desde ahí con la configuración de DSC Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-227">You can start from any stored image and then tweak from there with hello DSC configuration.</span></span>  <span data-ttu-id="0df47-228">Sin embargo, el cambio de configuración que está preparado a una imagen es mucho más difícil que actualizar dinámicamente la configuración de hello mediante DSC.</span><span class="sxs-lookup"><span data-stu-id="0df47-228">However, changing configuration that is baked into an image is much harder than dynamically updating hello configuration using DSC.</span></span>

<span data-ttu-id="0df47-229">No tienes toouse una plantilla de ARM y Hola VM extensión toouse esta técnica con sus máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="0df47-229">You don’t have toouse an ARM template and hello VM extension toouse this technique with your VMs.</span></span>  <span data-ttu-id="0df47-230">Y las máquinas virtuales no tienen toobe en Azure toobe bajo la administración de CD.</span><span class="sxs-lookup"><span data-stu-id="0df47-230">And your VMs don’t have toobe on Azure toobe under CD management.</span></span>  <span data-ttu-id="0df47-231">Todo lo que es necesaria que Chocolatey se instalado y hello LCM configurada en hello VM para que sepa dónde hello servidor de extracción es.</span><span class="sxs-lookup"><span data-stu-id="0df47-231">All that’s necessary is that Chocolatey be installed and hello LCM configured on hello VM so it knows where hello pull server is.</span></span>  

<span data-ttu-id="0df47-232">Por supuesto, cuando se actualiza un paquete en una máquina virtual que se encuentre en producción, debe tootake esa máquina virtual fuera de la rotación mientras se instala la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-232">Of course, when you update a package on a VM that’s in production, you need tootake that VM out of rotation while hello update is installed.</span></span>  <span data-ttu-id="0df47-233">Existen métodos muy diversos de hacerlo.</span><span class="sxs-lookup"><span data-stu-id="0df47-233">How you do this varies widely.</span></span>  <span data-ttu-id="0df47-234">Por ejemplo, con una máquina virtual tras un equilibrador de carga de Azure, puede agregar un sondeo personalizado.</span><span class="sxs-lookup"><span data-stu-id="0df47-234">For example, with a VM behind an Azure Load Balancer, you can add a Custom Probe.</span></span>  <span data-ttu-id="0df47-235">Al actualizar Hola VM, tener extremo de sondeo de hello un código de estado 400.</span><span class="sxs-lookup"><span data-stu-id="0df47-235">While updating hello VM, have hello probe endpoint return a 400.</span></span>  <span data-ttu-id="0df47-236">Hola deformación necesarios toocause este cambio puede ser dentro de la configuración, como puede Hola tooswitch deformación nuevo tooreturning 200 una vez completada la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="0df47-236">hello tweak necessary toocause this change can be inside your configuration, as can hello tweak tooswitch it back tooreturning a 200 once hello update is complete.</span></span>

<span data-ttu-id="0df47-237">El código fuente completo de este ejemplo de uso se encuentra en [este proyecto de Visual Studio](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) en GitHub.</span><span class="sxs-lookup"><span data-stu-id="0df47-237">Full source for this usage example is in [this Visual Studio project](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) on GitHub.</span></span>

## <a name="related-articles"></a><span data-ttu-id="0df47-238">Artículos relacionados</span><span class="sxs-lookup"><span data-stu-id="0df47-238">Related Articles</span></span>
* [<span data-ttu-id="0df47-239">Información general de DSC de Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="0df47-239">Azure Automation DSC Overview</span></span>](automation-dsc-overview.md)
* [<span data-ttu-id="0df47-240">Cmdlets de DSC de Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="0df47-240">Azure Automation DSC cmdlets</span></span>](https://msdn.microsoft.com/library/mt244122.aspx)
* [<span data-ttu-id="0df47-241">Incorporación de máquinas para administrarlas con DSC de Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="0df47-241">Onboarding machines for management by Azure Automation DSC</span></span>](automation-dsc-onboarding.md)

