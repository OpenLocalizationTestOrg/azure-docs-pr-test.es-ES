---
title: "Ejecución de un runbook en Azure Automation | Microsoft Docs"
description: "Describe los detalles de cómo se procesa un runbook en Automatización de Azure."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: d10c8ce2-2c0b-4ea7-ba3c-d20e09b2c9ca
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/17/2017
ms.author: bwren
ms.openlocfilehash: 14f923e3f08dd3b286218ae56012ce14edcc4058
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="runbook-execution-in-azure-automation"></a><span data-ttu-id="3407b-103">Ejecución de un runbook en Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="3407b-103">Runbook execution in Azure Automation</span></span>
<span data-ttu-id="3407b-104">Cuando se inicia un runbook en Automatización de Azure, se crea un trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-104">When you start a runbook in Azure Automation, a job is created.</span></span> <span data-ttu-id="3407b-105">Un trabajo es una instancia única de ejecución de un runbook.</span><span class="sxs-lookup"><span data-stu-id="3407b-105">A job is a single execution instance of a runbook.</span></span> <span data-ttu-id="3407b-106">Un trabajador de Automatización de Azure está asignado para ejecutar cada trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-106">An Azure Automation worker is assigned to run each job.</span></span> <span data-ttu-id="3407b-107">Aunque los trabajadores se comparten por varias cuentas de Azure, los trabajos de diferentes cuentas de Automatización están aislados entre sí.</span><span class="sxs-lookup"><span data-stu-id="3407b-107">While workers are shared by multiple Azure accounts, jobs from different Automation accounts are isolated from one another.</span></span> <span data-ttu-id="3407b-108">No tiene el control sobre qué trabajador presta servicio a la solicitud para el trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-108">You do not have control over which worker services the request for your job.</span></span>  <span data-ttu-id="3407b-109">Un único runbook puede tener varios trabajos que se ejecutan al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="3407b-109">A single runbook can have multiple jobs running at one time.</span></span> <span data-ttu-id="3407b-110">Al ver la lista de runbooks en Azure Portal, se muesta el estado de todos los trabajos iniciados por cada runbook.</span><span class="sxs-lookup"><span data-stu-id="3407b-110">When you view the list of runbooks in the Azure portal, it lists the status of all jobs that were started for each runbook.</span></span> <span data-ttu-id="3407b-111">Puede ver la lista de trabajos para cada runbook para hacer un seguimiento del estado de cada uno.</span><span class="sxs-lookup"><span data-stu-id="3407b-111">You can view the list of jobs for each runbook in order to track the status of each.</span></span> <span data-ttu-id="3407b-112">Para obtener una descripción de los distintos estados de trabajo, consulte [Estados del trabajo](#job-statuses).</span><span class="sxs-lookup"><span data-stu-id="3407b-112">For a description of the different job statuses, see [Job Statuses](#job-statuses).</span></span>

<span data-ttu-id="3407b-113">En el siguiente diagrama se muestra el ciclo de vida de un trabajo de runbook para [Runbooks gráficos](automation-runbook-types.md#graphical-runbooks) y [Runbooks del flujo de trabajo de PowerShell](automation-runbook-types.md#powershell-workflow-runbooks).</span><span class="sxs-lookup"><span data-stu-id="3407b-113">The following diagram shows the lifecycle of a runbook job for [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) and [PowerShell Workflow runbooks](automation-runbook-types.md#powershell-workflow-runbooks).</span></span>

![Estados de trabajo: flujo de trabajo de PowerShell](./media/automation-runbook-execution/job-statuses.png)

<span data-ttu-id="3407b-115">En el siguiente diagrama se muestra el ciclo de vida de un trabajo de runbook para [runbooks de PowerShell](automation-runbook-types.md#powershell-runbooks).</span><span class="sxs-lookup"><span data-stu-id="3407b-115">The following diagram shows the lifecycle of a runbook job for [PowerShell runbooks](automation-runbook-types.md#powershell-runbooks).</span></span>

![Estados de trabajo: script de PowerShell](./media/automation-runbook-execution/job-statuses-script.png)

<span data-ttu-id="3407b-117">Los trabajos tienen acceso a los recursos de Azure mediante una conexión a la suscripción de Azure.</span><span class="sxs-lookup"><span data-stu-id="3407b-117">Your jobs have access to your Azure resources by making a connection to your Azure subscription.</span></span> <span data-ttu-id="3407b-118">Solo tienen acceso a los recursos de su centro de datos si estos recursos están accesibles desde la nube pública.</span><span class="sxs-lookup"><span data-stu-id="3407b-118">They only have access to resources in your data center if those resources are accessible from the public cloud.</span></span>

## <a name="job-statuses"></a><span data-ttu-id="3407b-119">Estados del trabajo</span><span class="sxs-lookup"><span data-stu-id="3407b-119">Job statuses</span></span>
<span data-ttu-id="3407b-120">En la tabla siguiente se describen los diferentes estados posibles para un trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-120">The following table describes the different statuses that are possible for a job.</span></span>

| <span data-ttu-id="3407b-121">Status</span><span class="sxs-lookup"><span data-stu-id="3407b-121">Status</span></span> | <span data-ttu-id="3407b-122">Descripción</span><span class="sxs-lookup"><span data-stu-id="3407b-122">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="3407b-123">Completed</span><span class="sxs-lookup"><span data-stu-id="3407b-123">Completed</span></span> |<span data-ttu-id="3407b-124">El trabajo se completó correctamente.</span><span class="sxs-lookup"><span data-stu-id="3407b-124">The job completed successfully.</span></span> |
| <span data-ttu-id="3407b-125">Con error</span><span class="sxs-lookup"><span data-stu-id="3407b-125">Failed</span></span> |<span data-ttu-id="3407b-126">Para [Runbooks del flujo de trabajo de PowerShell](automation-runbook-types.md), no se pudo compilar el runbook.</span><span class="sxs-lookup"><span data-stu-id="3407b-126">For [Graphical and PowerShell Workflow runbooks](automation-runbook-types.md), the runbook failed to compile.</span></span>  <span data-ttu-id="3407b-127">Para [Runbooks de script de PowerShell](automation-runbook-types.md), no se pudo iniciar el runbook o el trabajo encontró una excepción.</span><span class="sxs-lookup"><span data-stu-id="3407b-127">For [PowerShell Script runbooks](automation-runbook-types.md), the runbook failed to start or the job encountered an exception.</span></span> |
| <span data-ttu-id="3407b-128">Error, esperando recursos</span><span class="sxs-lookup"><span data-stu-id="3407b-128">Failed, waiting for resources</span></span> |<span data-ttu-id="3407b-129">Se produjo un error en el trabajo porque ha alcanzado el límite de [distribución equilibrada](#fairshare) tres veces y se ha iniciado en el mismo punto de control o en el inicio del runbook cada vez.</span><span class="sxs-lookup"><span data-stu-id="3407b-129">The job failed because it reached the [fair share](#fairshare) limit three times and started from the same checkpoint or from the start of the runbook each time.</span></span> |
| <span data-ttu-id="3407b-130">En cola</span><span class="sxs-lookup"><span data-stu-id="3407b-130">Queued</span></span> |<span data-ttu-id="3407b-131">El trabajo espera que los recursos en un trabajador de Automatización estén disponible para que se puede iniciar.</span><span class="sxs-lookup"><span data-stu-id="3407b-131">The job is waiting for resources on an Automation worker to come available so that it can be started.</span></span> |
| <span data-ttu-id="3407b-132">Iniciando</span><span class="sxs-lookup"><span data-stu-id="3407b-132">Starting</span></span> |<span data-ttu-id="3407b-133">El trabajo se ha asignado a un trabajador y el sistema está en proceso de iniciarse.</span><span class="sxs-lookup"><span data-stu-id="3407b-133">The job has been assigned to a worker, and the system is in the process of starting it.</span></span> |
| <span data-ttu-id="3407b-134">Reanudando</span><span class="sxs-lookup"><span data-stu-id="3407b-134">Resuming</span></span> |<span data-ttu-id="3407b-135">El sistema está en proceso de reanudar el trabajo después de que se suspendió.</span><span class="sxs-lookup"><span data-stu-id="3407b-135">The system is in the process of resuming the job after it was suspended.</span></span> |
| <span data-ttu-id="3407b-136">Ejecución</span><span class="sxs-lookup"><span data-stu-id="3407b-136">Running</span></span> |<span data-ttu-id="3407b-137">El trabajo se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="3407b-137">The job is running.</span></span> |
| <span data-ttu-id="3407b-138">En ejecución, esperando recursos</span><span class="sxs-lookup"><span data-stu-id="3407b-138">Running, waiting for resources</span></span> |<span data-ttu-id="3407b-139">El trabajo se ha descargado porque ha alcanzado el límite de [distribución equilibrada](#fairshare) .</span><span class="sxs-lookup"><span data-stu-id="3407b-139">The job has been unloaded because it reached the [fair share](#fairshare) limit.</span></span> <span data-ttu-id="3407b-140">Se reanuda en breve desde su último punto de control.</span><span class="sxs-lookup"><span data-stu-id="3407b-140">It resumes shortly from its last checkpoint.</span></span> |
| <span data-ttu-id="3407b-141">Stopped</span><span class="sxs-lookup"><span data-stu-id="3407b-141">Stopped</span></span> |<span data-ttu-id="3407b-142">El trabajo lo detuvo el usuario antes de completarse.</span><span class="sxs-lookup"><span data-stu-id="3407b-142">The job was stopped by the user before it was completed.</span></span> |
| <span data-ttu-id="3407b-143">Deteniéndose</span><span class="sxs-lookup"><span data-stu-id="3407b-143">Stopping</span></span> |<span data-ttu-id="3407b-144">El sistema está en proceso de detener el trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-144">The system is in the process of stopping the job.</span></span> |
| <span data-ttu-id="3407b-145">Suspended</span><span class="sxs-lookup"><span data-stu-id="3407b-145">Suspended</span></span> |<span data-ttu-id="3407b-146">El trabajo lo ha suspendido el usuario, el sistema o un comando en el runbook.</span><span class="sxs-lookup"><span data-stu-id="3407b-146">The job was suspended by the user, by the system, or by a command in the runbook.</span></span> <span data-ttu-id="3407b-147">Un trabajo suspendido se puede iniciar de nuevo y se reanuda desde su último punto de control o desde el principio del runbook si no tiene ningún punto de control.</span><span class="sxs-lookup"><span data-stu-id="3407b-147">A job that is suspended can be started again and resume from its last checkpoint or from the beginning of the runbook if it doesn't have checkpoints.</span></span> <span data-ttu-id="3407b-148">El runbook solo lo suspenderá el sistema al producirse una excepción.</span><span class="sxs-lookup"><span data-stu-id="3407b-148">The runbook will only be suspended by the system when an exception occurs.</span></span> <span data-ttu-id="3407b-149">De forma predeterminada, se establece ErrorActionPreference en **Continuar**, lo que significa que el trabajo sigue ejecutándose en un error.</span><span class="sxs-lookup"><span data-stu-id="3407b-149">By default, ErrorActionPreference is set to **Continue**, meaning that the job keeps running on an error.</span></span> <span data-ttu-id="3407b-150">Si se establece esta variable de preferencia en **Detener**, se suspende el trabajo en un error.</span><span class="sxs-lookup"><span data-stu-id="3407b-150">If this preference variable is set to **Stop**, then the job suspends on an error.</span></span>  <span data-ttu-id="3407b-151">Solo se aplica a [Runbooks de flujo de trabajo de PowerShell y gráficos](automation-runbook-types.md) .</span><span class="sxs-lookup"><span data-stu-id="3407b-151">Applies to [Graphical and PowerShell Workflow runbooks](automation-runbook-types.md) only.</span></span> |
| <span data-ttu-id="3407b-152">Suspendiendo</span><span class="sxs-lookup"><span data-stu-id="3407b-152">Suspending</span></span> |<span data-ttu-id="3407b-153">El sistema está intentando suspender el trabajo a petición del usuario.</span><span class="sxs-lookup"><span data-stu-id="3407b-153">The system is attempting to suspend the job at the request of the user.</span></span> <span data-ttu-id="3407b-154">El runbook debe alcanzar su siguiente punto de control antes de que se pueda suspender.</span><span class="sxs-lookup"><span data-stu-id="3407b-154">The runbook must reach its next checkpoint before it can be suspended.</span></span> <span data-ttu-id="3407b-155">Si ya ha pasado su último punto de control, se completa antes de que se pueda suspender.</span><span class="sxs-lookup"><span data-stu-id="3407b-155">If it already passed its last checkpoint, then it completes before it can be suspended.</span></span>  <span data-ttu-id="3407b-156">Solo se aplica a [Runbooks de flujo de trabajo de PowerShell y gráficos](automation-runbook-types.md) .</span><span class="sxs-lookup"><span data-stu-id="3407b-156">Applies to [Graphical and PowerShell Workflow runbooks](automation-runbook-types.md) only.</span></span> |

## <a name="viewing-job-status-from-the-azure-portal"></a><span data-ttu-id="3407b-157">Visualización de un estado de trabajo desde el portal de Azure</span><span class="sxs-lookup"><span data-stu-id="3407b-157">Viewing job status from the Azure portal</span></span>
<span data-ttu-id="3407b-158">Puede ver un resumen del estado de todos los trabajos de runbook o profundizar en los detalles de un trabajo de runbook específico en el portal de Azure o mediante la configuración de la integración con el área de trabajo Log Analytics de Microsoft Operations Management Suite (OMS) para reenviar el estado del trabajo de runbook y las transmisiones de trabajos.</span><span class="sxs-lookup"><span data-stu-id="3407b-158">You can view a summarized status of all runbook jobs or drill into details of a specific runbook job in the Azure portal or by configuring integration with your Microsoft Operations Management Suite (OMS) Log Analytics workspace to forward runbook job status and job streams.</span></span>  <span data-ttu-id="3407b-159">Para más información sobre la integración con Log Analytics de OMS, consulte [Reenvío del estado de un trabajo y de transmisiones de trabajos desde Automation a Log Analytics (OMS)](automation-manage-send-joblogs-log-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="3407b-159">For more information about integrating with OMS Log Analytics, see [Forward job status and job streams from Automation to Log Analytics (OMS)](automation-manage-send-joblogs-log-analytics.md).</span></span>  

### <a name="automation-runbook-jobs-summary"></a><span data-ttu-id="3407b-160">Resumen de trabajos de runbook de Automation</span><span class="sxs-lookup"><span data-stu-id="3407b-160">Automation runbook jobs summary</span></span>
<span data-ttu-id="3407b-161">A la derecha de la cuenta de Automation, puede ver un resumen de todos los trabajos de runbook de una cuenta de Automation seleccionada en el icono **Estadísticas de trabajo**.</span><span class="sxs-lookup"><span data-stu-id="3407b-161">On the right of your selected Automation account, you can see a summary of all of the runbook jobs for a selected Automation account under **Job Statistics** tile.</span></span><br><br> <span data-ttu-id="3407b-162">![Icono Estadísticas de trabajo](./media/automation-runbook-execution/automation-account-job-status-summary.png).</span><span class="sxs-lookup"><span data-stu-id="3407b-162">![Job Statistics tile](./media/automation-runbook-execution/automation-account-job-status-summary.png).</span></span><br> <span data-ttu-id="3407b-163">Este icono muestra un contador y una representación gráfica del estado de trabajo de todos los trabajos ejecutados.</span><span class="sxs-lookup"><span data-stu-id="3407b-163">This tile displays a count and graphical representation of the job status for all jobs executed.</span></span>  

<span data-ttu-id="3407b-164">Si hace clic en el icono aparece la hoja **Trabajos**, que incluye una lista resumida de todos los trabajos ejecutados, con el estado, la ejecución del trabajo y la hora de inicio y finalización.</span><span class="sxs-lookup"><span data-stu-id="3407b-164">Clicking on the tile presents the **Jobs** blade, which includes a summarized list of all jobs executed, with status, job execution, and start and completion times.</span></span><br><br> <span data-ttu-id="3407b-165">![Hoja Trabajos de cuenta de Automation](./media/automation-runbook-execution/automation-account-jobs-status-blade.png)</span><span class="sxs-lookup"><span data-stu-id="3407b-165">![Automation account Jobs blade](./media/automation-runbook-execution/automation-account-jobs-status-blade.png)</span></span><br><br>  <span data-ttu-id="3407b-166">Puede filtrar la lista de trabajos si selecciona **Filtrar trabajos** y filtra según un runbook específico, el estado de un trabajo o desde la lista desplegable, el intervalo de fecha y hora dentro del cual desea buscar.</span><span class="sxs-lookup"><span data-stu-id="3407b-166">You can filter the list of jobs by selecting **Filter jobs**  and filter on a specific runbook, job status, or from the drop-down list, the date/time range to search within.</span></span><br><br> <span data-ttu-id="3407b-167">![Filtrar estado del trabajo](./media/automation-runbook-execution/automation-account-jobs-filter.png)</span><span class="sxs-lookup"><span data-stu-id="3407b-167">![Filter Job status](./media/automation-runbook-execution/automation-account-jobs-filter.png)</span></span>

<span data-ttu-id="3407b-168">De manera alternativa, puede ver los detalles resumidos de trabajo de un runbook específico; para ello, seleccione ese runbook en la hoja **Runbooks** de la cuenta de Automation y, luego, seleccione el icono **Trabajos**.</span><span class="sxs-lookup"><span data-stu-id="3407b-168">Alternatively, you can view job summary details for a specific runbook by selecting that runbook from the **Runbooks** blade in your Automation account, and then select the **Jobs** tile.</span></span>  <span data-ttu-id="3407b-169">Se abre la hoja **Trabajos** y, desde ahí, puede hacer clic en el registro del trabajo para ver sus detalles y salida.</span><span class="sxs-lookup"><span data-stu-id="3407b-169">This presents the **Jobs** blade, and from there you can click on the job record to view its detail and output.</span></span><br><br> <span data-ttu-id="3407b-170">![Hoja Trabajos de cuenta de Automation](./media/automation-runbook-execution/automation-runbook-job-summary-blade.png)</span><span class="sxs-lookup"><span data-stu-id="3407b-170">![Automation account Jobs blade](./media/automation-runbook-execution/automation-runbook-job-summary-blade.png)</span></span><br> 

### <a name="job-summary"></a><span data-ttu-id="3407b-171">Resumen del trabajo</span><span class="sxs-lookup"><span data-stu-id="3407b-171">Job Summary</span></span>
<span data-ttu-id="3407b-172">Puede ver una lista de todos los trabajos que se han creado para un runbook determinado y su estado más reciente.</span><span class="sxs-lookup"><span data-stu-id="3407b-172">You can view a list of all of the jobs that have been created for a particular runbook and their most recent status.</span></span> <span data-ttu-id="3407b-173">Puede filtrar esta lista por estado del trabajo y el intervalo de fechas del último cambio del trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-173">You can filter this list by job status and the range of dates for the last change to the job.</span></span> <span data-ttu-id="3407b-174">Para ver su información detallada y la salida, haga clic en el nombre de un trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-174">To view its detailed information and output, click on the name of a job.</span></span> <span data-ttu-id="3407b-175">La vista detallada del trabajo incluye los valores para los parámetros de runbook que se proporcionaron con ese trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-175">The detailed view of the job includes the values for the runbook parameters that were provided to that job.</span></span>

<span data-ttu-id="3407b-176">Puede utilizar los pasos siguientes para ver los trabajos de un runbook.</span><span class="sxs-lookup"><span data-stu-id="3407b-176">You can use the following steps to view the jobs for a runbook.</span></span>

1. <span data-ttu-id="3407b-177">En Azure Portal, seleccione **Automation** y después elija el nombre de una cuenta de Automation.</span><span class="sxs-lookup"><span data-stu-id="3407b-177">In the Azure portal, select **Automation** and then select the name of an Automation account.</span></span>
2. <span data-ttu-id="3407b-178">En el concentrador, seleccione **Runbooks** y, después, en la hoja **Runbooks**, seleccione un runbook de la lista.</span><span class="sxs-lookup"><span data-stu-id="3407b-178">From the hub, select **Runbooks** and then on the **Runbooks** blade select a runbook from the list.</span></span>
3. <span data-ttu-id="3407b-179">En la hoja del runbook seleccionado, haga clic en el icono **Trabajos**.</span><span class="sxs-lookup"><span data-stu-id="3407b-179">On the blade for the selected runbook, click the **Jobs** tile.</span></span>
4. <span data-ttu-id="3407b-180">Haga clic en uno de los trabajos de la lista y en la hoja de detalles del trabajo del runbook podrá ver su detalle y salida.</span><span class="sxs-lookup"><span data-stu-id="3407b-180">Click on one of the jobs in the list and on the runbook job details blade you can view its detail and output.</span></span>

## <a name="retrieving-job-status-using-windows-powershell"></a><span data-ttu-id="3407b-181">Recuperación del estado del trabajo con Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="3407b-181">Retrieving job status using Windows PowerShell</span></span>
<span data-ttu-id="3407b-182">Puede usar [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx) para recuperar los trabajos creados para un runbook y los detalles de un trabajo determinado.</span><span class="sxs-lookup"><span data-stu-id="3407b-182">You can use the [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx) to retrieve the jobs created for a runbook and the details of a particular job.</span></span> <span data-ttu-id="3407b-183">Si inicia un runbook con Windows PowerShell mediante el uso de [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx), devuelve el trabajo resultante.</span><span class="sxs-lookup"><span data-stu-id="3407b-183">If you start a runbook with Windows PowerShell using [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx), then it returns the resulting job.</span></span> <span data-ttu-id="3407b-184">Use la salida [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx) para obtener la salida de un trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-184">Use [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx)Output to get a job’s output.</span></span>

<span data-ttu-id="3407b-185">Los comandos de ejemplo siguientes recuperan el último trabajo para un runbook de ejemplo y muestran su estado, los valores proporcionados para los parámetros de runbook y la salida del trabajo.</span><span class="sxs-lookup"><span data-stu-id="3407b-185">The following sample commands retrieve the last job for a sample runbook and displays its status, the values provided for the runbook parameters, and the output from the job.</span></span>

    $job = (Get-AzureRmAutomationJob –AutomationAccountName "MyAutomationAccount" `
    –RunbookName "Test-Runbook" -ResourceGroupName "ResourceGroup01" | sort LastModifiedDate –desc)[0]
    $job.Status
    $job.JobParameters
    Get-AzureRmAutomationJobOutput -ResourceGroupName "ResourceGroup01" `
    –AutomationAccountName "MyAutomationAcct" -Id $job.JobId –Stream Output

## <a name="fair-share"></a><span data-ttu-id="3407b-186">distribución equilibrada</span><span class="sxs-lookup"><span data-stu-id="3407b-186">Fair share</span></span>
<span data-ttu-id="3407b-187">Para compartir recursos entre todos los Runbooks en la nube, Azure Automation descargará temporalmente cualquier trabajo cuando haya estado ejecutándose durante tres horas.</span><span class="sxs-lookup"><span data-stu-id="3407b-187">In order to share resources among all runbooks in the cloud, Azure Automation will temporarily unload any job after it has been running for three hours.</span></span>  <span data-ttu-id="3407b-188">Durante este tiempo, los trabajos de [runbooks basados en PowerShell](automation-runbook-types.md#powershell-runbooks) se detienen y no se reiniciarán.</span><span class="sxs-lookup"><span data-stu-id="3407b-188">During this time, jobs for [PowerShell-based runbooks](automation-runbook-types.md#powershell-runbooks) are stopped and will not be restarted.</span></span>  <span data-ttu-id="3407b-189">El estado del trabajo aparece como **Detenido**.</span><span class="sxs-lookup"><span data-stu-id="3407b-189">The job status shows **Stopped**.</span></span>  <span data-ttu-id="3407b-190">Este tipo de runbook siempre se reinicia desde el principio, ya que no admite los puntos de control.</span><span class="sxs-lookup"><span data-stu-id="3407b-190">This type of runbook is always restarted from the beginning since they don't support checkpoints.</span></span>  

<span data-ttu-id="3407b-191">Los [runbooks basados en el flujo de trabajo de PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) se reanudarán a partir de su último [punto de control](https://docs.microsoft.com/system-center/sma/overview-powershell-workflows#bk_Checkpoints).</span><span class="sxs-lookup"><span data-stu-id="3407b-191">[PowerShell-Workflow-based runbooks](automation-runbook-types.md#powershell-workflow-runbooks) will be resumed from their last [checkpoint](https://docs.microsoft.com/system-center/sma/overview-powershell-workflows#bk_Checkpoints).</span></span>  <span data-ttu-id="3407b-192">Después de ejecutarse durante tres horas, el servicio suspenderá el trabajo del runbook y su estado aparecerá como **En ejecución, esperando recursos**.</span><span class="sxs-lookup"><span data-stu-id="3407b-192">After running three hours, the runbook job will be suspended by the service and its status shows **Running, waiting for resources**.</span></span>  <span data-ttu-id="3407b-193">Si hay un espacio aislado disponible, el servicio Automation reiniciará automáticamente el runbook, que se reanuda a partir del último punto de control.</span><span class="sxs-lookup"><span data-stu-id="3407b-193">When a sandbox becomes available, the runbook will be automatically restarted by the Automation service and resumes from the last checkpoint.</span></span>  <span data-ttu-id="3407b-194">Este es el comportamiento normal del flujo de trabajo de PowerShell a la hora de suspender o reiniciar.</span><span class="sxs-lookup"><span data-stu-id="3407b-194">This is normal PowerShell-Workflow behavior for suspend/restart.</span></span>  <span data-ttu-id="3407b-195">Si el runbook sobrepasa de nuevo las tres horas de tiempo de ejecución, el proceso se repite hasta tres veces.</span><span class="sxs-lookup"><span data-stu-id="3407b-195">If the runbook again exceeds three hours of runtime, the process repeats, up to three times.</span></span>  <span data-ttu-id="3407b-196">Tras el tercer reinicio, si el runbook sigue sin completarse transcurridas tres horas, se producirá un error en el trabajo del runbook y el estado del trabajo aparecerá como **Error, esperando recursos**.</span><span class="sxs-lookup"><span data-stu-id="3407b-196">After the third restart, if the runbook still has not completed in three hours, then the runbook job is failed, and the job status shows **Failed, waiting for resources**.</span></span>  <span data-ttu-id="3407b-197">En este caso, recibe la siguiente excepción con el error.</span><span class="sxs-lookup"><span data-stu-id="3407b-197">In this case, you receive the following exception with the failure.</span></span>

<span data-ttu-id="3407b-198">*El trabajo no puede continuar ejecutándose porque se expulsó repetidamente del mismo punto de control. Asegúrese de que el runbook no realiza operaciones largas sin conservar su estado.*</span><span class="sxs-lookup"><span data-stu-id="3407b-198">*The job cannot continue running because it was repeatedly evicted from the same checkpoint. Please make sure your Runbook does not perform lengthy operations without persisting its state.*</span></span>

<span data-ttu-id="3407b-199">De esta forma se protege el servicio impidiéndose que los runbooks se ejecuten de manera indefinida sin completarse, ya que no pueden llegar al siguiente punto de control sin que se descarguen de nuevo.</span><span class="sxs-lookup"><span data-stu-id="3407b-199">This is to protect the service from runbooks running indefinitely without completing, as they are not able to make it to the next checkpoint without being unloaded again.</span></span>

<span data-ttu-id="3407b-200">Si el runbook no tiene puntos de control o el trabajo no había alcanzado el primer punto de control antes de la descarga, se reinicia desde el principio.</span><span class="sxs-lookup"><span data-stu-id="3407b-200">If the runbook has no checkpoints or the job had not reached the first checkpoint before being unloaded, then it restarts from the beginning.</span></span>  

<span data-ttu-id="3407b-201">Cuando se crea un runbook, debe asegurarse de que el tiempo para ejecutar las actividades entre dos puntos de control no supera las tres horas.</span><span class="sxs-lookup"><span data-stu-id="3407b-201">When you create a runbook, you should ensure that the time to run any activities between two checkpoints does not exceed three hours.</span></span> <span data-ttu-id="3407b-202">Puede que necesite agregar puntos de control a un Runbook para asegurarse de que no alcanza este límite de tres horas ni divide operaciones de ejecución prolongada.</span><span class="sxs-lookup"><span data-stu-id="3407b-202">You may need to add checkpoints to your runbook to ensure that it does not reach this three hour limit or break up long running operations.</span></span> <span data-ttu-id="3407b-203">Por ejemplo, su runbook podría realizar una reindexación en una gran base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="3407b-203">For example, your runbook might perform a reindex on a large SQL database.</span></span> <span data-ttu-id="3407b-204">Si esta operación no se completa dentro del límite de distribución equilibrada, el trabajo se descarga y se reinicia desde el principio.</span><span class="sxs-lookup"><span data-stu-id="3407b-204">If this single operation does not complete within the fair share limit, then the job are unloaded and restarted from the beginning.</span></span> <span data-ttu-id="3407b-205">En este caso, debe dividir la operación de reindexación en varios pasos, como volver a indexar una tabla a la vez y, a continuación, inserte un punto de control después de cada operación, de modo que el trabajo se pueda reanudar después de la última operación para completar.</span><span class="sxs-lookup"><span data-stu-id="3407b-205">In this case, you should break up the reindex operation into multiple steps, such as reindexing one table at a time, and then insert a checkpoint after each operation so that the job could resume after the last operation to complete.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3407b-206">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="3407b-206">Next steps</span></span>
* <span data-ttu-id="3407b-207">Para más información sobre los distintos métodos que se pueden usar para iniciar un runbook en Azure Automation, consulte [Inicio de un runbook en Azure Automation](automation-starting-a-runbook.md)</span><span class="sxs-lookup"><span data-stu-id="3407b-207">To learn more about the different methods that can be used to start a runbook in Azure Automation, see [Starting a runbook in Azure Automation](automation-starting-a-runbook.md)</span></span>

