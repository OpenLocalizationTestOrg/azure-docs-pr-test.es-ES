---
title: "Reenvío de datos del trabajo de Azure Automation a Log Analytics de OMS | Microsoft Docs"
description: "Este artículo muestra cómo enviar el estado de un trabajo y transmisiones de trabajo del runbook a Log Analytics de Microsoft Operations Management Suite para ofrecer mayor información y administración."
services: automation
documentationcenter: 
author: MGoedtel
manager: carmonm
editor: tysonn
ms.assetid: c12724c6-01a9-4b55-80ae-d8b7b99bd436
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/02/2017
ms.author: magoedte
ms.openlocfilehash: 2c0ca7fc332963e5a5db3c20c400ed877ae0cc54
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="forward-job-status-and-job-streams-from-automation-to-log-analytics-oms"></a><span data-ttu-id="33c30-103">Reenvío del estado de un trabajo y de transmisiones de trabajos de Automatización a Log Analytics (OMS)</span><span class="sxs-lookup"><span data-stu-id="33c30-103">Forward job status and job streams from Automation to Log Analytics (OMS)</span></span>
<span data-ttu-id="33c30-104">Automatización puede enviar el estado de un trabajo del runbook y de transmisiones de trabajos al área de trabajo devLog Analytics de Microsoft Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="33c30-104">Automation can send runbook job status and job streams to your Microsoft Operations Management Suite (OMS) Log Analytics workspace.</span></span>  <span data-ttu-id="33c30-105">Los registros de trabajo y flujos de trabajo están visibles en Azure Portal, o con PowerShell, para los trabajos individuales y esto permite llevar a cabo investigaciones simples.</span><span class="sxs-lookup"><span data-stu-id="33c30-105">Job logs and job streams are visible in the Azure portal, or with PowerShell, for individual jobs and this allows you to perform simple investigations.</span></span> <span data-ttu-id="33c30-106">Ahora con Log Analytics puede:</span><span class="sxs-lookup"><span data-stu-id="33c30-106">Now with Log Analytics you can:</span></span>

* <span data-ttu-id="33c30-107">Obtener información sobre los trabajos de Automatización</span><span class="sxs-lookup"><span data-stu-id="33c30-107">Get insight on your Automation jobs</span></span>
* <span data-ttu-id="33c30-108">Desencadenador de un correo electrónico o una alerta en función del estado de trabajo del runbook (por ejemplo, error o en suspensión)</span><span class="sxs-lookup"><span data-stu-id="33c30-108">Trigger an email or alert based on your runbook job status (for example, failed or suspended)</span></span>
* <span data-ttu-id="33c30-109">Escribir consultas avanzadas en las transmisiones de trabajos</span><span class="sxs-lookup"><span data-stu-id="33c30-109">Write advanced queries across your job streams</span></span>
* <span data-ttu-id="33c30-110">Correlacionar trabajos en cuentas de Automatización</span><span class="sxs-lookup"><span data-stu-id="33c30-110">Correlate jobs across Automation accounts</span></span>
* <span data-ttu-id="33c30-111">Visualizar el historial de trabajos a lo largo del tiempo</span><span class="sxs-lookup"><span data-stu-id="33c30-111">Visualize your job history over time</span></span>     

## <a name="prerequisites-and-deployment-considerations"></a><span data-ttu-id="33c30-112">Requisitos previos y consideraciones de implementación</span><span class="sxs-lookup"><span data-stu-id="33c30-112">Prerequisites and deployment considerations</span></span>
<span data-ttu-id="33c30-113">Para empezar a enviar los registros de Automation a Log Analytics, necesita:</span><span class="sxs-lookup"><span data-stu-id="33c30-113">To start sending your Automation logs to Log Analytics, you need:</span></span>

1. <span data-ttu-id="33c30-114">La versión de noviembre de 2016, o una posterior, de [Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/) (v2.3.0).</span><span class="sxs-lookup"><span data-stu-id="33c30-114">The November 2016 or later release of [Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/) (v2.3.0).</span></span>
2. <span data-ttu-id="33c30-115">Un área de trabajo de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="33c30-115">A Log Analytics workspace.</span></span> <span data-ttu-id="33c30-116">Para más información, consulte [Introducción a Log Analytics](../log-analytics/log-analytics-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="33c30-116">For more information, see [Get started with Log Analytics](../log-analytics/log-analytics-get-started.md).</span></span> 
3. <span data-ttu-id="33c30-117">El valor de ResourceId de su cuenta de Azure Automation</span><span class="sxs-lookup"><span data-stu-id="33c30-117">The ResourceId for your Azure Automation account</span></span>

<span data-ttu-id="33c30-118">Para encontrar el valor de ResourceId de la cuenta de Azure Automation y el área de trabajo de Log Analytics, ejecute el PowerShell siguiente:</span><span class="sxs-lookup"><span data-stu-id="33c30-118">To find the ResourceId for your Azure Automation account and Log Analytics workspace, run the following PowerShell:</span></span>

```powershell
# Find the ResourceId for the Automation Account
Find-AzureRmResource -ResourceType "Microsoft.Automation/automationAccounts"

# Find the ResourceId for the Log Analytics workspace
Find-AzureRmResource -ResourceType "Microsoft.OperationalInsights/workspaces"
```

<span data-ttu-id="33c30-119">Si tiene varias cuentas de Automation, o áreas de trabajo, en la salida de los comandos anteriores, busque el *nombre* que tiene que configurar y copie el valor para *ResourceId*.</span><span class="sxs-lookup"><span data-stu-id="33c30-119">If you have multiple Automation accounts, or workspaces, in the output of the preceding commands, find the *Name* you need to configure and copy the value for *ResourceId*.</span></span>

<span data-ttu-id="33c30-120">Si necesita encontrar el *nombre* de la cuenta de Automation, en Azure Portal seleccione su cuenta de Automation en la hoja **Cuenta de Automation** y seleccione **Toda la configuración**.</span><span class="sxs-lookup"><span data-stu-id="33c30-120">If you need to find the *Name* of your Automation account, in the Azure portal select your Automation account from the **Automation account** blade and select **All settings**.</span></span>  <span data-ttu-id="33c30-121">En la hoja **Toda la configuración**, en **Configuración de la cuenta**, seleccione **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="33c30-121">From the **All settings** blade, under **Account Settings** select **Properties**.</span></span>  <span data-ttu-id="33c30-122">En la hoja **Propiedades**, puede anotar estos valores.</span><span class="sxs-lookup"><span data-stu-id="33c30-122">In the **Properties** blade, you can note these values.</span></span><br> <span data-ttu-id="33c30-123">![Propiedades de una cuenta de Automatización](media/automation-manage-send-joblogs-log-analytics/automation-account-properties.png)(Introducción a Log Analytics).</span><span class="sxs-lookup"><span data-stu-id="33c30-123">![Automation Account properties](media/automation-manage-send-joblogs-log-analytics/automation-account-properties.png).</span></span>

## <a name="set-up-integration-with-log-analytics"></a><span data-ttu-id="33c30-124">Configuración de la integración con Log Analytics</span><span class="sxs-lookup"><span data-stu-id="33c30-124">Set up integration with Log Analytics</span></span>
1. <span data-ttu-id="33c30-125">En el equipo, inicie **Windows PowerShell** desde la pantalla **Inicio**.</span><span class="sxs-lookup"><span data-stu-id="33c30-125">On your computer, start **Windows PowerShell** from the **Start** screen.</span></span>  
2. <span data-ttu-id="33c30-126">Copie y pegue el código PowerShell siguiente, y edite el valor para `$workspaceId` y `$automationAccountId`.</span><span class="sxs-lookup"><span data-stu-id="33c30-126">Copy and paste the following PowerShell, and edit the value for the `$workspaceId` and `$automationAccountId`.</span></span>  <span data-ttu-id="33c30-127">Para el parámetro `-Environment`, los valores válidos son *nube de Azure* o *AzureUSGovernment*, en función del entorno de nube en el que se trabaje.</span><span class="sxs-lookup"><span data-stu-id="33c30-127">For the `-Environment` parameter, valid values are *AzureCloud* or *AzureUSGovernment* depending on the cloud environment you are working in.</span></span>     

```powershell
[cmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$True)]
        [ValidateSet("AzureCloud","AzureUSGovernment")]
        [string]$Environment="AzureCloud"
    )

#Check to see which cloud environment to sign into.
Switch ($Environment)
   {
       "AzureCloud" {Login-AzureRmAccount}
       "AzureUSGovernment" {Login-AzureRmAccount -EnvironmentName AzureUSGovernment} 
   }

# if you have one Log Analytics workspace you can use the following command to get the resource id of the workspace
$workspaceId = (Get-AzureRmOperationalInsightsWorkspace).ResourceId

$automationAccountId = "/SUBSCRIPTIONS/ec11ca60-1234-491e-5678-0ea07feae25c/RESOURCEGROUPS/DEMO/PROVIDERS/MICROSOFT.AUTOMATION/ACCOUNTS/DEMO" 

Set-AzureRmDiagnosticSetting -ResourceId $automationAccountId -WorkspaceId $workspaceId -Enabled $true

```

<span data-ttu-id="33c30-128">Después de ejecutar este script, verá los registros de Log Analytics a los 10 minutos de escribir los nuevos JobLogs o JobStreams.</span><span class="sxs-lookup"><span data-stu-id="33c30-128">After running this script, you will see records in Log Analytics within 10 minutes of new JobLogs or JobStreams being written.</span></span>

<span data-ttu-id="33c30-129">Para ver los registros, ejecute la siguiente consulta en la búsqueda de registros de Log Analytics: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span><span class="sxs-lookup"><span data-stu-id="33c30-129">To see the logs, run the following query in Log Analytics log search: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span></span>

### <a name="verify-configuration"></a><span data-ttu-id="33c30-130">Comprobación de la configuración</span><span class="sxs-lookup"><span data-stu-id="33c30-130">Verify configuration</span></span>
<span data-ttu-id="33c30-131">Para confirmar que la cuenta de Automation está enviando registros a su área de trabajo de Log Analytics, compruebe que los diagnósticos están establecidos correctamente en la cuenta de Automation con el código PowerShell siguiente:</span><span class="sxs-lookup"><span data-stu-id="33c30-131">To confirm that your Automation account is sending logs to your Log Analytics workspace, check that diagnostics are set correctly on the Automation account using the following PowerShell:</span></span>

```powershell
[cmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$True)]
        [ValidateSet("AzureCloud","AzureUSGovernment")]
        [string]$Environment="AzureCloud"
    )

#Check to see which cloud environment to sign into.
Switch ($Environment)
   {
       "AzureCloud" {Login-AzureRmAccount}
       "AzureUSGovernment" {Login-AzureRmAccount -EnvironmentName AzureUSGovernment} 
   }
# if you have one Log Analytics workspace you can use the following command to get the resource id of the workspace
$workspaceId = (Get-AzureRmOperationalInsightsWorkspace).ResourceId

$automationAccountId = "/SUBSCRIPTIONS/ec11ca60-1234-491e-5678-0ea07feae25c/RESOURCEGROUPS/DEMO/PROVIDERS/MICROSOFT.AUTOMATION/ACCOUNTS/DEMO" 

Get-AzureRmDiagnosticSetting -ResourceId $automationAccountId
```

<span data-ttu-id="33c30-132">En la salida asegúrese de que:</span><span class="sxs-lookup"><span data-stu-id="33c30-132">In the output ensure that:</span></span>
+ <span data-ttu-id="33c30-133">En *Registros*, el valor de *Habilitado* es *True*.</span><span class="sxs-lookup"><span data-stu-id="33c30-133">Under *Logs*, the value for *Enabled* is *True*</span></span>
+ <span data-ttu-id="33c30-134">El valor de *WorkspaceId* se establece en el valor de ResourceId de su área de trabajo de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="33c30-134">The value of *WorkspaceId* is set to the ResourceId of your Log Analytics workspace</span></span>


## <a name="log-analytics-records"></a><span data-ttu-id="33c30-135">Registros de Log Analytics</span><span class="sxs-lookup"><span data-stu-id="33c30-135">Log Analytics records</span></span>
<span data-ttu-id="33c30-136">Diagnósticos de Azure Automation crea dos tipos de registros en Log Analytics y se etiquetan como **Type=AzureDiagnostics**.</span><span class="sxs-lookup"><span data-stu-id="33c30-136">Diagnostics from Azure Automation creates two types of records in Log Analytics and are tagged as **Type=AzureDiagnostics**.</span></span>

### <a name="job-logs"></a><span data-ttu-id="33c30-137">Registros de trabajo</span><span class="sxs-lookup"><span data-stu-id="33c30-137">Job Logs</span></span>
| <span data-ttu-id="33c30-138">Propiedad</span><span class="sxs-lookup"><span data-stu-id="33c30-138">Property</span></span> | <span data-ttu-id="33c30-139">Descripción</span><span class="sxs-lookup"><span data-stu-id="33c30-139">Description</span></span> |
| --- | --- |
| <span data-ttu-id="33c30-140">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="33c30-140">TimeGenerated</span></span> |<span data-ttu-id="33c30-141">Fecha y hora en que se ejecuta el trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-141">Date and time when the runbook job executed.</span></span> |
| <span data-ttu-id="33c30-142">RunbookName_s</span><span class="sxs-lookup"><span data-stu-id="33c30-142">RunbookName_s</span></span> |<span data-ttu-id="33c30-143">El nombre del Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-143">The name of the runbook.</span></span> |
| <span data-ttu-id="33c30-144">Caller_s</span><span class="sxs-lookup"><span data-stu-id="33c30-144">Caller_s</span></span> |<span data-ttu-id="33c30-145">La persona que inicia la operación.</span><span class="sxs-lookup"><span data-stu-id="33c30-145">Who initiated the operation.</span></span>  <span data-ttu-id="33c30-146">Los valores posibles son una dirección de correo electrónico o el sistema para los trabajos programados.</span><span class="sxs-lookup"><span data-stu-id="33c30-146">Possible values are either an email address or system for scheduled jobs.</span></span> |
| <span data-ttu-id="33c30-147">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="33c30-147">Tenant_g</span></span> | <span data-ttu-id="33c30-148">GUID que identifica al inquilino para el llamador.</span><span class="sxs-lookup"><span data-stu-id="33c30-148">GUID that identifies the tenant for the Caller.</span></span> |
| <span data-ttu-id="33c30-149">JobId_g</span><span class="sxs-lookup"><span data-stu-id="33c30-149">JobId_g</span></span> |<span data-ttu-id="33c30-150">GUID que es el identificador del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-150">GUID that is the Id of the runbook job.</span></span> |
| <span data-ttu-id="33c30-151">ResultType</span><span class="sxs-lookup"><span data-stu-id="33c30-151">ResultType</span></span> |<span data-ttu-id="33c30-152">El estado del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-152">The status of the runbook job.</span></span>  <span data-ttu-id="33c30-153">Los valores posibles son:</span><span class="sxs-lookup"><span data-stu-id="33c30-153">Possible values are:</span></span><br><span data-ttu-id="33c30-154">Started</span><span class="sxs-lookup"><span data-stu-id="33c30-154">- Started</span></span><br><span data-ttu-id="33c30-155">Stopped</span><span class="sxs-lookup"><span data-stu-id="33c30-155">- Stopped</span></span><br><span data-ttu-id="33c30-156">Suspended</span><span class="sxs-lookup"><span data-stu-id="33c30-156">- Suspended</span></span><br><span data-ttu-id="33c30-157">Con error</span><span class="sxs-lookup"><span data-stu-id="33c30-157">- Failed</span></span><br><span data-ttu-id="33c30-158">Completado</span><span class="sxs-lookup"><span data-stu-id="33c30-158">- Completed</span></span> |
| <span data-ttu-id="33c30-159">Categoría</span><span class="sxs-lookup"><span data-stu-id="33c30-159">Category</span></span> | <span data-ttu-id="33c30-160">Clasificación del tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="33c30-160">Classification of the type of data.</span></span>  <span data-ttu-id="33c30-161">Para Automation, el valor será JobLogs.</span><span class="sxs-lookup"><span data-stu-id="33c30-161">For Automation, the value is JobLogs.</span></span> |
| <span data-ttu-id="33c30-162">nombreOperación</span><span class="sxs-lookup"><span data-stu-id="33c30-162">OperationName</span></span> | <span data-ttu-id="33c30-163">Especifica el tipo de operación realizada en Azure.</span><span class="sxs-lookup"><span data-stu-id="33c30-163">Specifies the type of operation performed in Azure.</span></span>  <span data-ttu-id="33c30-164">En Automation, el valor es Job.</span><span class="sxs-lookup"><span data-stu-id="33c30-164">For Automation, the value is Job.</span></span> |
| <span data-ttu-id="33c30-165">Recurso</span><span class="sxs-lookup"><span data-stu-id="33c30-165">Resource</span></span> | <span data-ttu-id="33c30-166">Nombre de la cuenta de Automation</span><span class="sxs-lookup"><span data-stu-id="33c30-166">Name of the Automation account</span></span> |
| <span data-ttu-id="33c30-167">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="33c30-167">SourceSystem</span></span> | <span data-ttu-id="33c30-168">Cómo Log Analytics ha recopilado los datos.</span><span class="sxs-lookup"><span data-stu-id="33c30-168">How Log Analytics collected the data.</span></span> <span data-ttu-id="33c30-169">Siempre *Azure* para Diagnósticos de Azure.</span><span class="sxs-lookup"><span data-stu-id="33c30-169">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="33c30-170">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="33c30-170">ResultDescription</span></span> |<span data-ttu-id="33c30-171">Describe el estado de resultado del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-171">Describes the runbook job result state.</span></span>  <span data-ttu-id="33c30-172">Los valores posibles son:</span><span class="sxs-lookup"><span data-stu-id="33c30-172">Possible values are:</span></span><br><span data-ttu-id="33c30-173">- Se inicia el trabajo</span><span class="sxs-lookup"><span data-stu-id="33c30-173">- Job is started</span></span><br><span data-ttu-id="33c30-174">- Error del trabajo</span><span class="sxs-lookup"><span data-stu-id="33c30-174">- Job Failed</span></span><br><span data-ttu-id="33c30-175">- Trabajo completado</span><span class="sxs-lookup"><span data-stu-id="33c30-175">- Job Completed</span></span> |
| <span data-ttu-id="33c30-176">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="33c30-176">CorrelationId</span></span> |<span data-ttu-id="33c30-177">GUID que es el identificador de correlación del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-177">GUID that is the Correlation Id of the runbook job.</span></span> |
| <span data-ttu-id="33c30-178">ResourceId</span><span class="sxs-lookup"><span data-stu-id="33c30-178">ResourceId</span></span> |<span data-ttu-id="33c30-179">Especifica el identificador de recursos de la cuenta de Azure Automation del runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-179">Specifies the Azure Automation account resource id of the runbook.</span></span> |
| <span data-ttu-id="33c30-180">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="33c30-180">SubscriptionId</span></span> | <span data-ttu-id="33c30-181">El identificador de la suscripción de Azure (GUID) para la cuenta de Automation.</span><span class="sxs-lookup"><span data-stu-id="33c30-181">The Azure subscription Id (GUID) for the Automation account.</span></span> |
| <span data-ttu-id="33c30-182">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="33c30-182">ResourceGroup</span></span> | <span data-ttu-id="33c30-183">Nombre del grupo de recursos de la cuenta de Automation.</span><span class="sxs-lookup"><span data-stu-id="33c30-183">Name of the resource group for the Automation account.</span></span> |
| <span data-ttu-id="33c30-184">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="33c30-184">ResourceProvider</span></span> | <span data-ttu-id="33c30-185">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="33c30-185">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="33c30-186">ResourceType</span><span class="sxs-lookup"><span data-stu-id="33c30-186">ResourceType</span></span> | <span data-ttu-id="33c30-187">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="33c30-187">AUTOMATIONACCOUNTS</span></span> |


### <a name="job-streams"></a><span data-ttu-id="33c30-188">Flujos de trabajo</span><span class="sxs-lookup"><span data-stu-id="33c30-188">Job Streams</span></span>
| <span data-ttu-id="33c30-189">Propiedad</span><span class="sxs-lookup"><span data-stu-id="33c30-189">Property</span></span> | <span data-ttu-id="33c30-190">Descripción</span><span class="sxs-lookup"><span data-stu-id="33c30-190">Description</span></span> |
| --- | --- |
| <span data-ttu-id="33c30-191">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="33c30-191">TimeGenerated</span></span> |<span data-ttu-id="33c30-192">Fecha y hora en que se ejecuta el trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-192">Date and time when the runbook job executed.</span></span> |
| <span data-ttu-id="33c30-193">RunbookName_s</span><span class="sxs-lookup"><span data-stu-id="33c30-193">RunbookName_s</span></span> |<span data-ttu-id="33c30-194">El nombre del Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-194">The name of the runbook.</span></span> |
| <span data-ttu-id="33c30-195">Caller_s</span><span class="sxs-lookup"><span data-stu-id="33c30-195">Caller_s</span></span> |<span data-ttu-id="33c30-196">La persona que inicia la operación.</span><span class="sxs-lookup"><span data-stu-id="33c30-196">Who initiated the operation.</span></span>  <span data-ttu-id="33c30-197">Los valores posibles son una dirección de correo electrónico o el sistema para los trabajos programados.</span><span class="sxs-lookup"><span data-stu-id="33c30-197">Possible values are either an email address or system for scheduled jobs.</span></span> |
| <span data-ttu-id="33c30-198">StreamType_s</span><span class="sxs-lookup"><span data-stu-id="33c30-198">StreamType_s</span></span> |<span data-ttu-id="33c30-199">El tipo de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="33c30-199">The type of job stream.</span></span> <span data-ttu-id="33c30-200">Los valores posibles son:</span><span class="sxs-lookup"><span data-stu-id="33c30-200">Possible values are:</span></span><br><span data-ttu-id="33c30-201">progreso</span><span class="sxs-lookup"><span data-stu-id="33c30-201">-Progress</span></span><br><span data-ttu-id="33c30-202">- Salida</span><span class="sxs-lookup"><span data-stu-id="33c30-202">- Output</span></span><br><span data-ttu-id="33c30-203">Warning (Advertencia)</span><span class="sxs-lookup"><span data-stu-id="33c30-203">- Warning</span></span><br><span data-ttu-id="33c30-204">Error</span><span class="sxs-lookup"><span data-stu-id="33c30-204">- Error</span></span><br><span data-ttu-id="33c30-205">DEBUG</span><span class="sxs-lookup"><span data-stu-id="33c30-205">- Debug</span></span><br><span data-ttu-id="33c30-206">- Detallado</span><span class="sxs-lookup"><span data-stu-id="33c30-206">- Verbose</span></span> |
| <span data-ttu-id="33c30-207">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="33c30-207">Tenant_g</span></span> | <span data-ttu-id="33c30-208">GUID que identifica al inquilino para el llamador.</span><span class="sxs-lookup"><span data-stu-id="33c30-208">GUID that identifies the tenant for the Caller.</span></span> |
| <span data-ttu-id="33c30-209">JobId_g</span><span class="sxs-lookup"><span data-stu-id="33c30-209">JobId_g</span></span> |<span data-ttu-id="33c30-210">GUID que es el identificador del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-210">GUID that is the Id of the runbook job.</span></span> |
| <span data-ttu-id="33c30-211">ResultType</span><span class="sxs-lookup"><span data-stu-id="33c30-211">ResultType</span></span> |<span data-ttu-id="33c30-212">El estado del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-212">The status of the runbook job.</span></span>  <span data-ttu-id="33c30-213">Los valores posibles son:</span><span class="sxs-lookup"><span data-stu-id="33c30-213">Possible values are:</span></span><br><span data-ttu-id="33c30-214">- In Progress</span><span class="sxs-lookup"><span data-stu-id="33c30-214">- In Progress</span></span> |
| <span data-ttu-id="33c30-215">Categoría</span><span class="sxs-lookup"><span data-stu-id="33c30-215">Category</span></span> | <span data-ttu-id="33c30-216">Clasificación del tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="33c30-216">Classification of the type of data.</span></span>  <span data-ttu-id="33c30-217">Para Automation, el valor es JobStreams.</span><span class="sxs-lookup"><span data-stu-id="33c30-217">For Automation, the value is JobStreams.</span></span> |
| <span data-ttu-id="33c30-218">nombreOperación</span><span class="sxs-lookup"><span data-stu-id="33c30-218">OperationName</span></span> | <span data-ttu-id="33c30-219">Especifica el tipo de operación realizada en Azure.</span><span class="sxs-lookup"><span data-stu-id="33c30-219">Specifies the type of operation performed in Azure.</span></span>  <span data-ttu-id="33c30-220">En Automation, el valor es Job.</span><span class="sxs-lookup"><span data-stu-id="33c30-220">For Automation, the value is Job.</span></span> |
| <span data-ttu-id="33c30-221">Recurso</span><span class="sxs-lookup"><span data-stu-id="33c30-221">Resource</span></span> | <span data-ttu-id="33c30-222">Nombre de la cuenta de Automation</span><span class="sxs-lookup"><span data-stu-id="33c30-222">Name of the Automation account</span></span> |
| <span data-ttu-id="33c30-223">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="33c30-223">SourceSystem</span></span> | <span data-ttu-id="33c30-224">Cómo Log Analytics ha recopilado los datos.</span><span class="sxs-lookup"><span data-stu-id="33c30-224">How Log Analytics collected the data.</span></span> <span data-ttu-id="33c30-225">Siempre *Azure* para Diagnósticos de Azure.</span><span class="sxs-lookup"><span data-stu-id="33c30-225">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="33c30-226">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="33c30-226">ResultDescription</span></span> |<span data-ttu-id="33c30-227">Incluye la secuencia de salida del Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-227">Includes the output stream from the runbook.</span></span> |
| <span data-ttu-id="33c30-228">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="33c30-228">CorrelationId</span></span> |<span data-ttu-id="33c30-229">GUID que es el identificador de correlación del trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-229">GUID that is the Correlation Id of the runbook job.</span></span> |
| <span data-ttu-id="33c30-230">ResourceId</span><span class="sxs-lookup"><span data-stu-id="33c30-230">ResourceId</span></span> |<span data-ttu-id="33c30-231">Especifica el identificador de recursos de la cuenta de Azure Automation del runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-231">Specifies the Azure Automation account resource id of the runbook.</span></span> |
| <span data-ttu-id="33c30-232">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="33c30-232">SubscriptionId</span></span> | <span data-ttu-id="33c30-233">El identificador de la suscripción de Azure (GUID) para la cuenta de Automation.</span><span class="sxs-lookup"><span data-stu-id="33c30-233">The Azure subscription Id (GUID) for the Automation account.</span></span> |
| <span data-ttu-id="33c30-234">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="33c30-234">ResourceGroup</span></span> | <span data-ttu-id="33c30-235">Nombre del grupo de recursos de la cuenta de Automation.</span><span class="sxs-lookup"><span data-stu-id="33c30-235">Name of the resource group for the Automation account.</span></span> |
| <span data-ttu-id="33c30-236">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="33c30-236">ResourceProvider</span></span> | <span data-ttu-id="33c30-237">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="33c30-237">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="33c30-238">ResourceType</span><span class="sxs-lookup"><span data-stu-id="33c30-238">ResourceType</span></span> | <span data-ttu-id="33c30-239">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="33c30-239">AUTOMATIONACCOUNTS</span></span> |

## <a name="viewing-automation-logs-in-log-analytics"></a><span data-ttu-id="33c30-240">Visualización de registros de Automatización en Log Analytics</span><span class="sxs-lookup"><span data-stu-id="33c30-240">Viewing Automation Logs in Log Analytics</span></span>
<span data-ttu-id="33c30-241">Ahora que ha iniciado el envío de los registros de los trabajos de Automation a Log Analytics, veamos lo que puede hacer con dichos registros en Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="33c30-241">Now that you have started sending your Automation job logs to Log Analytics, let’s see what you can do with these logs inside Log Analytics.</span></span>

<span data-ttu-id="33c30-242">Para ver los registros, ejecute la consulta siguiente: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span><span class="sxs-lookup"><span data-stu-id="33c30-242">To see the logs, run the following query: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span></span>

### <a name="send-an-email-when-a-runbook-job-fails-or-suspends"></a><span data-ttu-id="33c30-243">Envío de un correo electrónico cuando se produce un error en un trabajo del runbook o se suspende</span><span class="sxs-lookup"><span data-stu-id="33c30-243">Send an email when a runbook job fails or suspends</span></span>
<span data-ttu-id="33c30-244">Uno de nuestros principales clientes pregunta por la capacidad para enviar un correo electrónico o un mensaje de texto cuando aparece algún problema en un trabajo del runbook.</span><span class="sxs-lookup"><span data-stu-id="33c30-244">One of our top customer asks is for the ability to send an email or a text when something goes wrong with a runbook job.</span></span>   

<span data-ttu-id="33c30-245">Para crear una regla de alertas, lo primero es crear una búsqueda de registros de los registros del trabajo del runbook que deben invocar la alerta.</span><span class="sxs-lookup"><span data-stu-id="33c30-245">To create an alert rule, you start by creating a log search for the runbook job records that should invoke the alert.</span></span>  <span data-ttu-id="33c30-246">Haga clic en el botón **Alerta** para crear y configurar la regla de alerta.</span><span class="sxs-lookup"><span data-stu-id="33c30-246">Click the **Alert** button to create and configure the alert rule.</span></span>

1. <span data-ttu-id="33c30-247">En la página de información general de Log Analytics, haga clic en **Búsqueda de registros**.</span><span class="sxs-lookup"><span data-stu-id="33c30-247">From the Log Analytics Overview page, click **Log Search**.</span></span>
2. <span data-ttu-id="33c30-248">Cree una consulta de búsqueda de registros para la alerta escribiendo la siguiente búsqueda en el campo de consulta: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended)`. También puede agrupar por el valor de RunbookName mediante: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended) | measure Count() by RunbookName_s`.</span><span class="sxs-lookup"><span data-stu-id="33c30-248">Create a log search query for your alert by typing the following search into the query field:  `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended)`  You can also group by the RunbookName by using: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended) | measure Count() by RunbookName_s`</span></span>   

   <span data-ttu-id="33c30-249">Si ha configurado registros de más de una cuenta de Automation o suscripción a su área de trabajo, puede agrupar las alertas por suscripción o cuenta de Automation.</span><span class="sxs-lookup"><span data-stu-id="33c30-249">If you have set up logs from more than one Automation account or subscription to your workspace, you can group your alerts by subscription and Automation account.</span></span>  <span data-ttu-id="33c30-250">El nombre de la cuenta de Automatización puede derivarse del campo Resource (Recurso) en la búsqueda de JobLogs.</span><span class="sxs-lookup"><span data-stu-id="33c30-250">Automation account name can be derived from the Resource field in the search of JobLogs.</span></span>  
3. <span data-ttu-id="33c30-251">Para abrir la pantalla **Agregar regla de alerta**, haga clic en **Alerta** en la parte superior de la página.</span><span class="sxs-lookup"><span data-stu-id="33c30-251">To open the **Add Alert Rule** screen, click **Alert** at the top of the page.</span></span> <span data-ttu-id="33c30-252">Para más información sobre las opciones para configurar la alerta, consulte [Alertas de Log Analytics](../log-analytics/log-analytics-alerts.md#alert-rules).</span><span class="sxs-lookup"><span data-stu-id="33c30-252">For further details on the options to configure the alert, see [Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md#alert-rules).</span></span>

### <a name="find-all-jobs-that-have-completed-with-errors"></a><span data-ttu-id="33c30-253">Búsqueda de todos los trabajos que se han completado con errores</span><span class="sxs-lookup"><span data-stu-id="33c30-253">Find all jobs that have completed with errors</span></span>
<span data-ttu-id="33c30-254">Además de las alertas al producirse errores, puede saber cuando un trabajo de runbook tiene un error de no terminación.</span><span class="sxs-lookup"><span data-stu-id="33c30-254">In addition to alerting on failures, you can find when a runbook job has a non-terminating error.</span></span> <span data-ttu-id="33c30-255">En estos casos, PowerShell genera un flujo de errores, pero los errores de no terminación no causan la suspensión ni producirán un error en el trabajo.</span><span class="sxs-lookup"><span data-stu-id="33c30-255">In these cases PowerShell produces an error stream, but the non-terminating errors do not cause your job to suspend or fail.</span></span>    

1. <span data-ttu-id="33c30-256">En el área de trabajo de Log Analytics, haga clic en **Búsqueda de registros**.</span><span class="sxs-lookup"><span data-stu-id="33c30-256">In your Log Analytics workspace, click **Log Search**.</span></span>
2. <span data-ttu-id="33c30-257">En el campo de consulta, escriba `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams StreamType_s=Error | measure count() by JobId_g` y luego haga clic en **Buscar**.</span><span class="sxs-lookup"><span data-stu-id="33c30-257">In the query field, type `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams StreamType_s=Error | measure count() by JobId_g` and then click **Search**.</span></span>

### <a name="view-job-streams-for-a-job"></a><span data-ttu-id="33c30-258">Visualización de las transmisiones de un trabajo</span><span class="sxs-lookup"><span data-stu-id="33c30-258">View job streams for a job</span></span>
<span data-ttu-id="33c30-259">Cuando se depura un trabajo, también se pueden examinar sus transmisiones.</span><span class="sxs-lookup"><span data-stu-id="33c30-259">When you are debugging a job, you may also want to look into the job streams.</span></span>  <span data-ttu-id="33c30-260">La siguiente consulta muestra todas las transmisiones de un solo trabajo con GUID 2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0:</span><span class="sxs-lookup"><span data-stu-id="33c30-260">The following query shows all the streams for a single job with GUID 2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0:</span></span>   

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams JobId_g="2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0" | sort TimeGenerated | select ResultDescription`

### <a name="view-historical-job-status"></a><span data-ttu-id="33c30-261">Visualización del estado del historial de trabajos</span><span class="sxs-lookup"><span data-stu-id="33c30-261">View historical job status</span></span>
<span data-ttu-id="33c30-262">Por último, puede desear visualizar el historial de trabajos con el paso del tiempo.</span><span class="sxs-lookup"><span data-stu-id="33c30-262">Finally, you may want to visualize your job history over time.</span></span>  <span data-ttu-id="33c30-263">Esta consulta se puede usar para buscar el estado de los trabajos con el paso del tiempo.</span><span class="sxs-lookup"><span data-stu-id="33c30-263">You can use this query to search for the status of your jobs over time.</span></span>

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs NOT(ResultType="started") | measure Count() by ResultType interval 1hour`  
<br> <span data-ttu-id="33c30-264">![Gráfico del historial de trabajos de OMS](media/automation-manage-send-joblogs-log-analytics/historical-job-status-chart.png)</span><span class="sxs-lookup"><span data-stu-id="33c30-264">![OMS Historical Job Status Chart](media/automation-manage-send-joblogs-log-analytics/historical-job-status-chart.png)</span></span><br>

## <a name="summary"></a><span data-ttu-id="33c30-265">Resumen</span><span class="sxs-lookup"><span data-stu-id="33c30-265">Summary</span></span>
<span data-ttu-id="33c30-266">Al enviar el estado de trabajo y los datos de flujo de Automation a Log Analytics, puede obtener más información del estado de los trabajos de Automation mediante lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="33c30-266">By sending your Automation job status and stream data to Log Analytics, you can get better insight into the status of your Automation jobs by:</span></span>
+ <span data-ttu-id="33c30-267">Establecimiento de alertas que le notificarán cuando haya un problema</span><span class="sxs-lookup"><span data-stu-id="33c30-267">Setting up alerts to notify you when there is an issue</span></span>
+ <span data-ttu-id="33c30-268">Uso de vistas personalizadas y de consultas de búsqueda para visualizar los resultados de runbook, el estado del trabajo de runbook y otras métricas o indicadores clave relacionados.</span><span class="sxs-lookup"><span data-stu-id="33c30-268">Using custom views and search queries to visualize your runbook results, runbook job status, and other related key indicators or metrics.</span></span>  

<span data-ttu-id="33c30-269">Log Analytics proporciona mayor visibilidad operativa para los trabajos de Automation y pueden ayudar a resolver incidentes con más rapidez.</span><span class="sxs-lookup"><span data-stu-id="33c30-269">Log Analytics provides greater operational visibility to your Automation jobs and can help address incidents quicker.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="33c30-270">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="33c30-270">Next steps</span></span>
* <span data-ttu-id="33c30-271">Para aprender a crear diferentes consultas de búsqueda y a revisar los registros de trabajos de Automatización con Log Analytics, consulte [Búsquedas de registros en Log Analytics](../log-analytics/log-analytics-log-searches.md)</span><span class="sxs-lookup"><span data-stu-id="33c30-271">To learn more about how to construct different search queries and review the Automation job logs with Log Analytics, see [Log searches in Log Analytics](../log-analytics/log-analytics-log-searches.md)</span></span>
* <span data-ttu-id="33c30-272">Para aprender a crear y recuperar los mensajes de salida y de error de los runbooks en, consulte [Salidas de runbook y mensajes en la Automatización de Azure](automation-runbook-output-and-messages.md)</span><span class="sxs-lookup"><span data-stu-id="33c30-272">To understand how to create and retrieve output and error messages from runbooks, see [Runbook output and messages](automation-runbook-output-and-messages.md)</span></span>
* <span data-ttu-id="33c30-273">Para más información acerca de la ejecución de un runbook, cómo supervisar trabajos del runbook y otros detalles técnicos, consulte [Ejecución de un runbook en Automatización de Azure](automation-runbook-execution.md)</span><span class="sxs-lookup"><span data-stu-id="33c30-273">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md)</span></span>
* <span data-ttu-id="33c30-274">Para más información acerca de Log Analytics de OMS y de los orígenes de recopilación de datos, consulte [Conexión de Almacenamiento de Azure con Log Analytics](../log-analytics/log-analytics-azure-storage.md)</span><span class="sxs-lookup"><span data-stu-id="33c30-274">To learn more about OMS Log Analytics and data collection sources, see [Collecting Azure storage data in Log Analytics overview](../log-analytics/log-analytics-azure-storage.md)</span></span>
