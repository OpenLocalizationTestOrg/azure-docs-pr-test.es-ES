---
title: Mi primer runbook de PowerShell en Azure Automation | Microsoft Docs
description: "Tutorial que le guiará a través de la creación, prueba y publicación de un runbook de PowerShell."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "powershell de Azure, tutorial de scripts de powershell, automatización de powershell"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: 4b32011b72acc647d4af44bb5ccbcaab408fb4d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="c1603-104">Mi primer runbook de PowerShell</span><span class="sxs-lookup"><span data-stu-id="c1603-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="c1603-105">Gráfico</span><span class="sxs-lookup"><span data-stu-id="c1603-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="c1603-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="c1603-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="c1603-107">Flujo de trabajo de PowerShell</span><span class="sxs-lookup"><span data-stu-id="c1603-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="c1603-108">Este tutorial le guiará por la creación de un [Runbook de PowerShell](automation-runbook-types.md#powershell-runbooks) en Automatización de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1603-108">This tutorial walks you through the creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="c1603-109">Comenzaremos con un runbook simple que probaremos y publicaremos, y explicaremos cómo hacer un seguimiento del estado del trabajo del runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-109">We start with a simple runbook that we test and publish while we explain how to track the status of the runbook job.</span></span> <span data-ttu-id="c1603-110">A continuación, modificaremos el runbook para administrar recursos de Azure, en este caso, iniciar una máquina virtual de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1603-110">Then we modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="c1603-111">Para finalizar, agregaremos parámetros de runbook para que el runbook sea más robusto.</span><span class="sxs-lookup"><span data-stu-id="c1603-111">Lastly, we make the runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c1603-112">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="c1603-112">Prerequisites</span></span>
<span data-ttu-id="c1603-113">Para completar este tutorial, necesitará lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="c1603-113">To complete this tutorial, you need the following:</span></span>

* <span data-ttu-id="c1603-114">Suscripción de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1603-114">Azure subscription.</span></span> <span data-ttu-id="c1603-115">Si aún no tiene ninguna, puede [activar las ventajas de la suscripción a MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) o <a href="/pricing/free-account/" target="_blank">[registrarse para obtener una cuenta gratis](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="c1603-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="c1603-116">[Cuenta de Automatización](automation-sec-configure-azure-runas-account.md) para contener el Runbook y autenticarse en recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1603-116">[Automation account](automation-sec-configure-azure-runas-account.md) to hold the runbook and authenticate to Azure resources.</span></span>  <span data-ttu-id="c1603-117">Esta cuenta debe tener permiso para iniciar y detener la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c1603-117">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="c1603-118">Una máquina virtual de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1603-118">An Azure virtual machine.</span></span> <span data-ttu-id="c1603-119">Detendremos e iniciaremos esta máquina, por lo que no debería ser una máquina virtual de producción.</span><span class="sxs-lookup"><span data-stu-id="c1603-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="c1603-120">Paso 1: crear nuevo runbook</span><span class="sxs-lookup"><span data-stu-id="c1603-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="c1603-121">Empezaremos creando un runbook simple que genere el texto *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="c1603-121">We'll start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="c1603-122">En el Portal de Azure, abra su cuenta de Automatización.</span><span class="sxs-lookup"><span data-stu-id="c1603-122">In the Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="c1603-123">La página de la cuenta de Automatización proporciona una vista rápida de los recursos que hay en esa cuenta.</span><span class="sxs-lookup"><span data-stu-id="c1603-123">The Automation account page gives you a quick view of the resources in this account.</span></span> <span data-ttu-id="c1603-124">Ya debería tener algunos recursos.</span><span class="sxs-lookup"><span data-stu-id="c1603-124">You should already have some assets.</span></span> <span data-ttu-id="c1603-125">Muchas de ellos son los módulos que se incluyen automáticamente en una cuenta nueva de Automatización.</span><span class="sxs-lookup"><span data-stu-id="c1603-125">Most of those are the modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="c1603-126">También debe tener el recurso de credencial que se menciona en los [requisitos previos](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="c1603-126">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="c1603-127">Haga clic en el icono **Runbooks** para abrir la lista de runbooks.</span><span class="sxs-lookup"><span data-stu-id="c1603-127">Click the **Runbooks** tile to open the list of runbooks.</span></span><br><br> <span data-ttu-id="c1603-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="c1603-129">Para crear un runbook, haga clic en el botón **Agregar un runbook** y en **Crear un runbook nuevo**.</span><span class="sxs-lookup"><span data-stu-id="c1603-129">Create a new runbook by clicking the **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="c1603-130">Asigne al Runbook el nombre *MyFirstRunbook-PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="c1603-130">Give the runbook the name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="c1603-131">En este caso, vamos a crear un [runbook de PowerShell](automation-runbook-types.md#powershell-runbooks), por tanto, seleccione **Powershell** en **Tipo de runbook**.</span><span class="sxs-lookup"><span data-stu-id="c1603-131">In this case, we're going to create a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="c1603-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="c1603-133">Haga clic en **Crear** para crear el runbook y abra el editor de texto.</span><span class="sxs-lookup"><span data-stu-id="c1603-133">Click **Create** to create the runbook and open the textual editor.</span></span>

## <a name="step-2---add-code-to-the-runbook"></a><span data-ttu-id="c1603-134">Paso 2: Incorporación de código al runbook</span><span class="sxs-lookup"><span data-stu-id="c1603-134">Step 2 - Add code to the runbook</span></span>
<span data-ttu-id="c1603-135">Puede escribir el código directamente en el runbook o seleccionar los cmdlets, runbooks y recursos desde el control Biblioteca y agregarlos al runbook con los parámetros relacionados.</span><span class="sxs-lookup"><span data-stu-id="c1603-135">You can either type code directly into the runbook, or you can select cmdlets, runbooks, and assets from the Library control and have them added to the runbook with any related parameters.</span></span> <span data-ttu-id="c1603-136">En este tutorial, escribiremos directamente en el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-136">For this walkthrough, we type directly in the runbook.</span></span>

1. <span data-ttu-id="c1603-137">Nuestro Runbook ahora está vacío, escriba *Write-Output "Hello World"*.</span><span class="sxs-lookup"><span data-stu-id="c1603-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="c1603-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="c1603-139">Guarde el Runbook, para lo que debe hacer clic en **Guardar**.</span><span class="sxs-lookup"><span data-stu-id="c1603-139">Save the runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="c1603-140">![Botón Guardar](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="c1603-141">Paso 3: probar el runbook</span><span class="sxs-lookup"><span data-stu-id="c1603-141">Step 3 - Test the runbook</span></span>
<span data-ttu-id="c1603-142">Antes de que publiquemos el runbook para que esté disponible en producción, queremos probarlo para asegurarnos de que funciona correctamente.</span><span class="sxs-lookup"><span data-stu-id="c1603-142">Before we publish the runbook to make it available in production, we want to test it to make sure that it works properly.</span></span> <span data-ttu-id="c1603-143">Cuando se prueba un runbook, se ejecuta su versión **Borrador** y se visualizan sus resultados de forma interactiva.</span><span class="sxs-lookup"><span data-stu-id="c1603-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="c1603-144">Haga clic en **Panel Prueba** para abrir el panel de prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-144">Click **Test pane** to open the Test pane.</span></span><br><br> <span data-ttu-id="c1603-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="c1603-146">Haga clic en **Iniciar** para iniciar la prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-146">Click **Start** to start the test.</span></span> <span data-ttu-id="c1603-147">Esta debe ser la única opción habilitada.</span><span class="sxs-lookup"><span data-stu-id="c1603-147">This should be the only enabled option.</span></span>
3. <span data-ttu-id="c1603-148">Se crea un [trabajo de runbook](automation-runbook-execution.md) y se muestra su estado.</span><span class="sxs-lookup"><span data-stu-id="c1603-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="c1603-149">El estado del trabajo se inicia como *En cola*, lo que indica que está esperando que haya disponible un trabajo de runbook en la nube.</span><span class="sxs-lookup"><span data-stu-id="c1603-149">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to come available.</span></span> <span data-ttu-id="c1603-150">Su estado cambiará a *Iniciando* cuando un trabajo de runbook lo solicite. Cuando el runbook comience a ejecutarse realmente, el estado será *En ejecución*.</span><span class="sxs-lookup"><span data-stu-id="c1603-150">It will then move to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  
4. <span data-ttu-id="c1603-151">Cuando se complete el trabajo del runbook, se mostrará su resultado.</span><span class="sxs-lookup"><span data-stu-id="c1603-151">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="c1603-152">En nuestro caso, deberíamos ver *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="c1603-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="c1603-153">![Salida del panel de prueba](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="c1603-154">Cierre el panel Prueba para volver al lienzo.</span><span class="sxs-lookup"><span data-stu-id="c1603-154">Close the Test pane to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="c1603-155">Paso 4: publicar e iniciar el runbook</span><span class="sxs-lookup"><span data-stu-id="c1603-155">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="c1603-156">El runbook que acabamos de crear aún está en modo borrador.</span><span class="sxs-lookup"><span data-stu-id="c1603-156">The runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="c1603-157">Tenemos que publicarlo antes de que podamos ejecutarlo en producción.</span><span class="sxs-lookup"><span data-stu-id="c1603-157">We need to publish it before we can run it in production.</span></span>  <span data-ttu-id="c1603-158">Al publicar un runbook, se sobrescribe la versión publicada existente con la versión de borrador.</span><span class="sxs-lookup"><span data-stu-id="c1603-158">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span>  <span data-ttu-id="c1603-159">En nuestro caso, no tenemos una versión publicada aún porque acabamos de crear el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-159">In our case, we don't have a Published version yet because we just created the runbook.</span></span>

1. <span data-ttu-id="c1603-160">Haga clic en **Publicar** para publicar el runbook y en **Sí** cuando se le solicite.</span><span class="sxs-lookup"><span data-stu-id="c1603-160">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="c1603-161">![Botón Publicar](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="c1603-162">Si se desplaza ahora a la izquierda para ver el runbook en el panel **Runbooks**, mostrará el **Estado de creación** **Publicado**.</span><span class="sxs-lookup"><span data-stu-id="c1603-162">If you scroll left to view the runbook in the **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="c1603-163">Desplácese de nuevo a la derecha para ver el panel de **MyFirstRunbook-PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="c1603-163">Scroll back to the right to view the pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="c1603-164">Las opciones en la parte superior nos permiten iniciar el runbook, verlo, programarlo para que se inicie en algún momento en el futuro o crear un [webhook](automation-webhooks.md) para que se inicie a través de una llamada HTTP.</span><span class="sxs-lookup"><span data-stu-id="c1603-164">The options across the top allow us to start the runbook, view the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="c1603-165">Deseamos iniciar el runbook, así que hacemos clic en **Iniciar** y, después, en **Aceptar** cuando se abre la hoja Iniciar Runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-165">We want to start the runbook, so click **Start** and then click **Ok** when the Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="c1603-166">![Botón Iniciar](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="c1603-167">Se abre un panel de trabajo para el trabajo de runbook que acabamos de crear.</span><span class="sxs-lookup"><span data-stu-id="c1603-167">A job pane is opened for the runbook job that we created.</span></span> <span data-ttu-id="c1603-168">Podemos cerrar este panel, pero en este caso lo dejaremos abierto para que podamos ver el progreso del trabajo.</span><span class="sxs-lookup"><span data-stu-id="c1603-168">We can close this pane, but in this case we leave it open so we can watch the job's progress.</span></span>
6. <span data-ttu-id="c1603-169">El estado del trabajo se muestra en **Resumen del trabajo** y coincide con los estados que vimos cuando probamos el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-169">The job status is shown in **Job Summary** and matches the statuses that we saw when we tested the runbook.</span></span><br><br> <span data-ttu-id="c1603-170">![Resumen del trabajo](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="c1603-171">Cuando el estado del runbook aparezca como *Completado*, haga clic en **Salida**.</span><span class="sxs-lookup"><span data-stu-id="c1603-171">Once the runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="c1603-172">Se abre el panel Salida y podemos ver *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="c1603-172">The Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="c1603-173">![Salida de trabajo](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="c1603-174">Cierre el panel Salida.</span><span class="sxs-lookup"><span data-stu-id="c1603-174">Close the Output pane.</span></span>
9. <span data-ttu-id="c1603-175">Haga clic en **Todos los registros** para abrir el panel Transmisiones para el trabajo de Runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-175">Click **All Logs** to open the Streams pane for the runbook job.</span></span> <span data-ttu-id="c1603-176">Solo deberíamos ver *Hello World* en el flujo de salida, pero se pueden mostrar otras transmisiones de un trabajo de Runbook como Detallado y Error si el Runbook escribe en ellas.</span><span class="sxs-lookup"><span data-stu-id="c1603-176">We should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br><br> <span data-ttu-id="c1603-177">![Todos los registros](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="c1603-178">Cierre el panel Secuencias y el panel de trabajo para volver al panel MyFirstRunbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-178">Close the Streams pane and the Job pane to return to the MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="c1603-179">Haga clic en **Trabajos** para abrir el panel Trabajos de este runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-179">Click **Jobs** to open the Jobs pane for this runbook.</span></span> <span data-ttu-id="c1603-180">Enumera todos los trabajos creados por este runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-180">This lists all of the jobs created by this runbook.</span></span> <span data-ttu-id="c1603-181">Solo deberíamos ver un trabajo en la lista ya que solo ejecutamos el trabajo una vez.</span><span class="sxs-lookup"><span data-stu-id="c1603-181">We should only see one job listed since we only ran the job once.</span></span><br><br> <span data-ttu-id="c1603-182">![Lista de trabajos](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="c1603-183">Puede hacer clic en esta tarea para abrir el mismo panel Trabajo que vimos cuando se inició el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-183">You can click this job to open the same Job pane that we viewed when we started the runbook.</span></span> <span data-ttu-id="c1603-184">Esto permite volver atrás en el tiempo y ver los detalles de cualquier trabajo que se creó para un runbook determinado.</span><span class="sxs-lookup"><span data-stu-id="c1603-184">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="c1603-185">Paso 5: agregar autenticación para administrar recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="c1603-185">Step 5 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="c1603-186">Hemos probado y publicado nuestro runbook, pero hasta ahora no hace nada útil.</span><span class="sxs-lookup"><span data-stu-id="c1603-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="c1603-187">Queremos que administre recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1603-187">We want to have it manage Azure resources.</span></span> <span data-ttu-id="c1603-188">Sin embargo, no podrá hacerlo aunque a menos que lo autentiquemos con las credenciales que se mencionan en los [requisitos previos](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="c1603-188">It won't be able to do that though unless we have it authenticate using the credentials that are referred to in the [prerequisites](#prerequisites).</span></span> <span data-ttu-id="c1603-189">Esto se hace con el cmdlet **Add-AzureRmAccount** .</span><span class="sxs-lookup"><span data-stu-id="c1603-189">We do that with the **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="c1603-190">Abra el editor de texto haciendo clic en **Editar** en el panel MyFirstRunbook-PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c1603-190">Open the textual editor by clicking **Edit** on the MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="c1603-191">![Editar runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="c1603-192">Ya no necesitamos la línea **Write-Output** , así que elimínela.</span><span class="sxs-lookup"><span data-stu-id="c1603-192">We don't need the **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="c1603-193">Escriba o copie y pegue el siguiente código que controla la autenticación con la cuenta de ejecución de Automation:</span><span class="sxs-lookup"><span data-stu-id="c1603-193">Type or copy and paste the following code that handles the authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="c1603-194">Haga clic en el **panel Prueba** para poder probar el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-194">Click **Test pane** so that we can test the runbook.</span></span>
5. <span data-ttu-id="c1603-195">Haga clic en **Iniciar** para iniciar la prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-195">Click **Start** to start the test.</span></span> <span data-ttu-id="c1603-196">Cuando termine, recibirá unos resultados similares a los siguientes, que muestran información básica de su cuenta.</span><span class="sxs-lookup"><span data-stu-id="c1603-196">Once it completes, you should receive output similar to the following, displaying basic information from your account.</span></span> <span data-ttu-id="c1603-197">Esto confirma que la credencial es válida.</span><span class="sxs-lookup"><span data-stu-id="c1603-197">This confirms that the credential is valid.</span></span><br><br> <span data-ttu-id="c1603-198">![Autenticar](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-to-start-a-virtual-machine"></a><span data-ttu-id="c1603-199">Paso 6: Incorporación de una actividad para iniciar una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="c1603-199">Step 6 - Add code to start a virtual machine</span></span>
<span data-ttu-id="c1603-200">Ahora que el runbook se autentica en nuestra suscripción a Azure, podemos administrar los recursos.</span><span class="sxs-lookup"><span data-stu-id="c1603-200">Now that our runbook is authenticating to our Azure subscription, we can manage resources.</span></span> <span data-ttu-id="c1603-201">Vamos a agregar un comando para iniciar una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c1603-201">We add a command to start a virtual machine.</span></span> <span data-ttu-id="c1603-202">Puede seleccionar cualquier máquina virtual de su suscripción de Azure. Por ahora, vamos a codificar ese nombre en el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in the runbook.</span></span>

1. <span data-ttu-id="c1603-203">Después de *Add-AzureRmAccount*, escriba *Start-AzureRmVM -Name 'NombreVM' -ResourceGroupName 'NombreGrupoRecursos'* y proporcione el nombre y el nombre del grupo de recursos de la máquina virtual que se iniciará.</span><span class="sxs-lookup"><span data-stu-id="c1603-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing the name and Resource Group name of the virtual machine to start.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="c1603-204">Guarde el runbook y haga clic en el **panel Prueba** para poder probarlo.</span><span class="sxs-lookup"><span data-stu-id="c1603-204">Save the runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="c1603-205">Haga clic en **Iniciar** para iniciar la prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-205">Click **Start** to start the test.</span></span> <span data-ttu-id="c1603-206">Cuando haya terminado, compruebe que la máquina virtual se ha iniciado.</span><span class="sxs-lookup"><span data-stu-id="c1603-206">Once it completes, check that the virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-to-the-runbook"></a><span data-ttu-id="c1603-207">Paso 7: agregar un parámetro de entrada al runbook</span><span class="sxs-lookup"><span data-stu-id="c1603-207">Step 7 - Add an input parameter to the runbook</span></span>
<span data-ttu-id="c1603-208">Actualmente, nuestro runbook inicia la máquina virtual que codificamos en el runbook, pero nuestro runbook sería más útil si pudiéramos especificar la máquina virtual cuando se inicia el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-208">Our runbook currently starts the virtual machine that we hardcoded in the runbook, but it would be more useful if we specify the virtual machine when the runbook is started.</span></span> <span data-ttu-id="c1603-209">Ahora agregaremos parámetros de entrada para que el runbook proporcione esa funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="c1603-209">We will now add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="c1603-210">Agregue parámetros para *NombreVM* y *NombreGrupoRecursos* al runbook y use estas variables con el cmdlet **Start-AzureRmVM** como se muestra en el siguiente ejemplo.</span><span class="sxs-lookup"><span data-stu-id="c1603-210">Add parameters for *VMName* and *ResourceGroupName* to the runbook and use these variables with the **Start-AzureRmVM** cmdlet as in the example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="c1603-211">Guarde el runbook y abra el panel Prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-211">Save the runbook and open the Test pane.</span></span> <span data-ttu-id="c1603-212">Ahora puede proporcionar valores para las dos variables de entrada que se usarán en la prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-212">You can now provide values for the two input variables that are used in the test.</span></span>
3. <span data-ttu-id="c1603-213">Cierre el panel Prueba.</span><span class="sxs-lookup"><span data-stu-id="c1603-213">Close the Test pane.</span></span>
4. <span data-ttu-id="c1603-214">Haga clic en **Publicar** para publicar la nueva versión del runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-214">Click **Publish** to publish the new version of the runbook.</span></span>
5. <span data-ttu-id="c1603-215">Detenga la máquina virtual que inició en el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="c1603-215">Stop the virtual machine that you started in the previous step.</span></span>
6. <span data-ttu-id="c1603-216">Haga clic en **Iniciar** para iniciar el runbook.</span><span class="sxs-lookup"><span data-stu-id="c1603-216">Click **Start** to start the runbook.</span></span> <span data-ttu-id="c1603-217">Escriba el valor de **NombreVM** y **NombreGrupoRecursos** para la máquina virtual que va a iniciar.</span><span class="sxs-lookup"><span data-stu-id="c1603-217">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br><br> <span data-ttu-id="c1603-218">![Pasar parámetro](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="c1603-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="c1603-219">Cuando se complete el runbook, compruebe que la máquina virtual se ha iniciado.</span><span class="sxs-lookup"><span data-stu-id="c1603-219">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="c1603-220">Diferencias del flujo de trabajo de PowerShell</span><span class="sxs-lookup"><span data-stu-id="c1603-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="c1603-221">Los runbooks de PowerShell tienen el mismo ciclo de vida, las mismas funcionalidades y la misma administración que los runbooks de flujo de trabajo de PowerShell, pero existen algunas diferencias y limitaciones:</span><span class="sxs-lookup"><span data-stu-id="c1603-221">PowerShell runbooks have the same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="c1603-222">Los runbooks de PowerShell se ejecutan más rápido en comparación con los runbooks de flujo de trabajo de PowerShell, pues estos no tienen paso de compilación.</span><span class="sxs-lookup"><span data-stu-id="c1603-222">PowerShell runbooks run fast compared to PowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="c1603-223">Los runbooks de flujo de trabajo de PowerShell admiten los puntos de control y su uso. Los runbooks de flujo de trabajo de PowerShell pueden reanudarse desde cualquier punto en el runbook mientras que los runbooks de PowerShell solo puede reanudarse desde el principio.</span><span class="sxs-lookup"><span data-stu-id="c1603-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in the runbook whereas PowerShell runbooks can only resume from the beginning.</span></span>
3. <span data-ttu-id="c1603-224">Los runbooks de flujo de trabajo de PowerShell admiten la ejecución en serie y en paralelo, mientras que los runbooks de PowerShell solo puede ejecutar comandos en serie.</span><span class="sxs-lookup"><span data-stu-id="c1603-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="c1603-225">En un runbook de flujo de trabajo de PowerShell, una actividad, un comando o un bloque de script pueden tener su propio espacio de ejecución, mientras que en un runbook de PowerShell todo lo que hay en el script se ejecuta en un único espacio de ejecución.</span><span class="sxs-lookup"><span data-stu-id="c1603-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="c1603-226">También se observan algunas [diferencias sintácticas](https://technet.microsoft.com/magazine/dn151046.aspx) entre un runbook de PowerShell nativo y un runbook de flujo de trabajo de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c1603-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c1603-227">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="c1603-227">Next steps</span></span>
* <span data-ttu-id="c1603-228">Para empezar a trabajar con cuadernos gráficos, consulte [Mi primer runbook gráfico](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="c1603-228">To get started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="c1603-229">Para empezar a trabajar con Runbooks de flujo de trabajo de PowerShell, consulte [Mi primer runbook de flujo de trabajo de PowerShell](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="c1603-229">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="c1603-230">Para obtener más información sobre los tipos de Runbook, sus ventajas y sus limitaciones, consulte [Tipos de runbooks de Automatización de Azure](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="c1603-230">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="c1603-231">Para obtener más información sobre la característica de compatibilidad con scripts de PowerShell, consulte [Announcing Native PowerShell Script Support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="c1603-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

