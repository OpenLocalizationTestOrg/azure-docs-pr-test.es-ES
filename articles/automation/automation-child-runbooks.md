---
title: Runbooks secundarios en Azure Automation | Microsoft Docs
description: "Describe los diferentes métodos para iniciar un runbook en la Automatización de Azure desde otro runbook y compartir información entre ellos."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: a605d278dbbda9613b91007ea6a7042403a7a6ff
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="83826-103">Runbooks secundarios en la Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="83826-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="83826-104">Un procedimiento recomendado en la Automatización de Azure es escribir runbooks que sean reutilizables y modulares con una función independiente que puedan usar otros runbooks.</span><span class="sxs-lookup"><span data-stu-id="83826-104">It is a best practice in Azure Automation to write reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="83826-105">Con frecuencia, un runbook primario llamará a uno o varios runbooks secundarios para realizar la funcionalidad necesaria.</span><span class="sxs-lookup"><span data-stu-id="83826-105">A parent runbook will often call one or more child runbooks to perform required functionality.</span></span> <span data-ttu-id="83826-106">Existen dos maneras de llamar a un runbook secundario y cada una tiene varias diferencias que debería conocer para poder determinar cuál de ellas es mejor para los diferentes escenarios.</span><span class="sxs-lookup"><span data-stu-id="83826-106">There are two ways to call a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="83826-107">Invocación de un runbook secundario mediante la ejecución en línea</span><span class="sxs-lookup"><span data-stu-id="83826-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="83826-108">Para invocar un runbook en línea desde otro runbook, use el nombre del runbook y proporcione valores para sus parámetros, exactamente igual a como usaría una actividad o un cmdlet.</span><span class="sxs-lookup"><span data-stu-id="83826-108">To invoke a runbook inline from another runbook, you use the name of the runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="83826-109">De esta manera, todos los runbooks de la misma cuenta de Automatización estarán disponibles para que todos los demás los usen.</span><span class="sxs-lookup"><span data-stu-id="83826-109">All runbooks in the same Automation account are available to all others to be used in this manner.</span></span> <span data-ttu-id="83826-110">El runbook principal esperará a que el runbook secundario se complete antes de pasar a la siguiente línea, y cualquier resultado se devolverá directamente al elemento primario.</span><span class="sxs-lookup"><span data-stu-id="83826-110">The parent runbook will wait for the child runbook to complete before moving to the next line, and any output is returned directly to the parent.</span></span>

<span data-ttu-id="83826-111">Al invocar un runbook en línea, este se ejecuta en el mismo trabajo que el runbook primario.</span><span class="sxs-lookup"><span data-stu-id="83826-111">When you invoke a runbook inline, it runs in the same job as the parent runbook.</span></span> <span data-ttu-id="83826-112">No habrá ninguna indicación en el historial de trabajos del runbook secundario que se haya ejecutado.</span><span class="sxs-lookup"><span data-stu-id="83826-112">There will be no indication in the job history of the child runbook that it ran.</span></span> <span data-ttu-id="83826-113">Cualquier excepción y salida de flujo pertenecientes al runbook secundario, se asociarán al primario.</span><span class="sxs-lookup"><span data-stu-id="83826-113">Any exceptions and any stream output from the child runbook will be associated with the parent.</span></span> <span data-ttu-id="83826-114">Como resultado, hay menos trabajos y se facilita el seguimiento y la solución de problemas, ya que las excepciones producidas por el runbook secundario y la salida de flujo se asocian al trabajo primario.</span><span class="sxs-lookup"><span data-stu-id="83826-114">This results in fewer jobs and makes them easier to track and to troubleshoot since any exceptions thrown by the child runbook and any of its stream output are associated with the parent job.</span></span>

<span data-ttu-id="83826-115">Cuando se publica un runbook, cualquier runbook secundario al que llame deberá estar ya estar publicado.</span><span class="sxs-lookup"><span data-stu-id="83826-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="83826-116">Esto es así porque la Automatización de Azure crea una asociación con los runbooks secundarios cuando se compila un runbook.</span><span class="sxs-lookup"><span data-stu-id="83826-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="83826-117">Si no, parecerá que el runbook primario se publica correctamente, pero generará una excepción cuando se inicie.</span><span class="sxs-lookup"><span data-stu-id="83826-117">If they aren’t, the parent runbook will appear to publish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="83826-118">Si esto sucediera, puede volver a publicar el runbook primario para que haga referencia correctamente a los runbooks secundarios.</span><span class="sxs-lookup"><span data-stu-id="83826-118">If this happens, you can republish the parent runbook in order to properly reference the child runbooks.</span></span> <span data-ttu-id="83826-119">No es necesario que vuelva a publicar el runbook primario si cambia uno de los runbooks secundarios, porque ya se habrá creado la asociación.</span><span class="sxs-lookup"><span data-stu-id="83826-119">You do not need to republish the parent runbook if any of the child runbooks are changed because the association will have already been created.</span></span>

<span data-ttu-id="83826-120">Los parámetros de un Runbook secundario en línea pueden ser de cualquier tipo de datos (incluidos los objetos complejos), y no hay ninguna [serialización JSON](automation-starting-a-runbook.md#runbook-parameters) como sucede cuando se inicia el Runbook mediante el Portal de administración de Azure o mediante el cmdlet Start-AzureRmAutomationRunbook cmdlet.</span><span class="sxs-lookup"><span data-stu-id="83826-120">The parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start the runbook using the Azure Management Portal or with the Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="83826-121">Tipos de runbook</span><span class="sxs-lookup"><span data-stu-id="83826-121">Runbook types</span></span>
<span data-ttu-id="83826-122">Qué tipos pueden llamarse entre sí:</span><span class="sxs-lookup"><span data-stu-id="83826-122">Which types can call each other:</span></span>

* <span data-ttu-id="83826-123">Un [runbook de PowerShell](automation-runbook-types.md#powershell-runbooks) y los [runbooks gráficos](automation-runbook-types.md#graphical-runbooks) pueden llamarse entre sí en línea (ambos se basan en PowerShell).</span><span class="sxs-lookup"><span data-stu-id="83826-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="83826-124">Un [runbook de flujo de trabajo de PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) y los runbooks gráficos de flujo de trabajo de PowerShell pueden llamarse entre sí en línea (ambos tipos se basan en el flujo de trabajo de PowerShell).</span><span class="sxs-lookup"><span data-stu-id="83826-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="83826-125">Los tipos de PowerShell y los tipos de flujo de trabajo de PowerShell no pueden llamarse entre sí en línea, y deben utilizar Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="83826-125">The PowerShell types and the PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="83826-126">Cuándo es importante el orden de publicación:</span><span class="sxs-lookup"><span data-stu-id="83826-126">When does publish order matter:</span></span>

* <span data-ttu-id="83826-127">El orden de publicación de runbooks solo es importante para los runbooks de flujo de trabajo de PowerShell y los runbooks gráficos de flujo de trabajo de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="83826-127">The publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="83826-128">Cuando se llama a un runbook secundario gráfico o de flujo de trabajo de PowerShell con la ejecución insertada, solo tiene que usar el nombre del runbook.</span><span class="sxs-lookup"><span data-stu-id="83826-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use the name of the runbook.</span></span>  <span data-ttu-id="83826-129">Cuando se llama a un runbook secundario de PowerShell, debe precedido a su nombre *.\\*  para especificar que el script se encuentra en el directorio local.</span><span class="sxs-lookup"><span data-stu-id="83826-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* to specify that the script is located in the local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="83826-130">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="83826-130">Example</span></span>
<span data-ttu-id="83826-131">En el ejemplo siguiente se invoca un runbook secundario de prueba que acepta tres parámetros: un objeto complejo, un entero y un valor booleano.</span><span class="sxs-lookup"><span data-stu-id="83826-131">The following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="83826-132">Los resultados del runbook secundario se asignan a una variable.</span><span class="sxs-lookup"><span data-stu-id="83826-132">The output of the child runbook is assigned to a variable.</span></span>  <span data-ttu-id="83826-133">En este caso, el runbook secundario es un runbook de flujo de trabajo de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="83826-133">In this case, the child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="83826-134">A continuación, se muestra el mismo ejemplo con un runbook de PowerShell como elemento secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-134">Following is the same example using a PowerShell runbook as the child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="83826-135">Inicio de un runbook secundario mediante un cmdlet</span><span class="sxs-lookup"><span data-stu-id="83826-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="83826-136">Puede utilizar el cmdlet [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) para iniciar un runbook, tal como se describe en [To start a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell) (Inicio de un runbook con Windows PowerShell).</span><span class="sxs-lookup"><span data-stu-id="83826-136">You can use the [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet to start a runbook as described in [To start a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="83826-137">Existen dos modos de usar este cmdlet.</span><span class="sxs-lookup"><span data-stu-id="83826-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="83826-138">En un modo, el cmdlet devuelve el identificador del trabajo en cuanto se crea el trabajo secundario para el Runbook secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-138">In one mode, the cmdlet returns the job id as soon as the child job is created for the child runbook.</span></span>  <span data-ttu-id="83826-139">En el otro, que se habilita mediante la especificación del parámetro **-wait** , el cmdlet esperará a que finalice el trabajo secundario y devolverá los resultados del runbook secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-139">In the other mode, which you enable by specifying the **-wait** parameter, the cmdlet will wait until the child job finishes and will return the output from the child runbook.</span></span>

<span data-ttu-id="83826-140">Si inició el trabajo de un runbook secundario con un cmdlet, este se ejecutará en un trabajo independiente al runbook primario.</span><span class="sxs-lookup"><span data-stu-id="83826-140">The job from a child runbook started with a cmdlet will run in a separate job from the parent runbook.</span></span> <span data-ttu-id="83826-141">Como resultado, habrá más trabajos que cuando se invoca el runbook insertado, por lo que realizar un seguimiento será más difícil.</span><span class="sxs-lookup"><span data-stu-id="83826-141">This results in more jobs than invoking the runbook inline and makes them more difficult to track.</span></span> <span data-ttu-id="83826-142">Asimismo, el primario puede iniciar varios Runbooks secundarios de forma asincrónica sin tener que esperar a que se complete cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="83826-142">The parent can start multiple child runbooks asynchronously without waiting for each to complete.</span></span> <span data-ttu-id="83826-143">Para realizar este mismo tipo de ejecución en paralelo, al llamar a los runbooks secundarios en línea, el runbook primario necesitará usar la [palabra clave parallel](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="83826-143">For that same kind of parallel execution calling the child runbooks inline, the parent runbook would need to use the [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="83826-144">Los parámetros de un runbook secundario iniciado con un cmdlet se proporcionan como una tabla hash, tal y como se describe en [Parámetros de runbook](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="83826-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="83826-145">Solo pueden usarse los tipos de datos simples.</span><span class="sxs-lookup"><span data-stu-id="83826-145">Only simple data types can be used.</span></span> <span data-ttu-id="83826-146">Si el runbook tiene un parámetro con un tipo de datos complejo, debe llamarse en línea.</span><span class="sxs-lookup"><span data-stu-id="83826-146">If the runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="83826-147">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="83826-147">Example</span></span>
<span data-ttu-id="83826-148">En el ejemplo siguiente se inicia un Runbook secundario con parámetros y se espera a que finalice mediante el parámetro Start-AzureRmAutomationRunbook -wait.</span><span class="sxs-lookup"><span data-stu-id="83826-148">The following example starts a child runbook with parameters and then waits for it to complete using the Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="83826-149">Una vez completado, los resultados se recopilan desde el Runbook secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-149">Once completed, its output is collected from the child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="83826-150">Comparación de métodos para llamar a un runbook secundario</span><span class="sxs-lookup"><span data-stu-id="83826-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="83826-151">En la siguiente tabla se resumen las diferencias entre los dos métodos para llamar a un runbook desde otro runbook.</span><span class="sxs-lookup"><span data-stu-id="83826-151">The following table summarizes the differences between the two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="83826-152">En línea</span><span class="sxs-lookup"><span data-stu-id="83826-152">Inline</span></span> | <span data-ttu-id="83826-153">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="83826-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="83826-154">Trabajo</span><span class="sxs-lookup"><span data-stu-id="83826-154">Job</span></span> |<span data-ttu-id="83826-155">Los runbooks secundarios se ejecutan en el mismo trabajo que el primario.</span><span class="sxs-lookup"><span data-stu-id="83826-155">Child runbooks run in the same job as the parent.</span></span> |<span data-ttu-id="83826-156">Se crea un trabajo independiente para el runbook secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-156">A separate job is created for the child runbook.</span></span> |
| <span data-ttu-id="83826-157">Ejecución</span><span class="sxs-lookup"><span data-stu-id="83826-157">Execution</span></span> |<span data-ttu-id="83826-158">El runbook primario espera a que el runbook secundario se complete antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="83826-158">Parent runbook waits for the child runbook to complete before continuing.</span></span> |<span data-ttu-id="83826-159">El runbook primario continúa inmediatamente después de que se inicie el runbook secundario *o* el runbook primario espera a que finalice el trabajo secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for the child job to finish.</span></span> |
| <span data-ttu-id="83826-160">Salida</span><span class="sxs-lookup"><span data-stu-id="83826-160">Output</span></span> |<span data-ttu-id="83826-161">El runbook primario puede obtener los resultados directamente del runbook secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="83826-162">El runbook primario debe obtener los resultados directamente del trabajo de runbook secundario *o* el runbook primario puede obtener los resultados directamente del runbook secundario.</span><span class="sxs-lookup"><span data-stu-id="83826-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="83826-163">Parámetros</span><span class="sxs-lookup"><span data-stu-id="83826-163">Parameters</span></span> |<span data-ttu-id="83826-164">Los valores de los parámetros del runbook secundario se especifican por separado y pueden usar cualquier tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="83826-164">Values for the child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="83826-165">Los valores de los parámetros del runbook secundario deben combinarse en una sola tabla hash y solo pueden incluir tipos de datos simples, de matriz y de objeto que utilicen la serialización JSON.</span><span class="sxs-lookup"><span data-stu-id="83826-165">Values for the child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="83826-166">Cuenta de automatización</span><span class="sxs-lookup"><span data-stu-id="83826-166">Automation Account</span></span> |<span data-ttu-id="83826-167">El runbook primario solo puede usar el runbook secundario en la misma cuenta de automatización.</span><span class="sxs-lookup"><span data-stu-id="83826-167">Parent runbook can only use child runbook in the same automation account.</span></span> |<span data-ttu-id="83826-168">El runbook primario puede usar el runbook secundario desde cualquier cuenta de automatización de la misma suscripción de Azure, e incluso de otra suscripción si tiene una conexión a ella.</span><span class="sxs-lookup"><span data-stu-id="83826-168">Parent runbook can use child runbook from any automation account from the same Azure subscription and even a different subscription if you have a connection to it.</span></span> |
| <span data-ttu-id="83826-169">Publicación</span><span class="sxs-lookup"><span data-stu-id="83826-169">Publishing</span></span> |<span data-ttu-id="83826-170">El runbook secundario debe publicarse antes de publicar el runbook primario.</span><span class="sxs-lookup"><span data-stu-id="83826-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="83826-171">El runbook secundario debe publicarse en cualquier momento antes de iniciar el runbook primario.</span><span class="sxs-lookup"><span data-stu-id="83826-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="83826-172">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="83826-172">Next steps</span></span>
* [<span data-ttu-id="83826-173">Inicio de un runbook en Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="83826-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="83826-174">Salidas de runbook y mensajes en la Automatización de Azure</span><span class="sxs-lookup"><span data-stu-id="83826-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

