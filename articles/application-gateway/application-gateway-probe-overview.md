---
title: "Información general sobre la supervisión de estado para Azure Application Gateway| Microsoft Docs"
description: "Aprenda sobre las funciones de supervisión de la puerta de enlace de aplicaciones de Azure"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7eeba328-bb2d-4d3e-bdac-7552e7900b7f
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/14/2016
ms.author: gwallace
ms.openlocfilehash: 899115d213e626f17e58c2e5f01313f760f9e7f4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="application-gateway-health-monitoring-overview"></a><span data-ttu-id="b23df-103">Información general sobre la supervisión de estado de la puerta de enlace de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="b23df-103">Application Gateway health monitoring overview</span></span>

<span data-ttu-id="b23df-104">La puerta de enlace de aplicaciones de Azure supervisa de forma predeterminada el estado de todos los recursos de su grupo de back-end y elimina automáticamente del grupo los recursos que se considera que están en mal estado.</span><span class="sxs-lookup"><span data-stu-id="b23df-104">Azure Application Gateway by default monitors the health of all resources in its back-end pool and automatically removes any resource considered unhealthy from the pool.</span></span> <span data-ttu-id="b23df-105">Además, continúa supervisando las instancias en mal estado y las agrega de nuevo al grupo de back-end en buen estado, una vez que están disponibles y responden a los sondeos de estado.</span><span class="sxs-lookup"><span data-stu-id="b23df-105">Application Gateway continues to monitor the unhealthy instances and adds them back to the healthy back-end pool once they become available and respond to health probes.</span></span> <span data-ttu-id="b23df-106">Application Gateway envía los sondeos de mantenimiento con el mismo puerto que se define en la configuración de HTTP de back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-106">Application gateway sends the health probes with the same port that is defined in the back-end HTTP settings.</span></span> <span data-ttu-id="b23df-107">Esta configuración garantiza que el sondeo prueba el mismo puerto que utilizarían los clientes para conectarse al back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-107">This configuration ensures that the probe is testing the same port that customers would be using to connect to the backend.</span></span>

![ejemplo de sondeo de Application Gateway][1]

<span data-ttu-id="b23df-109">Aparte del uso de la supervisión del sondeo de estado, también puede personalizar el sondeo de estado para adaptarlo a las necesidades de su aplicación.</span><span class="sxs-lookup"><span data-stu-id="b23df-109">In addition to using default health probe monitoring, you can also customize the health probe to suit your application's requirements.</span></span> <span data-ttu-id="b23df-110">En este artículo trataremos ambos sondeos de estado: el personalizado y el predeterminado.</span><span class="sxs-lookup"><span data-stu-id="b23df-110">In this article, both default and custom health probes are covered.</span></span>

> [!NOTE]
> <span data-ttu-id="b23df-111">Si hay un grupo de seguridad de red en la subred de Application Gateway, se deberían abrir los intervalos de puertos 65503-65534 en la subred de Application Gateway destinada al tráfico de entrada.</span><span class="sxs-lookup"><span data-stu-id="b23df-111">If there is an NSG on Application Gateway subnet, port ranges 65503-65534 should be opened on the Application Gateway subnet for Inbound traffic.</span></span> <span data-ttu-id="b23df-112">Estos puertos son necesarios para que funcione correctamente la API de estado de back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-112">These ports are required for the backend health API to work.</span></span>

## <a name="default-health-probe"></a><span data-ttu-id="b23df-113">Sondeo de estado predeterminado</span><span class="sxs-lookup"><span data-stu-id="b23df-113">Default health probe</span></span>

<span data-ttu-id="b23df-114">Una puerta de enlace de aplicaciones configura automáticamente un sondeo de estado predeterminado cuando no hay ningún sondeo personalizado configurado.</span><span class="sxs-lookup"><span data-stu-id="b23df-114">An application gateway automatically configures a default health probe when you don't set up any custom probe configuration.</span></span> <span data-ttu-id="b23df-115">El comportamiento de supervisión consiste en realizar una solicitud HTTP a las direcciones IP configuradas para el grupo de back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-115">The monitoring behavior works by making an HTTP request to the IP addresses configured for the back-end pool.</span></span> <span data-ttu-id="b23df-116">En el caso de los sondeos predeterminados si las opciones de HTTP del back-end se configuran para HTTPS, el sondeo usa HTTPS también para comprobar el mantenimiento de los back-ends.</span><span class="sxs-lookup"><span data-stu-id="b23df-116">For default probes if the backend http settings are configured for HTTPS, the probe uses HTTPS as well to test health of the backends.</span></span>

<span data-ttu-id="b23df-117">Por ejemplo: configura la puerta de enlace de aplicaciones para usar los servidores back-end A, B y C para recibir el tráfico de red HTTP en el puerto 80.</span><span class="sxs-lookup"><span data-stu-id="b23df-117">For example: You configure your application gateway to use back-end servers A, B, and C to receive HTTP network traffic on port 80.</span></span> <span data-ttu-id="b23df-118">La supervisión de estado predeterminada comprueba los tres servidores cada 30 segundos para ver que la respuesta de HTTP es correcta.</span><span class="sxs-lookup"><span data-stu-id="b23df-118">The default health monitoring tests the three servers every 30 seconds for a healthy HTTP response.</span></span> <span data-ttu-id="b23df-119">Una respuesta HTTP correcta tiene un [código de estado](https://msdn.microsoft.com/library/aa287675.aspx) entre 200 y 399.</span><span class="sxs-lookup"><span data-stu-id="b23df-119">A healthy HTTP response has a [status code](https://msdn.microsoft.com/library/aa287675.aspx) between 200 and 399.</span></span>

<span data-ttu-id="b23df-120">Si la comprobación de sondeo predeterminado da error en el servidor A, la puerta de enlace de aplicaciones lo elimina de su grupo de back-end y el tráfico de red deja de fluir a este servidor.</span><span class="sxs-lookup"><span data-stu-id="b23df-120">If the default probe check fails for server A, the application gateway removes it from its back-end pool, and network traffic stops flowing to this server.</span></span> <span data-ttu-id="b23df-121">El sondeo predeterminado sigue comprobando el servidor A cada 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="b23df-121">The default probe still continues to check for server A every 30 seconds.</span></span> <span data-ttu-id="b23df-122">Cuando el servidor A responde correctamente a una solicitud de un sondeo de estado predeterminado, se considera que está en buen estado y se agrega de nuevo al grupo de back-end; el tráfico comienza a fluir de nuevo a él.</span><span class="sxs-lookup"><span data-stu-id="b23df-122">When server A responds successfully to one request from a default health probe, it is added back as healthy to the back-end pool, and traffic starts flowing to the server again.</span></span>

### <a name="default-health-probe-settings"></a><span data-ttu-id="b23df-123">Configuración de sondeo de estado predeterminado</span><span class="sxs-lookup"><span data-stu-id="b23df-123">Default health probe settings</span></span>

| <span data-ttu-id="b23df-124">Propiedad de sondeo</span><span class="sxs-lookup"><span data-stu-id="b23df-124">Probe property</span></span> | <span data-ttu-id="b23df-125">Valor</span><span class="sxs-lookup"><span data-stu-id="b23df-125">Value</span></span> | <span data-ttu-id="b23df-126">Description</span><span class="sxs-lookup"><span data-stu-id="b23df-126">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b23df-127">Dirección URL de sondeo</span><span class="sxs-lookup"><span data-stu-id="b23df-127">Probe URL</span></span> |<span data-ttu-id="b23df-128">http://127.0.0.1:\<puerto\>/</span><span class="sxs-lookup"><span data-stu-id="b23df-128">http://127.0.0.1:\<port\>/</span></span> |<span data-ttu-id="b23df-129">Ruta de acceso URL</span><span class="sxs-lookup"><span data-stu-id="b23df-129">URL path</span></span> |
| <span data-ttu-id="b23df-130">Intervalo</span><span class="sxs-lookup"><span data-stu-id="b23df-130">Interval</span></span> |<span data-ttu-id="b23df-131">30</span><span class="sxs-lookup"><span data-stu-id="b23df-131">30</span></span> |<span data-ttu-id="b23df-132">Intervalo de sondeo en segundos</span><span class="sxs-lookup"><span data-stu-id="b23df-132">Probe interval in seconds</span></span> |
| <span data-ttu-id="b23df-133">Tiempo de espera</span><span class="sxs-lookup"><span data-stu-id="b23df-133">Time-out</span></span> |<span data-ttu-id="b23df-134">30</span><span class="sxs-lookup"><span data-stu-id="b23df-134">30</span></span> |<span data-ttu-id="b23df-135">Tiempo de espera del sondeo en segundos</span><span class="sxs-lookup"><span data-stu-id="b23df-135">Probe time-out in seconds</span></span> |
| <span data-ttu-id="b23df-136">Umbral incorrecto</span><span class="sxs-lookup"><span data-stu-id="b23df-136">Unhealthy threshold</span></span> |<span data-ttu-id="b23df-137">3</span><span class="sxs-lookup"><span data-stu-id="b23df-137">3</span></span> |<span data-ttu-id="b23df-138">Número de reintentos de sondeo.</span><span class="sxs-lookup"><span data-stu-id="b23df-138">Probe retry count.</span></span> <span data-ttu-id="b23df-139">El servidor back-end se marca como inactivo después de que el número de errores de sondeo consecutivos alcanza el umbral incorrecto.</span><span class="sxs-lookup"><span data-stu-id="b23df-139">The back-end server is marked down after the consecutive probe failure count reaches the unhealthy threshold.</span></span> |

> [!NOTE]
> <span data-ttu-id="b23df-140">El puerto es el mismo que la configuración de HTTP del back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-140">The port is the same port as the back-end HTTP settings.</span></span>

<span data-ttu-id="b23df-141">El sondeo predeterminado solo examina http://127.0.0.1:\<puerto\> para determinar el estado de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="b23df-141">The default probe looks only at http://127.0.0.1:\<port\> to determine health status.</span></span> <span data-ttu-id="b23df-142">Si necesita configurar el sondeo de estado para ir a una dirección URL personalizada o modificar alguna otra configuración, debe usar sondeos personalizada tal como se describe en los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="b23df-142">If you need to configure the health probe to go to a custom URL or modify any other settings, you must use custom probes as described in the following steps:</span></span>

## <a name="custom-health-probe"></a><span data-ttu-id="b23df-143">Sondeo de estado personalizado</span><span class="sxs-lookup"><span data-stu-id="b23df-143">Custom health probe</span></span>

<span data-ttu-id="b23df-144">Los sondeos personalizados permiten un control más específico sobre la supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="b23df-144">Custom probes allow you to have a more granular control over the health monitoring.</span></span> <span data-ttu-id="b23df-145">Cuando se usan sondeos personalizados, puede configurar el intervalo de sondeo, la dirección URL y la ruta de acceso a la comprobación y cuántas respuestas erróneas se aceptan antes de marcar la instancia del grupo de back-end como en mal estado.</span><span class="sxs-lookup"><span data-stu-id="b23df-145">When using custom probes, you can configure the probe interval, the URL and path to test, and how many failed responses to accept before marking the back-end pool instance as unhealthy.</span></span>

### <a name="custom-health-probe-settings"></a><span data-ttu-id="b23df-146">Configuración de sondeo de estado personalizado</span><span class="sxs-lookup"><span data-stu-id="b23df-146">Custom health probe settings</span></span>

<span data-ttu-id="b23df-147">La siguiente tabla proporciona definiciones de las propiedades de un sondeo de mantenimiento personalizado.</span><span class="sxs-lookup"><span data-stu-id="b23df-147">The following table provides definitions for the properties of a custom health probe.</span></span>

| <span data-ttu-id="b23df-148">Propiedad de sondeo</span><span class="sxs-lookup"><span data-stu-id="b23df-148">Probe property</span></span> | <span data-ttu-id="b23df-149">Description</span><span class="sxs-lookup"><span data-stu-id="b23df-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="b23df-150">Nombre</span><span class="sxs-lookup"><span data-stu-id="b23df-150">Name</span></span> |<span data-ttu-id="b23df-151">Nombre del sondeo.</span><span class="sxs-lookup"><span data-stu-id="b23df-151">Name of the probe.</span></span> <span data-ttu-id="b23df-152">Este nombre se usa para hacer referencia al sondeo en la configuración de HTTP de back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-152">This name is used to refer to the probe in back-end HTTP settings.</span></span> |
| <span data-ttu-id="b23df-153">Protocol</span><span class="sxs-lookup"><span data-stu-id="b23df-153">Protocol</span></span> |<span data-ttu-id="b23df-154">Protocolo usado para enviar el sondeo.</span><span class="sxs-lookup"><span data-stu-id="b23df-154">Protocol used to send the probe.</span></span> <span data-ttu-id="b23df-155">El sondeo utiliza el protocolo definido en la configuración de HTTP del back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-155">The probe uses the protocol defined in the back-end HTTP settings</span></span> |
| <span data-ttu-id="b23df-156">Host</span><span class="sxs-lookup"><span data-stu-id="b23df-156">Host</span></span> |<span data-ttu-id="b23df-157">Nombre de host para enviar el sondeo.</span><span class="sxs-lookup"><span data-stu-id="b23df-157">Host name to send the probe.</span></span> <span data-ttu-id="b23df-158">Solo se puede aplicar cuando se ha configurado un entorno multisitio en Application Gateway; de lo contrario hay que usar '127.0.0.1'.</span><span class="sxs-lookup"><span data-stu-id="b23df-158">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="b23df-159">Este valor es distinto del nombre de host de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="b23df-159">This value is different from VM host name.</span></span> |
| <span data-ttu-id="b23df-160">Ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="b23df-160">Path</span></span> |<span data-ttu-id="b23df-161">Ruta de acceso relativa del sondeo.</span><span class="sxs-lookup"><span data-stu-id="b23df-161">Relative path of the probe.</span></span> <span data-ttu-id="b23df-162">La ruta de acceso válida se inicia desde '/'.</span><span class="sxs-lookup"><span data-stu-id="b23df-162">The valid path starts from '/'.</span></span> |
| <span data-ttu-id="b23df-163">Intervalo</span><span class="sxs-lookup"><span data-stu-id="b23df-163">Interval</span></span> |<span data-ttu-id="b23df-164">Intervalo de sondeo en segundos.</span><span class="sxs-lookup"><span data-stu-id="b23df-164">Probe interval in seconds.</span></span> <span data-ttu-id="b23df-165">Este valor es el intervalo de tiempo entre dos sondeos consecutivos.</span><span class="sxs-lookup"><span data-stu-id="b23df-165">This value is the time interval between two consecutive probes.</span></span> |
| <span data-ttu-id="b23df-166">Tiempo de espera</span><span class="sxs-lookup"><span data-stu-id="b23df-166">Time-out</span></span> |<span data-ttu-id="b23df-167">Tiempo de espera del sondeo en segundos.</span><span class="sxs-lookup"><span data-stu-id="b23df-167">Probe time-out in seconds.</span></span> <span data-ttu-id="b23df-168">Si no se recibe una respuesta válida dentro del período de tiempo de espera, el sondeo se marca como error.</span><span class="sxs-lookup"><span data-stu-id="b23df-168">If a valid response is not received within this time-out period, the probe is marked as failed.</span></span>  |
| <span data-ttu-id="b23df-169">Umbral incorrecto</span><span class="sxs-lookup"><span data-stu-id="b23df-169">Unhealthy threshold</span></span> |<span data-ttu-id="b23df-170">Número de reintentos de sondeo.</span><span class="sxs-lookup"><span data-stu-id="b23df-170">Probe retry count.</span></span> <span data-ttu-id="b23df-171">El servidor back-end se marca como inactivo después de que el número de errores de sondeo consecutivos alcanza el umbral incorrecto.</span><span class="sxs-lookup"><span data-stu-id="b23df-171">The back-end server is marked down after the consecutive probe failure count reaches the unhealthy threshold.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="b23df-172">Si la instancia de Puerta de enlace de aplicaciones está configurada para un único sitio, de forma predeterminada, el nombre de host debe especificarse como 127.0.0.1, salvo que se configure de otra manera en la sonda personalizada.</span><span class="sxs-lookup"><span data-stu-id="b23df-172">If Application Gateway is configured for a single site, by default the Host name should be specified as '127.0.0.1', unless otherwise configured in custom probe.</span></span>
> <span data-ttu-id="b23df-173">A modo de referencia se envía un sondeo personalizado a \<protocolo\>://\<host\>:\<puerto\>\<ruta de acceso\>.</span><span class="sxs-lookup"><span data-stu-id="b23df-173">For reference a custom probe is sent to \<protocol\>://\<host\>:\<port\>\<path\>.</span></span> <span data-ttu-id="b23df-174">El puerto usado será el definido en la configuración de HTTP del back-end.</span><span class="sxs-lookup"><span data-stu-id="b23df-174">The port used will be the same port as defined in the back-end HTTP settings.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b23df-175">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="b23df-175">Next steps</span></span>
<span data-ttu-id="b23df-176">Tras conocer todo lo referente a la supervisión del mantenimiento de Application Gateway, puede configurar un [sondeo de mantenimiento personalizado](application-gateway-create-probe-portal.md) en Azure Portal o un [sondeo de mantenimiento personalizado](application-gateway-create-probe-ps.md) mediante PowerShell y el modelo de implementación con Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="b23df-176">After learning about Application Gateway health monitoring, you can configure a [custom health probe](application-gateway-create-probe-portal.md) in the Azure portal or a [custom health probe](application-gateway-create-probe-ps.md) using PowerShell and the Azure Resource Manager deployment model.</span></span>

[1]: ./media/application-gateway-probe-overview/appgatewayprobe.png
