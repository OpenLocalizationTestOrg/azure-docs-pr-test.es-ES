---
title: "Creación un sondeo personalizado para Azure Application Gateway mediante Azure Portal | Microsoft Docs"
description: "Más información acerca de la creación de un sondeo personalizado para Puerta de enlace de aplicaciones mediante el portal"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 33fd5564-43a7-4c54-a9ec-b1235f661f97
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/26/2017
ms.author: gwallace
ms.openlocfilehash: 65e9bba4ce9ac41ae2a9a8c3fa7f661165fc1403
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="create-a-custom-probe-for-application-gateway-by-using-the-portal"></a><span data-ttu-id="b239c-103">Creación de un sondeo personalizado para Puerta de enlace de aplicaciones mediante el portal</span><span class="sxs-lookup"><span data-stu-id="b239c-103">Create a custom probe for Application Gateway by using the portal</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="b239c-104">Portal de Azure</span><span class="sxs-lookup"><span data-stu-id="b239c-104">Azure portal</span></span>](application-gateway-create-probe-portal.md)
> * [<span data-ttu-id="b239c-105">PowerShell de Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="b239c-105">Azure Resource Manager PowerShell</span></span>](application-gateway-create-probe-ps.md)
> * [<span data-ttu-id="b239c-106">Azure Classic PowerShell</span><span class="sxs-lookup"><span data-stu-id="b239c-106">Azure Classic PowerShell</span></span>](application-gateway-create-probe-classic-ps.md)

<span data-ttu-id="b239c-107">En este artículo, agregará un sondeo personalizado a una puerta de enlace de aplicaciones existente a través de Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="b239c-107">In this article, you add a custom probe to an existing application gateway through the Azure portal.</span></span> <span data-ttu-id="b239c-108">Los sondeos personalizados son útiles para aplicaciones que tienen una página de comprobación del estado o para aplicaciones que no proporcionan una respuesta correcta en la aplicación web predeterminada.</span><span class="sxs-lookup"><span data-stu-id="b239c-108">Custom probes are useful for applications that have a specific health check page or for applications that do not provide a successful response on the default web application.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="b239c-109">Antes de empezar</span><span class="sxs-lookup"><span data-stu-id="b239c-109">Before you begin</span></span>

<span data-ttu-id="b239c-110">Si no dispone aún de una puerta de enlace de aplicaciones, visite [Creación de una puerta de enlace de aplicaciones](application-gateway-create-gateway-portal.md) para crear una puerta de enlace de aplicaciones con la que trabajar.</span><span class="sxs-lookup"><span data-stu-id="b239c-110">If you do not already have an application gateway, visit [Create an Application Gateway](application-gateway-create-gateway-portal.md) to create an application gateway to work with.</span></span>

## <span data-ttu-id="b239c-111"><a name="createprobe"></a>Creación del sondeo</span><span class="sxs-lookup"><span data-stu-id="b239c-111"><a name="createprobe"></a>Create the probe</span></span>

<span data-ttu-id="b239c-112">Los sondeos se configuran en un proceso de dos pasos a través del portal.</span><span class="sxs-lookup"><span data-stu-id="b239c-112">Probes are configured in a two-step process through the portal.</span></span> <span data-ttu-id="b239c-113">El primer paso consiste en crear el sondeo.</span><span class="sxs-lookup"><span data-stu-id="b239c-113">The first step is to create the probe.</span></span> <span data-ttu-id="b239c-114">En el segundo paso, agregue el sondeo a la configuración HTTP de back-end de la puerta de enlace de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b239c-114">In the second step, you add the probe to the backend http settings of the application gateway.</span></span>

1. <span data-ttu-id="b239c-115">Inicie sesión en el [Portal de Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="b239c-115">Log in to the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="b239c-116">Si aún no tiene cuenta, puede registrarse para obtener [una evaluación gratuita durante un mes](https://azure.microsoft.com/free).</span><span class="sxs-lookup"><span data-stu-id="b239c-116">If you don't already have an account, you can sign up for a [free one-month trial](https://azure.microsoft.com/free)</span></span>

1. <span data-ttu-id="b239c-117">En el panel Favoritos de Azure Portal, haga clic en Todos los recursos.</span><span class="sxs-lookup"><span data-stu-id="b239c-117">In the Azure portal Favorites pane, click All resources.</span></span> <span data-ttu-id="b239c-118">Haga clic en la puerta de enlace de aplicaciones en la hoja Todos los recursos.</span><span class="sxs-lookup"><span data-stu-id="b239c-118">Click the application gateway in the All resources blade.</span></span> <span data-ttu-id="b239c-119">Si la suscripción que seleccionó ya tiene varios recursos en ella, puede escribir partners.contoso.net en el cuadro Filtrar por nombre…</span><span class="sxs-lookup"><span data-stu-id="b239c-119">If the subscription you selected already has several resources in it, you can enter partners.contoso.net in the Filter by name…</span></span> <span data-ttu-id="b239c-120">para acceder fácilmente a la puerta de enlace de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b239c-120">box to easily access the application gateway.</span></span>

1. <span data-ttu-id="b239c-121">Haga clic en **Sondeos** y, después, en el botón **Agregar** para agregar un sondeo.</span><span class="sxs-lookup"><span data-stu-id="b239c-121">Click **Probes** and click the **Add** button to add a probe.</span></span>

  ![Agregar hoja Sondeo con la información rellena][1]

1. <span data-ttu-id="b239c-123">En la hoja **Agregar sondeo de estado**, rellene la información necesaria para el sondeo y cuando finalice, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="b239c-123">On the **Add health probe** blade, fill out the required information for the probe, and when complete click **OK**.</span></span>

  |<span data-ttu-id="b239c-124">**Configuración**</span><span class="sxs-lookup"><span data-stu-id="b239c-124">**Setting**</span></span> | <span data-ttu-id="b239c-125">**Valor**</span><span class="sxs-lookup"><span data-stu-id="b239c-125">**Value**</span></span> | <span data-ttu-id="b239c-126">**Detalles**</span><span class="sxs-lookup"><span data-stu-id="b239c-126">**Details**</span></span>|
  |---|---|---|
  |<span data-ttu-id="b239c-127">**Name**</span><span class="sxs-lookup"><span data-stu-id="b239c-127">**Name**</span></span>|<span data-ttu-id="b239c-128">customProbe</span><span class="sxs-lookup"><span data-stu-id="b239c-128">customProbe</span></span>|<span data-ttu-id="b239c-129">Este valor es un nombre descriptivo para el sondeo al que se puede acceder en el portal.</span><span class="sxs-lookup"><span data-stu-id="b239c-129">This value is a friendly name to the probe that is accessible in the portal.</span></span>|
  |<span data-ttu-id="b239c-130">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="b239c-130">**Protocol**</span></span>|<span data-ttu-id="b239c-131">HTTP o HTTPS</span><span class="sxs-lookup"><span data-stu-id="b239c-131">HTTP or HTTPS</span></span> | <span data-ttu-id="b239c-132">El protocolo que usa el sondeo de estado.</span><span class="sxs-lookup"><span data-stu-id="b239c-132">The protocol that the health probe uses.</span></span>|
  |<span data-ttu-id="b239c-133">**Host**</span><span class="sxs-lookup"><span data-stu-id="b239c-133">**Host**</span></span>|<span data-ttu-id="b239c-134">es decir,</span><span class="sxs-lookup"><span data-stu-id="b239c-134">i.e</span></span> <span data-ttu-id="b239c-135">contoso.com</span><span class="sxs-lookup"><span data-stu-id="b239c-135">contoso.com</span></span>|<span data-ttu-id="b239c-136">Este valor es el nombre de host que se utiliza para el sondeo.</span><span class="sxs-lookup"><span data-stu-id="b239c-136">This value is the host name that is used for the probe.</span></span> <span data-ttu-id="b239c-137">Solo se puede aplicar cuando se ha configurado un entorno multisitio en Application Gateway; de lo contrario hay que usar '127.0.0.1'.</span><span class="sxs-lookup"><span data-stu-id="b239c-137">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="b239c-138">Este valor es distinto del nombre de host de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="b239c-138">This value is different from the VM host name.</span></span>|
  |<span data-ttu-id="b239c-139">**Ruta de acceso**</span><span class="sxs-lookup"><span data-stu-id="b239c-139">**Path**</span></span>|<span data-ttu-id="b239c-140">/ u otra ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="b239c-140">/ or another path</span></span>|<span data-ttu-id="b239c-141">El resto de la dirección URL completa del sondeo personalizado.</span><span class="sxs-lookup"><span data-stu-id="b239c-141">The remainder of the full url for the custom probe.</span></span> <span data-ttu-id="b239c-142">Las rutas de acceso válidas comienzan por '/'.</span><span class="sxs-lookup"><span data-stu-id="b239c-142">A valid path starts with '/'.</span></span> <span data-ttu-id="b239c-143">Para la ruta de acceso predeterminada de http://contoso.com, use solo '/'.</span><span class="sxs-lookup"><span data-stu-id="b239c-143">For the default path of http://contoso.com just use '/'</span></span> |
  |<span data-ttu-id="b239c-144">**Intervalo (segundos)**</span><span class="sxs-lookup"><span data-stu-id="b239c-144">**Interval (secs)**</span></span>|<span data-ttu-id="b239c-145">30</span><span class="sxs-lookup"><span data-stu-id="b239c-145">30</span></span>|<span data-ttu-id="b239c-146">La frecuencia con que se ejecuta el sondeo para comprobar el estado.</span><span class="sxs-lookup"><span data-stu-id="b239c-146">How often the probe is run to check for health.</span></span> <span data-ttu-id="b239c-147">No se recomienda establecer un valor inferior a 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="b239c-147">It is not recommended to set the lower than 30 seconds.</span></span>|
  |<span data-ttu-id="b239c-148">**Tiempo de espera (segundos)**</span><span class="sxs-lookup"><span data-stu-id="b239c-148">**Timeout (secs)**</span></span>|<span data-ttu-id="b239c-149">30</span><span class="sxs-lookup"><span data-stu-id="b239c-149">30</span></span>|<span data-ttu-id="b239c-150">El período que espera el sondeo antes de agotarse el tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="b239c-150">The amount of time the probe waits before timing out.</span></span> <span data-ttu-id="b239c-151">El intervalo de tiempo de espera debe ser lo suficientemente alto como para que se pueda realizar una llamada http para asegurarse de que la página de mantenimiento de back-end está disponible.</span><span class="sxs-lookup"><span data-stu-id="b239c-151">The timeout interval needs to be high enough that an http call can be made to ensure the backend health page is available.</span></span>|
  |<span data-ttu-id="b239c-152">**Umbral incorrecto**</span><span class="sxs-lookup"><span data-stu-id="b239c-152">**Unhealthy threshold**</span></span>|<span data-ttu-id="b239c-153">3</span><span class="sxs-lookup"><span data-stu-id="b239c-153">3</span></span>|<span data-ttu-id="b239c-154">Número de intentos con error para que se considere incorrecto.</span><span class="sxs-lookup"><span data-stu-id="b239c-154">Number of failed attempts to be considered unhealthy.</span></span> <span data-ttu-id="b239c-155">Un umbral de 0 significa que si el resultado de una comprobación de mantenimiento no es satisfactorio, se determinará de inmediato que el back-end es incorrecto.</span><span class="sxs-lookup"><span data-stu-id="b239c-155">A threshold of 0 means that if a health check fails the back-end is determined unhealthy immediately.</span></span>|

  > [!IMPORTANT]
  > <span data-ttu-id="b239c-156">El nombre de host no es el mismo que el del servidor.</span><span class="sxs-lookup"><span data-stu-id="b239c-156">The host name is not the same as server name.</span></span> <span data-ttu-id="b239c-157">Este valor es el nombre del host virtual que se ejecuta en el servidor de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b239c-157">This value is the name of the virtual host running on the application server.</span></span> <span data-ttu-id="b239c-158">El sondeo se envía a http://(nombre de host):(puerto de httpsetting)/urlPath</span><span class="sxs-lookup"><span data-stu-id="b239c-158">The probe is sent to http://(host name):(port from httpsetting)/urlPath</span></span>

## <a name="add-probe-to-the-gateway"></a><span data-ttu-id="b239c-159">Adición de un sondeo a la puerta de enlace</span><span class="sxs-lookup"><span data-stu-id="b239c-159">Add probe to the gateway</span></span>

<span data-ttu-id="b239c-160">Una vez creado el sondeo, es el momento de agregarlo a la puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="b239c-160">Now that the probe has been created, it is time to add it to the gateway.</span></span> <span data-ttu-id="b239c-161">La configuración del sondeo se establece en la configuración de http del back-end de la puerta de enlace de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b239c-161">Probe settings are set on the backend http settings of the application gateway.</span></span>

1. <span data-ttu-id="b239c-162">Haga clic en la **configuración de HTTP** de la instancia de Application Gateway para abrir la hoja Configuración y haga clic en la configuración de HTTP del back-end actual que aparece en la ventana.</span><span class="sxs-lookup"><span data-stu-id="b239c-162">Click **HTTP settings** on the application gateway, to bring up the configuration blade click the current backend http settings listed in the window.</span></span>

  ![ventana de configuración de https][2]

1. <span data-ttu-id="b239c-164">En la hoja de configuración de **appGatewayBackEndHttpSettings**, active la casilla **Usar sondeo personalizado** y elija el sondeo creado en la sección [Creación del sondeo](#createprobe) en el menú desplegable **Sondeo personalizado**.</span><span class="sxs-lookup"><span data-stu-id="b239c-164">On the **appGatewayBackEndHttpSettings** settings blade, check the **Use custom probe** checkbox and choose the probe created in the [Create the probe](#createprobe) section on the **Custom probe** drop-down..</span></span>
<span data-ttu-id="b239c-165">Cuando haya terminado, haga clic en **Guardar** y se aplicará la configuración.</span><span class="sxs-lookup"><span data-stu-id="b239c-165">When complete, click **Save** and the settings are applied.</span></span>

<span data-ttu-id="b239c-166">El sondeo predeterminado comprueba el acceso predeterminado a la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="b239c-166">The default probe checks the default access to the web application.</span></span> <span data-ttu-id="b239c-167">Una vez que se ha creado el sondeo personalizado, la puerta de enlace de aplicaciones usa la ruta de acceso personalizada definida para supervisar el estado de los servidores backend.</span><span class="sxs-lookup"><span data-stu-id="b239c-167">Now that a custom probe has been created, the application gateway uses the custom path defined to monitor health for the backend servers.</span></span> <span data-ttu-id="b239c-168">En función de los criterios definidos, la puerta de enlace de aplicaciones comprueba la ruta de acceso especificada en el sondeo.</span><span class="sxs-lookup"><span data-stu-id="b239c-168">Based on the criteria that was defined, the application gateway checks the path specified in the probe.</span></span> <span data-ttu-id="b239c-169">Si la llamada a host:Port/path no devuelve una respuesta de estado HTTP 200-399, el servidor se saca de la rotación cuando se alcanza el umbral de estado incorrecto.</span><span class="sxs-lookup"><span data-stu-id="b239c-169">If the call to host:Port/path does not return an HTTP 200-399 status response, the server is taken out of rotation after the unhealthy threshold is reached.</span></span> <span data-ttu-id="b239c-170">El sondeo continúa en la instancia incorrecta para determinar cuándo vuelve a ser correcta.</span><span class="sxs-lookup"><span data-stu-id="b239c-170">Probing continues on the unhealthy instance to determine when it becomes healthy again.</span></span> <span data-ttu-id="b239c-171">Una vez que la instancia se vuelve a agregar al grupo de servidores correcto, el tráfico comienza a fluir hacia ella de nuevo y el sondeo de la instancia continúa en el intervalo especificado por el usuario de forma normal.</span><span class="sxs-lookup"><span data-stu-id="b239c-171">Once the instance is added back to healthy server pool, traffic begins flowing to it again and probing to the instance continues at user specified interval as normal.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b239c-172">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="b239c-172">Next steps</span></span>

<span data-ttu-id="b239c-173">Para aprender a configurar la descarga de SSL con Azure Application Gateway, consulte [Configuración de la descarga SSL](application-gateway-ssl-portal.md)</span><span class="sxs-lookup"><span data-stu-id="b239c-173">To learn how to configure SSL Offloading with Azure Application Gateway, see [Configure SSL Offload](application-gateway-ssl-portal.md)</span></span>

[1]: ./media/application-gateway-create-probe-portal/figure1.png
[2]: ./media/application-gateway-create-probe-portal/figure2.png

