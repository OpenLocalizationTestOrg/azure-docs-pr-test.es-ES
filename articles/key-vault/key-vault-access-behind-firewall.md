---
title: "Acceso a Key Vault detrás de un firewall | Microsoft Docs"
description: "Aprenda a acceder a Azure Key Vault desde una aplicación detrás de un firewall"
services: key-vault
documentationcenter: 
author: amitbapat
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: 50d21774-2ee1-4212-8995-570c9de603c5
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 01/07/2017
ms.author: ambapat
ms.openlocfilehash: d00c6e0acf437d2bfc3c27e948f4646a6685b08f
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="access-azure-key-vault-behind-a-firewall"></a><span data-ttu-id="da98e-103">Acceso a Azure Key Vault desde detrás de un firewall</span><span class="sxs-lookup"><span data-stu-id="da98e-103">Access Azure Key Vault behind a firewall</span></span>
### <a name="q-my-key-vault-client-application-needs-to-be-behind-a-firewall-what-ports-hosts-or-ip-addresses-should-i-open-to-enable-access-to-a-key-vault"></a><span data-ttu-id="da98e-104">P: mi aplicación cliente de Key Vault debe estar detrás de un firewall.</span><span class="sxs-lookup"><span data-stu-id="da98e-104">Q: My key vault client application needs to be behind a firewall.</span></span> <span data-ttu-id="da98e-105">¿Qué puertos, hosts o direcciones IP debo abrir para habilitar el acceso a un almacén de claves?</span><span class="sxs-lookup"><span data-stu-id="da98e-105">What ports, hosts, or IP addresses should I open to enable access to a key vault?</span></span>
<span data-ttu-id="da98e-106">Para acceder a un almacén de claves, la aplicación cliente de Key Vault tiene que acceder a varios puntos de conexión para diversas funcionalidades:</span><span class="sxs-lookup"><span data-stu-id="da98e-106">To access a key vault, your key vault client application has to access multiple endpoints for various functionalities:</span></span>

* <span data-ttu-id="da98e-107">Autenticación a través de Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="da98e-107">Authentication via Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="da98e-108">Administración de Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="da98e-108">Management of Azure Key Vault.</span></span> <span data-ttu-id="da98e-109">Aquí se incluye la creación, lectura, actualización, eliminación y establecimiento de directivas de acceso a través de Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="da98e-109">This includes creating, reading, updating, deleting, and setting access policies through Azure Resource Manager.</span></span>
* <span data-ttu-id="da98e-110">Acceso y administración de los objetos (claves y secretos) almacenados en el propio Key Vault a través del punto de conexión específico del Key Vault (por ejemplo, [https://yourvaultname.vault.azure.net](https://yourvaultname.vault.azure.net)).</span><span class="sxs-lookup"><span data-stu-id="da98e-110">Accessing and managing objects (keys and secrets) stored in Key Vault itself, going through the Key Vault-specific endpoint (for example, [https://yourvaultname.vault.azure.net](https://yourvaultname.vault.azure.net)).</span></span>  

<span data-ttu-id="da98e-111">En función de su configuración y entorno, hay algunas variaciones.</span><span class="sxs-lookup"><span data-stu-id="da98e-111">Depending on your configuration and environment, there are some variations.</span></span>   

## <a name="ports"></a><span data-ttu-id="da98e-112">Puertos</span><span class="sxs-lookup"><span data-stu-id="da98e-112">Ports</span></span>
<span data-ttu-id="da98e-113">Todo el tráfico a un almacén de claves de las tres funciones (autenticación, la administración y acceso al plano de datos) se realiza a través de HTTPS: puerto 443.</span><span class="sxs-lookup"><span data-stu-id="da98e-113">All traffic to a key vault for all three functions (authentication, management, and data plane access) goes over HTTPS: port 443.</span></span> <span data-ttu-id="da98e-114">Sin embargo, ocasionalmente habrá tráfico HTTP (puerto 80) para CRL.</span><span class="sxs-lookup"><span data-stu-id="da98e-114">However, there will occasionally be HTTP (port 80) traffic for CRL.</span></span> <span data-ttu-id="da98e-115">Los clientes que admiten OCSP no deberían poder acceder a CRL, pero a veces pueden hacerlo a [http://cdp1.public-trust.com/CRL/Omniroot2025.crl](http://cdp1.public-trust.com/CRL/Omniroot2025.crl).</span><span class="sxs-lookup"><span data-stu-id="da98e-115">Clients that support OCSP shouldn't reach CRL, but may occasionally reach [http://cdp1.public-trust.com/CRL/Omniroot2025.crl](http://cdp1.public-trust.com/CRL/Omniroot2025.crl).</span></span>  

## <a name="authentication"></a><span data-ttu-id="da98e-116">Autenticación</span><span class="sxs-lookup"><span data-stu-id="da98e-116">Authentication</span></span>
<span data-ttu-id="da98e-117">Será preciso que las aplicaciones cliente de Key Vault accedan a los puntos de conexión de Azure Active Directory para la autenticación.</span><span class="sxs-lookup"><span data-stu-id="da98e-117">Key vault client applications will need to access Azure Active Directory endpoints for authentication.</span></span> <span data-ttu-id="da98e-118">El punto de conexión que se utilice dependerá de la configuración del inquilino de Azure AD, del tipo de entidad de seguridad (entidad de seguridad de usuario o entidad de servicio) y del tipo de cuenta (por ejemplo, cuenta Microsoft o una cuenta profesional o educativa.</span><span class="sxs-lookup"><span data-stu-id="da98e-118">The endpoint used depends on the Azure AD tenant configuration, the type of principal (user principal or service principal), and the type of account--for example, a Microsoft account or a work or school account.</span></span>  

| <span data-ttu-id="da98e-119">Tipo de entidad de seguridad</span><span class="sxs-lookup"><span data-stu-id="da98e-119">Principal type</span></span> | <span data-ttu-id="da98e-120">Punto de conexión:puerto</span><span class="sxs-lookup"><span data-stu-id="da98e-120">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="da98e-121">Usuario que utiliza cuenta Microsoft</span><span class="sxs-lookup"><span data-stu-id="da98e-121">User using Microsoft account</span></span><br> <span data-ttu-id="da98e-122">(por ejemplo, user@hotmail.com)</span><span class="sxs-lookup"><span data-stu-id="da98e-122">(for example, user@hotmail.com)</span></span> |<span data-ttu-id="da98e-123">**Global:**</span><span class="sxs-lookup"><span data-stu-id="da98e-123">**Global:**</span></span><br> <span data-ttu-id="da98e-124">login.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="da98e-124">login.microsoftonline.com:443</span></span><br><br> <span data-ttu-id="da98e-125">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="da98e-125">**Azure China:**</span></span><br> <span data-ttu-id="da98e-126">login.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="da98e-126">login.chinacloudapi.cn:443</span></span><br><br><span data-ttu-id="da98e-127">**Azure Gobierno de EE. UU.:**</span><span class="sxs-lookup"><span data-stu-id="da98e-127">**Azure US Government:**</span></span><br> <span data-ttu-id="da98e-128">login-us.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="da98e-128">login-us.microsoftonline.com:443</span></span><br><br><span data-ttu-id="da98e-129">**Azure Alemania:**</span><span class="sxs-lookup"><span data-stu-id="da98e-129">**Azure Germany:**</span></span><br> <span data-ttu-id="da98e-130">login.microsoftonline.de:443</span><span class="sxs-lookup"><span data-stu-id="da98e-130">login.microsoftonline.de:443</span></span><br><br> <span data-ttu-id="da98e-131">y</span><span class="sxs-lookup"><span data-stu-id="da98e-131">and</span></span> <br><span data-ttu-id="da98e-132">login.live.com:443</span><span class="sxs-lookup"><span data-stu-id="da98e-132">login.live.com:443</span></span> |
| <span data-ttu-id="da98e-133">Usuario o entidad de servicio con una cuenta profesional o educativa con Azure AD (por ejemplo, user@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="da98e-133">User or service principal using a work or school account with Azure AD (for example, user@contoso.com)</span></span> |<span data-ttu-id="da98e-134">**Global:**</span><span class="sxs-lookup"><span data-stu-id="da98e-134">**Global:**</span></span><br> <span data-ttu-id="da98e-135">login.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="da98e-135">login.microsoftonline.com:443</span></span><br><br> <span data-ttu-id="da98e-136">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="da98e-136">**Azure China:**</span></span><br> <span data-ttu-id="da98e-137">login.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="da98e-137">login.chinacloudapi.cn:443</span></span><br><br><span data-ttu-id="da98e-138">**Azure Gobierno de EE. UU.:**</span><span class="sxs-lookup"><span data-stu-id="da98e-138">**Azure US Government:**</span></span><br> <span data-ttu-id="da98e-139">login-us.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="da98e-139">login-us.microsoftonline.com:443</span></span><br><br><span data-ttu-id="da98e-140">**Azure Alemania:**</span><span class="sxs-lookup"><span data-stu-id="da98e-140">**Azure Germany:**</span></span><br> <span data-ttu-id="da98e-141">login.microsoftonline.de:443</span><span class="sxs-lookup"><span data-stu-id="da98e-141">login.microsoftonline.de:443</span></span> |
| <span data-ttu-id="da98e-142">Usuario o entidad de servicio con un trabajo o cuenta del centro educativo, además de los servicios de federación de Active Directory (AD FS) u otro punto de conexión federado (por ejemplo, user@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="da98e-142">User or service principal using a work or school account, plus Active Directory Federation Services (AD FS) or other federated endpoint (for example, user@contoso.com)</span></span> |<span data-ttu-id="da98e-143">Todos los puntos de conexión de una cuenta profesional o educativa, más AD FS u otros puntos de conexión federados</span><span class="sxs-lookup"><span data-stu-id="da98e-143">All endpoints for a work or school account, plus AD FS or other federated endpoints</span></span> |

<span data-ttu-id="da98e-144">Hay otros escenarios complejos posibles.</span><span class="sxs-lookup"><span data-stu-id="da98e-144">There are other possible complex scenarios.</span></span> <span data-ttu-id="da98e-145">Para más información, consulte [Escenarios de autenticación para Azure AD](/documentation/articles/active-directory-authentication-scenarios/), [Integración de aplicaciones con Azure Active Directory](/documentation/articles/active-directory-integrating-applications/) y [Guía del desarrollador de Azure Active Directory](https://msdn.microsoft.com/library/azure/dn151124.aspx).</span><span class="sxs-lookup"><span data-stu-id="da98e-145">Refer to [Azure Active Directory Authentication Flow](/documentation/articles/active-directory-authentication-scenarios/), [Integrating Applications with Azure Active Directory](/documentation/articles/active-directory-integrating-applications/), and [Active Directory Authentication Protocols](https://msdn.microsoft.com/library/azure/dn151124.aspx) for additional information.</span></span>  

## <a name="key-vault-management"></a><span data-ttu-id="da98e-146">Administración de Key Vault</span><span class="sxs-lookup"><span data-stu-id="da98e-146">Key Vault management</span></span>
<span data-ttu-id="da98e-147">Para la administración de Key Vault (CRUD y establecimiento de una directiva de acceso), es preciso que la aplicación cliente de Key Vault acceda a un punto de conexión de Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="da98e-147">For Key Vault management (CRUD and setting access policy), the key vault client application needs to access an Azure Resource Manager endpoint.</span></span>  

| <span data-ttu-id="da98e-148">Tipo de operación</span><span class="sxs-lookup"><span data-stu-id="da98e-148">Type of operation</span></span> | <span data-ttu-id="da98e-149">Punto de conexión:puerto</span><span class="sxs-lookup"><span data-stu-id="da98e-149">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="da98e-150">Operaciones del plano de control de Key Vault</span><span class="sxs-lookup"><span data-stu-id="da98e-150">Key Vault control plane operations</span></span><br> <span data-ttu-id="da98e-151">a través de Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="da98e-151">via Azure Resource Manager</span></span> |<span data-ttu-id="da98e-152">**Global:**</span><span class="sxs-lookup"><span data-stu-id="da98e-152">**Global:**</span></span><br> <span data-ttu-id="da98e-153">management.azure.com:443</span><span class="sxs-lookup"><span data-stu-id="da98e-153">management.azure.com:443</span></span><br><br> <span data-ttu-id="da98e-154">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="da98e-154">**Azure China:**</span></span><br> <span data-ttu-id="da98e-155">management.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="da98e-155">management.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="da98e-156">**Azure Gobierno de EE. UU.:**</span><span class="sxs-lookup"><span data-stu-id="da98e-156">**Azure US Government:**</span></span><br> <span data-ttu-id="da98e-157">management.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="da98e-157">management.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="da98e-158">**Azure Alemania:**</span><span class="sxs-lookup"><span data-stu-id="da98e-158">**Azure Germany:**</span></span><br> <span data-ttu-id="da98e-159">management.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="da98e-159">management.microsoftazure.de:443</span></span> |
| <span data-ttu-id="da98e-160">API Graph de Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="da98e-160">Azure Active Directory Graph API</span></span> |<span data-ttu-id="da98e-161">**Global:**</span><span class="sxs-lookup"><span data-stu-id="da98e-161">**Global:**</span></span><br> <span data-ttu-id="da98e-162">graph.windows.net:443</span><span class="sxs-lookup"><span data-stu-id="da98e-162">graph.windows.net:443</span></span><br><br> <span data-ttu-id="da98e-163">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="da98e-163">**Azure China:**</span></span><br> <span data-ttu-id="da98e-164">graph.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="da98e-164">graph.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="da98e-165">**Azure Gobierno de EE. UU.:**</span><span class="sxs-lookup"><span data-stu-id="da98e-165">**Azure US Government:**</span></span><br> <span data-ttu-id="da98e-166">graph.windows.net:443</span><span class="sxs-lookup"><span data-stu-id="da98e-166">graph.windows.net:443</span></span><br><br> <span data-ttu-id="da98e-167">**Azure Alemania:**</span><span class="sxs-lookup"><span data-stu-id="da98e-167">**Azure Germany:**</span></span><br> <span data-ttu-id="da98e-168">graph.cloudapi.de:443</span><span class="sxs-lookup"><span data-stu-id="da98e-168">graph.cloudapi.de:443</span></span> |

## <a name="key-vault-operations"></a><span data-ttu-id="da98e-169">Operaciones de Key Vault</span><span class="sxs-lookup"><span data-stu-id="da98e-169">Key Vault operations</span></span>
<span data-ttu-id="da98e-170">Para todas las operaciones criptográficas y de administración de objetos (claves y secretos) de Key Vault, es preciso que el cliente de Key Vault acceda al punto de conexión de Key Vault.</span><span class="sxs-lookup"><span data-stu-id="da98e-170">For all key vault object (keys and secrets) management and cryptographic operations, the key vault client needs to access the key vault endpoint.</span></span> <span data-ttu-id="da98e-171">En función de la ubicación del almacén de claves, el sufijo DNS del punto de conexión varía.</span><span class="sxs-lookup"><span data-stu-id="da98e-171">The endpoint DNS suffix varies depending on the location of your key vault.</span></span> <span data-ttu-id="da98e-172">El punto de conexión de Key Vault tiene el formato *vault-name*.*region-specific-dns-suffix*, como se describe en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="da98e-172">The key vault endpoint is of the format *vault-name*.*region-specific-dns-suffix*, as described in the following table.</span></span>  

| <span data-ttu-id="da98e-173">Tipo de operación</span><span class="sxs-lookup"><span data-stu-id="da98e-173">Type of operation</span></span> | <span data-ttu-id="da98e-174">Punto de conexión:puerto</span><span class="sxs-lookup"><span data-stu-id="da98e-174">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="da98e-175">Operaciones que incluyen operaciones criptográficas en claves; crear, leer, actualizar y eliminar claves y secretos; establecer u obtener etiquetas y otros atributos de objetos de Key Vault (claves o secretos)</span><span class="sxs-lookup"><span data-stu-id="da98e-175">Operations including cryptographic operations on keys; creating, reading, updating, and deleting keys and secrets; setting or getting tags and other attributes on key vault objects (keys or secrets)</span></span> |<span data-ttu-id="da98e-176">**Global:**</span><span class="sxs-lookup"><span data-stu-id="da98e-176">**Global:**</span></span><br> <span data-ttu-id="da98e-177">&lt;vault-name&gt;.vault.azure.net:443</span><span class="sxs-lookup"><span data-stu-id="da98e-177">&lt;vault-name&gt;.vault.azure.net:443</span></span><br><br> <span data-ttu-id="da98e-178">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="da98e-178">**Azure China:**</span></span><br> <span data-ttu-id="da98e-179">&lt;vault-name&gt;.vault.azure.cn:443</span><span class="sxs-lookup"><span data-stu-id="da98e-179">&lt;vault-name&gt;.vault.azure.cn:443</span></span><br><br> <span data-ttu-id="da98e-180">**Azure Gobierno de EE. UU.:**</span><span class="sxs-lookup"><span data-stu-id="da98e-180">**Azure US Government:**</span></span><br> <span data-ttu-id="da98e-181">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="da98e-181">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="da98e-182">**Azure Alemania:**</span><span class="sxs-lookup"><span data-stu-id="da98e-182">**Azure Germany:**</span></span><br> <span data-ttu-id="da98e-183">&lt;vault-name&gt;.vault.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="da98e-183">&lt;vault-name&gt;.vault.microsoftazure.de:443</span></span> |

## <a name="ip-address-ranges"></a><span data-ttu-id="da98e-184">Intervalos de direcciones IP</span><span class="sxs-lookup"><span data-stu-id="da98e-184">IP address ranges</span></span>
<span data-ttu-id="da98e-185">El servicio Key Vault utiliza otros recursos de Azure como la infraestructura de PaaS.</span><span class="sxs-lookup"><span data-stu-id="da98e-185">The Key Vault service uses other Azure resources like PaaS infrastructure.</span></span> <span data-ttu-id="da98e-186">Por consiguiente, no es posible proporcionar un intervalo específico de direcciones IP que los puntos de conexión del servicio Key Vault tendrán en un momento concreto.</span><span class="sxs-lookup"><span data-stu-id="da98e-186">So it's not possible to provide a specific range of IP addresses that Key Vault service endpoints will have at any particular time.</span></span> <span data-ttu-id="da98e-187">Si el firewall admite solo intervalos de direcciones IP, consulte el documento [Microsoft Azure Datacenter IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) (Intervalos de IP de los centro de datos de Microsoft Azure).</span><span class="sxs-lookup"><span data-stu-id="da98e-187">If your firewall supports only IP address ranges, refer to the [Microsoft Azure Datacenter IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) document.</span></span> <span data-ttu-id="da98e-188">Para la autenticación y la identidad (Azure Active Directory), la aplicación debe poder conectarse a los puntos de conexión descritos en [Autenticación y direcciones de identidad](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span><span class="sxs-lookup"><span data-stu-id="da98e-188">For authentication and identity (Azure Active Directory), your application must be able to connect to the endpoints described in [Authentication and identity addresses](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span></span>

## <a name="next-steps"></a><span data-ttu-id="da98e-189">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="da98e-189">Next steps</span></span>
<span data-ttu-id="da98e-190">Si le queda alguna duda acerca de Key Vault, visite los [foros de Azure Key Vault](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault).</span><span class="sxs-lookup"><span data-stu-id="da98e-190">If you have questions about Key Vault, visit the [Azure Key Vault Forums](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault).</span></span>

