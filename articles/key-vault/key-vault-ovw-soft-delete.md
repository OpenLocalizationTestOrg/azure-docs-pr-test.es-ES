---
ms.assetid: 
title: "Eliminación temporal de Azure Key Vault | Microsoft Docs"
ms.service: key-vault
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.date: 07/10/2017
ms.openlocfilehash: c873b153ef9c7d5f55672a5918c9dc4fb7256701
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="cc4a0-102">Información general sobre la eliminación temporal de Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="cc4a0-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="cc4a0-103">La característica de eliminación temporal de Key Vault permite recuperar almacenes y objetos de almacenes eliminados, lo que se conoce como eliminación temporal.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-103">Key Vault's soft delete feature allows recovery of the deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="cc4a0-104">En concreto, se tratan los siguientes escenarios:</span><span class="sxs-lookup"><span data-stu-id="cc4a0-104">Specifically, we address the following scenarios:</span></span>

- <span data-ttu-id="cc4a0-105">Compatibilidad con la eliminación recuperable de una instancia de Key Vault</span><span class="sxs-lookup"><span data-stu-id="cc4a0-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="cc4a0-106">Compatibilidad con la eliminación recuperable de objetos de Key Vault (por ejemplo,</span><span class="sxs-lookup"><span data-stu-id="cc4a0-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="cc4a0-107">claves, secretos y certificados)</span><span class="sxs-lookup"><span data-stu-id="cc4a0-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="cc4a0-108">Interfaces admitidas</span><span class="sxs-lookup"><span data-stu-id="cc4a0-108">Supporting interfaces</span></span>

<span data-ttu-id="cc4a0-109">La característica de eliminación temporal está disponible inicialmente a través de las interfaces de REST, .NET/C# y PowerShell.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-109">The soft-delete feature is initially available through the REST, .NET/C# and PowerShell interfaces.</span></span> <span data-ttu-id="cc4a0-110">Para más información al respecto, consulte la [referencia sobre Key Vault](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="cc4a0-110">Refer to the references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="cc4a0-111">Escenarios</span><span class="sxs-lookup"><span data-stu-id="cc4a0-111">Scenarios</span></span>

<span data-ttu-id="cc4a0-112">Los almacenes Azure Key Vault son recursos controlados que se administran por medio de Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="cc4a0-113">Azure Resource Manager especifica además un comportamiento bien definido para su eliminación, lo que conlleva que una operación DELETE ejecutada correctamente debería traducirse en que ese recurso deje de estar accesible.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="cc4a0-114">La característica de eliminación temporal aborda la recuperación del objeto eliminado, con independencia de que la eliminación haya sido voluntaria o involuntaria.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-114">The soft-delete feature addresses the recovery of the deleted object, whether the deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="cc4a0-115">En un escenario típico, un usuario puede haber eliminado por accidente una instancia o un objeto de Key Vault; si esa instancia o ese objeto de Key Vault fueran recuperables durante un período predeterminado, el usuario podría deshacer la eliminación y recuperar sus datos.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-115">In the typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were to be recoverable for a predetermined period, the user may undo the deletion and recover their data.</span></span>

2. <span data-ttu-id="cc4a0-116">En un escenario diferente, un usuario malintencionado podría intentar eliminar una instancia o un objeto de Key Vault, como una clave dentro de un almacén, para provocar una interrupción de la actividad empresarial.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-116">In a different scenario, a rogue user may attempt to delete a key vault or a key vault object, such as a key inside a vault, to cause a business disruption.</span></span> <span data-ttu-id="cc4a0-117">El hecho de que al eliminar la instancia o el objeto de Key Vault no se eliminen los datos subyacentes puede resultar útil como medida de seguridad ya que, por ejemplo, se pueden limitar los permisos sobre la eliminación de datos a un rol diferente que sea de confianza.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-117">Separating the deletion of the key vault or key vault object from the actual deletion of the underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion to a different, trusted role.</span></span> <span data-ttu-id="cc4a0-118">Este enfoque requiere un cuórum efectivo para una operación que, en caso contrario, podría provocar una pérdida de datos inmediata.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="cc4a0-119">Comportamiento de eliminación temporal</span><span class="sxs-lookup"><span data-stu-id="cc4a0-119">Soft-delete behavior</span></span>

<span data-ttu-id="cc4a0-120">Con esta característica, la operación DELETE sobre un objeto o instancia de Key Vault es una operación temporal que retiene los recursos durante un período determinado durante el cual parece que el objeto se ha eliminado realmente.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-120">With this feature, the DELETE operation on a key vault or key vault object is a soft-delete, effectively holding the resources for a given retention period, while giving the appearance that the object is deleted.</span></span> <span data-ttu-id="cc4a0-121">El servicio proporciona además un mecanismo para recuperar el objeto eliminado, básicamente deshaciendo la eliminación.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-121">The service further provides a mechanism for recovering the deleted object, essentially undoing the deletion.</span></span> 

<span data-ttu-id="cc4a0-122">La eliminación temporal es un comportamiento opcional de Key Vault y no **está habilitado de forma predeterminada** en esta versión.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> <span data-ttu-id="cc4a0-123">Para obtener más información acerca de cómo habilitar la eliminación de software para su instancia de Key Vault, consulte las instrucciones específicas relativas a la interfaz que esté utilizando en la [referencia de Key Vault](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="cc4a0-123">For details on enabling soft-delete for your key vault, see the specific guidance in the reference for the interface of your choice, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

### <a name="key-vault-recovery"></a><span data-ttu-id="cc4a0-124">Recuperación de Key Vault</span><span class="sxs-lookup"><span data-stu-id="cc4a0-124">Key vault recovery</span></span>

<span data-ttu-id="cc4a0-125">Tras eliminar una instancia de Key Vault, el servicio crea un recurso de proxy en la suscripción, agregando metadatos suficientes para la recuperación.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-125">Upon deleting a key vault, the service creates a proxy resource under the subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="cc4a0-126">El recurso de proxy es un objeto almacenado, disponible en la misma ubicación que la instancia de Key Vault eliminada.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-126">The proxy resource is a stored object, available in the same location as the deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="cc4a0-127">Recuperación de un objeto de Key Vault</span><span class="sxs-lookup"><span data-stu-id="cc4a0-127">Key vault object recovery</span></span>

<span data-ttu-id="cc4a0-128">Cuando se elimina un objeto de Key Vault, como una clave, el servicio pondrá el objeto en estado "eliminado", de manera que no será accesible para ninguna operación de recuperación.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-128">Upon deleting a key vault object, such as a key, the service will place the object in a deleted state, thus making it inaccessible to any retrieval operations.</span></span> <span data-ttu-id="cc4a0-129">Mientras esté en ese estado, el objeto de Key Vault solo se puede colocar en una lista, recuperar o eliminar por la fuerza/permanentemente.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-129">While in this state, the key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="cc4a0-130">Al mismo tiempo, Key Vault programará la eliminación de los datos subyacentes correspondientes al objeto o la instancia de Key Vault eliminados para su ejecución tras un intervalo de retención predeterminado.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-130">At the same time, Key Vault will schedule the deletion of the underlying data corresponding to the deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="cc4a0-131">El registro DNS correspondiente al almacén también se conserva durante la duración del intervalo de retención.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-131">The DNS record corresponding to the vault is also retained for the duration of the retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="cc4a0-132">Período de retención de la eliminación temporal</span><span class="sxs-lookup"><span data-stu-id="cc4a0-132">Soft-delete retention period</span></span>

<span data-ttu-id="cc4a0-133">Los recursos eliminados temporalmente se conservan durante un período de tiempo determinado: 90 días.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-133">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="cc4a0-134">Durante el intervalo de retención de eliminación temporal, se dan las circunstancias siguientes:</span><span class="sxs-lookup"><span data-stu-id="cc4a0-134">During the soft-delete retention interval, the following apply:</span></span>

- <span data-ttu-id="cc4a0-135">Puede confeccionar un listado con todos los objetos e instancias de Key Vault que se encuentran en estado de eliminación temporal en su suscripción, así como tener acceso a la información de eliminación y recuperación sobre ellos.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-135">You may list all of the key vaults and key vault objects in the soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="cc4a0-136">Solo los usuarios con permisos especiales pueden consultar los almacenes eliminados.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-136">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="cc4a0-137">Se recomienda que los usuarios creen un rol personalizado con estos permisos especiales para tratar los almacenes eliminados.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-137">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="cc4a0-138">No es posible crear una instancia de Key Vault con el mismo nombre en la misma ubicación; en consecuencia, no se puede crear un objeto de Key Vault en un almacén determinado si esa instancia de Key Vault contiene un objeto con el mismo nombre y está en estado eliminado.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-138">A key vault with the same name cannot be created in the same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with the same name and which is in a deleted state</span></span> 
- <span data-ttu-id="cc4a0-139">Solo un usuario con privilegios determinados puede restaurar una instancia o un objeto de Key Vault mediante la emisión de un comando de recuperación en el recurso de proxy correspondiente.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-139">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on the corresponding proxy resource.</span></span>
    - <span data-ttu-id="cc4a0-140">El usuario, miembro del rol personalizado, que tiene privilegios para crear una instancia de Key Vault en el grupo de recursos puede restaurar el almacén.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-140">The user, member of the custom role, who has the privilege to create a key vault under the resource group can restore the vault.</span></span>
- <span data-ttu-id="cc4a0-141">Solo un usuario con privilegios determinados puede eliminar por la fuerza una instancia o un objeto de Key Vault mediante la emisión de un comando de eliminación en el recurso de proxy correspondiente.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-141">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on the corresponding proxy resource.</span></span>

<span data-ttu-id="cc4a0-142">Una vez que finalice el intervalo de retención, el servicio lleva a cabo una purga de la instancia o el objeto de Key Vault eliminados temporalmente y de su contenido, a menos que se hayan recuperado.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-142">Unless a key vault or key vault object is recovered, at the end of the retention interval the service performs a purge of the soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="cc4a0-143">La eliminación de recursos no se puede volver a programar.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-143">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="cc4a0-144">Purga permitida</span><span class="sxs-lookup"><span data-stu-id="cc4a0-144">Permitted purge</span></span>

<span data-ttu-id="cc4a0-145">La purga permanente de una instancia de Key Vault es posible a través de una operación POST en el recurso de proxy y requiere privilegios especiales.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-145">Permanently deleting, purging, a key vault is possible via a POST operation on the proxy resource and requires special privileges.</span></span> <span data-ttu-id="cc4a0-146">Por lo general, el propietario de la suscripción es el único que puede purgar una instancia de Key Vault.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-146">Generally, only the subscription owner will be able to purge a key vault.</span></span> <span data-ttu-id="cc4a0-147">La operación POST activa la eliminación inmediata y no recuperable de esa instancia.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-147">The POST operation triggers the immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="cc4a0-148">Se da una excepción a esta circunstancia cuando la suscripción de Azure se ha marcado como *no eliminable*.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-148">An exception to this is the case when the Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="cc4a0-149">En este caso, solo el servicio puede realizar la eliminación real, y lo hace como un proceso programado.</span><span class="sxs-lookup"><span data-stu-id="cc4a0-149">In this case, only the service may then perform the actual deletion, and does so as a scheduled process.</span></span> 



