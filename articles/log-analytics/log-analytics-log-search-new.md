---
title: "Búsquedas de registros en Log Analytics de OMS | Microsoft Docs"
description: "Se requiere una búsqueda de registros para recuperar los datos de Log Analytics.  Este artículo describe cómo se usan las nuevas búsquedas de registros en Log Analytics y proporciona los conceptos que debe comprender antes de crear una."
services: log-analytics
documentationcenter: 
author: bwren
manager: carmonm
editor: 
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: bwren
ms.openlocfilehash: 0f27db7018e398f71a8d7bd0b86e643367b15875
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="understanding-log-searches-in-log-analytics"></a><span data-ttu-id="3a18f-104">Descripción de las búsquedas de registros en Log Analytics</span><span class="sxs-lookup"><span data-stu-id="3a18f-104">Understanding log searches in Log Analytics</span></span>

> [!NOTE]
> <span data-ttu-id="3a18f-105">Este artículo describe las búsquedas de registros de Azure Log Analytics mediante el nuevo lenguaje de consulta.</span><span class="sxs-lookup"><span data-stu-id="3a18f-105">This article describes log searches in Azure Log Analytics using the new query language.</span></span>  <span data-ttu-id="3a18f-106">Puede obtener más información sobre el nuevo lenguaje y conocer el procedimiento para actualizar el área de trabajo en [Upgrade your Azure Log Analytics workspace to new log search](log-analytics-log-search-upgrade.md) (Actualización del área de trabajo de Azure Log Analytics al nuevo registro de búsquedas)///.</span><span class="sxs-lookup"><span data-stu-id="3a18f-106">You can learn more about the new language and get the procedure to upgrade your workspace at [Upgrade your Azure Log Analytics workspace to new log search](log-analytics-log-search-upgrade.md).</span></span>  
>
> <span data-ttu-id="3a18f-107">Si todavía no se ha actualizado el área de trabajo al nuevo lenguaje de consulta, vaya a [Búsqueda de datos mediante búsquedas de registros en Log Analytics](log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="3a18f-107">If your workspace hasn't been upgraded to the new query language, you should refer to [Find data using log searches in Log Analytics](log-analytics-log-searches.md).</span></span>

<span data-ttu-id="3a18f-108">Se requiere una búsqueda de registros para recuperar los datos de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="3a18f-108">You require a log search to retrieve any data from Log Analytics.</span></span>  <span data-ttu-id="3a18f-109">Si está analizando los datos en el portal, configurando una regla de alertas para recibir una notificación sobre una condición determinada o recuperando datos mediante la API de Log Analytics, usará una búsqueda de registros para especificar los datos que desea.</span><span class="sxs-lookup"><span data-stu-id="3a18f-109">Whether you're analyzing data in the portal, configuring an alert rule to be notified of a particular condition, or retrieving data using the Log Analytics API, you will use a log search to specify the data you want.</span></span>  <span data-ttu-id="3a18f-110">Este artículo describe cómo se usan las búsquedas de registros en Log Analytics y proporciona los conceptos que debe comprender antes de crear una.</span><span class="sxs-lookup"><span data-stu-id="3a18f-110">This article describes how log searches are used in Log Analytics and provides concepts that should understand before creating one.</span></span> <span data-ttu-id="3a18f-111">Consulte la sección [Pasos siguientes](#next-steps) para más información sobre cómo crear y editar búsquedas de registros y para consultar referencias sobre el lenguaje de consulta.</span><span class="sxs-lookup"><span data-stu-id="3a18f-111">See the [Next steps](#next-steps) section for details on creating and editing log searches and for references on the query language.</span></span>

## <a name="where-log-searches-are-used"></a><span data-ttu-id="3a18f-112">Dónde se utilizan las búsquedas de registros</span><span class="sxs-lookup"><span data-stu-id="3a18f-112">Where log searches are used</span></span>

<span data-ttu-id="3a18f-113">Entre las distintas formas en que usará las búsquedas de registros en Log Analytics se incluyen las siguientes:</span><span class="sxs-lookup"><span data-stu-id="3a18f-113">The different ways that you will use log searches in Log Analytics include the following:</span></span>

- <span data-ttu-id="3a18f-114">**Portales.**</span><span class="sxs-lookup"><span data-stu-id="3a18f-114">**Portals.**</span></span> <span data-ttu-id="3a18f-115">Puede realizar un análisis de datos interactivo en el repositorio con el [portal de búsqueda de registros](log-analytics-log-search-log-search-portal.md) o el [portal avanzado de análisis](https://go.microsoft.com/fwlink/?linkid=856587).</span><span class="sxs-lookup"><span data-stu-id="3a18f-115">You can perform interactive analysis of data in the repository with the [Log Search portal](log-analytics-log-search-log-search-portal.md) or the [Advanced Analytics portal](https://go.microsoft.com/fwlink/?linkid=856587).</span></span>  <span data-ttu-id="3a18f-116">Esto le permite modificar la consulta y analizar los resultados en una gran variedad de formatos y visualizaciones.</span><span class="sxs-lookup"><span data-stu-id="3a18f-116">This allows you to edit your query and analyze the results in a variety of formats and visualizations.</span></span>  <span data-ttu-id="3a18f-117">La mayoría de las consultas que cree se iniciarán en uno de los portales y, posteriormente, se copiarán una vez que compruebe que funcionan según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="3a18f-117">Most queries that you create will start in one of the portals and then copied once you verify that it works as expected.</span></span>
- <span data-ttu-id="3a18f-118">**Reglas de alertas.**</span><span class="sxs-lookup"><span data-stu-id="3a18f-118">**Alert rules.**</span></span> <span data-ttu-id="3a18f-119">[Las reglas de alertas](log-analytics-alerts.md) identifican de manera proactiva los problemas de datos del área de trabajo.</span><span class="sxs-lookup"><span data-stu-id="3a18f-119">[Alert rules](log-analytics-alerts.md) proactively identify issues from data in your workspace.</span></span>  <span data-ttu-id="3a18f-120">Cada regla de alertas se basa en una búsqueda de registros que se ejecuta automáticamente a intervalos regulares.</span><span class="sxs-lookup"><span data-stu-id="3a18f-120">Each alert rule is based on a log search that is automatically run at regular intervals.</span></span>  <span data-ttu-id="3a18f-121">Los resultados se inspeccionan para determinar si se debe crear una alerta.</span><span class="sxs-lookup"><span data-stu-id="3a18f-121">The results are inspected to determine if an alert should be created.</span></span>
- <span data-ttu-id="3a18f-122">**Vistas.**</span><span class="sxs-lookup"><span data-stu-id="3a18f-122">**Views.**</span></span>  <span data-ttu-id="3a18f-123">Puede crear visualizaciones de datos que se incluyan en los paneles de usuario con el [diseñador de vistas](log-analytics-view-designer.md).</span><span class="sxs-lookup"><span data-stu-id="3a18f-123">You can create visualizations of data to be included in user dashboards with [View Designer](log-analytics-view-designer.md).</span></span>  <span data-ttu-id="3a18f-124">Las búsquedas de registros proporcionan los datos utilizados por [iconos](log-analytics-view-designer-tiles.md) y [elementos de visualización](log-analytics-view-designer-parts.md) en cada vista.</span><span class="sxs-lookup"><span data-stu-id="3a18f-124">Log searches provide the data used by [tiles](log-analytics-view-designer-tiles.md) and [visualization parts](log-analytics-view-designer-parts.md) in each view.</span></span>  <span data-ttu-id="3a18f-125">Puede explorar en profundidad los elementos de visualización en el portal de búsqueda de registros para realizar análisis adicionales de los datos.</span><span class="sxs-lookup"><span data-stu-id="3a18f-125">You can drill down from visualization parts into the Log Search portal to perform further analysis on the data.</span></span>
- <span data-ttu-id="3a18f-126">**Exportación.**</span><span class="sxs-lookup"><span data-stu-id="3a18f-126">**Export.**</span></span>  <span data-ttu-id="3a18f-127">Cuando exporte datos desde el área de trabajo de Log Analytics a Excel o [Power BI](log-analytics-powerbi.md), cree una búsqueda de registros para definir los datos que se van a exportar.</span><span class="sxs-lookup"><span data-stu-id="3a18f-127">When you export data from the Log Analytics workspace to Excel or [Power BI](log-analytics-powerbi.md), you create a log search to define the data to export.</span></span>
- <span data-ttu-id="3a18f-128">**PowerShell.**</span><span class="sxs-lookup"><span data-stu-id="3a18f-128">**PowerShell.**</span></span> <span data-ttu-id="3a18f-129">Puede ejecutar un script de PowerShell desde una línea de comandos o un runbook de Azure Automation que utilice el cmdlet [Get-AzureRmOperationalInsightsSearchResults](https://docs.microsoft.com/powershell/module/azurerm.operationalinsights/get-azurermoperationalinsightssearchresults?view=azurermps-4.0.0) para recuperar los datos de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="3a18f-129">You can run a PowerShell script from a command line or an Azure Automation runbook that uses [Get-AzureRmOperationalInsightsSearchResults](https://docs.microsoft.com/powershell/module/azurerm.operationalinsights/get-azurermoperationalinsightssearchresults?view=azurermps-4.0.0) to retrieve data from Log Analytics.</span></span>  <span data-ttu-id="3a18f-130">Este cmdlet requiere una consulta para determinar los datos que se van a recuperar.</span><span class="sxs-lookup"><span data-stu-id="3a18f-130">This cmdlet requires a query to determine the data to retrieve.</span></span>
- <span data-ttu-id="3a18f-131">**API de Log Analytics.**</span><span class="sxs-lookup"><span data-stu-id="3a18f-131">**Log Analytics API.**</span></span>  <span data-ttu-id="3a18f-132">La [API de búsqueda de registros de Log Analytics](log-analytics-log-search-api.md) permite que cualquier cliente de API de REST recupere datos del área de trabajo.</span><span class="sxs-lookup"><span data-stu-id="3a18f-132">The [Log Analytics log search API](log-analytics-log-search-api.md) allows any REST API client to retrieve data from the workspace.</span></span>  <span data-ttu-id="3a18f-133">La solicitud de API incluye una consulta que se ejecuta en Log Analytics para determinar los datos que se van a recuperar.</span><span class="sxs-lookup"><span data-stu-id="3a18f-133">The API request includes a query that is run against Log Analytics to determine the data to retrieve.</span></span>

![Búsqueda de registros](media/log-analytics-log-search-new/log-search-overview.png)

## <a name="how-log-analytics-data-is-organized"></a><span data-ttu-id="3a18f-135">Organización de los datos de Log Analytics</span><span class="sxs-lookup"><span data-stu-id="3a18f-135">How Log Analytics data is organized</span></span>
<span data-ttu-id="3a18f-136">Cuando compila una consulta, primero debe determinar las tablas que tienen los datos que está buscando.</span><span class="sxs-lookup"><span data-stu-id="3a18f-136">When you build a query, you start by determining which tables have the data that you're looking for.</span></span> <span data-ttu-id="3a18f-137">Cada [origen de datos](log-analytics-data-sources.md) y cada [solución](../operations-management-suite/operations-management-suite-solutions.md) almacena sus datos en tablas dedicadas en el área de trabajo de Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="3a18f-137">Each [data source](log-analytics-data-sources.md) and [solution](../operations-management-suite/operations-management-suite-solutions.md) stores its data in dedicated tables in the Log Analytics workspace.</span></span>  <span data-ttu-id="3a18f-138">La documentación de cada origen de datos y solución incluye el nombre del tipo de datos que crea y una descripción de cada una de sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="3a18f-138">Documentation for each data source and solution includes the name of the data type that it creates and a description of each of its properties.</span></span>     <span data-ttu-id="3a18f-139">Muchas consultas solo necesitan datos de una sola tabla, pero otros usuarios pueden utilizar una variedad de opciones para incluir datos de varias tablas.</span><span class="sxs-lookup"><span data-stu-id="3a18f-139">Many queries will only require data from a single tables, but others may use a variety of options to include data from multiple tables.</span></span>

![Tablas](media/log-analytics-log-search-new/queries-tables.png)


## <a name="writing-a-query"></a><span data-ttu-id="3a18f-141">Escribir una consulta</span><span class="sxs-lookup"><span data-stu-id="3a18f-141">Writing a query</span></span>
<span data-ttu-id="3a18f-142">El núcleo del registro de búsquedas de Log Analytics es [un lenguaje de consulta amplio](https://docs.loganalytics.io/) que le permite recuperar y analizar datos desde el repositorio de varias formas.</span><span class="sxs-lookup"><span data-stu-id="3a18f-142">At the core of log searches in Log Analytics is [an extensive query language](https://docs.loganalytics.io/) that lets you retrieve and analyze data from the repository in a variety of ways.</span></span>  <span data-ttu-id="3a18f-143">Este mismo idioma de consulta se utiliza para [Application Insights](../application-insights/app-insights-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="3a18f-143">This same query language is used for [Application Insights](../application-insights/app-insights-analytics.md).</span></span>  <span data-ttu-id="3a18f-144">Aprender a escribir una consulta es fundamental para crear búsquedas de registros en Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="3a18f-144">Learning how to write a query is critical to creating log searches in Log Analytics.</span></span>  <span data-ttu-id="3a18f-145">Normalmente se empieza con consultas básicas para avanzar posteriormente a funciones más avanzadas a medida que sus requisitos se hacen más complejos.</span><span class="sxs-lookup"><span data-stu-id="3a18f-145">You'll typically start with basic queries and then progress to use more advanced functions as your requirements become more complex.</span></span>

<span data-ttu-id="3a18f-146">La estructura básica de una consulta consiste en una tabla de origen seguida de una serie de operadores separados por un carácter de barra vertical `|`.</span><span class="sxs-lookup"><span data-stu-id="3a18f-146">The basic structure of a query is a source table followed by a series of operators separated by a pipe character `|`.</span></span>  <span data-ttu-id="3a18f-147">Puede encadenar varios operadores para refinar los datos y realizar funciones avanzadas.</span><span class="sxs-lookup"><span data-stu-id="3a18f-147">You can chain together multiple operators to refine the data and perform advanced functions.</span></span>

<span data-ttu-id="3a18f-148">Por ejemplo, suponga que desea buscar los diez equipos con más eventos de error del día anterior.</span><span class="sxs-lookup"><span data-stu-id="3a18f-148">For example, suppose you wanted to find the top ten computers with the most error events over the past day.</span></span>

    Event
    | where (EventLevelName == "Error")
    | where (TimeGenerated > ago(1days))
    | summarize ErrorCount = count() by Computer
    | top 10 by ErrorCount desc

<span data-ttu-id="3a18f-149">O bien, quizá desee buscar los equipos que no han tenido un latido en el último día.</span><span class="sxs-lookup"><span data-stu-id="3a18f-149">Or maybe you want to find computers that haven't had a heartbeat in the last day.</span></span>

    Heartbeat
    | where TimeGenerated > ago(7d)
    | summarize max(TimeGenerated) by Computer
    | where max_TimeGenerated < ago(1d)  

<span data-ttu-id="3a18f-150">¿Qué le parece un gráfico de líneas que muestre el uso del procesador por parte de cada equipo desde la semana pasada?</span><span class="sxs-lookup"><span data-stu-id="3a18f-150">How about a line chart with the processor utilization for each computer from last week?</span></span>

    Perf
    | where ObjectName == "Processor" and CounterName == "% Processor Time"
    | where TimeGenerated  between (startofweek(ago(7d)) .. endofweek(ago(7d)) )
    | summarize avg(CounterValue) by Computer, bin(TimeGenerated, 5min)
    | render timechart    

<span data-ttu-id="3a18f-151">En estos ejemplos rápidos se puede ver que, independientemente del tipo de datos con el que está trabajando, la estructura de la consulta es similar.</span><span class="sxs-lookup"><span data-stu-id="3a18f-151">You can see from these quick samples that regardless of the kind of data that you're working with, the structure of the query is similar.</span></span>  <span data-ttu-id="3a18f-152">Puede dividirla en distintos pasos en los que los datos resultantes de un comando se envían a través de la canalización al siguiente comando.</span><span class="sxs-lookup"><span data-stu-id="3a18f-152">You can break it down into distinct steps where the resulting data from one command is sent through the pipeline to the next command.</span></span>

<span data-ttu-id="3a18f-153">Para obtener documentación completa sobre el lenguaje de consultas de Azure Log Analytics incluyendo tutoriales y referencia del lenguaje, consulte la [documentación del lenguaje de consulta de Azure Log Analytics](https://docs.loganalytics.io/).</span><span class="sxs-lookup"><span data-stu-id="3a18f-153">For complete documentation on the Azure Log Analytics query language including tutorials and language reference, see the [Azure Log Analytics query language documentation](https://docs.loganalytics.io/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="3a18f-154">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="3a18f-154">Next steps</span></span>

- <span data-ttu-id="3a18f-155">Obtenga información acerca de los [portales que puede utilizar para crear y editar búsquedas de registros](log-analytics-log-search-portals.md).</span><span class="sxs-lookup"><span data-stu-id="3a18f-155">Learn about the [portals that you use to create and edit log searches](log-analytics-log-search-portals.md).</span></span>
- <span data-ttu-id="3a18f-156">Consulte un [tutorial sobre cómo escribir consultas](https://go.microsoft.com/fwlink/?linkid=856078) mediante el nuevo lenguaje de consulta.</span><span class="sxs-lookup"><span data-stu-id="3a18f-156">Check out a [tutorial on writing queries](https://go.microsoft.com/fwlink/?linkid=856078) using the new query language.</span></span>
