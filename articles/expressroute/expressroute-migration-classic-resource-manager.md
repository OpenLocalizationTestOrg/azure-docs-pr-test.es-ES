---
title: "Migración de las redes virtuales asociadas de ExpressRoute del modelo clásico a Azure Resource Manager: PowerShell | Microsoft Docs"
description: "En esta página se describe cómo migrar las redes virtuales asociadas a Resource Manager después de mover el circuito."
documentationcenter: na
services: expressroute
author: ganesr
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: expressroute
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/06/2017
ms.author: ganesr;cherylmc
ms.openlocfilehash: 964ea38569062a7127f60dd6309b328db263bf6f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="migrate-expressroute-associated-virtual-networks-from-classic-to-resource-manager"></a><span data-ttu-id="1d352-103">Migración de las redes virtuales asociadas de ExpressRoute del portal clásico a Resource Manager</span><span class="sxs-lookup"><span data-stu-id="1d352-103">Migrate ExpressRoute associated virtual networks from classic to Resource Manager</span></span>

<span data-ttu-id="1d352-104">En este artículo se explica cómo migrar las redes virtuales asociadas de Azure ExpressRoute desde el modelo de implementación clásica al modelo de implementación de Azure Resource Manager después de mover el circuito de ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="1d352-104">This article explains how to migrate Azure ExpressRoute associated virtual networks from the classic deployment model to the Azure Resource Manager deployment model after moving your ExpressRoute circuit.</span></span> 


## <a name="before-you-begin"></a><span data-ttu-id="1d352-105">Antes de empezar</span><span class="sxs-lookup"><span data-stu-id="1d352-105">Before you begin</span></span>
* <span data-ttu-id="1d352-106">Compruebe que dispone de la versión más reciente de los módulos de Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1d352-106">Verify that you have the latest version of the Azure PowerShell modules.</span></span> <span data-ttu-id="1d352-107">Para más información, vea [Instalación y configuración de Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="1d352-107">For more information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>
* <span data-ttu-id="1d352-108">Asegúrese de haber revisado los [requisitos previos](expressroute-prerequisites.md), los [requisitos de enrutamiento](expressroute-routing.md) y los [flujos de trabajo](expressroute-workflows.md) antes de comenzar la configuración.</span><span class="sxs-lookup"><span data-stu-id="1d352-108">Make sure that you have reviewed the [prerequisites](expressroute-prerequisites.md), [routing requirements](expressroute-routing.md), and [workflows](expressroute-workflows.md) before you begin configuration.</span></span>
* <span data-ttu-id="1d352-109">Revise la información que se proporciona en [Transición de un circuito ExpressRoute desde la implementación clásica a la implementación de Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="1d352-109">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span> <span data-ttu-id="1d352-110">Asegúrese de que comprende perfectamente los límites y restricciones.</span><span class="sxs-lookup"><span data-stu-id="1d352-110">Make sure that you fully understand the limits and limitations.</span></span>
* <span data-ttu-id="1d352-111">Compruebe que el circuito está totalmente operativo en el modelo de implementación clásica.</span><span class="sxs-lookup"><span data-stu-id="1d352-111">Verify that the circuit is fully operational in the classic deployment model.</span></span>
* <span data-ttu-id="1d352-112">Asegúrese de tener un grupo de recursos creado en el modelo de implementación de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="1d352-112">Ensure that you have a resource group that was created in the Resource Manager deployment model.</span></span>
* <span data-ttu-id="1d352-113">Revise la siguiente documentación de migración de recursos:</span><span class="sxs-lookup"><span data-stu-id="1d352-113">Review the following resource-migration documentation:</span></span>

    * [<span data-ttu-id="1d352-114">Migración compatible con la plataforma de recursos de IaaS del modelo clásico al de Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="1d352-114">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="1d352-115">Profundización técnica en la migración compatible con la plataforma de la implementación clásica a la de Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="1d352-115">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
    * <span data-ttu-id="1d352-116">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md) (Preguntas frecuentes: Migración compatible con la plataforma de recursos de IaaS desde el modelo de implementación clásica a Azure Resource Manager)</span><span class="sxs-lookup"><span data-stu-id="1d352-116">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)</span></span>
    * [<span data-ttu-id="1d352-117">Revisión de los errores y mitigaciones más comunes en la migración</span><span class="sxs-lookup"><span data-stu-id="1d352-117">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)

## <a name="supported-and-unsupported-scenarios"></a><span data-ttu-id="1d352-118">Escenarios admitidos y no admitidos</span><span class="sxs-lookup"><span data-stu-id="1d352-118">Supported and unsupported scenarios</span></span>

* <span data-ttu-id="1d352-119">Un circuito ExpressRoute se puede mover desde el modelo de implementación clásica al entorno de Resource Manager sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="1d352-119">An ExpressRoute circuit can be moved from the classic to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="1d352-120">Puede mover un circuito ExpressRoute del entorno clásico al entorno de Resource Manager sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="1d352-120">You can move any ExpressRoute circuit from the classic to the Resource Manager environment with no downtime.</span></span> <span data-ttu-id="1d352-121">Siga las instrucciones sobre [cómo mover circuitos ExpressRoute del modelo de implementación clásica a Resource Manager mediante PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="1d352-121">Follow the instructions in [moving ExpressRoute circuits from the classic to the Resource Manager deployment model using PowerShell](expressroute-howto-move-arm.md).</span></span> <span data-ttu-id="1d352-122">Este es un requisito previo para mover recursos conectados a la red virtual.</span><span class="sxs-lookup"><span data-stu-id="1d352-122">This is a prerequisite to move resources connected to the virtual network.</span></span>
* <span data-ttu-id="1d352-123">Las redes virtuales, las puertas de enlace y las implementaciones asociadas dentro de la red virtual que están conectadas a un circuito ExpressRoute de la misma suscripción se pueden migrar al entorno de Resource Manager sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="1d352-123">Virtual networks, gateways, and associated deployments within the virtual network that are attached to an ExpressRoute circuit in the same subscription can be migrated to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="1d352-124">Puede seguir los pasos descritos más adelante para migrar recursos, como redes virtuales, puertas de enlace y máquinas virtuales implementadas dentro de la red virtual.</span><span class="sxs-lookup"><span data-stu-id="1d352-124">You can follow the steps described later to migrate resources such as virtual networks, gateways, and virtual machines deployed within the virtual network.</span></span> <span data-ttu-id="1d352-125">Debe asegurarse de que las redes virtuales estén configuradas correctamente antes de la migración.</span><span class="sxs-lookup"><span data-stu-id="1d352-125">You must ensure that the virtual networks are configured correctly before they are migrated.</span></span> 
* <span data-ttu-id="1d352-126">Las redes virtuales, las puertas de enlace y las implementaciones asociadas dentro de la red virtual que no estén en la misma suscripción que el circuito ExpressRoute requerirán algún tiempo de inactividad para completar la migración.</span><span class="sxs-lookup"><span data-stu-id="1d352-126">Virtual networks, gateways, and associated deployments within the virtual network that are not in the same subscription as the ExpressRoute circuit require some downtime to complete the migration.</span></span> <span data-ttu-id="1d352-127">En la última sección del documento se describen los pasos que se deben seguir para migrar los recursos.</span><span class="sxs-lookup"><span data-stu-id="1d352-127">The last section of the document describes the steps to be followed to migrate resources.</span></span>
* <span data-ttu-id="1d352-128">No se puede migrar una red virtual con la puerta de enlace de ExpressRoute y VPN Gateway.</span><span class="sxs-lookup"><span data-stu-id="1d352-128">A virtual network with both ExpressRoute Gateway and VPN Gateway can't be migrated.</span></span>

## <a name="move-an-expressroute-circuit-from-classic-to-resource-manager"></a><span data-ttu-id="1d352-129">Movimiento de un circuito ExpressRoute del modelo clásico a Resource Manager</span><span class="sxs-lookup"><span data-stu-id="1d352-129">Move an ExpressRoute circuit from classic to Resource Manager</span></span>
<span data-ttu-id="1d352-130">Deberá mover un circuito ExpressRoute del entorno clásico a Resource Manager antes de intentar migrar los recursos que están conectados al circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="1d352-130">You must move an ExpressRoute circuit from the classic to the Resource Manager environment before you try to migrate resources that are attached to the ExpressRoute circuit.</span></span> <span data-ttu-id="1d352-131">Para realizar esta tarea, consulte los siguientes artículos:</span><span class="sxs-lookup"><span data-stu-id="1d352-131">To accomplish this task, see the following articles:</span></span>

* <span data-ttu-id="1d352-132">Revise la información que se proporciona en [Transición de un circuito ExpressRoute desde la implementación clásica a la implementación de Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="1d352-132">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span>
* <span data-ttu-id="1d352-133">[Transición de los circuitos ExpressRoute desde el modelo de implementación clásica al modelo de implementación de Resource Manager mediante Azure PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="1d352-133">[Move a circuit from classic to Resource Manager using Azure PowerShell](expressroute-howto-move-arm.md).</span></span>
* <span data-ttu-id="1d352-134">Use el portal de Azure Service Management.</span><span class="sxs-lookup"><span data-stu-id="1d352-134">Use the Azure Service Management portal.</span></span> <span data-ttu-id="1d352-135">Puede seguir el flujo de trabajo para [crear un nuevo circuito ExpressRoute](expressroute-howto-circuit-portal-resource-manager.md) y seleccionar la opción de importación.</span><span class="sxs-lookup"><span data-stu-id="1d352-135">You can follow the workflow to [create a new ExpressRoute circuit](expressroute-howto-circuit-portal-resource-manager.md) and select the import option.</span></span> 

<span data-ttu-id="1d352-136">Esta operación no requiere tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="1d352-136">This operation does not involve downtime.</span></span> <span data-ttu-id="1d352-137">Puede continuar transfiriendo datos entre el entorno local y Microsoft mientras la migración está en curso.</span><span class="sxs-lookup"><span data-stu-id="1d352-137">You can continue to transfer data between your premises and Microsoft while the migration is in progress.</span></span>

## <a name="migrate-virtual-networks-gateways-and-associated-deployments"></a><span data-ttu-id="1d352-138">Migración de redes virtuales, puertas de enlace e implementaciones asociadas</span><span class="sxs-lookup"><span data-stu-id="1d352-138">Migrate virtual networks, gateways, and associated deployments</span></span>

<span data-ttu-id="1d352-139">Los pasos que siga para migrar dependen de si los recursos están en la misma suscripción, en distintas suscripciones o en ambos casos.</span><span class="sxs-lookup"><span data-stu-id="1d352-139">The steps you follow to migrate depend on whether your resources are in the same subscription, different subscriptions, or both.</span></span>

### <a name="migrate-virtual-networks-gateways-and-associated-deployments-in-the-same-subscription-as-the-expressroute-circuit"></a><span data-ttu-id="1d352-140">Migración de redes virtuales, puertas de enlace e implementaciones asociadas en la misma suscripción que el circuito ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="1d352-140">Migrate virtual networks, gateways, and associated deployments in the same subscription as the ExpressRoute circuit</span></span>
<span data-ttu-id="1d352-141">En esta sección se describen los pasos que se deben seguir para migrar una red virtual, una puerta de enlace y las implementaciones asociadas en la misma suscripción que el circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="1d352-141">This section describes the steps to be followed to migrate a virtual network, gateway, and associated deployments in the same subscription as the ExpressRoute circuit.</span></span> <span data-ttu-id="1d352-142">No hay tiempo de inactividad asociado a esta migración.</span><span class="sxs-lookup"><span data-stu-id="1d352-142">No downtime is associated with this migration.</span></span> <span data-ttu-id="1d352-143">Puede seguir usando todos los recursos a través del proceso de migración.</span><span class="sxs-lookup"><span data-stu-id="1d352-143">You can continue to use all resources through the migration process.</span></span> <span data-ttu-id="1d352-144">El plano de administración se bloquea mientras la migración está en curso.</span><span class="sxs-lookup"><span data-stu-id="1d352-144">The management plane is locked while the migration is in progress.</span></span> 

1. <span data-ttu-id="1d352-145">Asegúrese de que el circuito ExpressRoute se ha movido del entorno clásico al entorno de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="1d352-145">Ensure that the ExpressRoute circuit has been moved from the classic to the Resource Manager environment.</span></span>
2. <span data-ttu-id="1d352-146">Asegúrese de que la red virtual se ha preparado correctamente para la migración.</span><span class="sxs-lookup"><span data-stu-id="1d352-146">Ensure that the virtual network has been prepared appropriately for the migration.</span></span>
3. <span data-ttu-id="1d352-147">Registre la suscripción para la migración de recursos.</span><span class="sxs-lookup"><span data-stu-id="1d352-147">Register your subscription for resource migration.</span></span> <span data-ttu-id="1d352-148">Para registrar la suscripción para la migración de recursos, use el siguiente fragmento de código de PowerShell:</span><span class="sxs-lookup"><span data-stu-id="1d352-148">To register your subscription for resource migration, use the following PowerShell snippet:</span></span>

  ```powershell 
  Select-AzureRmSubscription -SubscriptionName <Your Subscription Name>
  Register-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  Get-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  ```
4. <span data-ttu-id="1d352-149">Valide, prepare y migre.</span><span class="sxs-lookup"><span data-stu-id="1d352-149">Validate, prepare, and migrate.</span></span> <span data-ttu-id="1d352-150">Para mover la red virtual, use el siguiente fragmento de código de PowerShell:</span><span class="sxs-lookup"><span data-stu-id="1d352-150">To move the virtual network, use the following PowerShell snippet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Prepare $vnetName  
  Move-AzureVirtualNetwork -Commit $vnetName
  ```

  <span data-ttu-id="1d352-151">También puede cancelar la migración mediante la ejecución del siguiente cmdlet de PowerShell:</span><span class="sxs-lookup"><span data-stu-id="1d352-151">You can also abort migration by running the following PowerShell cmdlet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Abort $vnetName
  ```

## <a name="next-steps"></a><span data-ttu-id="1d352-152">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="1d352-152">Next steps</span></span>
* [<span data-ttu-id="1d352-153">Migración compatible con la plataforma de recursos de IaaS del modelo clásico al de Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="1d352-153">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="1d352-154">Profundización técnica en la migración compatible con la plataforma de la implementación clásica a la de Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="1d352-154">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
* <span data-ttu-id="1d352-155">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md) (Preguntas frecuentes: Migración compatible con la plataforma de recursos de IaaS desde el modelo de implementación clásica a Azure Resource Manager)</span><span class="sxs-lookup"><span data-stu-id="1d352-155">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)</span></span>
* [<span data-ttu-id="1d352-156">Revisión de los errores y mitigaciones más comunes en la migración</span><span class="sxs-lookup"><span data-stu-id="1d352-156">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
