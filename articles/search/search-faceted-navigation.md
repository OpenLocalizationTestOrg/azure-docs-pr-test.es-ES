---
title: "Procedimiento para implementar la navegación por facetas en Azure Search | Microsoft Docs"
description: "Agregue navegación con facetas a aplicaciones que se integran con Búsqueda de Azure, un servicio de búsqueda hospedado en la nube en Microsoft Azure."
services: search
documentationcenter: 
author: HeidiSteen
manager: mblythe
editor: 
ms.assetid: cdf98fd4-63fd-4b50-b0b0-835cb08ad4d3
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 3/10/2017
ms.author: heidist
ms.openlocfilehash: 413f498eeb0bbc9a971c7a65200ed2fd8caa9aaf
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-implement-faceted-navigation-in-azure-search"></a><span data-ttu-id="b2b84-103">Procedimiento para implementar la navegación por facetas en Búsqueda de Azure</span><span class="sxs-lookup"><span data-stu-id="b2b84-103">How to implement faceted navigation in Azure Search</span></span>
<span data-ttu-id="b2b84-104">La navegación por facetas es un mecanismo de filtrado que proporciona una navegación en profundidad autodirigida en aplicaciones de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-104">Faceted navigation is a filtering mechanism that provides self-directed drilldown navigation in search applications.</span></span> <span data-ttu-id="b2b84-105">El término "navegación por facetas" puede resultarle desconocido, pero probablemente es algo que ya ha usado con anterioridad.</span><span class="sxs-lookup"><span data-stu-id="b2b84-105">The term 'faceted navigation' may be unfamiliar, but you've probably used it before.</span></span> <span data-ttu-id="b2b84-106">Como se muestra en el siguiente ejemplo, la navegación por facetas no es más que las categorías usadas para filtrar los resultados.</span><span class="sxs-lookup"><span data-stu-id="b2b84-106">As the following example shows, faceted navigation is nothing more than the categories used to filter results.</span></span>

 ![Azure Search Job Portal Demo (Demostración del portal de búsqueda de trabajo de Azure Search)][1]

<span data-ttu-id="b2b84-108">La navegación por facetas es un punto de entrada alternativo para buscar.</span><span class="sxs-lookup"><span data-stu-id="b2b84-108">Faceted navigation is an alternative entry point to search.</span></span> <span data-ttu-id="b2b84-109">Ofrece una alternativa cómoda a escribir expresiones de búsqueda complejas a mano.</span><span class="sxs-lookup"><span data-stu-id="b2b84-109">It offers a convenient alternative to typing complex search expressions by hand.</span></span> <span data-ttu-id="b2b84-110">Las facetas pueden ayudarle a encontrar lo que busca y le garantizan que obtendrá al menos un resultado.</span><span class="sxs-lookup"><span data-stu-id="b2b84-110">Facets can help you find what you're looking for, while ensuring that you don’t get zero results.</span></span> <span data-ttu-id="b2b84-111">Como desarrollador, las facetas permiten exponer los criterios de búsqueda más útiles para navegar por el corpus de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-111">As a developer, facets let you expose the most useful search criteria for navigating your search corpus.</span></span> <span data-ttu-id="b2b84-112">En las aplicaciones de tienda en línea, la navegación por facetas suele basarse en marcas, departamentos (zapatos para niños), tamaño, precio, popularidad y clasificación.</span><span class="sxs-lookup"><span data-stu-id="b2b84-112">In online retail applications, faceted navigation is often built over brands, departments (kid’s shoes), size, price, popularity, and ratings.</span></span> 

<span data-ttu-id="b2b84-113">La implementación de la navegación por facetas difiere en las distintas tecnologías de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-113">Implementing faceted navigation differs across search technologies.</span></span> <span data-ttu-id="b2b84-114">En Azure Search, la navegación por facetas se compila en tiempo de consulta usando campos que haya atribuido anteriormente en el esquema.</span><span class="sxs-lookup"><span data-stu-id="b2b84-114">In Azure Search, faceted navigation is built at query time, using fields that you previously attributed in your schema.</span></span>

-   <span data-ttu-id="b2b84-115">En las consultas que la aplicación crea, una consulta tiene que enviar *parámetros de consulta de faceta* para obtener los valores de filtro de faceta disponibles para ese conjunto de resultados de documento.</span><span class="sxs-lookup"><span data-stu-id="b2b84-115">In the queries that your application builds, a query must send *facet query parameters* to get the available facet filter values for that document result set.</span></span>

-   <span data-ttu-id="b2b84-116">Para recortar realmente el conjunto de resultados de documento, la aplicación tiene que aplicar también una expresión `$filter`.</span><span class="sxs-lookup"><span data-stu-id="b2b84-116">To actually trim the document result set, the application must also apply a `$filter` expression.</span></span>

<span data-ttu-id="b2b84-117">En el desarrollo de aplicaciones, la escritura del código que construye las consultas supone la mayor parte del trabajo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-117">In your application development, writing code that constructs queries constitutes the bulk of the work.</span></span> <span data-ttu-id="b2b84-118">El servicio proporciona muchos de los comportamientos de aplicación que podrían interesarle de la navegación por facetas, incluida la compatibilidad integrada para establecer intervalos y obtener recuentos de los resultados de la faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-118">Many of the application behaviors that you would expect from faceted navigation are provided by the service, including built-in support for defining ranges and getting counts for facet results.</span></span> <span data-ttu-id="b2b84-119">El servicio también incluye valores predeterminados razonables que le ayudarán a evitar estructuras de navegación difíciles de manejar.</span><span class="sxs-lookup"><span data-stu-id="b2b84-119">The service also includes sensible defaults that help you avoid unwieldy navigation structures.</span></span> 

## <a name="sample-code-and-demo"></a><span data-ttu-id="b2b84-120">Demostración y código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="b2b84-120">Sample code and demo</span></span>
<span data-ttu-id="b2b84-121">En este artículo se utiliza como ejemplo un portal de búsqueda de trabajo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-121">This article uses a job search portal as an example.</span></span> <span data-ttu-id="b2b84-122">El ejemplo se implementa como una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="b2b84-122">The example is implemented as an ASP.NET MVC application.</span></span>

-   <span data-ttu-id="b2b84-123">Vea y pruebe la demostración de trabajo en línea en [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/) (Demostración del portal de búsqueda de trabajo de Azure Search).</span><span class="sxs-lookup"><span data-stu-id="b2b84-123">See and test the working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="b2b84-124">Descargue el código del [repositorio de ejemplos de Azure en GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="b2b84-124">Download the code from the [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

## <a name="get-started"></a><span data-ttu-id="b2b84-125">Primeros pasos</span><span class="sxs-lookup"><span data-stu-id="b2b84-125">Get started</span></span>
<span data-ttu-id="b2b84-126">Si no está familiarizado con el desarrollo de búsquedas, la mejor manera de pensar en la navegación por facetas es que muestra las posibilidades de una búsqueda autodirigida.</span><span class="sxs-lookup"><span data-stu-id="b2b84-126">If you're new to search development, the best way to think of faceted navigation is that it shows the possibilities for self-directed search.</span></span> <span data-ttu-id="b2b84-127">Es un tipo de experiencia de búsqueda en profundidad basada en filtros predefinidos, que se usa para restringir rápidamente los resultados de búsqueda mediante acciones de apuntar y hacer clic.</span><span class="sxs-lookup"><span data-stu-id="b2b84-127">It’s a type of drill-down search experience, based on predefined filters, used for quickly narrowing down search results through point-and-click actions.</span></span> 

### <a name="interaction-model"></a><span data-ttu-id="b2b84-128">Modelo de interacción</span><span class="sxs-lookup"><span data-stu-id="b2b84-128">Interaction model</span></span>

<span data-ttu-id="b2b84-129">La experiencia de búsqueda de la navegación por facetas es iterativa, por lo que comenzaremos por describirla como una secuencia de consultas que se despliega en respuesta a las acciones del usuario.</span><span class="sxs-lookup"><span data-stu-id="b2b84-129">The search experience for faceted navigation is iterative, so let’s start by understanding it as a sequence of queries that unfold in response to user actions.</span></span>

<span data-ttu-id="b2b84-130">El punto de partida es una página de aplicación que proporciona navegación por facetas, normalmente situada en la periferia.</span><span class="sxs-lookup"><span data-stu-id="b2b84-130">The starting point is an application page that provides faceted navigation, typically placed on the periphery.</span></span> <span data-ttu-id="b2b84-131">La navegación por facetas suele tener una estructura de árbol con casillas para cada valor o texto en el que se puede hacer clic.</span><span class="sxs-lookup"><span data-stu-id="b2b84-131">Faceted navigation is often a tree structure, with checkboxes for each value, or clickable text.</span></span> 

1. <span data-ttu-id="b2b84-132">Una consulta enviada a Búsqueda de Azure especifica la estructura de la navegación por facetas mediante uno o más parámetros de consulta de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-132">A query sent to Azure Search specifies the faceted navigation structure via one or more facet query parameters.</span></span> <span data-ttu-id="b2b84-133">Por ejemplo, la consulta podría incluir `facet=Rating`, quizá con una opción `:values` o `:sort` para refinar aún más la presentación.</span><span class="sxs-lookup"><span data-stu-id="b2b84-133">For instance, the query might include `facet=Rating`, perhaps with a `:values` or `:sort` option to further refine the presentation.</span></span>
2. <span data-ttu-id="b2b84-134">La capa de presentación representa una página de búsqueda que proporciona navegación por facetas, usando las facetas especificadas en la solicitud.</span><span class="sxs-lookup"><span data-stu-id="b2b84-134">The presentation layer renders a search page that provides faceted navigation, using the facets specified on the request.</span></span>
3. <span data-ttu-id="b2b84-135">En una estructura de navegación por facetas dada que incluye el campo de valoración Rating, haga clic en "4" para indicar que solo se deben mostrar los productos con una valoración de 4 o superior.</span><span class="sxs-lookup"><span data-stu-id="b2b84-135">Given a faceted navigation structure that includes Rating, you click "4" to indicate that only products with a rating of 4 or higher should be shown.</span></span> 
4. <span data-ttu-id="b2b84-136">En respuesta, la aplicación envía una consulta que incluye `$filter=Rating ge 4`</span><span class="sxs-lookup"><span data-stu-id="b2b84-136">In response, the application sends a query that includes `$filter=Rating ge 4`</span></span> 
5. <span data-ttu-id="b2b84-137">La capa de presentación actualiza la página para mostrar un conjunto de resultados reducido únicamente con los elementos que cumplen el nuevo criterio (en este caso, los productos con una valoración de 4 y superior).</span><span class="sxs-lookup"><span data-stu-id="b2b84-137">The presentation layer updates the page, showing a reduced result set, containing just those items that satisfy the new criteria (in this case, products rated 4 and up).</span></span>

<span data-ttu-id="b2b84-138">Una faceta es un parámetro de consulta, pero no lo confunda con una entrada de consulta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-138">A facet is a query parameter, but do not confuse it with query input.</span></span> <span data-ttu-id="b2b84-139">Nunca se usa como criterio de selección en una consulta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-139">It is never used as selection criteria in a query.</span></span> <span data-ttu-id="b2b84-140">En su lugar, piense en los parámetros de consulta de faceta como entradas a la estructura de navegación que se devuelven en la respuesta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-140">Instead, think of facet query parameters as inputs to the navigation structure that comes back in the response.</span></span> <span data-ttu-id="b2b84-141">Para cada parámetro de consulta de faceta que proporcione, Azure Search evaluará cuántos documentos hay en los resultados parciales de cada valor de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-141">For each facet query parameter you provide, Azure Search evaluates how many documents are in the partial results for each facet value.</span></span>

<span data-ttu-id="b2b84-142">Observe la expresión `$filter` en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="b2b84-142">Notice the `$filter` in step 4.</span></span> <span data-ttu-id="b2b84-143">El filtro es un aspecto importante de la navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-143">The filter is an important aspect of faceted navigation.</span></span> <span data-ttu-id="b2b84-144">Aunque las facetas y los filtros son independientes en la API, ambos son necesarios para proporcionarle la experiencia que desea.</span><span class="sxs-lookup"><span data-stu-id="b2b84-144">Although facets and filters are independent in the API, you need both to deliver the experience you intend.</span></span> 

### <a name="app-design-pattern"></a><span data-ttu-id="b2b84-145">Patrón de diseño de la aplicación</span><span class="sxs-lookup"><span data-stu-id="b2b84-145">App design pattern</span></span>

<span data-ttu-id="b2b84-146">En el código de aplicación, el patrón es usar parámetros de consulta de faceta para devolver la estructura de navegación por facetas junto con los resultados de las facetas, además de una expresión $filter.</span><span class="sxs-lookup"><span data-stu-id="b2b84-146">In application code, the pattern is to use facet query parameters to return the faceted navigation structure along with facet results, plus a $filter expression.</span></span>  <span data-ttu-id="b2b84-147">La expresión de filtro controla el evento de clic en el valor de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-147">The filter expression handles the click event on the facet value.</span></span> <span data-ttu-id="b2b84-148">Piense en la expresión `$filter` como en el código subyacente al recorte real de los resultados de búsqueda que se devuelven a la capa de presentación.</span><span class="sxs-lookup"><span data-stu-id="b2b84-148">Think of the `$filter` expression as the code behind the actual trimming of search results returned to the presentation layer.</span></span> <span data-ttu-id="b2b84-149">En una faceta Colors dada, la posibilidad de hacer clic en el color Red se implementa mediante una expresión `$filter` que selecciona solo los elementos que tienen un color rojo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-149">Given a Colors facet, clicking the color Red is implemented through a `$filter` expression that selects only those items that have a color of red.</span></span> 

### <a name="query-basics"></a><span data-ttu-id="b2b84-150">Conceptos básicos de las consultas</span><span class="sxs-lookup"><span data-stu-id="b2b84-150">Query basics</span></span>

<span data-ttu-id="b2b84-151">En Búsqueda de Azure, una solicitud se especifica mediante uno o más parámetros de consulta (consulte [Buscar documentos](http://msdn.microsoft.com/library/azure/dn798927.aspx) para obtener una descripción de cada uno).</span><span class="sxs-lookup"><span data-stu-id="b2b84-151">In Azure Search, a request is specified through one or more query parameters (see [Search Documents](http://msdn.microsoft.com/library/azure/dn798927.aspx) for a description of each one).</span></span> <span data-ttu-id="b2b84-152">Ninguno de los parámetros de consulta son obligatorios, pero debe tener al menos uno para que una consulta sea válida.</span><span class="sxs-lookup"><span data-stu-id="b2b84-152">None of the query parameters are required, but you must have at least one in order for a query to be valid.</span></span>

<span data-ttu-id="b2b84-153">La precisión, entendida como la capacidad de filtrar los resultados irrelevantes, se consigue mediante una o ambas de estas expresiones:</span><span class="sxs-lookup"><span data-stu-id="b2b84-153">Precision, understood as the ability to filter out irrelevant hits, is achieved through one or both of these expressions:</span></span>

-   <span data-ttu-id="b2b84-154">**search=**</span><span class="sxs-lookup"><span data-stu-id="b2b84-154">**search=**</span></span>  
    <span data-ttu-id="b2b84-155">El valor de este parámetro constituye la expresión de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-155">The value of this parameter constitutes the search expression.</span></span> <span data-ttu-id="b2b84-156">Podría ser un fragmento de texto o una expresión de búsqueda compleja que incluye varios términos y operadores.</span><span class="sxs-lookup"><span data-stu-id="b2b84-156">It might be a single piece of text, or a complex search expression that includes multiple terms and operators.</span></span> <span data-ttu-id="b2b84-157">En el servidor, las expresiones de búsqueda se usan para realizar búsquedas de texto completo que consultan en los campos de búsqueda del índice si hay términos coincidentes y devuelven los resultados en orden.</span><span class="sxs-lookup"><span data-stu-id="b2b84-157">On the server, a search expression is used for full-text search, querying searchable fields in the index for matching terms, returning results in rank order.</span></span> <span data-ttu-id="b2b84-158">Si establece `search` en NULL, la ejecución de la consulta se realiza en todo el índice (es decir, `search=*`).</span><span class="sxs-lookup"><span data-stu-id="b2b84-158">If you set `search` to null, query execution is over the entire index (that is, `search=*`).</span></span> <span data-ttu-id="b2b84-159">En este caso, los demás elementos de la consulta, como un `$filter` o el perfil de puntuación, son los principales factores que afectan a qué documentos se devuelven (`($filter`) y en qué orden (`scoringProfile` o `$orderby`).</span><span class="sxs-lookup"><span data-stu-id="b2b84-159">In this case, other elements of the query, such as a `$filter` or scoring profile, are the primary factors affecting which documents are returned `($filter`) and in what order (`scoringProfile` or `$orderby`).</span></span>

-   <span data-ttu-id="b2b84-160">**$filter=**</span><span class="sxs-lookup"><span data-stu-id="b2b84-160">**$filter=**</span></span>  
    <span data-ttu-id="b2b84-161">Un filtro es un mecanismo eficaz para limitar el tamaño de los resultados de búsqueda según los valores de atributos de documento específicos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-161">A filter is a powerful mechanism for limiting the size of search results based on the values of specific document attributes.</span></span> <span data-ttu-id="b2b84-162">Primero se evalúa una expresión `$filter` y después la lógica de uso de facetas que genera los valores disponibles y los correspondientes recuentos para cada valor.</span><span class="sxs-lookup"><span data-stu-id="b2b84-162">A `$filter` is evaluated first, followed by faceting logic that generates the available values and corresponding counts for each value</span></span>

<span data-ttu-id="b2b84-163">Las expresiones de búsqueda complejas reducen el rendimiento de la consulta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-163">Complex search expressions decrease the performance of the query.</span></span> <span data-ttu-id="b2b84-164">Siempre que sea posible, use expresiones de filtro bien construidas para aumentar la precisión y mejorar el rendimiento de las consultas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-164">Where possible, use well-constructed filter expressions to increase precision and improve query performance.</span></span>

<span data-ttu-id="b2b84-165">Para entender mejor cómo los filtros agregan más precisión, compare una expresión de búsqueda compleja con una que incluya una expresión de filtro:</span><span class="sxs-lookup"><span data-stu-id="b2b84-165">To better understand how a filter adds more precision, compare a complex search expression to one that includes a filter expression:</span></span>

-   `GET /indexes/hotel/docs?search=lodging budget +Seattle –motel +parking`
-   `GET /indexes/hotel/docs?search=lodging&$filter=City eq ‘Seattle’ and Parking and Type ne ‘motel’`

<span data-ttu-id="b2b84-166">Aunque ambas consultas son válidas, la segunda es mejor si está buscando hoteles que no sean moteles con estacionamiento en Seattle.</span><span class="sxs-lookup"><span data-stu-id="b2b84-166">Both queries are valid, but the second is superior if you’re looking for non-motels with parking in Seattle.</span></span>
-   <span data-ttu-id="b2b84-167">La primera consulta se basa en las palabras específicas que se mencionan o no en campos de cadena tales como nombre, descripción u otros que contengan datos que se pueden buscar.</span><span class="sxs-lookup"><span data-stu-id="b2b84-167">The first query relies on those specific words being mentioned or not mentioned in string fields like Name, Description, and any other field containing searchable data.</span></span>
-   <span data-ttu-id="b2b84-168">La segunda consulta busca coincidencias precisas en datos estructurados y es probable que sea mucho más exacta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-168">The second query looks for precise matches on structured data and is likely to be much more accurate.</span></span>

<span data-ttu-id="b2b84-169">En las aplicaciones que incluyen navegación por facetas, asegúrese de que cada acción del usuario en una estructura de navegación por facetas vaya acompañada de una restricción de los resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-169">In applications that include faceted navigation, make sure that each user action over a faceted navigation structure is accompanied by a narrowing of search results.</span></span> <span data-ttu-id="b2b84-170">Para restringir los resultados, utilice una expresión de filtro.</span><span class="sxs-lookup"><span data-stu-id="b2b84-170">To narrow results, use a filter expression.</span></span>

<a name="howtobuildit"></a>

## <a name="build-a-faceted-navigation-app"></a><span data-ttu-id="b2b84-171">Compilación de una aplicación de navegación por facetas</span><span class="sxs-lookup"><span data-stu-id="b2b84-171">Build a faceted navigation app</span></span>
<span data-ttu-id="b2b84-172">Implemente la navegación por facetas con Azure Search en el código de la aplicación que compila la solicitud de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-172">You implement faceted navigation with Azure Search in your application code that builds the search request.</span></span> <span data-ttu-id="b2b84-173">El panel de navegación por facetas se basa en los elementos del esquema que definió anteriormente.</span><span class="sxs-lookup"><span data-stu-id="b2b84-173">The faceted navigation relies on elements in your schema that you defined previously.</span></span>

<span data-ttu-id="b2b84-174">En el índice de búsqueda está predefinido el atributo de índice `Facetable [true|false]` , que se establece en los campos seleccionados para habilitar o deshabilitar su uso en una estructura de navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-174">Predefined in your search index is the `Facetable [true|false]` index attribute, set on selected fields to enable or disable their use in a faceted navigation structure.</span></span> <span data-ttu-id="b2b84-175">Sin `"Facetable" = true`, un campo no se puede usar en la navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-175">Without `"Facetable" = true`, a field cannot be used in facet navigation.</span></span>

<span data-ttu-id="b2b84-176">La capa de presentación del código proporciona la experiencia del usuario.</span><span class="sxs-lookup"><span data-stu-id="b2b84-176">The presentation layer in your code provides the user experience.</span></span> <span data-ttu-id="b2b84-177">Debe enumerar las partes que constituyen la navegación por facetas, como la etiqueta, los valores, las casillas y el recuento.</span><span class="sxs-lookup"><span data-stu-id="b2b84-177">It should list the constituent parts of the faceted navigation, such as the label, values, check boxes, and the count.</span></span> <span data-ttu-id="b2b84-178">La API de REST de Búsqueda de Azure es independiente de la plataforma, así que puede usar cualquier lenguaje y plataforma que desee.</span><span class="sxs-lookup"><span data-stu-id="b2b84-178">The Azure Search REST API is platform agnostic, so use whatever language and platform you want.</span></span> <span data-ttu-id="b2b84-179">Lo importante es incluir elementos de interfaz de usuario que admitan la actualización incremental, actualizando el estado de la interfaz de usuario cuando se seleccione cada faceta adicional.</span><span class="sxs-lookup"><span data-stu-id="b2b84-179">The important thing is to include UI elements that support incremental refresh, with updated UI state as each additional facet is selected.</span></span> 

<span data-ttu-id="b2b84-180">En tiempo de consulta, el código de aplicación crea una solicitud que incluye `facet=[string]`, un parámetro de solicitud que proporciona el campo por el que se realizará la consulta por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-180">At query time, your application code creates a request that includes `facet=[string]`, a request parameter that provides the field to facet by.</span></span> <span data-ttu-id="b2b84-181">Una consulta puede tener varias facetas, como `&facet=color&facet=category&facet=rating`, separadas por un carácter de y comercial (&).</span><span class="sxs-lookup"><span data-stu-id="b2b84-181">A query can have multiple facets, such as `&facet=color&facet=category&facet=rating`, each one separated by an ampersand (&) character.</span></span>

<span data-ttu-id="b2b84-182">El código de aplicación también debe construir una expresión `$filter` para controlar los eventos de clic en la navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-182">Application code must also construct a `$filter` expression to handle the click events in faceted navigation.</span></span> <span data-ttu-id="b2b84-183">Una expresión `$filter` reduce los resultados de búsqueda, usando el valor de la faceta como criterio de filtro.</span><span class="sxs-lookup"><span data-stu-id="b2b84-183">A `$filter` reduces the search results, using the facet value as filter criteria.</span></span>

<span data-ttu-id="b2b84-184">Azure Search devuelve los resultados de búsqueda, basados en uno o más de los términos que haya escrito, junto con las actualizaciones de la estructura de navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-184">Azure Search returns the search results, based on one or more terms that you enter, along with updates to the faceted navigation structure.</span></span> <span data-ttu-id="b2b84-185">En Búsqueda de Azure, la navegación por facetas es una construcción de un solo nivel, con los valores de las facetas y los recuentos de cuántos resultados se encuentran para cada una.</span><span class="sxs-lookup"><span data-stu-id="b2b84-185">In Azure Search, faceted navigation is a single-level construction, with facet values, and counts of how many results are found for each one.</span></span>

<span data-ttu-id="b2b84-186">En las secciones siguientes veremos con más detalle cómo crear cada parte.</span><span class="sxs-lookup"><span data-stu-id="b2b84-186">In the following sections, we take a closer look at how to build each part.</span></span>

<a name="buildindex"></a>

## <a name="build-the-index"></a><span data-ttu-id="b2b84-187">Crear el índice</span><span class="sxs-lookup"><span data-stu-id="b2b84-187">Build the index</span></span>
<span data-ttu-id="b2b84-188">El uso de facetas se habilita para cada campo en el índice mediante este atributo de índice: `"Facetable": true`.</span><span class="sxs-lookup"><span data-stu-id="b2b84-188">Faceting is enabled on a field-by-field basis in the index, via this index attribute: `"Facetable": true`.</span></span>  
<span data-ttu-id="b2b84-189">Todos los tipos de campo que podrían usarse en la navegación por facetas son `Facetable` de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="b2b84-189">All field types that could possibly be used in faceted navigation are `Facetable` by default.</span></span> <span data-ttu-id="b2b84-190">Entre estos tipos de campo se incluyen `Edm.String`, `Edm.DateTimeOffset`, y todos los tipos de campo numéricos (básicamente, todos los tipos de campo se pueden usar con facetas excepto `Edm.GeographyPoint`, que no se puede usar en la navegación por facetas).</span><span class="sxs-lookup"><span data-stu-id="b2b84-190">Such field types include `Edm.String`, `Edm.DateTimeOffset`, and all the numeric field types (essentially, all field types are facetable except `Edm.GeographyPoint`, which can’t be used in faceted navigation).</span></span> 

<span data-ttu-id="b2b84-191">Al crear un índice, el procedimiento recomendado para la navegación por facetas desactivar explícitamente el uso de facetas para los campos que nunca deben usarse como facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-191">When building an index, a best practice for faceted navigation is to explicitly turn faceting off for fields that should never be used as a facet.</span></span>  <span data-ttu-id="b2b84-192">En concreto, los campos de cadena de valores singleton, tales como un identificador o un nombre de producto, deben establecerse en `"Facetable": false` para impedir su uso accidental (e ineficaz) en una exploración por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-192">In particular, string fields for singleton values, such as an ID or product name, should be set to `"Facetable": false` to prevent their accidental (and ineffective) use in faceted navigation.</span></span> <span data-ttu-id="b2b84-193">Desactivar el uso de facetas donde no es necesario ayuda a mantener un tamaño de índice pequeño y, por lo general, mejora el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="b2b84-193">Turning faceting off where you don’t need it helps keep the size of the index small, and typically improves performance.</span></span>

<span data-ttu-id="b2b84-194">El siguiente es parte del esquema de la aplicación de ejemplo de la demostración del portal de búsqueda de trabajo, al que se le han recortado algunos atributos para reducir su tamaño:</span><span class="sxs-lookup"><span data-stu-id="b2b84-194">Following is part of the schema for the Job Portal Demo sample app, trimmed of some attributes to reduce the size:</span></span>

```json
{
  ...
  "name": "nycjobs",
  "fields": [
    { “name”: "id",                 "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "job_id",             "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "agency",              "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "posting_type",        "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "num_of_positions",    "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "business_title",      "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "civil_service_title", "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "title_code_no",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "level",               "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_from",   "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_to",     "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_frequency",    "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "work_location",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
…
    { “name”: "geo_location",        "type": "Edm.GeographyPoint",     "searchable": false, "filterable": true, ...  "facetable": false, ... },
    { “name”: "tags",                "type": "Collection(Edm.String)", "searchable": true,  "filterable": true, ...  "facetable": true, ...  }
  ],
…
}
```

<span data-ttu-id="b2b84-195">Como puede observar en el esquema del ejemplo, `Facetable` se ha desactivado para los campos de cadena que no deben usarse como facetas, como los valores de identificador.</span><span class="sxs-lookup"><span data-stu-id="b2b84-195">As you can see in the sample schema, `Facetable` is turned off for string fields that shouldn’t be used as facets, such as ID values.</span></span> <span data-ttu-id="b2b84-196">Desactivar el uso de facetas donde no es necesario ayuda a mantener un tamaño de índice pequeño y, por lo general, mejora el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="b2b84-196">Turning faceting off where you don’t need it helps keep the size of the index small, and typically improves performance.</span></span>

> [!TIP]
> <span data-ttu-id="b2b84-197">Como procedimiento recomendado, incluya el conjunto completo de atributos de índice para cada campo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-197">As a best practice, include the full set of index attributes for each field.</span></span> <span data-ttu-id="b2b84-198">Aunque `Facetable` está activado para casi todos los campos de forma predeterminada, establecer deliberadamente cada atributo puede ayudar a considerar detenidamente las implicaciones de cada decisión del esquema.</span><span class="sxs-lookup"><span data-stu-id="b2b84-198">Although `Facetable` is on by default for almost all fields, purposely setting each attribute can help you think through the implications of each schema decision.</span></span> 

<a name="checkdata"></a>

## <a name="check-the-data"></a><span data-ttu-id="b2b84-199">Comprobación de los datos</span><span class="sxs-lookup"><span data-stu-id="b2b84-199">Check the data</span></span>
<span data-ttu-id="b2b84-200">La calidad de los datos tiene un efecto directo en la posibilidad de que la estructura de navegación por facetas se materialice tal y como se espera.</span><span class="sxs-lookup"><span data-stu-id="b2b84-200">The quality of your data has a direct effect on whether the faceted navigation structure materializes as you expect it to.</span></span> <span data-ttu-id="b2b84-201">También afecta a la facilidad de creación de filtros para reducir el conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="b2b84-201">It also affects the ease of constructing filters to reduce the result set.</span></span>

<span data-ttu-id="b2b84-202">Si desea usar la marca o el precio como facetas, cada documento debe contener valores de *BrandName* y *ProductPrice* que sean válidos, coherentes y productivos como opción de filtro.</span><span class="sxs-lookup"><span data-stu-id="b2b84-202">If you want to facet by Brand or Price, each document should contain values for *BrandName* and *ProductPrice* that are valid, consistent, and productive as a filter option.</span></span>

<span data-ttu-id="b2b84-203">A continuación tiene algunos recordatorios de lo que se debe pulir:</span><span class="sxs-lookup"><span data-stu-id="b2b84-203">Here are a few reminders of what to scrub for:</span></span>

* <span data-ttu-id="b2b84-204">Para cada campo que desee usar como faceta, pregúntese si contiene valores que son adecuados como filtros en búsquedas autodirigidas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-204">For every field that you want to facet by, ask yourself whether it contains values that are suitable as filters in self-directed search.</span></span> <span data-ttu-id="b2b84-205">Los valores deben ser breves, descriptivos y suficientemente distintivos para ofrecer una opción clara entre las opciones de la competencia.</span><span class="sxs-lookup"><span data-stu-id="b2b84-205">The values should be short, descriptive, and sufficiently distinctive to offer a clear choice between competing options.</span></span>
* <span data-ttu-id="b2b84-206">Errores ortográficos o valores casi coincidentes.</span><span class="sxs-lookup"><span data-stu-id="b2b84-206">Misspellings or nearly matching values.</span></span> <span data-ttu-id="b2b84-207">Si usa Color como faceta y los valores de campo incluyen Naranja y Nraanja (una palabra incorrecta), una faceta basada en el campo Color seleccionará ambas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-207">If you facet on Color, and field values include Orange and Ornage (a misspelling), a facet based on the Color field would pick up both.</span></span>
* <span data-ttu-id="b2b84-208">La mezcla de mayúsculas y minúsculas en el texto también puede causar estragos en la navegación por facetas, porque naranja y Naranja aparecen como dos valores diferentes.</span><span class="sxs-lookup"><span data-stu-id="b2b84-208">Mixed case text can also wreak havoc in faceted navigation, with orange and Orange appearing as two different values.</span></span> 
* <span data-ttu-id="b2b84-209">Las versiones en singular y plural del mismo valor pueden producir una faceta diferente para cada una.</span><span class="sxs-lookup"><span data-stu-id="b2b84-209">Single and plural versions of the same value can result in a separate facet for each.</span></span>

<span data-ttu-id="b2b84-210">Como puede imaginar, la diligencia en la preparación de los datos es un aspecto esencial de una navegación por facetas eficiente.</span><span class="sxs-lookup"><span data-stu-id="b2b84-210">As you can imagine, diligence in preparing the data is an essential aspect of effective faceted navigation.</span></span>

<a name="presentationlayer"></a>

## <a name="build-the-ui"></a><span data-ttu-id="b2b84-211">Creación de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="b2b84-211">Build the UI</span></span>
<span data-ttu-id="b2b84-212">Empezar a trabajar desde la capa de presentación puede ayudarle a descubrir requisitos que de otra forma podrían perderse, y comprender las características que son esenciales para la experiencia de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-212">Working back from the presentation layer can help you uncover requirements that might be missed otherwise, and understand which capabilities are essential to the search experience.</span></span>

<span data-ttu-id="b2b84-213">En términos de la navegación por facetas, la página o aplicación web muestra la estructura de la navegación por facetas, detecta la entrada del usuario en la página e inserta los elementos modificados.</span><span class="sxs-lookup"><span data-stu-id="b2b84-213">In terms of faceted navigation, your web or application page displays the faceted navigation structure, detects user input on the page, and inserts the changed elements.</span></span> 

<span data-ttu-id="b2b84-214">En el caso de las aplicaciones web, normalmente se usa AJAX en la capa de presentación porque permite actualizar los cambios incrementales.</span><span class="sxs-lookup"><span data-stu-id="b2b84-214">For web applications, AJAX is commonly used in the presentation layer because it allows you to refresh incremental changes.</span></span> <span data-ttu-id="b2b84-215">También puede usar ASP.NET MVC o cualquier otra plataforma de visualización que puede conectarse a un servicio Búsqueda de Azure a través de HTTP.</span><span class="sxs-lookup"><span data-stu-id="b2b84-215">You could also use ASP.NET MVC or any other visualization platform that can connect to an Azure Search service over HTTP.</span></span> <span data-ttu-id="b2b84-216">La aplicación de ejemplo a la que se hace referencia a lo largo de este artículo ( **Azure Search Job Portal Demo** [Demostración del portal de búsqueda de trabajo de Azure Search]) es una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="b2b84-216">The sample application referenced throughout this article -- the **Azure Search Job Portal Demo** – happens to be an ASP.NET MVC application.</span></span>

<span data-ttu-id="b2b84-217">En el ejemplo, la navegación por facetas se integra en la página de resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-217">In the sample, faceted navigation is built into the search results page.</span></span> <span data-ttu-id="b2b84-218">El ejemplo siguiente, tomado del archivo `index.cshtml` de la aplicación de ejemplo, muestra una estructura HTML estática para mostrar la navegación por facetas en la página de resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-218">The following example, taken from the `index.cshtml` file of the sample application, shows the static HTML structure for displaying faceted navigation on the search results page.</span></span> <span data-ttu-id="b2b84-219">La lista de facetas se compila o recompila dinámicamente cuando se envía un término de búsqueda, o cuando se selecciona o borra una faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-219">The list of facets is built or rebuilt dynamically when you submit a search term, or select or clear a facet.</span></span>

```html
<div class="widget sidebar-widget jobs-filter-widget">
  <h5 class="widget-title">Filter Results</h5>
    <p id="filterReset"></p>
    <div class="widget-content">

      <h6 id="businessTitleFacetTitle">Business Title</h6>
      <ul class="filter-list" id="business_title_facets">
      </ul>

      <h6>Location</h6>
      <ul class="filter-list" id="posting_type_facets">
      </ul>

      <h6>Posting Type</h6>
      <ul class="filter-list" id="posting_type_facets"></ul>

      <h6>Minimum Salary</h6>
      <ul class="filter-list" id="salary_range_facets">
      </ul>

  </div>
</div>
```

<span data-ttu-id="b2b84-220">El siguiente fragmento de código desde la página `index.cshtml` compila de forma dinámica el HTML para mostrar la primera faceta, Business Title (cargo empresarial).</span><span class="sxs-lookup"><span data-stu-id="b2b84-220">The following code snippet from the `index.cshtml` page dynamically builds the HTML to display the first facet, Business Title.</span></span> <span data-ttu-id="b2b84-221">Funciones similares compilan dinámicamente el HTML para las otras facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-221">Similar functions dynamically build the HTML for the other facets.</span></span> <span data-ttu-id="b2b84-222">Cada faceta tiene una etiqueta y un recuento, que muestra el número de elementos encontrados para ese resultado de la faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-222">Each facet has a label and a count, which displays the number of items found for that facet result.</span></span>

```js
function UpdateBusinessTitleFacets(data) {
  var facetResultsHTML = '';
  for (var i = 0; i < data.length; i++) {
    facetResultsHTML += '<li><a href="javascript:void(0)" onclick="ChooseBusinessTitleFacet(\'' + data[i].Value + '\');">' + data[i].Value + ' (' + data[i].Count + ')</span></a></li>';
  }

  $("#business_title_facets").html(facetResultsHTML);
}
```

> [!TIP]
> <span data-ttu-id="b2b84-223">Al diseñar la página de resultados de búsqueda, no olvide agregar un mecanismo para borrar las facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-223">When you design the search results page, remember to add a mechanism for clearing facets.</span></span> <span data-ttu-id="b2b84-224">Si agrega casillas de verificación, puede ver fácilmente cómo borrar los filtros.</span><span class="sxs-lookup"><span data-stu-id="b2b84-224">If you add check boxes, you can easily see how to clear the filters.</span></span> <span data-ttu-id="b2b84-225">En otros diseños, puede que necesite un patrón de ruta de navegación u otro enfoque creativo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-225">For other layouts, you might need a breadcrumb pattern or another creative approach.</span></span> <span data-ttu-id="b2b84-226">Por ejemplo, en la aplicación de ejemplo del portal de búsqueda de trabajo, puede hacer clic en `[X]` después de una faceta seleccionada para borrar la faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-226">For example, in the Job Search Portal sample application, you can click the `[X]` after a selected facet to clear the facet.</span></span>

<a name="buildquery"></a>

## <a name="build-the-query"></a><span data-ttu-id="b2b84-227">Crear la consulta</span><span class="sxs-lookup"><span data-stu-id="b2b84-227">Build the query</span></span>
<span data-ttu-id="b2b84-228">El código que se escribe para crear consultas debe especificar todas las partes de una consulta válida, incluidas las expresiones de búsqueda, las facetas o los filtros de puntuación (todo lo que se usa para formular una solicitud).</span><span class="sxs-lookup"><span data-stu-id="b2b84-228">The code that you write for building queries should specify all parts of a valid query, including search expressions, facets, filters, scoring profiles– anything used to formulate a request.</span></span> <span data-ttu-id="b2b84-229">En esta sección, exploraremos cómo encajan las facetas en una consulta y cómo se usan los filtros con facetas para entregar un conjunto de resultados reducido.</span><span class="sxs-lookup"><span data-stu-id="b2b84-229">In this section, we explore where facets fit into a query, and how filters are used with facets to deliver a reduced result set.</span></span>

<span data-ttu-id="b2b84-230">Observe que las facetas son una parte integral de esta aplicación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-230">Notice that facets are integral in this sample application.</span></span> <span data-ttu-id="b2b84-231">La experiencia de búsqueda en la demostración del portal de búsqueda de trabajos está diseñada en torno a los filtros y la navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-231">The search experience in the Job Portal Demo is designed around faceted navigation and filters.</span></span> <span data-ttu-id="b2b84-232">La colocación destacada de navegación por facetas en la página muestra su importancia.</span><span class="sxs-lookup"><span data-stu-id="b2b84-232">The prominent placement of faceted navigation on the page demonstrates its importance.</span></span> 

<span data-ttu-id="b2b84-233">Un ejemplo suele ser una buena manera de comenzar.</span><span class="sxs-lookup"><span data-stu-id="b2b84-233">An example is often a good place to begin.</span></span> <span data-ttu-id="b2b84-234">En el ejemplo siguiente, tomado del archivo `JobsSearch.cs`, se crea una solicitud que crea una navegación por facetas basada en Business Title (cargo empresarial), Location (ubicación), Posting Type (tipo de puesto) y Minimum Salary (salario mínimo).</span><span class="sxs-lookup"><span data-stu-id="b2b84-234">The following example, taken from the `JobsSearch.cs` file, builds a request that creates facet navigation based on Business Title, Location, Posting Type, and Minimum Salary.</span></span> 

```cs
SearchParameters sp = new SearchParameters()
{
  ...
  // Add facets
  Facets = new List<String>() { "business_title", "posting_type", "level", "salary_range_from,interval:50000" },
};
```

<span data-ttu-id="b2b84-235">Un parámetro de consulta de faceta se establece en un campo y, según el tipo de datos, se puede parametrizar aún más con una lista delimitada por comas que incluya `count:<integer>`, `sort:<>`, `interval:<integer>` y `values:<list>`.</span><span class="sxs-lookup"><span data-stu-id="b2b84-235">A facet query parameter is set to a field and depending on the data type, can be further parameterized by comma-delimited list that includes `count:<integer>`, `sort:<>`, `interval:<integer>`, and `values:<list>`.</span></span> <span data-ttu-id="b2b84-236">Se admiten listas de valores para datos numéricos cuando se establecen intervalos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-236">A values list is supported for numeric data when setting up ranges.</span></span> <span data-ttu-id="b2b84-237">Consulte [Buscar documentos (API de Búsqueda de Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx) para obtener más información sobre su uso.</span><span class="sxs-lookup"><span data-stu-id="b2b84-237">See [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx) for usage details.</span></span>

<span data-ttu-id="b2b84-238">Además de las facetas, la solicitud que la aplicación formula también debe generar filtros para reducir el conjunto de documentos candidatos en función de una selección de valores de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-238">Along with facets, the request formulated by your application should also build filters to narrow down the set of candidate documents based on a facet value selection.</span></span> <span data-ttu-id="b2b84-239">Para una tienda de bicicletas, la navegación por facetas proporciona pistas a preguntas como *¿qué colores, fabricantes y tipos de bicicletas están disponibles?*.</span><span class="sxs-lookup"><span data-stu-id="b2b84-239">For a bike store, faceted navigation provides clues to questions like *What colors, manufacturers, and types of bikes are available?*.</span></span> <span data-ttu-id="b2b84-240">El filtrado responde a preguntas como *¿qué bicicletas exactas son rojas, bicicletas de montaña, dentro de este precio de intervalo de precios?*.</span><span class="sxs-lookup"><span data-stu-id="b2b84-240">Filtering answers questions like *Which exact bikes are red, mountain bikes, in this price range?*.</span></span> <span data-ttu-id="b2b84-241">Cuando hace clic en "Red" para indicar que solo se deben mostrar productos de color rojo, la consulta siguiente que la aplicación envía incluye`$filter=Color eq ‘Red’`.</span><span class="sxs-lookup"><span data-stu-id="b2b84-241">When you click "Red" to indicate that only Red products should be shown, the next query the application sends includes `$filter=Color eq ‘Red’`.</span></span>

<span data-ttu-id="b2b84-242">El siguiente fragmento de código de la página `JobsSearch.cs` agrega el cargo empresarial seleccionado al filtro si selecciona un valor de la faceta de Business Title.</span><span class="sxs-lookup"><span data-stu-id="b2b84-242">The following code snippet from the `JobsSearch.cs` page adds the selected Business Title to the filter if you select a value from the Business Title facet.</span></span>

```cs
if (businessTitleFacet != "")
  filter = "business_title eq '" + businessTitleFacet + "'";
```

<a name="tips"></a> 

## <a name="tips-and-best-practices"></a><span data-ttu-id="b2b84-243">Sugerencias y procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="b2b84-243">Tips and best practices</span></span>

### <a name="indexing-tips"></a><span data-ttu-id="b2b84-244">Sugerencias de indexación</span><span class="sxs-lookup"><span data-stu-id="b2b84-244">Indexing tips</span></span>
<span data-ttu-id="b2b84-245">**Mejora de la eficacia del índice si no utiliza un cuadro de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="b2b84-245">**Improve index efficiency if you don't use a Search box**</span></span>

<span data-ttu-id="b2b84-246">Si la aplicación usa navegación por facetas exclusivamente (es decir, ningún cuadro de búsqueda), puede marcar el campo como `searchable=false`, `facetable=true` para generar un índice más compacto.</span><span class="sxs-lookup"><span data-stu-id="b2b84-246">If your application uses faceted navigation exclusively (that is, no search box), you can mark the field as `searchable=false`, `facetable=true` to produce a more compact index.</span></span> <span data-ttu-id="b2b84-247">Además, la indización se produce solo en los valores de faceta completos, sin saltos de palabras ni indización de los componentes de un valor de varias palabras.</span><span class="sxs-lookup"><span data-stu-id="b2b84-247">In addition, indexing occurs only on whole facet values, with no word-break or indexing of the component parts of a multi-word value.</span></span>

<span data-ttu-id="b2b84-248">**Especificación de qué campos se pueden usar como facetas**</span><span class="sxs-lookup"><span data-stu-id="b2b84-248">**Specify which fields can be used as facets**</span></span>

<span data-ttu-id="b2b84-249">Recuerde que el esquema del índice determina qué campos están disponibles para usar como facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-249">Recall that the schema of the index determines which fields are available to use as a facet.</span></span> <span data-ttu-id="b2b84-250">Suponiendo que un campo se pueda usar para la búsqueda por facetas, la consulta especifica qué campos se van a usar para la búsqueda por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-250">Assuming a field is facetable, the query specifies which fields to facet by.</span></span> <span data-ttu-id="b2b84-251">El campo que se va a usar para la búsqueda por facetas proporciona los valores que aparecerán debajo de la etiqueta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-251">The field by which you are faceting provides the values that appear below the label.</span></span> 

<span data-ttu-id="b2b84-252">Los valores que aparecen debajo de cada etiqueta se recuperan del índice.</span><span class="sxs-lookup"><span data-stu-id="b2b84-252">The values that appear under each label are retrieved from the index.</span></span> <span data-ttu-id="b2b84-253">Por ejemplo, si el campo de faceta es *Color*, los valores disponibles para un filtrado adicional son los valores de ese campo (Red, Black, etc.).</span><span class="sxs-lookup"><span data-stu-id="b2b84-253">For example, if the facet field is *Color*, the values available for additional filtering are the values for that field - Red, Black, and so forth.</span></span>

<span data-ttu-id="b2b84-254">Solo para los valores Numeric y DateTime, puede establecer explícitamente valores en el campo de faceta (por ejemplo, `facet=Rating,values:1|2|3|4|5`).</span><span class="sxs-lookup"><span data-stu-id="b2b84-254">For Numeric and DateTime values only, you can explicitly set values on the facet field (for example, `facet=Rating,values:1|2|3|4|5`).</span></span> <span data-ttu-id="b2b84-255">Se permite una lista de valores para estos tipos de campo para simplificar la separación de los resultados de faceta en intervalos contiguos (intervalos basados en valores numéricos o en períodos de tiempo).</span><span class="sxs-lookup"><span data-stu-id="b2b84-255">A values list is allowed for these field types to simplify the separation of facet results into contiguous ranges (either ranges based on numeric values or time periods).</span></span> 

<span data-ttu-id="b2b84-256">**De forma predeterminada solo puede tener un nivel de navegación por facetas**</span><span class="sxs-lookup"><span data-stu-id="b2b84-256">**By default you can only have one level of faceted navigation**</span></span> 

<span data-ttu-id="b2b84-257">Como ya se mencionó, no hay compatibilidad directa para facetas anidadas en una jerarquía.</span><span class="sxs-lookup"><span data-stu-id="b2b84-257">As noted, there is no direct support for nesting facets in a hierarchy.</span></span> <span data-ttu-id="b2b84-258">De forma predeterminada, la navegación por facetas en Azure Search solo admite un nivel de filtros.</span><span class="sxs-lookup"><span data-stu-id="b2b84-258">By default, faceted navigation in Azure Search only supports one level of filters.</span></span> <span data-ttu-id="b2b84-259">Sin embargo, existen soluciones alternativas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-259">However, workarounds do exist.</span></span> <span data-ttu-id="b2b84-260">Puede codificar una estructura jerárquica de facetas en una `Collection(Edm.String)` con un punto de entrada por jerarquía.</span><span class="sxs-lookup"><span data-stu-id="b2b84-260">You can encode a hierarchical facet structure in a `Collection(Edm.String)` with one entry point per hierarchy.</span></span> <span data-ttu-id="b2b84-261">La implementación de esta solución queda fuera del ámbito de este artículo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-261">Implementing this workaround is beyond the scope of this article.</span></span> 

### <a name="querying-tips"></a><span data-ttu-id="b2b84-262">Sugerencias de consulta</span><span class="sxs-lookup"><span data-stu-id="b2b84-262">Querying tips</span></span>
<span data-ttu-id="b2b84-263">**Validar los campos**</span><span class="sxs-lookup"><span data-stu-id="b2b84-263">**Validate fields**</span></span>

<span data-ttu-id="b2b84-264">Si compila la lista de facetas de manera dinámica basándose en la entrada de usuarios que no son de confianza, valide que los nombres de los campos con facetas son válidos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-264">If you build the list of facets dynamically based on untrusted user input, validate that the names of the faceted fields are valid.</span></span> <span data-ttu-id="b2b84-265">O bien, anule los nombres al generar direcciones URL utilizando o bien `Uri.EscapeDataString()` en. NET, o su equivalente en la plataforma que elija.</span><span class="sxs-lookup"><span data-stu-id="b2b84-265">Or, escape the names when building URLs by using either `Uri.EscapeDataString()` in .NET, or the equivalent in your platform of choice.</span></span>

### <a name="filtering-tips"></a><span data-ttu-id="b2b84-266">Sugerencias de filtrado</span><span class="sxs-lookup"><span data-stu-id="b2b84-266">Filtering tips</span></span>
<span data-ttu-id="b2b84-267">**Aumento de la precisión de la búsqueda con filtros**</span><span class="sxs-lookup"><span data-stu-id="b2b84-267">**Increase search precision with filters**</span></span>

<span data-ttu-id="b2b84-268">Use filtros.</span><span class="sxs-lookup"><span data-stu-id="b2b84-268">Use filters.</span></span> <span data-ttu-id="b2b84-269">Si confía solamente en expresiones de búsqueda, la lematización podría provocar que se devuelva un documento que no tiene un valor de faceta preciso en ninguno de sus campos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-269">If you rely on just search expressions alone, stemming could cause a document to be returned that doesn’t have the precise facet value in any of its fields.</span></span>

<span data-ttu-id="b2b84-270">**Aumento del rendimiento de la búsqueda con filtros**</span><span class="sxs-lookup"><span data-stu-id="b2b84-270">**Increase search performance with filters**</span></span>

<span data-ttu-id="b2b84-271">Los filtros restringen el conjunto de documentos candidatos para la búsqueda y los excluyen de la clasificación.</span><span class="sxs-lookup"><span data-stu-id="b2b84-271">Filters narrow down the set of candidate documents for search and exclude them from ranking.</span></span> <span data-ttu-id="b2b84-272">Si tiene un conjunto grande de documentos, usar una profundización por facetas selectiva suele proporcionar un mayor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="b2b84-272">If you have a large set of documents, using a selective facet drill-down often gives you better performance.</span></span>
  
<span data-ttu-id="b2b84-273">**Filtrado solo de campos por facetas**</span><span class="sxs-lookup"><span data-stu-id="b2b84-273">**Filter only the faceted fields**</span></span>

<span data-ttu-id="b2b84-274">En la profundización por facetas, normalmente solo debe incluir los documentos que tienen el valor de faceta en un campo (con faceta) específico, no en cualquiera de todos los campos en los que se puede buscar.</span><span class="sxs-lookup"><span data-stu-id="b2b84-274">In faceted drill-down, you typically want to only include documents that have the facet value in a specific (faceted) field, not anywhere across all searchable fields.</span></span> <span data-ttu-id="b2b84-275">Agregar un filtro refuerza el campo de destino y dirige el servicio para que busque un valor coincidente solo en el campo con faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-275">Adding a filter reinforces the target field by directing the service to search only in the faceted field for a matching value.</span></span>

<span data-ttu-id="b2b84-276">**Recorte de los resultados de faceta con más filtros**</span><span class="sxs-lookup"><span data-stu-id="b2b84-276">**Trim facet results with more filters**</span></span>

<span data-ttu-id="b2b84-277">Los resultados de faceta son documentos que se encuentran en los resultados de búsqueda y que coinciden con un término de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-277">Facet results are documents found in the search results that match a facet term.</span></span> <span data-ttu-id="b2b84-278">En el ejemplo siguiente, en los resultados de búsqueda de *cloud computing*, 254 elementos también tienen *internal specification* como tipo de contenido.</span><span class="sxs-lookup"><span data-stu-id="b2b84-278">In the following example, in search results for *cloud computing*, 254 items also have *internal specification* as a content type.</span></span> <span data-ttu-id="b2b84-279">Los elementos no son necesariamente excluyentes mutuamente.</span><span class="sxs-lookup"><span data-stu-id="b2b84-279">Items are not necessarily mutually exclusive.</span></span> <span data-ttu-id="b2b84-280">Si un elemento cumple los criterios de ambos filtros, se contabiliza en cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-280">If an item meets the criteria of both filters, it is counted in each one.</span></span> <span data-ttu-id="b2b84-281">Esta duplicación es posible cuando se usan facetas en campos `Collection(Edm.String)`, que suelen usarse para implementar el etiquetado de documentos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-281">This duplication is possible when faceting on `Collection(Edm.String)` fields, which are often used to implement document tagging.</span></span>

        Search term: "cloud computing"
        Content type
           Internal specification (254)
           Video (10) 

<span data-ttu-id="b2b84-282">En general, si encuentra que los resultados de faceta son demasiado grandes de forma persistente, se recomienda agregar más filtros para ofrecer a los usuarios más opciones para delimitar la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-282">In general, if you find that facet results are consistently too large, we recommend that you add more filters to give users more options for narrowing the search.</span></span>

### <a name="tips-about-result-count"></a><span data-ttu-id="b2b84-283">Sugerencias sobre el recuento de resultados</span><span class="sxs-lookup"><span data-stu-id="b2b84-283">Tips about result count</span></span>

<span data-ttu-id="b2b84-284">**Limitación del número de elementos en la navegación por facetas**</span><span class="sxs-lookup"><span data-stu-id="b2b84-284">**Limit the number of items in the facet navigation**</span></span>

<span data-ttu-id="b2b84-285">Para cada campo de faceta del árbol de navegación, hay un límite predeterminado de 10 valores.</span><span class="sxs-lookup"><span data-stu-id="b2b84-285">For each faceted field in the navigation tree, there is a default limit of 10 values.</span></span> <span data-ttu-id="b2b84-286">Este valor predeterminado tiene sentido en las estructuras de navegación porque mantiene la lista de valores en un tamaño fácil de administrar.</span><span class="sxs-lookup"><span data-stu-id="b2b84-286">This default makes sense for navigation structures because it keeps the values list to a manageable size.</span></span> <span data-ttu-id="b2b84-287">Puede invalidar el valor predeterminado y asignar un valor a count.</span><span class="sxs-lookup"><span data-stu-id="b2b84-287">You can override the default by assigning a value to count.</span></span>

* <span data-ttu-id="b2b84-288">`&facet=city,count:5` especifica que solo se devuelven como resultado de la faceta las cinco primeras ciudades encontradas en los principales resultados.</span><span class="sxs-lookup"><span data-stu-id="b2b84-288">`&facet=city,count:5` specifies that only the first five cities found in the top ranked results are returned as a facet result.</span></span> <span data-ttu-id="b2b84-289">Considere una consulta de ejemplo con un término de búsqueda "aeropuerto" y 32 coincidencias.</span><span class="sxs-lookup"><span data-stu-id="b2b84-289">Consider a sample query with a search term of “airport” and 32 matches.</span></span> <span data-ttu-id="b2b84-290">Si la consulta especifica `&facet=city,count:5`, solo se incluyen en los resultados de la faceta las primeras cinco ciudades con más documentos en los resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-290">If the query specifies `&facet=city,count:5`, only the first five unique cities with the most documents in the search results are included in the facet results.</span></span>

<span data-ttu-id="b2b84-291">Observe la diferencia entre resultados de búsqueda y resultados de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-291">Notice the distinction between facet results and search results.</span></span> <span data-ttu-id="b2b84-292">Los resultados de búsqueda son todos los documentos que coinciden con la consulta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-292">Search results are all the documents that match the query.</span></span> <span data-ttu-id="b2b84-293">Los resultados de faceta son las coincidencias para cada valor de la faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-293">Facet results are the matches for each facet value.</span></span> <span data-ttu-id="b2b84-294">En el ejemplo, los resultados de búsqueda incluyen los nombres de ciudades que no están en la lista de clasificación de faceta (5 en nuestro ejemplo).</span><span class="sxs-lookup"><span data-stu-id="b2b84-294">In the example, search results include City names that are not in the facet classification list (5 in our example).</span></span> <span data-ttu-id="b2b84-295">Los resultados que se filtran mediante la navegación por facetas son visibles cuando se borran las facetas o se eligen otras facetas además de City.</span><span class="sxs-lookup"><span data-stu-id="b2b84-295">Results that are filtered out through faceted navigation become visible when you clear facets, or choose other facets besides City.</span></span> 

> [!NOTE]
> <span data-ttu-id="b2b84-296">Analizar `count` cuando hay más de un tipo puede ser confuso.</span><span class="sxs-lookup"><span data-stu-id="b2b84-296">Discussing `count` when there is more than one type can be confusing.</span></span> <span data-ttu-id="b2b84-297">En la tabla siguiente se ofrece un breve resumen de cómo se usa el término en la API de Búsqueda de Azure así como código de ejemplo y documentación.</span><span class="sxs-lookup"><span data-stu-id="b2b84-297">The following table offers a brief summary of how the term is used in Azure Search API, sample code, and documentation.</span></span> 

* `@colorFacet.count`<br/>
  <span data-ttu-id="b2b84-298">En el código de presentación, verá un parámetro count en la faceta, que se usa para mostrar el número de resultados de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-298">In presentation code, you should see a count parameter on the facet, used to display the number of facet results.</span></span> <span data-ttu-id="b2b84-299">En los resultados de faceta, count indica el número de documentos que coinciden con el término de faceta o con el intervalo de facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-299">In facet results, count indicates the number of documents that match on the facet term or range.</span></span>
* `&facet=City,count:12`<br/>
  <span data-ttu-id="b2b84-300">En una consulta de faceta, puede establecer count en un valor.</span><span class="sxs-lookup"><span data-stu-id="b2b84-300">In a facet query, you can set count to a value.</span></span>  <span data-ttu-id="b2b84-301">El valor predeterminado es 10, pero puede establecer uno inferior o superior.</span><span class="sxs-lookup"><span data-stu-id="b2b84-301">The default is 10, but you can set it higher or lower.</span></span> <span data-ttu-id="b2b84-302">Al establecer `count:12` se obtienen las 12 principales coincidencias en los resultados de faceta por recuento de documentos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-302">Setting `count:12` gets the top 12 matches in facet results by document count.</span></span>
* <span data-ttu-id="b2b84-303">"`@odata.count`"</span><span class="sxs-lookup"><span data-stu-id="b2b84-303">"`@odata.count`"</span></span><br/>
  <span data-ttu-id="b2b84-304">En la respuesta de la consulta, este valor indica el número de elementos coincidentes en los resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-304">In the query response, this value indicates the number of matching items in the search results.</span></span> <span data-ttu-id="b2b84-305">Por término medio, es mayor que la suma de todos los resultados de faceta combinados, debido a la presencia de elementos que coinciden con el término de búsqueda pero con ninguno de los valores de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-305">On average, it’s larger than the sum of all facet results combined, due to the presence of items that match the search term, but have no facet value matches.</span></span>

<span data-ttu-id="b2b84-306">**Obtención de recuentos en los resultados de faceta**</span><span class="sxs-lookup"><span data-stu-id="b2b84-306">**Get counts in facet results**</span></span>

<span data-ttu-id="b2b84-307">Al agregar un filtro a una consulta por facetas, quizás quiera conservar la instrucción facet (por ejemplo, `facet=Rating&$filter=Rating ge 4`).</span><span class="sxs-lookup"><span data-stu-id="b2b84-307">When you add a filter to a faceted query, you might want to retain the facet statement (for example, `facet=Rating&$filter=Rating ge 4`).</span></span> <span data-ttu-id="b2b84-308">Técnicamente, facet=Rating no es necesaria, pero conservarla devuelve los recuentos de los valores de faceta para las valoraciones de 4 y superiores.</span><span class="sxs-lookup"><span data-stu-id="b2b84-308">Technically, facet=Rating isn’t needed, but keeping it returns the counts of facet values for ratings 4 and higher.</span></span> <span data-ttu-id="b2b84-309">Por ejemplo, si hace clic en "4" y la consulta incluye un filtro para valores mayores o iguales que "4", se devuelven los recuentos de valoraciones de 4 y superiores.</span><span class="sxs-lookup"><span data-stu-id="b2b84-309">For example, if you click "4" and the query includes a filter for greater or equal to "4", counts are returned for each rating that is 4 and higher.</span></span>  

<span data-ttu-id="b2b84-310">**Garantía de obtención de recuentos de faceta adecuados**</span><span class="sxs-lookup"><span data-stu-id="b2b84-310">**Make sure you get accurate facet counts**</span></span>

<span data-ttu-id="b2b84-311">En determinadas circunstancias, puede que vea que los recuentos de faceta no coinciden con los conjuntos de resultados (consulte [Navegación por facetas en Búsqueda de Azure (publicación del foro)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span><span class="sxs-lookup"><span data-stu-id="b2b84-311">Under certain circumstances, you might find that facet counts do not match the result sets (see [Faceted navigation in Azure Search (forum post)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span></span>

<span data-ttu-id="b2b84-312">Los recuentos de faceta pueden ser incorrectos debido a la arquitectura de particionamiento.</span><span class="sxs-lookup"><span data-stu-id="b2b84-312">Facet counts can be inaccurate due to the sharding architecture.</span></span> <span data-ttu-id="b2b84-313">Cada índice de búsqueda tiene varias particiones, y cada una notifica las N primeras facetas por recuento de documentos, que después se combina en un único resultado.</span><span class="sxs-lookup"><span data-stu-id="b2b84-313">Every search index has multiple shards, and each shard reports the top N facets by document count, which is then combined into a single result.</span></span> <span data-ttu-id="b2b84-314">Si algunas particiones tienen muchos valores coincidentes, mientras que otros tienen menos, verá que algunos valores de faceta faltan o se contabilizan con un número inferior en los resultados.</span><span class="sxs-lookup"><span data-stu-id="b2b84-314">If some shards have many matching values, while others have fewer, you may find that some facet values are missing or under-counted in the results.</span></span>

<span data-ttu-id="b2b84-315">Aunque este comportamiento podría cambiar en cualquier momento, si se produce en la actualidad puede solucionarlo aumentando artificialmente el valor de count:<number> en un número grande para forzar que se notifique el valor completo de cada partición.</span><span class="sxs-lookup"><span data-stu-id="b2b84-315">Although this behavior could change at any time, if you encounter this behavior today, you can work around it by artificially inflating the count:<number> to a large number to enforce full reporting from each shard.</span></span> <span data-ttu-id="b2b84-316">Si el valor de count: es mayor o igual que el número de valores únicos en el campo, se garantizan resultados precisos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-316">If the value of count: is greater than or equal to the number of unique values in the field, you are guaranteed accurate results.</span></span> <span data-ttu-id="b2b84-317">Sin embargo, si el recuento de documentos es alto, esto afecta al rendimiento, por lo que debe usar esta opción con prudencia.</span><span class="sxs-lookup"><span data-stu-id="b2b84-317">However, when document counts are high, there is a performance penalty, so use this option judiciously.</span></span>

### <a name="user-interface-tips"></a><span data-ttu-id="b2b84-318">Sugerencias de interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="b2b84-318">User interface tips</span></span>
<span data-ttu-id="b2b84-319">**Agregar etiquetas para cada campo en la navegación por facetas**</span><span class="sxs-lookup"><span data-stu-id="b2b84-319">**Add labels for each field in facet navigation**</span></span>

<span data-ttu-id="b2b84-320">Las etiquetas suelen definirse en el HTML o formulario (`index.cshtml` en la aplicación de ejemplo).</span><span class="sxs-lookup"><span data-stu-id="b2b84-320">Labels are typically defined in the HTML or form (`index.cshtml` in the sample application).</span></span> <span data-ttu-id="b2b84-321">No hay ninguna API en Azure Search para las etiquetas de navegación por facetas u otros tipos de metadatos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-321">There is no API in Azure Search for facet navigation labels or any other metadata.</span></span>

<a name="rangefacets"></a>

## <a name="filter-based-on-a-range"></a><span data-ttu-id="b2b84-322">Filtro basado en un intervalo</span><span class="sxs-lookup"><span data-stu-id="b2b84-322">Filter based on a range</span></span>
<span data-ttu-id="b2b84-323">El uso de facetas en intervalos de valores es un requisito habitual de las aplicaciones de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-323">Faceting over ranges of values is a common search application requirement.</span></span> <span data-ttu-id="b2b84-324">Se admiten intervalos para datos numéricos y valores de fecha y hora.</span><span class="sxs-lookup"><span data-stu-id="b2b84-324">Ranges are supported for numeric data and DateTime values.</span></span> <span data-ttu-id="b2b84-325">Puede leer más acerca de cada enfoque en [Buscar documentos (API de Búsqueda de Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span><span class="sxs-lookup"><span data-stu-id="b2b84-325">You can read more about each approach in [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span></span>

<span data-ttu-id="b2b84-326">Búsqueda de Azure simplifica la construcción de intervalos mediante dos enfoques de cálculo de intervalos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-326">Azure Search simplifies range construction by providing two approaches for computing a range.</span></span> <span data-ttu-id="b2b84-327">En ambos enfoques, Búsqueda de Azure crea los intervalos adecuados con las entradas proporcionadas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-327">For both approaches, Azure Search creates the appropriate ranges given the inputs you’ve provided.</span></span> <span data-ttu-id="b2b84-328">Por ejemplo, si especifica valores de intervalo de 10|20|30, creará automáticamente los intervalos 0-10, 10-20, 20-30.</span><span class="sxs-lookup"><span data-stu-id="b2b84-328">For instance, if you specify range values of 10|20|30, it automatically creates ranges of 0-10, 10-20, 20-30.</span></span> <span data-ttu-id="b2b84-329">La aplicación tiene la opción de quitar los intervalos que estén vacíos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-329">Your application can optionally remove any intervals that are empty.</span></span> 

<span data-ttu-id="b2b84-330">**Enfoque 1: Usar el parámetro de intervalo**</span><span class="sxs-lookup"><span data-stu-id="b2b84-330">**Approach 1: Use the interval parameter**</span></span>  
<span data-ttu-id="b2b84-331">Para establecer las facetas de precio en incrementos de 10 USD, especificaría: `&facet=price,interval:10`</span><span class="sxs-lookup"><span data-stu-id="b2b84-331">To set price facets in $10 increments, you would specify: `&facet=price,interval:10`</span></span>

<span data-ttu-id="b2b84-332">**Enfoque 2: Usar una lista de valores**</span><span class="sxs-lookup"><span data-stu-id="b2b84-332">**Approach 2: Use a values list**</span></span>  
<span data-ttu-id="b2b84-333">Para datos numéricos, puede usar una lista de valores.</span><span class="sxs-lookup"><span data-stu-id="b2b84-333">For numeric data, you can use a values list.</span></span>  <span data-ttu-id="b2b84-334">Tenga en cuenta el intervalo de facetas para un campo `listPrice`, que se representa como sigue:</span><span class="sxs-lookup"><span data-stu-id="b2b84-334">Consider the facet range for a `listPrice` field, rendered as follows:</span></span>

  ![Lista de valores de ejemplo][5]

<span data-ttu-id="b2b84-336">Para especificar un intervalo de faceta semejante al de la captura de pantalla anterior, use una lista de valores:</span><span class="sxs-lookup"><span data-stu-id="b2b84-336">To specify a facet range like the one in the preceding screen shot, use a values list:</span></span>

    facet=listPrice,values:10|25|100|500|1000|2500

<span data-ttu-id="b2b84-337">Cada intervalo se genera usando 0 como punto de partida, un valor de la lista como extremo y, después, se recorta el intervalo anterior para crear diferentes intervalos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-337">Each range is built using 0 as a starting point, a value from the list as an endpoint, and then trimmed of the previous range to create discrete intervals.</span></span> <span data-ttu-id="b2b84-338">Azure Search hace esto como parte de la navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-338">Azure Search does these things as part of faceted navigation.</span></span> <span data-ttu-id="b2b84-339">No es necesario escribir código para estructurar cada intervalo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-339">You do not have to write code for structuring each interval.</span></span>

### <a name="build-a-filter-for-a-range"></a><span data-ttu-id="b2b84-340">Creación de un filtro para un intervalo</span><span class="sxs-lookup"><span data-stu-id="b2b84-340">Build a filter for a range</span></span>
<span data-ttu-id="b2b84-341">Para filtrar los documentos según un intervalo que seleccione, puede usar los operadores de filtro `"ge"` y `"lt"` en una expresión de dos partes que define los puntos de conexión del intervalo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-341">To filter documents based on a range you select, you can use the `"ge"` and `"lt"` filter operators in a two-part expression that defines the endpoints of the range.</span></span> <span data-ttu-id="b2b84-342">Por ejemplo, si elige el intervalo de 10 a 25 para un campo `listPrice`, el filtro sería `$filter=listPrice ge 10 and listPrice lt 25`.</span><span class="sxs-lookup"><span data-stu-id="b2b84-342">For example, if you choose the range 10-25 for a `listPrice` field, the filter would be `$filter=listPrice ge 10 and listPrice lt 25`.</span></span> <span data-ttu-id="b2b84-343">En el código de ejemplo, la expresión de filtro usa los parámetros **priceFrom** y **priceTo** para establecer los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="b2b84-343">In the sample code, the filter expression uses **priceFrom** and **priceTo** parameters to set the endpoints.</span></span> 

  ![Consulta para un intervalo de valores][6]

<a name="geofacets"></a> 

## <a name="filter-based-on-distance"></a><span data-ttu-id="b2b84-345">Filtro basado en la distancia</span><span class="sxs-lookup"><span data-stu-id="b2b84-345">Filter based on distance</span></span>
<span data-ttu-id="b2b84-346">Es habitual ver filtros que ayudan a elegir una tienda, un restaurante o un destino en función de su proximidad a la ubicación actual.</span><span class="sxs-lookup"><span data-stu-id="b2b84-346">It’s common to see filters that help you choose a store, restaurant, or destination based on its proximity to your current location.</span></span> <span data-ttu-id="b2b84-347">Aunque este tipo de filtro puede parecer una navegación por facetas, en realidad es solo un filtro.</span><span class="sxs-lookup"><span data-stu-id="b2b84-347">While this type of filter might look like faceted navigation, it’s just a filter.</span></span> <span data-ttu-id="b2b84-348">Lo mencionamos aquí para aquellos que buscan específicamente consejos de implementación para ese problema de diseño concreto.</span><span class="sxs-lookup"><span data-stu-id="b2b84-348">We mention it here for those of you who are specifically looking for implementation advice for that particular design problem.</span></span>

<span data-ttu-id="b2b84-349">Hay dos funciones geoespaciales en Azure Search, **geo.distance** y **geo.intersects**.</span><span class="sxs-lookup"><span data-stu-id="b2b84-349">There are two Geospatial functions in Azure Search, **geo.distance** and **geo.intersects**.</span></span>

* <span data-ttu-id="b2b84-350">La función **geo.distance** devuelve la distancia en kilómetros entre dos puntos.</span><span class="sxs-lookup"><span data-stu-id="b2b84-350">The **geo.distance** function returns the distance in kilometers between two points.</span></span> <span data-ttu-id="b2b84-351">Un punto es un campo y otra es una constante que se pasa como parte del filtro.</span><span class="sxs-lookup"><span data-stu-id="b2b84-351">One point is a field and other is a constant passed as part of the filter.</span></span> 
* <span data-ttu-id="b2b84-352">La función **geo.intersects** devuelve true si un punto determinado se encuentra dentro de un polígono determinado.</span><span class="sxs-lookup"><span data-stu-id="b2b84-352">The **geo.intersects** function returns true if a given point is within a given polygon.</span></span> <span data-ttu-id="b2b84-353">El punto es un campo y el polígono se especifica como una lista constante de coordenadas que se pasa como parte del filtro.</span><span class="sxs-lookup"><span data-stu-id="b2b84-353">The point is a field and the polygon is specified as a constant list of coordinates passed as part of the filter.</span></span>

<span data-ttu-id="b2b84-354">Puede encontrar ejemplos de filtros en [Sintaxis de expresiones de OData (Búsqueda de Azure)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span><span class="sxs-lookup"><span data-stu-id="b2b84-354">You can find filter examples in [OData expression syntax (Azure Search)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span></span>

<a name="tryitout"></a>

## <a name="try-the-demo"></a><span data-ttu-id="b2b84-355">Prueba de la demostración</span><span class="sxs-lookup"><span data-stu-id="b2b84-355">Try the demo</span></span>
<span data-ttu-id="b2b84-356">La demostración de Azure Search Job Portal contiene los ejemplos a los que se hace referencia en este artículo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-356">The Azure Search Job Portal Demo contains the examples referenced in this article.</span></span>

-   <span data-ttu-id="b2b84-357">Vea y pruebe la demostración de trabajo en línea en [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/) (Demostración del portal de búsqueda de trabajo de Azure Search).</span><span class="sxs-lookup"><span data-stu-id="b2b84-357">See and test the working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="b2b84-358">Descargue el código del [repositorio de ejemplos de Azure en GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="b2b84-358">Download the code from the [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

<span data-ttu-id="b2b84-359">Cuando trabaje con los resultados de búsqueda, vigile los posibles cambios en las direcciones URL en la construcción de la consulta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-359">As you work with search results, watch the URL for changes in query construction.</span></span> <span data-ttu-id="b2b84-360">Esta aplicación anexa facetas al URI a medida que las selecciona.</span><span class="sxs-lookup"><span data-stu-id="b2b84-360">This application happens to append facets to the URI as you select each one.</span></span>

1. <span data-ttu-id="b2b84-361">Para usar la funcionalidad de asignación de la aplicación de demostración, obtenga una clave de Bing Maps en [Bing Maps Dev Center](https://www.bingmapsportal.com/) (Centro para desarrolladores de Bing Maps).</span><span class="sxs-lookup"><span data-stu-id="b2b84-361">To use the mapping functionality of the demo app, get a Bing Maps key from the [Bing Maps Dev Center](https://www.bingmapsportal.com/).</span></span> <span data-ttu-id="b2b84-362">Pegue sobre la clave existente en la página `index.cshtml`.</span><span class="sxs-lookup"><span data-stu-id="b2b84-362">Paste it over the existing key in the `index.cshtml` page.</span></span> <span data-ttu-id="b2b84-363">El ajuste `BingApiKey` en el archivo `Web.config` no se utiliza.</span><span class="sxs-lookup"><span data-stu-id="b2b84-363">The `BingApiKey` setting in the `Web.config` file is not used.</span></span> 

2. <span data-ttu-id="b2b84-364">Ejecute la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b2b84-364">Run the application.</span></span> <span data-ttu-id="b2b84-365">Dese el paseo opcional o descarte el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="b2b84-365">Take the optional tour, or dismiss the dialog box.</span></span>
   
3. <span data-ttu-id="b2b84-366">Escriba un término de búsqueda, como "analyst" y haga clic en el icono de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b2b84-366">Enter a search term, such as "analyst", and click the Search icon.</span></span> <span data-ttu-id="b2b84-367">La consulta se ejecuta rápidamente.</span><span class="sxs-lookup"><span data-stu-id="b2b84-367">The query executes quickly.</span></span>
   
   <span data-ttu-id="b2b84-368">Con los resultados de búsqueda se devuelve también una estructura de navegación por facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-368">A faceted navigation structure is also returned with the search results.</span></span> <span data-ttu-id="b2b84-369">En la página de resultados de búsqueda, la estructura de navegación por facetas incluye los recuentos de cada resultado de faceta.</span><span class="sxs-lookup"><span data-stu-id="b2b84-369">In the search result page, the faceted navigation structure includes counts for each facet result.</span></span> <span data-ttu-id="b2b84-370">No hay facetas seleccionadas, por lo que se devuelven todos los resultados de búsqueda que coinciden.</span><span class="sxs-lookup"><span data-stu-id="b2b84-370">No facets are selected, so all matching results are returned.</span></span>
   
   ![Resultados de la búsqueda antes de seleccionar las facetas][11]

4. <span data-ttu-id="b2b84-372">Haga clic en un Business Title (cargo empresarial), Location (ubicación) o Minimum Salary (salario mínimo).</span><span class="sxs-lookup"><span data-stu-id="b2b84-372">Click a Business Title, Location, or Minimum Salary.</span></span> <span data-ttu-id="b2b84-373">Las facetas son NULL en la búsqueda inicial, pero a medida que toman valores, en los resultados de búsqueda se recortan los elementos que ya no coinciden.</span><span class="sxs-lookup"><span data-stu-id="b2b84-373">Facets were null on the initial search, but as they take on values, the search results are trimmed of items that no longer match.</span></span>
   
   ![Resultados de la búsqueda después de seleccionar las facetas][12]

5. <span data-ttu-id="b2b84-375">Para borrar la consulta por facetas para poder probar comportamientos de consulta diferentes, haga clic en `[X]` después de las facetas seleccionadas para borrar las facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-375">To clear the faceted query so that you can try different query behaviors, click the `[X]` after the selected facets to clear the facets.</span></span>
   
<a name="nextstep"></a>

## <a name="learn-more"></a><span data-ttu-id="b2b84-376">Más información</span><span class="sxs-lookup"><span data-stu-id="b2b84-376">Learn more</span></span>
<span data-ttu-id="b2b84-377">Vea el vídeo de [profundización en Azure Search](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410).</span><span class="sxs-lookup"><span data-stu-id="b2b84-377">Watch [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410).</span></span> <span data-ttu-id="b2b84-378">En el minuto 45:25, hay una demostración sobre cómo implementar las facetas.</span><span class="sxs-lookup"><span data-stu-id="b2b84-378">At 45:25, there is a demo on how to implement facets.</span></span>

<span data-ttu-id="b2b84-379">Para obtener más información sobre los principios de diseño de la navegación por facetas, recomendamos los siguientes vínculos:</span><span class="sxs-lookup"><span data-stu-id="b2b84-379">For more insights on design principles for faceted navigation, we recommend the following links:</span></span>

* [<span data-ttu-id="b2b84-380">Diseñar para la búsqueda por facetas</span><span class="sxs-lookup"><span data-stu-id="b2b84-380">Designing for Faceted Search</span></span>](http://www.uie.com/articles/faceted_search/)
* [<span data-ttu-id="b2b84-381">Patrones de diseño: Navegación por facetas</span><span class="sxs-lookup"><span data-stu-id="b2b84-381">Design Patterns: Faceted Navigation</span></span>](http://alistapart.com/article/design-patterns-faceted-navigation)


<!--Anchors-->
[How to build it]: #howtobuildit
[Build the presentation layer]: #presentationlayer
[Build the index]: #buildindex
[Check for data quality]: #checkdata
[Build the query]: #buildquery
[Tips on how to control faceted navigation]: #tips
[Faceted navigation based on range values]: #rangefacets
[Faceted navigation based on GeoPoints]: #geofacets
[Try it out]: #tryitout

<!--Image references-->
[1]: ./media/search-faceted-navigation/azure-search-faceting-example.PNG
[2]: ./media/search-faceted-navigation/Facet-2-CSHTML.PNG
[3]: ./media/search-faceted-navigation/Facet-3-schema.PNG
[4]: ./media/search-faceted-navigation/Facet-4-SearchMethod.PNG
[5]: ./media/search-faceted-navigation/Facet-5-Prices.PNG
[6]: ./media/search-faceted-navigation/Facet-6-buildfilter.PNG
[7]: ./media/search-faceted-navigation/Facet-7-appstart.png
[8]: ./media/search-faceted-navigation/Facet-8-appbike.png
[9]: ./media/search-faceted-navigation/Facet-9-appbikefaceted.png
[10]: ./media/search-faceted-navigation/Facet-10-appTitle.png
[11]: ./media/search-faceted-navigation/faceted-search-before-facets.png
[12]: ./media/search-faceted-navigation/faceted-search-after-facets.png

<!--Link references-->
[Designing for Faceted Search]: http://www.uie.com/articles/faceted_search/
[Design Patterns: Faceted Navigation]: http://alistapart.com/article/design-patterns-faceted-navigation
[Create your first application]: search-create-first-solution.md
[OData expression syntax (Azure Search)]: http://msdn.microsoft.com/library/azure/dn798921.aspx
[Azure Search Adventure Works Demo]: https://azuresearchadventureworksdemo.codeplex.com/
[http://www.odata.org/documentation/odata-version-2-0/overview/]: http://www.odata.org/documentation/odata-version-2-0/overview/ 
[Faceting on Azure Search forum post]: ../faceting-on-azure-search.md?forum=azuresearch
[Search Documents (Azure Search API)]: http://msdn.microsoft.com/library/azure/dn798927.aspx

