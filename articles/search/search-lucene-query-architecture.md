---
title: "Arquitectura del motor de búsqueda de texto completo en Azure Search | Microsoft Docs"
description: "Explicación de conceptos de recuperación de documentos y procesamiento de consultas de Lucene para la búsqueda de texto completo, como se establece en Azure Search."
services: search
manager: jhubbard
author: yahnoosh
documentationcenter: 
ms.service: search
ms.devlang: NA
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 04/06/2017
ms.author: jlembicz
ms.openlocfilehash: 9b7adf78271407963ed1d4b34a7760d707b5fc3a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="how-full-text-search-works-in-azure-search"></a><span data-ttu-id="83a2a-103">Cómo funciona la búsqueda de texto completo en Azure Search</span><span class="sxs-lookup"><span data-stu-id="83a2a-103">How full text search works in Azure Search</span></span>

<span data-ttu-id="83a2a-104">Este artículo está dirigido a desarrolladores que necesitan un conocimiento más profundo sobre cómo funciona la búsqueda de texto completo de Lucene en Azure Search.</span><span class="sxs-lookup"><span data-stu-id="83a2a-104">This article is for developers who need a deeper understanding of how Lucene full text search works in Azure Search.</span></span> <span data-ttu-id="83a2a-105">Para las consultas de texto, Azure Search ofrecerá perfectamente resultados esperados en la mayoría de los escenarios, pero en ocasiones, podría obtener un resultado que parezca "desconectado" de algún modo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-105">For text queries, Azure Search will seamlessly deliver expected results in most scenarios, but occasionally you might get a result that seems "off" somehow.</span></span> <span data-ttu-id="83a2a-106">En estas situaciones, tener experiencia en las cuatro fases de ejecución de la consulta de Lucene (análisis de consulta, análisis léxico, coincidencia de búsqueda y puntuación) puede ayudar a identificar los cambios específicos en la configuración del índice y los parámetros de la consulta que proporcionarán el resultado deseado.</span><span class="sxs-lookup"><span data-stu-id="83a2a-106">In these situations, having a background in the four stages of Lucene query execution (query parsing, lexical analysis, document matching, scoring) can help you identify specific changes to query parameters or index configuration that will deliver the desired outcome.</span></span> 

> [!Note] 
> <span data-ttu-id="83a2a-107">Azure Search usa Lucene para la búsqueda de texto completo, pero la integración de Lucene no es exhaustiva.</span><span class="sxs-lookup"><span data-stu-id="83a2a-107">Azure Search uses Lucene for full text search, but Lucene integration is not exhaustive.</span></span> <span data-ttu-id="83a2a-108">Exponemos y ampliamos selectivamente la funcionalidad de Lucene para habilitar escenarios importantes en Azure Search.</span><span class="sxs-lookup"><span data-stu-id="83a2a-108">We selectively expose and extend Lucene functionality to enable the scenarios important to Azure Search.</span></span> 

## <a name="architecture-overview-and-diagram"></a><span data-ttu-id="83a2a-109">Introducción a la arquitectura y diagrama</span><span class="sxs-lookup"><span data-stu-id="83a2a-109">Architecture overview and diagram</span></span>

<span data-ttu-id="83a2a-110">El procesamiento de una consulta de búsqueda de texto completo empieza analizando el texto de consulta para extraer los términos de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-110">Processing a full text search query starts with parsing the query text to extract search terms.</span></span> <span data-ttu-id="83a2a-111">El motor de búsqueda utiliza un índice para recuperar documentos con los términos de coincidencia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-111">The search engine uses an index to retrieve documents with matching terms.</span></span> <span data-ttu-id="83a2a-112">Los términos de consulta individuales a veces se dividen y reconstituyen en nuevas formas para convertir una red más amplia sobre la que pueda considerarse una posible coincidencia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-112">Individual query terms are sometimes broken down and reconstituted into new forms to cast a broader net over what could be considered as a potential match.</span></span> <span data-ttu-id="83a2a-113">Un conjunto de resultados se ordena mediante una puntuación de importancia asignada a cada documento de coincidencia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-113">A result set is then sorted by a relevance score assigned to each individual matching document.</span></span> <span data-ttu-id="83a2a-114">Los que se encuentran en la parte superior de la lista de clasificación se devuelven a la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="83a2a-114">Those at the top of the ranked list are returned to the calling application.</span></span>

<span data-ttu-id="83a2a-115">Una vez reformulada, la ejecución de la consulta tiene cuatro fases:</span><span class="sxs-lookup"><span data-stu-id="83a2a-115">Restated, query execution has four stages:</span></span> 

1. <span data-ttu-id="83a2a-116">Consulta de análisis</span><span class="sxs-lookup"><span data-stu-id="83a2a-116">Query parsing</span></span> 
2. <span data-ttu-id="83a2a-117">Análisis léxico</span><span class="sxs-lookup"><span data-stu-id="83a2a-117">Lexical analysis</span></span> 
3. <span data-ttu-id="83a2a-118">Recuperación de documentos</span><span class="sxs-lookup"><span data-stu-id="83a2a-118">Document retrieval</span></span> 
4. <span data-ttu-id="83a2a-119">Puntuación</span><span class="sxs-lookup"><span data-stu-id="83a2a-119">Scoring</span></span> 

<span data-ttu-id="83a2a-120">El diagrama siguiente muestra los componentes que se utilizan para procesar una solicitud de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-120">The diagram below illustrates the components used to process a search request.</span></span> 

 ![Diagrama de la arquitectura de la consulta de Lucene en Azure Search][1]


| <span data-ttu-id="83a2a-122">Componentes claves</span><span class="sxs-lookup"><span data-stu-id="83a2a-122">Key components</span></span> | <span data-ttu-id="83a2a-123">Descripción funcional</span><span class="sxs-lookup"><span data-stu-id="83a2a-123">Functional description</span></span> | 
|----------------|------------------------|
|<span data-ttu-id="83a2a-124">**Analizadores de consulta**</span><span class="sxs-lookup"><span data-stu-id="83a2a-124">**Query parsers**</span></span> | <span data-ttu-id="83a2a-125">Separe los términos de consulta de los operadores de consulta y cree la estructura de consulta (un árbol de consulta) que enviar al motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-125">Separate query terms from query operators and create the query structure (a query tree) to be sent to the search engine.</span></span> |
|<span data-ttu-id="83a2a-126">**Analizadores**</span><span class="sxs-lookup"><span data-stu-id="83a2a-126">**Analyzers**</span></span> | <span data-ttu-id="83a2a-127">Realice un análisis léxico sobre los términos de consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-127">Perform lexical analysis on query terms.</span></span> <span data-ttu-id="83a2a-128">Este proceso puede implicar la transformación, eliminación o expansión de los términos de consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-128">This process can involve transforming, removing, or expanding of query terms.</span></span> |
|<span data-ttu-id="83a2a-129">**Índice**</span><span class="sxs-lookup"><span data-stu-id="83a2a-129">**Index**</span></span> | <span data-ttu-id="83a2a-130">Una estructura de datos eficiente usada para almacenar y organizar términos que pueden buscarse extraídos de documentos indexados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-130">An efficient data structure used to store and organize searchable terms extracted from indexed documents.</span></span> |
|<span data-ttu-id="83a2a-131">**Motor de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="83a2a-131">**Search engine**</span></span> | <span data-ttu-id="83a2a-132">Recupera y puntúa los documentos coincidentes en función del contenido del índice invertido.</span><span class="sxs-lookup"><span data-stu-id="83a2a-132">Retrieves and scores matching documents based on the contents of the inverted index.</span></span> |

## <a name="anatomy-of-a-search-request"></a><span data-ttu-id="83a2a-133">Anatomía de una solicitud de búsqueda</span><span class="sxs-lookup"><span data-stu-id="83a2a-133">Anatomy of a search request</span></span>

<span data-ttu-id="83a2a-134">Una solicitud de búsqueda es una especificación completa de lo que se debe devolver en un conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-134">A search request is a complete specification of what should be returned in a result set.</span></span> <span data-ttu-id="83a2a-135">En su forma más simple, es una consulta vacía sin ningún criterio de ningún tipo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-135">In simplest form, it is an empty query with no criteria of any kind.</span></span> <span data-ttu-id="83a2a-136">Un ejemplo más realista incluye parámetros, varios términos de consulta, quizás con un ámbito en algunos de los campos, con posiblemente una expresión de filtro y reglas de ordenación.</span><span class="sxs-lookup"><span data-stu-id="83a2a-136">A more realistic example includes parameters, several query terms, perhaps scoped to certain fields, with possibly a filter expression and ordering rules.</span></span>  

<span data-ttu-id="83a2a-137">El ejemplo siguiente es una solicitud de búsqueda que puede enviar a Azure Search mediante la [API de REST](https://docs.microsoft.com/rest/api/searchservice/search-documents).</span><span class="sxs-lookup"><span data-stu-id="83a2a-137">The following example is a search request you might send to Azure Search using the [REST API](https://docs.microsoft.com/rest/api/searchservice/search-documents).</span></span>  

~~~~
POST /indexes/hotels/docs/search?api-version=2016-09-01 
{  
    "search": "Spacious, air-condition* +\"Ocean view\"",  
    "searchFields": "description, title",  
    "searchMode": "any",
    "filter": "price ge 60 and price lt 300",  
    "orderby": "geo.distance(location, geography'POINT(-159.476235 22.227659)')", 
    "queryType": "full" 
 } 
~~~~

<span data-ttu-id="83a2a-138">Para esta solicitud, el motor de búsqueda realiza lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="83a2a-138">For this request, the search engine does the following:</span></span>

1. <span data-ttu-id="83a2a-139">Filtra los documentos cuyo precio sea al menos de 60 USD y menos de 300 USD.</span><span class="sxs-lookup"><span data-stu-id="83a2a-139">Filters out documents where the price is at least $60 and less than $300.</span></span>
2. <span data-ttu-id="83a2a-140">Ejecuta la consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-140">Executes the query.</span></span> <span data-ttu-id="83a2a-141">En este ejemplo, la consulta de búsqueda consta de frases y términos: `"Spacious, air-condition* +\"Ocean view\""` (por lo general, los usuarios no especifican la puntuación, pero si la incluyen en el ejemplo, podemos explicar cómo la administran los analizadores).</span><span class="sxs-lookup"><span data-stu-id="83a2a-141">In this example, the search query consists of phrases and terms: `"Spacious, air-condition* +\"Ocean view\""` (users typically don't enter punctuation, but including it in the example allows us to explain how analyzers handle it).</span></span> <span data-ttu-id="83a2a-142">Para esta consulta, el motor de búsqueda examina la descripción y los campos de título especificados en `searchFields` para los documentos que contienen "vistas al mar", y además en el término "espacioso" o en términos que comienzan por el prefijo "post-vacacional".</span><span class="sxs-lookup"><span data-stu-id="83a2a-142">For this query, the search engine scans the description and title fields specified in `searchFields` for documents that contain "Ocean view", and additionally on the term "spacious", or on terms that start with the prefix "air-condition".</span></span> <span data-ttu-id="83a2a-143">El parámetro `searchMode` se utiliza para que coincida con cualquier término (valor predeterminado) o todos ellos, para los casos donde no se requiere de forma explícita un término (`+`).</span><span class="sxs-lookup"><span data-stu-id="83a2a-143">The `searchMode` parameter is used to match on any term (default) or all of them, for cases where a term is not explicitly required (`+`).</span></span>
3. <span data-ttu-id="83a2a-144">Ordena el conjunto de hoteles por proximidad a una ubicación geográfica determinada y, a continuación, los devuelve a la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="83a2a-144">Orders the resulting set of hotels by proximity to a given geography location, and then returned to the calling application.</span></span> 

<span data-ttu-id="83a2a-145">La mayor parte de este artículo es sobre el procesamiento de la *consulta de búsqueda*: `"Spacious, air-condition* +\"Ocean view\""`.</span><span class="sxs-lookup"><span data-stu-id="83a2a-145">The majority of this article is about processing of the *search query*: `"Spacious, air-condition* +\"Ocean view\""`.</span></span> <span data-ttu-id="83a2a-146">El filtrado y la ordenación están fuera del ámbito.</span><span class="sxs-lookup"><span data-stu-id="83a2a-146">Filtering and ordering are out of scope.</span></span> <span data-ttu-id="83a2a-147">Para más información, consulte la [Documentación de referencia de API de búsqueda](https://docs.microsoft.com/rest/api/searchservice/search-documents).</span><span class="sxs-lookup"><span data-stu-id="83a2a-147">For more information, see the [Search API reference documentation](https://docs.microsoft.com/rest/api/searchservice/search-documents).</span></span>

<a name="stage1"></a>
## <a name="stage-1-query-parsing"></a><span data-ttu-id="83a2a-148">Fase 1: Consulta de análisis</span><span class="sxs-lookup"><span data-stu-id="83a2a-148">Stage 1: Query parsing</span></span> 

<span data-ttu-id="83a2a-149">Como se mencionó anteriormente, la cadena de consulta es la primera línea de la solicitud:</span><span class="sxs-lookup"><span data-stu-id="83a2a-149">As noted, the query string is the first line of the request:</span></span> 

~~~~
 "search": "Spacious, air-condition* +\"Ocean view\"", 
~~~~

<span data-ttu-id="83a2a-150">El analizador de consultas separa los operadores (como `*` y `+` en el ejemplo) de los términos de búsqueda y deconstruye la consulta de búsqueda en *subconsultas* de un tipo admitido:</span><span class="sxs-lookup"><span data-stu-id="83a2a-150">The query parser separates operators (such as `*` and `+` in the example) from search terms, and deconstructs the search query into *subqueries* of a supported type:</span></span> 

+ <span data-ttu-id="83a2a-151">*consulta de término* para términos independiente (como "espacioso")</span><span class="sxs-lookup"><span data-stu-id="83a2a-151">*term query* for standalone terms (like spacious)</span></span>
+ <span data-ttu-id="83a2a-152">*consultas de frases* de términos entre comillas (como "vistas al mar")</span><span class="sxs-lookup"><span data-stu-id="83a2a-152">*phrase query* for quoted terms (like ocean view)</span></span>
+ <span data-ttu-id="83a2a-153">*consulta de prefijo* de términos seguidos por un operador de prefijo `*` (como "post-vacacional")</span><span class="sxs-lookup"><span data-stu-id="83a2a-153">*prefix query* for terms followed by a prefix operator `*` (like air-condition)</span></span>

<span data-ttu-id="83a2a-154">Para obtener una lista completa de tipos de consultas admitidas, consulte [Sintaxis de consulta de Lucene](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search)</span><span class="sxs-lookup"><span data-stu-id="83a2a-154">For a full list of supported query types see [Lucene query sytnax](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search)</span></span>

<span data-ttu-id="83a2a-155">Los operadores asociados a una subconsulta determinan si la cadena "tiene que" cumplirse o "debe" cumplirse para que un documento se considere una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-155">Operators associated with a subquery determine whether the query "must be" or "should be" satisfied in order for a document to be considered a match.</span></span> <span data-ttu-id="83a2a-156">Por ejemplo, `+"Ocean view"` es obligatorio debido al operador `+`.</span><span class="sxs-lookup"><span data-stu-id="83a2a-156">For example, `+"Ocean view"` is "must" due to the `+` operator.</span></span> 

<span data-ttu-id="83a2a-157">El analizador de consultas reestructura las subconsultas en un *árbol de consulta* (una estructura interna que representa la consulta) que pasa al motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-157">The query parser restructures the subqueries into a *query tree* (an internal structure representing the query) it passes on to the search engine.</span></span> <span data-ttu-id="83a2a-158">En la primera fase de análisis de la consulta, el árbol de consulta tiene el siguiente aspecto.</span><span class="sxs-lookup"><span data-stu-id="83a2a-158">In the first stage of query parsing, the query tree looks like this.</span></span>  

 ![Modo de búsqueda de consulta booleana][2]

### <a name="supported-parsers-simple-and-full-lucene"></a><span data-ttu-id="83a2a-160">Analizadores admitidos: versión simple y completa de Lucene</span><span class="sxs-lookup"><span data-stu-id="83a2a-160">Supported parsers: Simple and Full Lucene</span></span> 

 <span data-ttu-id="83a2a-161">Azure Search expone dos lenguajes de consulta diferentes, `simple` (valor predeterminado) y `full`.</span><span class="sxs-lookup"><span data-stu-id="83a2a-161">Azure Search exposes two different query languages, `simple` (default) and `full`.</span></span> <span data-ttu-id="83a2a-162">Si establece el parámetro `queryType` con su solicitud de búsqueda, indica al analizador de consultas qué lenguaje de consulta elegir de modo que sepa cómo interpretar los operadores y la sintaxis.</span><span class="sxs-lookup"><span data-stu-id="83a2a-162">By setting the `queryType` parameter with your search request, you tell the query parser which query language you choose so that it knows how to interpret the operators and syntax.</span></span> <span data-ttu-id="83a2a-163">El [lenguaje de consulta simple](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search) es intuitivo y sólido, a menudo adecuado para interpretar la entrada del usuario como está sin que sea necesario el procesamiento por parte del cliente.</span><span class="sxs-lookup"><span data-stu-id="83a2a-163">The [Simple query langauge](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search) is intuitive and robust, often suitable to interpret user input as-is without client-side processing.</span></span> <span data-ttu-id="83a2a-164">Admite los operadores de consulta familiares desde motores de búsqueda web.</span><span class="sxs-lookup"><span data-stu-id="83a2a-164">It supports query operators familiar from web search engines.</span></span> <span data-ttu-id="83a2a-165">El [lenguaje de consulta completo de Lucene](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search), que obtendrá estableciendo `queryType=full`, amplía el lenguaje de consulta simple predeterminado mediante la adición de compatibilidad con más operadores y tipos de consulta como carácter comodín, coincidencias parciales, regex y consultas centrada en el campo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-165">The [Full Lucene query language](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search), which you get by setting `queryType=full`, extends the default Simple query language by adding support for more operators and query types like wildcard, fuzzy, regex, and field-scoped queries.</span></span> <span data-ttu-id="83a2a-166">Por ejemplo, una expresión regular enviada con la sintaxis de consulta simple se interpretaría como una cadena de consulta y no una expresión.</span><span class="sxs-lookup"><span data-stu-id="83a2a-166">For example, a regular expression sent in Simple query syntax would be interpreted as a query string and not an expression.</span></span> <span data-ttu-id="83a2a-167">La solicitud de ejemplo de este artículo utiliza el lenguaje de consulta completo de Lucene.</span><span class="sxs-lookup"><span data-stu-id="83a2a-167">The example request in this article uses the Full Lucene query language.</span></span>

### <a name="impact-of-searchmode-on-the-parser"></a><span data-ttu-id="83a2a-168">Impacto de searchMode en el analizador</span><span class="sxs-lookup"><span data-stu-id="83a2a-168">Impact of searchMode on the parser</span></span> 

<span data-ttu-id="83a2a-169">Otro parámetro de solicitud de búsqueda que afecte al análisis es el parámetro `searchMode`.</span><span class="sxs-lookup"><span data-stu-id="83a2a-169">Another search request parameter that affects parsing is the `searchMode` parameter.</span></span> <span data-ttu-id="83a2a-170">Controla el operador predeterminado para las consultas booleanas: cualquiera (valor predeterminado) o todos.</span><span class="sxs-lookup"><span data-stu-id="83a2a-170">It controls the default operator for Boolean queries: any (default) or all.</span></span>  

<span data-ttu-id="83a2a-171">Cuando `searchMode=any`, que es el valor predeterminado, el delimitador de espacio entre "espacioso" y "post-vacacional" es OR (`||`), lo que hace que el texto de consulta de muestra sea equivalente a:</span><span class="sxs-lookup"><span data-stu-id="83a2a-171">When `searchMode=any`, which is the default, the space delimiter between spacious and air-condition is OR (`||`), making the sample query text equivalent to:</span></span> 

~~~~
Spacious,||air-condition*+"Ocean view" 
~~~~

<span data-ttu-id="83a2a-172">Los operadores explícitos, como `+` en `+"Ocean view"`, no son ambiguos en la construcción de la consulta booleana (el término *debe* coincidir).</span><span class="sxs-lookup"><span data-stu-id="83a2a-172">Explicit operators, such as `+` in `+"Ocean view"`, are unambiguous in boolean query construction (the term *must* match).</span></span> <span data-ttu-id="83a2a-173">Es menos obvio cómo interpretar los términos restantes: "espacioso" y "post-vacacional".</span><span class="sxs-lookup"><span data-stu-id="83a2a-173">Less obvious is how to interpret the remaining terms: spacious and air-condition.</span></span> <span data-ttu-id="83a2a-174">¿El motor de búsqueda debería encontrar coincidencias en "vistas al mar" *y* "espacioso" *y* "post-vacacional"?</span><span class="sxs-lookup"><span data-stu-id="83a2a-174">Should the search engine find matches on ocean view *and* spacious *and* air-condition?</span></span> <span data-ttu-id="83a2a-175">¿O debe encontrar "vistas al mar" además de *alguno* de los términos restantes?</span><span class="sxs-lookup"><span data-stu-id="83a2a-175">Or should it find ocean view plus *either one* of the remaining terms?</span></span> 

<span data-ttu-id="83a2a-176">De forma predeterminada (`searchMode=any`), el motor de búsqueda da por supuesto la interpretación más amplia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-176">By default (`searchMode=any`), the search engine assumes the broader interpretation.</span></span> <span data-ttu-id="83a2a-177">El campo *debe* coincidir, reflejar la semántica "o".</span><span class="sxs-lookup"><span data-stu-id="83a2a-177">Either field *should* be matched, reflecting "or" semantics.</span></span> <span data-ttu-id="83a2a-178">El árbol de consulta inicial mostrador anterior, con las dos operaciones "debe", muestra el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="83a2a-178">The initial query tree illustrated previously, with the two "should" operations, shows the default.</span></span>  

<span data-ttu-id="83a2a-179">Imagine que establecemos ahora `searchMode=all`.</span><span class="sxs-lookup"><span data-stu-id="83a2a-179">Suppose that we now set `searchMode=all`.</span></span> <span data-ttu-id="83a2a-180">En este caso, el espacio se interpreta como una operación "y".</span><span class="sxs-lookup"><span data-stu-id="83a2a-180">In this case, the space is interpreted as an "and" operation.</span></span> <span data-ttu-id="83a2a-181">Cada uno de los términos restantes debe estar presente en el documento para considerarse una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-181">Each of the remaining terms must both be present in the document to qualify as a match.</span></span> <span data-ttu-id="83a2a-182">La consulta de ejemplo resultante podría interpretarse del siguiente modo:</span><span class="sxs-lookup"><span data-stu-id="83a2a-182">The resulting sample query would be interpreted as follows:</span></span> 

~~~~
+Spacious,+air-condition*+"Ocean view"  
~~~~

<span data-ttu-id="83a2a-183">Un árbol de consulta modificado para esta consulta el siguiente, donde un documento coincidente es la intersección de las tres subconsultas:</span><span class="sxs-lookup"><span data-stu-id="83a2a-183">A modified query tree for this query would be as follows, where a matching document is the intersection of all three subqueries:</span></span> 

 ![Consulta booleana searchmode all][3]

> [!Note] 
> <span data-ttu-id="83a2a-185">Elegir `searchMode=any` sobre `searchMode=all` es la mejor decisión cuando se ejecutan consultas representativas.</span><span class="sxs-lookup"><span data-stu-id="83a2a-185">Choosing `searchMode=any` over `searchMode=all` is a decision best arrived at by running representative queries.</span></span> <span data-ttu-id="83a2a-186">Los usuarios que suelen incluir operadores (algo común cuando se buscan almacenes de documentos) pueden encontrar resultados más intuitivos si `searchMode=all` informa de construcciones de consultas booleanas.</span><span class="sxs-lookup"><span data-stu-id="83a2a-186">Users who are likely to include operators (common when searching document stores) might find results more intuitive if `searchMode=all` informs boolean query constructs.</span></span> <span data-ttu-id="83a2a-187">Para obtener más información sobre la interacción entre `searchMode` y los operadores, vea [Sintaxis de consulta simple](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search).</span><span class="sxs-lookup"><span data-stu-id="83a2a-187">For more about the interplay between `searchMode` and operators, see [Simple query syntax](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search).</span></span>

<a name="stage2"></a>
## <a name="stage-2-lexical-analysis"></a><span data-ttu-id="83a2a-188">Fase 2: Análisis léxico</span><span class="sxs-lookup"><span data-stu-id="83a2a-188">Stage 2: Lexical analysis</span></span> 

<span data-ttu-id="83a2a-189">Los analizadores léxicos procesan *consultas de términos* y *consultas de frases* después de que se estructure el árbol de consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-189">Lexical analyzers process *term queries* and *phrase queries* after the query tree is structured.</span></span> <span data-ttu-id="83a2a-190">Un analizador acepta las entradas de texto especificadas por el analizador, procesa el texto y, a continuación, vuelve a enviar términos acortados que incorporar al árbol de consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-190">An analyzer accepts the text inputs given to it by the parser, processes the text, and then sends back tokenized terms to be incorporated into the query tree.</span></span> 

<span data-ttu-id="83a2a-191">La forma más común de análisis léxico es el *análisis lingüístico*, que transforma los términos de consulta basándose en reglas específicas para un idioma determinado:</span><span class="sxs-lookup"><span data-stu-id="83a2a-191">The most common form of lexical analysis is *linguistic analysis* which transforms query terms based on rules specific to a given language:</span></span> 

* <span data-ttu-id="83a2a-192">Reducción de un término de consulta a la forma de la raíz de una palabra</span><span class="sxs-lookup"><span data-stu-id="83a2a-192">Reducing a query term to the root form of a word</span></span> 
* <span data-ttu-id="83a2a-193">Eliminación de palabras no esenciales (palabras irrelevantes, como "el" o "y")</span><span class="sxs-lookup"><span data-stu-id="83a2a-193">Removing non-essential words (stopwords, such as "the" or "and" in English)</span></span> 
* <span data-ttu-id="83a2a-194">División de una palabra compuesta en partes</span><span class="sxs-lookup"><span data-stu-id="83a2a-194">Breaking a composite word into component parts</span></span> 
* <span data-ttu-id="83a2a-195">Uso de minúsculas en una palabra con mayúsculas</span><span class="sxs-lookup"><span data-stu-id="83a2a-195">Lower casing an upper case word</span></span> 

<span data-ttu-id="83a2a-196">Todas estas operaciones tienden a borrar las diferencias entre la entrada de texto proporcionada por el usuario y los términos almacenados en el índice.</span><span class="sxs-lookup"><span data-stu-id="83a2a-196">All of these operations tend to erase differences between the text input provided by the user and the terms stored in the index.</span></span> <span data-ttu-id="83a2a-197">Estas operaciones van más allá del procesamiento de texto y requieren un conocimiento más profundo del propio idioma.</span><span class="sxs-lookup"><span data-stu-id="83a2a-197">Such operations go beyond text processing and require in-depth knowledge of the language itself.</span></span> <span data-ttu-id="83a2a-198">Para agregar esta capa de reconocimiento lingüístico, Azure Search admite una larga de [analizadores de idioma](https://docs.microsoft.com/rest/api/searchservice/language-support) de Lucene y Microsoft.</span><span class="sxs-lookup"><span data-stu-id="83a2a-198">To add this layer of linguistic awareness, Azure Search supports a long list of [language analyzers](https://docs.microsoft.com/rest/api/searchservice/language-support) from both Lucene and Microsoft.</span></span>

> [!Note]
> <span data-ttu-id="83a2a-199">Los requisitos de análisis pueden ser mínimos para la elaboración en función de su escenario.</span><span class="sxs-lookup"><span data-stu-id="83a2a-199">Analysis requirements can range from minimal to elaborate depending on your scenario.</span></span> <span data-ttu-id="83a2a-200">Puede controlar la complejidad del análisis léxico seleccionando uno de los analizadores predefinidos o creando su propio [analizador personalizado](https://docs.microsoft.com/rest/api/searchservice/Custom-analyzers-in-Azure-Search).</span><span class="sxs-lookup"><span data-stu-id="83a2a-200">You can control complexity of lexical analysis by the selecting one of the predefined analyzers or by creating your own [custom analyzer](https://docs.microsoft.com/rest/api/searchservice/Custom-analyzers-in-Azure-Search).</span></span> <span data-ttu-id="83a2a-201">Los analizadores se limitan a campos de búsqueda y se especifican como parte de una definición de campo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-201">Analyzers are scoped to searchable fields and are specified as part of a field definition.</span></span> <span data-ttu-id="83a2a-202">Esto le permite modificar el análisis léxico por campo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-202">This allows you to vary lexical analysis on a per-field basis.</span></span> <span data-ttu-id="83a2a-203">Si no se especifica, se utiliza el analizador *estándar* de Lucene.</span><span class="sxs-lookup"><span data-stu-id="83a2a-203">Unspecified, the *standard* Lucene analyzer is used.</span></span>

<span data-ttu-id="83a2a-204">En nuestro ejemplo, antes del análisis, el árbol de consulta inicial tiene el término "Espacioso," con una "E" mayúscula y una coma que el analizador de consultas interpreta como parte del término de consulta (la coma no se considera un operador de idioma de consulta).</span><span class="sxs-lookup"><span data-stu-id="83a2a-204">In our example, prior to analysis, the initial query tree has the term "Spacious," with an uppercase "S" and a comma that the query parser interprets as a part of the query term (a comma is not considered a query language operator).</span></span>  

<span data-ttu-id="83a2a-205">Cuando el analizador predeterminado procesa el término, cambiará a minúscula "vistas al mar" y "espacioso" y quitará la coma.</span><span class="sxs-lookup"><span data-stu-id="83a2a-205">When the default analyzer processes the term, it will lowercase "ocean view" and "spacious", and remove the comma character.</span></span> <span data-ttu-id="83a2a-206">El árbol de la consulta modificado será como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="83a2a-206">The modified query tree will look as follows:</span></span> 

 ![Consulta booleana con términos analizados][4]

### <a name="testing-analyzer-behaviors"></a><span data-ttu-id="83a2a-208">Prueba de comportamientos del analizador</span><span class="sxs-lookup"><span data-stu-id="83a2a-208">Testing analyzer behaviors</span></span> 

<span data-ttu-id="83a2a-209">Se puede probar el comportamiento de un analizador mediante la [Análisis de la API](https://docs.microsoft.com/rest/api/searchservice/test-analyzer).</span><span class="sxs-lookup"><span data-stu-id="83a2a-209">The behavior of an analyzer can be tested using the [Analyze API](https://docs.microsoft.com/rest/api/searchservice/test-analyzer).</span></span> <span data-ttu-id="83a2a-210">Proporcione el texto que desea analizar para ver qué términos generará un analizador determinado.</span><span class="sxs-lookup"><span data-stu-id="83a2a-210">Provide the text you want to analyze to see what terms given analyzer will generate.</span></span> <span data-ttu-id="83a2a-211">Por ejemplo, para ver cómo el analizador estándar procesaría el texto "post-vacacional", puede emitir la solicitud siguiente:</span><span class="sxs-lookup"><span data-stu-id="83a2a-211">For example, to see how the standard analyzer would process the text "air-condition", you can issue the following request:</span></span>

~~~~
{ 
    "text": "air-condition",
    "analyzer": "standard"
}
~~~~

<span data-ttu-id="83a2a-212">El analizador estándar divide el texto de entrada en los siguientes dos tokens, anotándolos con atributos como desplazamientos de inicio y final (utilizados para resultados destacados), así como su posición (que se usa para la coincidencia de frase):</span><span class="sxs-lookup"><span data-stu-id="83a2a-212">The standard analyzer breaks the input text into the following two tokens, annotating them with attributes like start and end offsets (used for hit highlighting) as well as their position (used for phrase matching):</span></span>

~~~~
{  
  "tokens": [
    {
      "token": "air",
      "startOffset": 0,
      "endOffset": 3,
      "position": 0
    },
    {
      "token": "condition",
      "startOffset": 4,
      "endOffset": 13,
      "position": 1
    }
  ]
}
~~~~

### <a name="exceptions-to-lexical-analysis"></a><span data-ttu-id="83a2a-213">Excepciones para el análisis léxico</span><span class="sxs-lookup"><span data-stu-id="83a2a-213">Exceptions to lexical analysis</span></span> 

<span data-ttu-id="83a2a-214">El análisis léxico se aplica únicamente a los tipos de consultas que requieren términos completos: una consulta de término o una consulta de frase.</span><span class="sxs-lookup"><span data-stu-id="83a2a-214">Lexical analysis applies only to query types that require complete terms – either a term query or a phrase query.</span></span> <span data-ttu-id="83a2a-215">No se aplica a los tipos de consulta con términos incompletos: consulta de prefijo, consulta de carácter comodín, consulta regex o a una consulta de coincidencia parcial.</span><span class="sxs-lookup"><span data-stu-id="83a2a-215">It doesn’t apply to query types with incomplete terms – prefix query, wildcard query, regex query – or to a fuzzy query.</span></span> <span data-ttu-id="83a2a-216">Estos tipos de consulta, incluida la consulta de prefijo con el término *post-vacacional\**  en nuestro ejemplo, se agregan directamente al árbol de consulta omitiendo la fase de análisis.</span><span class="sxs-lookup"><span data-stu-id="83a2a-216">Those query types, including the prefix query with term *air-condition\** in our example, are added directly to the query tree, bypassing the analysis stage.</span></span> <span data-ttu-id="83a2a-217">La única transformación realizada en los términos de consulta de esos tipos es el establecimiento de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="83a2a-217">The only transformation performed on query terms of those types is lowercasing.</span></span>

<a name="stage3"></a>
## <a name="stage-3-document-retrieval"></a><span data-ttu-id="83a2a-218">Fase 3: Recuperación de documentos</span><span class="sxs-lookup"><span data-stu-id="83a2a-218">Stage 3: Document retrieval</span></span> 

<span data-ttu-id="83a2a-219">La recuperación de documentos hace referencia a la búsqueda de documentos con términos coincidentes en el índice.</span><span class="sxs-lookup"><span data-stu-id="83a2a-219">Document retrieval refers to finding documents with matching terms in the index.</span></span> <span data-ttu-id="83a2a-220">Esta fase se entiende mejor mediante un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-220">This stage is understood best through an example.</span></span> <span data-ttu-id="83a2a-221">Puede empezar con un índice de hoteles que tengan el siguiente esquema simple:</span><span class="sxs-lookup"><span data-stu-id="83a2a-221">Let's start with a hotels index having the following simple schema:</span></span> 

~~~~
{   
    "name": "hotels",     
    "fields": [     
        { "name": "id", "type": "Edm.String", "key": true, "searchable": false },     
        { "name": "title", "type": "Edm.String", "searchable": true },     
        { "name": "description", "type": "Edm.String", "searchable": true }
    ] 
} 
~~~~

<span data-ttu-id="83a2a-222">Suponga también que este índice contiene los siguientes cuatro documentos:</span><span class="sxs-lookup"><span data-stu-id="83a2a-222">Further assume that this index contains the following four documents:</span></span> 

~~~~
{ 
    "value": [
        {         
            "id": "1",         
            "title": "Hotel Atman",         
            "description": "Spacious rooms, ocean view, walking distance to the beach."   
        },       
        {         
            "id": "2",         
            "title": "Beach Resort",        
            "description": "Located on the north shore of the island of Kauaʻi. Ocean view."     
        },       
        {         
            "id": "3",         
            "title": "Playa Hotel",         
            "description": "Comfortable, air-conditioned rooms with ocean view."
        },       
        {         
            "id": "4",         
            "title": "Ocean Retreat",         
            "description": "Quiet and secluded"
        }    
    ]
}
~~~~

<span data-ttu-id="83a2a-223">**Cómo se indexan los términos**</span><span class="sxs-lookup"><span data-stu-id="83a2a-223">**How terms are indexed**</span></span>

<span data-ttu-id="83a2a-224">Para entender la recuperación, es útil conocer algunos conceptos básicos acerca de la indexación.</span><span class="sxs-lookup"><span data-stu-id="83a2a-224">To understand retrieval, it helps to know a few basics about indexing.</span></span> <span data-ttu-id="83a2a-225">La unidad de almacenamiento es un índice invertido, uno para cada campo de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-225">The unit of storage is an inverted index, one for each searchable field.</span></span> <span data-ttu-id="83a2a-226">Dentro de un índice invertido hay una lista ordenada de todos los términos de todos los documentos.</span><span class="sxs-lookup"><span data-stu-id="83a2a-226">Within an inverted index is a sorted list of all terms from all documents.</span></span> <span data-ttu-id="83a2a-227">Cada término se asigna a la lista de documentos en el que aparece, tal como aparece en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="83a2a-227">Each term maps to the list of documents in which it occurs, as evident in the example below.</span></span>

<span data-ttu-id="83a2a-228">Para generar los términos en un índice invertido, el motor de búsqueda realiza un análisis léxico del contenido de los documentos, de forma similar a lo que sucede durante el procesamiento de consultas.</span><span class="sxs-lookup"><span data-stu-id="83a2a-228">To produce the terms in an inverted index, the search engine performs lexical analysis over the content of documents, similar to what happens during query processing.</span></span> <span data-ttu-id="83a2a-229">Las entradas de texto pasan al analizador, en minúsculas, con una puntuación fragmentada y así sucesivamente, dependiendo de la configuración del analizador.</span><span class="sxs-lookup"><span data-stu-id="83a2a-229">Text inputs are passed to an analyzer, lower-cased, stripped of punctuation, and so forth, depending on the analyzer configuration.</span></span> <span data-ttu-id="83a2a-230">Es común, pero no necesario, usar los mismos analizadores para las operaciones de búsqueda e indexación para que los términos de consulta tengan un aspecto más parecido a los términos de dentro del índice.</span><span class="sxs-lookup"><span data-stu-id="83a2a-230">It's common, but not required, to use the same analyzers for search and indexing operations so that query terms look more like terms inside the index.</span></span>

> [!Note]
> <span data-ttu-id="83a2a-231">Azure Search le permite especificar diferentes analizadores para la indexación y búsqueda a través de parámetros de campo `indexAnalyzer` y `searchAnalyzer` adicionales.</span><span class="sxs-lookup"><span data-stu-id="83a2a-231">Azure Search lets you specify different analyzers for indexing and search via additional `indexAnalyzer` and `searchAnalyzer` field parameters.</span></span> <span data-ttu-id="83a2a-232">Si no se especifica, el analizador establecido con la propiedad `analyzer` se utiliza para la indexación y la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-232">If unspecified, the analyzer set with the `analyzer` property is used for both indexing and searching.</span></span>  

<span data-ttu-id="83a2a-233">**Índice invertido para documentos de ejemplo**</span><span class="sxs-lookup"><span data-stu-id="83a2a-233">**Inverted index for example documents**</span></span>

<span data-ttu-id="83a2a-234">Volviendo a nuestro ejemplo, para el campo **título**, el índice invertido tendría el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="83a2a-234">Returning to our example, for the **title** field, the inverted index looks like this:</span></span>

| <span data-ttu-id="83a2a-235">Término</span><span class="sxs-lookup"><span data-stu-id="83a2a-235">Term</span></span> | <span data-ttu-id="83a2a-236">Lista de documento</span><span class="sxs-lookup"><span data-stu-id="83a2a-236">Document list</span></span> |
|------|---------------|
| <span data-ttu-id="83a2a-237">atman</span><span class="sxs-lookup"><span data-stu-id="83a2a-237">atman</span></span> | <span data-ttu-id="83a2a-238">1</span><span class="sxs-lookup"><span data-stu-id="83a2a-238">1</span></span> |
| <span data-ttu-id="83a2a-239">playa</span><span class="sxs-lookup"><span data-stu-id="83a2a-239">beach</span></span> | <span data-ttu-id="83a2a-240">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-240">2</span></span> |
| <span data-ttu-id="83a2a-241">hotel</span><span class="sxs-lookup"><span data-stu-id="83a2a-241">hotel</span></span> | <span data-ttu-id="83a2a-242">1, 3</span><span class="sxs-lookup"><span data-stu-id="83a2a-242">1, 3</span></span> |
| <span data-ttu-id="83a2a-243">océano</span><span class="sxs-lookup"><span data-stu-id="83a2a-243">ocean</span></span> | <span data-ttu-id="83a2a-244">4</span><span class="sxs-lookup"><span data-stu-id="83a2a-244">4</span></span>  |
| <span data-ttu-id="83a2a-245">playa</span><span class="sxs-lookup"><span data-stu-id="83a2a-245">playa</span></span> | <span data-ttu-id="83a2a-246">3</span><span class="sxs-lookup"><span data-stu-id="83a2a-246">3</span></span> |
| <span data-ttu-id="83a2a-247">resort</span><span class="sxs-lookup"><span data-stu-id="83a2a-247">resort</span></span> | <span data-ttu-id="83a2a-248">3</span><span class="sxs-lookup"><span data-stu-id="83a2a-248">3</span></span> |
| <span data-ttu-id="83a2a-249">retirada</span><span class="sxs-lookup"><span data-stu-id="83a2a-249">retreat</span></span> | <span data-ttu-id="83a2a-250">4</span><span class="sxs-lookup"><span data-stu-id="83a2a-250">4</span></span> |

<span data-ttu-id="83a2a-251">En el campo de título, solo *hotel* aparece en dos documentos: 1 y 3.</span><span class="sxs-lookup"><span data-stu-id="83a2a-251">In the title field, only *hotel* shows up in two documents: 1, 3.</span></span>

<span data-ttu-id="83a2a-252">Para el campo **descripción**, el índice es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="83a2a-252">For the **description** field, the index is as follows:</span></span>

| <span data-ttu-id="83a2a-253">Término</span><span class="sxs-lookup"><span data-stu-id="83a2a-253">Term</span></span> | <span data-ttu-id="83a2a-254">Lista de documento</span><span class="sxs-lookup"><span data-stu-id="83a2a-254">Document list</span></span> |
|------|---------------|
| <span data-ttu-id="83a2a-255">post-</span><span class="sxs-lookup"><span data-stu-id="83a2a-255">air</span></span> | <span data-ttu-id="83a2a-256">3</span><span class="sxs-lookup"><span data-stu-id="83a2a-256">3</span></span>
| <span data-ttu-id="83a2a-257">y</span><span class="sxs-lookup"><span data-stu-id="83a2a-257">and</span></span> | <span data-ttu-id="83a2a-258">4</span><span class="sxs-lookup"><span data-stu-id="83a2a-258">4</span></span>
| <span data-ttu-id="83a2a-259">playa</span><span class="sxs-lookup"><span data-stu-id="83a2a-259">beach</span></span> | <span data-ttu-id="83a2a-260">1</span><span class="sxs-lookup"><span data-stu-id="83a2a-260">1</span></span>
| <span data-ttu-id="83a2a-261">vacacional</span><span class="sxs-lookup"><span data-stu-id="83a2a-261">conditioned</span></span> | <span data-ttu-id="83a2a-262">3</span><span class="sxs-lookup"><span data-stu-id="83a2a-262">3</span></span>
| <span data-ttu-id="83a2a-263">cómodo</span><span class="sxs-lookup"><span data-stu-id="83a2a-263">comfortable</span></span> | <span data-ttu-id="83a2a-264">3</span><span class="sxs-lookup"><span data-stu-id="83a2a-264">3</span></span>
| <span data-ttu-id="83a2a-265">distancia</span><span class="sxs-lookup"><span data-stu-id="83a2a-265">distance</span></span> | <span data-ttu-id="83a2a-266">1</span><span class="sxs-lookup"><span data-stu-id="83a2a-266">1</span></span>
| <span data-ttu-id="83a2a-267">isla</span><span class="sxs-lookup"><span data-stu-id="83a2a-267">island</span></span> | <span data-ttu-id="83a2a-268">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-268">2</span></span>
| <span data-ttu-id="83a2a-269">kauaʻi</span><span class="sxs-lookup"><span data-stu-id="83a2a-269">kauaʻi</span></span> | <span data-ttu-id="83a2a-270">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-270">2</span></span>
| <span data-ttu-id="83a2a-271">ubicado</span><span class="sxs-lookup"><span data-stu-id="83a2a-271">located</span></span> | <span data-ttu-id="83a2a-272">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-272">2</span></span>
| <span data-ttu-id="83a2a-273">norte</span><span class="sxs-lookup"><span data-stu-id="83a2a-273">north</span></span> | <span data-ttu-id="83a2a-274">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-274">2</span></span>
| <span data-ttu-id="83a2a-275">océano</span><span class="sxs-lookup"><span data-stu-id="83a2a-275">ocean</span></span> | <span data-ttu-id="83a2a-276">1, 2, 3</span><span class="sxs-lookup"><span data-stu-id="83a2a-276">1, 2, 3</span></span>
| <span data-ttu-id="83a2a-277">de</span><span class="sxs-lookup"><span data-stu-id="83a2a-277">of</span></span> | <span data-ttu-id="83a2a-278">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-278">2</span></span>
| <span data-ttu-id="83a2a-279">en</span><span class="sxs-lookup"><span data-stu-id="83a2a-279">on</span></span> |<span data-ttu-id="83a2a-280">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-280">2</span></span>
| <span data-ttu-id="83a2a-281">silencioso</span><span class="sxs-lookup"><span data-stu-id="83a2a-281">quiet</span></span> | <span data-ttu-id="83a2a-282">4</span><span class="sxs-lookup"><span data-stu-id="83a2a-282">4</span></span>
| <span data-ttu-id="83a2a-283">habitaciones</span><span class="sxs-lookup"><span data-stu-id="83a2a-283">rooms</span></span>  | <span data-ttu-id="83a2a-284">1, 3</span><span class="sxs-lookup"><span data-stu-id="83a2a-284">1, 3</span></span>
| <span data-ttu-id="83a2a-285">aislado</span><span class="sxs-lookup"><span data-stu-id="83a2a-285">secluded</span></span> | <span data-ttu-id="83a2a-286">4</span><span class="sxs-lookup"><span data-stu-id="83a2a-286">4</span></span>
| <span data-ttu-id="83a2a-287">costa</span><span class="sxs-lookup"><span data-stu-id="83a2a-287">shore</span></span> | <span data-ttu-id="83a2a-288">2</span><span class="sxs-lookup"><span data-stu-id="83a2a-288">2</span></span>
| <span data-ttu-id="83a2a-289">espacioso</span><span class="sxs-lookup"><span data-stu-id="83a2a-289">spacious</span></span> | <span data-ttu-id="83a2a-290">1</span><span class="sxs-lookup"><span data-stu-id="83a2a-290">1</span></span>
| <span data-ttu-id="83a2a-291">el</span><span class="sxs-lookup"><span data-stu-id="83a2a-291">the</span></span> | <span data-ttu-id="83a2a-292">1, 2</span><span class="sxs-lookup"><span data-stu-id="83a2a-292">1, 2</span></span>
| <span data-ttu-id="83a2a-293">to</span><span class="sxs-lookup"><span data-stu-id="83a2a-293">to</span></span> | <span data-ttu-id="83a2a-294">1</span><span class="sxs-lookup"><span data-stu-id="83a2a-294">1</span></span>
| <span data-ttu-id="83a2a-295">view</span><span class="sxs-lookup"><span data-stu-id="83a2a-295">view</span></span> | <span data-ttu-id="83a2a-296">1, 2, 3</span><span class="sxs-lookup"><span data-stu-id="83a2a-296">1, 2, 3</span></span>
| <span data-ttu-id="83a2a-297">paseo</span><span class="sxs-lookup"><span data-stu-id="83a2a-297">walking</span></span> | <span data-ttu-id="83a2a-298">1</span><span class="sxs-lookup"><span data-stu-id="83a2a-298">1</span></span>
| <span data-ttu-id="83a2a-299">por</span><span class="sxs-lookup"><span data-stu-id="83a2a-299">with</span></span> | <span data-ttu-id="83a2a-300">3</span><span class="sxs-lookup"><span data-stu-id="83a2a-300">3</span></span>


<span data-ttu-id="83a2a-301">**Coincidencia de términos de consulta con términos indexados**</span><span class="sxs-lookup"><span data-stu-id="83a2a-301">**Matching query terms against indexed terms**</span></span>

<span data-ttu-id="83a2a-302">Teniendo en cuenta los índices invertidos anteriores, volvamos a la consulta de ejemplo y veamos cómo se detectan los documentos coincidentes en nuestra consulta de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-302">Given the inverted indices above, let’s return to the sample query and see how matching documents are found for our example query.</span></span> <span data-ttu-id="83a2a-303">Recuerde que el árbol de consulta final tendrá el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="83a2a-303">Recall that the final query tree looks like this:</span></span> 

 ![Consulta booleana con términos analizados][4]

<span data-ttu-id="83a2a-305">Durante la ejecución de la consulta, las consultas individuales se ejecutan en los campos de búsqueda por separado.</span><span class="sxs-lookup"><span data-stu-id="83a2a-305">During query execution, individual queries are executed against the searchable fields independently.</span></span> 

+ <span data-ttu-id="83a2a-306">La consulta de término "espacioso" coincide con el documento 1 (Hotel Atman).</span><span class="sxs-lookup"><span data-stu-id="83a2a-306">The TermQuery, "spacious", matches document 1 (Hotel Atman).</span></span> 

+ <span data-ttu-id="83a2a-307">La consulta de prefijo "post-vacacional*" no coincide con ningún documento.</span><span class="sxs-lookup"><span data-stu-id="83a2a-307">The PrefixQuery, "air-condition*", doesn't match any documents.</span></span> 

  <span data-ttu-id="83a2a-308">Este es el comportamiento que normalmente confunde a los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="83a2a-308">This is a behavior that sometimes confuses developers.</span></span> <span data-ttu-id="83a2a-309">Aunque el término post-vacacional existe en el documento, el analizador predeterminado lo divide en dos términos.</span><span class="sxs-lookup"><span data-stu-id="83a2a-309">Although the term air-conditioned exists in the document, it is split into two terms by the default analyzer.</span></span> <span data-ttu-id="83a2a-310">Recuerde que las consultas de prefijo, que contienen términos parciales, no se analizan.</span><span class="sxs-lookup"><span data-stu-id="83a2a-310">Recall that prefix queries, which contain partial terms, are not analyzed.</span></span> <span data-ttu-id="83a2a-311">Por lo tanto, los términos con el prefijo "post-vacacional" se buscan en el índice invertido y no se encuentran.</span><span class="sxs-lookup"><span data-stu-id="83a2a-311">Therefore terms with prefix "air-condition" are looked up in the inverted index and not found.</span></span>

+ <span data-ttu-id="83a2a-312">La consulta de frase "vistas al mar", busca los términos "mar" y "vistas" y comprueba la proximidad de términos en el documento original.</span><span class="sxs-lookup"><span data-stu-id="83a2a-312">The PhraseQuery, "ocean view", looks up the terms "ocean" and "view" and checks the proximity of terms in the original document.</span></span> <span data-ttu-id="83a2a-313">Los documentos 1, 2 y 3 coinciden con esta consulta en el campo de descripción.</span><span class="sxs-lookup"><span data-stu-id="83a2a-313">Documents 1, 2 and 3 match this query in the description field.</span></span> <span data-ttu-id="83a2a-314">Tenga en cuenta que el documento 4 tiene el término "mar" en el título, pero no se considera una coincidencia ya que estamos buscando la frase "vistas al mar" y no palabras individuales.</span><span class="sxs-lookup"><span data-stu-id="83a2a-314">Notice document 4 has the term ocean in the title but isn’t considered a match, as we're looking for the "ocean view" phrase rather than individual words.</span></span> 

> [!Note]
> <span data-ttu-id="83a2a-315">Se ejecuta una consulta de búsqueda de forma independiente en todos los campos de búsqueda en el índice de Azure Search a no ser que limite los campos establecidos con el parámetro `searchFields`, como se muestra en la solicitud de búsqueda de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="83a2a-315">A search query is executed independently against all searchable fields in the Azure Search index unless you limit the fields set with the `searchFields` parameter, as illustrated in the example search request.</span></span> <span data-ttu-id="83a2a-316">Se devuelven documentos que coinciden con cualquiera de los campos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-316">Documents that match in any of the selected fields are returned.</span></span> 

<span data-ttu-id="83a2a-317">En general, para la consulta en cuestión, los documentos que coinciden son 1, 2 y 3.</span><span class="sxs-lookup"><span data-stu-id="83a2a-317">On the whole, for the query in question, the documents that match are 1, 2, 3.</span></span> 

## <a name="stage-4-scoring"></a><span data-ttu-id="83a2a-318">Fase 4: Puntuación</span><span class="sxs-lookup"><span data-stu-id="83a2a-318">Stage 4: Scoring</span></span>  

<span data-ttu-id="83a2a-319">A todos los documentos de un conjunto de resultados de búsqueda se les asigna una puntuación de relevancia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-319">Every document in a search result set is assigned a relevance score.</span></span> <span data-ttu-id="83a2a-320">La función de la puntuación de relevancia es rango superior en aquellos documentos que responden mejor a una pregunta de usuario según lo expresado por la consulta de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-320">The function of the relevance score is to rank higher those documents that best answer a user question as expressed by the search query.</span></span> <span data-ttu-id="83a2a-321">La puntuación se calcula en función de propiedades estadísticas de términos que coinciden.</span><span class="sxs-lookup"><span data-stu-id="83a2a-321">The score is computed based on statistical properties of terms that matched.</span></span> <span data-ttu-id="83a2a-322">La base de la fórmula de puntuación es [TF/IDF (frecuencia del documento de frecuencia inversa del término)](https://en.wikipedia.org/wiki/Tf%E2%80%93idf).</span><span class="sxs-lookup"><span data-stu-id="83a2a-322">At the core of the scoring formula is [TF/IDF (term frequency-inverse document frequency)](https://en.wikipedia.org/wiki/Tf%E2%80%93idf).</span></span> <span data-ttu-id="83a2a-323">En las consultas que contienen términos comunes y poco frecuentes, TF/IDF favorece a los resultados que contienen el término poco frecuente.</span><span class="sxs-lookup"><span data-stu-id="83a2a-323">In queries containing rare and common terms, TF/IDF promotes results containing the rare term.</span></span> <span data-ttu-id="83a2a-324">Por ejemplo, en un índice hipotético con todos los artículos de Wikipedia, de documentos que coincidían con la consulta *el presidente*, los documentos que coinciden con *presidente* se consideran más importantes que los documentos que coinciden con *el*.</span><span class="sxs-lookup"><span data-stu-id="83a2a-324">For example, in a hypothetical index with all Wikipedia articles, from documents that matched the query *the president*, documents matching on *president* are considered more relevant than documents matching on *the*.</span></span>


### <a name="scoring-example"></a><span data-ttu-id="83a2a-325">Ejemplo de puntuación</span><span class="sxs-lookup"><span data-stu-id="83a2a-325">Scoring example</span></span>

<span data-ttu-id="83a2a-326">Recuerde los tres documentos que coinciden con la consulta de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="83a2a-326">Recall the three documents that matched our example query:</span></span>
~~~~
search=Spacious, air-condition* +"Ocean view"  
~~~~
~~~~
{  
  "value": [
    {
      "@search.score": 0.25610128,
      "id": "1",
      "title": "Hotel Atman",
      "description": "Spacious rooms, ocean view, walking distance to the beach."
    },
    {
      "@search.score": 0.08951007,
      "id": "3",
      "title": "Playa Hotel",
      "description": "Comfortable, air-conditioned rooms with ocean view."
    },
    {
      "@search.score": 0.05967338,
      "id": "2",
      "title": "Ocean Resort",
      "description": "Located on a cliff on the north shore of the island of Kauai. Ocean view."
    }
  ]
}
~~~~

<span data-ttu-id="83a2a-327">El documento 1 coincidió con la mejor consulta porque tanto el término *espacioso* y la frase necesaria *vistas al mar* aparecen en el campo de descripción.</span><span class="sxs-lookup"><span data-stu-id="83a2a-327">Document 1 matched the query best because both the term *spacious* and the required phrase *ocean view* occur in the description field.</span></span> <span data-ttu-id="83a2a-328">Los siguientes dos documentos coinciden solo con la frase *vistas al mar*.</span><span class="sxs-lookup"><span data-stu-id="83a2a-328">The next two documents match only the phrase *ocean view*.</span></span> <span data-ttu-id="83a2a-329">Podría ser sorprendente que la puntuación por relevancia para el documento 2 y 3 fuera diferente, aunque coincide con la consulta de la misma manera.</span><span class="sxs-lookup"><span data-stu-id="83a2a-329">It might be surprising that the relevance score for document 2 and 3 is different even though they matched the query in the same way.</span></span> <span data-ttu-id="83a2a-330">Se debe a que la fórmula de puntuación tiene más componentes que simplemente TF/IDF.</span><span class="sxs-lookup"><span data-stu-id="83a2a-330">It's because the scoring formula has more components than just TF/IDF.</span></span> <span data-ttu-id="83a2a-331">En este caso, al documento 3 se le asignó una puntuación ligeramente superior porque su descripción es más corta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-331">In this case, document 3 was assigned a slightly higher score because its description is shorter.</span></span> <span data-ttu-id="83a2a-332">Obtenga información sobre [Fórmula de puntuación práctica de Lucene](https://lucene.apache.org/core/4_0_0/core/org/apache/lucene/search/similarities/TFIDFSimilarity.html) para entender cómo longitud de campo y otros factores pueden influir en la puntuación por relevancia.</span><span class="sxs-lookup"><span data-stu-id="83a2a-332">Learn about [Lucene's Practical Scoring Formula](https://lucene.apache.org/core/4_0_0/core/org/apache/lucene/search/similarities/TFIDFSimilarity.html) to understand how field length and other factors can influence the relevance score.</span></span>

<span data-ttu-id="83a2a-333">Algunos tipos de consulta (comodín, prefijo y regex) siempre aportan una puntuación constante a la puntuación total del documento.</span><span class="sxs-lookup"><span data-stu-id="83a2a-333">Some query types (wildcard, prefix, regex) always contribute a constant score to the overall document score.</span></span> <span data-ttu-id="83a2a-334">Esto permite la inclusión de las coincidencias encontradas a través de la expansión de consultas en los resultados, pero sin que ello afecte a la clasificación.</span><span class="sxs-lookup"><span data-stu-id="83a2a-334">This allows matches found through query expansion to be included in the results, but without affecting the ranking.</span></span> 

<span data-ttu-id="83a2a-335">El ejemplo muestra por qué esto es importante.</span><span class="sxs-lookup"><span data-stu-id="83a2a-335">An example illustrates why this matters.</span></span> <span data-ttu-id="83a2a-336">Las búsquedas con caracteres comodín, incluidas las búsquedas de prefijo, son ambiguas por definición, dado que la entrada es una cadena parcial con coincidencias posibles en un gran número de términos dispares (tenga en cuenta una entrada de "tour*", con las coincidencias encontradas en "tours", "tourettes" y "touroperador").</span><span class="sxs-lookup"><span data-stu-id="83a2a-336">Wildcard searches, including prefix searches, are ambiguous by definition because the input is a partial string with potential matches on a very large number of disparate terms (consider an input of "tour*", with matches found on “tours”, “tourettes”, and “tourmaline”).</span></span> <span data-ttu-id="83a2a-337">Dada la naturaleza de estos resultados, no hay ninguna manera razonable de deducir qué términos son más valiosos que los demás.</span><span class="sxs-lookup"><span data-stu-id="83a2a-337">Given the nature of these results, there is no way to reasonably infer which terms are more valuable than others.</span></span> <span data-ttu-id="83a2a-338">Por este motivo, se omiten las frecuencias de término cuando realiza la puntuación de resultados en consultas de tipo caracteres comodín, prefijo y regex.</span><span class="sxs-lookup"><span data-stu-id="83a2a-338">For this reason, we ignore term frequencies when scoring results in queries of types wildcard, prefix and regex.</span></span> <span data-ttu-id="83a2a-339">En una solicitud de búsqueda de varias partes que incluye términos parciales y totales, se incorporan los resultados de la entrada parcial con una puntuación constante para evitar un sesgo hacia coincidencias potencialmente inesperadas.</span><span class="sxs-lookup"><span data-stu-id="83a2a-339">In a multi-part search request that includes partial and complete terms, results from the partial input are incorporated with a constant score to avoid bias towards potentially unexpected matches.</span></span>

### <a name="score-tuning"></a><span data-ttu-id="83a2a-340">Optimización de la puntuación</span><span class="sxs-lookup"><span data-stu-id="83a2a-340">Score tuning</span></span>

<span data-ttu-id="83a2a-341">Existen dos maneras de optimizar las puntuaciones de relevancia en Azure Search:</span><span class="sxs-lookup"><span data-stu-id="83a2a-341">There are two ways to tune relevance scores in Azure Search:</span></span>

1. <span data-ttu-id="83a2a-342">Los **perfiles de puntuación** favorecen a los documentos de la lista de clasificación basados en un conjunto de reglas.</span><span class="sxs-lookup"><span data-stu-id="83a2a-342">**Scoring profiles** promote documents in the ranked list of results based on a set of rules.</span></span> <span data-ttu-id="83a2a-343">En nuestro ejemplo, podemos considerar los documentos que coincidieron en el campo de título más importantes que los documentos que coincidieron en el campo de descripción.</span><span class="sxs-lookup"><span data-stu-id="83a2a-343">In our example, we could consider documents that matched in the title field more relevant than documents that matched in the description field.</span></span> <span data-ttu-id="83a2a-344">Además, si el índice tenía un campo de precio para cada hotel, podríamos favorecer a los documentos con un precio menor.</span><span class="sxs-lookup"><span data-stu-id="83a2a-344">Additionally, if our index had a price field for each hotel, we could promote documents with lower price.</span></span> <span data-ttu-id="83a2a-345">Obtenga información sobre cómo [agregar perfiles de puntuación a un índice de búsqueda.](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index)</span><span class="sxs-lookup"><span data-stu-id="83a2a-345">Learn more how to [add Scoring Profiles to a search index.](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index)</span></span>
2. <span data-ttu-id="83a2a-346">**Priorización de términos** (disponible solo en la sintaxis de consulta completa Lucene) proporciona un operador de priorización `^` que puede aplicarse a cualquier parte del árbol de consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-346">**Term boosting** (available only in the Full Lucene query syntax) provides a boosting operator `^` that can be applied to any part of the query tree.</span></span> <span data-ttu-id="83a2a-347">En nuestro ejemplo, en lugar de buscar en el prefijo *post-vacacional*\*, puede buscar el término exacto *post-vacacional* o el prefijo, pero los documentos que coinciden con el término exacto se clasifican en una posición superior aplicando la priorización a la consulta de término: *post-vacacional^2||post-vacacional**.</span><span class="sxs-lookup"><span data-stu-id="83a2a-347">In our example, instead of searching on the prefix *air-condition*\*, one could search for either the exact term *air-condition* or the prefix, but documents that match on the exact term are ranked higher by applying boost to the term query: *air-condition^2||air-condition**.</span></span> <span data-ttu-id="83a2a-348">Más información sobre la [priorización de términos](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search#bkmk_termboost).</span><span class="sxs-lookup"><span data-stu-id="83a2a-348">Learn more about [term boosting](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search#bkmk_termboost).</span></span>


### <a name="scoring-in-a-distributed-index"></a><span data-ttu-id="83a2a-349">Puntuación en un índice distribuido</span><span class="sxs-lookup"><span data-stu-id="83a2a-349">Scoring in a distributed index</span></span>

<span data-ttu-id="83a2a-350">Todos los índices de Azure Search se dividen automáticamente en varias particiones, lo que nos permite distribuir rápidamente el índice en varios nodos durante el escalado vertical o la reducción vertical del servicio.</span><span class="sxs-lookup"><span data-stu-id="83a2a-350">All indexes in Azure Search are automatically split into multiple shards, allowing us to quickly distribute the index among multiple nodes during service scale up or scale down.</span></span> <span data-ttu-id="83a2a-351">Cuando se emite una solicitud de búsqueda, se emite de forma independiente en cada partición.</span><span class="sxs-lookup"><span data-stu-id="83a2a-351">When a search request is issued, it’s issued against each shard independently.</span></span> <span data-ttu-id="83a2a-352">Los resultados de cada partición se combinan y se ordenan por puntuación (si no se ha definido ningún otro orden).</span><span class="sxs-lookup"><span data-stu-id="83a2a-352">The results from each shard are then merged and ordered by score (if no other ordering is defined).</span></span> <span data-ttu-id="83a2a-353">Es importante saber que la función de puntuación mide la frecuencia del término de consulta con la frecuencia inversa del documento en todos los documentos dentro de la partición, no en todas las particiones.</span><span class="sxs-lookup"><span data-stu-id="83a2a-353">It is important to know that the scoring function weights query term frequency against its inverse document frequency in all documents within the shard, not across all shards!</span></span>

<span data-ttu-id="83a2a-354">Esto significa que una puntuación por relevancia *puede* ser diferente para los documentos idénticos si residen en diferentes particiones.</span><span class="sxs-lookup"><span data-stu-id="83a2a-354">This means a relevance score *could* be different for identical documents if they reside on different shards.</span></span> <span data-ttu-id="83a2a-355">Afortunadamente, estas diferencias tienden a desaparecer a medida que aumenta el número de documentos en el índice debido a una mejor distribución de los términos.</span><span class="sxs-lookup"><span data-stu-id="83a2a-355">Fortunately, such differences tend to disappear as the number of documents in the index grows due to more even term distribution.</span></span> <span data-ttu-id="83a2a-356">No es posible suponer en qué partición se colocará un documento determinado.</span><span class="sxs-lookup"><span data-stu-id="83a2a-356">It’s not possible to assume on which shard any given document will be placed.</span></span> <span data-ttu-id="83a2a-357">Sin embargo, suponiendo que la clave de documento no cambie, siempre se asignará a la misma partición.</span><span class="sxs-lookup"><span data-stu-id="83a2a-357">However, assuming a document key doesn't change, it will always be assigned to the same shard.</span></span>

<span data-ttu-id="83a2a-358">En general, la puntuación del documento no es el mejor atributo para ordenar los documentos si la estabilidad del orden es importante.</span><span class="sxs-lookup"><span data-stu-id="83a2a-358">In general, document score is not the best attribute for ordering documents if order stability is important.</span></span> <span data-ttu-id="83a2a-359">Por ejemplo, en dos documentos con una puntuación idéntica, no hay ninguna garantía del que aparecerá en primer lugar en las ejecuciones posteriores de la misma consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-359">For example, given two document with an identical score, there is no guarantee which one appears first in subsequent runs of the same query.</span></span> <span data-ttu-id="83a2a-360">La puntuación del documento solo debe proporcionar una idea general de la relevancia del documento con respecto a otros documentos en el conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-360">Document score should only give a general sense of document relevance relative to other documents in the results set.</span></span>

## <a name="conclusion"></a><span data-ttu-id="83a2a-361">Conclusión</span><span class="sxs-lookup"><span data-stu-id="83a2a-361">Conclusion</span></span>

<span data-ttu-id="83a2a-362">El éxito de los motores de búsqueda de Internet ha generado expectativas para la búsqueda de texto completo sobre datos privados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-362">The success of internet search engines has raised expectations for full text search over private data.</span></span> <span data-ttu-id="83a2a-363">Para casi cualquier tipo de experiencia de búsqueda, esperamos que el motor comprenda nuestra intención, incluso cuando los términos son incorrectos o están incompletos.</span><span class="sxs-lookup"><span data-stu-id="83a2a-363">For almost any kind of search experience, we now expect the engine to understand our intent, even when terms are misspelled or incomplete.</span></span> <span data-ttu-id="83a2a-364">Esperamos incluso coincidencias basadas en términos casi equivalentes o sinónimos que realmente nunca hemos especificado.</span><span class="sxs-lookup"><span data-stu-id="83a2a-364">We might even expect matches based on near equivalent terms or synonyms that we never actually specified.</span></span>

<span data-ttu-id="83a2a-365">Desde un punto de vista técnico, la búsqueda de texto completo es muy compleja, lo que requiere un análisis lingüístico sofisticado y un enfoque sistemático para el procesamiento de forma que sintetice, expanda y transforme términos de consulta para proporcionar un resultado relevante.</span><span class="sxs-lookup"><span data-stu-id="83a2a-365">From a technical standpoint, full text search is highly complex, requiring sophisticated linguistic analysis and a systematic approach to processing in ways that distill, expand, and transform query terms to deliver a relevant result.</span></span> <span data-ttu-id="83a2a-366">Dada la complejidad inherente, existen muchos factores que pueden afectar al resultado de una consulta.</span><span class="sxs-lookup"><span data-stu-id="83a2a-366">Given the inherent complexities, there are a lot of factors that can affect the outcome of a query.</span></span> <span data-ttu-id="83a2a-367">Por esta razón, dedique tiempo a comprender las ventajas concretas que ofrece la mecánica de la búsqueda de texto completo cuando intenta trabajar con resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-367">For this reason, investing the time to understand the mechanics of full text search offers tangible benefits when trying to work through unexpected results.</span></span>  

<span data-ttu-id="83a2a-368">En este artículo se ha analizado la búsqueda de texto completo en el contexto de Azure Search.</span><span class="sxs-lookup"><span data-stu-id="83a2a-368">This article explored full text search in the context of Azure Search.</span></span> <span data-ttu-id="83a2a-369">Esperamos haberle proporcionado información suficiente como para reconocer las posibles causas y soluciones para resolver problemas de consultas comunes.</span><span class="sxs-lookup"><span data-stu-id="83a2a-369">We hope it gives you sufficient background to recognize potential causes and resolutions for addressing common query problems.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="83a2a-370">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="83a2a-370">Next steps</span></span>

+ <span data-ttu-id="83a2a-371">Generar el índice de ejemplo, probar distintas consultas y revisar los resultados.</span><span class="sxs-lookup"><span data-stu-id="83a2a-371">Build the sample index, try out different queries and review results.</span></span> <span data-ttu-id="83a2a-372">Para obtener instrucciones, vea [Creación y consulta de un índice en el portal](search-get-started-portal.md#query-index).</span><span class="sxs-lookup"><span data-stu-id="83a2a-372">For instructions, see [Build and query an index in the portal](search-get-started-portal.md#query-index).</span></span>

+ <span data-ttu-id="83a2a-373">Probar la sintaxis de consulta adicional de la sección de ejemplo [Buscar documentos](https://docs.microsoft.com/rest/api/searchservice/search-documents#examples) o desde [Sintaxis de consulta simple](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search) en el explorador de búsqueda en el portal.</span><span class="sxs-lookup"><span data-stu-id="83a2a-373">Try additional query syntax from the [Search Documents](https://docs.microsoft.com/rest/api/searchservice/search-documents#examples) example section or from [Simple query syntax](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search) in Search explorer in the portal.</span></span>

+ <span data-ttu-id="83a2a-374">Revisar los [perfiles de puntuación](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index) si desea ajustar la clasificación en la aplicación de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="83a2a-374">Review [scoring profiles](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index) if you want to tune ranking in your search application.</span></span>

+ <span data-ttu-id="83a2a-375">Obtener información sobre cómo aplicar [analizadores léxicos específicos del idioma](https://docs.microsoft.com/rest/api/searchservice/language-support).</span><span class="sxs-lookup"><span data-stu-id="83a2a-375">Learn how to apply [language-specific lexical analyzers](https://docs.microsoft.com/rest/api/searchservice/language-support).</span></span>

+ <span data-ttu-id="83a2a-376">[Configurar los analizadores personalizados](https://docs.microsoft.com/rest/api/searchservice/custom-analyzers-in-azure-search) para un procesamiento mínimo o especializado en campos específicos.</span><span class="sxs-lookup"><span data-stu-id="83a2a-376">[Configure custom analyzers](https://docs.microsoft.com/rest/api/searchservice/custom-analyzers-in-azure-search) for either minimal processing or specialized processing on specific fields.</span></span>

+ <span data-ttu-id="83a2a-377">[Comparar el analizador estándar y el analizador de inglés](http://alice.unearth.ai/) en paralelo en este sitio web de demostración.</span><span class="sxs-lookup"><span data-stu-id="83a2a-377">[Compare standard and English analyzers](http://alice.unearth.ai/)) side-by-side on this demo web site.</span></span> 

## <a name="see-also"></a><span data-ttu-id="83a2a-378">Otras referencias</span><span class="sxs-lookup"><span data-stu-id="83a2a-378">See also</span></span>

[<span data-ttu-id="83a2a-379">API de REST de documentos de búsqueda</span><span class="sxs-lookup"><span data-stu-id="83a2a-379">Search Documents REST API</span></span>](https://docs.microsoft.com/rest/api/searchservice/search-documents)

[<span data-ttu-id="83a2a-380">Sintaxis de consulta simplificada</span><span class="sxs-lookup"><span data-stu-id="83a2a-380">Simple query syntax</span></span>](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search)

[<span data-ttu-id="83a2a-381">Sintaxis de consulta completa de Lucene </span><span class="sxs-lookup"><span data-stu-id="83a2a-381">Full Lucene query syntax</span></span>](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search)

[<span data-ttu-id="83a2a-382">Control de los resultados de la búsqueda</span><span class="sxs-lookup"><span data-stu-id="83a2a-382">Handle search results</span></span>](https://docs.microsoft.com/azure/search/search-pagination-page-layout)

<!--Image references-->
[1]: ./media/search-lucene-query-architecture/architecture-diagram2.png
[2]: ./media/search-lucene-query-architecture/azSearch-queryparsing-should2.png
[3]: ./media/search-lucene-query-architecture/azSearch-queryparsing-must2.png
[4]: ./media/search-lucene-query-architecture/azSearch-queryparsing-spacious2.png
