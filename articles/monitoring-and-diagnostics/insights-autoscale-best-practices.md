---
title: "prácticas recomendadas de aaaBest para el escalado automático | Documentos de Microsoft"
description: "Patrones de escalado automático en Azure para Web Apps, conjunto de escalado de máquinas virtuales y Cloud Services"
author: anirudhcavale
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 9fa2b94b-dfa5-4106-96ff-74fd1fba4657
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/07/2017
ms.author: ancav
ms.openlocfilehash: eb731c15e440af93a2675210583878814d0d8818
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-autoscale"></a><span data-ttu-id="8b6e5-103">Procedimientos recomendados de escalado automático</span><span class="sxs-lookup"><span data-stu-id="8b6e5-103">Best practices for Autoscale</span></span>
<span data-ttu-id="8b6e5-104">En este artículo se explica tooautoscale de prácticas recomendada en Azure.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-104">This article teaches best practices tooautoscale in Azure.</span></span> <span data-ttu-id="8b6e5-105">Azure escalado automático de Monitor se aplica solo demasiado[conjuntos de escalas de máquina Virtual](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [servicios en la nube](https://azure.microsoft.com/services/cloud-services/), y [servicio de aplicaciones: aplicaciones Web](https://azure.microsoft.com/services/app-service/web/).</span><span class="sxs-lookup"><span data-stu-id="8b6e5-105">Azure Monitor autoscale applies only too[Virtual Machine Scale Sets](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [Cloud Services](https://azure.microsoft.com/services/cloud-services/), and [App Service - Web Apps](https://azure.microsoft.com/services/app-service/web/).</span></span> <span data-ttu-id="8b6e5-106">Otros servicios de Azure usan distintos métodos de escalado.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-106">Other Azure services use different scaling methods.</span></span>

## <a name="autoscale-concepts"></a><span data-ttu-id="8b6e5-107">Conceptos de escalado automático</span><span class="sxs-lookup"><span data-stu-id="8b6e5-107">Autoscale concepts</span></span>
* <span data-ttu-id="8b6e5-108">Un recurso solo puede tener *una* configuración de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-108">A resource can have only *one* autoscale setting</span></span>
* <span data-ttu-id="8b6e5-109">Una configuración de escalado automático puede tener uno o varios perfiles y cada perfil, a su vez, puede tener una o varias reglas de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-109">An autoscale setting can have one or more profiles and each profile can have one or more autoscale rules.</span></span>
* <span data-ttu-id="8b6e5-110">Una configuración de Autoescala escala instancias horizontalmente, que es *out* aumentando instancias de Hola y *en* reduciendo el número de Hola de instancias.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-110">An autoscale setting scales instances horizontally, which is *out* by increasing hello instances and *in* by decreasing hello number of instances.</span></span>
  <span data-ttu-id="8b6e5-111">Una configuración de escalado automático presenta unos valores máximo, mínimo y predeterminado de instancias.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-111">An autoscale setting has a maximum, minimum, and default value of instances.</span></span>
* <span data-ttu-id="8b6e5-112">Un trabajo de escalado automático siempre lee Hola asociado tooscale métrica activando, si alcanzó el umbral configurado de Hola de escalabilidad horizontal o en escala.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-112">An autoscale job always reads hello associated metric tooscale by, checking if it has crossed hello configured threshold for scale-out or scale-in.</span></span> <span data-ttu-id="8b6e5-113">En [Métricas comunes de escalado automático de Azure Monitor](insights-autoscale-common-metrics.md) encontrará una lista de métricas por las que el escalado automático puede escalar.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-113">You can view a list of metrics that autoscale can scale by at [Azure Monitor autoscaling common metrics](insights-autoscale-common-metrics.md).</span></span>
* <span data-ttu-id="8b6e5-114">Todos los umbrales se calculan en el nivel de instancia.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-114">All thresholds are calculated at an instance level.</span></span> <span data-ttu-id="8b6e5-115">Por ejemplo, "escala a través de 1 instancia al promedio de CPU > 80% al recuento de instancias es 2", significa escalado horizontal cuando Hola promedio de CPU en todas las instancias es superior al 80%.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-115">For example, "scale out by 1 instance when average CPU > 80% when instance count is 2", means scale-out when hello average CPU across all instances is greater than 80%.</span></span>
* <span data-ttu-id="8b6e5-116">Las notificaciones de error siempre se reciben por correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-116">You always receive failure notifications via email.</span></span> <span data-ttu-id="8b6e5-117">En concreto, Hola propietario, Colaborador y los lectores de recurso de destino de Hola reciban correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-117">Specifically, hello owner, contributor, and readers of hello target resource receive email.</span></span> <span data-ttu-id="8b6e5-118">Además, siempre se recibe un correo electrónico de *recuperación* cuando el escalado automático se recupere de un error y comience a funcionar con normalidad.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-118">You also always receive a *recovery* email when autoscale recovers from a failure and starts functioning normally.</span></span>
* <span data-ttu-id="8b6e5-119">Pueden participar en tooreceive una notificación de acción de escala correctamente a través de correo electrónico y webhook.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-119">You can opt-in tooreceive a successful scale action notification via email and webhooks.</span></span>

## <a name="autoscale-best-practices"></a><span data-ttu-id="8b6e5-120">Procedimientos recomendados de escalado automático</span><span class="sxs-lookup"><span data-stu-id="8b6e5-120">Autoscale best practices</span></span>
<span data-ttu-id="8b6e5-121">Usar hello seguir las prácticas recomendadas que usen el escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-121">Use hello following best practices as you use autoscale.</span></span>

### <a name="ensure-hello-maximum-and-minimum-values-are-different-and-have-an-adequate-margin-between-them"></a><span data-ttu-id="8b6e5-122">Asegúrese de valores máximos y mínimos de hello son diferentes y tienen un margen suficiente entre ellos</span><span class="sxs-lookup"><span data-stu-id="8b6e5-122">Ensure hello maximum and minimum values are different and have an adequate margin between them</span></span>
<span data-ttu-id="8b6e5-123">Si tiene una configuración que tenga como mínimo = 2, máximo = 2 y el recuento de instancias actual de hello es 2, no se puede producir ninguna acción de escala.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-123">If you have a setting that has minimum=2, maximum=2 and hello current instance count is 2, no scale action can occur.</span></span> <span data-ttu-id="8b6e5-124">Mantener un margen suficiente entre los recuentos de instancias máximo y mínimo de hello, que son inclusivos.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-124">Keep an adequate margin between hello maximum and minimum instance counts, which are inclusive.</span></span> <span data-ttu-id="8b6e5-125">El escalado automático siempre escala entre estos límites.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-125">Autoscale always scales between these limits.</span></span>

### <a name="manual-scaling-is-reset-by-autoscale-min-and-max"></a><span data-ttu-id="8b6e5-126">El escalado manual se restablece al valor máximo y mínimo de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-126">Manual scaling is reset by autoscale min and max</span></span>
<span data-ttu-id="8b6e5-127">Si actualizar Hola instancia recuento tooa valor anterior o por debajo del máximo de hello, Hola motor de escalado automático automáticamente manualmente escala mínima atrás toohello (si está por debajo) o hello máximo (si está por encima).</span><span class="sxs-lookup"><span data-stu-id="8b6e5-127">If you manually update hello instance count tooa value above or below hello maximum, hello autoscale engine automatically scales back toohello minimum (if below) or hello maximum (if above).</span></span> <span data-ttu-id="8b6e5-128">Por ejemplo, establecer intervalo de hello entre 3 y 6.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-128">For example, you set hello range between 3 and 6.</span></span> <span data-ttu-id="8b6e5-129">Si tiene una instancia en ejecución, motor de escalado automático de hello escala too3 instancias en su siguiente ejecución.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-129">If you have one running instance, hello autoscale engine scales too3 instances on its next run.</span></span> <span data-ttu-id="8b6e5-130">Del mismo modo, podría escala de 8 instancias encenderlo too6 su siguiente ejecución.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-130">Likewise, it would scale-in 8 instances back too6 on its next run.</span></span>  <span data-ttu-id="8b6e5-131">Ajuste manual de tamaño es muy temporal a menos que restablezca también las reglas de escalado automático de Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-131">Manual scaling is very temporary unless you reset hello autoscale rules as well.</span></span>

### <a name="always-use-a-scale-out-and-scale-in-rule-combination-that-performs-an-increase-and-decrease"></a><span data-ttu-id="8b6e5-132">Use siempre una combinación de reglas de escalado horizontal y reducción horizontal que realice un aumento y una disminución.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-132">Always use a scale-out and scale-in rule combination that performs an increase and decrease</span></span>
<span data-ttu-id="8b6e5-133">Si usa solo una parte de la combinación de hello, escalado automático escala de que solo out, o bien en hasta el máximo de hello, o como mínimo, se alcanza.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-133">If you use only one part of hello combination, autoscale scale-in that single out, or in, until hello maximum, or minimum, is reached.</span></span>

### <a name="do-not-switch-between-hello-azure-portal-and-hello-azure-classic-portal-when-managing-autoscale"></a><span data-ttu-id="8b6e5-134">No cambie entre Hola portal de Azure y Hola portal de Azure clásico al administrar el escalado automático</span><span class="sxs-lookup"><span data-stu-id="8b6e5-134">Do not switch between hello Azure portal and hello Azure classic portal when managing Autoscale</span></span>
<span data-ttu-id="8b6e5-135">Para los servicios de nube y servicios de aplicaciones (aplicaciones Web), utilice toocreate de portal de Azure (portal.azure.com) de Hola y administrar la configuración de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-135">For Cloud Services and App Services (Web Apps), use hello Azure portal (portal.azure.com) toocreate and manage autoscale settings.</span></span> <span data-ttu-id="8b6e5-136">Para conjuntos de escalas de máquina Virtual utilice toocreate de PowerShell, CLI o API de REST y administrar la configuración de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-136">For Virtual Machine Scale Sets use PowerShell, CLI or REST API toocreate and manage autoscale setting.</span></span> <span data-ttu-id="8b6e5-137">No se intercambian entre el portal de Azure clásico (manage.windowsazure.com) de Hola y Hola portal de Azure (portal.azure.com) al administrar configuraciones de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-137">Do not switch between hello Azure classic portal (manage.windowsazure.com) and hello Azure portal (portal.azure.com) when managing autoscale configurations.</span></span> <span data-ttu-id="8b6e5-138">Hola portal de Azure clásico y su back-end subyacente tiene limitaciones.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-138">hello Azure classic portal and its underlying backend has limitations.</span></span> <span data-ttu-id="8b6e5-139">Mueva el escalado automático de Azure toomanage portal toohello mediante una interfaz gráfica de usuario.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-139">Move toohello Azure portal toomanage autoscale using a graphical user interface.</span></span> <span data-ttu-id="8b6e5-140">Opciones de Hello son toouse Hola Autoescala PowerShell, la CLI o la API de REST (a través del explorador de recursos de Azure).</span><span class="sxs-lookup"><span data-stu-id="8b6e5-140">hello options are toouse hello autoscale PowerShell, CLI or REST API (via Azure Resource Explorer).</span></span>

### <a name="choose-hello-appropriate-statistic-for-your-diagnostics-metric"></a><span data-ttu-id="8b6e5-141">Elija estadística adecuada de hello para la métrica de diagnósticos</span><span class="sxs-lookup"><span data-stu-id="8b6e5-141">Choose hello appropriate statistic for your diagnostics metric</span></span>
<span data-ttu-id="8b6e5-142">Para las métricas de diagnóstico, puede elegir entre *Media*, *mínimo*, *máximo* y *Total* como una métrica tooscale por.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-142">For diagnostics metrics, you can choose among *Average*, *Minimum*, *Maximum* and *Total* as a metric tooscale by.</span></span> <span data-ttu-id="8b6e5-143">estadística de Hello más común es *Media*.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-143">hello most common statistic is *Average*.</span></span>

### <a name="choose-hello-thresholds-carefully-for-all-metric-types"></a><span data-ttu-id="8b6e5-144">Elija los umbrales de hello cuidadosamente para todos los tipos de métrica</span><span class="sxs-lookup"><span data-stu-id="8b6e5-144">Choose hello thresholds carefully for all metric types</span></span>
<span data-ttu-id="8b6e5-145">Es recomendable tener cuidado a la hora de elegir los diferentes umbrales de escalado y reducción horizontal en función de las situaciones prácticas.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-145">We recommend carefully choosing different thresholds for scale-out and scale-in based on practical situations.</span></span>

<span data-ttu-id="8b6e5-146">Se *no se recomienda* Hola a opciones de escalado automático como ejemplos de hello siguientes con valores de umbral igual o muy similar para y en condiciones:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-146">We *do not recommend* autoscale settings like hello examples below with hello same or very similar threshold values for out and in conditions:</span></span>

* <span data-ttu-id="8b6e5-147">Aumentar las instancias en 1 cuando el número de subprocesos < = 600</span><span class="sxs-lookup"><span data-stu-id="8b6e5-147">Increase instances by 1 count when Thread Count <= 600</span></span>
* <span data-ttu-id="8b6e5-148">Disminuir las instancias en 1 cuando el número de subprocesos > = 600</span><span class="sxs-lookup"><span data-stu-id="8b6e5-148">Decrease instances by 1 count when Thread Count >= 600</span></span>

<span data-ttu-id="8b6e5-149">Veamos un ejemplo de lo que puede provocar el comportamiento de tooa que puede parecer confuso.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-149">Let's look at an example of what can lead tooa behavior that may seem confusing.</span></span> <span data-ttu-id="8b6e5-150">Considere la posibilidad de hello después de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-150">Consider hello following sequence.</span></span>

1. <span data-ttu-id="8b6e5-151">Suponga que hay 2 toobegin de instancias con y, a continuación, promedio de Hola de subprocesos por instancia crece too625.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-151">Assume there are 2 instances toobegin with and then hello average number of threads per instance grows too625.</span></span>
2. <span data-ttu-id="8b6e5-152">El escalado automático escala horizontalmente agregando una tercera instancia.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-152">Autoscale scales out adding a 3rd instance.</span></span>
3. <span data-ttu-id="8b6e5-153">A continuación, se supone que el número de subprocesos de promedio de Hola a través de la instancia está too575.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-153">Next, assume that hello average thread count across instance falls too575.</span></span>
4. <span data-ttu-id="8b6e5-154">Antes de escalar hacia abajo, escalado automático intenta tooestimate qué estado final Hola será si escala en.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-154">Before scaling down, autoscale tries tooestimate what hello final state will be if it scaled in.</span></span> <span data-ttu-id="8b6e5-155">Por ejemplo, 575 x 3 (número de instancias actual) = 1725/2 (número final de instancias al reducir verticalmente) = 862,5 subprocesos.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-155">For example, 575 x  3 (current instance count) = 1,725 / 2 (final number of instances when scaled down) = 862.5 threads.</span></span> <span data-ttu-id="8b6e5-156">Esto significa escalado automático tendría tooimmediately escalabilidad nuevo incluso después de que escalan en, si Hola subproceso promedio recuento sigue siendo Hola mismo o incluso cae solo una cantidad reducida.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-156">This means autoscale would have tooimmediately scale-out again even after it scaled in, if hello average thread count remains hello same or even falls only a small amount.</span></span> <span data-ttu-id="8b6e5-157">Sin embargo, si escalado una vez más, debería repetir el proceso completo de hello, iniciales tooan de bucle infinito.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-157">However, if it scaled up again, hello whole process would repeat, leading tooan infinite loop.</span></span>
5. <span data-ttu-id="8b6e5-158">tooavoid esta situación (lo que se denomina "aleteo"), escalado automático no se escala hacia abajo en absoluto.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-158">tooavoid this situation (termed "flapping"), autoscale does not scale down at all.</span></span> <span data-ttu-id="8b6e5-159">En su lugar, se omite y se vuelve a evaluar condición de hello nuevo trabajo de hello siguiente tiempo Hola del servicio se ejecute.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-159">Instead, it skips and reevaluates hello condition again hello next time hello service's job executes.</span></span> <span data-ttu-id="8b6e5-160">Esto puede confundir a muchas personas porque escalado automático no aparecería toowork cuando el recuento de subprocesos promedio de hello 575.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-160">This could confuse many people because autoscale wouldn't appear toowork when hello average thread count was 575.</span></span>

<span data-ttu-id="8b6e5-161">Estimación durante la escala es previsto tooavoid "oscilante" situaciones, donde las acciones de escala y escalado horizontal continuamente avanzar y retroceder.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-161">Estimation during a scale-in is intended tooavoid "flapping" situations, where scale-in and scale-out actions continually go back and forth.</span></span> <span data-ttu-id="8b6e5-162">Tenga este comportamiento en cuenta al elegir Hola mismos umbrales para la implementación escalada y en.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-162">Keep this behavior in mind when you choose hello same thresholds for scale-out and in.</span></span>

<span data-ttu-id="8b6e5-163">Se recomienda elegir un margen suficiente entre Hola de escalado horizontal y de los umbrales.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-163">We recommend choosing an adequate margin between hello scale-out and in thresholds.</span></span> <span data-ttu-id="8b6e5-164">Por ejemplo, considere la posibilidad de hello siguiendo la mejor combinación de regla.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-164">As an example, consider hello following better rule combination.</span></span>

* <span data-ttu-id="8b6e5-165">Aumentar las instancias en 1 cuando el porcentaje de CPU > = 80</span><span class="sxs-lookup"><span data-stu-id="8b6e5-165">Increase instances by 1 count when CPU%  >= 80</span></span>
* <span data-ttu-id="8b6e5-166">Disminuir las instancias en 1 cuando el porcentaje de CPU > = 60</span><span class="sxs-lookup"><span data-stu-id="8b6e5-166">Decrease instances by 1 count when CPU% <= 60</span></span>

<span data-ttu-id="8b6e5-167">En este caso</span><span class="sxs-lookup"><span data-stu-id="8b6e5-167">In this case</span></span>  

1. <span data-ttu-id="8b6e5-168">Suponga que hay 2 toostart de instancias con.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-168">Assume there are 2 instances toostart with.</span></span>
2. <span data-ttu-id="8b6e5-169">Si deja de Hola % de CPU promedio en todas las instancias too80, escalado automático admita la ampliación horizontal al agregar una tercera instancia.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-169">If hello average CPU% across instances goes too80, autoscale scales out adding a third instance.</span></span>
3. <span data-ttu-id="8b6e5-170">Ahora suponga que a través de tiempo Hola CPU % está too60.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-170">Now assume that over time hello CPU% falls too60.</span></span>
4. <span data-ttu-id="8b6e5-171">De escala regla del escalado automático calcula el estado final de hello si estuviera en tooscale.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-171">Autoscale's scale-in rule estimates hello final state if it were tooscale-in.</span></span> <span data-ttu-id="8b6e5-172">Por ejemplo, 60 x 3 (número de instancias actual) = 180/2 (número final de instancias al reducir verticalmente) = 90.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-172">For example, 60 x 3 (current instance count) = 180 / 2 (final number of instances when scaled down) = 90.</span></span> <span data-ttu-id="8b6e5-173">Por lo tanto escalado automático no escala de ya que tendría tooscale horizontal nuevo inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-173">So autoscale does not scale-in because it would have tooscale-out again immediately.</span></span> <span data-ttu-id="8b6e5-174">En su lugar, omite la reducción vertical.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-174">Instead, it skips scaling down.</span></span>
5. <span data-ttu-id="8b6e5-175">las comprobaciones de escalado automático de tiempo siguiente Hello, Hola CPU continúa toofall too50.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-175">hello next time autoscale checks, hello CPU continues toofall too50.</span></span> <span data-ttu-id="8b6e5-176">Lo nuevo - estima la instancia de 50 x 3 = 150 / 2 instancias = 75, que por debajo del umbral de escalado horizontal de Hola de 80, por lo que se escala en instancias de too2 correctamente.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-176">It estimates again -  50 x 3 instance = 150 / 2 instances = 75, which is below hello scale-out threshold of 80, so it scales in successfully too2 instances.</span></span>

### <a name="considerations-for-scaling-threshold-values-for-special-metrics"></a><span data-ttu-id="8b6e5-177">Consideraciones para establecer valores de umbral de escalado en métricas especiales</span><span class="sxs-lookup"><span data-stu-id="8b6e5-177">Considerations for scaling threshold values for special metrics</span></span>
 <span data-ttu-id="8b6e5-178">Para obtener métricas especiales, como métrica de la longitud de cola de Bus de servicio o de almacenamiento, umbral de hello es promedio de Hola de mensajes disponibles por número actual de instancias.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-178">For special metrics such as Storage or Service Bus Queue length metric, hello threshold is hello average number of messages available per current number of instances.</span></span> <span data-ttu-id="8b6e5-179">Elija cuidadosamente Hola elija el valor de umbral de Hola para esta métrica.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-179">Carefully choose hello choose hello threshold value for this metric.</span></span>

<span data-ttu-id="8b6e5-180">Vamos a mostrar con una tooensure de ejemplo que comprende el comportamiento de hello mejor.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-180">Let's illustrate it with an example tooensure you understand hello behavior better.</span></span>

* <span data-ttu-id="8b6e5-181">Aumentar las instancias en 1 cuando el número de mensajes de la cola de almacenamiento > = 50</span><span class="sxs-lookup"><span data-stu-id="8b6e5-181">Increase instances by 1 count when Storage Queue message count >= 50</span></span>
* <span data-ttu-id="8b6e5-182">Disminuir las instancias en 1 cuando el número de mensajes de la cola de almacenamiento < = 10</span><span class="sxs-lookup"><span data-stu-id="8b6e5-182">Decrease instances by 1 count when Storage Queue message count <= 10</span></span>

<span data-ttu-id="8b6e5-183">Considere la posibilidad de hello sigue secuencia:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-183">Consider hello following sequence:</span></span>

1. <span data-ttu-id="8b6e5-184">Hay dos instancias de la cola de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-184">There are 2 storage queue instances.</span></span>
2. <span data-ttu-id="8b6e5-185">Siguen apareciendo mensajes y cuando revise la cola de almacenamiento de hello, número total de hello lee 50.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-185">Messages keep coming and when you review hello storage queue, hello total count reads 50.</span></span> <span data-ttu-id="8b6e5-186">Se supone que el escalado automático tendría que iniciar una acción de escalado horizontal.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-186">You might assume that autoscale should start a scale-out action.</span></span> <span data-ttu-id="8b6e5-187">Sin embargo, vemos que sigue siendo de 50/2 = 25 mensajes por instancia.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-187">However, note that it is still 50/2 = 25 messages per instance.</span></span> <span data-ttu-id="8b6e5-188">Por lo tanto, el escalado horizontal no se ha producido.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-188">So, scale-out does not occur.</span></span> <span data-ttu-id="8b6e5-189">Para hello primer toohappen de escalabilidad horizontal, número total de mensajes de Hola en cola de almacenamiento de hello debe ser 100.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-189">For hello first scale-out toohappen, hello total message count in hello storage queue should be 100.</span></span>
3. <span data-ttu-id="8b6e5-190">A continuación, se supone que recuento total de mensajes de Hola llega a 100.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-190">Next, assume that hello total message count reaches 100.</span></span>
4. <span data-ttu-id="8b6e5-191">Se agrega una instancia de cola de almacenamiento 3rd debido a acción de escalado horizontal de tooa.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-191">A 3rd storage queue instance is added due tooa scale-out action.</span></span>  <span data-ttu-id="8b6e5-192">Hello siguiente acción de escalado horizontal no se realizará hasta Hola total número de mensajes en cola de hello alcanza 150 ya 150/3 = 50.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-192">hello next scale-out action will not happen until hello total message count in hello queue reaches 150 because 150/3 = 50.</span></span>
5. <span data-ttu-id="8b6e5-193">Número de Hola de mensajes en cola de hello obtiene ahora más pequeño.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-193">Now hello number of messages in hello queue gets smaller.</span></span> <span data-ttu-id="8b6e5-194">Con 3 instancias, Hola primera escala de acción que se produce cuando hello total de mensajes en todas las colas de suma too30 porque 30/3 = 10 mensajes por instancia, que es el umbral de escala en Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-194">With 3 instances, hello first scale-in action happens when hello total messages in all queues add up too30 because 30/3 = 10 messages per instance, which is hello scale-in threshold.</span></span>

### <a name="considerations-for-scaling-when-multiple-profiles-are-configured-in-an-autoscale-setting"></a><span data-ttu-id="8b6e5-195">Consideraciones de escalado cuando hay varios perfiles configurados en una configuración de escalado automático</span><span class="sxs-lookup"><span data-stu-id="8b6e5-195">Considerations for scaling when multiple profiles are configured in an autoscale setting</span></span>
<span data-ttu-id="8b6e5-196">En una configuración de escalado automático, puede elegir un perfil predeterminado, que se aplica siempre (independientemente de programaciones o períodos de tiempo), o bien optar por perfil periódico o por un perfil para un período fijo con una fecha y un intervalo de tiempo.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-196">In an autoscale setting, you can choose a default profile, which is always applied without any dependency on schedule or time, or you can choose a recurring profile or a profile for a fixed period with a date and time range.</span></span>

<span data-ttu-id="8b6e5-197">Cuando el servicio de escalado automático procesarlos, siempre se comprueba en hello siguiendo el orden:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-197">When autoscale service processes them, it always checks in hello following order:</span></span>

1. <span data-ttu-id="8b6e5-198">Perfil de fecha fija</span><span class="sxs-lookup"><span data-stu-id="8b6e5-198">Fixed Date profile</span></span>
2. <span data-ttu-id="8b6e5-199">Perfil periódico</span><span class="sxs-lookup"><span data-stu-id="8b6e5-199">Recurring profile</span></span>
3. <span data-ttu-id="8b6e5-200">Perfil predeterminado ("Siempre")</span><span class="sxs-lookup"><span data-stu-id="8b6e5-200">Default ("Always") profile</span></span>

<span data-ttu-id="8b6e5-201">Si se cumple una condición de perfil, escalado automático no condición de comprobación Hola siguiente perfil por debajo de él.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-201">If a profile condition is met, autoscale does not check hello next profile condition below it.</span></span> <span data-ttu-id="8b6e5-202">El escalado automático solo procesa un perfil cada vez.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-202">Autoscale only processes one profile at a time.</span></span> <span data-ttu-id="8b6e5-203">Esto significa que si desea tooalso incluyen una condición de procesamiento de un perfil de nivel inferior, debe incluir esas reglas también en el perfil actual de Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-203">This means if you want tooalso include a processing condition from a lower-tier profile, you must include those rules as well in hello current profile.</span></span>

<span data-ttu-id="8b6e5-204">Analicemos esto con un ejemplo:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-204">Let's review this using an example:</span></span>

<span data-ttu-id="8b6e5-205">Hola imagen siguiente muestra una configuración de escalado automático con un perfil predeterminado de instancias mínimos = 2 y máximas de instancias = 10.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-205">hello image below shows an autoscale setting with a default profile of minimum instances = 2 and maximum instances = 10.</span></span> <span data-ttu-id="8b6e5-206">En este ejemplo, las reglas son configurado tooscale horizontal cuando Hola el número de mensajes en cola de hello es mayor que 10 y escala de cuando Hola el número de mensajes en cola de hello es menor que 3.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-206">In this example, rules are configured tooscale-out when hello message count in hello queue is greater than 10 and scale-in when hello message count in hello queue is less than 3.</span></span> <span data-ttu-id="8b6e5-207">Ahora pueden escalar recursos Hola entre 2 y 10 instancias.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-207">So now hello resource can scale between 2 and 10 instances.</span></span>

<span data-ttu-id="8b6e5-208">Además, hay un perfil periódico establecido para el lunes.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-208">In addition, there is a recurring profile set for Monday.</span></span> <span data-ttu-id="8b6e5-209">Está configurado para un número de instancias mínimo = 2 y un número de instancias máximo = 12.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-209">It is set for minimum instances = 2 and maximum instances = 12.</span></span> <span data-ttu-id="8b6e5-210">Esto significa que el lunes, Hola primera hora escalado automático comprueba esta condición, si el recuento de instancias de hello es 2, se escala toohello nuevo mínimo de 3.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-210">This means on Monday, hello first time autoscale checks for this condition, if hello instance count is 2, it scales toohello new minimum of 3.</span></span> <span data-ttu-id="8b6e5-211">Escalado automático continúa toofind esta condición de perfil coincidente (lunes), siempre y cuando procesa solo basada en CPU Hola escala-out/in reglas configuradas para este perfil.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-211">As long as autoscale continues toofind this profile condition matched (Monday), it only processes hello CPU-based scale-out/in rules configured for this profile.</span></span> <span data-ttu-id="8b6e5-212">En este momento, no comprueba para la longitud de cola de Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-212">At this time, it does not check for hello queue length.</span></span> <span data-ttu-id="8b6e5-213">Sin embargo, si también desea longitud de cola de hello condición toobe activa, debe también incluir esas reglas de perfil predeterminado de hello en el perfil lunes.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-213">However, if you also want hello queue length condition toobe checked, you should include those rules from hello default profile as well in your Monday profile.</span></span>

<span data-ttu-id="8b6e5-214">De forma similar, cuando escalado automático cambia el perfil predeterminado de toohello atrás, en primer lugar comprueba si se cumplen las condiciones mínimo y máximo de Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-214">Similarly, when autoscale switches back toohello default profile, it first checks if hello minimum and maximum conditions are met.</span></span> <span data-ttu-id="8b6e5-215">Si el número de Hola de instancias en tiempo de hello es 12, se escala en too10, Hola máximo permitido para el perfil predeterminado de Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-215">If hello number of instances at hello time is 12, it scales in too10, hello maximum allowed for hello default profile.</span></span>

![configuración de escalado automático](./media/insights-autoscale-best-practices/insights-autoscale-best-practices-2.png)

### <a name="considerations-for-scaling-when-multiple-rules-are-configured-in-a-profile"></a><span data-ttu-id="8b6e5-217">Consideraciones de escalado cuando hay varias reglas configuradas en un perfil</span><span class="sxs-lookup"><span data-stu-id="8b6e5-217">Considerations for scaling when multiple rules are configured in a profile</span></span>
<span data-ttu-id="8b6e5-218">Hay casos en que se pueden tener tooset varias reglas en un perfil.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-218">There are cases where you may have tooset multiple rules in a profile.</span></span> <span data-ttu-id="8b6e5-219">Hola siguiendo el conjunto de reglas de escalado automático se usa mediante el uso de servicios cuando se establecen varias reglas.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-219">hello following set of autoscale rules are used by services use when multiple rules are set.</span></span>

<span data-ttu-id="8b6e5-220">Al *escalar horizontalmente*, el escalado automático se ejecuta si se cumple cualquier regla.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-220">On *scale out*, autoscale runs if any rule is met.</span></span>
<span data-ttu-id="8b6e5-221">En *de escala*, escalado automático requieren que todas las reglas toobe cumplen.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-221">On *scale-in*, autoscale require all rules toobe met.</span></span>

<span data-ttu-id="8b6e5-222">tooillustrate, suponga que ha Hola siguiendo 4 reglas de escalado automático:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-222">tooillustrate, assume that you have hello following 4 autoscale rules:</span></span>

* <span data-ttu-id="8b6e5-223">Con una CPU < 30 %, se reduce horizontalmente en 1</span><span class="sxs-lookup"><span data-stu-id="8b6e5-223">If CPU < 30 %, scale-in by 1</span></span>
* <span data-ttu-id="8b6e5-224">Con una memoria < 50 %, se reduce horizontalmente en 1</span><span class="sxs-lookup"><span data-stu-id="8b6e5-224">If Memory < 50%, scale-in by 1</span></span>
* <span data-ttu-id="8b6e5-225">Con una CPU> 75 %, se escala horizontalmente en 1</span><span class="sxs-lookup"><span data-stu-id="8b6e5-225">If CPU > 75%, scale-out by 1</span></span>
* <span data-ttu-id="8b6e5-226">Con una memoria > 75 %, se escala horizontalmente en 1</span><span class="sxs-lookup"><span data-stu-id="8b6e5-226">If Memory > 75%, scale-out by 1</span></span>

<span data-ttu-id="8b6e5-227">A continuación, se produce Hola seguimiento:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-227">Then hello follow occurs:</span></span>

* <span data-ttu-id="8b6e5-228">Con una CPU del 76 % y una memoria del 50 %, se escala horizontalmente.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-228">If CPU is 76% and Memory is 50%, we scale-out.</span></span>
* <span data-ttu-id="8b6e5-229">Con una CPU del 50 % y una memoria del 76 %, se escala horizontalmente.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-229">If CPU is 50% and Memory is 76% we scale-out.</span></span>

<span data-ttu-id="8b6e5-230">Hola en otra parte, si la CPU es 25% y memoria es hace de escalado automático de 51% **no** en escala.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-230">On hello other hand, if CPU is 25% and memory is 51% autoscale does **not** scale-in.</span></span> <span data-ttu-id="8b6e5-231">En tooscale, CPU debe ser 29% y memoria 49%.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-231">In order tooscale-in, CPU must be 29% and Memory 49%.</span></span>

### <a name="always-select-a-safe-default-instance-count"></a><span data-ttu-id="8b6e5-232">Seleccione siempre un número predeterminado de instancias seguro</span><span class="sxs-lookup"><span data-stu-id="8b6e5-232">Always select a safe default instance count</span></span>
<span data-ttu-id="8b6e5-233">recuento de instancias predeterminadas de Hello es importante de escalado automático escala el recuento de toothat del servicio cuando las métricas no están disponibles.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-233">hello default instance count is important autoscale scales your service toothat count when metrics are not available.</span></span> <span data-ttu-id="8b6e5-234">Por tanto, seleccione un número predeterminado de instancias que sea seguro para sus cargas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-234">Therefore, select a default instance count that's safe for your workloads.</span></span>

### <a name="configure-autoscale-notifications"></a><span data-ttu-id="8b6e5-235">Configure notificaciones de escalado automático</span><span class="sxs-lookup"><span data-stu-id="8b6e5-235">Configure autoscale notifications</span></span>
<span data-ttu-id="8b6e5-236">Escalado automático notifica a los administradores de Hola y colaboradores de recurso de Hola por correo electrónico si se produce alguna de hello condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="8b6e5-236">Autoscale notifies hello administrators and contributors of hello resource by email if any of hello following conditions occur:</span></span>

* <span data-ttu-id="8b6e5-237">servicio de escalado automático se produce un error tootake una acción.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-237">autoscale service fails tootake an action.</span></span>
* <span data-ttu-id="8b6e5-238">Las métricas no están disponibles para el escalado automático servicio toomake una decisión de escala.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-238">Metrics are not available for autoscale service toomake a scale decision.</span></span>
* <span data-ttu-id="8b6e5-239">Las métricas están disponible (recuperación) nuevo toomake una decisión de escala.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-239">Metrics are available (recovery) again toomake a scale decision.</span></span>
  <span data-ttu-id="8b6e5-240">Además toohello condiciones anteriores, puede configurar tooget de notificaciones de correo electrónico o webhook una notificación para las acciones de la escala correcta.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-240">In addition toohello conditions above, you can configure email or webhook notifications tooget notified for successful scale actions.</span></span>
  
<span data-ttu-id="8b6e5-241">También puede utilizar un estado de hello toomonitor alerta de registro de actividad del motor de escalado automático de Hola.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-241">You can also use an Activity Log alert toomonitor hello health of hello autoscale engine.</span></span> <span data-ttu-id="8b6e5-242">Presentamos ejemplos[crear una alerta de registro de actividad toomonitor todas las operaciones de motor de escalado automático en su suscripción](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) o demasiado[crear una alerta de registro de actividad toomonitor todos no pudo escalar de escalado automático en / escalar horizontalmente las operaciones en su suscripción](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span><span class="sxs-lookup"><span data-stu-id="8b6e5-242">Here are examples too[create an Activity Log Alert toomonitor all autoscale engine operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) or too[create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8b6e5-243">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="8b6e5-243">Next Steps</span></span>
- [<span data-ttu-id="8b6e5-244">Crear una alerta de registro de actividad toomonitor todas las operaciones de motor de escalado automático en su suscripción.</span><span class="sxs-lookup"><span data-stu-id="8b6e5-244">Create an Activity Log Alert toomonitor all autoscale engine operations on your subscription.</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert)
- [<span data-ttu-id="8b6e5-245">Crear una alerta de registro de actividad toomonitor todos no pudo escalar de escalado automático en / escalar horizontalmente las operaciones en la suscripción</span><span class="sxs-lookup"><span data-stu-id="8b6e5-245">Create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert)
