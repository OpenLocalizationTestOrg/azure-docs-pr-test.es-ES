---
title: "Implementación y exploración de la aplicación SaaS de Wingtip multiinquilino que usa Azure SQL Database | Microsoft Docs"
description: "Implemente y explore la aplicación SaaS de Wingtip multiinquilino, en la que se muestran los modelos de SaaS con Azure SQL Database."
keywords: tutorial de base de datos sql
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: b09bfa8a5bc22a092e963f351e99c16d0e9a57ba
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="deploy-and-explore-a-multi-tenant-application-that-uses-azure-sql-database---wingtip-saas"></a><span data-ttu-id="4ac56-104">Implementación y exploración de una aplicación SaaS multiinquilino que usa Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="4ac56-104">Deploy and explore a multi-tenant application that uses Azure SQL Database - Wingtip SaaS</span></span>

<span data-ttu-id="4ac56-105">En este tutorial, se implementa y explora la aplicación SaaS de Wingtip.</span><span class="sxs-lookup"><span data-stu-id="4ac56-105">In this tutorial, you deploy and explore the Wingtip SaaS application.</span></span> <span data-ttu-id="4ac56-106">La aplicación utiliza un patrón de aplicación SaaS de base de datos por inquilino para dar servicio a varios inquilinos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-106">The application uses a database-per-tenant, SaaS application pattern, to service multiple tenants.</span></span> <span data-ttu-id="4ac56-107">La aplicación está diseñada para presentar las características de Azure SQL Database que simplifican escenarios de SaaS.</span><span class="sxs-lookup"><span data-stu-id="4ac56-107">The application is designed to showcase features of Azure SQL Database that simplify enabling SaaS scenarios.</span></span>

<span data-ttu-id="4ac56-108">Cinco minutos después de hacer clic en el botón *Implementar en Azure*, tiene una aplicación de SaaS multiempresa que usa SQL Database en funcionamiento en la nube.</span><span class="sxs-lookup"><span data-stu-id="4ac56-108">Five minutes after clicking the *Deploy to Azure* button below, you have a multi-tenant SaaS application, using SQL Database, up and running in the cloud.</span></span> <span data-ttu-id="4ac56-109">La aplicación se implementa con tres inquilinos de ejemplo, cada uno con su propia base de datos, y todos ellos implementados en un grupo elástico de SQL.</span><span class="sxs-lookup"><span data-stu-id="4ac56-109">The application is deployed with three sample tenants, each with its own database, all deployed into a SQL elastic pool.</span></span> <span data-ttu-id="4ac56-110">La aplicación se implementa en su suscripción de Azure, lo que le proporciona acceso completo para explorar y trabajar con los componentes de la aplicación individuales.</span><span class="sxs-lookup"><span data-stu-id="4ac56-110">The app is deployed to your Azure subscription, giving you full access to explore and work with the individual application components.</span></span> <span data-ttu-id="4ac56-111">El código fuente y los scripts de administración de la aplicación están disponibles en el repositorio de GitHub WingtipSaaS.</span><span class="sxs-lookup"><span data-stu-id="4ac56-111">The application source code and management scripts are available in the WingtipSaaS GitHub repo.</span></span>


<span data-ttu-id="4ac56-112">En este tutorial, obtendrá información:</span><span class="sxs-lookup"><span data-stu-id="4ac56-112">In this tutorial you learn:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="4ac56-113">Cómo implementar la aplicación SaaS de Wingtip</span><span class="sxs-lookup"><span data-stu-id="4ac56-113">How to deploy the Wingtip SaaS application</span></span>
> * <span data-ttu-id="4ac56-114">Dónde obtener el código fuente de la aplicación y los scripts de administración</span><span class="sxs-lookup"><span data-stu-id="4ac56-114">Where to get the application source code, and management scripts</span></span>
> * <span data-ttu-id="4ac56-115">Acerca de los servidores, los grupos y las bases de datos que componen la aplicación</span><span class="sxs-lookup"><span data-stu-id="4ac56-115">About the servers, pools, and databases that make up the app</span></span>
> * <span data-ttu-id="4ac56-116">Cómo se asignan los inquilinos a sus datos con el *catálogo*</span><span class="sxs-lookup"><span data-stu-id="4ac56-116">How tenants are mapped to their data with the *catalog*</span></span>
> * <span data-ttu-id="4ac56-117">Cómo aprovisionar un nuevo inquilino</span><span class="sxs-lookup"><span data-stu-id="4ac56-117">How to provision a new tenant</span></span>
> * <span data-ttu-id="4ac56-118">Cómo supervisar la actividad de los inquilinos en la aplicación</span><span class="sxs-lookup"><span data-stu-id="4ac56-118">How to monitor tenant activity in the app</span></span>

<span data-ttu-id="4ac56-119">Para explorar diversos patrones de administración y diseño de SaaS, hay un [serie de tutoriales relacionados](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) disponibles que se basan en esta implementación inicial.</span><span class="sxs-lookup"><span data-stu-id="4ac56-119">To explore various SaaS design and management patterns, a [series of related tutorials](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) is available that build upon this initial deployment.</span></span> <span data-ttu-id="4ac56-120">Cuando recorra los tutoriales, profundice en los scripts que se proporcionan y examine cómo se implementan los distintos patrones de SaaS.</span><span class="sxs-lookup"><span data-stu-id="4ac56-120">While going through the tutorials, dive into the provided scripts, and examine how the different SaaS patterns are implemented.</span></span> <span data-ttu-id="4ac56-121">Recorra los scripts de cada tutorial para conocer mejor cómo implementar la gran cantidad de características de SQL Database que simplifican el desarrollo de aplicaciones SaaS.</span><span class="sxs-lookup"><span data-stu-id="4ac56-121">Step through the scripts in each tutorial to gain a deeper understanding how to implement the many SQL Database features that simplify developing SaaS applications.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="4ac56-122">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="4ac56-122">Prerequisites</span></span>

<span data-ttu-id="4ac56-123">Para completar este tutorial, asegúrese de cumplir los siguientes requisitos previos:</span><span class="sxs-lookup"><span data-stu-id="4ac56-123">To complete this tutorial, make sure the following prerequisites are completed:</span></span>

* <span data-ttu-id="4ac56-124">Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="4ac56-124">Azure PowerShell is installed.</span></span> <span data-ttu-id="4ac56-125">Para más información, consulte [Introducción a Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="4ac56-125">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="deploy-the-wingtip-saas-application"></a><span data-ttu-id="4ac56-126">Implementar la aplicación SaaS de Wingtip</span><span class="sxs-lookup"><span data-stu-id="4ac56-126">Deploy the Wingtip SaaS application</span></span>

<span data-ttu-id="4ac56-127">Implemente la aplicación SaaS de Wingtip:</span><span class="sxs-lookup"><span data-stu-id="4ac56-127">Deploy the Wingtip SaaS app:</span></span>

1. <span data-ttu-id="4ac56-128">Al hacer clic en el botón **Implementar en Azure** se abre Azure Portal por la plantilla de implementación SaaS de Wingtip.</span><span class="sxs-lookup"><span data-stu-id="4ac56-128">Clicking the **Deploy to Azure** button opens the Azure portal to the Wingtip SaaS deployment template.</span></span> <span data-ttu-id="4ac56-129">La plantilla requiere dos valores de parámetro; un nombre para un nuevo grupo de recursos y un nombre de usuario que distingue esta implementación de otras implementaciones de la aplicación SaaS de Wingtip.</span><span class="sxs-lookup"><span data-stu-id="4ac56-129">The template requires two parameter values; a name for a new resource group, and a user name that distinguishes this deployment from other deployments of the Wingtip SaaS app.</span></span> <span data-ttu-id="4ac56-130">El paso siguiente proporciona detalles para establecer estos valores.</span><span class="sxs-lookup"><span data-stu-id="4ac56-130">The next step provides details for setting these values.</span></span>

   <span data-ttu-id="4ac56-131">Asegúrese de anotar los valores exactos que use, ya que necesitará escribirlos más adelante en un archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="4ac56-131">Make sure to note the exact values that you use, because you will need to enter them into a configuration file later.</span></span>

   <a href="http://aka.ms/deploywtpapp" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>

1. <span data-ttu-id="4ac56-132">Especifique los valores necesarios de los parámetros para la implementación:</span><span class="sxs-lookup"><span data-stu-id="4ac56-132">Enter required parameter values for the deployment:</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="4ac56-133">Para realizar la demostración, se ha eliminado intencionadamente la protección de varios firewalls de autenticación y del servidor.</span><span class="sxs-lookup"><span data-stu-id="4ac56-133">Some authentication, and server firewalls are intentionally unsecured for demonstration purposes.</span></span> <span data-ttu-id="4ac56-134">**Cree un nuevo grupo de recursos** y no use grupos de recursos, servidores o grupos existentes.</span><span class="sxs-lookup"><span data-stu-id="4ac56-134">**Create a new resource group**, and do not use existing resource groups, servers, or pools.</span></span> <span data-ttu-id="4ac56-135">No use esta aplicación, ni ninguno de los recursos que se crean, para producción.</span><span class="sxs-lookup"><span data-stu-id="4ac56-135">Do not use this application, or any resources it creates, for production.</span></span> <span data-ttu-id="4ac56-136">Elimine este grupo de recursos cuando haya terminado con la aplicación para detener la facturación relacionada con él.</span><span class="sxs-lookup"><span data-stu-id="4ac56-136">Delete this resource group when you are finished with the application to stop related billing.</span></span>

    * <span data-ttu-id="4ac56-137">**Grupo de recursos**: seleccione **Crear nuevo** y proporcione un **nombre** para el nuevo grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-137">**Resource group** - Select **Create new** and provide a **Name** for the resource group.</span></span> <span data-ttu-id="4ac56-138">Seleccione una **ubicación** en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="4ac56-138">Select a **Location** from the drop-down list.</span></span>
    * <span data-ttu-id="4ac56-139">**Usuario**: algunos recursos requieren nombres que sean globalmente únicos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-139">**User** - Some resources require names that are globally unique.</span></span> <span data-ttu-id="4ac56-140">Para garantizar la unicidad, cada vez que implemente la aplicación, especifique un valor para diferenciar los recursos que cree de los que han creado otras implementaciones de la aplicación Wingtip.</span><span class="sxs-lookup"><span data-stu-id="4ac56-140">To ensure uniqueness, each time you deploy the application provide a value to differentiate resources you create, from resources created by any other deployment of the Wingtip application.</span></span> <span data-ttu-id="4ac56-141">Se recomienda usar un nombre de **usuario** corto, como sus iniciales y un número (por ejemplo, *bg1*) y, después, utilizarlo en el nombre del grupo de recursos (por ejemplo, *wingtip-bg1*).</span><span class="sxs-lookup"><span data-stu-id="4ac56-141">It’s recommended to use a short **User** name, such as your initials plus a number (for example, *bg1*), and then use that in the resource group name (for example, *wingtip-bg1*).</span></span> <span data-ttu-id="4ac56-142">El parámetro **Usuario** solo puede contener letras, números y guiones (sin espacios).</span><span class="sxs-lookup"><span data-stu-id="4ac56-142">The **User** parameter can only contain letters, numbers, and hyphens (no spaces).</span></span> <span data-ttu-id="4ac56-143">El primer y último carácter deben ser una letra o un número (se recomienda usar minúsculas).</span><span class="sxs-lookup"><span data-stu-id="4ac56-143">The first and last character must be a letter or a number (all lowercase is recommended).</span></span>


1. <span data-ttu-id="4ac56-144">**Implemente la aplicación**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-144">**Deploy the application**.</span></span>

    * <span data-ttu-id="4ac56-145">Haga clic para aceptar los términos y condiciones.</span><span class="sxs-lookup"><span data-stu-id="4ac56-145">Click to agree to the terms and conditions.</span></span>
    * <span data-ttu-id="4ac56-146">Haga clic en **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-146">Click **Purchase**.</span></span>

1. <span data-ttu-id="4ac56-147">Supervise el estado de implementación, para lo que debe hacer clic en **Notificaciones** (el icono de la campana de la derecha del cuadro de búsqueda).</span><span class="sxs-lookup"><span data-stu-id="4ac56-147">Monitor deployment status by clicking **Notifications** (the bell icon right of the search box).</span></span> <span data-ttu-id="4ac56-148">La implementación de la aplicación SaaS de Wingtip tarda aproximadamente cinco minutos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-148">Deploying the Wingtip SaaS app takes approximately five minutes.</span></span>

   ![implementación correcta](media/sql-database-saas-tutorial/succeeded.png)

## <a name="download-and-unblock-the-wingtip-saas-scripts"></a><span data-ttu-id="4ac56-150">Descargar y desbloquear los scripts SaaS de Wingtip</span><span class="sxs-lookup"><span data-stu-id="4ac56-150">Download and unblock the Wingtip SaaS scripts</span></span>

<span data-ttu-id="4ac56-151">Mientras la aplicación se está implementando, descargue el código fuente y los scripts de administración.</span><span class="sxs-lookup"><span data-stu-id="4ac56-151">While the application is deploying, download the source code and management scripts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4ac56-152">Es posible que Windows bloquee el contenido ejecutable (scripts, archivos DLL) cuando se descarguen y extraigan archivos ZIP desde un origen externo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-152">Executable contents (scripts, dlls) may be blocked by Windows when zip files are downloaded from an external source and extracted.</span></span> <span data-ttu-id="4ac56-153">Al extraer los scripts de un archivo ZIP, siga estos pasos para desbloquear el archivo .zip antes de extraerlo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-153">When extracting the scripts from a zip file, follow the steps below to unblock the .zip file before extracting.</span></span> <span data-ttu-id="4ac56-154">Esto garantiza que se puedan ejecutar los scripts.</span><span class="sxs-lookup"><span data-stu-id="4ac56-154">This ensures the scripts are allowed to run.</span></span>

1. <span data-ttu-id="4ac56-155">Vaya al [repositorio de SaaS de Wingtip en GitHub](https://github.com/Microsoft/WingtipSaaS).</span><span class="sxs-lookup"><span data-stu-id="4ac56-155">Browse to [the Wingtip SaaS github repo](https://github.com/Microsoft/WingtipSaaS).</span></span>
1. <span data-ttu-id="4ac56-156">Haga clic en **Clone or download** (Clonar o descargar).</span><span class="sxs-lookup"><span data-stu-id="4ac56-156">Click **Clone or download**.</span></span>
1. <span data-ttu-id="4ac56-157">Haga clic en **Download ZIP** (Descargar archivos ZIP) y guarde el archivo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-157">Click **Download ZIP** and save the file.</span></span>
1. <span data-ttu-id="4ac56-158">Haga clic con el botón derecho en el archivo **WingtipSaaS-master.zip** y seleccione **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-158">Right-click the **WingtipSaaS-master.zip** file, and select **Properties**.</span></span>
1. <span data-ttu-id="4ac56-159">En la pestaña **General**, seleccione **Desbloquear** y haga clic en **Aplicar**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-159">On the **General** tab, select **Unblock**, and click **Apply**.</span></span>
1. <span data-ttu-id="4ac56-160">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-160">Click **OK**.</span></span>
1. <span data-ttu-id="4ac56-161">Extraiga los archivos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-161">Extract the files.</span></span>

<span data-ttu-id="4ac56-162">Los scripts se encuentran en la carpeta *..\\WingtipSaaS-master\\Learning Modules*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-162">Scripts are located in the *..\\WingtipSaaS-master\\Learning Modules* folder.</span></span>

## <a name="update-the-configuration-file-for-this-deployment"></a><span data-ttu-id="4ac56-163">Actualizar el archivo de configuración para esta implementación</span><span class="sxs-lookup"><span data-stu-id="4ac56-163">Update the configuration file for this deployment</span></span>

<span data-ttu-id="4ac56-164">Antes de ejecutar cualquier script, establezca los valores *grupo de recursos* y *usuario* en **UserConfig.psm1**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-164">Before running any scripts, set the *resource group* and *user* values in **UserConfig.psm1**.</span></span> <span data-ttu-id="4ac56-165">Establezca estas variables en los valores establecidos durante la implementación.</span><span class="sxs-lookup"><span data-stu-id="4ac56-165">Set these variables to the values you set during deployment.</span></span>

1. <span data-ttu-id="4ac56-166">Abra ...\\Learning Modules\\*UserConfig.psm1* en *PowerShell ISE*</span><span class="sxs-lookup"><span data-stu-id="4ac56-166">Open ...\\Learning Modules\\*UserConfig.psm1* in the *PowerShell ISE*</span></span>
1. <span data-ttu-id="4ac56-167">Actualice *ResourceGroupName* y *Name* con los valores específicos para la implementación (solo en las líneas 10 y 11).</span><span class="sxs-lookup"><span data-stu-id="4ac56-167">Update *ResourceGroupName* and *Name* with the specific values for your deployment (on lines 10 and 11 only).</span></span>
1. <span data-ttu-id="4ac56-168">Guarde los cambios.</span><span class="sxs-lookup"><span data-stu-id="4ac56-168">Save the changes!</span></span>

<span data-ttu-id="4ac56-169">Al establecerlo aquí simplemente evita tener que actualizar estos valores específicos de la implementación en todos los scripts.</span><span class="sxs-lookup"><span data-stu-id="4ac56-169">Setting this here simply keeps you from having to update these deployment-specific values in every script.</span></span>

## <a name="run-the-application"></a><span data-ttu-id="4ac56-170">Ejecución de la aplicación</span><span class="sxs-lookup"><span data-stu-id="4ac56-170">Run the application</span></span>

<span data-ttu-id="4ac56-171">La aplicación presenta lugares, como salas de concierto, clubs de jazz o clubes deportivos, que alojan eventos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-171">The app showcases venues, such as concert halls, jazz clubs, sports clubs, that host events.</span></span> <span data-ttu-id="4ac56-172">Los lugares se registran como clientes (o inquilinos) de la plataforma Wingtip, lo que facilita la enumeración de eventos y la venta de entradas.</span><span class="sxs-lookup"><span data-stu-id="4ac56-172">Venues register as customers (or tenants) of the Wingtip platform, for an easy way to list events and sell tickets.</span></span> <span data-ttu-id="4ac56-173">Cada lugar obtiene una aplicación web personalizada que administra y enumera sus eventos y vende las entradas, que independiente y está aislada de otros inquilinos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-173">Each venue gets a personalized web app to manage and list their events and sell tickets, independent and isolated from other tenants.</span></span> <span data-ttu-id="4ac56-174">Entre bastidores, cada inquilino obtiene una base de datos SQL que se implementa en un grupo elástico de SQL.</span><span class="sxs-lookup"><span data-stu-id="4ac56-174">Under the covers, each tenant gets a SQL database deployed into a SQL elastic pool.</span></span>

<span data-ttu-id="4ac56-175">Un **centro de eventos** central proporciona una lista de las direcciones URL de los inquilinos específicas para la implementación.</span><span class="sxs-lookup"><span data-stu-id="4ac56-175">A central **Events Hub** provides a list of tenant URLs specific to your deployment.</span></span>

1. <span data-ttu-id="4ac56-176">Abra el _centro de eventos_ en el explorador web: http://events.wtp.&lt;USUARIO&gt;.trafficmanager.net (reemplácelo por el nombre de usuario de la implementación):</span><span class="sxs-lookup"><span data-stu-id="4ac56-176">Open the _Events Hub_ in your web browser: http://events.wtp.&lt;USER&gt;.trafficmanager.net (replace with your deployment's user name):</span></span>

    ![events hub](media/sql-database-saas-tutorial/events-hub.png)

1. <span data-ttu-id="4ac56-178">Haga clic en **Fabrikam Jazz Club** en el *centro de eventos*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-178">Click **Fabrikam Jazz Club** in the *Events Hub*.</span></span>

   ![Eventos](./media/sql-database-saas-tutorial/fabrikam.png)


<span data-ttu-id="4ac56-180">Para controlar la distribución de las solicitudes entrantes, la aplicación usa [*Azure Traffic Manager*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview).</span><span class="sxs-lookup"><span data-stu-id="4ac56-180">To control the distribution of incoming requests, the app uses [*Azure Traffic Manager*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview).</span></span> <span data-ttu-id="4ac56-181">Las páginas de eventos, que son específicas del inquilino, requieren que los nombres de los inquilinos se incluyan en las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="4ac56-181">The events pages, which are tenant-specific, require that tenant names are included in the URLs.</span></span> <span data-ttu-id="4ac56-182">Todas estas direcciones incluyen un valor específico de *Usuario* y siguen este formato: http://events.wtp.&lt; USUARIO&gt;.trafficmanager.net/*fabrikamjazzclub*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-182">All the tenant URLs include your specific *User* value and follow this format: http://events.wtp.&lt;USER&gt;.trafficmanager.net/*fabrikamjazzclub*.</span></span> <span data-ttu-id="4ac56-183">La aplicación de eventos analiza el nombre de inquilino de la dirección URL y lo utiliza para crear una clave para acceder a un catálogo mediante la [*administración del mapa de particiones*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management).</span><span class="sxs-lookup"><span data-stu-id="4ac56-183">The events app parses the tenant name from the URL and uses it to create a key to access a catalog using [*shard map management*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management).</span></span> <span data-ttu-id="4ac56-184">El catálogo asigna la clave a la ubicación de base de datos del inquilino.</span><span class="sxs-lookup"><span data-stu-id="4ac56-184">The catalog maps the key to the tenant's database location.</span></span> <span data-ttu-id="4ac56-185">El **centro de eventos** usa metadatos extendidos en el catálogo para recuperar el nombre del inquilino asociado a cada base de datos para proporcionar la lista de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="4ac56-185">The **Events Hub** uses extended metadata in the catalog to retrieve the tenant’s name associated with each database to provide the list of URLs.</span></span>

<span data-ttu-id="4ac56-186">En un entorno de producción, lo habitual sería crear un registro DNS CNAME que [*apunte a un dominio de empresa de Internet*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) para el perfil de Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="4ac56-186">In a production environment, you would typically create a CNAME DNS record to [*point a company internet domain*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) to the traffic manager profile.</span></span>

## <a name="start-generating-load-on-the-tenant-databases"></a><span data-ttu-id="4ac56-187">Empiece a generar carga en las bases de datos de los inquilinos</span><span class="sxs-lookup"><span data-stu-id="4ac56-187">Start generating load on the tenant databases</span></span>

<span data-ttu-id="4ac56-188">Ahora que la aplicación se ha implementado, vamos a ponerla en marcha.</span><span class="sxs-lookup"><span data-stu-id="4ac56-188">Now that the app is deployed, let’s put it to work!</span></span> <span data-ttu-id="4ac56-189">El script de PowerShell *Demo-LoadGenerator* inicia una carga de trabajo que se ejecuta en las bases de datos de todos los inquilinos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-189">The *Demo-LoadGenerator* PowerShell script starts a workload running against all tenant databases.</span></span> <span data-ttu-id="4ac56-190">La carga real en muchas aplicaciones de SaaS normalmente es esporádica e imprevisible.</span><span class="sxs-lookup"><span data-stu-id="4ac56-190">The real-world load on many SaaS apps is typically sporadic and unpredictable.</span></span> <span data-ttu-id="4ac56-191">Para simular este tipo de carga, el generador genera una carga que se distribuye entre todos los inquilinos, con ráfagas aleatorias en cada inquilino que se producen a intervalos aleatorios.</span><span class="sxs-lookup"><span data-stu-id="4ac56-191">To simulate this type of load, the generator produces a load distributed across all tenants, with randomized bursts on each tenant occurring at randomized intervals.</span></span> <span data-ttu-id="4ac56-192">Por este motivo, el modelo de carga tarda varios minutos en surgir, por lo que es mejor permitir que el generador se ejecute durante al menos tres o cuatro minutos antes de supervisar la carga.</span><span class="sxs-lookup"><span data-stu-id="4ac56-192">Because of this it takes several minutes for the load pattern to emerge, so it’s best to let the generator run for at least three or four minutes before monitoring the load.</span></span>

1. <span data-ttu-id="4ac56-193">En *PowerShell ISE*, abra el script ...\\Learning Modules\\Utilities\\*Demo-LoadGenerator.ps1*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-193">In the *PowerShell ISE*, open the ...\\Learning Modules\\Utilities\\*Demo-LoadGenerator.ps1* script.</span></span>
1. <span data-ttu-id="4ac56-194">Presione **F5** para ejecutar el script e iniciar el generador de carga (por ahora deje los valores predeterminados de los parámetros).</span><span class="sxs-lookup"><span data-stu-id="4ac56-194">Press **F5** to run the script and start the load generator (leave the default parameter values for now).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4ac56-195">Para ejecutar otros scripts, abra una nueva ventana de PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="4ac56-195">To run other scripts, open a new PowerShell ISE window.</span></span> <span data-ttu-id="4ac56-196">El generador de carga se ejecuta como una serie de trabajos en la sesión local de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4ac56-196">The load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="4ac56-197">El script *Demo-LoadGenerator.ps1* inicia el script real del generador de carga, que se ejecuta como una tarea en primer plano además de una serie de trabajos de generación de carga en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="4ac56-197">The *Demo-LoadGenerator.ps1* script kicks off the actual load generator script, which runs as a foreground task plus a series of background load-generation jobs.</span></span> <span data-ttu-id="4ac56-198">Se invoca un trabajo de generador de carga para cada base de datos registrada en el catálogo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-198">A load-generator job is invoked for each database registered in the catalog.</span></span> <span data-ttu-id="4ac56-199">Los trabajos se ejecutan en la sesión de PowerShell local, por lo que al cerrar la sesión de PowerShell se detienen todos los trabajos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-199">The jobs are running in your local PowerShell session, so closing the PowerShell session stops all jobs.</span></span> <span data-ttu-id="4ac56-200">Si se suspende el equipo, se pausa la generación de carga y se reanudará cuando reactive el equipo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-200">If you suspend your machine, load generation is paused and will resume when you wake up your machine.</span></span>

<span data-ttu-id="4ac56-201">Una vez que el generador de carga invoca los trabajos de generación de carga para cada inquilino, la tarea en primer plano permanece en un estado de invocación de trabajo, donde inicia trabajos en segundo plano adicionales para los nuevos inquilinos que se aprovisionen posteriormente.</span><span class="sxs-lookup"><span data-stu-id="4ac56-201">Once the load generator invokes load-generation jobs for each tenant, the foreground task remains in a job-invoking state, where it starts additional background jobs for any new tenants that are subsequently provisioned.</span></span> <span data-ttu-id="4ac56-202">Puede presionar *Ctrl-C* o pulsar el botón *Detener* para detener la tarea en primer plano, pero los trabajos en segundo plano existentes seguirán generando la carga en cada base de datos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-202">You can use *Ctrl-C* or press the *Stop* button to stop the foreground task, but existing background jobs will continue generating load on each database.</span></span> <span data-ttu-id="4ac56-203">Si necesita supervisar y controlar los trabajos en segundo plano, use *Get-Job*, *Receive-Job* y *Stop-Job*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-203">If you need to monitor and control the background jobs, use *Get-Job*, *Receive-Job* and *Stop-Job*.</span></span> <span data-ttu-id="4ac56-204">Mientras se ejecuta la tarea en primer plano no se puede usar la misma sesión de PowerShell para ejecutar otros scripts.</span><span class="sxs-lookup"><span data-stu-id="4ac56-204">While the foreground task is running you cannot use the same PowerShell session to execute other scripts.</span></span> <span data-ttu-id="4ac56-205">Para ejecutar otros scripts, abra una nueva ventana de PowerShell ISE.</span><span class="sxs-lookup"><span data-stu-id="4ac56-205">To run other scripts, open a new PowerShell ISE window.</span></span>

<span data-ttu-id="4ac56-206">Si quiere reiniciar la sesión del generador de carga, por ejemplo con parámetros diferentes, puede detener la tarea en primer plano y, después, volver a ejecutar el script *Demo-LoadGenerator.ps1*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-206">If you want to restart the load generator session, for example with different parameters, you can stop the foreground task and then re-run the *Demo-LoadGenerator.ps1* script.</span></span> <span data-ttu-id="4ac56-207">Al volver a ejecutar *Demo-LoadGenerator.ps1* primero se detiene cualquier trabajo en ejecución y después se reinicia el generador, que inicia un nuevo conjunto de trabajos con los parámetros actuales.</span><span class="sxs-lookup"><span data-stu-id="4ac56-207">Re-running *Demo-LoadGenerator.ps1* first stops any currently running jobs, and then restarts the generator, which kicks off a new set of jobs using the current parameters.</span></span>

<span data-ttu-id="4ac56-208">Por ahora, deje el generador de carga en ejecución en el estado de invocación de trabajo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-208">For now, leave the load generator running in the job-invoking state.</span></span>


## <a name="provision-a-new-tenant"></a><span data-ttu-id="4ac56-209">Aprovisionamiento de un nuevo inquilino</span><span class="sxs-lookup"><span data-stu-id="4ac56-209">Provision a new tenant</span></span>

<span data-ttu-id="4ac56-210">La implementación inicial crea tres inquilinos de ejemplo, pero vamos a crear otro inquilino para ver cómo afecta a la aplicación implementada.</span><span class="sxs-lookup"><span data-stu-id="4ac56-210">The initial deployment creates three sample tenants, but let’s create another tenant to see how this impacts the deployed application.</span></span> <span data-ttu-id="4ac56-211">El flujo de trabajo de aprovisionamiento de inquilinos de SaaS de Wingtip se detalla en el [tutorial de aprovisionamiento y el catálogo](sql-database-saas-tutorial-provision-and-catalog.md).</span><span class="sxs-lookup"><span data-stu-id="4ac56-211">The Wingtip SaaS provisioning-tenants workflow is detailed in the [Provision and catalog tutorial](sql-database-saas-tutorial-provision-and-catalog.md).</span></span> <span data-ttu-id="4ac56-212">En este paso, se crea rápidamente un inquilino.</span><span class="sxs-lookup"><span data-stu-id="4ac56-212">In this step, you quickly create a new tenant.</span></span>

1. <span data-ttu-id="4ac56-213">Abra ...\\Learning Modules\Provision and Catalog\\*Demo-ProvisionAndCatalog.ps1* en *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="4ac56-213">Open ...\\Learning Modules\Provision and Catalog\\*Demo-ProvisionAndCatalog.ps1* in the *PowerShell ISE*.</span></span>
1. <span data-ttu-id="4ac56-214">Presione **F5** para ejecutar el script (deje por ahora los valores predeterminados).</span><span class="sxs-lookup"><span data-stu-id="4ac56-214">Press **F5** to run the script (leave the default values for now).</span></span>

   > [!NOTE]
   > <span data-ttu-id="4ac56-215">Muchos scripts SaaS de Wingtip usan *$PSScriptRoot* para permitir navegar por las carpetas para llamar a funciones en otros scripts.</span><span class="sxs-lookup"><span data-stu-id="4ac56-215">Many Wingtip SaaS scripts use *$PSScriptRoot* to allow navigating folders to call functions in other scripts.</span></span> <span data-ttu-id="4ac56-216">Esta variable solo se evalúa cuando se ejecuta el script presionando **F5**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-216">This variable is only evaluated when the script is executed by pressing **F5**.</span></span>  <span data-ttu-id="4ac56-217">Resaltar y ejecutar una selección (**F8**) puede dar lugar a errores, por tanto, presione **F5** al ejecutar los scripts.</span><span class="sxs-lookup"><span data-stu-id="4ac56-217">Highlighting and running a selection (**F8**) can result in errors, so press **F5** when running scripts.</span></span>

<span data-ttu-id="4ac56-218">La nueva base de datos de inquilinos se crea en un grupo elástico de SQL, se inicializa y se registra en el catálogo.</span><span class="sxs-lookup"><span data-stu-id="4ac56-218">The new tenant database is created in a SQL elastic pool, initialized and registered in the catalog.</span></span> <span data-ttu-id="4ac56-219">Si el aprovisionamiento se ha realizado correctamente, el sitio de *eventos* de venta de entradas del nuevo inquilino aparece en el explorador:</span><span class="sxs-lookup"><span data-stu-id="4ac56-219">After successful provisioning, the new tenant's ticket-selling *Events* site appears in your browser:</span></span>

![Nuevo inquilino](./media/sql-database-saas-tutorial/red-maple-racing.png)

<span data-ttu-id="4ac56-221">Actualice el *centro de eventos* y el nuevo inquilino aparece ahora en la lista.</span><span class="sxs-lookup"><span data-stu-id="4ac56-221">Refresh the *Events Hub* and the new tenant now appears in the list.</span></span>


## <a name="explore-the-servers-pools-and-tenant-databases"></a><span data-ttu-id="4ac56-222">Explore los servidores, los grupos y las bases de datos de los inquilinos</span><span class="sxs-lookup"><span data-stu-id="4ac56-222">Explore the servers, pools, and tenant databases</span></span>

<span data-ttu-id="4ac56-223">Ahora que ha empezado a ejecutar una carga en la colección de inquilinos, veamos algunos de los recursos que se han implementado:</span><span class="sxs-lookup"><span data-stu-id="4ac56-223">Now that you've started running a load against the collection of tenants, let’s look at some of the resources that were deployed:</span></span>

1. <span data-ttu-id="4ac56-224">En [Azure Portal](http://portal.azure.com), vaya a la lista de servidores SQL Server y abra el servidor **catalog-&lt;USUARIO&gt;**.</span><span class="sxs-lookup"><span data-stu-id="4ac56-224">In the [Azure portal](http://portal.azure.com), browse to your list of SQL servers and open the **catalog-&lt;USER&gt;** server.</span></span> <span data-ttu-id="4ac56-225">El servidor de catálogo contiene dos bases de datos:</span><span class="sxs-lookup"><span data-stu-id="4ac56-225">The catalog server contains two databases.</span></span> <span data-ttu-id="4ac56-226">**tenantcatalog** y **basetenantdb** (una base de datos *golden* vacía o una base de datos de plantilla que se copia para crear nuevos inquilinos).</span><span class="sxs-lookup"><span data-stu-id="4ac56-226">The **tenantcatalog**, and the **basetenantdb** (an empty *golden* or template database that is copied to create new tenants).</span></span>

   ![bases de datos](./media/sql-database-saas-tutorial/databases.png)

1. <span data-ttu-id="4ac56-228">Vuelva a la lista de servidores de SQL Server y abra el servidor **tenants1&lt;&gt;USUARIO** que contiene las bases de datos de los inquilinos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-228">Go back to your list of SQL servers and open the **tenants1-&lt;USER&gt;** server that holds the tenant databases.</span></span> <span data-ttu-id="4ac56-229">Todas las bases de datos de inquilinos son _elásticas estándar_ en un conjunto estándar de 50 eDTU.</span><span class="sxs-lookup"><span data-stu-id="4ac56-229">Each tenant database is an _Elastic Standard_ database in a 50 eDTU standard pool.</span></span> <span data-ttu-id="4ac56-230">Observe también hay una base de datos de _Red Maple Racing_, la base de datos de inquilino que aprovisionó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="4ac56-230">Also notice there is a _Red Maple Racing_ database, the tenant database you provisioned previously.</span></span>

   ![Servidor](./media/sql-database-saas-tutorial/server.png)

## <a name="monitor-the-pool"></a><span data-ttu-id="4ac56-232">Supervisión del grupo</span><span class="sxs-lookup"><span data-stu-id="4ac56-232">Monitor the pool</span></span>

<span data-ttu-id="4ac56-233">Si el generador de carga lleva varios minutos en ejecución, debería haber suficientes datos disponibles para empezar a examinar algunas de las funcionalidades de supervisión integradas en los grupos y las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-233">If the load generator has been running for several minutes, enough data should be available to start looking at some of the monitoring capabilities built into pools and databases.</span></span>

1. <span data-ttu-id="4ac56-234">Vaya al servidor de **tenants1-&lt;USUARIO&gt;** y haga clic en **Pool1** para ver el uso de los recursos para el grupo (el generador de carga se ejecutó durante una hora en los siguientes gráficos):</span><span class="sxs-lookup"><span data-stu-id="4ac56-234">Browse to the server **tenants1-&lt;USER&gt;**, and click **Pool1** to view resource utilization for the pool (the load generator ran for an hour in the following charts):</span></span>

   ![supervisar grupo](./media/sql-database-saas-tutorial/monitor-pool.png)

<span data-ttu-id="4ac56-236">Estos dos gráficos ilustran es el grado de idoneidad de los grupos elásticos y de SQL Database para las cargas de trabajo de una aplicación SaaS.</span><span class="sxs-lookup"><span data-stu-id="4ac56-236">What these two charts nicely illustrate, is how well suited elastic pools and SQL Database are for SaaS application workloads.</span></span> <span data-ttu-id="4ac56-237">Cuatro bases de datos que generen un máximo de 40 eDTU cada una se admiten fácilmente en un grupo de 50 eDTU.</span><span class="sxs-lookup"><span data-stu-id="4ac56-237">Four databases that are each bursting to as much as 40 eDTUs are easily being supported in a 50 eDTU pool.</span></span> <span data-ttu-id="4ac56-238">Si se aprovisionaron como bases de datos independientes, cada una debe ser de tipo S2 (50 DTU) para admitir las ráfagas.</span><span class="sxs-lookup"><span data-stu-id="4ac56-238">If they were provisioned as standalone databases, they would each need to be an S2 (50 DTU) to support the bursts.</span></span> <span data-ttu-id="4ac56-239">El coste de cuatro bases de datos S2 independientes sería casi tres veces el precio del grupo y el grupo todavía tiene una gran cantidad de espacio disponible para muchas más bases de datos.</span><span class="sxs-lookup"><span data-stu-id="4ac56-239">The cost of 4 standalone S2 databases would be nearly 3 times the price of the pool, and the pool still has plenty of headroom for many more databases.</span></span> <span data-ttu-id="4ac56-240">En situaciones reales, los clientes de SQL Database están ejecutando hasta 500 bases de datos en grupos de 200 eDTU.</span><span class="sxs-lookup"><span data-stu-id="4ac56-240">In real-world situations, SQL Database customers are currently running up to 500 databases in 200 eDTU pools.</span></span> <span data-ttu-id="4ac56-241">Para más información consulte el [tutorial de supervisión del rendimiento](sql-database-saas-tutorial-performance-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="4ac56-241">For more information, see the [performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>


## <a name="next-steps"></a><span data-ttu-id="4ac56-242">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="4ac56-242">Next steps</span></span>

<span data-ttu-id="4ac56-243">En este tutorial ha obtenido información:</span><span class="sxs-lookup"><span data-stu-id="4ac56-243">In this tutorial you learned:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="4ac56-244">Cómo implementar la aplicación SaaS de Wingtip</span><span class="sxs-lookup"><span data-stu-id="4ac56-244">How to deploy the Wingtip SaaS application</span></span>
> * <span data-ttu-id="4ac56-245">Acerca de los servidores, los grupos y las bases de datos que componen la aplicación</span><span class="sxs-lookup"><span data-stu-id="4ac56-245">About the servers, pools, and databases that make up the app</span></span>
> * <span data-ttu-id="4ac56-246">Acerca de los inquilinos que se asignan a sus datos con el *catálogo*</span><span class="sxs-lookup"><span data-stu-id="4ac56-246">Tenants are mapped to their data with the *catalog*</span></span>
> * <span data-ttu-id="4ac56-247">Acerca de cómo aprovisionar nuevos inquilinos</span><span class="sxs-lookup"><span data-stu-id="4ac56-247">How to provision new tenants</span></span>
> * <span data-ttu-id="4ac56-248">Acerca de cómo ver el uso de grupos para supervisar la actividad de los inquilinos</span><span class="sxs-lookup"><span data-stu-id="4ac56-248">How to view pool utilization to monitor tenant activity</span></span>
> * <span data-ttu-id="4ac56-249">Acerca de cómo eliminar los recursos de ejemplo para detener la facturación relacionada con ellos</span><span class="sxs-lookup"><span data-stu-id="4ac56-249">How to delete sample resources to stop related billing</span></span>

<span data-ttu-id="4ac56-250">Ahora pruebe el [tutorial de aprovisionamiento del catálogo](sql-database-saas-tutorial-provision-and-catalog.md)</span><span class="sxs-lookup"><span data-stu-id="4ac56-250">Now try the [Provision and catalog tutorial](sql-database-saas-tutorial-provision-and-catalog.md)</span></span>



## <a name="additional-resources"></a><span data-ttu-id="4ac56-251">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="4ac56-251">Additional resources</span></span>

* <span data-ttu-id="4ac56-252">Otros [tutoriales basados en la aplicación SaaS de Wingtip](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="4ac56-252">Additional [tutorials that build on the Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* <span data-ttu-id="4ac56-253">Para obtener información acerca de los grupos elásticos, consulte [*¿Qué son los grupos elásticos de Azure SQL?*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool)</span><span class="sxs-lookup"><span data-stu-id="4ac56-253">To learn about elastic pools, see [*What is an Azure SQL elastic pool*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool)</span></span>
* <span data-ttu-id="4ac56-254">Para obtener información acerca de los trabajos elásticos, consulte [*Administración de bases de datos escaladas horizontalmente en la nube*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview)</span><span class="sxs-lookup"><span data-stu-id="4ac56-254">To learn about elastic jobs, see [*Managing scaled-out cloud databases*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview)</span></span>
* <span data-ttu-id="4ac56-255">Para obtener información acerca de aplicaciones SaaS multiempresa, consulte [*Modelos de diseño para las aplicaciones SaaS multiempresa y Azure SQL Database*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)</span><span class="sxs-lookup"><span data-stu-id="4ac56-255">To learn about multi-tenant SaaS applications, see [*Design patterns for multi-tenant SaaS applications*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)</span></span>
