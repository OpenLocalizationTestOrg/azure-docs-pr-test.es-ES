---
title: las actualizaciones de aplicaciones de aaaRolling - base de datos de SQL de Azure | Documentos de Microsoft
description: "Obtenga información acerca de cómo toouse replicación geográfica de base de datos de SQL Azure toosupport actualizaciones en línea de la aplicación en la nube."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 58f42859-1e37-463c-a3d8-a3ca2e867148
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 07/16/2016
ms.author: sashan
ms.openlocfilehash: 18c56300916d129bff141624cc5c416b500408d4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="managing-rolling-upgrades-of-cloud-applications-using-sql-database-active-geo-replication"></a><span data-ttu-id="d53c4-103">Administración de actualizaciones graduales de aplicaciones en la nube mediante la replicación geográfica activa de SQL Database</span><span class="sxs-lookup"><span data-stu-id="d53c4-103">Managing rolling upgrades of cloud applications using SQL Database active geo-replication</span></span>
> [!NOTE]
> <span data-ttu-id="d53c4-104">La [replicación geográfica activa](sql-database-geo-replication-overview.md) ahora está disponible para todas las bases de datos en todos los niveles.</span><span class="sxs-lookup"><span data-stu-id="d53c4-104">[Active geo-replication](sql-database-geo-replication-overview.md) is now available for all databases in all tiers.</span></span>
> 

<span data-ttu-id="d53c4-105">Obtenga información acerca de cómo toouse [georreplicación](sql-database-geo-replication-overview.md) en la base de datos SQL tooenable actualizaciones sucesivas de la aplicación en la nube.</span><span class="sxs-lookup"><span data-stu-id="d53c4-105">Learn how toouse [geo-replication](sql-database-geo-replication-overview.md) in SQL Database tooenable rolling upgrades of your cloud application.</span></span> <span data-ttu-id="d53c4-106">Como la actualización es una operación problemática, pues debe ser parte del diseño y planeamiento de continuidad.</span><span class="sxs-lookup"><span data-stu-id="d53c4-106">Because upgrade is a disruptive operation, it should be part of your business continuity planning and design.</span></span> <span data-ttu-id="d53c4-107">En este artículo que veremos dos métodos diferentes de organización hello proceso de actualización y describe las ventajas de Hola y ventajas y desventajas de cada opción.</span><span class="sxs-lookup"><span data-stu-id="d53c4-107">In this article we look at two different methods of orchestrating hello upgrade process, and discuss hello benefits and trade-offs of each option.</span></span> <span data-ttu-id="d53c4-108">Hola de este artículo se utilizará una aplicación sencilla que consta de una base de datos solo de sitio web tooa conectado como su capa de datos.</span><span class="sxs-lookup"><span data-stu-id="d53c4-108">For hello purposes of this article we will use a simple application that consists of a web site connected tooa single database as its data tier.</span></span> <span data-ttu-id="d53c4-109">Nuestro objetivo es tooupgrade versión 1 de hello aplicación tooversion 2 sin ningún impacto significativo en la experiencia del usuario final Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-109">Our goal is tooupgrade version 1 of hello application tooversion 2 without any significant impact on hello end-user experience.</span></span> 

<span data-ttu-id="d53c4-110">Al evaluar las opciones de actualización de hello debe considerar Hola siguientes factores:</span><span class="sxs-lookup"><span data-stu-id="d53c4-110">When evaluating hello upgrade options you should consider hello following factors:</span></span>

* <span data-ttu-id="d53c4-111">El impacto sobre la disponibilidad de las aplicaciones durante las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="d53c4-111">Impact on application availability during upgrades.</span></span> <span data-ttu-id="d53c4-112">¿Durante cuánto tiempo función de la aplicación hello podría estar limitado o degradado.</span><span class="sxs-lookup"><span data-stu-id="d53c4-112">How long hello application function may be limited or degraded.</span></span>
* <span data-ttu-id="d53c4-113">Capacidad tooroll atrás en el caso de un error de actualización.</span><span class="sxs-lookup"><span data-stu-id="d53c4-113">Ability tooroll back in case of an upgrade failure.</span></span>
* <span data-ttu-id="d53c4-114">Vulnerabilidad de aplicación de hello si se produce un error grave no relacionado durante la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-114">Vulnerability of hello application if an unrelated catastrophic failure occurs during hello upgrade.</span></span>
* <span data-ttu-id="d53c4-115">El costo total en dólares.</span><span class="sxs-lookup"><span data-stu-id="d53c4-115">Total dollar cost.</span></span>  <span data-ttu-id="d53c4-116">Esto incluye la redundancia adicional y costes incrementales de componentes de hello temporal utilizados por el proceso de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-116">This includes additional redundancy and incremental costs of hello temporary components  used by hello upgrade process.</span></span> 

## <a name="upgrading-applications-that-rely-on-database-backups-for-disaster-recovery"></a><span data-ttu-id="d53c4-117">La actualización de las aplicaciones que dependen de las copias de seguridad de base de datos para recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="d53c4-117">Upgrading applications that rely on database backups for disaster recovery</span></span>
<span data-ttu-id="d53c4-118">Si la aplicación se basa en las copias de seguridad automáticas de la base de datos y usa la restauración geográfica para la recuperación ante desastres, es normalmente implementado tooa sola región de Azure.</span><span class="sxs-lookup"><span data-stu-id="d53c4-118">If your application relies on automatic database backups and uses geo-restore for disaster recovery, it is usually deployed tooa single Azure region.</span></span> <span data-ttu-id="d53c4-119">En este caso el proceso de actualización de hello implica crear una implementación de todos los componentes de aplicación de copia de seguridad implicados en la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-119">In this case hello upgrade process involves creating a backup deployment of all application components involved in hello upgrade.</span></span> <span data-ttu-id="d53c4-120">interrupción de toominimize hello para el usuario final aprovecharán Azure Traffic Manager (WATM) con el perfil de conmutación por error de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-120">toominimize hello end-user disruption you will leverage Azure Traffic Manager (WATM) with hello failover profile.</span></span>  <span data-ttu-id="d53c4-121">Hola siguiente diagrama ilustra el proceso de actualización de toohello anteriores de entorno operativo de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-121">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="d53c4-122">Hola extremo <i>1.azurewebsites.net contoso</i> representa una zona de producción de la aplicación hello que necesita toobe actualizado.</span><span class="sxs-lookup"><span data-stu-id="d53c4-122">hello endpoint <i>contoso-1.azurewebsites.net</i> represents a production slot of hello application that needs toobe upgraded.</span></span> <span data-ttu-id="d53c4-123">tooenable Hola capacidad tooroll volver Hola actualización, necesita crear un espacio de fase con una copia de la aplicación hello totalmente sincronizada.</span><span class="sxs-lookup"><span data-stu-id="d53c4-123">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="d53c4-124">Hello pasos siguientes son de la aplicación hello tooprepare necesarios para la actualización de hello:</span><span class="sxs-lookup"><span data-stu-id="d53c4-124">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="d53c4-125">Crear un espacio de la fase de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-125">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="d53c4-126">toodo que crear una base de datos secundaria (1) e implementar un sitio web idéntico en hello misma región de Azure.</span><span class="sxs-lookup"><span data-stu-id="d53c4-126">toodo that create a secondary database (1) and deploy an identical web site in hello same Azure region.</span></span> <span data-ttu-id="d53c4-127">Supervisar Hola secundaria toosee si Hola la propagación de proceso se ha completado.</span><span class="sxs-lookup"><span data-stu-id="d53c4-127">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="d53c4-128">Cree un perfil de conmutación por error en WATM con <i>contoso-1.azurewebsites.net</i> como punto de conexión en línea y <i>contoso 2.azurewebsites.net</i> como punto de conexión desconectado.</span><span class="sxs-lookup"><span data-stu-id="d53c4-128">Create a failover profile in WATM with <i>contoso-1.azurewebsites.net</i> as online endpoint and <i>contoso-2.azurewebsites.net</i> as offline.</span></span> 

> [!NOTE]
> <span data-ttu-id="d53c4-129">Tenga en cuenta los pasos de preparación hello no afectará a la aplicación hello en la ranura de producción de hello y puede funcionar en modo de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="d53c4-129">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
>  

![Configuración de la replicación geográfica de la Base de datos SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-1.png)

<span data-ttu-id="d53c4-132">Cuando haya realizado los pasos de preparación de hello aplicación hello está listo para la actualización real de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-132">Once hello preparation steps are completed hello application is ready for hello actual upgrade.</span></span> <span data-ttu-id="d53c4-133">Hola siguiente diagrama muestra Hola pasos implicados en el proceso de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-133">hello following diagram illustrates hello steps involved in hello upgrade process.</span></span> 

1. <span data-ttu-id="d53c4-134">Establecer base de datos principal de Hola Hola ranura solo tooread en modo de producción (3).</span><span class="sxs-lookup"><span data-stu-id="d53c4-134">Set hello primary database in hello production slot tooread-only mode (3).</span></span> <span data-ttu-id="d53c4-135">Esto garantizará que Hola permanecerá instancia de producción de la aplicación hello (V1) de solo lectura durante la actualización de hello evitando divergencia de datos de hello entre Hola V1 y V2 instancias de base de datos.</span><span class="sxs-lookup"><span data-stu-id="d53c4-135">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="d53c4-136">Desconectar Hola base de datos secundaria utilizando el modo de finalización planeada hello (4).</span><span class="sxs-lookup"><span data-stu-id="d53c4-136">Disconnect hello secondary database using hello planned termination mode (4).</span></span> <span data-ttu-id="d53c4-137">Creará una copia independiente totalmente sincronizada de la base de datos principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-137">It will create a fully synchronized independent copy of hello primary database.</span></span> <span data-ttu-id="d53c4-138">Esta base de datos se actualizará.</span><span class="sxs-lookup"><span data-stu-id="d53c4-138">This database will be upgraded.</span></span>
3. <span data-ttu-id="d53c4-139">Activar el modo de escritura tooread de base de datos principal de Hola y ejecute el script de actualización de hello en la ranura de fase de hello (5).</span><span class="sxs-lookup"><span data-stu-id="d53c4-139">Turn hello primary database tooread-write mode and run hello upgrade script in hello stage slot  (5).</span></span>     

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option1-2.png)

<span data-ttu-id="d53c4-142">Ahora está aplicación de hello tooswitch listo Hola a los usuarios finales toohello provisionalmente copia si Hola actualización se completó correctamente.</span><span class="sxs-lookup"><span data-stu-id="d53c4-142">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello staged copy hello application.</span></span> <span data-ttu-id="d53c4-143">Ranura de producción de hello de aplicación hello estará ahora.</span><span class="sxs-lookup"><span data-stu-id="d53c4-143">It will now become hello production slot of hello application.</span></span>  <span data-ttu-id="d53c4-144">Esto supone unos pocos pasos más tal como se muestra en hello siguiente diagrama.</span><span class="sxs-lookup"><span data-stu-id="d53c4-144">This involves a few more steps as illustrated on hello following diagram.</span></span>

1. <span data-ttu-id="d53c4-145">Cambiar punto de conexión en línea hello en perfil WATM de hello demasiado<i>2.azurewebsites.net contoso</i>, qué versión de toohello V2 puntos del sitio web de hello (6).</span><span class="sxs-lookup"><span data-stu-id="d53c4-145">Switch hello online endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which points toohello V2 version of hello web site (6).</span></span> <span data-ttu-id="d53c4-146">Ahora se convierte en zona de producción de hello con hello aplicación V2 y tráfico de usuario final de hello es tooit dirigido.</span><span class="sxs-lookup"><span data-stu-id="d53c4-146">It now becomes hello production slot with hello V2 application and hello end-user traffic is directed tooit.</span></span>  
2. <span data-ttu-id="d53c4-147">Si ya no necesita los componentes de la aplicación hello V1 para poder sin ningún riesgo quitarlos (7).</span><span class="sxs-lookup"><span data-stu-id="d53c4-147">If you no longer need hello V1 application components so you can safely remove them (7).</span></span>   

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option1-3.png)

<span data-ttu-id="d53c4-150">Si el proceso de actualización de hello es correcta, por ejemplo debido a error de tooan en el script de actualización de hello, ranura de la fase de hello debe considerarse en peligro.</span><span class="sxs-lookup"><span data-stu-id="d53c4-150">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="d53c4-151">tooroll hacer una copia de hello toohello previas a la actualización estado de la aplicación simplemente Revertir aplicación hello en el acceso de toofull de ranura de producción de hello.</span><span class="sxs-lookup"><span data-stu-id="d53c4-151">tooroll back hello application toohello pre-upgrade state you simply revert hello application in hello production slot toofull access.</span></span> <span data-ttu-id="d53c4-152">pasos de Hola se muestran en el diagrama siguiente Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-152">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="d53c4-153">Establecer modo de escritura de tooread de copia de base de datos de hello (8).</span><span class="sxs-lookup"><span data-stu-id="d53c4-153">Set hello database copy tooread-write mode (8).</span></span> <span data-ttu-id="d53c4-154">Esto restaurará Hola completa V1 funcionalmente en la ranura de producción de hello.</span><span class="sxs-lookup"><span data-stu-id="d53c4-154">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="d53c4-155">Realizar análisis de causa raíz de Hola y quitar componentes de hello en peligro en la ranura de fase de hello (9).</span><span class="sxs-lookup"><span data-stu-id="d53c4-155">Perform hello root cause analysis and remove hello compromised components in hello stage slot (9).</span></span> 

<span data-ttu-id="d53c4-156">En este momento aplicación hello es totalmente funcional y se pueden repetir los pasos de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-156">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="d53c4-157">Hello rollback no requiere cambios en el perfil WATM como ya puntos demasiado<i>1.azurewebsites.net contoso</i> como Hola extremo activo.</span><span class="sxs-lookup"><span data-stu-id="d53c4-157">hello rollback does not require changes in WATM profile as it already points too<i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option1-4.png)

<span data-ttu-id="d53c4-160">clave de Hello **ventaja** de esta opción es que puede actualizar una aplicación en una sola región con un conjunto de pasos sencillos.</span><span class="sxs-lookup"><span data-stu-id="d53c4-160">hello key **advantage** of this option is that you can upgrade an application in a single region using a set of simple steps.</span></span> <span data-ttu-id="d53c4-161">costo de dólar Hola de actualización de hello es relativamente baja.</span><span class="sxs-lookup"><span data-stu-id="d53c4-161">hello dollar cost of hello upgrade is relatively low.</span></span> <span data-ttu-id="d53c4-162">Hola principal **contrapartida** es que si se produce un error grave durante el estado previo a la actualización de Hola Hola actualización recuperación toohello implicará la reimplementación de la aplicación hello en una región distinta y Hola base de datos de copia de seguridad mediante la restauración geográfica.</span><span class="sxs-lookup"><span data-stu-id="d53c4-162">hello main **tradeoff** is that if a catastrophic failure occurs during hello upgrade hello recovery toohello pre-upgrade state will involve re-deployment of hello application in a different region and restoring hello database from backup using geo-restore.</span></span> <span data-ttu-id="d53c4-163">Este proceso dará como resultado un tiempo de inactividad considerable.</span><span class="sxs-lookup"><span data-stu-id="d53c4-163">This process will result in significant downtime.</span></span>   

## <a name="upgrading-applications-that-rely-on-database-geo-replication-for-disaster-recovery"></a><span data-ttu-id="d53c4-164">Actualización de aplicaciones que dependen de la replicación geográfica para la recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="d53c4-164">Upgrading applications that rely on database geo-replication for disaster recovery</span></span>
<span data-ttu-id="d53c4-165">Si la aplicación utiliza la replicación geográfica para la continuidad del negocio, está implementada tooat menos dos regiones diferentes con una implementación activa en la región principal y una implementación en espera en la región de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d53c4-165">If your application leverages geo-replication for business continuity, it is deployed  tooat least two different regions with an active deployment in Primary region and a standby deployment in Backup region.</span></span> <span data-ttu-id="d53c4-166">Además toohello factores se ha mencionado anteriormente, proceso de actualización de hello debe garantizar que:</span><span class="sxs-lookup"><span data-stu-id="d53c4-166">In addition toohello factors mentioned earlier, hello upgrade process must guarantee that:</span></span>

* <span data-ttu-id="d53c4-167">aplicación de Hello sigue estando protegida frente a errores catastróficos en todo momento durante el proceso de actualización de Hola</span><span class="sxs-lookup"><span data-stu-id="d53c4-167">hello application remains protected from catastrophic failures at all times during hello upgrade process</span></span>
* <span data-ttu-id="d53c4-168">componentes con redundancia geográfica de Hola de aplicación hello se actualizan en paralelo con componentes active Hola</span><span class="sxs-lookup"><span data-stu-id="d53c4-168">hello geo-redundant components of hello application are upgraded in parallel with hello active components</span></span>

<span data-ttu-id="d53c4-169">tooachieve generar perfiles de estos objetivos aprovecharán con conmutación por error de hello Azure Traffic Manager (WATM) con una activa y tres puntos de conexión de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d53c4-169">tooachieve these goals you will leverage Azure Traffic Manager (WATM) using hello failover profile with one active and three backup endpoints.</span></span>  <span data-ttu-id="d53c4-170">Hola siguiente diagrama ilustra el proceso de actualización de toohello anteriores de entorno operativo de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-170">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="d53c4-171">Hola sitios web <i>contoso 1.azurewebsites.net</i> y <i>dr.azurewebsites.net contoso</i> representan una ranura de producción de la aplicación hello con redundancia geográfica completa.</span><span class="sxs-lookup"><span data-stu-id="d53c4-171">hello web sites <i>contoso-1.azurewebsites.net</i> and <i>contoso-dr.azurewebsites.net</i> represent a production slot of hello application with full geographic redundancy.</span></span> <span data-ttu-id="d53c4-172">tooenable Hola capacidad tooroll volver Hola actualización, necesita crear un espacio de fase con una copia de la aplicación hello totalmente sincronizada.</span><span class="sxs-lookup"><span data-stu-id="d53c4-172">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="d53c4-173">Dado que necesitan tooensure que aplicación hello puede recuperar rápidamente en caso de que se produce un error grave durante el proceso de actualización de hello, ranura de la fase de hello necesita que toobe también con redundancia geográfica.</span><span class="sxs-lookup"><span data-stu-id="d53c4-173">Because you need tooensure that hello application can quickly recover in case a catastrophic failure occurs during hello upgrade process, hello stage slot needs toobe geo-redundant as well.</span></span> <span data-ttu-id="d53c4-174">Hello pasos siguientes son de la aplicación hello tooprepare necesarios para la actualización de hello:</span><span class="sxs-lookup"><span data-stu-id="d53c4-174">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="d53c4-175">Crear un espacio de la fase de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-175">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="d53c4-176">toodo que crea una base de datos secundaria (1) e implementa una copia idéntica del sitio web de Hola Hola misma región de Azure.</span><span class="sxs-lookup"><span data-stu-id="d53c4-176">toodo that create a secondary database (1) and deploy an identical copy of hello web site in hello same Azure region.</span></span> <span data-ttu-id="d53c4-177">Supervisar Hola secundaria toosee si Hola la propagación de proceso se ha completado.</span><span class="sxs-lookup"><span data-stu-id="d53c4-177">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="d53c4-178">Crear una base de datos secundaria con redundancia geográfica en la ranura de la fase de hello mediante la replicación geográfica región de copia de seguridad Hola base de datos secundaria toohello (Esto se denomina "encadenadas replicación geográfica").</span><span class="sxs-lookup"><span data-stu-id="d53c4-178">Create a geo-redundant secondary database in hello stage slot by geo-replicating hello secondary database toohello backup region (this is called "chained geo-replication").</span></span> <span data-ttu-id="d53c4-179">Supervisar toosee secundaria de copia de seguridad de hello si Hola proceso la propagación está completado (3).</span><span class="sxs-lookup"><span data-stu-id="d53c4-179">Monitor hello backup secondary toosee if hello seeding process is completed (3).</span></span>
3. <span data-ttu-id="d53c4-180">Crear una copia en espera del sitio web de hello en la región de copia de seguridad de Hola y vincúlela toohello con redundancia geográfica secundaria (4).</span><span class="sxs-lookup"><span data-stu-id="d53c4-180">Create a standby copy of hello web site in hello backup region and link it toohello geo-redundant secondary (4).</span></span>  
4. <span data-ttu-id="d53c4-181">Agregar extremos adicionales de hello <i>contoso 2.azurewebsites.net</i> y <i>3.azurewebsites.net contoso</i> perfil de conmutación por error de toohello en WATM como extremos sin conexión (5).</span><span class="sxs-lookup"><span data-stu-id="d53c4-181">Add hello additional endpoints <i>contoso-2.azurewebsites.net</i> and <i>contoso-3.azurewebsites.net</i> toohello failover profile in WATM as offline endpoints (5).</span></span> 

> [!NOTE]
> <span data-ttu-id="d53c4-182">Tenga en cuenta los pasos de preparación hello no afectará a la aplicación hello en la ranura de producción de hello y puede funcionar en modo de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="d53c4-182">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
> 
> 

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option2-1.png)

<span data-ttu-id="d53c4-185">Una vez completados los pasos de preparación de hello, ranura de la fase de hello está listo para actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-185">Once hello preparation steps are completed, hello stage slot is ready for hello upgrade.</span></span> <span data-ttu-id="d53c4-186">Hola siguiente diagrama ilustra los pasos de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-186">hello following diagram illustrates hello upgrade steps.</span></span>

1. <span data-ttu-id="d53c4-187">Establecer base de datos principal de Hola Hola ranura solo tooread en modo de producción (6).</span><span class="sxs-lookup"><span data-stu-id="d53c4-187">Set hello primary database in hello production slot tooread-only mode (6).</span></span> <span data-ttu-id="d53c4-188">Esto garantizará que Hola permanecerá instancia de producción de la aplicación hello (V1) de solo lectura durante la actualización de hello evitando divergencia de datos de hello entre Hola V1 y V2 instancias de base de datos.</span><span class="sxs-lookup"><span data-stu-id="d53c4-188">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="d53c4-189">Desconectar la base de datos secundaria de Hola Hola misma región mediante Hola modo la terminación planificada (7).</span><span class="sxs-lookup"><span data-stu-id="d53c4-189">Disconnect hello secondary database in hello same region using hello planned termination mode (7).</span></span> <span data-ttu-id="d53c4-190">Creará una copia independiente totalmente sincronizada de base de datos principal hello, que se convertirá automáticamente en un elemento principal después de la terminación de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-190">It will create a fully synchronized independent copy of hello primary database, which will automatically become a primary after hello termination.</span></span> <span data-ttu-id="d53c4-191">Esta base de datos se actualizará.</span><span class="sxs-lookup"><span data-stu-id="d53c4-191">This database will be upgraded.</span></span>
3. <span data-ttu-id="d53c4-192">Activar la base de datos principal de Hola Hola fase ranura tooread-en modo de escritura y ejecutar el script de actualización de hello (8).</span><span class="sxs-lookup"><span data-stu-id="d53c4-192">Turn hello primary database in hello stage slot tooread-write mode and run hello upgrade script (8).</span></span>    

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option2-2.png)

<span data-ttu-id="d53c4-195">Si Hola actualización se completó correctamente ahora está versión de toohello V2 de tooswitch listo Hola a los usuarios finales de la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="d53c4-195">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello V2 version of hello application.</span></span> <span data-ttu-id="d53c4-196">Hola siguiente diagrama ilustra los pasos para saludo.</span><span class="sxs-lookup"><span data-stu-id="d53c4-196">hello following diagram illustrates hello steps involved.</span></span>

1. <span data-ttu-id="d53c4-197">Cambiar punto de conexión activo de hello en perfil WATM de hello demasiado<i>2.azurewebsites.net contoso</i>, que ahora apunta toohello V2 versión del sitio web de hello (9).</span><span class="sxs-lookup"><span data-stu-id="d53c4-197">Switch hello active endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which now points toohello V2 version of hello web site (9).</span></span> <span data-ttu-id="d53c4-198">Ahora se convierte en una ranura de producción con hello aplicación V2 y tráfico de usuario final es tooit dirigido.</span><span class="sxs-lookup"><span data-stu-id="d53c4-198">It now becomes a production slot with hello V2 application and end-user traffic is directed tooit.</span></span> 
2. <span data-ttu-id="d53c4-199">Si ya no necesita la aplicación de hello V1 por lo que puede quitar (10 y 11).</span><span class="sxs-lookup"><span data-stu-id="d53c4-199">If you no longer need hello V1 application so you can safely remove it (10 and 11).</span></span>  

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option2-3.png)

<span data-ttu-id="d53c4-202">Si el proceso de actualización de hello es correcta, por ejemplo debido a error de tooan en el script de actualización de hello, ranura de la fase de hello debe considerarse en peligro.</span><span class="sxs-lookup"><span data-stu-id="d53c4-202">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="d53c4-203">tooroll hacer una copia de hello toohello previas a la actualización estado de la aplicación simplemente Revertir aplicación de hello toousing en la ranura de producción de hello con acceso completo.</span><span class="sxs-lookup"><span data-stu-id="d53c4-203">tooroll back hello application toohello pre-upgrade state you simply revert toousing hello application in hello production slot with full access.</span></span> <span data-ttu-id="d53c4-204">pasos de Hola se muestran en el diagrama siguiente Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-204">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="d53c4-205">Conjunto de copia de base de datos principal de hello en modo de tooread y escritura de ranura de producción de hello (12).</span><span class="sxs-lookup"><span data-stu-id="d53c4-205">Set hello primary database copy in hello production slot tooread-write mode (12).</span></span> <span data-ttu-id="d53c4-206">Esto restaurará Hola completa V1 funcionalmente en la ranura de producción de hello.</span><span class="sxs-lookup"><span data-stu-id="d53c4-206">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="d53c4-207">Realizar análisis de causa raíz de Hola y quitar componentes de hello en peligro en la ranura de fase de hello (13 y 14).</span><span class="sxs-lookup"><span data-stu-id="d53c4-207">Perform hello root cause analysis and remove hello compromised components in hello stage slot (13 and 14).</span></span> 

<span data-ttu-id="d53c4-208">En este momento aplicación hello es totalmente funcional y se pueden repetir los pasos de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-208">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="d53c4-209">Hello rollback no requiere cambios en el perfil WATM como ya puntos demasiado <i>1.azurewebsites.net contoso</i> como Hola extremo activo.</span><span class="sxs-lookup"><span data-stu-id="d53c4-209">hello rollback does not require changes in WATM profile as it already points too <i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![Configuración de replicación geográfica de SQL Database.](media/sql-database-manage-application-rolling-upgrade/Option2-4.png)

<span data-ttu-id="d53c4-212">clave de Hello **ventaja** de esta opción es que puede actualizar aplicación hello y su copia con redundancia geográfica en paralelo sin poner en peligro la continuidad empresarial durante la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="d53c4-212">hello key **advantage** of this option is that you can upgrade both hello application and its geo-redundant copy in parallel without compromising your business continuity during hello upgrade.</span></span> <span data-ttu-id="d53c4-213">Hola principal **contrapartida** es que requiere doble redundancia de los componentes de aplicaciones y, por tanto, implica mayor costo de dólar.</span><span class="sxs-lookup"><span data-stu-id="d53c4-213">hello main **tradeoff** is that it requires double redundancy of each application component and therefore incurs higher dollar cost.</span></span> <span data-ttu-id="d53c4-214">También implica un flujo de trabajo más complicado.</span><span class="sxs-lookup"><span data-stu-id="d53c4-214">It also involves a more complicated workflow.</span></span> 

## <a name="summary"></a><span data-ttu-id="d53c4-215">Resumen</span><span class="sxs-lookup"><span data-stu-id="d53c4-215">Summary</span></span>
<span data-ttu-id="d53c4-216">métodos de actualización de Hello dos descritos en el artículo Hola difieren en dólares de hello y complejidad de costo, pero se centran en minimizar el tiempo de hello cuando el usuario de final de hello es limitadas operaciones sólo tooread.</span><span class="sxs-lookup"><span data-stu-id="d53c4-216">hello two upgrade methods described in hello article differ in complexity and hello dollar cost but they both focus on minimizing hello time when hello end user is limited tooread-only operations.</span></span> <span data-ttu-id="d53c4-217">Duración de Hola de script de actualización de hello directamente define ese tiempo.</span><span class="sxs-lookup"><span data-stu-id="d53c4-217">That time is directly defined by hello duration of hello upgrade script.</span></span> <span data-ttu-id="d53c4-218">No depende de tamaño de base de datos de hello, Hola de nivel de servicio seleccione, configuración de sitios web de Hola y otros factores que no se puede controlar fácilmente.</span><span class="sxs-lookup"><span data-stu-id="d53c4-218">It does not depend on hello database size, hello service tier you chose, hello web site configuration and other factors that you cannot easily control.</span></span> <span data-ttu-id="d53c4-219">Esto es porque todos los pasos de preparación de Hola se desacoplan de pasos de actualización de Hola y pueden realizarse sin afectar a la aplicación de producción de hello.</span><span class="sxs-lookup"><span data-stu-id="d53c4-219">This is because all hello preparation steps are decoupled from hello upgrade steps and can be done without impacting hello production application.</span></span> <span data-ttu-id="d53c4-220">eficacia de Hola de script de actualización de hello es factor clave Hola que determina la experiencia del usuario final de Hola durante las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="d53c4-220">hello efficiency of hello upgrade script is hello key factor that determines hello end-user experience during upgrades.</span></span> <span data-ttu-id="d53c4-221">Por lo que se puede mejorar de mejor manera de hello es centrar los esfuerzos en hacer la secuencia de comandos de actualización de hello tan eficaz como sea posible.</span><span class="sxs-lookup"><span data-stu-id="d53c4-221">So hello best way you can improve it is by focusing your efforts on making hello upgrade script as efficient as possible.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="d53c4-222">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="d53c4-222">Next steps</span></span>
* <span data-ttu-id="d53c4-223">Para obtener una descripción general y los escenarios de la continuidad empresarial, consulte [Información general sobre la continuidad empresarial](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="d53c4-223">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md).</span></span>
* <span data-ttu-id="d53c4-224">toolearn acerca de las copias de seguridad automatizada de base de datos SQL Azure, consulte [copias de seguridad automáticas de base de datos SQL](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="d53c4-224">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="d53c4-225">toolearn sobre el uso de copias de seguridad automatizadas para la recuperación, consulte [restaurar una base de datos de copias de seguridad automatizadas](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="d53c4-225">toolearn about using automated backups for recovery, see [restore a database from automated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="d53c4-226">toolearn acerca de las opciones de recuperación más rápidos, consulte [replicación geográfica activa](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d53c4-226">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md).</span></span>


