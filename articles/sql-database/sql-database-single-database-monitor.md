---
title: rendimiento de la base de datos de aaaMonitoring en la base de datos de SQL de Azure | Documentos de Microsoft
description: "Obtenga información acerca de las opciones de hello para la supervisión de la base de datos con las herramientas de Azure y vistas de administración dinámica."
keywords: "supervisión de base de datos, rendimiento de base de datos"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: a2e47475-c955-4a8d-a65c-cbef9a6d9b9f
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 01/10/2017
ms.author: carlrab
ms.openlocfilehash: b13771183d4ccf37f58e2fc518b9b14de38212dc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="monitoring-database-performance-in-azure-sql-database"></a><span data-ttu-id="9e77f-104">Supervisión de rendimiento de bases de datos con la Base de datos SQL de Azure</span><span class="sxs-lookup"><span data-stu-id="9e77f-104">Monitoring database performance in Azure SQL Database</span></span>
<span data-ttu-id="9e77f-105">Supervisar el rendimiento de Hola de una base de datos SQL de Azure se inicia con la supervisión del nivel de toohello relativa de uso de recursos de Hola de rendimiento de base de datos que elija.</span><span class="sxs-lookup"><span data-stu-id="9e77f-105">Monitoring hello performance of a SQL database in Azure starts with monitoring hello resource utilization relative toohello level of database performance you choose.</span></span> <span data-ttu-id="9e77f-106">La supervisión ayuda a determinar si la base de datos tiene capacidad de sobra o está teniendo problemas para porque se alcanzó recursos y, a continuación, decidir si es nivel de rendimiento de tiempo tooadjust hello y [nivel de servicio](sql-database-service-tiers.md) de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-106">Monitoring helps you  determine whether your database has excess capacity or is having trouble because resources are maxed out, and then decide whether it's time tooadjust hello performance level and [service tier](sql-database-service-tiers.md) of your database.</span></span> <span data-ttu-id="9e77f-107">Puede supervisar la base de datos con las herramientas gráficas de hello [portal de Azure](https://portal.azure.com) o mediante SQL [vistas de administración dinámica](https://msdn.microsoft.com/library/ms188754.aspx).</span><span class="sxs-lookup"><span data-stu-id="9e77f-107">You can monitor your database using graphical tools in hello [Azure portal](https://portal.azure.com) or using SQL [dynamic management views](https://msdn.microsoft.com/library/ms188754.aspx).</span></span>

## <a name="monitor-databases-using-hello-azure-portal"></a><span data-ttu-id="9e77f-108">Supervisar bases de datos mediante Hola portal de Azure</span><span class="sxs-lookup"><span data-stu-id="9e77f-108">Monitor databases using hello Azure portal</span></span>
<span data-ttu-id="9e77f-109">Hola [portal de Azure](https://portal.azure.com/), puede supervisar el uso de una sola base de datos, seleccione la base de datos y al hacer clic en hello **supervisión** gráfico.</span><span class="sxs-lookup"><span data-stu-id="9e77f-109">In hello [Azure portal](https://portal.azure.com/), you can monitor a single database’s utilization by selecting your database and clicking hello **Monitoring** chart.</span></span> <span data-ttu-id="9e77f-110">Se abrirá una **métrica** ventana que se puede cambiar haciendo clic en hello **Editar gráfico** botón.</span><span class="sxs-lookup"><span data-stu-id="9e77f-110">This brings up a **Metric** window that you can change by clicking hello **Edit chart** button.</span></span> <span data-ttu-id="9e77f-111">Agregue Hola siguientes métricas:</span><span class="sxs-lookup"><span data-stu-id="9e77f-111">Add hello following metrics:</span></span>

* <span data-ttu-id="9e77f-112">Porcentaje de CPU</span><span class="sxs-lookup"><span data-stu-id="9e77f-112">CPU percentage</span></span>
* <span data-ttu-id="9e77f-113">Porcentaje de DTU</span><span class="sxs-lookup"><span data-stu-id="9e77f-113">DTU percentage</span></span>
* <span data-ttu-id="9e77f-114">Porcentaje de E/S de datos</span><span class="sxs-lookup"><span data-stu-id="9e77f-114">Data IO percentage</span></span>
* <span data-ttu-id="9e77f-115">Porcentaje de tamaño de base de datos</span><span class="sxs-lookup"><span data-stu-id="9e77f-115">Database size percentage</span></span>

<span data-ttu-id="9e77f-116">Una vez haya agregado estas métricas, puede seguir tooview ellas en hello **supervisión** gráfico con más detalles sobre hello **métrica** ventana.</span><span class="sxs-lookup"><span data-stu-id="9e77f-116">Once you’ve added these metrics, you can continue tooview them in hello **Monitoring** chart with more details on hello **Metric** window.</span></span> <span data-ttu-id="9e77f-117">Las métricas de cuatro muestran toohello relativa del porcentaje de utilización promedio hello **DTU** de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-117">All four metrics show hello average utilization percentage relative toohello **DTU** of your database.</span></span> <span data-ttu-id="9e77f-118">Vea hello [niveles de servicio](sql-database-service-tiers.md) artículo para obtener más información acerca de la Dtu.</span><span class="sxs-lookup"><span data-stu-id="9e77f-118">See hello [service tiers](sql-database-service-tiers.md) article for details about DTUs.</span></span>

![Supervisión del nivel de servicio del rendimiento de la base de datos.](./media/sql-database-service-tiers/sqldb_service_tier_monitoring.png)

<span data-ttu-id="9e77f-120">También puede configurar alertas en las métricas de rendimiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-120">You can also configure alerts on hello performance metrics.</span></span> <span data-ttu-id="9e77f-121">Haga clic en hello **Agregar alerta** botón en hello **métrica** ventana.</span><span class="sxs-lookup"><span data-stu-id="9e77f-121">Click hello **Add alert** button in hello **Metric** window.</span></span> <span data-ttu-id="9e77f-122">Siga hello tooconfigure de Asistente para la alerta.</span><span class="sxs-lookup"><span data-stu-id="9e77f-122">Follow hello wizard tooconfigure your alert.</span></span> <span data-ttu-id="9e77f-123">Tener Hola opción tooalert si las métricas de hello superan un umbral determinado o si Hola está por debajo de un umbral determinado.</span><span class="sxs-lookup"><span data-stu-id="9e77f-123">You have hello option tooalert if hello metrics exceed a certain threshold or if hello metric falls below a certain threshold.</span></span>

<span data-ttu-id="9e77f-124">Por ejemplo, si espera cargas de trabajo de hello en su toogrow de base de datos, puede tooconfigure una alerta de correo electrónico cada vez que la base de datos alcanza el 80% en cualquiera de las métricas de rendimiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-124">For example, if you expect hello workload on your database toogrow, you can choose tooconfigure an email alert whenever your database reaches 80% on any of hello performance metrics.</span></span> <span data-ttu-id="9e77f-125">Puede utilizar esto como un toofigure de advertencia temprano out cuando es posible que tenga tooswitch toohello siguiente nivel de rendimiento superior.</span><span class="sxs-lookup"><span data-stu-id="9e77f-125">You can use this as an early warning toofigure out when you might have tooswitch toohello next higher performance level.</span></span>

<span data-ttu-id="9e77f-126">las métricas de rendimiento de Hello también pueden ayudarle a determinar si es capaz de toodowngrade tooa nivel de rendimiento inferior.</span><span class="sxs-lookup"><span data-stu-id="9e77f-126">hello performance metrics can also help you determine if you are able toodowngrade tooa lower performance level.</span></span> <span data-ttu-id="9e77f-127">Se supone que usa una base de datos para estándar S2 y todos los programa de métricas de rendimiento que hello en promedio de base de datos no utiliza más del 10% en un momento dado.</span><span class="sxs-lookup"><span data-stu-id="9e77f-127">Assume you are using a Standard S2 database and all performance metrics show that hello database on average does not use more than 10% at any given time.</span></span> <span data-ttu-id="9e77f-128">Es probable que esa base de datos de hello funcionarán bien en S1 estándar.</span><span class="sxs-lookup"><span data-stu-id="9e77f-128">It is likely that hello database will work well in Standard S1.</span></span> <span data-ttu-id="9e77f-129">Sin embargo, sea consciente de las cargas de trabajo que tienen picos o fluctúan antes de realizar el nivel de rendimiento inferior de hello decisión toomove tooa.</span><span class="sxs-lookup"><span data-stu-id="9e77f-129">However, be aware of workloads that spike or fluctuate before making hello decision toomove tooa lower performance level.</span></span>

## <a name="monitor-databases-using-dmvs"></a><span data-ttu-id="9e77f-130">Supervisión de bases de datos mediante DMV</span><span class="sxs-lookup"><span data-stu-id="9e77f-130">Monitor databases using DMVs</span></span>
<span data-ttu-id="9e77f-131">Hello mismas métricas que se exponen en el portal de hello también están disponibles a través de vistas del sistema: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) Hola lógico **maestro** base de datos del servidor, y [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) en la base de datos de usuario de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-131">hello same metrics that are exposed in hello portal are also available through system views: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) in hello logical **master** database of your server, and [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) in hello user database.</span></span> <span data-ttu-id="9e77f-132">Use **sys.resource_stats** si necesita toomonitor menos datos pormenorizados durante un período más largo de tiempo.</span><span class="sxs-lookup"><span data-stu-id="9e77f-132">Use **sys.resource_stats** if you need toomonitor less granular data across a longer period of time.</span></span> <span data-ttu-id="9e77f-133">Use **sys.dm_db_resource_stats** si necesita toomonitor datos más pormenorizados durante un período de tiempo menor.</span><span class="sxs-lookup"><span data-stu-id="9e77f-133">Use **sys.dm_db_resource_stats** if you need toomonitor more granular data within a smaller time frame.</span></span> <span data-ttu-id="9e77f-134">Para obtener más información, consulte la [Guía de rendimiento de la Base de datos SQL de Azure](sql-database-single-database-monitor.md#monitor-resource-use).</span><span class="sxs-lookup"><span data-stu-id="9e77f-134">For more information, see [Azure SQL Database Performance Guidance](sql-database-single-database-monitor.md#monitor-resource-use).</span></span>

> [!NOTE]
> <span data-ttu-id="9e77f-135">**sys.dm_db_resource_stats** devuelve un conjunto de resultados vacío cuando se utiliza en las bases de datos Web Edition y Business Edition, que se retiraron.</span><span class="sxs-lookup"><span data-stu-id="9e77f-135">**sys.dm_db_resource_stats** returns an empty result set when used in Web and Business edition databases, which are retired.</span></span>
>
>

### <a name="monitor-resource-use"></a><span data-ttu-id="9e77f-136">Supervisión del uso de recursos</span><span class="sxs-lookup"><span data-stu-id="9e77f-136">Monitor resource use</span></span>

<span data-ttu-id="9e77f-137">Puede supervisar el uso de recursos con [Información de rendimiento de consultas de SQL Database](sql-database-query-performance.md) y [Almacén de consultas](https://msdn.microsoft.com/library/dn817826.aspx).</span><span class="sxs-lookup"><span data-stu-id="9e77f-137">You can monitor resource usage using [SQL Database Query Performance Insight](sql-database-query-performance.md) and [Query Store](https://msdn.microsoft.com/library/dn817826.aspx).</span></span>

<span data-ttu-id="9e77f-138">También puede supervisar el uso con estas dos vistas:</span><span class="sxs-lookup"><span data-stu-id="9e77f-138">You can also monitor usage using these two views:</span></span>

* [<span data-ttu-id="9e77f-139">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="9e77f-139">sys.dm_db_resource_stats</span></span>](https://msdn.microsoft.com/library/dn800981.aspx)
* [<span data-ttu-id="9e77f-140">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="9e77f-140">sys.resource_stats</span></span>](https://msdn.microsoft.com/library/dn269979.aspx)

#### <a name="sysdmdbresourcestats"></a><span data-ttu-id="9e77f-141">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="9e77f-141">sys.dm_db_resource_stats</span></span>
<span data-ttu-id="9e77f-142">Puede usar hello [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) vista en cada base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="9e77f-142">You can use hello [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) view in every SQL database.</span></span> <span data-ttu-id="9e77f-143">Hola **sys.dm_db_resource_stats** vista muestra el nivel de servicio de toohello relativa datos de uso de recursos recientes.</span><span class="sxs-lookup"><span data-stu-id="9e77f-143">hello **sys.dm_db_resource_stats** view shows recent resource use data relative toohello service tier.</span></span> <span data-ttu-id="9e77f-144">Porcentajes medios para CPU, E/S de datos, escritura de registros y memoria, se registran cada 15 segundos y se mantienen durante una hora.</span><span class="sxs-lookup"><span data-stu-id="9e77f-144">Average percentages for CPU, data I/O, log writes, and memory are recorded every 15 seconds and are maintained for 1 hour.</span></span>

<span data-ttu-id="9e77f-145">Dado que esta vista proporciona una panorámica más granular del uso de recursos, use primero **sys.dm_db_resource_stats** para cualquier análisis o solución de problemas de estado actual.</span><span class="sxs-lookup"><span data-stu-id="9e77f-145">Because this view provides a more granular look at resource use, use **sys.dm_db_resource_stats** first for any current-state analysis or troubleshooting.</span></span> <span data-ttu-id="9e77f-146">Por ejemplo, esta consulta muestra recursos máximo y promedio de hello usan para base de datos actual de hello sobre Hola última hora:</span><span class="sxs-lookup"><span data-stu-id="9e77f-146">For example, this query shows hello average and maximum resource use for hello current database over hello past hour:</span></span>

    SELECT  
        AVG(avg_cpu_percent) AS 'Average CPU use in percent',
        MAX(avg_cpu_percent) AS 'Maximum CPU use in percent',
        AVG(avg_data_io_percent) AS 'Average data I/O in percent',
        MAX(avg_data_io_percent) AS 'Maximum data I/O in percent',
        AVG(avg_log_write_percent) AS 'Average log write use in percent',
        MAX(avg_log_write_percent) AS 'Maximum log write use in percent',
        AVG(avg_memory_usage_percent) AS 'Average memory use in percent',
        MAX(avg_memory_usage_percent) AS 'Maximum memory use in percent'
    FROM sys.dm_db_resource_stats;  

<span data-ttu-id="9e77f-147">Para otras consultas, vea los ejemplos de hello en [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span><span class="sxs-lookup"><span data-stu-id="9e77f-147">For other queries, see hello examples in [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span></span>

#### <a name="sysresourcestats"></a><span data-ttu-id="9e77f-148">Sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="9e77f-148">sys.resource_stats</span></span>
<span data-ttu-id="9e77f-149">Hola [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) vista Hola **maestro** base de datos tiene información adicional que puede ayudarle a supervisar el rendimiento de saludo de la base de datos SQL en su nivel de rendimiento y de nivel de servicio específico .</span><span class="sxs-lookup"><span data-stu-id="9e77f-149">hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view in hello **master** database has additional information that can help you monitor hello performance of your SQL database at its specific service tier and performance level.</span></span> <span data-ttu-id="9e77f-150">datos de Hola se recopilan cada 5 minutos y se mantienen durante aproximadamente 35 días.</span><span class="sxs-lookup"><span data-stu-id="9e77f-150">hello data is collected every 5 minutes and is maintained for approximately 35 days.</span></span> <span data-ttu-id="9e77f-151">Esta vista es útil para realizar análisis históricos a largo plazo de cómo la base de datos SQL usa los recursos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-151">This view is useful for a longer-term historical analysis of how your SQL database uses resources.</span></span>

<span data-ttu-id="9e77f-152">Hello gráfico siguiente muestra hello uso de recursos de CPU para una base de datos Premium con hello nivel de rendimiento P2 durante cada hora de una semana.</span><span class="sxs-lookup"><span data-stu-id="9e77f-152">hello following graph shows hello CPU resource use for a Premium database with hello P2 performance level for each hour in a week.</span></span> <span data-ttu-id="9e77f-153">Este gráfico comienza en lunes, muestra los 5 días de trabajo y, a continuación, se muestra un fin de semana, cuando se produce mucho menor en la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="9e77f-153">This graph starts on a Monday, shows 5 work days, and then shows a weekend, when much less happens on hello application.</span></span>

![Uso de recursos de base de datos SQL](./media/sql-database-performance-guidance/sql_db_resource_utilization.png)

<span data-ttu-id="9e77f-155">Según los datos de hello, esta base de datos tiene actualmente una carga de CPU máxima de aproximadamente un 50 por ciento el uso de CPU nivel de rendimiento relativa toohello P2 (el mediodía del martes).</span><span class="sxs-lookup"><span data-stu-id="9e77f-155">From hello data, this database currently has a peak CPU load of just over 50 percent CPU use relative toohello P2 performance level (midday on Tuesday).</span></span> <span data-ttu-id="9e77f-156">Si la CPU es un factor dominante hello en perfil de recursos de la aplicación hello, podría decidir que P2 es Hola derecho tooguarantee de nivel de rendimiento que Hola cargas de trabajo siempre se ajusta.</span><span class="sxs-lookup"><span data-stu-id="9e77f-156">If CPU is hello dominant factor in hello application’s resource profile, then you might decide that P2 is hello right performance level tooguarantee that hello workload always fits.</span></span> <span data-ttu-id="9e77f-157">Si espera un toogrow de aplicación con el tiempo, es un toohave buena idea un búfer de recursos adicionales para que la aplicación hello alguna vez no alcanza el límite de nivel de rendimiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-157">If you expect an application toogrow over time, it's a good idea toohave an extra resource buffer so that hello application doesn't ever reach hello performance-level limit.</span></span> <span data-ttu-id="9e77f-158">Si se aumenta el nivel de rendimiento de hello, puede ayudar a evitar errores visibles para el cliente que pueden producirse cuando una base de datos no tiene suficiente solicitudes de tooprocess de alimentación de forma eficaz, especialmente en entornos sensibles a la latencia.</span><span class="sxs-lookup"><span data-stu-id="9e77f-158">If you increase hello performance level, you can help avoid customer-visible errors that might occur when a database doesn't have enough power tooprocess requests effectively, especially in latency-sensitive environments.</span></span> <span data-ttu-id="9e77f-159">Un ejemplo es una base de datos que admite una aplicación que dibuja páginas Web en función de los resultados de Hola de llamadas de base de datos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-159">An example is a database that supports an application that paints webpages based on hello results of database calls.</span></span>

<span data-ttu-id="9e77f-160">Otros tipos de aplicaciones podrían interpretar Hola mismo gráfico de manera diferente.</span><span class="sxs-lookup"><span data-stu-id="9e77f-160">Other application types might interpret hello same graph differently.</span></span> <span data-ttu-id="9e77f-161">Por ejemplo, si una aplicación trata los datos de nóminas tooprocess cada día y ha Hola mismo gráfico, este tipo de modelo de "proceso por lotes" podría funcionar bien en un nivel de rendimiento P1.</span><span class="sxs-lookup"><span data-stu-id="9e77f-161">For example, if an application tries tooprocess payroll data each day and has hello same chart, this kind of "batch job" model might do fine at a P1 performance level.</span></span> <span data-ttu-id="9e77f-162">Hola nivel de rendimiento P1 tiene 100 Dtu en comparación con too200 Dtu en hello nivel de rendimiento P2.</span><span class="sxs-lookup"><span data-stu-id="9e77f-162">hello P1 performance level has 100 DTUs compared too200 DTUs at hello P2 performance level.</span></span> <span data-ttu-id="9e77f-163">Hola nivel de rendimiento P1 proporciona un rendimiento Hola mitad del programa Hola a nivel de rendimiento P2.</span><span class="sxs-lookup"><span data-stu-id="9e77f-163">hello P1 performance level provides half hello performance of hello P2 performance level.</span></span> <span data-ttu-id="9e77f-164">Por lo tanto, el 50 por ciento de uso de CPU en P2 es igual al 100 por cien de uso de CPU en P1.</span><span class="sxs-lookup"><span data-stu-id="9e77f-164">So, 50 percent of CPU use in P2 equals 100 percent CPU use in P1.</span></span> <span data-ttu-id="9e77f-165">Si la aplicación hello no tiene los tiempos de espera, podría ser importante si un trabajo tarde 2 o 2,5 horas toofinish, si se complete hoy.</span><span class="sxs-lookup"><span data-stu-id="9e77f-165">If hello application does not have timeouts, it might not matter if a job takes 2 hours or 2.5 hours toofinish, if it gets done today.</span></span> <span data-ttu-id="9e77f-166">Una aplicación de esta categoría puede usar probablemente un nivel de rendimiento P1.</span><span class="sxs-lookup"><span data-stu-id="9e77f-166">An application in this category probably can use a P1 performance level.</span></span> <span data-ttu-id="9e77f-167">Puede aprovechar las ventajas del hecho de Hola que hay períodos de tiempo durante el día de hello cuando el uso de recursos es menor, por lo que cualquier "carga elevada" se puede retrasar a uno de esos momentos de hello más adelante en el día de Hola de.</span><span class="sxs-lookup"><span data-stu-id="9e77f-167">You can take advantage of hello fact that there are periods of time during hello day when resource use is lower, so that any "big peak" might spill over into one of hello troughs later in hello day.</span></span> <span data-ttu-id="9e77f-168">nivel de rendimiento P1 Hola podría ser más conveniente para ese tipo de aplicación (y ahorrar dinero), siempre y cuando los trabajos de hello pueden finalizar a tiempo cada día.</span><span class="sxs-lookup"><span data-stu-id="9e77f-168">hello P1 performance level might be good for that kind of application (and save money), as long as hello jobs can finish on time each day.</span></span>

<span data-ttu-id="9e77f-169">Expone de base de datos de SQL Azure consumidos información de recursos para cada base de datos activa en hello **sys.resource_stats** vista de hello **maestro** base de datos en cada servidor.</span><span class="sxs-lookup"><span data-stu-id="9e77f-169">Azure SQL Database exposes consumed resource information for each active database in hello **sys.resource_stats** view of hello **master** database in each server.</span></span> <span data-ttu-id="9e77f-170">datos de Hello en la tabla de Hola se agregan a intervalos de 5 minutos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-170">hello data in hello table is aggregated for 5-minute intervals.</span></span> <span data-ttu-id="9e77f-171">Con los niveles de servicio Basic, Standard y Premium hello, Hola datos pueden tardar más de 5 minutos tooappear en la tabla de hello, por lo que estos datos son más útiles para análisis históricos en lugar de análisis en tiempo casi real.</span><span class="sxs-lookup"><span data-stu-id="9e77f-171">With hello Basic, Standard, and Premium service tiers, hello data can take more than 5 minutes tooappear in hello table, so this data is more useful for historical analysis rather than near-real-time analysis.</span></span> <span data-ttu-id="9e77f-172">Hola de consulta **sys.resource_stats** vista toosee Hola historial reciente de una base de datos y toovalidate si reserva Hola eligió entrega rendimiento de Hola que desea cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="9e77f-172">Query hello **sys.resource_stats** view toosee hello recent history of a database and toovalidate whether hello reservation you chose delivered hello performance you want when needed.</span></span>

> [!NOTE]
> <span data-ttu-id="9e77f-173">Debe ser conectado toohello **maestro** base de datos de la lógica tooquery de servidor de base de datos SQL **sys.resource_stats** en hello en los ejemplos siguientes.</span><span class="sxs-lookup"><span data-stu-id="9e77f-173">You must be connected toohello **master** database of your logical SQL database server tooquery **sys.resource_stats** in hello following examples.</span></span>
> 
> 

<span data-ttu-id="9e77f-174">Este ejemplo muestra cómo se exponen los datos hello en esta vista:</span><span class="sxs-lookup"><span data-stu-id="9e77f-174">This example shows you how hello data in this view is exposed:</span></span>

    SELECT TOP 10 *
    FROM sys.resource_stats
    WHERE database_name = 'resource1'
    ORDER BY start_time DESC

![vista de catálogo sys.resource_stats Hola](./media/sql-database-performance-guidance/sys_resource_stats.png)

<span data-ttu-id="9e77f-176">Hello en el ejemplo siguiente se muestra distintas formas que puede usar hello **sys.resource_stats** tooget de ver información acerca de cómo la base de datos SQL usa los recursos de catálogo:</span><span class="sxs-lookup"><span data-stu-id="9e77f-176">hello next example shows you different ways that you can use hello **sys.resource_stats** catalog view tooget information about how your SQL database uses resources:</span></span>

1. <span data-ttu-id="9e77f-177">toolook en hello más allá de los recursos de la semana utilice para hello userdb1 de base de datos, puede ejecutar esta consulta:</span><span class="sxs-lookup"><span data-stu-id="9e77f-177">toolook at hello past week’s resource use for hello database userdb1, you can run this query:</span></span>
   
        SELECT *
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND
              start_time > DATEADD(day, -7, GETDATE())
        ORDER BY start_time DESC;
2. <span data-ttu-id="9e77f-178">tooevaluate la medida de la carga de trabajo se ajuste a nivel de rendimiento de hello, necesita toodrill hacia abajo en todos los aspectos de métricas de recursos de hello: CPU, lecturas, escrituras, número de trabajadores y número de sesiones.</span><span class="sxs-lookup"><span data-stu-id="9e77f-178">tooevaluate how well your workload fits hello performance level, you need toodrill down into each aspect of hello resource metrics: CPU, reads, writes, number of workers, and number of sessions.</span></span> <span data-ttu-id="9e77f-179">Aquí es revisada consultar mediante **sys.resource_stats** tooreport Hola valores promedio y máximos de estas métricas de recursos:</span><span class="sxs-lookup"><span data-stu-id="9e77f-179">Here's a revised query using **sys.resource_stats** tooreport hello average and maximum values of these resource metrics:</span></span>
   
        SELECT
            avg(avg_cpu_percent) AS 'Average CPU use in percent',
            max(avg_cpu_percent) AS 'Maximum CPU use in percent',
            avg(avg_data_io_percent) AS 'Average physical data I/O use in percent',
            max(avg_data_io_percent) AS 'Maximum physical data I/O use in percent',
            avg(avg_log_write_percent) AS 'Average log write use in percent',
            max(avg_log_write_percent) AS 'Maximum log write use in percent',
            avg(max_session_percent) AS 'Average % of sessions',
            max(max_session_percent) AS 'Maximum % of sessions',
            avg(max_worker_percent) AS 'Average % of workers',
            max(max_worker_percent) AS 'Maximum % of workers'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
3. <span data-ttu-id="9e77f-180">Con esta información acerca de los valores de hello promedio y máximo de cada métrica de recurso, se puede evaluar cómo bien la carga de trabajo se ajusta al nivel de rendimiento de Hola que eligió.</span><span class="sxs-lookup"><span data-stu-id="9e77f-180">With this information about hello average and maximum values of each resource metric, you can assess how well your workload fits into hello performance level you chose.</span></span> <span data-ttu-id="9e77f-181">Normalmente, los valores promedio de **sys.resource_stats** ofrecerle una toouse buena línea base con tamaño de destino de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-181">Usually, average values from **sys.resource_stats** give you a good baseline toouse against hello target size.</span></span> <span data-ttu-id="9e77f-182">Debería ser su vara de medida principal.</span><span class="sxs-lookup"><span data-stu-id="9e77f-182">It should be your primary measurement stick.</span></span> <span data-ttu-id="9e77f-183">Para obtener un ejemplo, puede que esté usando capa de servicio estándar Hola con nivel de rendimiento de S2.</span><span class="sxs-lookup"><span data-stu-id="9e77f-183">For an example, you might be using hello Standard service tier with S2 performance level.</span></span> <span data-ttu-id="9e77f-184">promedio de Hello utilizar los porcentajes para las lecturas de E/S y CPU y escrituras están por debajo de 40 por ciento, promedio de Hola de trabajadores está por debajo de 50 y Hola cantidad promedio de sesiones es menor que 200.</span><span class="sxs-lookup"><span data-stu-id="9e77f-184">hello average use percentages for CPU and I/O reads and writes are below 40 percent, hello average number of workers is below 50, and hello average number of sessions is below 200.</span></span> <span data-ttu-id="9e77f-185">La carga de trabajo podría ajustarse en hello nivel de rendimiento S1.</span><span class="sxs-lookup"><span data-stu-id="9e77f-185">Your workload might fit into hello S1 performance level.</span></span> <span data-ttu-id="9e77f-186">Es fácil toosee si la base de datos se ajusta a trabajo hello y límites de la sesión.</span><span class="sxs-lookup"><span data-stu-id="9e77f-186">It's easy toosee whether your database fits in hello worker and session limits.</span></span> <span data-ttu-id="9e77f-187">toosee si una base de datos se ajusta a un nivel de rendimiento inferior con lo que respecta a tooCPU, lecturas y escrituras, divida el número DTU de Hola de nivel de rendimiento inferior Hola por número de DTU del nivel de rendimiento actual de hello y, a continuación, multiplique el resultado de hello por 100:</span><span class="sxs-lookup"><span data-stu-id="9e77f-187">toosee whether a database fits into a lower performance level with regards tooCPU, reads, and writes, divide hello DTU number of hello lower performance level by hello DTU number of your current performance level, and then multiply hello result by 100:</span></span>
   
    <span data-ttu-id="9e77f-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span><span class="sxs-lookup"><span data-stu-id="9e77f-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span></span>
   
    <span data-ttu-id="9e77f-189">resultado de Hello es la diferencia de rendimiento relativo de hello entre dos niveles de rendimiento hello en porcentaje.</span><span class="sxs-lookup"><span data-stu-id="9e77f-189">hello result is hello relative performance difference between hello two performance levels in percentage.</span></span> <span data-ttu-id="9e77f-190">Si el uso de recursos no supera esta cantidad, la carga de trabajo podría ajustarse en el nivel de rendimiento inferior Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-190">If your resource use doesn't exceed this amount, your workload might fit into hello lower performance level.</span></span> <span data-ttu-id="9e77f-191">Sin embargo, es necesario toolook todos los intervalos de valores de uso de recursos y determinar, por porcentaje, la frecuencia con la carga de trabajo de la base de datos se ajustaría al nivel de rendimiento inferior Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-191">However, you need toolook at all ranges of resource use values, and determine, by percentage, how often your database workload would fit into hello lower performance level.</span></span> <span data-ttu-id="9e77f-192">Hello siguiente consulta expresa Hola ajustarse porcentaje por dimensión de recursos, en función de umbral de Hola de 40 por ciento que se calcula en este ejemplo:</span><span class="sxs-lookup"><span data-stu-id="9e77f-192">hello following query outputs hello fit percentage per resource dimension, based on hello threshold of 40 percent that we calculated in this example:</span></span>
   
        SELECT
            (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log Write Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical Data IO Fit Percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="9e77f-193">En función de su objetivo de nivel de servicio (SLO) de base de datos, puede decidir si la carga de trabajo se adapta a nivel de rendimiento inferior Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-193">Based on your database service level objective (SLO), you can decide whether your workload fits into hello lower performance level.</span></span> <span data-ttu-id="9e77f-194">Si la carga de trabajo de base de datos SLO es de 99,9% y hello consulta anterior devuelve valores mayores que 99,9% para todas las tres dimensiones de recursos, la carga de trabajo es probable que se ajusta al nivel de rendimiento inferior Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-194">If your database workload SLO is 99.9 percent and hello preceding query returns values greater than 99.9 percent for all three resource dimensions, your workload likely fits into hello lower performance level.</span></span>
   
    <span data-ttu-id="9e77f-195">Examinando el porcentaje de hello ajustar también ofrece una visión general de si debe mover los toohello siguiente superior toomeet de nivel de rendimiento su SLO.</span><span class="sxs-lookup"><span data-stu-id="9e77f-195">Looking at hello fit percentage also gives you insight into whether you should move toohello next higher performance level toomeet your SLO.</span></span> <span data-ttu-id="9e77f-196">Por ejemplo, userdb1 muestra hello consecuencia del uso de CPU para hello semana anterior:</span><span class="sxs-lookup"><span data-stu-id="9e77f-196">For example, userdb1 shows hello following CPU use for hello past week:</span></span>
   
   | <span data-ttu-id="9e77f-197">Porcentaje medio de CPU</span><span class="sxs-lookup"><span data-stu-id="9e77f-197">Average CPU percent</span></span> | <span data-ttu-id="9e77f-198">Porcentaje máximo de CPU</span><span class="sxs-lookup"><span data-stu-id="9e77f-198">Maximum CPU percent</span></span> |
   | --- | --- |
   | <span data-ttu-id="9e77f-199">24,5</span><span class="sxs-lookup"><span data-stu-id="9e77f-199">24.5</span></span> |<span data-ttu-id="9e77f-200">100,00</span><span class="sxs-lookup"><span data-stu-id="9e77f-200">100.00</span></span> |
   
    <span data-ttu-id="9e77f-201">Hola promedio de CPU es aproximadamente un cuarto del límite de Hola de nivel de rendimiento de hello, lo que se ajustaría bien en el nivel de rendimiento de Hola de base de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-201">hello average CPU is about a quarter of hello limit of hello performance level, which would fit well into hello performance level of hello database.</span></span> <span data-ttu-id="9e77f-202">Sin embargo, valor máximo de hello muestra que esa base de datos de hello alcanza el límite de Hola de nivel de rendimiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-202">But, hello maximum value shows that hello database reaches hello limit of hello performance level.</span></span> <span data-ttu-id="9e77f-203">¿Necesita toomove toohello siguiente nivel de rendimiento superior?</span><span class="sxs-lookup"><span data-stu-id="9e77f-203">Do you need toomove toohello next higher performance level?</span></span> <span data-ttu-id="9e77f-204">Observar cómo muchas veces la carga de trabajo alcanza el 100 por ciento y, a continuación, comparar cargas de trabajo de base de datos de tooyour SLO.</span><span class="sxs-lookup"><span data-stu-id="9e77f-204">Look at how many times your workload reaches 100 percent, and then compare it tooyour database workload SLO.</span></span>
   
        SELECT
        (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log write fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical data I/O fit percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="9e77f-205">Si esta consulta devuelve un valor menor que 99,9 por ciento para cualquiera de las dimensiones de recursos de hello tres, considere la posibilidad de cualquier móvil toohello siguiente nivel de rendimiento superior o use carga hello tooreduce técnicas de optimización de aplicaciones en la base de datos SQL de Hola.</span><span class="sxs-lookup"><span data-stu-id="9e77f-205">If this query returns a value less than 99.9 percent for any of hello three resource dimensions, consider either moving toohello next higher performance level or use application-tuning techniques tooreduce hello load on hello SQL database.</span></span>
4. <span data-ttu-id="9e77f-206">Este ejercicio también tiene en cuenta el aumento de carga de trabajo prevista en hello futuras.</span><span class="sxs-lookup"><span data-stu-id="9e77f-206">This exercise also considers your projected workload increase in hello future.</span></span>

<span data-ttu-id="9e77f-207">Para los grupos elásticos, puede supervisar las bases de datos individuales en el grupo de hello con técnicas de hello descritas en esta sección.</span><span class="sxs-lookup"><span data-stu-id="9e77f-207">For elastic pools, you can monitor individual databases in hello pool with hello techniques described in this section.</span></span> <span data-ttu-id="9e77f-208">Pero también puede supervisar el grupo de Hola como un todo.</span><span class="sxs-lookup"><span data-stu-id="9e77f-208">But you can also monitor hello pool as a whole.</span></span> <span data-ttu-id="9e77f-209">Para más información, consulte el artículo sobre la [supervisión y administración de un grupo de bases de datos elásticas](sql-database-elastic-pool-manage-portal.md).</span><span class="sxs-lookup"><span data-stu-id="9e77f-209">For information, see [Monitor and manage an elastic pool](sql-database-elastic-pool-manage-portal.md).</span></span>


### <a name="maximum-concurrent-requests"></a><span data-ttu-id="9e77f-210">Número máximo de solicitudes simultáneas</span><span class="sxs-lookup"><span data-stu-id="9e77f-210">Maximum concurrent requests</span></span>
<span data-ttu-id="9e77f-211">número de hello toosee de solicitudes simultáneas, ejecute esta consulta de Transact-SQL en la base de datos SQL:</span><span class="sxs-lookup"><span data-stu-id="9e77f-211">toosee hello number of concurrent requests, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R

<span data-ttu-id="9e77f-212">carga de trabajo de tooanalyze Hola de una base de datos de SQL Server local, modifique este toofilter de consulta en la base de datos específica de hello desea tooanalyze.</span><span class="sxs-lookup"><span data-stu-id="9e77f-212">tooanalyze hello workload of an on-premises SQL Server database, modify this query toofilter on hello specific database you want tooanalyze.</span></span> <span data-ttu-id="9e77f-213">Por ejemplo, si tiene una base de datos local denominado MyDatabase, esta consulta de Transact-SQL devuelve el recuento de Hola de solicitudes simultáneas en esa base de datos:</span><span class="sxs-lookup"><span data-stu-id="9e77f-213">For example, if you have an on-premises database named MyDatabase, this Transact-SQL query returns hello count of concurrent requests in that database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R
    INNER JOIN sys.databases D ON D.database_id = R.database_id
    AND D.name = 'MyDatabase'

<span data-ttu-id="9e77f-214">Se trata simplemente de una instantánea en un solo momento dado.</span><span class="sxs-lookup"><span data-stu-id="9e77f-214">This is just a snapshot at a single point in time.</span></span> <span data-ttu-id="9e77f-215">tooget una mejor comprensión de la carga de trabajo y los requisitos de solicitudes simultáneas, necesitará toocollect número de muestras con el tiempo.</span><span class="sxs-lookup"><span data-stu-id="9e77f-215">tooget a better understanding of your workload and concurrent request requirements, you'll need toocollect many samples over time.</span></span>

### <a name="maximum-concurrent-logins"></a><span data-ttu-id="9e77f-216">Número máximo de inicios de sesión simultáneos</span><span class="sxs-lookup"><span data-stu-id="9e77f-216">Maximum concurrent logins</span></span>
<span data-ttu-id="9e77f-217">Puede analizar el tooget de patrones una idea de frecuencia de Hola de inicios de sesión de usuario y la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9e77f-217">You can analyze your user and application patterns tooget an idea of hello frequency of logins.</span></span> <span data-ttu-id="9e77f-218">También puede ejecutar las cargas reales en un toomake de entorno de prueba seguro de que no tiene este u otros límites que se explican en este artículo.</span><span class="sxs-lookup"><span data-stu-id="9e77f-218">You also can run real-world loads in a test environment toomake sure that you're not hitting this or other limits we discuss in this article.</span></span> <span data-ttu-id="9e77f-219">No hay una única consulta o vista de administración dinámica (DMV) que pueda mostrar el número o el historial de inicios de sesión simultáneos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-219">There isn’t a single query or dynamic management view (DMV) that can show you concurrent login counts or history.</span></span>

<span data-ttu-id="9e77f-220">Si usan varios clientes Hola misma cadena de conexión, hello servicio autentica cada inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="9e77f-220">If multiple clients use hello same connection string, hello service authenticates each login.</span></span> <span data-ttu-id="9e77f-221">Si 10 usuarios se conecten simultáneamente tooa base de datos mediante el uso de Hola el mismo nombre de usuario y contraseña, sería 10 inicios de sesión simultáneos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-221">If 10 users simultaneously connect tooa database by using hello same username and password, there would be 10 concurrent logins.</span></span> <span data-ttu-id="9e77f-222">Este límite aplica solo toohello duración del inicio de sesión de Hola y la autenticación.</span><span class="sxs-lookup"><span data-stu-id="9e77f-222">This limit applies only toohello duration of hello login and authentication.</span></span> <span data-ttu-id="9e77f-223">Si los usuarios de hello 10 mismo conectan secuencialmente toohello base de datos, número de Hola de inicios de sesión simultáneos nunca sería mayor que 1.</span><span class="sxs-lookup"><span data-stu-id="9e77f-223">If hello same 10 users connect toohello database sequentially, hello number of concurrent logins would never be greater than 1.</span></span>

> [!NOTE]
> <span data-ttu-id="9e77f-224">Actualmente, este límite no aplica toodatabases en grupos elásticos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-224">Currently, this limit does not apply toodatabases in elastic pools.</span></span>
> 
> 

### <a name="maximum-sessions"></a><span data-ttu-id="9e77f-225">Número máximo de sesiones</span><span class="sxs-lookup"><span data-stu-id="9e77f-225">Maximum sessions</span></span>
<span data-ttu-id="9e77f-226">número de hello toosee de sesiones activas actuales, ejecute esta consulta de Transact-SQL en la base de datos SQL:</span><span class="sxs-lookup"><span data-stu-id="9e77f-226">toosee hello number of current active sessions, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Sessions]
    FROM sys.dm_exec_connections

<span data-ttu-id="9e77f-227">Si está analizando una carga de trabajo de SQL Server local, modifique hello toofocus de consulta en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="9e77f-227">If you're analyzing an on-premises SQL Server workload, modify hello query toofocus on a specific database.</span></span> <span data-ttu-id="9e77f-228">Esta consulta le ayuda a determinar las necesidades de sesión posibles para la base de datos de hello si se va a mover tooAzure base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="9e77f-228">This query helps you determine possible session needs for hello database if you are considering moving it tooAzure SQL Database.</span></span>

    SELECT COUNT(*)  AS [Sessions]
    FROM sys.dm_exec_connections C
    INNER JOIN sys.dm_exec_sessions S ON (S.session_id = C.session_id)
    INNER JOIN sys.databases D ON (D.database_id = S.database_id)
    WHERE D.name = 'MyDatabase'

<span data-ttu-id="9e77f-229">Nuevamente, estas consultas devuelven un número puntual.</span><span class="sxs-lookup"><span data-stu-id="9e77f-229">Again, these queries return a point-in-time count.</span></span> <span data-ttu-id="9e77f-230">Si recopila varias muestras con el tiempo, tendrá usar mejor comprensión de saludo de la sesión.</span><span class="sxs-lookup"><span data-stu-id="9e77f-230">If you collect multiple samples over time, you’ll have hello best understanding of your session use.</span></span>

<span data-ttu-id="9e77f-231">Para el análisis de la base de datos SQL, puede obtener estadísticas históricas en las sesiones consultando hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) vista y revisar hello **active_session_count** columna.</span><span class="sxs-lookup"><span data-stu-id="9e77f-231">For SQL Database analysis, you can get historical statistics on sessions by querying hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view and reviewing hello **active_session_count** column.</span></span> 
