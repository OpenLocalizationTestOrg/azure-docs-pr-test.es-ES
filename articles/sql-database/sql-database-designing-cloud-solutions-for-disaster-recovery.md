---
title: servicio de alta disponibilidad aaaDesign con la base de datos de SQL de Azure | Documentos de Microsoft
description: "Obtenga información sobre el diseño de aplicaciones para servicios de alta disponibilidad con Azure SQL Database."
keywords: "recuperación ante desastres en la nube, soluciones de recuperación ante desastres, copia de seguridad de datos de aplicación, planificación de continuidad del negocio"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 815f754ba7014cd8a1108a2d84c2a8f71d7030a5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a><span data-ttu-id="fd6da-104">Diseño de servicios de alta disponibilidad con Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="fd6da-104">Designing highly available services using Azure SQL Database</span></span>

<span data-ttu-id="fd6da-105">Al compilar e implementar servicios de alta disponibilidad en la base de datos de SQL Azure, use [conmutación por error de grupos y la replicación geográfica activa](sql-database-geo-replication-overview.md) tooregional errores de tooprovide resistencia e interrupciones graves y habilitar recuperación rápida toohello bases de datos secundarias.</span><span class="sxs-lookup"><span data-stu-id="fd6da-105">When building and deploying highly available services on Azure SQL Database, you use [failover groups and active geo-replication](sql-database-geo-replication-overview.md) tooprovide resilience tooregional failures and catastrophic outages and enable fast recovery toohello secondary databases.</span></span> <span data-ttu-id="fd6da-106">En este artículo se centra en los patrones de aplicación comunes y se describen las ventajas de Hola y ventajas y desventajas de cada opción según los requisitos de la implementación de la aplicación hello, los acuerdo de nivel de servicio de hello tiene como destino, la latencia de tráfico y los costos.</span><span class="sxs-lookup"><span data-stu-id="fd6da-106">This article focuses on common application patterns and discusses hello benefits and trade-offs of each option depending on hello application deployment requirements, hello service level agreement you are targeting, traffic latency, and costs.</span></span> <span data-ttu-id="fd6da-107">Para saber cómo utilizar la replicación geográfica activa con los grupos elásticos, consulte [Estrategias de recuperación ante desastres para aplicaciones que usan el grupo elástico de Base de datos SQL](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="fd6da-107">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a><span data-ttu-id="fd6da-108">Patrón de diseño 1: implementación activa-pasiva para la recuperación ante desastres en la nube con una base de datos colocada</span><span class="sxs-lookup"><span data-stu-id="fd6da-108">Design pattern 1: Active-passive deployment for cloud disaster recovery with a co-located database</span></span>
<span data-ttu-id="fd6da-109">Esta opción es ideal para las aplicaciones con hello siguientes características:</span><span class="sxs-lookup"><span data-stu-id="fd6da-109">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="fd6da-110">Instancia activa de una única región de Azure.</span><span class="sxs-lookup"><span data-stu-id="fd6da-110">Active instance in a single Azure region</span></span>
* <span data-ttu-id="fd6da-111">Dependencia fuerte en toodata de acceso de lectura y escritura (RW)</span><span class="sxs-lookup"><span data-stu-id="fd6da-111">Strong dependency on read-write (RW) access toodata</span></span>
* <span data-ttu-id="fd6da-112">No es aceptable debido costo toolatency y el tráfico entre regiones conectividad entre la aplicación web de Hola y de base de datos de Hola</span><span class="sxs-lookup"><span data-stu-id="fd6da-112">Cross-region connectivity between hello web application and hello database is not acceptable due toolatency and traffic cost</span></span>    

<span data-ttu-id="fd6da-113">En este caso, la topología de implementación de aplicación Hola está optimizada para administrar desastres regionales cuando todos los componentes de la aplicación están teniendo problemas y necesitan toofailover como una unidad.</span><span class="sxs-lookup"><span data-stu-id="fd6da-113">In this case, hello application deployment topology is optimized for handling regional disasters when all application components are impacted and need toofailover as a unit.</span></span> <span data-ttu-id="fd6da-114">Para la redundancia geográfica, base de datos de Hola y lógica de la aplicación hello son tooanother replicada región pero no se usan para la carga de trabajo de aplicación de hello en condiciones normales de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-114">For geographic redundancy, hello application logic and hello database are replicated tooanother region but they are not used for hello application workload under hello normal conditions.</span></span> <span data-ttu-id="fd6da-115">aplicación de Hello en la región secundaria Hola debería ser toouse configurado SQL conexión cadena toohello base de datos secundaria.</span><span class="sxs-lookup"><span data-stu-id="fd6da-115">hello application in hello secondary region should be configured toouse a SQL connection string toohello secondary database.</span></span> <span data-ttu-id="fd6da-116">El Administrador de tráfico está configurado toouse [método de enrutamiento de conmutación por error](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="fd6da-116">Traffic manager is set up toouse [failover routing method](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="fd6da-117">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) se usa en este artículo únicamente con fines ilustrativos.</span><span class="sxs-lookup"><span data-stu-id="fd6da-117">[Azure traffic manager](../traffic-manager/traffic-manager-overview.md) is used throughout this article for illustration purposes only.</span></span> <span data-ttu-id="fd6da-118">Puede usar cualquier solución de equilibrio de carga que admita el método de enrutamiento de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="fd6da-118">You can use any load-balancing solution that supports failover routing method.</span></span>    
>

<span data-ttu-id="fd6da-119">Hola siguiente diagrama ilustra esta configuración antes de una interrupción.</span><span class="sxs-lookup"><span data-stu-id="fd6da-119">hello following diagram shows this configuration before an outage.</span></span>

![Configuración de replicación geográfica de SQL Database.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

<span data-ttu-id="fd6da-122">Después de una interrupción en la región principal de hello, servicio de base de datos SQL de hello detecta esa base de datos principal de hello no es accesible y desencadenar una conmutación por error toohello base de datos secundaria según los parámetros de Hola de directiva de conmutación por error automática de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-122">After an outage in hello primary region, hello SQL Database service detects that hello primary database is not accessible and trigger a failover toohello secondary database based on hello parameters of hello automatic failover policy.</span></span> <span data-ttu-id="fd6da-123">Dependiendo de su SLA de la aplicación, puede decidir tooconfigure un período de gracia entre la detección de Hola de interrupción de Hola y conmutación por error de hello propio.</span><span class="sxs-lookup"><span data-stu-id="fd6da-123">Depending on your application SLA, you can decide tooconfigure a grace period between hello detection of hello outage and hello failover itself.</span></span> <span data-ttu-id="fd6da-124">Configuración de un período de gracia reduce el riesgo de Hola de casos de toohello de pérdida de datos donde interrupción hello es grave y disponibilidad en la región de hello no se puede restaurar rápidamente.</span><span class="sxs-lookup"><span data-stu-id="fd6da-124">Configuring a grace period reduces hello risk of data loss toohello cases where hello outage is catastrophic and availability in hello region cannot be quickly restored.</span></span> <span data-ttu-id="fd6da-125">Si conmutación por error de punto de conexión de Hola se inicia mediante el Administrador de tráfico Hola antes de desencadenadores de grupo de conmutación por error de Hola Hola conmutación por error de base de datos de hello, aplicación web de hello no es base de datos pueda tooreconnect toohello.</span><span class="sxs-lookup"><span data-stu-id="fd6da-125">If hello endpoint failover is initiated by hello traffic manager before hello failover group triggers hello failover of hello database, hello web application is not able tooreconnect toohello database.</span></span> <span data-ttu-id="fd6da-126">tooreconnect de intento de la aplicación Hello supera automáticamente tan pronto como finaliza la conmutación por error de base de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-126">hello application’s attempt tooreconnect automatically succeeds as soon as hello database failover completes.</span></span> 

> [!NOTE]
> <span data-ttu-id="fd6da-127">tooachieve totalmente había coordinada conmutación por error de la aplicación hello y bases de datos de hello, debe diseñar su propio método de supervisión y usar la conmutación por error manual de los extremos de la aplicación hello web y bases de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-127">tooachieve fully coordinated failover of hello application and hello databases, you should devise your own monitoring method and use manual failover of hello web application endpoints and hello databases.</span></span>
>

<span data-ttu-id="fd6da-128">Una vez completada la conmutación por error de saludo de la aplicación hello extremos y base de datos de hello, aplicación hello iniciará volver a procesar las solicitudes de usuario de hello en la región de hello B y permanecerá coexisten con base de datos de hello porque la base de datos principal de hello ahora está en región de B. Este escenario se muestra en hello siguiente diagrama.</span><span class="sxs-lookup"><span data-stu-id="fd6da-128">After hello failover of both hello application’s endpoints and hello database completes, hello application will re-start processing hello user requests in hello region B and will remain co-located with hello database because hello primary database is now in region B. This scenario is illustrated in hello following diagram.</span></span> <span data-ttu-id="fd6da-129">En todos los diagramas, las líneas continuas indican conexiones activas, las líneas de puntos indican conexiones suspendidas y las señales de detención indican desencadenadores de acción.</span><span class="sxs-lookup"><span data-stu-id="fd6da-129">In all diagrams, solid lines indicate active connections, dotted lines indicate suspended connections, and stop signs indicate action triggers.</span></span>

![Replicación geográfica: Base de datos conmutación por error toosecondary.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

<span data-ttu-id="fd6da-132">Si se produce una interrupción en la región secundaria de hello, se suspende Hola vínculo de replicación entre Hola principal y la base de datos secundaria de hello pero Hola conmutación por error no se desencadena porque no se ve afectada la base de datos principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-132">If an outage happens in hello secondary region, hello replication link between hello primary and hello secondary database is suspended but hello failover is not triggered because hello primary database is not impacted.</span></span> <span data-ttu-id="fd6da-133">no se cambia en este caso, la disponibilidad de la aplicación Hello pero aplicación hello funciona expuesto y, por tanto, en un riesgo más alto en el caso de ambas regiones producirá un error en sucesión.</span><span class="sxs-lookup"><span data-stu-id="fd6da-133">hello application's availability is not changed in this case, but hello application operates exposed and therefore at higher risk in case both regions fail in succession.</span></span>

> [!NOTE]
> <span data-ttu-id="fd6da-134">Recuperación ante desastres se recomienda la configuración de hello con regiones de tootwo limitado de implementación de aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd6da-134">For disaster recovery we recommend hello configuration with application deployment limited tootwo regions.</span></span> <span data-ttu-id="fd6da-135">Se trata porque la mayoría de hello regiones geográficas de Azure tienen solo dos regiones.</span><span class="sxs-lookup"><span data-stu-id="fd6da-135">This is because most of hello Azure geographies have only two regions.</span></span> <span data-ttu-id="fd6da-136">Esta configuración no protegerá la aplicación de un error grave simultáneo de ambas regiones.</span><span class="sxs-lookup"><span data-stu-id="fd6da-136">This configuration will not protect your application from a simultaneous catastrophic failure of both regions.</span></span>  <span data-ttu-id="fd6da-137">En el caso poco probable de que este error se produjese, podría recuperar sus bases de datos en una tercera región mediante una [operación de restauración geográfica](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="fd6da-137">In an unlikely event of such a failure, you can recover your databases in a third region using [geo-restore operation](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span>
>

<span data-ttu-id="fd6da-138">Una vez que se mitiga interrupción hello, base de datos secundaria de hello volver a sincronizará automáticamente con hello principal.</span><span class="sxs-lookup"><span data-stu-id="fd6da-138">Once hello outage is mitigated, hello secondary database will automatically re-synchronize with hello primary.</span></span> <span data-ttu-id="fd6da-139">Durante la sincronización, rendimiento de hello principal podría verse afectada ligeramente según cantidad Hola de datos que necesita toobe sincronizado.</span><span class="sxs-lookup"><span data-stu-id="fd6da-139">During synchronization, performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="fd6da-140">Hello diagrama siguiente ilustra una interrupción en la región secundaria Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-140">hello following diagram illustrates an outage in hello secondary region.</span></span>

![Base de datos secundaria sincronizada con la primaria.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

<span data-ttu-id="fd6da-143">clave de Hello **ventajas** de este patrón de diseño son:</span><span class="sxs-lookup"><span data-stu-id="fd6da-143">hello key **advantages** of this design pattern are:</span></span>

* <span data-ttu-id="fd6da-144">Hola misma aplicación web es regiones tooboth implementado sin ninguna configuración específica de la región y sin conmutación por error de lógica adicional tooreact toohello.</span><span class="sxs-lookup"><span data-stu-id="fd6da-144">hello same web application is deployed tooboth regions without any region-specific configuration and no additional logic tooreact toohello failover.</span></span> 
* <span data-ttu-id="fd6da-145">rendimiento de la aplicación Hello no se ve afectado por la conmutación por error como aplicación web de Hola y base de datos de hello siempre se ubican conjuntamente.</span><span class="sxs-lookup"><span data-stu-id="fd6da-145">hello application's performance is not impacted by failover as hello web application and hello database are always co-located.</span></span>

<span data-ttu-id="fd6da-146">Hola principal **contrapartida** es que aplicación de redundancia de hello instancia en la región secundaria Hola solo se utiliza para la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="fd6da-146">hello main **tradeoff** is that hello redundant application instance in hello secondary region is only used for disaster recovery.</span></span>

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a><span data-ttu-id="fd6da-147">Patrón de diseño 2: implementación activa-activa para el equilibrio de carga de aplicación</span><span class="sxs-lookup"><span data-stu-id="fd6da-147">Design pattern 2: Active-active deployment for application load balancing</span></span>
<span data-ttu-id="fd6da-148">Esta opción de recuperación ante desastres en la nube es ideal en las aplicaciones con hello siguientes características:</span><span class="sxs-lookup"><span data-stu-id="fd6da-148">This cloud disaster recovery option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="fd6da-149">Proporción alta de base de datos lee toowrites</span><span class="sxs-lookup"><span data-stu-id="fd6da-149">High ratio of database reads toowrites</span></span>
* <span data-ttu-id="fd6da-150">Base de datos de latencia de lectura es más importante para la experiencia del usuario final de Hola que la latencia de escritura Hola</span><span class="sxs-lookup"><span data-stu-id="fd6da-150">Database read latency is more critical for hello end-user experience than hello write latency</span></span> 
* <span data-ttu-id="fd6da-151">La lógica de solo lectura se puede separar de la lógica de lectura y escritura mediante el uso de una cadena de conexión distinta.</span><span class="sxs-lookup"><span data-stu-id="fd6da-151">Read-only logic can be separated from read-write logic by using a different connection string</span></span>
* <span data-ttu-id="fd6da-152">Lógica de solo lectura no dependen de datos completa que se sincronizan con las últimas actualizaciones de Hola</span><span class="sxs-lookup"><span data-stu-id="fd6da-152">Read-only logic does not depend on data being fully synchronized with hello latest updates</span></span>  

<span data-ttu-id="fd6da-153">Si las aplicaciones tienen estas características, puede mejorar sustancialmente el equilibrio de carga las conexiones de usuario final de hello entre varias instancias de aplicación en diferentes regiones Hola general experiencia del usuario final.</span><span class="sxs-lookup"><span data-stu-id="fd6da-153">If your applications have these characteristics, load balancing hello end-user connections across multiple application instances in different regions can substantially improve hello overall end-user experience.</span></span> <span data-ttu-id="fd6da-154">Dos de las regiones de hello deben seleccionarse como Hola par de recuperación ante desastres y grupo de conmutación por error de hello debe incluir las bases de datos de hello en estas regiones.</span><span class="sxs-lookup"><span data-stu-id="fd6da-154">Two of hello regions should be selected as hello DR pair and hello failover group should include hello databases in these regions.</span></span> <span data-ttu-id="fd6da-155">tooimplement equilibrio de carga, cada región debe tener una instancia activa de la aplicación hello con hello lectura y escritura (RW) lógica conectada toohello agente de escucha de lectura y escritura punto de conexión del grupo de conmutación por error de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-155">tooimplement load-balancing, each region should have an active instance of hello application with hello read-write (RW) logic connected toohello read-write listener endpoint of hello failover group.</span></span> <span data-ttu-id="fd6da-156">Se garantizará que Hola de conmutación por error se iniciará automáticamente si la base de datos principal de Hola se ve afectado por una interrupción del servicio.</span><span class="sxs-lookup"><span data-stu-id="fd6da-156">It will guarantee that hello failover will be automatically initiated if hello primary database is impacted by an outage.</span></span> <span data-ttu-id="fd6da-157">Hola de solo lectura lógica (RO) en la aplicación web de hello debe conectarse directamente toohello base de datos en dicha región.</span><span class="sxs-lookup"><span data-stu-id="fd6da-157">hello read-only logic (RO) in hello web application should connect directly toohello database in that region.</span></span> <span data-ttu-id="fd6da-158">El Administrador de tráfico se debe configurar toouse [rendimiento enrutamiento](../traffic-manager/traffic-manager-configure-performance-routing-method.md) con [supervisión de extremo](../traffic-manager/traffic-manager-monitoring.md) habilitado para cada instancia de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd6da-158">Traffic manager should be set up toouse [performance routing](../traffic-manager/traffic-manager-configure-performance-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for each application instance.</span></span>

<span data-ttu-id="fd6da-159">Como en el patrón nº 1, debe considerar la posibilidad de implementar una aplicación de supervisión similar.</span><span class="sxs-lookup"><span data-stu-id="fd6da-159">As in pattern #1, you should consider deploying a similar monitoring application.</span></span> <span data-ttu-id="fd6da-160">Pero a diferencia de patrón #1, Hola supervisión de la aplicación no será responsable de activar la conmutación por error de hello extremo.</span><span class="sxs-lookup"><span data-stu-id="fd6da-160">But unlike pattern #1, hello monitoring application will not be responsible for triggering hello end-point failover.</span></span>

> [!NOTE]
> <span data-ttu-id="fd6da-161">Aunque este patrón utiliza más de una base de datos secundaria, solo Hola secundaria en la región B se utilizarían para conmutación por error y debe formar parte del grupo de conmutación por error de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-161">While this pattern uses more than one secondary database, only hello secondary in Region B  would be used for failover and should be part of hello failover group.</span></span>
>

<span data-ttu-id="fd6da-162">El Administrador de tráfico debe configurarse para la ubicación geográfica del rendimiento enrutamiento toodirect Hola usuario conexiones toohello instancia más cercano toohello de usuarios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd6da-162">Traffic manager should be configured for performance routing toodirect hello user connections toohello application instance closest toohello user's geographic location.</span></span> <span data-ttu-id="fd6da-163">Hola siguiente diagrama ilustra esta configuración antes de una interrupción.</span><span class="sxs-lookup"><span data-stu-id="fd6da-163">hello following diagram illustrates this configuration before an outage.</span></span>

![Ninguna interrupción: aplicación de toonearest enrutamiento de rendimiento.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

<span data-ttu-id="fd6da-166">Si se detecta una interrupción de la base de datos en una región de hello, grupo de conmutación por error de hello iniciará automáticamente conmutación por error de base de datos principal de hello en la región A toohello secundaria en la región de B. Se actualizará automáticamente también tooregion de punto de conexión de agente de escucha de lectura y escritura de hello B para que las conexiones de lectura y escritura en la aplicación web de hello no se verá afectadas.</span><span class="sxs-lookup"><span data-stu-id="fd6da-166">If a database outage is detected in hello region A, hello failover group will automatically initiate failover of hello primary database in region A toohello secondary in region B. It will also automatically update hello read-write listener endpoint tooregion B so read-write connections in hello web application will not be impacted.</span></span> <span data-ttu-id="fd6da-167">Administrador de tráfico de Hello, excluirá el extremo sin conexión Hola de tabla de enrutamiento de hello pero seguirá enrutamiento hello para el usuario final tráfico toohello restantes instancias en línea.</span><span class="sxs-lookup"><span data-stu-id="fd6da-167">hello traffic manager will exclude hello offline end-point from hello routing table but will continue routing hello end-user traffic toohello remaining online instances.</span></span> <span data-ttu-id="fd6da-168">Hello las cadenas de conexión de SQL de solo lectura no se verán afectadas como señalan siempre la base de datos de toohello Hola misma región.</span><span class="sxs-lookup"><span data-stu-id="fd6da-168">hello read-only SQL connection strings will not be impacted as they always point toohello database in hello same region.</span></span> 

<span data-ttu-id="fd6da-169">Hola siguiente diagrama muestra la configuración nuevo de hello después Hola conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="fd6da-169">hello following diagram illustrates hello new configuration after hello failover.</span></span>

![Configuración después de la conmutación por error.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

<span data-ttu-id="fd6da-172">En caso de una interrupción en una de las regiones secundaria Hola, Administrador de tráfico de Hola quitará automáticamente extremo sin conexión de hello en dicha región de tabla de enrutamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-172">In case of an outage in one of hello secondary regions, hello traffic manager will automatically remove hello offline end-point in that region from hello routing table.</span></span> <span data-ttu-id="fd6da-173">se suspenderá Hola replicación canal toohello base de datos secundaria en dicha región.</span><span class="sxs-lookup"><span data-stu-id="fd6da-173">hello replication channel toohello secondary database in that region will be suspended.</span></span> <span data-ttu-id="fd6da-174">Porque regiones restantes Hola obtener tráfico de usuario adicionales en este escenario, se verá afectado el rendimiento de la aplicación hello durante la interrupción de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-174">Because hello remaining regions get additional user traffic in this scenario, hello application's performance will be impacted during hello outage.</span></span> <span data-ttu-id="fd6da-175">Una vez que se mitiga interrupción hello, hello base de datos secundaria en la región afectada Hola inmediatamente sincronizarán con hello principal.</span><span class="sxs-lookup"><span data-stu-id="fd6da-175">Once hello outage is mitigated, hello secondary database in hello impacted region will be immediately synchronized with hello primary.</span></span> <span data-ttu-id="fd6da-176">Durante el saludo rendimiento de la sincronización de hello principal podría verse afectada ligeramente según cantidad Hola de datos que necesita toobe sincronizado.</span><span class="sxs-lookup"><span data-stu-id="fd6da-176">During hello synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="fd6da-177">Hola siguiente diagrama ilustra una interrupción en la región de B.</span><span class="sxs-lookup"><span data-stu-id="fd6da-177">hello following diagram illustrates an outage in region B.</span></span>

![Interrupción en la región secundaria.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

<span data-ttu-id="fd6da-180">clave de Hello **ventaja** de diseño de este patrón es que puede escalar la carga de trabajo de aplicación Hola a través de rendimiento de varios elementos secundarios tooachieve Hola óptimo para el usuario final.</span><span class="sxs-lookup"><span data-stu-id="fd6da-180">hello key **advantage** of this design pattern is that you can scale hello application workload across multiple secondaries tooachieve hello optimal end-user performance.</span></span> <span data-ttu-id="fd6da-181">Hola **compensaciones** de esta opción son:</span><span class="sxs-lookup"><span data-stu-id="fd6da-181">hello **tradeoffs** of this option are:</span></span>

* <span data-ttu-id="fd6da-182">Conexiones de lectura / escritura entre instancias de la aplicación hello y base de datos tienen distintos latencia y costo</span><span class="sxs-lookup"><span data-stu-id="fd6da-182">Read-write connections between hello application instances and database have varying latency and cost</span></span>
* <span data-ttu-id="fd6da-183">Rendimiento de la aplicación se ve afectado durante la interrupción de Hola</span><span class="sxs-lookup"><span data-stu-id="fd6da-183">Application performance is impacted during hello outage</span></span>

> [!NOTE]
> <span data-ttu-id="fd6da-184">Puede usar un enfoque similar toooffload especializado las cargas de trabajo como los informes de trabajos, herramientas de inteligencia empresarial o las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="fd6da-184">A similar approach can be used toooffload specialized workloads such as reporting jobs, business intelligence tools, or backups.</span></span> <span data-ttu-id="fd6da-185">Normalmente, estas cargas de trabajo consumen recursos significativos de la base de datos, por tanto, se recomienda designar uno de Hola bases de datos secundarias para ellos con carga de trabajo prevista de hello rendimiento nivel toohello coincidente.</span><span class="sxs-lookup"><span data-stu-id="fd6da-185">Typically, these workloads consume significant database resources therefore it is recommended that you designate one of hello secondary databases for them with hello performance level matched toohello anticipated workload.</span></span>
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a><span data-ttu-id="fd6da-186">Patrón de diseño 3: implementación activa-pasiva para la conservación de datos</span><span class="sxs-lookup"><span data-stu-id="fd6da-186">Design pattern 3: Active-passive deployment for data preservation</span></span>
<span data-ttu-id="fd6da-187">Esta opción es ideal para las aplicaciones con hello siguientes características:</span><span class="sxs-lookup"><span data-stu-id="fd6da-187">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="fd6da-188">Cualquier pérdida de datos supone un alto riesgo para la empresa.</span><span class="sxs-lookup"><span data-stu-id="fd6da-188">Any data loss is high business risk.</span></span> <span data-ttu-id="fd6da-189">conmutación por error de base de datos de Hello solo puede usarse como último recurso si interrupción hello es grave.</span><span class="sxs-lookup"><span data-stu-id="fd6da-189">hello database failover can only be used as a last resort if hello outage is catastrophic.</span></span>
* <span data-ttu-id="fd6da-190">aplicación Hello admite los modos de solo lectura y lectura / escritura de operaciones y puede funcionar en "modo de solo lectura" durante un período de tiempo.</span><span class="sxs-lookup"><span data-stu-id="fd6da-190">hello application supports read-only and read-write modes of operations and can operate in "read-only mode" for a period of time.</span></span>

<span data-ttu-id="fd6da-191">En este modelo, aplicación hello cambia el modo de sólo tooread cuando las conexiones de lectura / escritura de hello empiece a obtener errores de tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="fd6da-191">In this pattern, hello application switches tooread-only mode when hello read-write connections start getting time-out errors.</span></span> <span data-ttu-id="fd6da-192">Hola aplicación Web está implementada tooboth regiones e incluyen un punto de conexión de agente de escucha de lectura y escritura de toohello de conexión y el punto de conexión de una conexión distinta toohello del agente de escucha de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="fd6da-192">hello Web Application is deployed tooboth regions and include a connection toohello read-write listener endpoint and different connection toohello read-only listener endpoint.</span></span> <span data-ttu-id="fd6da-193">el Administrador de tráfico Hola se debe configurar toouse [enrutamiento de conmutación por error](../traffic-manager/traffic-manager-configure-failover-routing-method.md) con [supervisión de extremo](../traffic-manager/traffic-manager-monitoring.md) habilitada para el extremo de la aplicación hello en cada región.</span><span class="sxs-lookup"><span data-stu-id="fd6da-193">hello Traffic manager should be set up toouse [failover routing](../traffic-manager/traffic-manager-configure-failover-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for hello application endpoint in each region.</span></span>

<span data-ttu-id="fd6da-194">Hola siguiente diagrama ilustra esta configuración antes de una interrupción.</span><span class="sxs-lookup"><span data-stu-id="fd6da-194">hello following diagram illustrates this configuration before an outage.</span></span>

![Implementación activa-pasiva antes de la conmutación por error.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

<span data-ttu-id="fd6da-197">Cuando el Administrador de tráfico Hola detecta un tooregion de error de conectividad A, cambia automáticamente la instancia de aplicación de usuario tráfico toohello en la región de B. Con este modelo, es importante establecer período de gracia de hello con valor suficientemente alto de datos pérdida tooa, por ejemplo, 24 horas.</span><span class="sxs-lookup"><span data-stu-id="fd6da-197">When hello traffic manager detects a connectivity failure tooregion A, it automatically switches user traffic toohello application instance in region B. With this pattern, it is important that you set hello grace period with data loss tooa sufficiently high value, e.g. 24 hours.</span></span> <span data-ttu-id="fd6da-198">Se asegurará de que se evita la pérdida de datos si se mitiga la interrupción de Hola durante este periodo.</span><span class="sxs-lookup"><span data-stu-id="fd6da-198">It will ensure that data loss is prevented if hello outage is mitigated within that time.</span></span> <span data-ttu-id="fd6da-199">Cuando se activa hello las aplicaciones Web de región de hello B las operaciones de lectura y escritura de hello empiezan a generar errores.</span><span class="sxs-lookup"><span data-stu-id="fd6da-199">When hello Web application in hello region B is activated hello read-write operations will start failing.</span></span> <span data-ttu-id="fd6da-200">En ese momento, debe cambiar el modo de solo lectura de toohello.</span><span class="sxs-lookup"><span data-stu-id="fd6da-200">At that point, it should switch toohello read-only mode.</span></span> <span data-ttu-id="fd6da-201">En este Hola modo solicitudes será toohello enrutado automáticamente la base de datos secundaria.</span><span class="sxs-lookup"><span data-stu-id="fd6da-201">In this mode hello requests will be automatically routed toohello secondary database.</span></span> <span data-ttu-id="fd6da-202">En caso de hello del programa Hola a un error catastrófico interrupción no se pueden mitigar dentro del período de gracia de Hola y grupo de conmutación por error de hello desencadenará Hola conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="fd6da-202">In hello case of a catastrophic failure hello outage will not be mitigated within hello grace period and hello failover group will trigger hello failover.</span></span> <span data-ttu-id="fd6da-203">Después de ese Hola estará disponible el agente de escucha de lectura y escritura y Hola llamadas tooit se detendrá por error.</span><span class="sxs-lookup"><span data-stu-id="fd6da-203">After that hello read-write listener will become available and hello calls tooit will stop failing.</span></span> <span data-ttu-id="fd6da-204">Hola siguiente diagrama se ilustra.</span><span class="sxs-lookup"><span data-stu-id="fd6da-204">This is illustrated by hello following diagram.</span></span>

![Interrupción: aplicación en modo de sólo lectura.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

<span data-ttu-id="fd6da-207">Si se mitiga una interrupción de hello en la región principal de hello en período de gracia de hello, traffic manager detecta restauración Hola de conectividad en la región principal de Hola y activa la instancia de aplicación de usuario tráfico toohello atrás en la región A. Esa instancia de la aplicación se reanuda y funciona en modo de lectura y escritura en base de datos principal de hello región A.</span><span class="sxs-lookup"><span data-stu-id="fd6da-207">If hello outage in hello primary region is mitigated within hello grace period, traffic manager detects hello restoration of connectivity in hello primary region and switches user traffic back toohello application instance in region A. That application instance resumes and operates in read-write mode using hello primary database in region A.</span></span>

<span data-ttu-id="fd6da-208">En el caso de una interrupción en la región de hello B, Administrador de tráfico de hello detecta el error de hello del extremo de aplicación hello en la región B y el grupo de conmutación por error Hola conmutadores Hola del agente de escucha de solo lectura tooregion A. Esta interrupción no afecta a la experiencia del usuario final de hello pero se expondrá la base de datos principal de Hola durante la interrupción de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-208">In case of an outage in hello region B, hello traffic manager detects hello failure of hello application end-point in region B and hello failover group switches hello read-only listener tooregion A. This outage does not impact hello end-user experience but hello primary database will be exposed during hello outage.</span></span> <span data-ttu-id="fd6da-209">Hola siguiente diagrama se ilustra.</span><span class="sxs-lookup"><span data-stu-id="fd6da-209">This is illustrated by hello following diagram.</span></span>

![Interrupción: base de datos secundaria.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

<span data-ttu-id="fd6da-212">Una vez que se mitiga interrupción hello, hello base de datos secundaria se sincronice inmediatamente con hello principal y agente de escucha de solo lectura de hello es conmutada toohello back-base de datos secundaria en la región de B. Durante la sincronización de rendimiento de hello principal podría verse afectada ligeramente según cantidad Hola de datos que necesita toobe sincronizado.</span><span class="sxs-lookup"><span data-stu-id="fd6da-212">Once hello outage is mitigated, hello secondary database is immediately synchronized with hello primary and hello read-only listener is switched back toohello secondary database in region B. During synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span>

<span data-ttu-id="fd6da-213">Este patrón de diseño tiene varias **ventajas**:</span><span class="sxs-lookup"><span data-stu-id="fd6da-213">This design pattern has several **advantages**:</span></span>

* <span data-ttu-id="fd6da-214">Evita la pérdida de datos durante las interrupciones temporales de Hola.</span><span class="sxs-lookup"><span data-stu-id="fd6da-214">It avoids data loss during hello temporary outages.</span></span>
* <span data-ttu-id="fd6da-215">Tiempo de inactividad depende solo de la velocidad de traffic manager detecta errores de conectividad de hello, lo que es configurable.</span><span class="sxs-lookup"><span data-stu-id="fd6da-215">Downtime depends only on how quickly traffic manager detects hello connectivity failure, which is configurable.</span></span>

<span data-ttu-id="fd6da-216">Hola **contrapartida** es:</span><span class="sxs-lookup"><span data-stu-id="fd6da-216">hello **tradeoff** is:</span></span>

* <span data-ttu-id="fd6da-217">Aplicación debe ser capaz de toooperate en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="fd6da-217">Application must be able toooperate in read-only mode.</span></span>

> [!NOTE]
> <span data-ttu-id="fd6da-218">En el caso de una interrupción del servicio permanente en la región de hello, manualmente activar la conmutación por error de base de datos y Aceptar Hola pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="fd6da-218">In case of a permanent service outage in hello region, you manually activate database failover and accept hello data loss.</span></span> <span data-ttu-id="fd6da-219">aplicación Hello será funcional en la región secundaria de hello con base de datos de toohello de acceso de lectura y escritura.</span><span class="sxs-lookup"><span data-stu-id="fd6da-219">hello application will be functional in hello secondary region with read-write access toohello database.</span></span>
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a><span data-ttu-id="fd6da-220">Planificación de continuidad del negocio: elección del diseño de una aplicación para la recuperación ante desastres en la nube</span><span class="sxs-lookup"><span data-stu-id="fd6da-220">Business continuity planning: Choose an application design for cloud disaster recovery</span></span>
<span data-ttu-id="fd6da-221">La estrategia de recuperación ante desastres de nube específica puede combinar o ampliar estos patrones de diseño necesidades de hello cumple toobest de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd6da-221">Your specific cloud disaster recovery strategy can combine or extend these design patterns toobest meet hello needs of your application.</span></span>  <span data-ttu-id="fd6da-222">Como se mencionó anteriormente, estrategia de Hola que elija se basa en hello SLA desee a toooffer tooyour clientes y Hola topología de implementación de aplicación.</span><span class="sxs-lookup"><span data-stu-id="fd6da-222">As mentioned earlier, hello strategy you choose is based on hello SLA you want toooffer tooyour customers and hello application deployment topology.</span></span> <span data-ttu-id="fd6da-223">toohelp guiar la decisión, hello en la tabla siguiente compara las opciones de hello basándose en datos estimada de hello pérdida o recuperación objetivos de punto (RPO) y el tiempo de recuperación estimado (ERT).</span><span class="sxs-lookup"><span data-stu-id="fd6da-223">toohelp guide your decision, hello following table compares hello choices based on hello estimated data loss or recovery point objective (RPO) and estimated recovery time (ERT).</span></span>

| <span data-ttu-id="fd6da-224">Patrón</span><span class="sxs-lookup"><span data-stu-id="fd6da-224">Pattern</span></span> | <span data-ttu-id="fd6da-225">RPO</span><span class="sxs-lookup"><span data-stu-id="fd6da-225">RPO</span></span> | <span data-ttu-id="fd6da-226">ERT</span><span class="sxs-lookup"><span data-stu-id="fd6da-226">ERT</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="fd6da-227">Implementación activa-pasiva para la recuperación ante desastres con acceso a base de datos colocalizada</span><span class="sxs-lookup"><span data-stu-id="fd6da-227">Active-passive deployment for disaster recovery with co-located database access</span></span> |<span data-ttu-id="fd6da-228">Acceso de lectura y escritura < 5 s</span><span class="sxs-lookup"><span data-stu-id="fd6da-228">Read-write access < 5 sec</span></span> |<span data-ttu-id="fd6da-229">Tiempo de detección de errores + TTL de DNS</span><span class="sxs-lookup"><span data-stu-id="fd6da-229">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="fd6da-230">Implementación activa-activa para el equilibrio de carga de aplicación</span><span class="sxs-lookup"><span data-stu-id="fd6da-230">Active-active deployment for application load balancing</span></span> |<span data-ttu-id="fd6da-231">Acceso de lectura y escritura < 5 s</span><span class="sxs-lookup"><span data-stu-id="fd6da-231">Read-write access < 5 sec</span></span> |<span data-ttu-id="fd6da-232">Tiempo de detección de errores + TTL de DNS</span><span class="sxs-lookup"><span data-stu-id="fd6da-232">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="fd6da-233">Implementación activa-pasiva para la conservación de datos</span><span class="sxs-lookup"><span data-stu-id="fd6da-233">Active-passive deployment for data preservation</span></span> |<span data-ttu-id="fd6da-234">Acceso de solo lectura < 5 s</span><span class="sxs-lookup"><span data-stu-id="fd6da-234">Read-only access < 5 sec</span></span> | <span data-ttu-id="fd6da-235">Acceso de solo lectura = 0</span><span class="sxs-lookup"><span data-stu-id="fd6da-235">Read-only access = 0</span></span> |
||<span data-ttu-id="fd6da-236">Acceso de lectura y escritura = cero</span><span class="sxs-lookup"><span data-stu-id="fd6da-236">Read-write access = zero</span></span> | <span data-ttu-id="fd6da-237">Acceso de lectura y escritura = Tiempo de detección de errores + Período de gracia con pérdida de datos</span><span class="sxs-lookup"><span data-stu-id="fd6da-237">Read-write access = Failure detection time + grace period with data loss</span></span> |
|||

## <a name="next-steps"></a><span data-ttu-id="fd6da-238">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="fd6da-238">Next steps</span></span>
* <span data-ttu-id="fd6da-239">toolearn acerca de las copias de seguridad de base de datos de SQL de Azure automatizada, vea [copias de seguridad automáticas de base de datos SQL](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="fd6da-239">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="fd6da-240">Para obtener una descripción general y los escenarios de la continuidad empresarial, consulte [Continuidad empresarial con Base de datos SQL de Azure](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="fd6da-240">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="fd6da-241">toolearn sobre el uso de copias de seguridad automatizadas para la recuperación, vea [restaurar una base de datos de copias de seguridad de hello iniciadas por el servicio](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="fd6da-241">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>
* <span data-ttu-id="fd6da-242">toolearn acerca de las opciones de recuperación más rápidos, consulte [replicación geográfica activa](sql-database-geo-replication-overview.md)</span><span class="sxs-lookup"><span data-stu-id="fd6da-242">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md)</span></span>  
* <span data-ttu-id="fd6da-243">toolearn sobre el uso de copias de seguridad automatizadas para el archivado, vea [copiar base de datos](sql-database-copy.md)</span><span class="sxs-lookup"><span data-stu-id="fd6da-243">toolearn about using automated backups for archiving, see [database copy](sql-database-copy.md)</span></span>
* <span data-ttu-id="fd6da-244">Para saber cómo utilizar la replicación geográfica activa con los grupos elásticos, consulte [Estrategias de recuperación ante desastres para aplicaciones que usan el grupo elástico de Base de datos SQL](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="fd6da-244">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
