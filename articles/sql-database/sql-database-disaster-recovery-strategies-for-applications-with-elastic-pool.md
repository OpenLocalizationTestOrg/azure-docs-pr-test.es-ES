---
title: "Diseño de soluciones de recuperación ante desastres: Azure SQL Database | Microsoft Docs"
description: "Aprenda a diseñar la solución de nube para recuperación ante desastres eligiendo el modelo correcto de conmutación por error."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 2db99057-0c79-4fb0-a7f1-d1c057ec787f
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: sashan;carlrab
ms.openlocfilehash: 4f5131fdd2ca83e7a0a2f986a2fa1e3551814c6e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="disaster-recovery-strategies-for-applications-using-sql-database-elastic-pools"></a><span data-ttu-id="6d2ee-103">Estrategias de recuperación ante desastres para aplicaciones que usan grupos elásticos de SQL Database</span><span class="sxs-lookup"><span data-stu-id="6d2ee-103">Disaster recovery strategies for applications using SQL Database elastic pools</span></span>
<span data-ttu-id="6d2ee-104">A lo largo de los años, hemos aprendido que los servicios en la nube no son infalibles y que los incidentes catastróficos ocurren.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-104">Over the years we have learned that cloud services are not foolproof and catastrophic incidents happen.</span></span> <span data-ttu-id="6d2ee-105">SQL Database proporciona una serie de funcionalidades para proporcionar la continuidad del negocio de la aplicación cuando se producen estos incidentes.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-105">SQL Database provides several capabilities to provide for the business continuity of your application when these incidents occur.</span></span> <span data-ttu-id="6d2ee-106">Los [grupos elásticos](sql-database-elastic-pool.md) y las bases de datos únicas admiten el mismo tipo de funcionalidades de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-106">[Elastic pools](sql-database-elastic-pool.md) and single databases support the same kind of disaster recovery capabilities.</span></span> <span data-ttu-id="6d2ee-107">En este artículo se describen varias estrategias de recuperación ante desastres para grupos elásticos que sacan partido a esas características de continuidad de negocio de Base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-107">This article describes several DR strategies for elastic pools that leverage these SQL Database business continuity features.</span></span>

<span data-ttu-id="6d2ee-108">En este artículo se usa el modelo de aplicaciones de ISV de SaaS canónico siguiente:</span><span class="sxs-lookup"><span data-stu-id="6d2ee-108">This article uses the following canonical SaaS ISV application pattern:</span></span>

<span data-ttu-id="6d2ee-109"><i>Una aplicación web moderna basada en la nube aprovisiona una instancia de SQL Database para cada usuario final. El ISV tiene muchos clientes y, por tanto, utiliza muchas bases de datos, conocidas como bases de datos de inquilino. Dado que las bases de datos de inquilino normalmente tienen patrones de actividad impredecibles, el ISV usa un grupo elástico para que el costo de la base de datos sea muy predecible durante prolongados períodos. El grupo elástico también simplifica la administración del rendimiento cuando aumenta la actividad del usuario. Además de las bases de datos de inquilino, la aplicación también utiliza varias bases de datos para administrar los perfiles de usuario, la seguridad o la recopilación de los patrones de uso, entre otros. La disponibilidad de los inquilinos individuales no afecta a la disponibilidad de la aplicación como conjunto. Sin embargo, la disponibilidad y el rendimiento de las bases de datos de administración son fundamentales para el funcionamiento de la aplicación y, si las bases de datos de administración están sin conexión, pasará lo mismo con toda la aplicación.</i></span><span class="sxs-lookup"><span data-stu-id="6d2ee-109"><i>A modern cloud-based web application provisions one SQL database for each end user. The ISV has many customers and therefore uses many databases, known as tenant databases. Because the tenant databases typically have unpredictable activity patterns, the ISV uses an elastic pool to make the database cost very predictable over extended periods of time. The elastic pool also simplifies the performance management when the user activity spikes. In addition to the tenant databases the application also uses several databases to manage user profiles, security, collect usage patterns etc. Availability of the individual tenants does not impact the application’s availability as whole. However, the availability and performance of management databases is critical for the application’s function and if the management databases are offline the entire application is offline.</i></span></span>  

<span data-ttu-id="6d2ee-110">En este artículo se describen las estrategias de recuperación ante desastres que abarcan una variedad de escenarios que va desde las aplicaciones de inicio sensibles al costo a aquellas con requisitos estrictos de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-110">This article discusses DR strategies covering a range of scenarios from cost sensitive startup applications to ones with stringent availability requirements.</span></span>

## <a name="scenario-1-cost-sensitive-startup"></a><span data-ttu-id="6d2ee-111">Escenario 1.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-111">Scenario 1.</span></span> <span data-ttu-id="6d2ee-112">Inicio sensible al costo</span><span class="sxs-lookup"><span data-stu-id="6d2ee-112">Cost sensitive startup</span></span>
<span data-ttu-id="6d2ee-113"><i>Acabo de crear una empresa y me preocupan sobremanera los costos.  Quiero simplificar la implementación y administración de la aplicación y puedo tener un Acuerdo de Nivel de Servicio limitado para clientes individuales. Sin embargo, quiero garantizar que nunca se quede sin conexión toda la aplicación.</i></span><span class="sxs-lookup"><span data-stu-id="6d2ee-113"><i>I am a startup business and am extremely cost sensitive.  I want to simplify deployment and management of the application and I can have a limited SLA for individual customers. But I want to ensure the application as a whole is never offline.</i></span></span>

<span data-ttu-id="6d2ee-114">Para satisfacer el requisito de simplicidad, implemente todas las bases de datos de inquilino en un grupo elástico de la región de Azure de su elección e implemente las bases de datos de administración como bases de datos únicas de replicación geográfica.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-114">To satisfy the simplicity requirement, deploy all tenant databases into one elastic pool in the Azure region of your choice and deploy management databases as geo-replicated single databases.</span></span> <span data-ttu-id="6d2ee-115">Para la recuperación ante desastres de los inquilinos, use la restauración geográfica, que se incluye sin costo adicional.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-115">For the disaster recovery of tenants, use geo-restore, which comes at no additional cost.</span></span> <span data-ttu-id="6d2ee-116">Para garantizar la disponibilidad de las bases de datos de administración, replíquelas geográficamente en otra región con un grupo de conmutación por error automática (versión preliminar) (paso 1).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-116">To ensure the availability of the management databases, geo-replicate them to another region using an auto-failover group (in-preview) (step 1).</span></span> <span data-ttu-id="6d2ee-117">El costo en curso de la configuración de recuperación ante desastres en este escenario es igual al costo total de las bases de datos secundarias.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-117">The ongoing cost of the disaster recovery configuration in this scenario is equal to the total cost of the secondary databases.</span></span> <span data-ttu-id="6d2ee-118">En el siguiente diagrama se ilustra esta configuración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-118">This configuration is illustrated on the next diagram.</span></span>

![En la Ilustración 1](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-1.png)

<span data-ttu-id="6d2ee-120">En el caso de una interrupción en la región primaria, en el diagrama siguiente se muestran los pasos de recuperación para volver a conectar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-120">If an outage occurs in the primary region, the recovery steps to bring your application online are illustrated by the next diagram.</span></span>

* <span data-ttu-id="6d2ee-121">El grupo de conmutación por error inicia la conmutación por error automática de la base de datos de administración a la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-121">The failover group initiates automatic failover of the management database to the DR region.</span></span> <span data-ttu-id="6d2ee-122">La aplicación se volverá a conectar automáticamente a la nueva base de datos principal y todas las nuevas cuentas y bases de datos de inquilino se crearán en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-122">The application is automatically reconnected to the new primary and all new accounts and tenant databases are created in the DR region.</span></span> <span data-ttu-id="6d2ee-123">Los clientes existentes verán que sus datos no están disponibles temporalmente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-123">The existing customers see their data temporarily unavailable.</span></span>
* <span data-ttu-id="6d2ee-124">Cree el grupo elástico con la misma configuración que el grupo original (2).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-124">Create the elastic pool with the same configuration as the original pool (2).</span></span>
* <span data-ttu-id="6d2ee-125">Use la restauración geográfica para crear copias de las bases de datos de inquilino (3).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-125">Use geo-restore to create copies of the tenant databases (3).</span></span> <span data-ttu-id="6d2ee-126">Considere desencadenar las restauraciones individuales por las conexiones de los usuarios finales o utilizar algún otro esquema de prioridad específica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-126">You can consider triggering the individual restores by the end-user connections or use some other application-specific priority scheme.</span></span>


<span data-ttu-id="6d2ee-127">En este momento, la aplicación vuelve a estar conectada en la región de recuperación ante desastres, pero algunos clientes experimentarán una demora al tener acceso a sus datos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-127">At this point your application is back online in the DR region, but some customers experience delay when accessing their data.</span></span>

![Ilustración 2](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-2.png)

<span data-ttu-id="6d2ee-129">Si la interrupción fue temporal, es posible que Azure recupere la región primaria antes de que todas las restauraciones de bases de datos se completen en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-129">If the outage was temporary, it is possible that the primary region is recovered by Azure before all the database restores are complete in the DR region.</span></span> <span data-ttu-id="6d2ee-130">En este caso, organice el regreso de la aplicación a la región primaria.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-130">In this case, orchestrate moving the application back to the primary region.</span></span> <span data-ttu-id="6d2ee-131">El proceso realizará los pasos que se muestran en el diagrama siguiente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-131">The process takes the steps illustrated on the next diagram.</span></span>

* <span data-ttu-id="6d2ee-132">Cancele todas las solicitudes de restauración geográfica pendientes.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-132">Cancel all outstanding geo-restore requests.</span></span>   
* <span data-ttu-id="6d2ee-133">Realice la conmutación por error de las bases de datos de administración a la región primaria (5).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-133">Fail over the management databases to the primary region (5).</span></span> <span data-ttu-id="6d2ee-134">Nota: Después de la recuperación de la región, las primarias anteriores se convierten automáticamente en secundarias.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-134">After the region’s recovery, the old primaries have automatically become secondaries.</span></span> <span data-ttu-id="6d2ee-135">Ahora vuelven a cambiar los roles.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-135">Now they switch roles again.</span></span> 
* <span data-ttu-id="6d2ee-136">Cambie la cadena de conexión de la aplicación para que vuelva a apuntar a la región primaria.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-136">Change the application's connection string to point back to the primary region.</span></span> <span data-ttu-id="6d2ee-137">Ahora todas las cuentas nuevas y las bases de datos de inquilino se crean en la región primaria.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-137">Now all new accounts and tenant databases are created in the primary region.</span></span> <span data-ttu-id="6d2ee-138">Algunos clientes existentes verán que sus datos no están disponibles temporalmente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-138">Some existing customers see their data temporarily unavailable.</span></span>   
* <span data-ttu-id="6d2ee-139">Establezca todas las bases de datos en el grupo de recuperación ante desastres de solo lectura para asegurarse de que no se puede modificar en la región de recuperación ante desastres (6).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-139">Set all databases in the DR pool to read-only to ensure they cannot be modified in the DR region (6).</span></span> 
* <span data-ttu-id="6d2ee-140">Para las bases de datos del grupo de recuperación ante desastres que hayan cambiado desde la recuperación, cambie el nombre o elimine las bases de datos correspondientes en el grupo principal (7).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-140">For each database in the DR pool that has changed since the recovery, rename or delete the corresponding databases in the primary pool (7).</span></span> 
* <span data-ttu-id="6d2ee-141">Copie las bases de datos actualizadas desde el grupo de recuperación ante desastres al grupo principal (8).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-141">Copy the updated databases from the DR pool to the primary pool (8).</span></span> 
* <span data-ttu-id="6d2ee-142">Elimine el grupo de recuperación ante desastres (9).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-142">Delete the DR pool (9)</span></span>

<span data-ttu-id="6d2ee-143">En este momento la aplicación estará en línea en la región primaria con todas las bases de datos de inquilino disponibles en el grupo principal.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-143">At this point your application is online in the primary region with all tenant databases available in the primary pool.</span></span>

![Ilustración 3](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-3.png)

<span data-ttu-id="6d2ee-145">La principal **ventaja** de esta estrategia es el bajo costo continuo para la redundancia de nivel de datos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-145">The key **benefit** of this strategy is low ongoing cost for data tier redundancy.</span></span> <span data-ttu-id="6d2ee-146">Las copias de seguridad las realiza automáticamente el servicio de Base de datos SQL sin necesidad de reescritura de aplicación y sin costo adicional.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-146">Backups are taken automatically by the SQL Database service with no application rewrite and at no additional cost.</span></span>  <span data-ttu-id="6d2ee-147">El costo se contrae solo cuando se restauran las bases de datos elásticas.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-147">The cost is incurred only when the elastic databases are restored.</span></span> <span data-ttu-id="6d2ee-148">El **inconveniente** es que la recuperación completa de todas las bases de datos de inquilino tarda mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-148">The **trade-off** is that the complete recovery of all tenant databases takes significant time.</span></span> <span data-ttu-id="6d2ee-149">El tiempo dependerá del número total de restauraciones que se inicien en la región de recuperación ante desastres y del tamaño general de las bases de datos de inquilino.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-149">The length of time depends on the total number of restores you initiate in the DR region and overall size of the tenant databases.</span></span> <span data-ttu-id="6d2ee-150">Aunque si se priorizan algunas restauraciones de inquilinos sobre otras, estará compitiendo con todas las demás restauraciones que se inicien en la misma región, ya que el servicio arbitrará y se limitará para minimizar la repercusión global en las bases de datos de los clientes existentes.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-150">Even if you prioritize some tenants' restores over others, you are competing with all the other restores that are initiated in the same region as the service arbitrates and throttles to minimize the overall impact on the existing customers' databases.</span></span> <span data-ttu-id="6d2ee-151">Además, la recuperación de las bases de datos de inquilino no podrá iniciarse hasta que se cree el nuevo grupo elástico en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-151">In addition, the recovery of the tenant databases cannot start until the new elastic pool in the DR region is created.</span></span>

## <a name="scenario-2-mature-application-with-tiered-service"></a><span data-ttu-id="6d2ee-152">Escenario 2.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-152">Scenario 2.</span></span> <span data-ttu-id="6d2ee-153">Aplicación madura con servicio en capas</span><span class="sxs-lookup"><span data-stu-id="6d2ee-153">Mature application with tiered service</span></span>
<span data-ttu-id="6d2ee-154"><i>Tengo una aplicación de SaaS desarrollada con ofertas de servicio en capas y distintos Acuerdos de Nivel de Servicio para clientes de versiones de prueba y de pago. Para los clientes de versiones de prueba, tengo que reducir el costo tanto como sea posible. Los clientes de versiones de prueba pueden asumir el tiempo de inactividad, pero quiero reducir su probabilidad. Para los clientes de versiones de pago, los tiempos de inactividad es un riesgo de vuelo. Por tanto, quiero asegurarme de que los clientes con versiones de pago siempre tengan acceso a sus datos.</i></span><span class="sxs-lookup"><span data-stu-id="6d2ee-154"><i>I am a mature SaaS application with tiered service offers and different SLAs for trial customers and for paying customers. For the trial customers, I have to reduce the cost as much as possible. Trial customers can take downtime but I want to reduce its likelihood. For the paying customers, any downtime is a flight risk. So I want to make sure that paying customers are always able to access their data.</i></span></span> 

<span data-ttu-id="6d2ee-155">Para admitir este escenario, separe los inquilinos de versiones de prueba de los inquilinos de versiones de pago, colocándolos en grupos elásticos independientes.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-155">To support this scenario, separate the trial tenants from paid tenants by putting them into separate elastic pools.</span></span> <span data-ttu-id="6d2ee-156">Los clientes de versiones de prueba tienen un eDTU menor por inquilino y un contrato de nivel de servicio menor con un tiempo de recuperación mayor.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-156">The trial customers have lower eDTU per tenant and lower SLA with a longer recovery time.</span></span> <span data-ttu-id="6d2ee-157">Los clientes de versiones de pago se encuentran en un grupo con mayor eDTU por inquilino y un contrato de nivel de servicio superior.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-157">The paying customers are in a pool with higher eDTU per tenant and a higher SLA.</span></span> <span data-ttu-id="6d2ee-158">Para garantizar el menor tiempo de recuperación, las bases de datos de inquilino de los clientes de versiones de pago deben replicarse geográficamente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-158">To guarantee the lowest recovery time, the paying customers' tenant databases are geo-replicated.</span></span> <span data-ttu-id="6d2ee-159">En el siguiente diagrama se ilustra esta configuración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-159">This configuration is illustrated on the next diagram.</span></span> 

![Ilustración 4](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-4.png)

<span data-ttu-id="6d2ee-161">Al igual que en el primer escenario, las bases de datos de administración estarán bastante activas, por tanto puede utilizar una base de datos única de replicación geográfica para ello (1).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-161">As in the first scenario, the management databases are quite active so you use a single geo-replicated database for it (1).</span></span> <span data-ttu-id="6d2ee-162">Esto garantiza un rendimiento predecible para las nuevas suscripciones de cliente, actualizaciones del perfil y otras operaciones de administración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-162">This ensures the predictable performance for new customer subscriptions, profile updates, and other management operations.</span></span> <span data-ttu-id="6d2ee-163">La región en la que residen los principales de las bases de datos de administración será la región primaria y la región en la que residen los secundarios de las bases de datos de administración será la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-163">The region in which the primaries of the management databases reside is the primary region and the region in which the secondaries of the management databases reside is the DR region.</span></span>

<span data-ttu-id="6d2ee-164">Las bases de datos de inquilino de los clientes con versiones de pago tienen bases de datos activas en el grupo aprovisionado "de pago" de la región primaria.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-164">The paying customers’ tenant databases have active databases in the “paid” pool provisioned in the primary region.</span></span> <span data-ttu-id="6d2ee-165">Aprovisione un grupo secundario con el mismo nombre en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-165">Provision a secondary pool with the same name in the DR region.</span></span> <span data-ttu-id="6d2ee-166">Cada inquilino está replicado geográficamente en el grupo secundario (2).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-166">Each tenant is geo-replicated to the secondary pool (2).</span></span> <span data-ttu-id="6d2ee-167">Esto permite una recuperación rápida de todas las bases de datos de inquilino mediante la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-167">This enables quick recovery of all tenant databases using failover.</span></span> 

<span data-ttu-id="6d2ee-168">En el caso de una interrupción en la región principal, en el diagrama siguiente se muestran los pasos de recuperación para volver a conectar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-168">If an outage occurs in the primary region, the recovery steps to bring your application online are illustrated in the next diagram:</span></span>

![Ilustración 5.](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-5.png)

* <span data-ttu-id="6d2ee-170">Realice inmediatamente una conmutación por error en las bases de datos de administración en la región de recuperación ante desastres (3).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-170">Immediately fail over the management databases to the DR region (3).</span></span>
* <span data-ttu-id="6d2ee-171">Cambie la cadena de conexión de la aplicación para que apunte a la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-171">Change the application’s connection string to point to the DR region.</span></span> <span data-ttu-id="6d2ee-172">Ahora todas las cuentas nuevas y las bases de datos de inquilino se crean en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-172">Now all new accounts and tenant databases are created in the DR region.</span></span> <span data-ttu-id="6d2ee-173">Los clientes de versiones de prueba existentes verán que sus datos no están disponibles temporalmente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-173">The existing trial customers see their data temporarily unavailable.</span></span>
* <span data-ttu-id="6d2ee-174">Realice una conmutación por error en las bases de datos de inquilino de versiones de pago, en el grupo de la región de recuperación ante desastres, para restaurar inmediatamente su disponibilidad (4).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-174">Fail over the paid tenant's databases to the pool in the DR region to immediately restore their availability (4).</span></span> <span data-ttu-id="6d2ee-175">Dado que la conmutación por error es un rápido cambio de nivel de metadatos, se puede considerar una optimización cuando se desencadenan las conmutaciones por error individuales a petición de las conexiones del usuario final.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-175">Since the failover is a quick metadata level change, consider an optimization where the individual failovers are triggered on demand by the end-user connections.</span></span> 
* <span data-ttu-id="6d2ee-176">Si el tamaño de eDTU del grupo secundario era menor que el principal porque las bases de datos secundarias solo requieren la capacidad para procesar los registros de cambio mientras eran secundarias, aumente inmediatamente la capacidad del bloque para acomodar la carga de trabajo completa de todos los inquilinos (5).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-176">If your secondary pool eDTU size was lower than the primary because the secondary databases only required the capacity to process the change logs while they were secondaries, immediately increase the pool capacity now to accommodate the full workload of all tenants (5).</span></span> 
* <span data-ttu-id="6d2ee-177">Cree el nuevo grupo elástico con el mismo nombre y la misma configuración en la región de recuperación ante desastres para bases de datos de los clientes de versiones de prueba (6).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-177">Create the new elastic pool with the same name and the same configuration in the DR region for the trial customers' databases (6).</span></span> 
* <span data-ttu-id="6d2ee-178">Una vez creado el grupo de clientes de versiones de prueba, puede usar la restauración geográfica para restaurar las bases de datos de inquilino de versiones de prueba individuales en el nuevo grupo (7).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-178">Once the trial customers’ pool is created, use geo-restore to restore the individual trial tenant databases into the new pool (7).</span></span> <span data-ttu-id="6d2ee-179">Considere desencadenar las restauraciones individuales por las conexiones de los usuarios finales o utilizar algún otro esquema de prioridad específica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-179">Consider triggering the individual restores by the end-user connections or use some other application-specific priority scheme.</span></span>

<span data-ttu-id="6d2ee-180">En este momento la aplicación vuelve a estar en línea en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-180">At this point your application is back online in the DR region.</span></span> <span data-ttu-id="6d2ee-181">Todos los clientes de versiones de pago tienen acceso a los datos, mientras que los clientes de versiones de prueba experimentan una demora al acceder a los suyos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-181">All paying customers have access to their data while the trial customers experience delay when accessing their data.</span></span>

<span data-ttu-id="6d2ee-182">Cuando Azure recupera la región primaria *después* de haber restaurado la aplicación en la región de recuperación ante desastres, puede continuar ejecutando la aplicación en dicha región, o bien decidir realizar una conmutación por recuperación en la región principal.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-182">When the primary region is recovered by Azure *after* you have restored the application in the DR region you can continue running the application in that region or you can decide to fail back to the primary region.</span></span> <span data-ttu-id="6d2ee-183">Si se recupera la región primaria *antes* de que se complete el proceso de conmutación por error, debe plantearse utilizar la conmutación por recuperación inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-183">If the primary region is recovered *before* the failover process is completed, consider failing back right away.</span></span> <span data-ttu-id="6d2ee-184">La conmutación por recuperación realiza los pasos que se muestran en el diagrama siguiente:</span><span class="sxs-lookup"><span data-stu-id="6d2ee-184">The failback takes the steps illustrated in the next diagram:</span></span> 

![Ilustración 6.](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-6.png)

* <span data-ttu-id="6d2ee-186">Cancele todas las solicitudes de restauración geográfica pendientes.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-186">Cancel all outstanding geo-restore requests.</span></span>   
* <span data-ttu-id="6d2ee-187">Realice una conmutación por error en las bases de datos de administración (8).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-187">Fail over the management databases (8).</span></span> <span data-ttu-id="6d2ee-188">Después de la recuperación de la región, la primaria anterior se convierte automáticamente en secundaria.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-188">After the region’s recovery, the old primary automatically become the secondary.</span></span> <span data-ttu-id="6d2ee-189">Ahora vuelve a convertir en principal.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-189">Now it becomes the primary again.</span></span>  
* <span data-ttu-id="6d2ee-190">Realice una conmutación por error en las bases de datos de inquilino de versiones de pago (9).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-190">Fail over the paid tenant databases (9).</span></span> <span data-ttu-id="6d2ee-191">De igual forma, después de la recuperación de la región, las primarias anteriores se convierten automáticamente en secundarias.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-191">Similarly, after the region’s recovery, the old primaries automatically become the secondaries.</span></span> <span data-ttu-id="6d2ee-192">Ahora volverán a ser primarias.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-192">Now they become the primaries again.</span></span> 
* <span data-ttu-id="6d2ee-193">Establezca las bases de datos de versiones de prueba restauradas que han cambiado en la región de recuperación ante desastres en solo lectura (10).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-193">Set the restored trial databases that have changed in the DR region to read-only (10).</span></span>
* <span data-ttu-id="6d2ee-194">Para las bases de datos del grupo de recuperación ante desastres de los clientes de versiones de prueba que hayan cambiado desde la recuperación, cambie el nombre o elimine la base de datos correspondiente en el grupo principal (11).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-194">For each database in the trial customers DR pool that changed since the recovery, rename or delete the corresponding database in the trial customers primary pool (11).</span></span> 
* <span data-ttu-id="6d2ee-195">Copie las bases de datos actualizadas desde el grupo de recuperación ante desastres al grupo principal (12).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-195">Copy the updated databases from the DR pool to the primary pool (12).</span></span> 
* <span data-ttu-id="6d2ee-196">Elimine el grupo de recuperación ante desastres (13).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-196">Delete the DR pool (13)</span></span> 

> [!NOTE]
> <span data-ttu-id="6d2ee-197">La operación de conmutación por error es asincrónica.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-197">The failover operation is asynchronous.</span></span> <span data-ttu-id="6d2ee-198">Para minimizar el tiempo de recuperación, es importante ejecutar comando de conmutación por error de las bases de datos de inquilino en lotes de al menos 20 bases de datos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-198">To minimize the recovery time it is important that you execute the tenant databases' failover command in batches of at least 20 databases.</span></span> 
> 
> 

<span data-ttu-id="6d2ee-199">La principal **ventaja** de esta estrategia es que proporciona el Acuerdo de Nivel de Servicio superior para los clientes de versiones de pago.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-199">The key **benefit** of this strategy is that it provides the highest SLA for the paying customers.</span></span> <span data-ttu-id="6d2ee-200">También garantiza que las nuevas versiones de prueba se desbloquean en cuanto se crea el grupo de recuperación ante desastres de versiones de prueba.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-200">It also guarantees that the new trials are unblocked as soon as the trial DR pool is created.</span></span> <span data-ttu-id="6d2ee-201">El **inconveniente** es que esta configuración aumentará el costo total de las bases de datos de inquilino debido al costo del grupo de recuperación ante desastres secundario para los clientes de versiones de pago.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-201">The **trade-off** is that this setup increases the total cost of the tenant databases by the cost of the secondary DR pool for paid customers.</span></span> <span data-ttu-id="6d2ee-202">Además, si el grupo secundario tiene un tamaño diferente, los clientes de versiones de pago experimentarán un rendimiento menor después de la conmutación por error hasta que se complete la actualización del grupo en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-202">In addition, if the secondary pool has a different size, the paying customers experience lower performance after failover until the pool upgrade in the DR region is completed.</span></span> 

## <a name="scenario-3-geographically-distributed-application-with-tiered-service"></a><span data-ttu-id="6d2ee-203">Escenario 3.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-203">Scenario 3.</span></span> <span data-ttu-id="6d2ee-204">Aplicación distribuida geográficamente con servicio en capas</span><span class="sxs-lookup"><span data-stu-id="6d2ee-204">Geographically distributed application with tiered service</span></span>
<span data-ttu-id="6d2ee-205"><i>Tengo una aplicación de SaaS desarrollada con ofertas de servicio en capas. Deseo ofrecer un contrato de nivel de servicio muy agresivo a mis clientes de versiones de pago y minimizar el riesgo de impacto cuando se produzcan interrupciones, porque incluso una breve interrupción puede causar la insatisfacción del cliente. Es fundamental que los clientes de versiones de pago siempre puedan acceder a sus datos. Las versiones de prueba son gratuitas y no se ofrece ningún Acuerdo de Nivel de Servicio durante el periodo de prueba. </i></span><span class="sxs-lookup"><span data-stu-id="6d2ee-205"><i>I have a mature SaaS application with tiered service offers. I want to offer a very aggressive SLA to my paid customers and minimize the risk of impact when outages occur because even brief interruption can cause customer dissatisfaction. It is critical that the paying customers can always access their data. The trials are free and an SLA is not offered during the trial period. </i></span></span> 

<span data-ttu-id="6d2ee-206">Para este escenario, use tres grupos elásticos independientes.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-206">To support this scenario, use three separate elastic pools.</span></span> <span data-ttu-id="6d2ee-207">Aprovisione dos grupos de igual tamaño con elevados eDTU por base de datos en dos regiones diferentes para contener las bases de datos de inquilino de clientes de versiones de pago.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-207">Provision two equal size pools with high eDTUs per database in two different regions to contain the paid customers' tenant databases.</span></span> <span data-ttu-id="6d2ee-208">El tercer grupo que contiene a los inquilinos de versiones de prueba tendría menores eDTU por base de datos y se puede aprovisionar en una de las dos regiones.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-208">The third pool containing the trial tenants can have lower eDTUs per database and be provisioned in one of the two regions.</span></span>

<span data-ttu-id="6d2ee-209">Para garantizar el menor tiempo de recuperación durante las interrupciones en las bases de datos de inquilino de los clientes de versiones de pago, deben replicarse geográficamente con el 50 % de las bases de datos principales en cada una de las dos regiones.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-209">To guarantee the lowest recovery time during outages, the paying customers' tenant databases are geo-replicated with 50% of the primary databases in each of the two regions.</span></span> <span data-ttu-id="6d2ee-210">De forma similar, cada región tiene el 50 % de las bases de datos secundarias.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-210">Similarly, each region has 50% of the secondary databases.</span></span> <span data-ttu-id="6d2ee-211">De este modo si una región está sin conexión, solo el 50 % de las bases de datos de los clientes de versiones de pago se ven afectados y tienen que realizar la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-211">This way, if a region is offline, only 50% of the paid customers' databases are impacted and have to fail over.</span></span> <span data-ttu-id="6d2ee-212">Las otras bases de datos permanecen intactas.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-212">The other databases remain intact.</span></span> <span data-ttu-id="6d2ee-213">Esta configuración se ilustra en el diagrama siguiente:</span><span class="sxs-lookup"><span data-stu-id="6d2ee-213">This configuration is illustrated in the following diagram:</span></span>

![Ilustración 4](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-7.png)

<span data-ttu-id="6d2ee-215">Al igual que en los escenarios anteriores, las bases de datos de administración están bastante activas, por tanto debe configurarlas como bases de datos únicas de replicación geográfica (1).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-215">As in the previous scenarios, the management databases are quite active so configure them as single geo-replicated databases (1).</span></span> <span data-ttu-id="6d2ee-216">Esto garantiza un rendimiento predecible para las nuevas suscripciones de cliente, actualizaciones del perfil y otras operaciones de administración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-216">This ensures the predictable performance of the new customer subscriptions, profile updates and other management operations.</span></span> <span data-ttu-id="6d2ee-217">La región A es la región primaria de las bases de datos de administración y la región B se usa para la recuperación de las bases de datos de administración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-217">Region A is the primary region for the management databases and the region B is used for recovery of the management databases.</span></span>

<span data-ttu-id="6d2ee-218">Las bases de datos de inquilino de los clientes de versiones de pago también se replicarán geográficamente pero las principales y secundarias se dividen entre la región A y la región B (2).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-218">The paying customers’ tenant databases are also geo-replicated but with primaries and secondaries split between region A and region B (2).</span></span> <span data-ttu-id="6d2ee-219">De este modo, las bases de datos principales de inquilino afectadas por la interrupción pueden conmutar por error a otra región y estar disponibles.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-219">This way, the tenant primary databases impacted by the outage can fail over to the other region and become available.</span></span> <span data-ttu-id="6d2ee-220">La otra mitad de las bases de datos de inquilino no se ve afectada.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-220">The other half of the tenant databases are not be impacted at all.</span></span> 

<span data-ttu-id="6d2ee-221">El siguiente diagrama ilustra los pasos de recuperación que hay que llevar a cabo si se produce una interrupción en la región A.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-221">The next diagram illustrates the recovery steps to take if  an outage occurs in region A.</span></span>

![Ilustración 5.](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-8.png)

* <span data-ttu-id="6d2ee-223">Realice inmediatamente una conmutación por error en las bases de datos de administración en la región B (3).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-223">Immediately fail over the management databases to region B (3).</span></span>
* <span data-ttu-id="6d2ee-224">Cambie la cadena de conexión de la aplicación para que señale a las bases de datos de administración de la región B. Modifique las bases de datos de administración para asegurarse de que las nuevas cuentas y bases de datos de inquilino se crearán en la región B y que las bases de datos de inquilino existentes se encontrarán allí también.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-224">Change the application’s connection string to point to the management databases in region B. Modify the management databases to make sure the new accounts and tenant databases are created in region B and the existing tenant databases are found there as well.</span></span> <span data-ttu-id="6d2ee-225">Los clientes de versiones de prueba existentes verán que sus datos no están disponibles temporalmente.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-225">The existing trial customers see their data temporarily unavailable.</span></span>
* <span data-ttu-id="6d2ee-226">Realice una conmutación por error en las bases de datos de inquilino de versiones de pago en el grupo 2 de la región B, para restaurar inmediatamente su disponibilidad (4).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-226">Fail over the paid tenant's databases to pool 2 in region B to immediately restore their availability (4).</span></span> <span data-ttu-id="6d2ee-227">Dado que la conmutación por error es un rápido cambio de nivel de metadatos, se puede considerar una optimización cuando se desencadenan las conmutaciones por error individuales a petición de las conexiones del usuario final.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-227">Since the failover is a quick metadata level change, you may consider an optimization where the individual failovers are triggered on demand by the end-user connections.</span></span> 
* <span data-ttu-id="6d2ee-228">Como ahora el grupo 2 contiene solo bases de datos principales, aumenta la carga de trabajo total del grupo, por lo que puede aumentar de inmediato su tamaño de eDTU (5).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-228">Since now pool 2 contains only primary databases, the total workload in the pool increases and can immediately increase its eDTU size (5).</span></span> 
* <span data-ttu-id="6d2ee-229">Cree el nuevo grupo elástico con el mismo nombre y la misma configuración en la región B para bases de datos de los clientes de versiones de prueba (6).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-229">Create the new elastic pool with the same name and the same configuration in the region B for the trial customers' databases (6).</span></span> 
* <span data-ttu-id="6d2ee-230">Una vez creado el grupo, puede usar la restauración geográfica para restaurar las bases de datos de inquilino de versiones de prueba individuales en el grupo (7).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-230">Once the pool is created use geo-restore to restore the individual trial tenant database into the pool (7).</span></span> <span data-ttu-id="6d2ee-231">Considere desencadenar las restauraciones individuales por las conexiones de los usuarios finales o utilizar algún otro esquema de prioridad específica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-231">You can consider triggering the individual restores by the end-user connections or use some other application-specific priority scheme.</span></span>

> [!NOTE]
> <span data-ttu-id="6d2ee-232">La operación de conmutación por error es asincrónica.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-232">The failover operation is asynchronous.</span></span> <span data-ttu-id="6d2ee-233">Para minimizar el tiempo de recuperación, es importante ejecutar el comando de conmutación por error de las bases de datos de inquilino en lotes de al menos 20 bases de datos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-233">To minimize the recovery time, it is important that you execute the tenant databases' failover command in batches of at least 20 databases.</span></span> 
> 

<span data-ttu-id="6d2ee-234">En este punto, la aplicación vuelve a estar en línea en la región B. Todos los clientes de versiones de pago tienen acceso a sus datos, mientras que los clientes de versiones de prueba experimentan una demora al acceder a los suyos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-234">At this point your application is back online in region B. All paying customers have access to their data while the trial customers experience delay when accessing their data.</span></span>

<span data-ttu-id="6d2ee-235">Cuando se recupera la región A, debe decidir si quiere usar la región B para clientes de versiones prueba o realizar una conmutación por recuperación mediante el grupo de clientes de versiones de prueba en la región A. Un criterio podría ser el porcentaje de bases de datos de inquilino de versiones de prueba modificadas desde la recuperación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-235">When region A is recovered you need to decide if you want to use region B for trial customers or failback to using the trial customers pool in region A. One criteria could be the % of trial tenant databases modified since the recovery.</span></span> <span data-ttu-id="6d2ee-236">Con independencia de esta decisión, debe volver a equilibrar los inquilinos de versiones de pago entre los dos grupos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-236">Regardless of that decision, you need to re-balance the paid tenants between two pools.</span></span> <span data-ttu-id="6d2ee-237">En el siguiente diagrama se muestra el proceso de la conmutación por recuperación de las bases de datos de inquilino de versiones de prueba en la región A.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-237">the next diagram illustrates the process when the trial tenant databases fail back to region A.</span></span>  

![Ilustración 6.](./media/sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool/diagram-9.png)

* <span data-ttu-id="6d2ee-239">Cancele todas las solicitudes de restauración geográfica pendientes en el grupo de recuperación ante desastres de versiones de prueba.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-239">Cancel all outstanding geo-restore requests to trial DR pool.</span></span>   
* <span data-ttu-id="6d2ee-240">Realice una conmutación por error en la base de datos de administración (8).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-240">Fail over the management database (8).</span></span> <span data-ttu-id="6d2ee-241">Después de la recuperación de la región, la región primaria anterior se convierte automáticamente en secundaria.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-241">After the region’s recovery, the old primary automatically became the secondary.</span></span> <span data-ttu-id="6d2ee-242">Ahora vuelve a convertir en principal.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-242">Now it becomes the primary again.</span></span>  
* <span data-ttu-id="6d2ee-243">Seleccione qué bases de datos de inquilino de versiones de pago producen una conmutación por recuperación en el grupo 1 e inicie la conmutación por error en sus secundarias (9).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-243">Select which paid tenant databases fail back to pool 1 and initiate failover to their secondaries (9).</span></span> <span data-ttu-id="6d2ee-244">Después de la recuperación de la región, todas las bases de datos del grupo 1 se convertirán automáticamente en secundarias.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-244">After the region’s recovery, all databases in pool 1 automatically became secondaries.</span></span> <span data-ttu-id="6d2ee-245">Ahora el 50 % volverán a ser principales.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-245">Now 50% of them become primaries again.</span></span> 
* <span data-ttu-id="6d2ee-246">Reduzca el tamaño del grupo 2 a la eDTU original (10).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-246">Reduce the size of pool 2 to the original eDTU (10).</span></span>
* <span data-ttu-id="6d2ee-247">Establezca todas las bases de datos de versiones de prueba restauradas de la región B en solo lectura (11).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-247">Set all restored trial databases in the region B to read-only (11).</span></span>
* <span data-ttu-id="6d2ee-248">Para las bases de datos del grupo de recuperación ante desastres de versiones de prueba que hayan cambiado desde la recuperación, cambie el nombre o elimine las bases de datos correspondientes del grupo principal (12).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-248">For each database in the trial DR pool that has changed since the recovery, rename or delete the corresponding database in the trial primary pool (12).</span></span> 
* <span data-ttu-id="6d2ee-249">Copie las bases de datos actualizadas desde el grupo de recuperación ante desastres al grupo principal (13).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-249">Copy the updated databases from the DR pool to the primary pool (13).</span></span> 
* <span data-ttu-id="6d2ee-250">Elimine el grupo de recuperación ante desastres (14).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-250">Delete the DR pool (14)</span></span> 

<span data-ttu-id="6d2ee-251">Las principales **ventajas** de esta estrategia son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="6d2ee-251">The key **benefits** of this strategy are:</span></span>

* <span data-ttu-id="6d2ee-252">Admite el contrato de nivel de servicio más agresivo para los clientes de versiones de pago porque garantiza que una interrupción no puede afectar a más del 50 % de las bases de datos de inquilino.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-252">It supports the most aggressive SLA for the paying customers because it ensures that an outage cannot impact more than 50% of the tenant databases.</span></span> 
* <span data-ttu-id="6d2ee-253">También garantiza que las nuevas versiones de prueba se desbloquean tan pronto se cree el grupo de recuperación ante desastres de versiones de prueba durante la recuperación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-253">It guarantees that the new trials are unblocked as soon as the trail DR pool is created during the recovery.</span></span> 
* <span data-ttu-id="6d2ee-254">Permite un uso más eficaz de la capacidad del grupo, ya que se garantiza que el 50 % de las bases de datos secundarias de los grupos 1 y 2 sean menos activas que las bases de datos principales.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-254">It allows more efficient use of the pool capacity as 50% of secondary databases in pool 1 and pool 2 are guaranteed to be less active than the primary databases.</span></span>

<span data-ttu-id="6d2ee-255">Las **contrapartidas** principales son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="6d2ee-255">The main **trade-offs** are:</span></span>

* <span data-ttu-id="6d2ee-256">Las operaciones de CRUD en las bases de datos de administración tienen una latencia menor para los usuarios finales conectados a la región A que para los usuarios finales conectados a la región B, ya que se ejecutan en la principal de las bases de datos de administración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-256">The CRUD operations against the management databases have lower latency for the end users connected to region A than for the end users connected to region B as they are executed against the primary of the management databases.</span></span>
* <span data-ttu-id="6d2ee-257">Requiere un diseño más complejo de la base de datos de administración.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-257">It requires more complex design of the management database.</span></span> <span data-ttu-id="6d2ee-258">Por ejemplo, cada registro de inquilinos tiene una etiqueta de ubicación que debe cambiarse durante la conmutación por error y la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-258">For example, each tenant record has a location tag that needs to be changed during failover and failback.</span></span>  
* <span data-ttu-id="6d2ee-259">Los clientes de versiones de pago pueden experimentar un rendimiento inferior al normal hasta que se complete la actualización de los grupos en la región B.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-259">The paying customers may experience lower performance than usual until the pool upgrade in region B is completed.</span></span> 

## <a name="summary"></a><span data-ttu-id="6d2ee-260">Resumen</span><span class="sxs-lookup"><span data-stu-id="6d2ee-260">Summary</span></span>
<span data-ttu-id="6d2ee-261">Este artículo se centra en las estrategias de recuperación ante desastres para el nivel de base de datos utilizado por una aplicación multiinquilino ISV de SaaS.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-261">This article focuses on the disaster recovery strategies for the database tier used by a SaaS ISV multi-tenant application.</span></span> <span data-ttu-id="6d2ee-262">La estrategia que seleccione debe basarse en las necesidades de la aplicación, como el modelo de negocio, el contrato de nivel de servicio que desea ofrecer a sus clientes, la restricción del presupuesto, entre otras. Cada estrategia descrita describe las ventajas y los inconvenientes para que pueda tomar una decisión informada.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-262">The strategy you choose is based on the needs of the application, such as the business model, the SLA you want to offer to your customers, budget constraint etc. Each described strategy outlines the benefits and trade-off so you could make an informed decision.</span></span> <span data-ttu-id="6d2ee-263">Además, la aplicación específica probablemente incluya otros componentes de Azure.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-263">Also, your specific application likely includes other Azure components.</span></span> <span data-ttu-id="6d2ee-264">Debe revisar las instrucciones de continuidad de negocio de los mismos y coordinar la recuperación de la capa de base de datos con ellos.</span><span class="sxs-lookup"><span data-stu-id="6d2ee-264">So you review their business continuity guidance and orchestrate the recovery of the database tier with them.</span></span> <span data-ttu-id="6d2ee-265">Para más información sobre la administración de la recuperación de aplicaciones de base de datos en Azure, consulte [Diseño de soluciones en la nube para la recuperación ante desastres](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-265">To learn more about managing recovery of database applications in Azure, refer to [Designing cloud solutions for disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>  

## <a name="next-steps"></a><span data-ttu-id="6d2ee-266">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="6d2ee-266">Next steps</span></span>
* <span data-ttu-id="6d2ee-267">Para saber en qué consisten las copias de seguridad automatizadas de Base de datos SQL de Azure, consulte [Información general: copias de seguridad automatizadas de Base de datos SQL](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-267">To learn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="6d2ee-268">Para obtener una descripción general y los escenarios de la continuidad empresarial, consulte [Información general sobre la continuidad empresarial](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-268">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md).</span></span>
* <span data-ttu-id="6d2ee-269">Si quiere saber cómo utilizar las copias de seguridad automatizadas para procesos de recuperación, consulte [Recover an Azure SQL database using automated database backups](sql-database-recovery-using-backups.md)(Recuperación de una base de datos SQL de Azure mediante copias de seguridad de base de datos automatizadas).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-269">To learn about using automated backups for recovery, see [restore a database from the service-initiated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="6d2ee-270">Para conocer las opciones de recuperación más rápidas, consulte [Replicación geográfica activa](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-270">To learn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md).</span></span>
* <span data-ttu-id="6d2ee-271">Si quiere aprender a utilizar las copias de seguridad automatizadas para procesos de archivado, consulte el procedimiento para [copiar una base de datos](sql-database-copy.md).</span><span class="sxs-lookup"><span data-stu-id="6d2ee-271">To learn about using automated backups for archiving, see [database copy](sql-database-copy.md).</span></span>

