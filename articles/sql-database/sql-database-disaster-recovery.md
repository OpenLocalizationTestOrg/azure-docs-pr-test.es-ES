---
title: "recuperación ante desastres de bases de datos aaaSQL | Documentos de Microsoft"
description: "Obtenga información acerca de cómo toorecover una base de datos de un centro de datos regional suministro o con Hola base de datos de SQL Azure la replicación geográfica activa y las capacidades de restauración geográfica."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 4800960e-3f9d-40ce-9e55-fb7f2784c067
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/14/2017
ms.author: sashan
ms.openlocfilehash: bae08485863067748107ec4808e52d8e88e2de0d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="restore-an-azure-sql-database-or-failover-tooa-secondary"></a><span data-ttu-id="1f50f-103">Restaurar tooa secundario para una base de datos de SQL Azure o conmutación por error</span><span class="sxs-lookup"><span data-stu-id="1f50f-103">Restore an Azure SQL Database or failover tooa secondary</span></span>
<span data-ttu-id="1f50f-104">La base de datos de SQL Azure ofrece Hola después de capacidades para recuperarse de una interrupción del servicio:</span><span class="sxs-lookup"><span data-stu-id="1f50f-104">Azure SQL Database offers hello following capabilities for recovering from an outage:</span></span>

* [<span data-ttu-id="1f50f-105">Replicación geográfica activa</span><span class="sxs-lookup"><span data-stu-id="1f50f-105">Active geo-replication</span></span>](sql-database-geo-replication-overview.md)
* [<span data-ttu-id="1f50f-106">Restauración geográfica</span><span class="sxs-lookup"><span data-stu-id="1f50f-106">Geo-restore</span></span>](sql-database-recovery-using-backups.md#point-in-time-restore)

<span data-ttu-id="1f50f-107">toolearn sobre escenarios de continuidad empresarial y características de hello compatibles con estos escenarios, vea [continuidad del negocio](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-107">toolearn about business continuity scenarios and hello features supporting these scenarios, see [Business continuity](sql-database-business-continuity.md).</span></span>

### <a name="prepare-for-hello-event-of-an-outage"></a><span data-ttu-id="1f50f-108">Preparar para eventos de Hola de una interrupción del servicio</span><span class="sxs-lookup"><span data-stu-id="1f50f-108">Prepare for hello event of an outage</span></span>
<span data-ttu-id="1f50f-109">Para lograr el éxito con la región de datos de recuperación tooanother con replicación geográfica activa o las copias de seguridad con redundancia geográfica, necesita tooprepare un servidor en otro datos center interrupción toobecome Hola nuevo servidor principal debe Hola necesita surgen así como tener pasos bien definidos probado y documentado tooensure una recuperación sin problemas.</span><span class="sxs-lookup"><span data-stu-id="1f50f-109">For success with recovery tooanother data region using either active geo-replication or geo-redundant backups, you need tooprepare a server in another data center outage toobecome hello new primary server should hello need arise as well as have well-defined steps documented and tested tooensure a smooth recovery.</span></span> <span data-ttu-id="1f50f-110">Estos son algunos de los pasos correspondientes a la fase de preparación:</span><span class="sxs-lookup"><span data-stu-id="1f50f-110">These preparation steps include:</span></span>

* <span data-ttu-id="1f50f-111">Identifique el servidor lógico de hello en otra región toobecome Hola nuevo servidor principal.</span><span class="sxs-lookup"><span data-stu-id="1f50f-111">Identify hello logical server in another region toobecome hello new primary server.</span></span> <span data-ttu-id="1f50f-112">Con la replicación geográfica activa, esta será al menos uno y quizás cada uno de los servidores secundarios de Hola.</span><span class="sxs-lookup"><span data-stu-id="1f50f-112">With active geo-replication, this will be at least one and perhaps each of hello secondary servers.</span></span> <span data-ttu-id="1f50f-113">Para la restauración geográfica, esto suele ser un servidor en hello [región emparejada](../best-practices-availability-paired-regions.md) de región de hello en el que se encuentra la base de datos.</span><span class="sxs-lookup"><span data-stu-id="1f50f-113">For geo-restore, this will generally be a server in hello [paired region](../best-practices-availability-paired-regions.md) for hello region in which your database is located.</span></span>
* <span data-ttu-id="1f50f-114">Identificar y, opcionalmente, definir, las reglas de firewall de nivel de servidor de hello necesarios en los usuarios tooaccess Hola nueva base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="1f50f-114">Identify, and optionally define, hello server-level firewall rules needed on for users tooaccess hello new primary database.</span></span>
* <span data-ttu-id="1f50f-115">Determinar cómo se van tooredirect usuarios toohello nuevo servidor principal, como cambiar las cadenas de conexión o cambiando las entradas de DNS.</span><span class="sxs-lookup"><span data-stu-id="1f50f-115">Determine how you are going tooredirect users toohello new primary server, such as by changing connection strings or by changing DNS entries.</span></span>
* <span data-ttu-id="1f50f-116">Identificar y, opcionalmente, crear, Hola inicios de sesión que deben estar presente en la base de datos maestra de hello en el nuevo servidor principal de Hola y asegúrese de que estos inicios de sesión tienen los permisos adecuados en la base de datos maestra de hello, si lo hay.</span><span class="sxs-lookup"><span data-stu-id="1f50f-116">Identify, and optionally create, hello logins that must be present in hello master database on hello new primary server, and ensure these logins have appropriate permissions in hello master database, if any.</span></span> <span data-ttu-id="1f50f-117">Para obtener más información, consulte [Administración de la seguridad de Base de datos SQL de Azure después de la recuperación ante desastres](sql-database-geo-replication-security-config.md)</span><span class="sxs-lookup"><span data-stu-id="1f50f-117">For more information, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md)</span></span>
* <span data-ttu-id="1f50f-118">Identificar las reglas de alerta que necesitan toobe toomap actualizada toohello nueva base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="1f50f-118">Identify alert rules that will need toobe updated toomap toohello new primary database.</span></span>
* <span data-ttu-id="1f50f-119">Configuración de auditoría de Hola de documento en la base de datos principal Hola actual</span><span class="sxs-lookup"><span data-stu-id="1f50f-119">Document hello auditing configuration on hello current primary database</span></span>
* <span data-ttu-id="1f50f-120">Realice [maniobras de recuperación ante desastres](sql-database-disaster-recovery-drills.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-120">Perform a [disaster recovery drill](sql-database-disaster-recovery-drills.md).</span></span> <span data-ttu-id="1f50f-121">toosimulate una interrupción para la restauración geográfica, puede eliminar o cambiar el nombre de error de conectividad de la aplicación de toocause de hello origen base de datos.</span><span class="sxs-lookup"><span data-stu-id="1f50f-121">toosimulate an outage for geo-restore, you can delete or rename hello source database toocause application connectivity failure.</span></span> <span data-ttu-id="1f50f-122">toosimulate una interrupción del servicio de replicación geográfica activa, puede deshabilitar aplicación de hello web o máquina virtual conectada toohello base de datos o de conmutación por error Hola base de datos toocause conectividad errores de aplicación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-122">toosimulate an outage for active geo-replication, you can disable hello web application or virtual machine connected toohello database or failover hello database toocause application connectivity failures.</span></span>

## <a name="when-tooinitiate-recovery"></a><span data-ttu-id="1f50f-123">Cuando tooinitiate recuperación</span><span class="sxs-lookup"><span data-stu-id="1f50f-123">When tooinitiate recovery</span></span>
<span data-ttu-id="1f50f-124">operación de recuperación de Hello afecta aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="1f50f-124">hello recovery operation impacts hello application.</span></span> <span data-ttu-id="1f50f-125">Es necesario cambiar la cadena de conexión de SQL de Hola o redirección con DNS y dar lugar a pérdida de datos permanente.</span><span class="sxs-lookup"><span data-stu-id="1f50f-125">It requires changing hello SQL connection string or redirection using DNS and could result in permanent data loss.</span></span> <span data-ttu-id="1f50f-126">Por lo tanto, debe realizarse solo una vez interrupción hello toolast es probable que más de objetivo de tiempo de recuperación de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-126">Therefore, it should be done only when hello outage is likely toolast longer than your application's recovery time objective.</span></span> <span data-ttu-id="1f50f-127">Una vez hello aplicación tooproduction implementado debe realizar la supervisión regular de estado de la aplicación hello y usar hello es garantizar la sobresuscripción tooassert puntos que Hola de recuperación de datos siguientes:</span><span class="sxs-lookup"><span data-stu-id="1f50f-127">When hello application is deployed tooproduction you should perform regular monitoring of hello application health and use hello following data points tooassert that hello recovery is warranted:</span></span>

1. <span data-ttu-id="1f50f-128">Error de conectividad permanente de base de datos toohello capa de aplicación de Hola.</span><span class="sxs-lookup"><span data-stu-id="1f50f-128">Permanent connectivity failure from hello application tier toohello database.</span></span>
2. <span data-ttu-id="1f50f-129">Hola portal de Azure, muestra una alerta sobre un incidente en la región de hello con gran impacto.</span><span class="sxs-lookup"><span data-stu-id="1f50f-129">hello Azure portal shows an alert about an incident in hello region with broad impact.</span></span>
3. <span data-ttu-id="1f50f-130">servidor de base de datos de SQL Azure de Hello está marcado como degradado.</span><span class="sxs-lookup"><span data-stu-id="1f50f-130">hello Azure SQL Database server is marked as degraded.</span></span>

<span data-ttu-id="1f50f-131">Dependiendo de su responsabilidad de negocio de toodowntime y posibles de tolerancia de aplicación puede considerar Hola siguientes opciones de recuperación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-131">Depending on your application tolerance toodowntime and possible business liability you can consider hello following recovery options.</span></span>

<span data-ttu-id="1f50f-132">Hola de uso [obtener base de datos recuperable](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) punto de restauración de replicación geográfica más reciente de tooget Hola.</span><span class="sxs-lookup"><span data-stu-id="1f50f-132">Use hello [Get Recoverable Database](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) tooget hello latest Geo-replicated restore point.</span></span>

## <a name="wait-for-service-recovery"></a><span data-ttu-id="1f50f-133">Espera para la recuperación del servicio</span><span class="sxs-lookup"><span data-stu-id="1f50f-133">Wait for service recovery</span></span>
<span data-ttu-id="1f50f-134">Hello Azure los equipos trabajan minuciosamente toorestore disponibilidad del servicio tal y como rápidamente como sea posible, pero dependiendo de la causa raíz de hello puede tardar horas o días.</span><span class="sxs-lookup"><span data-stu-id="1f50f-134">hello Azure teams work diligently toorestore service availability as quickly as possible but depending on hello root cause it can take hours or days.</span></span>  <span data-ttu-id="1f50f-135">Si su aplicación tolera mucho tiempo de inactividad puede esperar simplemente hello toocomplete de recuperación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-135">If your application can tolerate significant downtime you can simply wait for hello recovery toocomplete.</span></span> <span data-ttu-id="1f50f-136">En este caso, no se requieren acciones por su parte.</span><span class="sxs-lookup"><span data-stu-id="1f50f-136">In this case, no action on your part is required.</span></span> <span data-ttu-id="1f50f-137">Puede ver el estado actual del servicio hello en nuestro [panel de estado del servicio de Azure](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="1f50f-137">You can see hello current service status on our [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span> <span data-ttu-id="1f50f-138">Después de la recuperación de Hola de región de Hola se restaurará la disponibilidad de su aplicación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-138">After hello recovery of hello region your application’s availability will be restored.</span></span>

## <a name="fail-over-toogeo-replicated-secondary-database"></a><span data-ttu-id="1f50f-139">Conmutar por error toogeo con replicación de base de datos secundaria</span><span class="sxs-lookup"><span data-stu-id="1f50f-139">Fail over toogeo-replicated secondary database</span></span>
<span data-ttu-id="1f50f-140">Si el tiempo de inactividad de la aplicación puede dar lugar a responsabilidades civiles, debería utilizar bases de datos con replicación geográfica en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-140">If your application’s downtime can result in business liability you should be using geo-replicated database(s) in your application.</span></span> <span data-ttu-id="1f50f-141">Se habilitará la disponibilidad de restauración tooquickly hello las aplicaciones en una región distinta en el caso de una interrupción.</span><span class="sxs-lookup"><span data-stu-id="1f50f-141">It will enable hello application tooquickly restore availability in a different region in case of an outage.</span></span> <span data-ttu-id="1f50f-142">Obtenga información acerca de cómo demasiado[configurar la replicación geográfica](sql-database-geo-replication-portal.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-142">Learn how too[configure geo-replication](sql-database-geo-replication-portal.md).</span></span>

<span data-ttu-id="1f50f-143">disponibilidad de toorestore del programa Hola a bases de datos necesita tooinitiate Hola mediante uno de los métodos de hello admitida la conmutación por error toohello replicación geográfica secundaria.</span><span class="sxs-lookup"><span data-stu-id="1f50f-143">toorestore availability of hello database(s) you need tooinitiate hello failover toohello geo-replicated secondary using one of hello supported methods.</span></span>

<span data-ttu-id="1f50f-144">Use uno de hello siguiendo guías toofail a través de la base de datos de tooa replicación geográfica secundaria:</span><span class="sxs-lookup"><span data-stu-id="1f50f-144">Use one of hello following guides toofail over tooa geo-replicated secondary database:</span></span>

* [<span data-ttu-id="1f50f-145">Conmutar por error tooa georreplicadas base de datos secundaria mediante el Portal de Azure</span><span class="sxs-lookup"><span data-stu-id="1f50f-145">Fail over tooa geo-replicated secondary using Azure Portal</span></span>](sql-database-geo-replication-portal.md)
* [<span data-ttu-id="1f50f-146">Conmutar por error tooa replicación geográfica secundaria mediante PowerShell</span><span class="sxs-lookup"><span data-stu-id="1f50f-146">Fail over tooa geo-replicated secondary using PowerShell</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
* [<span data-ttu-id="1f50f-147">Conmutar por error tooa georreplicadas base de datos secundaria mediante T-SQL</span><span class="sxs-lookup"><span data-stu-id="1f50f-147">Fail over tooa geo-replicated secondary using T-SQL</span></span>](sql-database-geo-replication-transact-sql.md)

## <a name="recover-using-geo-restore"></a><span data-ttu-id="1f50f-148">Recuperación mediante la restauración geográfica</span><span class="sxs-lookup"><span data-stu-id="1f50f-148">Recover using geo-restore</span></span>
<span data-ttu-id="1f50f-149">Si el tiempo de inactividad de la aplicación no da como resultado la responsabilidad de negocio puede usar [georestauración](sql-database-recovery-using-backups.md) como un método toorecover las bases de datos de aplicación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-149">If your application’s downtime does not result in business liability you can use [geo-restore](sql-database-recovery-using-backups.md) as a method toorecover your application database(s).</span></span> <span data-ttu-id="1f50f-150">Crea una copia de base de datos de Hola desde su última copia de seguridad con redundancia geográfica.</span><span class="sxs-lookup"><span data-stu-id="1f50f-150">It creates a copy of hello database from its latest geo-redundant backup.</span></span>

## <a name="configure-your-database-after-recovery"></a><span data-ttu-id="1f50f-151">Configuración de la base de datos después de realizar la recuperación</span><span class="sxs-lookup"><span data-stu-id="1f50f-151">Configure your database after recovery</span></span>
<span data-ttu-id="1f50f-152">Si usas conmutación por error de replicación geográfica o la restauración geográfica toorecover desde una interrupción, debe asegurarse de que Hola conectividad toohello nuevas bases de datos está configurado correctamente para que se puede reanudar la función de aplicación normal de hello.</span><span class="sxs-lookup"><span data-stu-id="1f50f-152">If you are using either geo-replication failover or geo-restore toorecover from an outage, you must make sure that hello connectivity toohello new databases is properly configured so that hello normal application function can be resumed.</span></span> <span data-ttu-id="1f50f-153">Esto es una lista de comprobación de tareas tooget listos para la producción de base de datos recuperada.</span><span class="sxs-lookup"><span data-stu-id="1f50f-153">This is a checklist of tasks tooget your recovered database production ready.</span></span>

### <a name="update-connection-strings"></a><span data-ttu-id="1f50f-154">Actualización de cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="1f50f-154">Update connection strings</span></span>
<span data-ttu-id="1f50f-155">Dado que la base de datos recuperada residen en un servidor diferente, deberá tooupdate servidor toothat toopoint cadena de conexión a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1f50f-155">Because your recovered database will reside in a different server, you need tooupdate your application’s connection string toopoint toothat server.</span></span>

<span data-ttu-id="1f50f-156">Para obtener más información acerca de cómo cambiar las cadenas de conexión, vea el lenguaje de desarrollo adecuada de Hola para su [biblioteca de conexiones de](sql-database-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-156">For more information about changing connection strings, see hello appropriate development language for your [connection library](sql-database-libraries.md).</span></span>

### <a name="configure-firewall-rules"></a><span data-ttu-id="1f50f-157">Configuración de las reglas del firewall</span><span class="sxs-lookup"><span data-stu-id="1f50f-157">Configure Firewall Rules</span></span>
<span data-ttu-id="1f50f-158">Necesita toomake Asegúrese de que las reglas de firewall de hello configurado en servidor y en la coincidencia de la base de datos de hello aquellos que se han configurado en el servidor principal de Hola y base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="1f50f-158">You need toomake sure that hello firewall rules configured on server and on hello database match those that were configured on hello primary server and primary database.</span></span> <span data-ttu-id="1f50f-159">Para obtener más información, consulte [Configuración del firewall (Base de datos SQL de Azure)](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-159">For more information, see [How to: Configure Firewall Settings (Azure SQL Database)](sql-database-configure-firewall-settings.md).</span></span>

### <a name="configure-logins-and-database-users"></a><span data-ttu-id="1f50f-160">Configuración de inicios de sesión de y de usuarios de la base de datos</span><span class="sxs-lookup"><span data-stu-id="1f50f-160">Configure logins and database users</span></span>
<span data-ttu-id="1f50f-161">Necesita toomake seguro de que todos los inicios de sesión de hello utilizados por la aplicación existen en el servidor de Hola que hospeda la base de datos recuperada.</span><span class="sxs-lookup"><span data-stu-id="1f50f-161">You need toomake sure that all hello logins used by your application exist on hello server which is hosting your recovered database.</span></span> <span data-ttu-id="1f50f-162">Para obtener más información, consulte [Configuración de seguridad para Replicación geográfica activa o estándar](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-162">For more information, see [Security Configuration for geo-replication](sql-database-geo-replication-security-config.md).</span></span>

> [!NOTE]
> <span data-ttu-id="1f50f-163">Debe configurar y probar las reglas de firewall del servidor y los inicios de sesión (y sus permisos) durante una maniobra de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="1f50f-163">You should configure and test your server firewall rules and logins (and their permissions) during a disaster recovery drill.</span></span> <span data-ttu-id="1f50f-164">Estos objetos de nivel de servidor y su configuración no estén disponibles durante la interrupción de Hola.</span><span class="sxs-lookup"><span data-stu-id="1f50f-164">These server-level objects and their configuration may not be available during hello outage.</span></span>
> 
> 

### <a name="setup-telemetry-alerts"></a><span data-ttu-id="1f50f-165">Configuración de alertas de telemetría</span><span class="sxs-lookup"><span data-stu-id="1f50f-165">Setup telemetry alerts</span></span>
<span data-ttu-id="1f50f-166">Debe toomake que la configuración de regla de alerta existente estén actualizados toomap toohello recuperado hello y base de datos de otro servidor.</span><span class="sxs-lookup"><span data-stu-id="1f50f-166">You need toomake sure your existing alert rule settings are updated toomap toohello recovered database and hello different server.</span></span>

<span data-ttu-id="1f50f-167">Para obtener más información sobre las reglas de alerta de las bases de datos, consulte [Recibir notificaciones de alerta](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) y [Realización de seguimiento del estado](../monitoring-and-diagnostics/insights-service-health.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-167">For more information about database alert rules, see [Receive Alert Notifications](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) and [Track Service Health](../monitoring-and-diagnostics/insights-service-health.md).</span></span>

### <a name="enable-auditing"></a><span data-ttu-id="1f50f-168">Habilitar auditoría</span><span class="sxs-lookup"><span data-stu-id="1f50f-168">Enable auditing</span></span>
<span data-ttu-id="1f50f-169">Si la auditoría está tooaccess requiere la base de datos, necesita tooenable auditoría después de una recuperación de base de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="1f50f-169">If auditing is required tooaccess your database, you need tooenable Auditing after hello database recovery.</span></span> <span data-ttu-id="1f50f-170">Para obtener más información, consulte [este artículo sobre la realización de auditorías en las bases de datos](sql-database-auditing.md).</span><span class="sxs-lookup"><span data-stu-id="1f50f-170">For more information, see [Database auditing](sql-database-auditing.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1f50f-171">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="1f50f-171">Next steps</span></span>
* <span data-ttu-id="1f50f-172">toolearn acerca de las copias de seguridad de base de datos de SQL de Azure automatizada, vea [copias de seguridad automáticas de base de datos SQL](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="1f50f-172">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="1f50f-173">toolearn sobre escenarios de recuperación y diseño de continuidad de negocio, vea [escenarios de continuidad](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="1f50f-173">toolearn about business continuity design and recovery scenarios, see [Continuity scenarios](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="1f50f-174">toolearn sobre el uso de copias de seguridad automatizadas para la recuperación, vea [restaurar una base de datos de copias de seguridad de hello iniciadas por el servicio](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="1f50f-174">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>

