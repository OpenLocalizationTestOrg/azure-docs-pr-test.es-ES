---
title: "Actualización a la última biblioteca de cliente de base de datos elástica | Microsoft Docs"
description: "Actualización de aplicaciones y bibliotecas mediante NuGet"
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 0a546510-76e7-465e-9271-f15ff0cfa959
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/06/2017
ms.author: ddove
ms.openlocfilehash: 7e28d128645e856c0efa6e4f78d8f9f36982a76c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="upgrade-an-app-to-use-the-latest-elastic-database-client-library"></a><span data-ttu-id="2964b-103">Actualización de una aplicación para usar la biblioteca de cliente de base de datos elástica más reciente</span><span class="sxs-lookup"><span data-stu-id="2964b-103">Upgrade an app to use the latest elastic database client library</span></span>
<span data-ttu-id="2964b-104">Las nuevas versiones de la [biblioteca de clientes de Elastic Database](sql-database-elastic-database-client-library.md) están disponibles a través de NuGet y de la interfaz del Administrador de paquetes NuGet en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2964b-104">New versions of the [Elastic Database client library](sql-database-elastic-database-client-library.md) are  available through NuGetand the NuGetPackage Manager interface in Visual Studio.</span></span> <span data-ttu-id="2964b-105">Las actualizaciones contienen correcciones de errores y compatibilidad para nuevas capacidades de la biblioteca de clientes.</span><span class="sxs-lookup"><span data-stu-id="2964b-105">Upgrades contain bug fixes and support for new capabilities of the client library.</span></span>

<span data-ttu-id="2964b-106">**Para obtener la última versión** : vaya a [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/).</span><span class="sxs-lookup"><span data-stu-id="2964b-106">**For the latest version:** Go to [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/).</span></span>

<span data-ttu-id="2964b-107">Vuelve a generar la aplicación con la nueva biblioteca, así como cambiar los metadatos de administrador de asignación de particiones existentes almacenados en sus bases de datos SQL de Azure para admitir nuevas características.</span><span class="sxs-lookup"><span data-stu-id="2964b-107">Rebuild your application with the new library, as well as change your existing Shard Map Manager metadata stored in your Azure SQL Databases to support new features.</span></span>

<span data-ttu-id="2964b-108">Al realizar estos pasos de actualización en orden se asegura de que las versiones anteriores de la biblioteca de cliente ya no está presentes en el entorno cuando se actualizan los objetos de metadatos, lo que significa que no se crearán objetos de metadatos de la antigua versión después de la actualización.</span><span class="sxs-lookup"><span data-stu-id="2964b-108">Performing these steps in order ensures that old versions of the client library are no longer present in your environment when metadata objects are updated, which means that old-version metadata objects won’t be created after upgrade.</span></span>   

## <a name="upgrade-steps"></a><span data-ttu-id="2964b-109">Pasos de actualización</span><span class="sxs-lookup"><span data-stu-id="2964b-109">Upgrade steps</span></span>
<span data-ttu-id="2964b-110">**1. Actualice sus aplicaciones.**</span><span class="sxs-lookup"><span data-stu-id="2964b-110">**1. Upgrade your applications.**</span></span> <span data-ttu-id="2964b-111">En Visual Studio, descargue y haga referencia a la versión más reciente de la biblioteca de clientes en todos los proyectos de desarrollo que usan la biblioteca; a continuación, vuelva a compilar e implementar.</span><span class="sxs-lookup"><span data-stu-id="2964b-111">In Visual Studio, download and reference the latest client library version into all of your development projects that use the library; then rebuild and deploy.</span></span> 

* <span data-ttu-id="2964b-112">En la solución de Visual Studio, seleccione **Herramientas** --> **Administrador de paquetes NuGet** -->  **Administrar paquetes NuGet para la solución**.</span><span class="sxs-lookup"><span data-stu-id="2964b-112">In your Visual Studio solution, select **Tools** --> **NuGet Package Manager** -->  **Manage NuGet Packages for Solution**.</span></span> 
* <span data-ttu-id="2964b-113">(Visual Studio 2013) En el panel izquierdo, seleccione **Actualizaciones** y, a continuación, seleccione el botón **Actualizar** en el paquete **Azure SQL Database Elastic Scale Client Library** (Biblioteca de clientes de escala elástica de Azure SQL Database) que aparece en la ventana.</span><span class="sxs-lookup"><span data-stu-id="2964b-113">(Visual Studio 2013) In the left panel, select **Updates**, and then select the **Update** button on the package **Azure SQL Database Elastic Scale Client Library** that appears in the window.</span></span>
* <span data-ttu-id="2964b-114">(Visual Studio 2015) Establezca el cuadro de filtro en **Actualización disponible**.</span><span class="sxs-lookup"><span data-stu-id="2964b-114">(Visual Studio 2015) Set the Filter box to **Upgrade available**.</span></span> <span data-ttu-id="2964b-115">Seleccione el paquete que quiera actualizar y haga clic en el botón **Actualizar** .</span><span class="sxs-lookup"><span data-stu-id="2964b-115">Select the package to update, and click the **Update** button.</span></span>
* <span data-ttu-id="2964b-116">(Visual Studio 2017) En la parte superior del cuadro de diálogo, seleccione **Actualizaciones**.</span><span class="sxs-lookup"><span data-stu-id="2964b-116">(Visual Studio 2017) At the top of the dialog, select **Updates**.</span></span> <span data-ttu-id="2964b-117">Seleccione el paquete que quiera actualizar y haga clic en el botón **Actualizar** .</span><span class="sxs-lookup"><span data-stu-id="2964b-117">Select the package to update, and click the **Update** button.</span></span>
* <span data-ttu-id="2964b-118">Genere e implemente.</span><span class="sxs-lookup"><span data-stu-id="2964b-118">Build and Deploy.</span></span> 

<span data-ttu-id="2964b-119">**2. Actualice los scripts.**</span><span class="sxs-lookup"><span data-stu-id="2964b-119">**2. Upgrade your scripts.**</span></span> <span data-ttu-id="2964b-120">Si está utilizando scripts de **PowerShell** para administrar particiones, [descargue la nueva versión de la biblioteca](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/) y cópiela en el directorio desde el que ejecuta los scripts.</span><span class="sxs-lookup"><span data-stu-id="2964b-120">If you are using **PowerShell** scripts to manage shards, [download the new library version](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/) and copy it into the directory from which you execute scripts.</span></span> 

<span data-ttu-id="2964b-121">**3. Actualice el servicio de división y combinación.**</span><span class="sxs-lookup"><span data-stu-id="2964b-121">**3. Upgrade your split-merge service.**</span></span> <span data-ttu-id="2964b-122">Si usa la herramienta de división y combinación de la base de datos elástica para reorganizar datos particionados, [descargue e implemente la versión más reciente de la herramienta](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/).</span><span class="sxs-lookup"><span data-stu-id="2964b-122">If you use the elastic database split-merge tool to reorganize sharded data, [download and deploy the latest version of the tool](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/).</span></span> <span data-ttu-id="2964b-123">Encontrará pasos detallados para la actualización del servicio [aquí](sql-database-elastic-scale-overview-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="2964b-123">Detailed upgrade steps for the Service can be found [here](sql-database-elastic-scale-overview-split-and-merge.md).</span></span> 

<span data-ttu-id="2964b-124">**4. Actualice las bases de datos de Shard Map Manager**.</span><span class="sxs-lookup"><span data-stu-id="2964b-124">**4. Upgrade your Shard Map Manager databases**.</span></span> <span data-ttu-id="2964b-125">Actualice los metadatos compatibles con sus asignaciones de partición en la base de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="2964b-125">Upgrade the metadata supporting your Shard Maps in Azure SQL Database.</span></span>  <span data-ttu-id="2964b-126">Hay dos maneras de hacerlo, mediante PowerShell o C#.</span><span class="sxs-lookup"><span data-stu-id="2964b-126">There are two ways you can accomplish this, using PowerShell or C#.</span></span> <span data-ttu-id="2964b-127">Ambas opciones se muestran a continuación.</span><span class="sxs-lookup"><span data-stu-id="2964b-127">Both options are shown below.</span></span>

<span data-ttu-id="2964b-128">***Opción 1: actualizar los metadatos mediante PowerShell***</span><span class="sxs-lookup"><span data-stu-id="2964b-128">***Option 1: Upgrade metadata using PowerShell***</span></span>

1. <span data-ttu-id="2964b-129">Descargue la utilidad de línea de comandos más reciente de NuGet desde [aquí](http://nuget.org/nuget.exe) y guárdela en una carpeta.</span><span class="sxs-lookup"><span data-stu-id="2964b-129">Download the latest command-line utility for NuGet from [here](http://nuget.org/nuget.exe) and save to a folder.</span></span> 
2. <span data-ttu-id="2964b-130">Abra un símbolo del sistema, navegue a la misma carpeta y emita el comando: `nuget install Microsoft.Azure.SqlDatabase.ElasticScale.Client`</span><span class="sxs-lookup"><span data-stu-id="2964b-130">Open a Command Prompt, navigate to the same folder, and issue the command: `nuget install Microsoft.Azure.SqlDatabase.ElasticScale.Client`</span></span>
3. <span data-ttu-id="2964b-131">Vaya a la subcarpeta que contiene la nueva versión DLL de cliente que acaba de descargar, por ejemplo: `cd .\Microsoft.Azure.SqlDatabase.ElasticScale.Client.1.0.0\lib\net45`</span><span class="sxs-lookup"><span data-stu-id="2964b-131">Navigate to the subfolder containing the new client DLL version you have just downloaded, for example: `cd .\Microsoft.Azure.SqlDatabase.ElasticScale.Client.1.0.0\lib\net45`</span></span>
4. <span data-ttu-id="2964b-132">Descargue el scriptlet de actualización del cliente de base de datos elástica del [Centro de scripts](https://gallery.technet.microsoft.com/scriptcenter/Azure-SQL-Database-Elastic-6442e6a9)y guárdelo en la misma carpeta que contiene el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="2964b-132">Download the elastic database client upgrade scriptlet from the [Script Center](https://gallery.technet.microsoft.com/scriptcenter/Azure-SQL-Database-Elastic-6442e6a9), and save it into the same folder containing the DLL.</span></span>
5. <span data-ttu-id="2964b-133">Desde esa carpeta, ejecute “PowerShell .\upgrade.ps1” desde el símbolo del sistema y siga las indicaciones.</span><span class="sxs-lookup"><span data-stu-id="2964b-133">From that folder, run “PowerShell .\upgrade.ps1” from the command prompt and follow the prompts.</span></span>

<span data-ttu-id="2964b-134">***Opción 2: actualizar los metadatos mediante C#***</span><span class="sxs-lookup"><span data-stu-id="2964b-134">***Option 2: Upgrade metadata using C#***</span></span>

<span data-ttu-id="2964b-135">De forma alternativa, puede crear una aplicación de Visual Studio que abra ShardMapManager, recorra en iteración todas las particiones y realice la actualización de metadatos mediante una llamada a los métodos [UpgradeLocalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradelocalstore.aspx) y [UpgradeGlobalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradeglobalstore.aspx), como en este ejemplo:</span><span class="sxs-lookup"><span data-stu-id="2964b-135">Alternatively, create a Visual Studio application that opens your ShardMapManager, iterates over all shards, and performs the metadata upgrade by calling the methods [UpgradeLocalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradelocalstore.aspx) and [UpgradeGlobalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradeglobalstore.aspx) as in this example:</span></span> 

    ShardMapManager smm =
       ShardMapManagerFactory.GetSqlShardMapManager
       (connStr, ShardMapManagerLoadPolicy.Lazy); 
    smm.UpgradeGlobalStore(); 

    foreach (ShardLocation loc in
     smm.GetDistinctShardLocations()) 
    {   
       smm.UpgradeLocalStore(loc); 
    } 

<span data-ttu-id="2964b-136">Estas técnicas para las actualizaciones de metadatos se pueden aplicar varias veces sin problema.</span><span class="sxs-lookup"><span data-stu-id="2964b-136">These techniques for metadata upgrades can be applied multiple times without harm.</span></span> <span data-ttu-id="2964b-137">Por ejemplo, si una versión anterior del cliente crea sin darse cuenta una partición después de haber actualizado, puede ejecutar la actualización de nuevo en todas las particiones para asegurarse de que la última versión de metadatos está presente en toda su infraestructura.</span><span class="sxs-lookup"><span data-stu-id="2964b-137">For example, if an older client version inadvertently creates a shard after you have already updated, you can run upgrade again across all shards to ensure that the latest metadata version is present throughout your infrastructure.</span></span> 

<span data-ttu-id="2964b-138">**Nota:** las nuevas versiones de la biblioteca de clientes publicadas hasta la fecha seguirán funcionando con versiones anteriores de los metadatos de Shard Map Manager en Azure SQL DB, y viceversa.</span><span class="sxs-lookup"><span data-stu-id="2964b-138">**Note:**  New versions of the client library published to-date continue to work with prior versions of the Shard Map Manager metadata on Azure SQL DB, and vice-versa.</span></span>   <span data-ttu-id="2964b-139">Sin embargo, para aprovechar algunas de las nuevas características en el cliente más reciente, es necesario actualizar los metadatos.</span><span class="sxs-lookup"><span data-stu-id="2964b-139">However to take advantage of some of the new features in the latest client, metadata needs to be upgraded.</span></span>   <span data-ttu-id="2964b-140">Tenga en cuenta que las actualizaciones de metadatos no afectarán a los datos de usuario ni los datos específicos de la aplicación, solo a los objetos creados y utilizados por el Administrador de mapa de particiones.</span><span class="sxs-lookup"><span data-stu-id="2964b-140">Note that metadata upgrades will not affect any user-data or application-specific data, only objects created and used by the Shard Map Manager.</span></span>  <span data-ttu-id="2964b-141">Las aplicaciones seguirán funcionando a través de la secuencia de actualización que se ha descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="2964b-141">And applications continue to operate through the upgrade sequence described above.</span></span> 

## <a name="elastic-database-client-version-history"></a><span data-ttu-id="2964b-142">Historial de versiones de cliente de base de datos elástica</span><span class="sxs-lookup"><span data-stu-id="2964b-142">Elastic database client version history</span></span>
<span data-ttu-id="2964b-143">Para el historial de versiones: vaya a [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/)</span><span class="sxs-lookup"><span data-stu-id="2964b-143">For version history, go to [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/)</span></span>

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Image references-->
[1]:./media/sql-database-elastic-scale-upgrade-client-library/nuget-upgrade.png

