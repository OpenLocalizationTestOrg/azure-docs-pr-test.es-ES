---
title: "aaaProvision nuevos inquilinos en una aplicación de varios inquilinos que usa la base de datos de SQL de Azure | Documentos de Microsoft"
description: "Obtenga información acerca de cómo tooprovision y catálogo de nuevo los inquilinos Hola aplicación Wingtip SaaS"
keywords: tutorial de SQL Database
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: sstein
ms.openlocfilehash: eb26f523305650c2124e36707d187dfcdad06fcc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="provision-new-tenants-and-register-them-in-hello-catalog"></a><span data-ttu-id="87399-104">Aprovisionar nuevos inquilinos y registrarlos en el catálogo de Hola</span><span class="sxs-lookup"><span data-stu-id="87399-104">Provision new tenants and register them in hello catalog</span></span>

<span data-ttu-id="87399-105">En este tutorial, aprenderá sobre aprovisionar hello y patrones de SaaS de catálogo y cómo se implementan en hello aplicación SaaS Wingtip.</span><span class="sxs-lookup"><span data-stu-id="87399-105">In this tutorial, you learn about hello provision and catalog SaaS patterns, and how they are implemented in hello Wingtip SaaS application.</span></span> <span data-ttu-id="87399-106">Crear, inicializar nuevas bases de datos de inquilino y registrarlos en el catálogo de la aplicación hello inquilino.</span><span class="sxs-lookup"><span data-stu-id="87399-106">You create and initialize new tenant databases, and register them in hello application’s tenant catalog.</span></span> <span data-ttu-id="87399-107">catálogo de Hello es una base de datos que mantiene la asignación de hello entre varios inquilinos de la aplicación de SaaS hello y sus datos.</span><span class="sxs-lookup"><span data-stu-id="87399-107">hello catalog is a database that maintains hello mapping between hello SaaS application's many tenants and their data.</span></span> <span data-ttu-id="87399-108">catálogo de Hello desempeña un papel importante dirigir la base de datos de aplicación solicitudes toohello correcta.</span><span class="sxs-lookup"><span data-stu-id="87399-108">hello catalog plays an important role directing application requests toohello correct database.</span></span>  

<span data-ttu-id="87399-109">En este tutorial, aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="87399-109">In this tutorial, you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="87399-110">Aprovisionar un nuevo inquilino único, incluidos todos los pasos de su implementación</span><span class="sxs-lookup"><span data-stu-id="87399-110">Provision a single new tenant, including stepping through how this is implemented</span></span>
> * <span data-ttu-id="87399-111">Aprovisionar un lote de inquilinos adicionales</span><span class="sxs-lookup"><span data-stu-id="87399-111">Provision a batch of additional tenants</span></span>


<span data-ttu-id="87399-112">toocomplete se ha completado este tutorial, asegúrese de hello seguro después de requisitos previos:</span><span class="sxs-lookup"><span data-stu-id="87399-112">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="87399-113">se implementa la aplicación de SaaS Wingtip Hello.</span><span class="sxs-lookup"><span data-stu-id="87399-113">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="87399-114">vea toodeploy en menos de cinco minutos, [implementar y explorar la aplicación de SaaS Wingtip hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="87399-114">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="87399-115">Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="87399-115">Azure PowerShell is installed.</span></span> <span data-ttu-id="87399-116">Para más información, consulte [Introducción a Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="87399-116">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toohello-saas-catalog-pattern"></a><span data-ttu-id="87399-117">Introducción toohello patrón de catálogo de SaaS</span><span class="sxs-lookup"><span data-stu-id="87399-117">Introduction toohello SaaS Catalog pattern</span></span>

<span data-ttu-id="87399-118">En una aplicación de SaaS multiempresa de seguridad de base de datos, es importante tooknow donde se almacena información para cada inquilino.</span><span class="sxs-lookup"><span data-stu-id="87399-118">In a database-backed multi-tenant SaaS application, it's important tooknow where information for each tenant is stored.</span></span> <span data-ttu-id="87399-119">En el patrón de catálogo de SaaS hello, una base de datos de catálogo es toohold usado Hola asignación entre cada inquilino y donde se almacenan sus datos.</span><span class="sxs-lookup"><span data-stu-id="87399-119">In hello SaaS catalog pattern, a catalog database is used toohold hello mapping between each tenant and where their data is stored.</span></span> <span data-ttu-id="87399-120">aplicación de SaaS Wingtip Hello usa a un único inquilino por arquitectura de base de datos, pero patrón básico de Hola de almacenar la asignación de inquilino a base de datos en un catálogo se aplica si se utiliza una base de datos de inquilino único o múltiple.</span><span class="sxs-lookup"><span data-stu-id="87399-120">hello Wingtip SaaS app uses a single-tenant per database architecture, but hello basic pattern of storing tenant-to-database mapping in a catalog applies whether a multi-tenant or single-tenant database is used.</span></span>

<span data-ttu-id="87399-121">Cada inquilino se asigna una clave que identifica a ellos en el catálogo de Hola y que se asigna toohello ubicación de base de datos adecuado de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-121">Each tenant is assigned a key that identifies them in hello catalog and which is mapped toohello location of hello appropriate database.</span></span> <span data-ttu-id="87399-122">En la aplicación de SaaS Wingtip hello, clave de hello está formado de un código hash del nombre del inquilino de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-122">In hello Wingtip SaaS app, hello key is formed from a hash of hello tenant’s name.</span></span> <span data-ttu-id="87399-123">Esto permite utiliza de parte del nombre de inquilino de Hola de toobe de dirección URL de aplicación Hola clave de hello tooconstruct.</span><span class="sxs-lookup"><span data-stu-id="87399-123">This allows hello tenant name portion of hello application URL toobe used tooconstruct hello key.</span></span> <span data-ttu-id="87399-124">También se podrían utilizar otros esquemas de claves de inquilino.</span><span class="sxs-lookup"><span data-stu-id="87399-124">Other tenant key schemes could be used.</span></span>  

<span data-ttu-id="87399-125">catálogo de Hello permite Hola nombre o la ubicación de hello toobe de base de datos cambiado con un impacto mínimo en la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="87399-125">hello catalog allows hello name or location of hello database toobe changed with minimal impact on hello application.</span></span>  <span data-ttu-id="87399-126">En un modelo de base de datos multiinquilino, esto también permite mover a un inquilino entre bases de datos.</span><span class="sxs-lookup"><span data-stu-id="87399-126">In a multi-tenant database model, this also accommodates ‘moving’ a tenant between databases.</span></span>  <span data-ttu-id="87399-127">catálogo de Hello también puede ser usado tooindicate si un inquilino o base de datos está sin conexión durante el mantenimiento u otras acciones.</span><span class="sxs-lookup"><span data-stu-id="87399-127">hello catalog can also be used tooindicate whether a tenant or database is offline for maintenance or other actions.</span></span> <span data-ttu-id="87399-128">Esto se explora en hello [restaurar tutorial de un solo inquilino](sql-database-saas-tutorial-restore-single-tenant.md).</span><span class="sxs-lookup"><span data-stu-id="87399-128">This is explored in hello [restore single tenant tutorial](sql-database-saas-tutorial-restore-single-tenant.md).</span></span>

<span data-ttu-id="87399-129">Además, catálogo de hello, que está en vigor una base de datos de administración de una aplicación SaaS, puede almacenar metadatos de inquilino o base de datos adicionales, como Hola capa o edición de una base de datos, la versión del esquema, el plan de servicio o SLA que ofrece tootenants y otra información que permite la administración de aplicaciones, soporte al cliente o los procesos de devops.</span><span class="sxs-lookup"><span data-stu-id="87399-129">In addition, hello catalog, which is in effect a management database for a SaaS application, can store additional tenant or database metadata, such as hello tier or edition of a database, schema version, service plan, or SLAs offered tootenants, and other info that enables application management, customer support, or devops processes.</span></span>  

<span data-ttu-id="87399-130">Más allá de hello aplicación SaaS, catálogo Hola puede permitir a las herramientas de base de datos.</span><span class="sxs-lookup"><span data-stu-id="87399-130">Beyond hello SaaS application, hello catalog can enable database tools.</span></span>  <span data-ttu-id="87399-131">En el ejemplo de Hola a Wingtip SaaS, catálogo de hello es consulta entre inquilinos de tooenable usado, explorada en hello [tutorial de análisis ad hoc](sql-database-saas-tutorial-adhoc-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="87399-131">In hello Wingtip SaaS sample, hello catalog is used tooenable cross-tenant query, explored in hello [ad hoc analytics tutorial](sql-database-saas-tutorial-adhoc-analytics.md).</span></span> <span data-ttu-id="87399-132">Administración del trabajo entre bases de datos se explora en hello [administración del esquema](sql-database-saas-tutorial-schema-management.md) y [inquilino análisis](sql-database-saas-tutorial-tenant-analytics.md) tutoriales.</span><span class="sxs-lookup"><span data-stu-id="87399-132">Cross-database job management is explored in hello [schema management](sql-database-saas-tutorial-schema-management.md) and [tenant analytics](sql-database-saas-tutorial-tenant-analytics.md) tutorials.</span></span> 

<span data-ttu-id="87399-133">En la aplicación de SaaS Wingtip hello, catálogo Hola se implementa mediante características de administración de particiones de Hola de hello [biblioteca de cliente de base de datos elástica (EDCL)](sql-database-elastic-database-client-library.md).</span><span class="sxs-lookup"><span data-stu-id="87399-133">In hello Wingtip SaaS app, hello catalog is implemented using hello Shard Management features of hello [Elastic Database Client Library (EDCL)](sql-database-elastic-database-client-library.md).</span></span> <span data-ttu-id="87399-134">Hola EDCL habilita una aplicación toocreate, administrar y usar un mapa de particiones de seguridad de base de datos.</span><span class="sxs-lookup"><span data-stu-id="87399-134">hello EDCL enables an application toocreate, manage, and use a database-backed shard map.</span></span> <span data-ttu-id="87399-135">Un mapa de particiones contiene una lista de particiones (bases de datos) y asignación de hello entre bases de datos y claves (inquilinos).</span><span class="sxs-lookup"><span data-stu-id="87399-135">A shard map contains a list of shards (databases) and hello mapping between keys (tenants) and databases.</span></span>  <span data-ttu-id="87399-136">Funciones EDCL se puedan usar desde aplicaciones o scripts de PowerShell durante las entradas de hello toocreate en mapa de particiones de Hola de aprovisionamiento del inquilino y desde las aplicaciones tooefficiently conectan toohello base de datos correcta.</span><span class="sxs-lookup"><span data-stu-id="87399-136">EDCL functions can be used from applications or PowerShell scripts during tenant provisioning toocreate hello entries in hello shard map, and from applications tooefficiently connect toohello correct database.</span></span> <span data-ttu-id="87399-137">Se almacena en caché en EDCL conexión información toominimize Hola tráfico toohello catálogo base de datos y acelerar la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="87399-137">EDCL caches connection information toominimize hello traffic toohello catalog database and speed up hello application.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="87399-138">los datos de asignación de Hello están accesibles en la base de datos de catálogo de hello, pero *no editarlo*!</span><span class="sxs-lookup"><span data-stu-id="87399-138">hello mapping data is accessible in hello catalog database, but *don't edit it*!</span></span> <span data-ttu-id="87399-139">Para editar datos de asignación, utilice únicamente las API de la biblioteca de cliente de Elastic Database.</span><span class="sxs-lookup"><span data-stu-id="87399-139">Edit mapping data using Elastic Database Client Library APIs only.</span></span> <span data-ttu-id="87399-140">Manipular directamente los datos de asignación de hello riesgos Hola de daño de catálogo y no se admiten.</span><span class="sxs-lookup"><span data-stu-id="87399-140">Directly manipulating hello mapping data risks corrupting hello catalog and is not supported.</span></span>


## <a name="introduction-toohello-saas-provisioning-pattern"></a><span data-ttu-id="87399-141">Patrón de aprovisionamiento de SaaS toohello de introducción</span><span class="sxs-lookup"><span data-stu-id="87399-141">Introduction toohello SaaS Provisioning pattern</span></span>

<span data-ttu-id="87399-142">Durante la incorporación de un nuevo inquilino a una aplicación SaaS que usa el modelo de base de datos de un solo inquilino, se debe aprovisionar una nueva base de datos de inquilino.</span><span class="sxs-lookup"><span data-stu-id="87399-142">When onboarding a new tenant in a SaaS application that uses a single-tenant database model a new tenant database must be provisioned.</span></span>  <span data-ttu-id="87399-143">Debe crearse en la ubicación adecuada de Hola y de nivel de servicio, inicializado con los datos de referencia y el esquema adecuado y después se registran en el catálogo de hello bajo la clave de inquilino adecuado de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-143">It must be created in hello appropriate location and service tier, initialized with appropriate schema and reference data, and then registered in hello catalog under hello appropriate tenant key.</span></span>  

<span data-ttu-id="87399-144">Distintos enfoques pueden ser usado toodatabase aprovisionamiento, lo que podría incluir la ejecución de scripts SQL, la implementación de un bacpac o copiar una base de datos 'maestra' plantilla.</span><span class="sxs-lookup"><span data-stu-id="87399-144">Different approaches can be used toodatabase provisioning, which could include executing SQL scripts, deploying a bacpac, or copying a 'golden' template database.</span></span>  

<span data-ttu-id="87399-145">debe se ha comprendido Hola aprovisionamiento del método que utilice en su estrategia general de administración de esquema, que debe asegurarse de que se ha aprovisionado nuevas bases de datos con el esquema más reciente de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-145">hello provisioning approach you use must be comprehended in your overall schema management strategy, which must ensure that new databases are provisioned with hello latest schema.</span></span>  <span data-ttu-id="87399-146">Esto se explora en hello [tutorial de administración de esquema](sql-database-saas-tutorial-schema-management.md).</span><span class="sxs-lookup"><span data-stu-id="87399-146">This is explored in hello [schema management tutorial](sql-database-saas-tutorial-schema-management.md).</span></span>  

<span data-ttu-id="87399-147">Hola Wingtip SaaS aplicación aprovisiona nuevos inquilinos mediante la copia de una base de datos maestra con el nombre basetenantdb, implementada en el servidor de catálogo Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-147">hello Wingtip SaaS app provisions new tenants by copying a golden database named basetenantdb, deployed on hello catalog server.</span></span>  <span data-ttu-id="87399-148">Aprovisionamiento podría se integra en la aplicación hello como parte de una experiencia de inicio de sesión o admiten sin conexión con las secuencias de comandos.</span><span class="sxs-lookup"><span data-stu-id="87399-148">Provisioning could be integrated into hello application as part of a sign-up experience, and/or supported offline using scripts.</span></span> <span data-ttu-id="87399-149">Este tutorial describe el aprovisionamiento con PowerShell.</span><span class="sxs-lookup"><span data-stu-id="87399-149">This tutorial will explore provisioning using PowerShell.</span></span> <span data-ttu-id="87399-150">scripts de aprovisionamiento de Hello copiar hello basetenantdb toocreate una nueva base de datos de inquilinos en un grupo elástico, a continuación, inicializarlo con información específica del inquilino y registrarlo en mapa de particiones del catálogo de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-150">hello provisioning scripts copy hello basetenantdb toocreate a new tenant database in an elastic pool, then initialize it with tenant-specific info and register it in hello catalog shard map.</span></span>  <span data-ttu-id="87399-151">En la aplicación de ejemplo de Hola, las bases de datos se les asignan nombres basados en nombre del inquilino de hello, pero esto no es una parte fundamental del modelo de hello: uso de Hola de catálogo de hello permite cualquier base de datos de nombre toobe asignado toohello. +</span><span class="sxs-lookup"><span data-stu-id="87399-151">In hello sample app, databases are given names based on hello tenant name, but this is not a critical part of hello pattern – hello use of hello catalog allows any name toobe assigned toohello database.+</span></span> 


## <a name="get-hello-wingtip-application-scripts"></a><span data-ttu-id="87399-152">Obtener scripts de la aplicación hello Wingtip</span><span class="sxs-lookup"><span data-stu-id="87399-152">Get hello Wingtip application scripts</span></span>

<span data-ttu-id="87399-153">Hello Wingtip SaaS scripts y código fuente de aplicación están disponibles en hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repositorio de github.</span><span class="sxs-lookup"><span data-stu-id="87399-153">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="87399-154">[Pasos de secuencias de comandos de toodownload Hola Wingtip SaaS](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="87399-154">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>


## <a name="provision-and-catalog-detailed-walkthrough"></a><span data-ttu-id="87399-155">Tutorial detallado de aprovisionamiento y catalogación</span><span class="sxs-lookup"><span data-stu-id="87399-155">Provision and catalog detailed walkthrough</span></span>

<span data-ttu-id="87399-156">toounderstand cómo Hola Wingtip aplicación implementa nuevo inquilino de aprovisionamiento, agregue un punto de interrupción y recorrer el flujo de trabajo de Hola durante el aprovisionamiento de un inquilino:</span><span class="sxs-lookup"><span data-stu-id="87399-156">toounderstand how hello Wingtip application implements new tenant provisioning, add a breakpoint and step through hello workflow while provisioning a tenant:</span></span>

1. <span data-ttu-id="87399-157">Abra... \\Módulos de aprendizaje\\ProvisionAndCatalog\\_ProvisionAndCatalog.ps1 demostración_ y Hola de conjunto de parámetros siguientes:</span><span class="sxs-lookup"><span data-stu-id="87399-157">Open ...\\Learning Modules\\ProvisionAndCatalog\\_Demo-ProvisionAndCatalog.ps1_ and set hello following parameters:</span></span>
   * <span data-ttu-id="87399-158">**$TenantName** = nombre de Hola de nuevo escenario de hello (por ejemplo, *Bushwillow Blues*).</span><span class="sxs-lookup"><span data-stu-id="87399-158">**$TenantName** = hello name of hello new venue (for example, *Bushwillow Blues*).</span></span>
   * <span data-ttu-id="87399-159">**$VenueType** = uno de los tipos de ubicación predefinida de hello: *blues*, classicalmusic, fiesta, jazz, judo, motorracing, multipropósito, opera, rockmusic, fútbol.</span><span class="sxs-lookup"><span data-stu-id="87399-159">**$VenueType** = one of hello pre-defined venue types: *blues*, classicalmusic, dance, jazz, judo, motorracing, multipurpose, opera, rockmusic, soccer.</span></span>
   * <span data-ttu-id="87399-160">**$DemoScenario** = **1**, establezca demasiado**1** demasiado*aprovisionar un solo inquilino*.</span><span class="sxs-lookup"><span data-stu-id="87399-160">**$DemoScenario** = **1**, Set too**1** too*Provision a single tenant*.</span></span>

1. <span data-ttu-id="87399-161">Agregar un punto de interrupción, coloque el cursor en cualquier lugar en línea hello 48, línea que dice: *nuevo inquilino '*y presione **F9**.</span><span class="sxs-lookup"><span data-stu-id="87399-161">Add a breakpoint by putting your cursor anywhere on line 48, hello line that says: *New-Tenant \`*, and press **F9**.</span></span>

   ![punto de interrupción](media/sql-database-saas-tutorial-provision-and-catalog/breakpoint.png)

1. <span data-ttu-id="87399-163">Presione de script de Hola toorun **F5**.</span><span class="sxs-lookup"><span data-stu-id="87399-163">toorun hello script press **F5**.</span></span>

1. <span data-ttu-id="87399-164">Después de la ejecución de script de Hola se detiene en el punto de interrupción de hello, presione **F11** toostep en código de hello.</span><span class="sxs-lookup"><span data-stu-id="87399-164">After hello script execution stops at hello breakpoint, press **F11** toostep into hello code.</span></span>

   ![punto de interrupción](media/sql-database-saas-tutorial-provision-and-catalog/debug.png)



<span data-ttu-id="87399-166">Seguimiento de ejecución del script de Hola mediante hello **depurar** opciones de menú - **F10** y **F11** toostep sobre o en hello llamada a funciones.</span><span class="sxs-lookup"><span data-stu-id="87399-166">Trace hello script's execution using hello **Debug** menu options - **F10** and **F11** toostep over or into hello called functions.</span></span> <span data-ttu-id="87399-167">Para obtener más información sobre cómo depurar scripts de PowerShell, consulte [Sugerencias para trabajar con scripts de PowerShell y depurarlos](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span><span class="sxs-lookup"><span data-stu-id="87399-167">For more information about debugging PowerShell scripts, see [Tips on working with and debugging PowerShell scripts](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span></span>


<span data-ttu-id="87399-168">siguiente Hello no es pasos seguir tooexplicitly, sino una explicación del flujo de trabajo de hello que recorre paso a paso durante la depuración de script de Hola:</span><span class="sxs-lookup"><span data-stu-id="87399-168">hello following are not steps tooexplicitly follow, but an explanation of hello workflow you step through while debugging hello script:</span></span>

1. <span data-ttu-id="87399-169">**Hola de importación SubscriptionManagement.psm1** módulo que contiene funciones para iniciar sesión en tooAzure y seleccionando Hola suscripción de Azure que está trabajando.</span><span class="sxs-lookup"><span data-stu-id="87399-169">**Import hello SubscriptionManagement.psm1** module that contains functions for signing in tooAzure and selecting hello Azure subscription you are working with.</span></span>
1. <span data-ttu-id="87399-170">**Hola de importación CatalogAndDatabaseManagement.psm1** módulo que proporciona un catálogo y el nivel del inquilino abstracción sobre hello [administración de particiones](sql-database-elastic-scale-shard-map-management.md) funciones.</span><span class="sxs-lookup"><span data-stu-id="87399-170">**Import hello CatalogAndDatabaseManagement.psm1** module that provides a catalog and tenant-level abstraction over hello [Shard Management](sql-database-elastic-scale-shard-map-management.md) functions.</span></span> <span data-ttu-id="87399-171">Se trata de un módulo importante que encapsula gran parte del patrón de catálogo de Hola y merece la pena mencionar.</span><span class="sxs-lookup"><span data-stu-id="87399-171">This is an important module that encapsulates much of hello catalog pattern and is worth exploring.</span></span>
1. <span data-ttu-id="87399-172">**Obtenga los detalles de configuración**.</span><span class="sxs-lookup"><span data-stu-id="87399-172">**Get configuration details**.</span></span> <span data-ttu-id="87399-173">Ir a Get-configuración (F11) y vea cómo se especifica la configuración de aplicación Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-173">Step into Get-Configuration (with F11) and see how hello app config is specified.</span></span> <span data-ttu-id="87399-174">Los nombres de recursos y otros valores específicos de la aplicación se definen aquí, pero no cambiar ninguno de estos valores hasta que esté familiarizado con las secuencias de comandos de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-174">Resource names and other app-specific values are defined here, but do not change any of these values until you are familiar with hello scripts.</span></span>
1. <span data-ttu-id="87399-175">**Obtener objetos de catálogo de hello**.</span><span class="sxs-lookup"><span data-stu-id="87399-175">**Get hello catalog object**.</span></span> <span data-ttu-id="87399-176">Ir a Get-catálogo que crea y devuelve un objeto de catálogo que se usa en el script de nivel superior de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-176">Step into Get-Catalog which composes and returns a catalog object that is used in hello higher-level script.</span></span>  <span data-ttu-id="87399-177">Esta función utiliza las funciones de administración de particiones que se importan desde **AzureShardManagement.psm1**.</span><span class="sxs-lookup"><span data-stu-id="87399-177">This function uses Shard Management functions that are imported from **AzureShardManagement.psm1**.</span></span> <span data-ttu-id="87399-178">objeto de catálogo de Hola se compone de siguiente hello:</span><span class="sxs-lookup"><span data-stu-id="87399-178">hello catalog object is composed of hello following:</span></span>
   * <span data-ttu-id="87399-179">$catalogServerFullyQualifiedName se construye utilizando troncal estándar hello más el nombre de usuario: _catálogo -\<usuario\>. database.windows.net_.</span><span class="sxs-lookup"><span data-stu-id="87399-179">$catalogServerFullyQualifiedName is constructed using hello standard stem plus your User name: _catalog-\<user\>.database.windows.net_.</span></span>
   * <span data-ttu-id="87399-180">$catalogDatabaseName se recuperan desde la configuración de hello: *tenantcatalog*.</span><span class="sxs-lookup"><span data-stu-id="87399-180">$catalogDatabaseName is retrieved from hello config: *tenantcatalog*.</span></span>
   * <span data-ttu-id="87399-181">se inicializa el objeto de $shardMapManager de base de datos de catálogo de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-181">$shardMapManager object is initialized from hello catalog database.</span></span>
   * <span data-ttu-id="87399-182">objeto $shardMap se inicializa desde hello *tenantcatalog* mapa de particiones en la base de datos de catálogo de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-182">$shardMap object is initialized from hello *tenantcatalog* shard map in hello catalog database.</span></span>
   <span data-ttu-id="87399-183">Un objeto de catálogo está compuesto por y devuelve y utilizan en script un nivel más alto de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-183">A catalog object is composed and returned, and used in hello higher-level script.</span></span>
1. <span data-ttu-id="87399-184">**Calcular la nueva clave de inquilino hello**.</span><span class="sxs-lookup"><span data-stu-id="87399-184">**Calculate hello new tenant key**.</span></span> <span data-ttu-id="87399-185">Una función hash es clave de inquilino de hello toocreate usado de nombre del inquilino Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-185">A hash function is used toocreate hello tenant key from hello tenant name.</span></span>
1. <span data-ttu-id="87399-186">**Comprobar si ya existe la clave de inquilino de hello**.</span><span class="sxs-lookup"><span data-stu-id="87399-186">**Check if hello tenant key already exists**.</span></span> <span data-ttu-id="87399-187">catálogo de Hola se comprueba la clave de hello tooensure está disponible.</span><span class="sxs-lookup"><span data-stu-id="87399-187">hello catalog is checked tooensure hello key is available.</span></span>
1. <span data-ttu-id="87399-188">**base de datos de inquilinos de Hola se aprovisiona con New-TenantDatabase.**</span><span class="sxs-lookup"><span data-stu-id="87399-188">**hello tenant database is provisioned with New-TenantDatabase.**</span></span> <span data-ttu-id="87399-189">Use **F11** toostep en y ver cómo es la base de datos de hello aprovisionado con un [plantilla de Azure Resource Manager](../azure-resource-manager/resource-manager-template-walkthrough.md).</span><span class="sxs-lookup"><span data-stu-id="87399-189">Use **F11** toostep in and see how hello database is provisioned using an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md).</span></span>

<span data-ttu-id="87399-190">nombre de la base de datos de Hola se construye a partir de hello inquilino nombre toomake claro qué partición pertenece a toowhich inquilino.</span><span class="sxs-lookup"><span data-stu-id="87399-190">hello database name is constructed from hello tenant name toomake it clear which shard belongs toowhich tenant.</span></span> <span data-ttu-id="87399-191">(Fácilmente se podrían usar otras estrategias para asignar nombres a base de datos.) + Una plantilla de administrador de recursos es toocreate usa una base de datos de inquilinos mediante la copia de una base de datos maestra (baseTenantDB) en el servidor de catálogo Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-191">(Other strategies for database naming could easily be used.)+ A Resource Manager template is used toocreate a tenant database by copying a golden database (baseTenantDB) on hello catalog server.</span></span> <span data-ttu-id="87399-192">Un enfoque alternativo podría ser toocreate una base de datos vacía y e inicializarlo después mediante la importación de un bacpac o tooexecute un script de inicialización desde una ubicación conocida.</span><span class="sxs-lookup"><span data-stu-id="87399-192">An alternative approach could be toocreate an empty database and then initialize it by importing a bacpac, or tooexecute an initialization script from a well-known location.</span></span>  

<span data-ttu-id="87399-193">plantilla del Administrador de recursos de Hola está en la carpeta de hello ...\Learning Modules\Common\: *tenantdatabasecopytemplate.json*</span><span class="sxs-lookup"><span data-stu-id="87399-193">hello Resource Manager template is in hello …\Learning Modules\Common\ folder: *tenantdatabasecopytemplate.json*</span></span>

<span data-ttu-id="87399-194">Después de crea la base de datos de inquilinos de hello, a continuación, resulta más **inicializa con el nombre de lugar (inquilino) de Hola y el tipo de ubicación de hello**.</span><span class="sxs-lookup"><span data-stu-id="87399-194">After hello tenant database is created, it is then further **initialized with hello venue (tenant) name and hello venue type**.</span></span> <span data-ttu-id="87399-195">Aquí también podría realizarse otro tipo de inicialización.</span><span class="sxs-lookup"><span data-stu-id="87399-195">Other initialization could also be done here.</span></span>

<span data-ttu-id="87399-196">Hola **base de datos de inquilino está registrado en el catálogo de hello** con *TenantDatabaseToCatalog agregar* con clave de inquilino de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-196">hello **tenant database is registered in hello catalog** with *Add-TenantDatabaseToCatalog* using hello tenant key.</span></span> <span data-ttu-id="87399-197">Use **F11** toostep en los detalles de hello:</span><span class="sxs-lookup"><span data-stu-id="87399-197">Use **F11** toostep into hello details:</span></span>

* <span data-ttu-id="87399-198">base de datos de catálogo de Hola se agrega el mapa de particiones toohello (lista de Hola de bases de datos conocidos).</span><span class="sxs-lookup"><span data-stu-id="87399-198">hello catalog database is added toohello shard map (hello list of known databases).</span></span>
* <span data-ttu-id="87399-199">Hola asignación de esa partición de toohello vínculos Hola clave-valor se crea.</span><span class="sxs-lookup"><span data-stu-id="87399-199">hello mapping that links hello key value toohello shard is created.</span></span>
* <span data-ttu-id="87399-200">Metadatos adicionales (nombre del lugar de hello) acerca de inquilino de Hola se agregan toohello tabla de los inquilinos en el catálogo de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-200">Additional meta data (hello venue's name) about hello tenant is added toohello Tenants table in hello catalog.</span></span>  <span data-ttu-id="87399-201">tabla de inquilinos de Hello no forma parte del esquema de ShardManagement Hola y Hola EDCL no lo instala.</span><span class="sxs-lookup"><span data-stu-id="87399-201">hello Tenants table is not part of hello ShardManagement schema and is not installed by hello EDCL.</span></span>  <span data-ttu-id="87399-202">Esta tabla muestra cómo puede extenderse a base de datos de catálogo de hello datos de toosupport adicionales específicos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="87399-202">This table illustrates how hello Catalog database can be extended toosupport additional application-specific data.</span></span>   


<span data-ttu-id="87399-203">Después de que finalice el aprovisionamiento, ejecución devuelve toohello original *demostración ProvisionAndCatalog* secuencia de comandos, que abre hello **eventos** página para nuevo inquilino de hello en el Explorador de hello:</span><span class="sxs-lookup"><span data-stu-id="87399-203">After provisioning completes, execution returns toohello original *Demo-ProvisionAndCatalog* script, which opens hello **Events** page for hello new tenant in hello browser:</span></span>

   ![events](media/sql-database-saas-tutorial-provision-and-catalog/new-tenant.png)


## <a name="provision-a-batch-of-tenants"></a><span data-ttu-id="87399-205">Aprovisionamiento de un lote de inquilinos</span><span class="sxs-lookup"><span data-stu-id="87399-205">Provision a batch of tenants</span></span>

<span data-ttu-id="87399-206">Este ejercicio aprovisiona un lote de 17 inquilinos.</span><span class="sxs-lookup"><span data-stu-id="87399-206">This exercise provisions a batch of 17 tenants.</span></span> <span data-ttu-id="87399-207">Se recomienda que proporcionar este lote de inquilinos antes de iniciar otros tutoriales Wingtip SaaS, así que no hay más de unos pocos toowork de bases de datos con.</span><span class="sxs-lookup"><span data-stu-id="87399-207">It’s recommended you provision this batch of tenants before starting other Wingtip SaaS tutorials, so there's more than just a few databases toowork with.</span></span>

1. <span data-ttu-id="87399-208">Abra... \\Módulos de aprendizaje\\ProvisionAndCatalog\\*demostración ProvisionAndCatalog.ps1* en hello *PowerShell ISE* y cambiar hello *$ DemoScenario* too3 de parámetro:</span><span class="sxs-lookup"><span data-stu-id="87399-208">Open ...\\Learning Modules\\ProvisionAndCatalog\\*Demo-ProvisionAndCatalog.ps1* in hello *PowerShell ISE* and change hello *$DemoScenario* parameter too3:</span></span>
   * <span data-ttu-id="87399-209">**$DemoScenario** = **3**, también cambian**3** demasiado*aprovisionar un lote de inquilinos*.</span><span class="sxs-lookup"><span data-stu-id="87399-209">**$DemoScenario** = **3**, change too**3** too*Provision a batch of tenants*.</span></span>
1. <span data-ttu-id="87399-210">Presione **F5** y ejecute el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-210">Press **F5** and run hello script.</span></span>

<span data-ttu-id="87399-211">script de Hola implementa un lote de inquilinos adicionales.</span><span class="sxs-lookup"><span data-stu-id="87399-211">hello script deploys a batch of additional tenants.</span></span> <span data-ttu-id="87399-212">Usa un [plantilla de Azure Resource Manager](../azure-resource-manager/resource-manager-template-walkthrough.md) que controla el lote de hello y, a continuación, los delegados de aprovisionamiento de cada plantilla vinculada de tooa de base de datos.</span><span class="sxs-lookup"><span data-stu-id="87399-212">It uses an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md) that controls hello batch and then delegates provisioning of each database tooa linked template.</span></span> <span data-ttu-id="87399-213">Uso de plantillas de esta manera permite Azure Resource Manager toobroker Hola proceso para su script de aprovisionamiento.</span><span class="sxs-lookup"><span data-stu-id="87399-213">Using templates in this way allows Azure Resource Manager toobroker hello provisioning process for your script.</span></span> <span data-ttu-id="87399-214">Plantillas de aprovisionar bases de datos en paralelo donde puede y manejar los reintentos si es necesario, optimizar el proceso general de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-214">Templates provision databases in parallel where it can, and handles retries if needed, optimizing hello overall process.</span></span> <span data-ttu-id="87399-215">Hola script es idempotente por lo que si se produce un error o se detiene por alguna razón, vuelva a ejecutarlo.</span><span class="sxs-lookup"><span data-stu-id="87399-215">hello script is idempotent so if it fails or stops for any reason, run it again.</span></span>

### <a name="verify-hello-batch-of-tenants-successfully-deployed"></a><span data-ttu-id="87399-216">Compruebe el lote de Hola de inquilinos que se implementó correctamente</span><span class="sxs-lookup"><span data-stu-id="87399-216">Verify hello batch of tenants successfully deployed</span></span>

* <span data-ttu-id="87399-217">Abra hello *tenants1* servidor examinando tooyour lista de servidores en hello [portal de Azure](https://portal.azure.com), haga clic en **bases de datos SQL**y compruebe el lote de Hola de 17 bases de datos adicionales están ahora en la lista de hello:</span><span class="sxs-lookup"><span data-stu-id="87399-217">Open hello *tenants1* server by browsing tooyour list of servers in hello [Azure portal](https://portal.azure.com), click **SQL databases**, and verify hello batch of 17 additional databases are now in hello list:</span></span>

   ![lista de base de datos](media/sql-database-saas-tutorial-provision-and-catalog/database-list.png)



## <a name="other-provisioning-patterns"></a><span data-ttu-id="87399-219">Otros patrones de aprovisionamiento</span><span class="sxs-lookup"><span data-stu-id="87399-219">Other provisioning patterns</span></span>

<span data-ttu-id="87399-220">Entre los patrones de aprovisionamiento que no se describen en este tutorial se incluyen los siguientes:</span><span class="sxs-lookup"><span data-stu-id="87399-220">Other provisioning patterns not included in this tutorial include:</span></span>

<span data-ttu-id="87399-221">**Aprovisionamiento previo de bases de datos.**</span><span class="sxs-lookup"><span data-stu-id="87399-221">**Pre-provisioning databases.**</span></span> <span data-ttu-id="87399-222">Hola previamente aprovisionamiento patrón aprovecha el hecho de Hola que las bases de datos en un grupo elástico no agregan costos adicionales.</span><span class="sxs-lookup"><span data-stu-id="87399-222">hello pre-provisioning pattern exploits hello fact that databases in an elastic pool do not add extra cost.</span></span> <span data-ttu-id="87399-223">La facturación es para el grupo elástico hello, no Hola bases de datos y las bases de datos inactivas no consuman ningún recurso.</span><span class="sxs-lookup"><span data-stu-id="87399-223">Billing is for hello elastic pool, not hello databases, and idle databases consume no resources.</span></span> <span data-ttu-id="87399-224">Al aprovisionar previamente bases de datos en un grupo y asignarlas posteriormente cuando sea necesario, puede reducirse considerablemente el tiempo de incorporación del inquilino.</span><span class="sxs-lookup"><span data-stu-id="87399-224">By pre-provisioning databases in a pool and allocating them when needed, tenant onboarding time can be reduced significantly.</span></span> <span data-ttu-id="87399-225">número de Hola de bases de datos que se suministran previamente pudo ajustará como tookeep necesitan un búfer adecuado para hello prever la velocidad de aprovisionamiento.</span><span class="sxs-lookup"><span data-stu-id="87399-225">hello number of databases pre-provisioned could be adjusted as needed tookeep a buffer suitable for hello anticipated provisioning rate.</span></span>

<span data-ttu-id="87399-226">**Aprovisionamiento automático**</span><span class="sxs-lookup"><span data-stu-id="87399-226">**Auto-provisioning.**</span></span> <span data-ttu-id="87399-227">En el patrón de aprovisionamiento automático de hello, un servicio de aprovisionamiento dedicado es tooprovision usa servidores, los grupos y las bases de datos automáticamente según sea necesario, incluidas bases de datos previamente aprovisionamiento en grupos elásticos si lo desea.</span><span class="sxs-lookup"><span data-stu-id="87399-227">In hello auto-provisioning pattern, a dedicated provisioning service is used tooprovision servers, pools, and databases automatically as needed – including pre-provisioning databases in elastic pools if desired.</span></span> <span data-ttu-id="87399-228">Y si las bases de datos se encargó anular y se elimina, deficiencias en grupos elásticos pueden ser completadas por hello aprovisionamiento del servicio según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="87399-228">And if databases are de-commissioned and deleted, gaps in elastic pools can be filled by hello provisioning service as desired.</span></span> <span data-ttu-id="87399-229">Este servicio puede ser simple o complejo; por ejemplo, puede controlarse el aprovisionamiento en varias regiones geográficas y configurarse automáticamente la replicación geográfica si se utiliza dicha estrategia para la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="87399-229">Such a service could be simple or complex – for example, handling provisioning across multiple geographies, and could set up geo-replication automatically if that strategy is being used for disaster recovery.</span></span> <span data-ttu-id="87399-230">Con el patrón de aprovisionamiento automático de hello, una aplicación cliente o la secuencia de comandos podría enviar un aprovisionamiento toobe de cola de tooa de solicitud procesada por hello aprovisionamiento del servicio y, a continuación, podría sondear realización de toodetermine del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-230">With hello auto-provisioning pattern, a client application or script would submit a provisioning request tooa queue toobe processed by hello provisioning service, and would then poll hello service toodetermine completion.</span></span> <span data-ttu-id="87399-231">Si se utiliza el aprovisionamiento previamente, se podrían administrar las solicitudes rápidamente con servicio de hello administra el aprovisionamiento de una base de datos de reemplazo que se ejecuta en segundo plano de Hola.</span><span class="sxs-lookup"><span data-stu-id="87399-231">If pre-provisioning is used, requests would be handled quickly with hello service managing provisioning of a replacement database running in hello background.</span></span>



## <a name="next-steps"></a><span data-ttu-id="87399-232">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="87399-232">Next steps</span></span>

<span data-ttu-id="87399-233">En este tutorial, ha aprendido cómo:</span><span class="sxs-lookup"><span data-stu-id="87399-233">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="87399-234">Aprovisionar un nuevo inquilino único</span><span class="sxs-lookup"><span data-stu-id="87399-234">Provision a single new tenant</span></span>
> * <span data-ttu-id="87399-235">Aprovisionar un lote de inquilinos adicionales</span><span class="sxs-lookup"><span data-stu-id="87399-235">Provision a batch of additional tenants</span></span>
> * <span data-ttu-id="87399-236">Ir a detalles de Hola de aprovisionamiento de los inquilinos y registrarlos en el catálogo de Hola</span><span class="sxs-lookup"><span data-stu-id="87399-236">Step into hello details of provisioning tenants, and registering them into hello catalog</span></span>

<span data-ttu-id="87399-237">Intente hello [tutorial de supervisión de rendimiento](sql-database-saas-tutorial-performance-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="87399-237">Try hello [Performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="87399-238">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="87399-238">Additional Resources</span></span>

* <span data-ttu-id="87399-239">Adicionales [tutoriales que parten Hola aplicación Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="87399-239">Additional [tutorials that build upon hello Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="87399-240">Biblioteca de cliente de base de datos elástica</span><span class="sxs-lookup"><span data-stu-id="87399-240">Elastic database client library</span></span>](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-database-client-library)
* [<span data-ttu-id="87399-241">Cómo tooDebug Scripts en Windows PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="87399-241">How tooDebug Scripts in Windows PowerShell ISE</span></span>](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise)
