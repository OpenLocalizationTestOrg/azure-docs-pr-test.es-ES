---
title: "Información general sobre las consultas elásticas de Azure SQL Database | Microsoft Docs"
description: "Información general de la característica de consultas elásticas"
services: sql-database
documentationcenter: 
manager: jhubbard
author: MladjoA
ms.assetid: a8bf0e2c-bc74-44d0-9b1e-bcc9a6aa2e33
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/27/2016
ms.author: mlandzic
ms.openlocfilehash: 9b3151248a1d036117bbdc9af03a98dff71ca535
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/18/2017
---
# <a name="azure-sql-database-elastic-query-overview-preview"></a><span data-ttu-id="8fe2d-103">Información general sobre las consultas elásticas de Azure SQL Database (versión preliminar)</span><span class="sxs-lookup"><span data-stu-id="8fe2d-103">Azure SQL Database elastic query overview (preview)</span></span>
<span data-ttu-id="8fe2d-104">La característica de consulta elástica (en versión preliminar) le permite ejecutar una consulta de Transact-SQL que abarca varias bases de datos en Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-104">The elastic query feature (in preview) enables you to run a Transact-SQL query that spans multiple databases in Azure SQL Database.</span></span> <span data-ttu-id="8fe2d-105">Permite realizar consultas entre bases de datos para acceder a tablas remotas, así como conectar herramientas de Microsoft y de terceros (Excel, PowerBI, Tableau, etc.) para hacer consultas en capas de datos con varias bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-105">It allows you to perform cross-database queries to access remote tables, and to connect Microsoft and third party tools (Excel, PowerBI, Tableau, etc.) to query across data tiers with multiple databases.</span></span> <span data-ttu-id="8fe2d-106">Con esta característica, puede escalar consultas horizontalmente a capas de datos de gran tamaño en Base de datos SQL y visualizar los resultados en los informes de inteligencia empresarial (BI).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-106">Using this feature, you can scale out queries to large data tiers in SQL Database and visualize the results in business intelligence (BI) reports.</span></span>


## <a name="why-use-elastic-queries"></a><span data-ttu-id="8fe2d-107">¿Por qué usar consultas elásticas?</span><span class="sxs-lookup"><span data-stu-id="8fe2d-107">Why use elastic queries?</span></span>

<span data-ttu-id="8fe2d-108">**Base de datos SQL de Azure**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-108">**Azure SQL Database**</span></span>

<span data-ttu-id="8fe2d-109">Realice consultas entre bases de datos SQL de Azure completamente en T-SQL.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-109">Query across Azure SQL databases completely in T-SQL.</span></span> <span data-ttu-id="8fe2d-110">lo que permite realizar consultas de solo lectura en bases de datos remotas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-110">This allows for read-only querying of remote databases.</span></span> <span data-ttu-id="8fe2d-111">Esto proporciona una opción para que los clientes actuales de SQL Server local migren las aplicaciones que usan nombres de tres y cuatro partes o un servidor vinculado a la base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-111">This provides an option for current on-premises SQL Server customers to migrate applications using three- and four-part names or linked server to SQL DB.</span></span>

<span data-ttu-id="8fe2d-112">**Disponible en el nivel Estándar**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-112">**Available on standard tier**</span></span>

<span data-ttu-id="8fe2d-113">La consulta elástica se admite en el nivel de rendimiento Estándar además de en el Premium.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-113">Elastic query is supported on the Standard performance tier in addition to the Premium performance tier.</span></span> <span data-ttu-id="8fe2d-114">Vea la sección Limitaciones de versión preliminar más adelante, que trata sobre las limitaciones del rendimiento para los niveles de rendimiento inferiores.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-114">See the section on Preview Limitations below on performance limitations for lower performance tiers.</span></span>

<span data-ttu-id="8fe2d-115">**Inserción en bases de datos remotas**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-115">**Push to remote databases**</span></span>

<span data-ttu-id="8fe2d-116">Ahora las consultas elásticas pueden insertar parámetros SQL en las bases de datos remotas para su ejecución.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-116">Elastic queries can now push SQL parameters to the remote databases for execution.</span></span>

<span data-ttu-id="8fe2d-117">**Ejecución de un procedimiento almacenado**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-117">**Stored procedure execution**</span></span>

<span data-ttu-id="8fe2d-118">Ejecute llamadas a procedimientos almacenados remotos o funciones remotas mediante [sp\_execute\_remote](https://msdn.microsoft.com/library/mt703714).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-118">Execute remote stored procedure calls or remote functions using [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714).</span></span>

<span data-ttu-id="8fe2d-119">**Flexibilidad**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-119">**Flexibility**</span></span>

<span data-ttu-id="8fe2d-120">Las tablas externas con consulta elástica ahora pueden hacer referencia a tablas remotas con un nombre de tabla o un esquema diferente.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-120">External tables with elastic query can now refer to remote tables with a different schema or table name.</span></span>

## <a name="elastic-query-scenarios"></a><span data-ttu-id="8fe2d-121">Escenarios de consulta elástica</span><span class="sxs-lookup"><span data-stu-id="8fe2d-121">Elastic query scenarios</span></span>

<span data-ttu-id="8fe2d-122">El objetivo es facilitar escenarios de consulta en los que varias bases de datos aportan filas a un único resultado global.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-122">The goal is to facilitate querying scenarios where multiple databases contribute rows into a single overall result.</span></span> <span data-ttu-id="8fe2d-123">El usuario o la aplicación pueden componer la consulta directamente, o también se puede conseguir de forma indirecta mediante las herramientas que están conectadas a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-123">The query can either be composed by the user or application directly, or indirectly through tools that are connected to the database.</span></span> <span data-ttu-id="8fe2d-124">Esto resulta especialmente útil cuando se crean informes, mediante herramientas de integración de datos o de BI comerciales, o bien cualquier aplicación que no se pueda cambiar.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-124">This is especially useful when creating reports, using commercial BI or data integration tools—or any application that cannot be changed.</span></span> <span data-ttu-id="8fe2d-125">Con una consulta elástica, puede consultar varias bases de datos por medio de la conocida experiencia de conectividad de SQL Server en herramientas como Excel, PowerBI, Tableau o Cognos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-125">With an elastic query, you can query across several databases using the familiar SQL Server connectivity experience in tools such as Excel, PowerBI, Tableau, or Cognos.</span></span>
<span data-ttu-id="8fe2d-126">Una consulta elástica facilita el acceso a toda una colección de bases de datos a través de las consultas emitidas por SQL Server Management Studio o Visual Studio. Asimismo, permite las consultas entre bases de datos desde Entity Framework u otros entornos de ORM.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-126">An elastic query allows easy access to an entire collection of databases through queries issued by SQL Server Management Studio or Visual Studio, and facilitates cross-database querying from Entity Framework or other ORM environments.</span></span> <span data-ttu-id="8fe2d-127">En la Figura 1 se muestra un escenario donde una aplicación en la nube existente (que usa la [biblioteca de cliente de bases de datos elásticas](sql-database-elastic-database-client-library.md)) se compila en una capa de datos escalada horizontalmente y se usa una consulta elástica para informes entre bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-127">Figure 1 shows a scenario where an existing cloud application (which uses the [elastic database client library](sql-database-elastic-database-client-library.md)) builds on a scaled-out data tier, and an elastic query is used for cross-database reporting.</span></span>

<span data-ttu-id="8fe2d-128">**Figura 1** Consulta usada en la capa de datos de escala horizontal</span><span class="sxs-lookup"><span data-stu-id="8fe2d-128">**Figure 1** Elastic query used on scaled-out data tier</span></span>

![Consulta usada en la capa de datos de escala horizontal][1]

<span data-ttu-id="8fe2d-130">Los escenarios de clientes para la consulta elástica se caracterizan por las siguientes topologías:</span><span class="sxs-lookup"><span data-stu-id="8fe2d-130">Customer scenarios for elastic query are characterized by the following topologies:</span></span>

* <span data-ttu-id="8fe2d-131">**Particiones verticales: consultas entre bases de datos** (topología 1): los datos se particionan en vertical entre varias bases de datos en una capa de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-131">**Vertical partitioning - Cross-database queries** (Topology 1): The data is partitioned vertically between a number of databases in a data tier.</span></span> <span data-ttu-id="8fe2d-132">Normalmente, los distintos conjuntos de tablas residen en bases de datos diferentes.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-132">Typically, different sets of tables reside on different databases.</span></span> <span data-ttu-id="8fe2d-133">Esto significa que el esquema es diferente en las distintas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-133">That means that the schema is different on different databases.</span></span> <span data-ttu-id="8fe2d-134">Por ejemplo, todas las tablas de inventario se encuentran en una base de datos mientras que todas las relacionadas con la contabilidad se encuentran en otra.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-134">For instance, all tables for inventory are on one database while all accounting-related tables are on a second database.</span></span> <span data-ttu-id="8fe2d-135">En los casos de uso habituales con esta topología, se requiere uno para realizar una consulta o compilar informes en todas las tablas de varias bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-135">Common use cases with this topology require one to query across or to compile reports across tables in several databases.</span></span>
* <span data-ttu-id="8fe2d-136">**Particiones horizontales: Particionamiento** (topología 2): los datos se particionan en horizontal para distribuir las filas en una capa de datos de escala horizontal.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-136">**Horizontal Partitioning - Sharding** (Topology 2): Data is partitioned horizontally to distribute rows across a scaled out data tier.</span></span> <span data-ttu-id="8fe2d-137">Con este enfoque, el esquema es idéntico en todas las bases de datos participantes.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-137">With this approach, the schema is identical on all participating databases.</span></span> <span data-ttu-id="8fe2d-138">Este enfoque también se denomina simplemente "particionamiento".</span><span class="sxs-lookup"><span data-stu-id="8fe2d-138">This approach is also called “sharding”.</span></span> <span data-ttu-id="8fe2d-139">El particionamiento se puede realizar y administrar mediante 1) las bibliotecas de herramientas de bases de datos elásticas o 2) el particionamiento automático.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-139">Sharding can be performed and managed using (1) the elastic database tools libraries or (2) self-sharding.</span></span> <span data-ttu-id="8fe2d-140">Se usa una consulta elástica para realizar consultas o compilar informes en muchas particiones.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-140">An elastic query is used to query or compile reports across many shards.</span></span>

> [!NOTE]
> <span data-ttu-id="8fe2d-141">La consulta elástica funciona mejor en escenarios de informes ocasionales, en los que la mayor parte del procesamiento se puede realizar en la capa de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-141">Elastic query works best for occasional reporting scenarios where most of the processing can be performed on the data tier.</span></span> <span data-ttu-id="8fe2d-142">Para grandes cargas de trabajo de informes o escenarios de almacenamiento de datos con consultas más complejas, considere también usar [Almacenamiento de datos SQL de Azure](https://azure.microsoft.com/services/sql-data-warehouse/).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-142">For heavy reporting workloads or data warehousing scenarios with more complex queries, also consider using [Azure SQL Data Warehouse](https://azure.microsoft.com/services/sql-data-warehouse/).</span></span>
>  

## <a name="vertical-partitioning---cross-database-queries"></a><span data-ttu-id="8fe2d-143">Particionamiento vertical: consultas entre bases de datos</span><span class="sxs-lookup"><span data-stu-id="8fe2d-143">Vertical partitioning - cross-database queries</span></span>

<span data-ttu-id="8fe2d-144">Para empezar a codificar, consulte la [introducción a la consulta entre bases de datos (creación de particiones verticales)](sql-database-elastic-query-getting-started-vertical.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-144">To begin coding, see [Getting started with cross-database query (vertical partitioning)](sql-database-elastic-query-getting-started-vertical.md).</span></span>

<span data-ttu-id="8fe2d-145">Se puede usar una consulta elástica para que los datos de una base de datos SQL estén disponibles para otras bases de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-145">An elastic query can be used to make data located in a SQL database available to other SQL databases.</span></span> <span data-ttu-id="8fe2d-146">Esto permite que las consultas desde una base de datos hagan referencia a las tablas de cualquier otra base de datos SQL remota.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-146">This allows queries from one database to refer to tables in any other remote SQL database.</span></span> <span data-ttu-id="8fe2d-147">El primer paso consiste en definir un origen de datos externo para cada base de datos remota.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-147">The first step is to define an external data source for each remote database.</span></span> <span data-ttu-id="8fe2d-148">El origen de datos externo se define en la base de datos local desde la que desee obtener acceso a las tablas que residen en la base de datos remota.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-148">The external data source is defined in the local database from which you want to gain access to tables located on the remote database.</span></span> <span data-ttu-id="8fe2d-149">No es necesario realizar cambios en la base de datos remota.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-149">No changes are necessary on the remote database.</span></span> <span data-ttu-id="8fe2d-150">En los escenarios típicos de particionamiento vertical en los que las diferentes bases de datos tienen esquemas distintos, se pueden usar consultas elásticas para implementar casos de uso habituales, como el acceso a datos de referencia y la consulta entre bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-150">For typical vertical partitioning scenarios where different databases have different schemas, elastic queries can be used to implement common use cases such as access to reference data and cross-database querying.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8fe2d-151">Se debe poseer el permiso ALTER ANY EXTERNAL DATA SOURCE.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-151">You must possess ALTER ANY EXTERNAL DATA SOURCE permission.</span></span> <span data-ttu-id="8fe2d-152">Este permiso está incluido en el permiso ALTER DATABASE.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-152">This permission is included with the ALTER DATABASE permission.</span></span> <span data-ttu-id="8fe2d-153">Se necesitan permisos ALTER ANY EXTERNAL DATA SOURCE para hacer referencia al origen de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-153">ALTER ANY EXTERNAL DATA SOURCE permissions are needed to refer to the underlying data source.</span></span>
>

<span data-ttu-id="8fe2d-154">**Datos de referencia**: la topología se usa para la administración de datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-154">**Reference data**: The topology is used for reference data management.</span></span> <span data-ttu-id="8fe2d-155">En la ilustración siguiente, se mantienen dos tablas (T1 y T2) con datos de referencia en una base de datos dedicada.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-155">In the figure below, two tables (T1 and T2) with reference data are kept on a dedicated database.</span></span> <span data-ttu-id="8fe2d-156">Con una consulta elástica, ahora puede acceder a las tablas T1 y T2 de forma remota desde otras bases de datos, como se muestra en la ilustración.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-156">Using an elastic query, you can now access tables T1 and T2 remotely from other databases, as shown in the figure.</span></span> <span data-ttu-id="8fe2d-157">Use la topología 1 si las tablas de referencia son pequeñas o si las consultas remotas en la tabla de referencia tienen predicados selectivos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-157">Use topology 1 if reference tables are small or remote queries into reference table have selective predicates.</span></span>

<span data-ttu-id="8fe2d-158">**Ilustración 2** Particionamiento vertical: usar una consulta elástica para consultar datos de referencia</span><span class="sxs-lookup"><span data-stu-id="8fe2d-158">**Figure 2** Vertical partitioning - Using elastic query to query reference data</span></span>

![Particionamiento vertical: usar una consulta elástica para consultar datos de referencia][3]

<span data-ttu-id="8fe2d-160">**Consulta entre bases de datos**: las consultas elásticas hacen posibles los casos de uso que requieren realizar consultas en varias bases de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-160">**Cross-database querying**: Elastic queries enable use cases that require querying across several SQL databases.</span></span> <span data-ttu-id="8fe2d-161">En la ilustración 3, se muestran cuatro bases de datos diferentes: CRM, Inventory, HR y Products.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-161">Figure 3 shows four different databases: CRM, Inventory, HR and Products.</span></span> <span data-ttu-id="8fe2d-162">Las consultas realizadas en una de las bases de datos también necesitan acceder a una de las otras bases de datos o a todas ellas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-162">Queries performed in one of the databases also need access to one or all the other databases.</span></span> <span data-ttu-id="8fe2d-163">Mediante una consulta elástica, puede configurar la base de datos para este caso ejecutando unas pocas instrucciones DDL sencillas en cada una de las cuatro bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-163">Using an elastic query, you can configure your database for this case by running a few simple DDL statements on each of the four databases.</span></span> <span data-ttu-id="8fe2d-164">Después de esta configuración única, el acceso a una tabla remota es tan sencillo como hacer referencia a una tabla local desde las consultas T-SQL o las herramientas de BI.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-164">After this one-time configuration, access to a remote table is as simple as referring to a local table from your T-SQL queries or from your BI tools.</span></span> <span data-ttu-id="8fe2d-165">Se recomienda este enfoque si las consultas remotas no devuelven resultados de gran tamaño.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-165">This approach is recommended if the remote queries do not return large results.</span></span>

<span data-ttu-id="8fe2d-166">**Ilustración 3** Particionamiento vertical: usar una consulta elástica para consultar en varias bases de datos</span><span class="sxs-lookup"><span data-stu-id="8fe2d-166">**Figure 3** Vertical partitioning - Using elastic query to query across various databases</span></span>

![Particionamiento vertical: usar una consulta elástica para consultar en varias bases de datos][4]

<span data-ttu-id="8fe2d-168">Con los siguientes pasos, se configuran consultas de bases de datos elásticas para escenarios de particionamiento vertical que requieren acceso a tablas ubicadas en una base de datos SQL remota con el mismo esquema:</span><span class="sxs-lookup"><span data-stu-id="8fe2d-168">The following steps configure elastic database queries for vertical partitioning scenarios that require access to a table located on remote SQL databases with the same schema:</span></span>

* <span data-ttu-id="8fe2d-169">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) miClaveMaestra</span><span class="sxs-lookup"><span data-stu-id="8fe2d-169">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey</span></span>
* <span data-ttu-id="8fe2d-170">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) miCredencial</span><span class="sxs-lookup"><span data-stu-id="8fe2d-170">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential</span></span>
* <span data-ttu-id="8fe2d-171">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) miOrigenDeDatos de tipo **RDBMS**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-171">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **RDBMS**</span></span>
* <span data-ttu-id="8fe2d-172">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) miTabla</span><span class="sxs-lookup"><span data-stu-id="8fe2d-172">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable</span></span>

<span data-ttu-id="8fe2d-173">Después de ejecutar las instrucciones DDL, puede acceder a la tabla remota "miTabla" como si fuera una tabla local.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-173">After running the DDL statements, you can access the remote table “mytable” as though it were a local table.</span></span> <span data-ttu-id="8fe2d-174">Base de datos SQL de Azure abre automáticamente una conexión con la base de datos remota, procesa la solicitud en la base de datos remota y devuelve los resultados.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-174">Azure SQL Database automatically opens a connection to the remote database, processes your request on the remote database, and returns the results.</span></span>

## <a name="horizontal-partitioning---sharding"></a><span data-ttu-id="8fe2d-175">Particiones horizontales (particionamiento)</span><span class="sxs-lookup"><span data-stu-id="8fe2d-175">Horizontal partitioning - sharding</span></span>
<span data-ttu-id="8fe2d-176">El uso de una consulta elástica para realizar tareas de informes en una capa de datos particionada, es decir, con particiones horizontales, requiere un [mapa de particiones de bases de datos elásticas](sql-database-elastic-scale-shard-map-management.md) para representar las bases de datos de la capa de datos.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-176">Using elastic query to perform reporting tasks over a sharded, i.e., horizontally partitioned, data tier requires an [elastic database shard map](sql-database-elastic-scale-shard-map-management.md) to represent the databases of the data tier .</span></span> <span data-ttu-id="8fe2d-177">Normalmente, se usa un solo mapa de particiones en este escenario y una base de datos dedicada con funcionalidades de consulta elástica (nodo principal) sirve de punto de entrada para las consultas de informes.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-177">Typically, only a single shard map is used in this scenario and a dedicated database with elastic query capabilities (head node) serves as the entry point for reporting queries.</span></span> <span data-ttu-id="8fe2d-178">Esta base de datos dedicada es la única que necesita acceder al mapa de particiones.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-178">Only this dedicated database needs access to the shard map.</span></span> <span data-ttu-id="8fe2d-179">La ilustración 4 muestra esta topología y su configuración con la base de datos de consulta elástica y el mapa de particiones.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-179">Figure 4 illustrates this topology and its configuration with the elastic query database and shard map.</span></span> <span data-ttu-id="8fe2d-180">Las bases de datos en la capa de datos pueden ser de cualquier edición o versión de Base de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-180">The databases in the data tier can be of any Azure SQL Database version or edition.</span></span> <span data-ttu-id="8fe2d-181">Para obtener más información acerca de la biblioteca de cliente de bases de datos elásticas y crear mapas de particiones, consulte [Administración de mapas de particiones](sql-database-elastic-scale-shard-map-management.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-181">For more information about the elastic database client library and creating shard maps, see [Shard map management](sql-database-elastic-scale-shard-map-management.md).</span></span>

<span data-ttu-id="8fe2d-182">**Ilustración 4** Particionamiento horizontal: usar una consulta elástica para informes en capas de datos particionadas</span><span class="sxs-lookup"><span data-stu-id="8fe2d-182">**Figure 4** Horizontal partitioning - Using elastic query for reporting over sharded data tiers</span></span>

![Particionamiento horizontal: usar una consulta elástica para informes en capas de datos particionadas][5]

> [!NOTE]
> <span data-ttu-id="8fe2d-184">La base de datos de consulta elástica (nodo principal) puede ser una independiente o la misma que hospeda el mapa de particiones.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-184">Elastic Query Database (head node) can be separate database, or it can be the same database that hosts the shard map.</span></span> <span data-ttu-id="8fe2d-185">Sea cual sea la configuración que elija, asegúrese de que ese servicio y el nivel de rendimiento de esa base de datos es suficientemente alto como para controlar la cantidad de solicitudes de inicio de sesión/consulta esperada.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-185">Whatever configuration you choose, make sure that service and performance tier of that database is high enough to handle the expected  amount of login/query requests.</span></span>

<span data-ttu-id="8fe2d-186">Con los siguientes pasos, se configuran consultas de bases de datos elásticas para escenarios de particionamiento horizontal que requieren acceso a un conjunto de tablas ubicadas, por lo general, en varias bases de datos SQL remotas:</span><span class="sxs-lookup"><span data-stu-id="8fe2d-186">The following steps configure elastic database queries for horizontal partitioning scenarios that require access to a set of table that are located on (typically) several remote SQL databases:</span></span>

* <span data-ttu-id="8fe2d-187">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) miClaveMaestra</span><span class="sxs-lookup"><span data-stu-id="8fe2d-187">[CREATE MASTER KEY](https://msdn.microsoft.com/library/ms174382.aspx) mymasterkey</span></span>
* <span data-ttu-id="8fe2d-188">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) miCredencial</span><span class="sxs-lookup"><span data-stu-id="8fe2d-188">[CREATE DATABASE SCOPED CREDENTIAL](https://msdn.microsoft.com/library/mt270260.aspx) mycredential</span></span>
* <span data-ttu-id="8fe2d-189">Cree un [mapa de particiones](sql-database-elastic-scale-shard-map-management.md) que represente su capa de datos mediante la biblioteca de cliente de bases de datos elásticas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-189">Create a [shard map](sql-database-elastic-scale-shard-map-management.md) representing your data tier using the elastic database client library.</span></span>   
* <span data-ttu-id="8fe2d-190">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) miOrigenDeDatos de tipo **SHARD_MAP_MANAGER**</span><span class="sxs-lookup"><span data-stu-id="8fe2d-190">[CREATE/DROP EXTERNAL DATA SOURCE](https://msdn.microsoft.com/library/dn935022.aspx) mydatasource of type **SHARD_MAP_MANAGER**</span></span>
* <span data-ttu-id="8fe2d-191">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) miTabla</span><span class="sxs-lookup"><span data-stu-id="8fe2d-191">[CREATE/DROP EXTERNAL TABLE](https://msdn.microsoft.com/library/dn935021.aspx) mytable</span></span>

<span data-ttu-id="8fe2d-192">Una vez que realice estos pasos, puede acceder a la tabla con partición horizontal "miTabla" como si fuera una tabla local.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-192">Once you have performed these steps, you can access the horizontally partitioned table “mytable” as though it were a local table.</span></span> <span data-ttu-id="8fe2d-193">Base de datos SQL de Azure abre automáticamente varias conexiones paralelas con las bases de datos remotas donde se almacenan las tablas, procesa las solicitudes en las bases de datos remotas y devuelve los resultados.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-193">Azure SQL Database automatically opens multiple parallel connections to the remote databases where the tables are physically stored, processes the requests on the remote databases, and returns the results.</span></span>
<span data-ttu-id="8fe2d-194">Obtenga más información sobre los pasos necesarios para el escenario de particionamiento horizontal en [Consulta de bases de datos elásticas para particionamiento horizontal](sql-database-elastic-query-horizontal-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-194">More information on the steps required for the horizontal partitioning scenario can be found in [elastic query for horizontal partitioning](sql-database-elastic-query-horizontal-partitioning.md).</span></span>

<span data-ttu-id="8fe2d-195">Para empezar a codificar, consulte [Introducción a las consultas elásticas para particionamiento horizontal (particionamiento)](sql-database-elastic-query-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-195">To begin coding, see [Getting started with elastic query for horizontal partitioning (sharding)](sql-database-elastic-query-getting-started.md).</span></span>

## <a name="t-sql-querying"></a><span data-ttu-id="8fe2d-196">Consultas T-SQL</span><span class="sxs-lookup"><span data-stu-id="8fe2d-196">T-SQL querying</span></span>
<span data-ttu-id="8fe2d-197">Una vez que defina los orígenes de datos externos y las tablas externas, puede usar cadenas de conexión de SQL Server normales para conectarse a las bases de datos en las que definió las tablas externas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-197">Once you have defined your external data sources and your external tables, you can use regular SQL Server connection strings to connect to the databases where you defined your external tables.</span></span> <span data-ttu-id="8fe2d-198">A continuación, puede ejecutar instrucciones T-SQL en las tablas externas de esa conexión, con las limitaciones que se describen a continuación.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-198">You can then run T-SQL statements over your external tables on that connection with the limitations outlined below.</span></span> <span data-ttu-id="8fe2d-199">Puede encontrar más información y ejemplos de consultas de T-SQL en los temas de documentación sobre [particiones horizontales](sql-database-elastic-query-horizontal-partitioning.md) y [particiones verticales](sql-database-elastic-query-vertical-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-199">You can find more information and examples of T-SQL queries in the documentation topics for [horizontal partitioning](sql-database-elastic-query-horizontal-partitioning.md) and [vertical partitioning](sql-database-elastic-query-vertical-partitioning.md).</span></span>

## <a name="connectivity-for-tools"></a><span data-ttu-id="8fe2d-200">Conectividad para herramientas</span><span class="sxs-lookup"><span data-stu-id="8fe2d-200">Connectivity for tools</span></span>
<span data-ttu-id="8fe2d-201">Puede usar cadenas de conexión de SQL Server normales para conectar sus aplicaciones y herramientas de integración de datos o de BI a bases de datos con tablas externas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-201">You can use regular SQL Server connection strings to connect your applications and BI or data integration tools to databases that have external tables.</span></span> <span data-ttu-id="8fe2d-202">Asegúrese de que SQL Server se admite como origen de datos para la herramienta.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-202">Make sure that SQL Server is supported as a data source for your tool.</span></span> <span data-ttu-id="8fe2d-203">Una vez conectadas, consulte la base de datos de consulta elástica y las tablas externas de esa base de datos como haría con cualquier otra base de datos de SQL Server a la que se conecte con su herramienta.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-203">Once connected, refer to the elastic query database and the external tables in that database just like you would do with any other SQL Server database that you connect to with your tool.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8fe2d-204">Actualmente no se admite la autenticación usando Azure Active Directory con consultas elásticas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-204">Authentication using Azure Active Directory with elastic queries is not currently supported.</span></span>
> 
> 

## <a name="cost"></a><span data-ttu-id="8fe2d-205">Coste</span><span class="sxs-lookup"><span data-stu-id="8fe2d-205">Cost</span></span>
<span data-ttu-id="8fe2d-206">La consulta elástica se incluye en el costo de las bases de datos de Base de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-206">Elastic query is included into the cost of Azure SQL Database databases.</span></span> <span data-ttu-id="8fe2d-207">Tenga en cuenta que se admiten las topologías en las que las bases de datos remotas se encuentran en un centro de datos diferente al punto de conexión de la consulta elástica, pero la salida de datos de las bases de datos remotas se cobra a [tarifas de Azure](https://azure.microsoft.com/pricing/details/data-transfers/)normales.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-207">Note that topologies where your remote databases are in a different data center than the elastic query endpoint are supported, but data egress from remote databases are charged regular [Azure rates](https://azure.microsoft.com/pricing/details/data-transfers/).</span></span>

## <a name="preview-limitations"></a><span data-ttu-id="8fe2d-208">Limitaciones de vista previa</span><span class="sxs-lookup"><span data-stu-id="8fe2d-208">Preview limitations</span></span>
* <span data-ttu-id="8fe2d-209">Ejecutar una consulta elástica por primera vez puede tardar unos minutos en el nivel de rendimiento Estándar.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-209">Running your first elastic query can take up to a few minutes on the Standard performance tier.</span></span> <span data-ttu-id="8fe2d-210">Esta vez es necesario cargar la funcionalidad de consulta elástica; el rendimiento de carga mejora con niveles superiores de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-210">This time is necessary to load the elastic query functionality; loading performance improves with higher performance tiers.</span></span>
* <span data-ttu-id="8fe2d-211">Aún no se admite el scripting de orígenes de datos externos o tablas externas desde SSMS o SSDT.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-211">Scripting of external data sources or external tables from SSMS or SSDT is not yet supported.</span></span>
* <span data-ttu-id="8fe2d-212">La función Importación/Exportación para bases de datos SQL aún no admite orígenes de datos externos ni tablas externas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-212">Import/Export for SQL DB does not yet support external data sources and external tables.</span></span> <span data-ttu-id="8fe2d-213">Si necesita usar Importación/Exportación, quite estos objetos antes de exportar y después vuelva a crearlos después de importar.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-213">If you need to use Import/Export, drop these objects before exporting and then re-create them after importing.</span></span>
* <span data-ttu-id="8fe2d-214">Actualmente, la consulta elástica solo es compatible con el acceso de solo lectura a tablas externas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-214">Elastic query currently only supports read-only access to external tables.</span></span> <span data-ttu-id="8fe2d-215">Sin embargo, puede usar toda la funcionalidad de T-SQL en la base de datos donde se define la tabla externa.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-215">You can, however, use full T-SQL functionality on the database where the external table is defined.</span></span> <span data-ttu-id="8fe2d-216">Esto puede ser útil, por ejemplo, para conservar resultados temporales mediante por ejemplo SELECT <column_list> INTO <local_table>, o para definir procedimientos almacenados en la base de datos de consulta elástica que hacen referencia a tablas externas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-216">This can be useful to, e.g., persist temporary results using, e.g., SELECT <column_list> INTO <local_table>, or to define stored procedures on the elastic query database which refer to external tables.</span></span>
* <span data-ttu-id="8fe2d-217">A excepción de nvarchar(max), los tipos LOB no se admiten en las definiciones de tabla externa.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-217">Except for nvarchar(max), LOB types are not supported in external table definitions.</span></span> <span data-ttu-id="8fe2d-218">Como alternativa, cree una vista en la base de datos remota que convierta el tipo LOB en nvarchar(max), defina la tabla externa en la vista en lugar de la tabla base y después conviértala en el tipo LOB original en las consultas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-218">As a workaround, you can create a view on the remote database that casts the LOB type into nvarchar(max), define your external table over the view instead of the base table and then cast it back into the original LOB type in your queries.</span></span>
* <span data-ttu-id="8fe2d-219">Actualmente no se admiten estadísticas de columna con tablas externas.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-219">Column statistics over external tables are currently not supported.</span></span> <span data-ttu-id="8fe2d-220">Se admiten las estadísticas de tabla, pero se deben crear manualmente.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-220">Tables statistics are supported, but need to be created manually.</span></span>

## <a name="feedback"></a><span data-ttu-id="8fe2d-221">Comentarios</span><span class="sxs-lookup"><span data-stu-id="8fe2d-221">Feedback</span></span>
<span data-ttu-id="8fe2d-222">Comparta sus comentarios sobre su experiencia con las consultas elásticas en Disqus más abajo, los foros de MSDN o Stackoverflow.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-222">Please share feedback on your experience with elastic queries with us on Disqus below, the MSDN forums, or on Stackoverflow.</span></span> <span data-ttu-id="8fe2d-223">Estamos interesados en todo tipo de comentarios sobre el servicio (defectos, particularidades, deficiencias de característica, etc.).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-223">We are interested in all kinds of feedback about the service (defects, rough edges, feature gaps).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8fe2d-224">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="8fe2d-224">Next steps</span></span>

* <span data-ttu-id="8fe2d-225">Para obtener un tutorial sobre la creación de particiones verticales, consulte [Introducción a las consultas entre bases de datos (particiones verticales)](sql-database-elastic-query-getting-started-vertical.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-225">For a vertical partitioning tutorial, see [Getting started with cross-database query (vertical partitioning)](sql-database-elastic-query-getting-started-vertical.md).</span></span>
* <span data-ttu-id="8fe2d-226">Para ver la sintaxis y consultas de ejemplo para los datos con particionamiento vertical, consulte [Consulta de datos particionados verticalmente](sql-database-elastic-query-vertical-partitioning.md)</span><span class="sxs-lookup"><span data-stu-id="8fe2d-226">For syntax and sample queries for vertically partitioned data, see [Querying vertically partitioned data)](sql-database-elastic-query-vertical-partitioning.md)</span></span>
* <span data-ttu-id="8fe2d-227">Para obtener un tutorial sobre la creación de particiones horizontales (particionamiento), consulte [Introducción a las consultas elásticas para las particiones horizontales (particionamiento)](sql-database-elastic-query-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="8fe2d-227">For a horizontal partitioning (sharding) tutorial, see [Getting started with elastic query for horizontal partitioning (sharding)](sql-database-elastic-query-getting-started.md).</span></span>
* <span data-ttu-id="8fe2d-228">Para ver la sintaxis y consultas de ejemplo para los datos con particionamiento horizontal, consulte [Consulta de datos particionados horizontalmente.](sql-database-elastic-query-horizontal-partitioning.md)</span><span class="sxs-lookup"><span data-stu-id="8fe2d-228">For syntax and sample queries for horizontally partitioned data, see [Querying horizontally partitioned data)](sql-database-elastic-query-horizontal-partitioning.md)</span></span>
* <span data-ttu-id="8fe2d-229">Consulte [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714) para ver un procedimiento almacenado que ejecuta una instrucción de Transact-SQL en una sola instancia remota de Azure SQL Database o un conjunto de bases de datos que actúan como particiones en un esquema de particiones horizontales.</span><span class="sxs-lookup"><span data-stu-id="8fe2d-229">See [sp\_execute \_remote](https://msdn.microsoft.com/library/mt703714) for a stored procedure that executes a Transact-SQL statement on a single remote Azure SQL Database or set of databases serving as shards in a horizontal partitioning scheme.</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-query-overview/overview.png
[2]: ./media/sql-database-elastic-query-overview/topology1.png
[3]: ./media/sql-database-elastic-query-overview/vertpartrrefdata.png
[4]: ./media/sql-database-elastic-query-overview/verticalpartitioning.png
[5]: ./media/sql-database-elastic-query-overview/horizontalpartitioning.png

<!--anchors-->
