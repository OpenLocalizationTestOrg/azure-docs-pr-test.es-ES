---
title: "Administración de bases de datos escaladas horizontalmente en la nube | Microsoft Docs"
description: "Muestra el servicio de trabajo de base de datos elástica"
metakeywords: azure sql database elastic databases
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 6fa47cf2-1162-4534-a206-6e2d95b78580
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: 8e84562115a866c0df5e0dee6c7f66c036a74737
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="managing-scaled-out-cloud-databases"></a><span data-ttu-id="d3515-103">Administración de bases de datos escaladas horizontalmente en la nube</span><span class="sxs-lookup"><span data-stu-id="d3515-103">Managing scaled-out cloud databases</span></span>
<span data-ttu-id="d3515-104">Para administrar bases de datos con particiones y escaladas horizontalmente en la nube, la característica **Trabajos de base de datos elástica** (versión preliminar) permite ejecutar un script de Transact-SQL (T-SQL) de forma confiable en un grupo de bases de datos, lo que incluye:</span><span class="sxs-lookup"><span data-stu-id="d3515-104">To manage scaled-out sharded databases, the **Elastic Database jobs** feature (preview) enables you to reliably execute a Transact-SQL (T-SQL) script across a group of databases, including:</span></span>

* <span data-ttu-id="d3515-105">una colección personalizada de bases de datos (se explica más adelante)</span><span class="sxs-lookup"><span data-stu-id="d3515-105">a custom-defined collection of databases (explained below)</span></span>
* <span data-ttu-id="d3515-106">todas las bases de datos de un [grupo elástico](sql-database-elastic-pool.md)</span><span class="sxs-lookup"><span data-stu-id="d3515-106">all databases in an [elastic pool](sql-database-elastic-pool.md)</span></span>
* <span data-ttu-id="d3515-107">un conjunto de particiones (creadas con la [biblioteca de cliente de bases de datos elásticas](sql-database-elastic-database-client-library.md))</span><span class="sxs-lookup"><span data-stu-id="d3515-107">a shard set (created using [Elastic Database client library](sql-database-elastic-database-client-library.md)).</span></span> 

## <a name="documentation"></a><span data-ttu-id="d3515-108">Documentación</span><span class="sxs-lookup"><span data-stu-id="d3515-108">Documentation</span></span>
* <span data-ttu-id="d3515-109">[Información general sobre la instalación de Trabajos de base de datos elástica](sql-database-elastic-jobs-service-installation.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-109">[Install the Elastic Database job components](sql-database-elastic-jobs-service-installation.md).</span></span> 
* <span data-ttu-id="d3515-110">[Introducción a Trabajos de base de datos elástica](sql-database-elastic-jobs-getting-started.md)</span><span class="sxs-lookup"><span data-stu-id="d3515-110">[Get started with Elastic Database jobs](sql-database-elastic-jobs-getting-started.md).</span></span>
* <span data-ttu-id="d3515-111">[Creación y administración de un grupo de bases de datos SQL elásticas mediante PowerShell](sql-database-elastic-jobs-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-111">[Create and manage jobs using PowerShell](sql-database-elastic-jobs-powershell.md).</span></span>
* [<span data-ttu-id="d3515-112">Creación y administración de Bases de datos SQL de Azure escaladas horizontalmente</span><span class="sxs-lookup"><span data-stu-id="d3515-112">Create and manage scaled out Azure SQL Databases</span></span>](sql-database-elastic-jobs-getting-started.md)

<span data-ttu-id="d3515-113">**Trabajos de base de datos elástica** es actualmente un servicio en la nube de Azure hospedado en el cliente que permite la ejecución de tareas administrativas ad hoc y programadas, que se denominan **trabajos**.</span><span class="sxs-lookup"><span data-stu-id="d3515-113">**Elastic Database jobs** is currently a customer-hosted Azure Cloud Service that enables the execution of ad-hoc and scheduled administrative tasks, which are called **jobs**.</span></span> <span data-ttu-id="d3515-114">Con los trabajos, puede administrar de forma fácil y confiable grandes grupos de bases de datos SQL de Azure mediante la ejecución de scripts de Transact-SQL para realizar operaciones administrativas.</span><span class="sxs-lookup"><span data-stu-id="d3515-114">With jobs, you can easily and reliably manage large groups of Azure SQL Databases by running Transact-SQL scripts to perform administrative operations.</span></span> 

![Servicio del trabajo de bases de datos elásticas][1]

## <a name="why-use-jobs"></a><span data-ttu-id="d3515-116">¿Por qué usar trabajos?</span><span class="sxs-lookup"><span data-stu-id="d3515-116">Why use jobs?</span></span>
<span data-ttu-id="d3515-117">**Manage**</span><span class="sxs-lookup"><span data-stu-id="d3515-117">**Manage**</span></span>

<span data-ttu-id="d3515-118">Realice fácilmente cambios de esquema, administración de credenciales, actualizaciones de datos de referencia, recopilación de datos de rendimiento o recopilación de telemetría de inquilinos (cliente).</span><span class="sxs-lookup"><span data-stu-id="d3515-118">Easily do schema changes, credentials management, reference data updates, performance data collection or tenant (customer) telemetry collection.</span></span>

<span data-ttu-id="d3515-119">**Informes**</span><span class="sxs-lookup"><span data-stu-id="d3515-119">**Reports**</span></span>

<span data-ttu-id="d3515-120">Agregue datos de una colección de bases de datos SQL de Azure en una tabla de destino única.</span><span class="sxs-lookup"><span data-stu-id="d3515-120">Aggregate data from a collection of Azure SQL Databases into a single destination table.</span></span>

<span data-ttu-id="d3515-121">**Reducción de la sobrecarga**</span><span class="sxs-lookup"><span data-stu-id="d3515-121">**Reduce overhead**</span></span>

<span data-ttu-id="d3515-122">Normalmente, debe conectarse a cada base de datos de forma independiente para ejecutar instrucciones T-SQL o realizar otras tareas administrativas.</span><span class="sxs-lookup"><span data-stu-id="d3515-122">Normally, you must connect to each database independently in order to run Transact-SQL statements or perform other administrative tasks.</span></span> <span data-ttu-id="d3515-123">Un trabajo controla la tarea de inicio de sesión en cada base de datos en el grupo de destino.</span><span class="sxs-lookup"><span data-stu-id="d3515-123">A job handles the task of logging in to each database in the target group.</span></span> <span data-ttu-id="d3515-124">También se definen, mantienen y conservan los scripts Transact-SQL que se van a ejecutar transversalmente en un grupo de bases de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="d3515-124">You also define, maintain and persist Transact-SQL scripts to be executed across a group of Azure SQL Databases.</span></span>

<span data-ttu-id="d3515-125">**Control**</span><span class="sxs-lookup"><span data-stu-id="d3515-125">**Accounting**</span></span>

<span data-ttu-id="d3515-126">Los trabajos ejecutan el script y registran el estado de ejecución de cada base de datos.</span><span class="sxs-lookup"><span data-stu-id="d3515-126">Jobs run the script and log the status of execution for each database.</span></span> <span data-ttu-id="d3515-127">Obtenga también el reintento automático en caso de errores.</span><span class="sxs-lookup"><span data-stu-id="d3515-127">You also get automatic retry when failures occur.</span></span>

<span data-ttu-id="d3515-128">**Flexibilidad**</span><span class="sxs-lookup"><span data-stu-id="d3515-128">**Flexibility**</span></span>

<span data-ttu-id="d3515-129">Defina grupos personalizados de bases de datos SQL de Azure, así como programaciones para ejecutar un trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-129">Define custom groups of Azure SQL Databases, and define schedules for running a job.</span></span>

> [!NOTE]
> <span data-ttu-id="d3515-130">En el Portal de Azure, solo hay disponible un conjunto reducido de funciones limitadas a grupos elásticos de SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="d3515-130">In the Azure portal, only a reduced set of functions limited to SQL Azure elastic pools is available.</span></span> <span data-ttu-id="d3515-131">Use las API de PowerShell para tener acceso al conjunto completo de funcionalidad actual.</span><span class="sxs-lookup"><span data-stu-id="d3515-131">Use the PowerShell APIs to access the full set of current functionality.</span></span>
> 
> 

## <a name="applications"></a><span data-ttu-id="d3515-132">Aplicaciones</span><span class="sxs-lookup"><span data-stu-id="d3515-132">Applications</span></span>
* <span data-ttu-id="d3515-133">Realice tareas administrativas como, por ejemplo, la implementación de un nuevo esquema</span><span class="sxs-lookup"><span data-stu-id="d3515-133">Perform administrative tasks, such as deploying a new schema.</span></span>
* <span data-ttu-id="d3515-134">Actualice información de producto con datos de referencia comunes en todas las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="d3515-134">Update reference data-product information common across all databases.</span></span> <span data-ttu-id="d3515-135">O bien, programe actualizaciones automáticas todos los días laborables, fuera del horario de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-135">Or schedules automatic updates every weekday, after hours.</span></span>
* <span data-ttu-id="d3515-136">Regeneración de índices para mejorar el rendimiento de consultas</span><span class="sxs-lookup"><span data-stu-id="d3515-136">Rebuild indexes to improve query performance.</span></span> <span data-ttu-id="d3515-137">La regeneración puede configurarse para que se ejecute periódicamente en una colección de bases de datos como, por ejemplo, fuera de horas pico.</span><span class="sxs-lookup"><span data-stu-id="d3515-137">The rebuilding can be configured to execute across a collection of databases on a recurring basis, such as during off-peak hours.</span></span>
* <span data-ttu-id="d3515-138">Recopile los resultados de consulta de un conjunto de bases de datos en una tabla central de forma continua.</span><span class="sxs-lookup"><span data-stu-id="d3515-138">Collect query results from a set of databases into a central table on an on-going basis.</span></span> <span data-ttu-id="d3515-139">Las consultas de rendimiento pueden ejecutarse continuamente y configurarse para que desencadenen la ejecución de otras tareas.</span><span class="sxs-lookup"><span data-stu-id="d3515-139">Performance queries can be continually executed and configured to trigger additional tasks to be executed.</span></span>
* <span data-ttu-id="d3515-140">Ejecute consultas de procesamiento de datos de ejecución más larga en un conjunto grande de bases de datos; por ejemplo, la recopilación de telemetría de cliente.</span><span class="sxs-lookup"><span data-stu-id="d3515-140">Execute longer running data processing queries across a large set of databases, for example the collection of customer telemetry.</span></span> <span data-ttu-id="d3515-141">Los resultados se recopilan en una sola tabla de destino para su posterior análisis.</span><span class="sxs-lookup"><span data-stu-id="d3515-141">Results are collected into a single destination table for further analysis.</span></span>

## <a name="elastic-database-jobs-end-to-end"></a><span data-ttu-id="d3515-142">Información detallada sobre los trabajos de base de datos elástica</span><span class="sxs-lookup"><span data-stu-id="d3515-142">Elastic Database jobs: end-to-end</span></span>
1. <span data-ttu-id="d3515-143">Instale los componentes de **Trabajos de base de datos elástica** .</span><span class="sxs-lookup"><span data-stu-id="d3515-143">Install the **Elastic Database jobs** components.</span></span> <span data-ttu-id="d3515-144">Para obtener más información, vea [Instalación de Trabajos de base de datos elástica](sql-database-elastic-jobs-service-installation.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-144">For more information, see [Installing Elastic Database jobs](sql-database-elastic-jobs-service-installation.md).</span></span> <span data-ttu-id="d3515-145">En caso de error en la instalación, vea [Desinstalación](sql-database-elastic-jobs-uninstall.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-145">If the installation fails, see [how to uninstall](sql-database-elastic-jobs-uninstall.md).</span></span>
2. <span data-ttu-id="d3515-146">Use las API de PowerShell para tener acceso a otra funcionalidad, por ejemplo, crear colecciones de bases de datos personalizadas, agregar programaciones o recopilar conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="d3515-146">Use the PowerShell APIs to access more functionality, for example creating custom-defined database collections, adding schedules and/or gathering results sets.</span></span> <span data-ttu-id="d3515-147">Use el portal para instalar, crear y supervisar de manera sencilla los trabajos que se limiten a la ejecución de un **grupo elástico**.</span><span class="sxs-lookup"><span data-stu-id="d3515-147">Use the portal for simple installation and creation/monitoring of jobs limited to execution against a **elastic pool**.</span></span> 
3. <span data-ttu-id="d3515-148">Cree credenciales cifradas para la ejecución de trabajos y [agregue el usuario (o rol) a cada base de datos del grupo](sql-database-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-148">Create encrypted credentials for job execution and [add the user (or role) to each database in the group](sql-database-security-overview.md).</span></span>
4. <span data-ttu-id="d3515-149">Cree un script de T-SQL idempotente que se pueda ejecutar en cada base de datos del grupo.</span><span class="sxs-lookup"><span data-stu-id="d3515-149">Create an idempotent T-SQL script that can be run against every database in the group.</span></span> 
5. <span data-ttu-id="d3515-150">Siga estos pasos para crear trabajos mediante el Portal de Azure: [Creación y administración de trabajos de base de datos elástica](sql-database-elastic-jobs-create-and-manage.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-150">Follow these steps to create jobs using the Azure portal: [Creating and managing Elastic Database jobs](sql-database-elastic-jobs-create-and-manage.md).</span></span> 
6. <span data-ttu-id="d3515-151">O bien use scripts de PowerShell: [Creación y administración de trabajos de base de datos elástica de Base de datos SQL (vista previa)](sql-database-elastic-jobs-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-151">Or use PowerShell scripts: [Create and manage a SQL Database elastic database jobs using PowerShell (preview)](sql-database-elastic-jobs-powershell.md).</span></span>

## <a name="idempotent-scripts"></a><span data-ttu-id="d3515-152">Scripts idempotentes</span><span class="sxs-lookup"><span data-stu-id="d3515-152">Idempotent scripts</span></span>
<span data-ttu-id="d3515-153">Los scripts deben ser [idempotentes](https://en.wikipedia.org/wiki/Idempotence).</span><span class="sxs-lookup"><span data-stu-id="d3515-153">The scripts must be [idempotent](https://en.wikipedia.org/wiki/Idempotence).</span></span> <span data-ttu-id="d3515-154">En términos sencillos, "idempotente" significa que si el script se ejecuta correctamente y se vuelve a ejecutar, produce el mismo resultado.</span><span class="sxs-lookup"><span data-stu-id="d3515-154">In simple terms, "idempotent" means that if the script succeeds, and it is run again, the same result occurs.</span></span> <span data-ttu-id="d3515-155">Un script puede producir errores debido a problemas de red transitorios.</span><span class="sxs-lookup"><span data-stu-id="d3515-155">A script may fail due to transient network issues.</span></span> <span data-ttu-id="d3515-156">En ese caso, el trabajo volverá a intentar ejecutar automáticamente el script un número de veces predefinido antes de desistir.</span><span class="sxs-lookup"><span data-stu-id="d3515-156">In that case, the job will automatically retry running the script a preset number of times before desisting.</span></span> <span data-ttu-id="d3515-157">Un script idempotente produce el mismo resultado aunque se ejecute correctamente dos veces.</span><span class="sxs-lookup"><span data-stu-id="d3515-157">An idempotent script has the same result even if has been successfully run twice.</span></span> 

<span data-ttu-id="d3515-158">Una táctica sencilla es probar la existencia de un objeto antes de crearlo.</span><span class="sxs-lookup"><span data-stu-id="d3515-158">A simple tactic is to test for the existence of an object before creating it.</span></span>  

    IF NOT EXIST (some_object)
    -- Create the object 
    -- If it exists, drop the object before recreating it.

<span data-ttu-id="d3515-159">De forma similar, un script debe ser capaz de comprobar lógicamente y contrarrestar las condiciones que encuentre para ejecutarse correctamente.</span><span class="sxs-lookup"><span data-stu-id="d3515-159">Similarly, a script must be able to execute successfully by logically testing for and countering any conditions it finds.</span></span>

## <a name="failures-and-logs"></a><span data-ttu-id="d3515-160">Errores y registros</span><span class="sxs-lookup"><span data-stu-id="d3515-160">Failures and logs</span></span>
<span data-ttu-id="d3515-161">Si se produce un error en un script después de varios intentos, el trabajo registra el error y continúa.</span><span class="sxs-lookup"><span data-stu-id="d3515-161">If a script fails after multiple attempts, the job logs the error and continues.</span></span> <span data-ttu-id="d3515-162">Después de que finalice un trabajo (es decir, una ejecución en todas las bases de datos del grupo), puede comprobar la lista de intentos incorrectos.</span><span class="sxs-lookup"><span data-stu-id="d3515-162">After a job ends (meaning a run against all databases in the group), you can check its list of failed attempts.</span></span> <span data-ttu-id="d3515-163">Los registros proporcionan detalles para depurar scripts defectuosos.</span><span class="sxs-lookup"><span data-stu-id="d3515-163">The logs provide details to debug faulty scripts.</span></span> 

## <a name="group-types-and-creation"></a><span data-ttu-id="d3515-164">Tipos de grupo y creación</span><span class="sxs-lookup"><span data-stu-id="d3515-164">Group types and creation</span></span>
<span data-ttu-id="d3515-165">Hay dos tipos de grupos:</span><span class="sxs-lookup"><span data-stu-id="d3515-165">There are two kinds of groups:</span></span> 

1. <span data-ttu-id="d3515-166">Conjuntos de particiones</span><span class="sxs-lookup"><span data-stu-id="d3515-166">Shard sets</span></span>
2. <span data-ttu-id="d3515-167">Grupos personalizados</span><span class="sxs-lookup"><span data-stu-id="d3515-167">Custom groups</span></span>

<span data-ttu-id="d3515-168">Los grupos de conjuntos de particiones se crean mediante las [Herramientas para bases de datos elásticas](sql-database-elastic-scale-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-168">Shard set groups are created using the [Elastic Database tools](sql-database-elastic-scale-introduction.md).</span></span> <span data-ttu-id="d3515-169">Cuando se crea un grupo de conjuntos de particiones, las bases de datos se agregan o se quitan del grupo automáticamente.</span><span class="sxs-lookup"><span data-stu-id="d3515-169">When you create a shard set group, databases are added or removed from the group automatically.</span></span> <span data-ttu-id="d3515-170">Por ejemplo, las nuevas particiones se incluyen automáticamente en el grupo al agregarlas al mapa de particiones.</span><span class="sxs-lookup"><span data-stu-id="d3515-170">For example, a new shard will be automatically in the group when you add it to the shard map.</span></span> <span data-ttu-id="d3515-171">A continuación, se puede ejecutar un trabajo en el grupo.</span><span class="sxs-lookup"><span data-stu-id="d3515-171">A job can then be run against the group.</span></span>

<span data-ttu-id="d3515-172">Por otro lado, los grupos personalizados se definen de forma rígida.</span><span class="sxs-lookup"><span data-stu-id="d3515-172">Custom groups, on the other hand, are rigidly defined.</span></span> <span data-ttu-id="d3515-173">Debe agregar o quitar explícitamente las bases de datos de los grupos personalizados.</span><span class="sxs-lookup"><span data-stu-id="d3515-173">You must explicitly add or remove databases from custom groups.</span></span> <span data-ttu-id="d3515-174">Si se quita una base de datos del grupo, el trabajo intentará ejecutar el script en la base de datos, lo que puede producir un error.</span><span class="sxs-lookup"><span data-stu-id="d3515-174">If a database in the group is dropped, the job will attempt to run the script against the database resulting in an eventual failure.</span></span> <span data-ttu-id="d3515-175">Los grupos creados mediante el Portal de Azure son grupos personalizados.</span><span class="sxs-lookup"><span data-stu-id="d3515-175">Groups created using the Azure portal currently are custom groups.</span></span> 

## <a name="components-and-pricing"></a><span data-ttu-id="d3515-176">Componentes y precios</span><span class="sxs-lookup"><span data-stu-id="d3515-176">Components and pricing</span></span>
<span data-ttu-id="d3515-177">Los siguientes componentes funcionan conjuntamente para crear un servicio de nube de Azure que permite la ejecución de ad hoc de trabajos administrativos.</span><span class="sxs-lookup"><span data-stu-id="d3515-177">The following components work together to create an Azure Cloud service that enables ad-hoc execution of administrative jobs.</span></span> <span data-ttu-id="d3515-178">Los componentes se instalan y configuran automáticamente durante la instalación, en su suscripción.</span><span class="sxs-lookup"><span data-stu-id="d3515-178">The components are installed and configured automatically during setup, in your subscription.</span></span> <span data-ttu-id="d3515-179">Puede identificar los servicios, ya que todos tienen el mismo nombre generado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="d3515-179">You can identify the services as they all have the same auto-generated name.</span></span> <span data-ttu-id="d3515-180">El nombre es único y se compone del prefijo "edj" seguido de 21 caracteres generados de forma aleatoria.</span><span class="sxs-lookup"><span data-stu-id="d3515-180">The name is unique, and consists of the prefix "edj" followed by 21 randomly generated characters.</span></span>

* <span data-ttu-id="d3515-181">**Servicio de nube de Azure**: los trabajos de bases de datos elásticas (vista previa) se entregan como un servicio de nube de Azure hospedado por el cliente para realizar la ejecución de las tareas requeridas.</span><span class="sxs-lookup"><span data-stu-id="d3515-181">**Azure Cloud Service**: elastic database jobs (preview) is delivered as a customer-hosted Azure Cloud service to perform execution of the requested tasks.</span></span> <span data-ttu-id="d3515-182">Desde el portal, el servicio se implemente y hospeda en su suscripción de Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="d3515-182">From the portal, the service is deployed and hosted in your Microsoft Azure subscription.</span></span> <span data-ttu-id="d3515-183">El servicio implementado predeterminado se ejecuta con un mínimo de dos roles de trabajador para ofrecer un elevado nivel de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="d3515-183">The default deployed service runs with the minimum of two worker roles for high availability.</span></span> <span data-ttu-id="d3515-184">El tamaño predeterminado de cada función de trabajador (ElasticDatabaseJobWorker) se ejecuta en una instancia de A0.</span><span class="sxs-lookup"><span data-stu-id="d3515-184">The default size of each worker role (ElasticDatabaseJobWorker) runs on an A0 instance.</span></span> <span data-ttu-id="d3515-185">Para obtener información sobre los precios, vea [Precios de servicios de nube](https://azure.microsoft.com/pricing/details/cloud-services/).</span><span class="sxs-lookup"><span data-stu-id="d3515-185">For pricing, see [Cloud services pricing](https://azure.microsoft.com/pricing/details/cloud-services/).</span></span> 
* <span data-ttu-id="d3515-186">**Azure SQL Database**: el servicio usa una base de datos de Azure SQL conocida como **base de datos de control** para almacenar todos los metadatos del trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-186">**Azure SQL Database**: The service uses an Azure SQL Database known as the **control database** to store all of the job metadata.</span></span> <span data-ttu-id="d3515-187">El nivel de servicio predeterminado es S0.</span><span class="sxs-lookup"><span data-stu-id="d3515-187">The default service tier is a S0.</span></span> <span data-ttu-id="d3515-188">Para obtener información sobre precios, vea [Precios de bases de datos SQL](https://azure.microsoft.com/pricing/details/sql-database/).</span><span class="sxs-lookup"><span data-stu-id="d3515-188">For pricing, see [SQL Database Pricing](https://azure.microsoft.com/pricing/details/sql-database/).</span></span>
* <span data-ttu-id="d3515-189">**Bus de servicio de Azure**: el bus de servicio de Azure permite coordinar el trabajo del servicio de nube de Azure.</span><span class="sxs-lookup"><span data-stu-id="d3515-189">**Azure Service Bus**: An Azure Service Bus is for coordination of the work within the Azure Cloud Service.</span></span> <span data-ttu-id="d3515-190">Vea [Precios del bus de servicio](https://azure.microsoft.com/pricing/details/service-bus/).</span><span class="sxs-lookup"><span data-stu-id="d3515-190">See [Service Bus Pricing](https://azure.microsoft.com/pricing/details/service-bus/).</span></span>
* <span data-ttu-id="d3515-191">**Almacenamiento de Azure**: se usa una cuenta de almacenamiento de Azure para almacenar los registros de salida de diagnóstico en caso de que un problema requiera una mayor depuración (vea [Habilitación de diagnósticos en Servicios en la nube y Máquinas virtuales de Azure](../cloud-services/cloud-services-dotnet-diagnostics.md)).</span><span class="sxs-lookup"><span data-stu-id="d3515-191">**Azure Storage**: An Azure Storage account is used to store diagnostic output logging in the event that an issue requires further debugging (see [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md)).</span></span> <span data-ttu-id="d3515-192">Para obtener información sobre precios, vea [Precios de almacenamiento de Azure](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="d3515-192">For pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>

## <a name="how-elastic-database-jobs-work"></a><span data-ttu-id="d3515-193">Funcionamiento de Trabajos de base de datos elástica</span><span class="sxs-lookup"><span data-stu-id="d3515-193">How Elastic Database jobs work</span></span>
1. <span data-ttu-id="d3515-194">Se designa una Base de datos SQL de Azure como **base de datos de control** que almacena todos los datos de estado y los metadatos.</span><span class="sxs-lookup"><span data-stu-id="d3515-194">An Azure SQL Database is designated a **control database** which stores all meta-data and state data.</span></span>
2. <span data-ttu-id="d3515-195">Se obtiene acceso a la base de control mediante el **servicio de trabajos** para iniciar los trabajos que deben ejecutarse y hacerles el seguimiento.</span><span class="sxs-lookup"><span data-stu-id="d3515-195">The control database is accessed by the **job service** to launch and track jobs to execute.</span></span>
3. <span data-ttu-id="d3515-196">Dos roles diferentes se comunican con la base de datos de control:</span><span class="sxs-lookup"><span data-stu-id="d3515-196">Two different roles communicate with the control database:</span></span> 
   * <span data-ttu-id="d3515-197">Controlador: determina los trabajos que requieren tareas para realizar el trabajo solicitado y reintenta los trabajos con errores creando nuevas tareas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-197">Controller: Determines which jobs require tasks to perform the requested job, and retries failed jobs by creating new job tasks.</span></span>
   * <span data-ttu-id="d3515-198">Ejecución de tareas de trabajo: lleva a cabo las tareas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-198">Job Task Execution: Carries out the job tasks.</span></span>

### <a name="job-task-types"></a><span data-ttu-id="d3515-199">Tipos de tareas de trabajo</span><span class="sxs-lookup"><span data-stu-id="d3515-199">Job task types</span></span>
<span data-ttu-id="d3515-200">Hay varios tipos de tareas de trabajo que efectúan la ejecución de trabajos:</span><span class="sxs-lookup"><span data-stu-id="d3515-200">There are multiple types of job tasks that carry out execution of jobs:</span></span>

* <span data-ttu-id="d3515-201">ShardMapRefresh: consulta el mapa de particiones para determinar todas las bases de datos que se usan como particiones</span><span class="sxs-lookup"><span data-stu-id="d3515-201">ShardMapRefresh: Queries the shard map to determine all the databases used as shards</span></span>
* <span data-ttu-id="d3515-202">ScriptSplit: divide el script en lotes de instrucciones 'GO'</span><span class="sxs-lookup"><span data-stu-id="d3515-202">ScriptSplit: Splits the script across ‘GO’ statements into batches</span></span>
* <span data-ttu-id="d3515-203">ExpandJob: crea trabajos secundarios para cada base de datos en un trabajo destinado a un grupo de bases de datos</span><span class="sxs-lookup"><span data-stu-id="d3515-203">ExpandJob: Creates child jobs for each database from a job that targets a group of databases</span></span>
* <span data-ttu-id="d3515-204">ScriptExecution: ejecuta un script en una base de datos concreta con las credenciales que se definan</span><span class="sxs-lookup"><span data-stu-id="d3515-204">ScriptExecution: Executes a script against a particular database using defined credentials</span></span>
* <span data-ttu-id="d3515-205">Dacpac: aplica un DACPAC a una base de datos concreta con las credenciales que se determinen</span><span class="sxs-lookup"><span data-stu-id="d3515-205">Dacpac: Applies a DACPAC to a particular database using particular credentials</span></span>

## <a name="end-to-end-job-execution-work-flow"></a><span data-ttu-id="d3515-206">Flujo de trabajo de ejecución de trabajos completo</span><span class="sxs-lookup"><span data-stu-id="d3515-206">End-to-end job execution work-flow</span></span>
1. <span data-ttu-id="d3515-207">Con el Portal o la API de PowerShell, se inserta un trabajo en la **base de datos de control**.</span><span class="sxs-lookup"><span data-stu-id="d3515-207">Using either the Portal or the PowerShell API, a job is inserted into the  **control database**.</span></span> <span data-ttu-id="d3515-208">El trabajo solicita la ejecución de un script de Transact-SQL en un grupo de bases de datos con las credenciales específicas.</span><span class="sxs-lookup"><span data-stu-id="d3515-208">The job requests execution of a Transact-SQL script against a group of databases using specific credentials.</span></span>
2. <span data-ttu-id="d3515-209">El controlador identifica el nuevo trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-209">The controller identifies the new job.</span></span> <span data-ttu-id="d3515-210">Se crean tareas de trabajo y se ejecutan para dividir el script y actualizar las bases de datos del grupo.</span><span class="sxs-lookup"><span data-stu-id="d3515-210">Job tasks are created and executed to split the script and to refresh the group’s databases.</span></span> <span data-ttu-id="d3515-211">Por último, se crea otro trabajo y se ejecuta para expandir el trabajo y crear nuevos trabajos secundarios donde se especifica que cada trabajo secundario ejecute el script de Transact-SQL en una base de datos individual del grupo.</span><span class="sxs-lookup"><span data-stu-id="d3515-211">Lastly, a new job is created and executed to expand the job and create new child jobs where each child job is specified to execute the Transact-SQL script against an individual database in the group.</span></span>
3. <span data-ttu-id="d3515-212">El controlador identifica los trabajos secundarios creados.</span><span class="sxs-lookup"><span data-stu-id="d3515-212">The controller identifies the created child jobs.</span></span> <span data-ttu-id="d3515-213">Para cada trabajo, el controlador crea y desencadena una tarea de trabajo que ejecuta el script en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="d3515-213">For each job, the controller creates and triggers a job task to execute the script against a database.</span></span> 
4. <span data-ttu-id="d3515-214">Tras completar todas las tareas de trabajo, el controlador actualiza los trabajos con el estado completado.</span><span class="sxs-lookup"><span data-stu-id="d3515-214">After all job tasks have completed, the controller updates the jobs to a completed state.</span></span> 
   <span data-ttu-id="d3515-215">En cualquier momento durante la ejecución de trabajos, puede usarse la API de PowerShell para ver el estado actual de la ejecución de trabajos.</span><span class="sxs-lookup"><span data-stu-id="d3515-215">At any point during job execution, the PowerShell API can be used to view the current state of job execution.</span></span> <span data-ttu-id="d3515-216">Todas las horas que devuelven las API de PowerShell se representan en formato UTC.</span><span class="sxs-lookup"><span data-stu-id="d3515-216">All times returned by the PowerShell APIs are represented in UTC.</span></span> <span data-ttu-id="d3515-217">Si lo desea, se puede iniciar una solicitud de cancelación para detener un trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3515-217">If desired, a cancellation request can be initiated to stop a job.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="d3515-218">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="d3515-218">Next steps</span></span>
<span data-ttu-id="d3515-219">[Instale los componentes](sql-database-elastic-jobs-service-installation.md) y luego [cree y agregue un registro en cada base de datos del grupo](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-219">[Install the components](sql-database-elastic-jobs-service-installation.md), then [create and add a log in to each database in the group of databases](sql-database-manage-logins.md).</span></span> <span data-ttu-id="d3515-220">Para comprender mejor la administración y creación de trabajos, consulte [Creación y administración de trabajos de bases de datos elásticas](sql-database-elastic-jobs-create-and-manage.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-220">To further understand job creation and management, see [creating and managing elastic database jobs](sql-database-elastic-jobs-create-and-manage.md).</span></span> <span data-ttu-id="d3515-221">Vea también [Introducción a Trabajos de base de datos elástica](sql-database-elastic-jobs-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="d3515-221">See also [Getting started with Elastic Database jobs](sql-database-elastic-jobs-getting-started.md).</span></span>

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Image references-->
[1]: ./media/sql-database-elastic-jobs-overview/elastic-jobs.png
<!--anchors-->


