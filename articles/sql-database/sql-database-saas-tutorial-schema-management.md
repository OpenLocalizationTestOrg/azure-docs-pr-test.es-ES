---
title: "Administración del esquema de Azure SQL Database en una aplicación multiinquilino | Microsoft Docs"
description: "Administración del esquema para varios inquilinos en una aplicación multiinquilino que usa Azure SQL Database"
keywords: tutorial de base de datos sql
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2017
ms.author: billgib; sstein
ms.openlocfilehash: 78d76efb88bf11fa18a416b59e6f881539141232
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="manage-schema-for-multiple-tenants-in-the-wingtip-saas-application"></a><span data-ttu-id="43146-104">Administración del esquema para varios inquilinos en la aplicación SaaS de Wingtip</span><span class="sxs-lookup"><span data-stu-id="43146-104">Manage schema for multiple tenants in the Wingtip SaaS application</span></span>

<span data-ttu-id="43146-105">El [primer tutorial sobre SaaS de Wingtip](sql-database-saas-tutorial.md) muestra cómo la aplicación puede aprovisionar una base de datos de inquilino y registrarla en el catálogo.</span><span class="sxs-lookup"><span data-stu-id="43146-105">The [first Wingtip SaaS tutorial](sql-database-saas-tutorial.md) shows how the app can provision a tenant database and register it in the catalog.</span></span> <span data-ttu-id="43146-106">Como cualquier otra aplicación, la aplicación SaaS de Wingtip evolucionará con el tiempo y, en ocasiones, requerirá que se hagan cambios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="43146-106">Like any application, the Wingtip SaaS app will evolve over time, and at times will require changes to the database.</span></span> <span data-ttu-id="43146-107">Estos cambios pueden incluir un esquema nuevo o modificado, datos de referencia nuevos o modificados y tareas de mantenimiento de la base de datos rutinarias para garantizar un rendimiento óptimo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="43146-107">Changes may include new or changed schema, new or changed reference data, and routine database maintenance tasks to ensure optimal app performance.</span></span> <span data-ttu-id="43146-108">Con una aplicación SaaS, estos cambios deben implementarse de manera coordinada a lo largo de una línea potencialmente masiva de bases de datos de inquilino.</span><span class="sxs-lookup"><span data-stu-id="43146-108">With a SaaS application, these changes need to be deployed in a coordinated manner across a potentially massive fleet of tenant databases.</span></span> <span data-ttu-id="43146-109">Para que estos cambios estén presentes en futuras bases de datos de inquilino, deben incorporarse en el proceso de aprovisionamiento.</span><span class="sxs-lookup"><span data-stu-id="43146-109">For these changes to be in future tenant databases, they need to be incorporated into the provisioning process.</span></span>

<span data-ttu-id="43146-110">Este tutorial explora dos escenarios: la implementación de actualizaciones de datos de referencia para todos los inquilinos y el reajuste de un índice en la tabla que contiene los datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="43146-110">This tutorial explores two scenarios - deploying reference data updates for all tenants, and retuning an index on the table containing the reference data.</span></span> <span data-ttu-id="43146-111">La característica [Trabajos elásticos](sql-database-elastic-jobs-overview.md) se usa para ejecutar estas operaciones en todos los inquilinos y la base de datos de inquilino *maestra* se utiliza como plantilla para nuevas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="43146-111">The [Elastic jobs](sql-database-elastic-jobs-overview.md) feature is used to execute these operations across all tenants, and the *golden* tenant database that is used as a template for new databases.</span></span>

<span data-ttu-id="43146-112">En este tutorial, aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="43146-112">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="43146-113">Crear una cuenta de trabajo</span><span class="sxs-lookup"><span data-stu-id="43146-113">Create a job account</span></span>
> * <span data-ttu-id="43146-114">Consultas entre varios inquilinos</span><span class="sxs-lookup"><span data-stu-id="43146-114">Query across multiple tenants</span></span>
> * <span data-ttu-id="43146-115">Actualizar datos en todas las bases de datos de inquilino</span><span class="sxs-lookup"><span data-stu-id="43146-115">Update data in all tenant databases</span></span>
> * <span data-ttu-id="43146-116">Crear un índice en una tabla en todas las bases de datos de inquilino</span><span class="sxs-lookup"><span data-stu-id="43146-116">Create an index on a table in all tenant databases</span></span>


<span data-ttu-id="43146-117">Para completar este tutorial, asegúrese de cumplir estos requisitos previos:</span><span class="sxs-lookup"><span data-stu-id="43146-117">To complete this tutorial, make sure the following prerequisites are met:</span></span>

* <span data-ttu-id="43146-118">Se implementa la aplicación SaaS de Wingtip.</span><span class="sxs-lookup"><span data-stu-id="43146-118">The Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="43146-119">Para implementarla en menos de cinco minutos, consulte el artículo sobre la [implementación y exploración de la aplicación SaaS de Wingtip](sql-database-saas-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="43146-119">To deploy in less than five minutes, see [Deploy and explore the Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="43146-120">Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="43146-120">Azure PowerShell is installed.</span></span> <span data-ttu-id="43146-121">Para más información, consulte [Introducción a Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="43146-121">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>
* <span data-ttu-id="43146-122">La versión más reciente de SQL Server Management Studio (SSMS) está instalada.</span><span class="sxs-lookup"><span data-stu-id="43146-122">The latest version of SQL Server Management Studio (SSMS) is installed.</span></span> [<span data-ttu-id="43146-123">Descarga e instalación de SSMS</span><span class="sxs-lookup"><span data-stu-id="43146-123">Download and Install SSMS</span></span>](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms)

<span data-ttu-id="43146-124">*En este tutorial se usan características del servicio SQL Database que se encuentran en una versión preliminar limitada (trabajos de Elastic Database). Si desea seguir este tutorial, envíe su identificador de suscripción a SaaSFeedback@microsoft.com con el asunto Elastic Jobs Preview. Después de recibir la confirmación de que se ha habilitado su suscripción, [descargue e instale los cmdlets de trabajos de versión preliminar más recientes](https://github.com/jaredmoo/azure-powershell/releases). Esta versión preliminar es limitada, de modo que póngase en contacto SaaSFeedback@microsoft.com si necesita asistencia.*</span><span class="sxs-lookup"><span data-stu-id="43146-124">*This tutorial uses features of the SQL Database service that are in a limited preview (Elastic Database jobs). If you wish to do this tutorial, provide your subscription id to SaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install the latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>


## <a name="introduction-to-saas-schema-management-patterns"></a><span data-ttu-id="43146-125">Introducción a los patrones de administración de esquema de SaaS</span><span class="sxs-lookup"><span data-stu-id="43146-125">Introduction to SaaS Schema Management patterns</span></span>

<span data-ttu-id="43146-126">El patrón de inquilino único por base de datos de SaaS se aprovecha de varias maneras del aislamiento de los datos resultante, pero al mismo tiempo introduce la complejidad adicional de mantener y administrar muchas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="43146-126">The single tenant per database SaaS pattern benefits in many ways from the data isolation that results, but at the same time introduces the additional complexity of maintaining and managing many databases.</span></span> <span data-ttu-id="43146-127">La característica [Trabajos elásticos](sql-database-elastic-jobs-overview.md) facilita la administración de la capa de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="43146-127">[Elastic Jobs](sql-database-elastic-jobs-overview.md) facilitates administration and management of the SQL data tier.</span></span> <span data-ttu-id="43146-128">Los trabajos permiten ejecutar tareas (scripts T-SQL) en un grupo de bases de datos de manera segura y confiable independientemente de las interacciones o entradas del usuario.</span><span class="sxs-lookup"><span data-stu-id="43146-128">Jobs enable you to securely and reliably, run tasks (T-SQL scripts) independent of user interaction or input, against a group of databases.</span></span> <span data-ttu-id="43146-129">Este método puede utilizarse para implementar cambios en el esquema y los datos de referencia comunes en todos los inquilinos de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="43146-129">This method can be used to deploy schema and common reference data changes across all tenants in an application.</span></span> <span data-ttu-id="43146-130">Trabajos elásticos también se puede utilizar para mantener una copia *golden* de la base de datos utilizada para crear nuevos inquilinos, garantizando así que siempre tenga el esquema y los datos de referencia más recientes.</span><span class="sxs-lookup"><span data-stu-id="43146-130">Elastic Jobs can also be used to maintain a *golden* copy of the database used to create new tenants, ensuring it always has the latest schema and reference data.</span></span>

![pantalla](media/sql-database-saas-tutorial-schema-management/schema-management.png)


## <a name="elastic-jobs-limited-preview"></a><span data-ttu-id="43146-132">Versión preliminar limitada de Trabajos elásticos</span><span class="sxs-lookup"><span data-stu-id="43146-132">Elastic Jobs limited preview</span></span>

<span data-ttu-id="43146-133">Hay una nueva versión de Trabajos elásticos que ahora es una característica integrada de Azure SQL Database (no requiere servicios ni componentes adicionales).</span><span class="sxs-lookup"><span data-stu-id="43146-133">There is a new version of Elastic Jobs that is now an integrated feature of Azure SQL Database (that requires no additional services or components).</span></span> <span data-ttu-id="43146-134">Esta nueva versión de Trabajos elásticos ofrece actualmente una versión preliminar limitada.</span><span class="sxs-lookup"><span data-stu-id="43146-134">This new version of Elastic Jobs is currently in limited preview.</span></span> <span data-ttu-id="43146-135">Esta versión preliminar limitada admite PowerShell para crear cuentas de trabajo y T-SQL para crear y administrar trabajos.</span><span class="sxs-lookup"><span data-stu-id="43146-135">This limited preview currently supports PowerShell to create job accounts, and T-SQL to create and manage jobs.</span></span>

> [!NOTE]
> <span data-ttu-id="43146-136">*En este tutorial se usan características del servicio SQL Database que se encuentran en una versión preliminar limitada (trabajos de Elastic Database). Si desea seguir este tutorial, envíe su identificador de suscripción a SaaSFeedback@microsoft.com con el asunto Elastic Jobs Preview. Después de recibir la confirmación de que se ha habilitado su suscripción, [descargue e instale los cmdlets de trabajos de versión preliminar más recientes](https://github.com/jaredmoo/azure-powershell/releases). Esta versión preliminar es limitada, de modo que póngase en contacto SaaSFeedback@microsoft.com si necesita asistencia.*</span><span class="sxs-lookup"><span data-stu-id="43146-136">*This tutorial uses features of the SQL Database service that are in a limited preview (Elastic Database jobs). If you wish to do this tutorial, provide your subscription id to SaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install the latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>

## <a name="get-the-wingtip-application-scripts"></a><span data-ttu-id="43146-137">Obtener scripts de la aplicación Wingtip</span><span class="sxs-lookup"><span data-stu-id="43146-137">Get the Wingtip application scripts</span></span>

<span data-ttu-id="43146-138">Los scripts SaaS de Wingtip y el código fuente de la aplicación están disponibles en el repositorio de GitHub [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS).</span><span class="sxs-lookup"><span data-stu-id="43146-138">The Wingtip SaaS scripts and application source code are available in the [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="43146-139">[Pasos para descargar los scripts SaaS de Wingtip](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="43146-139">[Steps to download the Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="create-a-job-account-database-and-new-job-account"></a><span data-ttu-id="43146-140">Creación de una base de datos de cuentas de trabajo y una nueva cuenta de trabajo</span><span class="sxs-lookup"><span data-stu-id="43146-140">Create a job account database and new job account</span></span>

<span data-ttu-id="43146-141">Para este tutorial, es necesario usar PowerShell para crear la base de datos de cuentas de trabajo y una nueva cuenta de trabajo.</span><span class="sxs-lookup"><span data-stu-id="43146-141">This tutorial requires you use PowerShell to create the job account database and job account.</span></span> <span data-ttu-id="43146-142">Al igual que MSDB y el Agente SQL, Trabajos Elásticos utiliza una instancia de Azure SQL Database para almacenar definiciones de trabajos, estados de trabajo y el historial.</span><span class="sxs-lookup"><span data-stu-id="43146-142">Like MSDB and SQL Agent, Elastic Jobs uses an Azure SQL database to store job definitions, job status, and history.</span></span> <span data-ttu-id="43146-143">Una vez creada la cuenta de trabajo, puede crear y supervisar trabajos inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="43146-143">Once the job account is created, you can create and monitor jobs immediately.</span></span>

1. <span data-ttu-id="43146-144">Abra …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* en **PowerShell ISE**.</span><span class="sxs-lookup"><span data-stu-id="43146-144">Open …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* in the **PowerShell ISE**.</span></span>
1. <span data-ttu-id="43146-145">Presione **F5** para ejecutar el script.</span><span class="sxs-lookup"><span data-stu-id="43146-145">Press **F5** to run the script.</span></span>

<span data-ttu-id="43146-146">El script *Demo-SchemaManagement.ps1* llama al script *Deploy-SchemaManagement.ps1* para crear una base de datos *S2* llamada **jobaccount** en el servidor de catálogo.</span><span class="sxs-lookup"><span data-stu-id="43146-146">The *Demo-SchemaManagement.ps1* script calls the *Deploy-SchemaManagement.ps1* script to create an *S2* database named **jobaccount** on the catalog server.</span></span> <span data-ttu-id="43146-147">A continuación, crea la cuenta de trabajo, transfiriendo la base de datos jobaccount como un parámetro a la llamada de creación de la cuenta de trabajo.</span><span class="sxs-lookup"><span data-stu-id="43146-147">It then creates the job account, passing the jobaccount database as a parameter to the job account creation call.</span></span>

## <a name="create-a-job-to-deploy-new-reference-data-to-all-tenants"></a><span data-ttu-id="43146-148">Creación de un trabajo para implementar nuevos datos de referencia en todos los inquilinos</span><span class="sxs-lookup"><span data-stu-id="43146-148">Create a job to deploy new reference data to all tenants</span></span>

<span data-ttu-id="43146-149">Cada base de datos de inquilinos incluye un conjunto de tipos de ubicación que definen la clase de eventos que se celebran en una ubicación.</span><span class="sxs-lookup"><span data-stu-id="43146-149">Each tenant database includes a set of venue types that define the kind of events that are hosted at a venue.</span></span> <span data-ttu-id="43146-150">En este ejercicio, se implementa una actualización en todas las bases de datos de inquilinos para agregar dos tipos de ubicación adicionales: *Motorcycle Racing* (motociclismo) y *Swimming Club* (club de natación).</span><span class="sxs-lookup"><span data-stu-id="43146-150">In this exercise, you deploy an update to all the tenant databases to add two additional venue types: *Motorcycle Racing* and *Swimming Club*.</span></span> <span data-ttu-id="43146-151">Estos tipos de ubicación se corresponden con la imagen de fondo que se ve en la aplicación de eventos de inquilino.</span><span class="sxs-lookup"><span data-stu-id="43146-151">These venue types correspond to the background image you see in the tenant events app.</span></span>

<span data-ttu-id="43146-152">Haga clic en el menú desplegable Tipo de lugar de celebración y asegúrese de que solo haya 10 opciones de tipo de ubicación disponibles y, en concreto, que "Motorcycle Racing" y "Swimming Club" no se encuentren en la lista.</span><span class="sxs-lookup"><span data-stu-id="43146-152">Click the Venue Type drop down menu and validate that only 10 venue type options are available, and specifically that ‘Motorcycle Racing’ and ‘Swimming Club’ are not included in the list.</span></span>

<span data-ttu-id="43146-153">Ahora vamos a crear un trabajo para actualizar la tabla *VenueTypes* en todas las bases de datos de inquilino y agregar los nuevos tipos de ubicación.</span><span class="sxs-lookup"><span data-stu-id="43146-153">Now let’s create a job to update the *VenueTypes* table in all the tenant databases and add the new venue types.</span></span>

<span data-ttu-id="43146-154">Para crear un nuevo trabajo, utilizamos un conjunto de procedimientos almacenados en el sistema de trabajos creados en la base de datos jobaccount cuando se creó la cuenta de trabajo.</span><span class="sxs-lookup"><span data-stu-id="43146-154">To create a new job, we use a set of jobs system stored procedures created in the jobaccount database when the job account was created.</span></span>

1. <span data-ttu-id="43146-155">Abra SSMS y conéctese al servidor de catálogo: catalog-\<usuario\>.database.windows.net server.</span><span class="sxs-lookup"><span data-stu-id="43146-155">Open SSMS and connect to the catalog server: catalog-\<user\>.database.windows.net server</span></span>
1. <span data-ttu-id="43146-156">Conéctese también al servidor de inquilino: tenants1-\<usuario\>.database.windows.net.</span><span class="sxs-lookup"><span data-stu-id="43146-156">Also connect to the tenant server: tenants1-\<user\>.database.windows.net</span></span>
1. <span data-ttu-id="43146-157">Vaya a la base de datos *contosoconcerthall* del servidor *tenants1* y consulte la tabla *VenueTypes* para confirmar que *Motorcycle Racing* y *Swimming Club* **no figuran** en la lista de resultados.</span><span class="sxs-lookup"><span data-stu-id="43146-157">Browse to the *contosoconcerthall* database on the *tenants1* server and query the *VenueTypes* table to confirm that *Motorcycle Racing* and *Swimming Club* **are not** in the results list.</span></span>
1. <span data-ttu-id="43146-158">Abra el archivo …\\Learning Modules\\Schema Management\\DeployReferenceData.sql.</span><span class="sxs-lookup"><span data-stu-id="43146-158">Open the file …\\Learning Modules\\Schema Management\\DeployReferenceData.sql</span></span>
1. <span data-ttu-id="43146-159">Modifique la instrucción: SET @wtpUser = &lt;usuario&gt; y sustituya el valor Usuario utilizado al implementar la aplicación Wingtip</span><span class="sxs-lookup"><span data-stu-id="43146-159">Modify the statement: SET @wtpUser = &lt;user&gt; and substitute the User value used when you deployed the Wingtip app</span></span>
1. <span data-ttu-id="43146-160">Asegúrese de que está conectado a la base de datos jobaccount y presione **F5** para ejecutar el script.</span><span class="sxs-lookup"><span data-stu-id="43146-160">Ensure you are connected to the jobaccount database and press **F5** to run the script</span></span>

* <span data-ttu-id="43146-161">**sp\_add\_target\_group** crea el nombre del grupo de destino DemoServerGroup. Ahora hay que agregar miembros de destino.</span><span class="sxs-lookup"><span data-stu-id="43146-161">**sp\_add\_target\_group** creates the target group name DemoServerGroup, now we need to add target members.</span></span>
* <span data-ttu-id="43146-162">**sp\_add\_target\_group\_member** agrega un tipo de miembro de destino *servidor* que considera que todas las bases de datos de ese servidor (tenga en cuenta que se trata del servidor tenants1-&lt;Usuario&gt; que contiene las bases de datos de inquilino) en el momento de la ejecución del trabajo deben incluirse en el trabajo. A continuación, se agrega un tipo de miembro de destino *base de datos*, en concreto la base de datos "maestra" (basetenantdb) que reside en el servidor catalog-&lt;Usuario&gt;. Por último, se agrega otro tipo de miembro de destino *base de datos* para incluir la base de datos adhocanalytics que se utiliza en un tutorial posterior.</span><span class="sxs-lookup"><span data-stu-id="43146-162">**sp\_add\_target\_group\_member** adds a *server* target member type, which deems all databases within that server (note this is the tenants1-&lt;User&gt; server containing the tenant databases) at time of job execution should be included in the job, the second is adding a *database* target member type, specifically the ‘golden’ database (basetenantdb) that resides on catalog-&lt;User&gt; server, and lastly another *database* target group member type to include the adhocanalytics database that is used in a later tutorial.</span></span>
* <span data-ttu-id="43146-163">**sp\_add\_job** crea un trabajo llamado “Reference Data Deployment”.</span><span class="sxs-lookup"><span data-stu-id="43146-163">**sp\_add\_job** creates a job called “Reference Data Deployment”</span></span>
* <span data-ttu-id="43146-164">**sp\_add\_jobstep** crea el paso de trabajo que contiene el texto del comando T-SQL para actualizar la tabla de referencia VenueTypes.</span><span class="sxs-lookup"><span data-stu-id="43146-164">**sp\_add\_jobstep** creates the job step containing T-SQL command text to update the reference table, VenueTypes</span></span>
* <span data-ttu-id="43146-165">En las demás vistas del script se muestran los objetos existentes y se supervisa la ejecución de los trabajos.</span><span class="sxs-lookup"><span data-stu-id="43146-165">The remaining views in the script display the existence of the objects and monitor job execution.</span></span> <span data-ttu-id="43146-166">Use estas consultas para revisar el valor de estado en la columna **ciclo de vida** a fin de determinar si el trabajo ha finalizado correctamente en todas las bases de datos de inquilino y las dos bases de datos adicionales que contienen la tabla de referencia.</span><span class="sxs-lookup"><span data-stu-id="43146-166">Use these queries to review the status value in the **lifecycle** column to determine when the job has successfully finished on all tenant databases and the two additional databases containing the reference table.</span></span>

1. <span data-ttu-id="43146-167">En SSMS, vaya a la base de datos *contosoconcerthall* del servidor *tenants1* y consulte la tabla *VenueTypes* para confirmar que *Motorcycle Racing* y *Swimming Club* **figuran** ahora en la lista de resultados.</span><span class="sxs-lookup"><span data-stu-id="43146-167">In SSMS, browse to the *contosoconcerthall* database on the *tenants1* server and query the *VenueTypes* table to confirm that *Motorcycle Racing* and *Swimming Club* **are** now in the results list.</span></span>


## <a name="create-a-job-to-manage-the-reference-table-index"></a><span data-ttu-id="43146-168">Creación de un trabajo para administrar el índice de tabla de referencia</span><span class="sxs-lookup"><span data-stu-id="43146-168">Create a job to manage the reference table index</span></span>

<span data-ttu-id="43146-169">Al igual que en el ejercicio anterior, en este ejercicio se crea un trabajo para volver a crear el índice en la clave principal de la tabla de referencia, una operación de administración de bases de datos habitual que puede realizar un administrador después de cargar una gran cantidad de datos en una tabla.</span><span class="sxs-lookup"><span data-stu-id="43146-169">Similar to the previous exercise, this exercise creates a job to rebuild the index on the reference table primary key, a typical database management operation an administrator might perform after a large data load into a table.</span></span>

<span data-ttu-id="43146-170">Cree un trabajo con los mismos procedimientos almacenados del "sistema" de trabajos.</span><span class="sxs-lookup"><span data-stu-id="43146-170">Create a job using the same jobs 'system' stored procedures.</span></span>

1. <span data-ttu-id="43146-171">Abra SSMS y conéctese al servidor catalog-&lt;Usuario&gt;.database.windows.net.</span><span class="sxs-lookup"><span data-stu-id="43146-171">Open SSMS and connect to the catalog-&lt;User&gt;.database.windows.net server</span></span>
1. <span data-ttu-id="43146-172">Abra el archivo …\\Learning Modules\\Schema Management\\OnlineReindex.sql.</span><span class="sxs-lookup"><span data-stu-id="43146-172">Open the file …\\Learning Modules\\Schema Management\\OnlineReindex.sql</span></span>
1. <span data-ttu-id="43146-173">Haga clic con el botón derecho, seleccione Conexión y conéctese al servidor catalog-&lt;Usuario&gt;.database.windows.net si aún no lo está.</span><span class="sxs-lookup"><span data-stu-id="43146-173">Right click, select Connection, and connect to the catalog-&lt;User&gt;.database.windows.net server, if not already connected</span></span>
1. <span data-ttu-id="43146-174">Asegúrese de que está conectado a la base de datos jobaccount y presione F5 para ejecutar el script.</span><span class="sxs-lookup"><span data-stu-id="43146-174">Ensure you are connected to the jobaccount database and press F5 to run the script</span></span>

* <span data-ttu-id="43146-175">sp\_add\_job crea un nuevo trabajo denominado “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”.</span><span class="sxs-lookup"><span data-stu-id="43146-175">sp\_add\_job creates a new job called “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”</span></span>
* <span data-ttu-id="43146-176">sp\_add\_jobstep crea el paso de trabajo que contiene el texto del comando T-SQL para actualizar el índice.</span><span class="sxs-lookup"><span data-stu-id="43146-176">sp\_add\_jobstep creates the job step containing T-SQL command text to update the index</span></span>




## <a name="next-steps"></a><span data-ttu-id="43146-177">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="43146-177">Next steps</span></span>

<span data-ttu-id="43146-178">En este tutorial, ha aprendido cómo:</span><span class="sxs-lookup"><span data-stu-id="43146-178">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="43146-179">Crear una cuenta de trabajo para consultar en varios inquilinos</span><span class="sxs-lookup"><span data-stu-id="43146-179">Create a job account to query across multiple tenants</span></span>
> * <span data-ttu-id="43146-180">Actualizar datos en todas las bases de datos de inquilino</span><span class="sxs-lookup"><span data-stu-id="43146-180">Update data in all tenant databases</span></span>
> * <span data-ttu-id="43146-181">Crear un índice en una tabla en todas las bases de datos de inquilino</span><span class="sxs-lookup"><span data-stu-id="43146-181">Create an index on a table in all tenant databases</span></span>

[<span data-ttu-id="43146-182">Tutorial de análisis ad hoc</span><span class="sxs-lookup"><span data-stu-id="43146-182">Ad-hoc analytics tutorial</span></span>](sql-database-saas-tutorial-adhoc-analytics.md)


## <a name="additional-resources"></a><span data-ttu-id="43146-183">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="43146-183">Additional resources</span></span>

* [<span data-ttu-id="43146-184">Otros tutoriales basados en la implementación de la aplicación SaaS de Wingtip</span><span class="sxs-lookup"><span data-stu-id="43146-184">Additional tutorials that build upon the Wingtip SaaS application deployment</span></span>](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)
* [<span data-ttu-id="43146-185">Administración de bases de datos escaladas horizontalmente en la nube</span><span class="sxs-lookup"><span data-stu-id="43146-185">Managing scaled-out cloud databases</span></span>](sql-database-elastic-jobs-overview.md)
* [<span data-ttu-id="43146-186">Creación y administración de bases de datos escaladas horizontalmente</span><span class="sxs-lookup"><span data-stu-id="43146-186">Create and manage scaled-out cloud databases</span></span>](sql-database-elastic-jobs-create-and-manage.md)
