---
title: "aaaOperating almacén de consultas de base de datos de SQL Azure"
description: "Obtenga información acerca de cómo toooperate Hola almacén de consultas de base de datos de SQL Azure"
keywords: 
services: sql-database
documentationcenter: 
author: bonova
manager: jhubbard
editor: 
ms.assetid: 0cccf6bd-1327-44f7-a6f9-8eff0c210463
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: sqldb-performance
ms.workload: data-management
ms.date: 11/08/2016
ms.author: bonova
ms.openlocfilehash: ab741e49685bf6df3bceab219aaf57ea51cdb25d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="operating-hello-query-store-in-azure-sql-database"></a><span data-ttu-id="ce25c-103">Hola funcionamiento almacén de consultas de base de datos de SQL Azure</span><span class="sxs-lookup"><span data-stu-id="ce25c-103">Operating hello Query Store in Azure SQL Database</span></span>
<span data-ttu-id="ce25c-104">El Almacén de consultas en Azure es una característica de base de datos completamente administrada que recopila y presenta constantemente información histórica detallada sobre todas las consultas.</span><span class="sxs-lookup"><span data-stu-id="ce25c-104">Query Store in Azure is a fully managed database feature that continuously collects and presents detailed historic information about all queries.</span></span> <span data-ttu-id="ce25c-105">Puede pensar en el almacén de consultas como caja negra de datos del avión tooan similar que significativamente simplifica la solución de problemas para la nube de rendimiento de las consultas y los clientes locales.</span><span class="sxs-lookup"><span data-stu-id="ce25c-105">You can think about Query Store as similar tooan airplane's flight data recorder that significantly simplifies query performance troubleshooting both for cloud and on-premises customers.</span></span> <span data-ttu-id="ce25c-106">En este artículo se explican los aspectos específicos del funcionamiento del Almacén de consultas de Azure.</span><span class="sxs-lookup"><span data-stu-id="ce25c-106">This article explains specific aspects of operating Query Store in Azure.</span></span> <span data-ttu-id="ce25c-107">Con estos datos de consulta previamente recopilados, puede diagnosticar y resolver rápidamente los problemas de rendimiento y así dedicar más tiempo a centrarse en sus negocios.</span><span class="sxs-lookup"><span data-stu-id="ce25c-107">Using this pre-collected query data, you can quickly diagnose and resolve performance problems and thus spend more time focusing on their business.</span></span> 

<span data-ttu-id="ce25c-108">El Almacén de consultas está [disponible globalmente](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) en Base de datos SQL de Azure desde noviembre de 2015.</span><span class="sxs-lookup"><span data-stu-id="ce25c-108">Query Store has been [globally available](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) in Azure SQL Database since November, 2015.</span></span> <span data-ttu-id="ce25c-109">Almacén de consultas está foundation hello para el análisis de rendimiento y optimización de características, como [Asistente de base de datos de SQL y el panel de rendimiento](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span><span class="sxs-lookup"><span data-stu-id="ce25c-109">Query Store is hello foundation for performance analysis and tuning features, such as [SQL Database Advisor and Performance Dashboard](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span></span> <span data-ttu-id="ce25c-110">En el momento de hello sobre la publicación de este artículo, el almacén de consultas se está ejecutando en más de 200.000 bases de datos de usuario en Azure, recopilar información relacionada con la consulta durante varios meses, sin interrupción.</span><span class="sxs-lookup"><span data-stu-id="ce25c-110">At hello moment of publishing this article, Query Store is running in more than 200,000 user databases in Azure, collecting query-related information for several months, without interruption.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ce25c-111">Microsoft está en proceso de saludo de activación de almacén de consultas para todas las bases de datos de SQL Azure (existentes y nuevos).</span><span class="sxs-lookup"><span data-stu-id="ce25c-111">Microsoft is in hello process of activating Query Store for all Azure SQL databases (existing and new).</span></span> 
> 
> 

## <a name="optimal-query-store-configuration"></a><span data-ttu-id="ce25c-112">Configuración óptima del Almacén de consultas</span><span class="sxs-lookup"><span data-stu-id="ce25c-112">Optimal Query Store Configuration</span></span>
<span data-ttu-id="ce25c-113">Esta sección describen los valores predeterminados de la configuración óptima que se tooensure diseñado un funcionamiento confiable del almacén de consultas de Hola y las características dependientes, como [Asistente de base de datos de SQL y el panel de rendimiento](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span><span class="sxs-lookup"><span data-stu-id="ce25c-113">This section describes optimal configuration defaults that are designed tooensure reliable operation of hello Query Store and dependent features, such as [SQL Database Advisor and Performance Dashboard](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span></span> <span data-ttu-id="ce25c-114">La configuración predeterminada está optimizada para una recopilación continua de los datos, es decir, un tiempo mínimo en los estados OFF y READ_ONLY.</span><span class="sxs-lookup"><span data-stu-id="ce25c-114">Default configuration is optimized for continuous data collection, that is minimal time spent in OFF/READ_ONLY states.</span></span>

| <span data-ttu-id="ce25c-115">Configuración</span><span class="sxs-lookup"><span data-stu-id="ce25c-115">Configuration</span></span> | <span data-ttu-id="ce25c-116">Description</span><span class="sxs-lookup"><span data-stu-id="ce25c-116">Description</span></span> | <span data-ttu-id="ce25c-117">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="ce25c-117">Default</span></span> | <span data-ttu-id="ce25c-118">Comentario</span><span class="sxs-lookup"><span data-stu-id="ce25c-118">Comment</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ce25c-119">MAX_STORAGE_SIZE_MB</span><span class="sxs-lookup"><span data-stu-id="ce25c-119">MAX_STORAGE_SIZE_MB</span></span> |<span data-ttu-id="ce25c-120">Especifica el límite de Hola Hola espacio de datos que puede llevar a cabo el almacén de consultas dentro de la base de datos de clientes de z</span><span class="sxs-lookup"><span data-stu-id="ce25c-120">Specifies hello limit for hello data space that Query Store can take inside z customer database</span></span> |<span data-ttu-id="ce25c-121">100</span><span class="sxs-lookup"><span data-stu-id="ce25c-121">100</span></span> |<span data-ttu-id="ce25c-122">Se aplica a nuevas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="ce25c-122">Enforced for new databases</span></span> |
| <span data-ttu-id="ce25c-123">INTERVAL_LENGTH_MINUTES</span><span class="sxs-lookup"><span data-stu-id="ce25c-123">INTERVAL_LENGTH_MINUTES</span></span> |<span data-ttu-id="ce25c-124">Define el tamaño de la ventana de tiempo durante la que se agregan y conservan las estadísticas recopiladas en tiempo de ejecución para los planes de consulta.</span><span class="sxs-lookup"><span data-stu-id="ce25c-124">Defines size of time window during which collected runtime statistics for query plans are aggregated and persisted.</span></span> <span data-ttu-id="ce25c-125">Todos los planes de consulta activa tienen al menos una fila durante un período de tiempo definido con esta configuración.</span><span class="sxs-lookup"><span data-stu-id="ce25c-125">Every active query plan has at most one row for a period of time defined with this configuration</span></span> |<span data-ttu-id="ce25c-126">60</span><span class="sxs-lookup"><span data-stu-id="ce25c-126">60</span></span> |<span data-ttu-id="ce25c-127">Se aplica a nuevas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="ce25c-127">Enforced for new databases</span></span> |
| <span data-ttu-id="ce25c-128">STALE_QUERY_THRESHOLD_DAYS</span><span class="sxs-lookup"><span data-stu-id="ce25c-128">STALE_QUERY_THRESHOLD_DAYS</span></span> |<span data-ttu-id="ce25c-129">Directiva de limpieza basada en el tiempo que controla el período de retención de Hola de estadísticas de tiempo de ejecución persistentes y las consultas inactivas</span><span class="sxs-lookup"><span data-stu-id="ce25c-129">Time-based cleanup policy that controls hello retention period of persisted runtime statistics and inactive queries</span></span> |<span data-ttu-id="ce25c-130">30</span><span class="sxs-lookup"><span data-stu-id="ce25c-130">30</span></span> |<span data-ttu-id="ce25c-131">Se aplica a nuevas bases de datos y bases de datos con la configuración predeterminada anterior (367).</span><span class="sxs-lookup"><span data-stu-id="ce25c-131">Enforced for new databases and databases with previous default (367)</span></span> |
| <span data-ttu-id="ce25c-132">SIZE_BASED_CLEANUP_MODE</span><span class="sxs-lookup"><span data-stu-id="ce25c-132">SIZE_BASED_CLEANUP_MODE</span></span> |<span data-ttu-id="ce25c-133">Especifica si la limpieza automática de los datos tiene lugar cuando el tamaño de datos de almacén de consultas aproxime el límite de Hola</span><span class="sxs-lookup"><span data-stu-id="ce25c-133">Specifies whether automatic data cleanup takes place when Query Store data size approaches hello limit</span></span> |<span data-ttu-id="ce25c-134">AUTO</span><span class="sxs-lookup"><span data-stu-id="ce25c-134">AUTO</span></span> |<span data-ttu-id="ce25c-135">Se aplica a todas las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="ce25c-135">Enforced for all databases</span></span> |
| <span data-ttu-id="ce25c-136">QUERY_CAPTURE_MODE</span><span class="sxs-lookup"><span data-stu-id="ce25c-136">QUERY_CAPTURE_MODE</span></span> |<span data-ttu-id="ce25c-137">Especifica si se realiza el seguimiento de todas las consultas o solo de un subconjunto de estas.</span><span class="sxs-lookup"><span data-stu-id="ce25c-137">Specifies whether all queries or only a subset of queries are tracked</span></span> |<span data-ttu-id="ce25c-138">AUTO</span><span class="sxs-lookup"><span data-stu-id="ce25c-138">AUTO</span></span> |<span data-ttu-id="ce25c-139">Se aplica a todas las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="ce25c-139">Enforced for all databases</span></span> |
| <span data-ttu-id="ce25c-140">FLUSH_INTERVAL_SECONDS</span><span class="sxs-lookup"><span data-stu-id="ce25c-140">FLUSH_INTERVAL_SECONDS</span></span> |<span data-ttu-id="ce25c-141">Especifica el periodo máximo durante el cual las estadísticas del runtime capturada se mantienen en memoria, antes del vaciado toodisk</span><span class="sxs-lookup"><span data-stu-id="ce25c-141">Specifies maximum period during which captured runtime statistics are kept in memory, before flushing toodisk</span></span> |<span data-ttu-id="ce25c-142">900</span><span class="sxs-lookup"><span data-stu-id="ce25c-142">900</span></span> |<span data-ttu-id="ce25c-143">Se aplica a nuevas bases de datos.</span><span class="sxs-lookup"><span data-stu-id="ce25c-143">Enforced for new databases</span></span> |
|  | | | |

> [!IMPORTANT]
> <span data-ttu-id="ce25c-144">Estos valores predeterminados se aplican automáticamente en la fase final de saludo de activación de almacén de consultas en todas las bases de datos de SQL Azure (vea la nota importante anterior).</span><span class="sxs-lookup"><span data-stu-id="ce25c-144">These defaults are automatically applied in hello final stage of Query Store activation in all Azure SQL databases (see preceding important note).</span></span> <span data-ttu-id="ce25c-145">Después de esta luz de una base de datos de SQL Azure no cambiar los valores de configuración establecidos por los clientes, a menos que afecten negativamente a operaciones confiables de hello almacén de consultas o carga de trabajo principal.</span><span class="sxs-lookup"><span data-stu-id="ce25c-145">After this light up, Azure SQL Database won’t be changing configuration values set by customers, unless they negatively impact primary workload or reliable operations of hello Query Store.</span></span>
> 
> 

<span data-ttu-id="ce25c-146">Si desea toostay con su configuración personalizada, utilice [ALTER DATABASE con las opciones de almacén de consultas](https://msdn.microsoft.com/library/bb522682.aspx) estado anterior de toorevert configuración toohello.</span><span class="sxs-lookup"><span data-stu-id="ce25c-146">If you want toostay with your custom settings, use [ALTER DATABASE with Query Store options](https://msdn.microsoft.com/library/bb522682.aspx) toorevert configuration toohello previous state.</span></span> <span data-ttu-id="ce25c-147">Extraer del repositorio [prácticas recomendadas con hello almacén de consultas](https://msdn.microsoft.com/library/mt604821.aspx) en orden toolearn cómo superior eligió parámetros de configuración óptima.</span><span class="sxs-lookup"><span data-stu-id="ce25c-147">Check out [Best Practices with hello Query Store](https://msdn.microsoft.com/library/mt604821.aspx) in order toolearn how top chose optimal configuration parameters.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ce25c-148">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="ce25c-148">Next steps</span></span>
[<span data-ttu-id="ce25c-149">SQL Database Performance Insight (Información de rendimiento de Base de datos SQL)</span><span class="sxs-lookup"><span data-stu-id="ce25c-149">SQL Database Performance Insight</span></span>](sql-database-performance.md)

## <a name="additional-resources"></a><span data-ttu-id="ce25c-150">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="ce25c-150">Additional resources</span></span>
<span data-ttu-id="ce25c-151">Para más información desproteger Hola siguientes artículos:</span><span class="sxs-lookup"><span data-stu-id="ce25c-151">For more information check out hello following articles:</span></span>

* [<span data-ttu-id="ce25c-152">A flight data recorder for your database (Una caja negra para la base de datos)</span><span class="sxs-lookup"><span data-stu-id="ce25c-152">A flight data recorder for your database</span></span>](https://azure.microsoft.com/blog/query-store-a-flight-data-recorder-for-your-database) 
* [<span data-ttu-id="ce25c-153">Supervisión de rendimiento usando el almacén de consultas de Hola</span><span class="sxs-lookup"><span data-stu-id="ce25c-153">Monitoring Performance By Using hello Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="ce25c-154">Query Store Usage Scenarios (Escenarios de uso del Almacén de consultas)</span><span class="sxs-lookup"><span data-stu-id="ce25c-154">Query Store Usage Scenarios</span></span>](https://msdn.microsoft.com/library/mt614796.aspx)
* [<span data-ttu-id="ce25c-155">Supervisión de rendimiento usando el almacén de consultas de Hola</span><span class="sxs-lookup"><span data-stu-id="ce25c-155">Monitoring Performance By Using hello Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx) 

