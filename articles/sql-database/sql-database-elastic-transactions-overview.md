---
title: aaaDistributed transacciones entre bases de datos en la nube
description: "Introducción sobre las transacciones de base de datos elástica con Base de datos SQL de Azure"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: 9a18f2749108d337bf115b3dc21dd0c7828dd9c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="8d772-103">Introducción sobre las transacciones de base de datos elástica con Base de datos SQL de Azure</span><span class="sxs-lookup"><span data-stu-id="8d772-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="8d772-104">Transacciones de bases de datos elástica para base de datos de SQL de Azure (base de datos SQL) le permiten transacciones toorun que abarcan varias bases de datos en la base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you toorun transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="8d772-105">Las transacciones de base de datos elástica para base de datos SQL están disponibles para aplicaciones .NET mediante ADO .NET e integrar con experiencia de programación familiar hello mediante hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) clases.</span><span class="sxs-lookup"><span data-stu-id="8d772-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with hello familiar programming experience using hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="8d772-106">biblioteca de hello tooget, consulte [.NET Framework 4.6.1 (instalador Web)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="8d772-106">tooget hello library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="8d772-107">De forma local, este escenario requiere normalmente la ejecución del Coordinador de transacciones distribuidas de Microsoft (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="8d772-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="8d772-108">Puesto que MSDTC no está disponible para la aplicación de plataforma como servicio en Azure, las transacciones de hello capacidad toocoordinate distribuida se ahora ha directamente integrado en la base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, hello ability toocoordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="8d772-109">Las aplicaciones pueden conectarse a las transacciones toolaunch distribuida de base de datos SQL de tooany y una de las bases de datos de hello transparente coordinará transacción Hola distribuida, como se muestra en la figura siguiente de Hola.</span><span class="sxs-lookup"><span data-stu-id="8d772-109">Applications can connect tooany SQL Database toolaunch distributed transactions, and one of hello databases will transparently coordinate hello distributed transaction, as shown in hello following figure.</span></span> 

  ![<span data-ttu-id="8d772-110">Transacciones distribuidas con Base de datos SQL de Azure mediante transacciones de base de datos elástica</span><span class="sxs-lookup"><span data-stu-id="8d772-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="8d772-111">Escenarios comunes</span><span class="sxs-lookup"><span data-stu-id="8d772-111">Common scenarios</span></span>
<span data-ttu-id="8d772-112">Las transacciones de base de datos elástica para base de datos SQL habilitar aplicaciones toomake cambios atómicos toodata almacenado en varias bases de datos diferentes de SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-112">Elastic database transactions for SQL DB enable applications toomake atomic changes toodata stored in several different SQL Databases.</span></span> <span data-ttu-id="8d772-113">vista previa de Hola se centra en las experiencias de desarrollo en el cliente en C# y. NET.</span><span class="sxs-lookup"><span data-stu-id="8d772-113">hello preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="8d772-114">Para más adelante está prevista una experiencia en el lado servidor mediante T-SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="8d772-115">Hola de destinos de las transacciones de base de datos elástica los escenarios siguientes:</span><span class="sxs-lookup"><span data-stu-id="8d772-115">Elastic database transactions targets hello following scenarios:</span></span>

* <span data-ttu-id="8d772-116">Aplicaciones de varias bases de datos en Azure: con este escenario, los datos se particionan verticalmente entre varias bases de datos de Base de datos SQL de forma que diferentes clases de datos residen en diferentes bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8d772-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="8d772-117">Algunas operaciones requieren toodata de cambios que se mantiene en dos o más bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8d772-117">Some operations require changes toodata which is kept in two or more databases.</span></span> <span data-ttu-id="8d772-118">aplicación Hello usa cambios de hello toocoordinate de base de datos elástica transacciones entre bases de datos y garantizar la atomicidad.</span><span class="sxs-lookup"><span data-stu-id="8d772-118">hello application uses elastic database transactions toocoordinate hello changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="8d772-119">Aplicaciones de base de datos particionada en Azure: con este escenario, la capa de datos de Hola usa hello [biblioteca de cliente de base de datos elástica](sql-database-elastic-database-client-library.md) o toohorizontally de particionamiento automático partición Hola datos entre varias bases de datos en la base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-119">Sharded database applications in Azure: With this scenario, hello data tier uses hello [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding toohorizontally partition hello data across many databases in SQL DB.</span></span> <span data-ttu-id="8d772-120">Un caso de uso principales resulta cambios atómicos tooperform de hello necesario para una aplicación de varios inquilinos particionada cambios abarcan los inquilinos.</span><span class="sxs-lookup"><span data-stu-id="8d772-120">One prominent use case is hello need tooperform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="8d772-121">Piense en una transferencia de un inquilino tooanother, ambos que residen en diferentes bases de datos para la instancia.</span><span class="sxs-lookup"><span data-stu-id="8d772-121">Think for instance of a transfer from one tenant tooanother, both residing on different databases.</span></span> <span data-ttu-id="8d772-122">Un segundo caso es específica particionamiento tooaccommodate las necesidades de capacidad para un inquilino de gran tamaño que a su vez suele implicar que algunos toostretch de necesidades de operaciones atómicas en varias bases de datos utilizadas para hello mismo inquilino.</span><span class="sxs-lookup"><span data-stu-id="8d772-122">A second case is fine-grained sharding tooaccommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs toostretch across several databases used for hello same tenant.</span></span> <span data-ttu-id="8d772-123">Un tercer caso es tooreference una actualización atómica de datos que se replican a través de las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8d772-123">A third case is atomic updates tooreference data that are replicated across databases.</span></span> <span data-ttu-id="8d772-124">Ahora se pueden coordinar operaciones atómicas, transacciones, a lo largo de estas líneas a través de varias bases de datos mediante la vista previa de Hola.</span><span class="sxs-lookup"><span data-stu-id="8d772-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using hello preview.</span></span>
  <span data-ttu-id="8d772-125">Las transacciones de base de datos elástica usan atomicidad de transacciones de confirmación en dos fases tooensure entre bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8d772-125">Elastic database transactions use two-phase commit tooensure transaction atomicity across databases.</span></span> <span data-ttu-id="8d772-126">Esto resulta adecuado para transacciones que suponen menos de 100 bases de datos a la vez en una única transacción.</span><span class="sxs-lookup"><span data-stu-id="8d772-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="8d772-127">No se aplican estos límites, pero uno debe esperar tasas de éxito para toosuffer de las transacciones de bases de datos elásticas y rendimiento cuando superen estos límites.</span><span class="sxs-lookup"><span data-stu-id="8d772-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions toosuffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="8d772-128">Instalación y migración</span><span class="sxs-lookup"><span data-stu-id="8d772-128">Installation and migration</span></span>
<span data-ttu-id="8d772-129">se proporcionan capacidades de Hola para las transacciones de base de datos elástica de base de datos SQL a través de bibliotecas de .NET de las actualizaciones toohello System.Data.dll y System.Transactions.dll.</span><span class="sxs-lookup"><span data-stu-id="8d772-129">hello capabilities for elastic database transactions in SQL DB are provided through updates toohello .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="8d772-130">Hello dll asegurarse de que se confirman en dos fases se utiliza cuando sea necesario tooensure atomicidad.</span><span class="sxs-lookup"><span data-stu-id="8d772-130">hello DLLs ensure that two-phase commit is used where necessary tooensure atomicity.</span></span> <span data-ttu-id="8d772-131">el uso de transacciones de base de datos elástica, desarrollo de aplicaciones de toostart instalar [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) o una versión posterior.</span><span class="sxs-lookup"><span data-stu-id="8d772-131">toostart developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="8d772-132">Cuando se ejecuta en una versión anterior de .NET framework de hello, las transacciones se producirá un error toopromote tooa distribuida transaction y se producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="8d772-132">When running on an earlier version of hello .NET framework, transactions will fail toopromote tooa distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="8d772-133">Después de la instalación, puede usar transacciones distribuida de hello API de System.Transactions con conexiones tooSQL DB.</span><span class="sxs-lookup"><span data-stu-id="8d772-133">After installation, you can use hello distributed transaction APIs in System.Transactions with connections tooSQL DB.</span></span> <span data-ttu-id="8d772-134">Si tiene aplicaciones existentes de MSDTC que utilizan estas API, basta con volver a generar las aplicaciones existentes de .NET 4.6 después de instalar Hola 4.6.1 Framework.</span><span class="sxs-lookup"><span data-stu-id="8d772-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing hello 4.6.1 Framework.</span></span> <span data-ttu-id="8d772-135">Si los proyectos destinados a .NET 4.6, usarán automáticamente archivos DLL de hello actualizado de la nueva versión de Framework hello y llamadas de API de transacciones distribuidas en combinación con tooSQL conexiones que DB ahora se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="8d772-135">If your projects target .NET 4.6, they will automatically use hello updated DLLs from hello new Framework version and distributed transaction API calls in combination with connections tooSQL DB will now succeed.</span></span>

<span data-ttu-id="8d772-136">Recuerde que las transacciones de base de datos elástica no precisan la instalación de MSDTC.</span><span class="sxs-lookup"><span data-stu-id="8d772-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="8d772-137">Por el contrario, se administran directamente mediante y dentro de Base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="8d772-138">Esto simplifica notablemente escenarios de nube como una implementación de MSDTC no es necesario toouse distribuida transacciones con la base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary toouse distributed transactions with SQL DB.</span></span> <span data-ttu-id="8d772-139">Sección 4 se explica con más detalle cómo Hola y las transacciones de base de datos elástica toodeploy requieren .NET framework junto con su tooAzure de aplicaciones de nube.</span><span class="sxs-lookup"><span data-stu-id="8d772-139">Section 4 explains in more detail how toodeploy elastic database transactions and hello required .NET framework together with your cloud applications tooAzure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="8d772-140">Experiencia de desarrollo</span><span class="sxs-lookup"><span data-stu-id="8d772-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="8d772-141">Aplicaciones de varias bases de datos</span><span class="sxs-lookup"><span data-stu-id="8d772-141">Multi-database applications</span></span>
<span data-ttu-id="8d772-142">Hello código de ejemplo siguiente utiliza experiencia de programación familiar Hola con .NET System.Transactions.</span><span class="sxs-lookup"><span data-stu-id="8d772-142">hello following sample code uses hello familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="8d772-143">Hola TransactionScope, clase establece una transacción de ambiente en. NET.</span><span class="sxs-lookup"><span data-stu-id="8d772-143">hello TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="8d772-144">(Una "transacción ambiente" es uno que reside en el subproceso actual de hello). Todas las conexiones abiertas dentro de hello TransactionScope participan en transacciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="8d772-144">(An “ambient transaction” is one that lives in hello current thread.) All connections opened within hello TransactionScope participate in hello transaction.</span></span> <span data-ttu-id="8d772-145">Si diferentes bases de datos participan, hello es transacción tooa automáticamente con privilegios elevados distribuida.</span><span class="sxs-lookup"><span data-stu-id="8d772-145">If different databases participate, hello transaction is automatically elevated tooa distributed transaction.</span></span> <span data-ttu-id="8d772-146">resultado de Hello de transacción de Hola se controla estableciendo Hola ámbito toocomplete tooindicate una confirmación.</span><span class="sxs-lookup"><span data-stu-id="8d772-146">hello outcome of hello transaction is controlled by setting hello scope toocomplete tooindicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="8d772-147">Aplicaciones de base de datos particionada</span><span class="sxs-lookup"><span data-stu-id="8d772-147">Sharded database applications</span></span>
<span data-ttu-id="8d772-148">Las transacciones de base de datos elástica para base de datos SQL también admiten coordinar las transacciones distribuidas donde se utiliza método de OpenConnectionForKey de Hola Hola bases de datos elásticas biblioteca tooopen de conexiones de cliente para un repositorio ampliados datos capa.</span><span class="sxs-lookup"><span data-stu-id="8d772-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use hello OpenConnectionForKey method of hello elastic database client library tooopen connections for a scaled out data tier.</span></span> <span data-ttu-id="8d772-149">Considere la posibilidad de casos donde es necesario tooguarantee la coherencia transaccional de cambios a través de varios valores de clave de particionamiento diferente.</span><span class="sxs-lookup"><span data-stu-id="8d772-149">Consider cases where you need tooguarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="8d772-150">Particiones de toohello conexiones hospedaje de los valores de clave de particionamiento diferente de Hola se asíncrona mediante OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="8d772-150">Connections toohello shards hosting hello different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="8d772-151">En el caso general de hello, las conexiones de hello pueden ser toodifferent particiones tal que garantizar garantías transaccionales requiere una transacción distribuida.</span><span class="sxs-lookup"><span data-stu-id="8d772-151">In hello general case, hello connections can be toodifferent shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="8d772-152">Hola siguiendo el ejemplo de código muestra este enfoque.</span><span class="sxs-lookup"><span data-stu-id="8d772-152">hello following code sample illustrates this approach.</span></span> <span data-ttu-id="8d772-153">Se supone que una variable denominada shardmap está toorepresent usa una partición se asignan desde la biblioteca de cliente de base de datos elástica hello:</span><span class="sxs-lookup"><span data-stu-id="8d772-153">It assumes that a variable called shardmap is used toorepresent a shard map from hello elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="8d772-154">Instalación de .NET para servicios en la nube de Azure</span><span class="sxs-lookup"><span data-stu-id="8d772-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="8d772-155">Azure proporciona varias ofertas de aplicaciones de .NET toohost.</span><span class="sxs-lookup"><span data-stu-id="8d772-155">Azure provides several offerings toohost .NET applications.</span></span> <span data-ttu-id="8d772-156">Está disponible en una comparación de diferentes ofertas de hello [comparación de servicio de aplicaciones de Azure, servicios en la nube y máquinas virtuales](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="8d772-156">A comparison of hello different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="8d772-157">Si hello SO invitado de oferta de hello es menor que .NET 4.6.1 necesarias para transacciones elásticas, deberá too4.6.1 de SO invitado de tooupgrade Hola.</span><span class="sxs-lookup"><span data-stu-id="8d772-157">If hello guest OS of hello offering is smaller than .NET 4.6.1 required for elastic transactions, you need tooupgrade hello guest OS too4.6.1.</span></span> 

<span data-ttu-id="8d772-158">Para los servicios de aplicación de Azure, actualiza a invitado toohello que SO no se admite actualmente.</span><span class="sxs-lookup"><span data-stu-id="8d772-158">For Azure App Services, upgrades toohello guest OS are currently not supported.</span></span> <span data-ttu-id="8d772-159">Para máquinas de virtuales de Azure, simplemente inicie sesión en hello VM y ejecutar el instalador de Hola para hello más reciente de .NET framework.</span><span class="sxs-lookup"><span data-stu-id="8d772-159">For Azure Virtual Machines, simply log into hello VM and run hello installer for hello latest .NET framework.</span></span> <span data-ttu-id="8d772-160">Para los servicios de nube de Azure, necesita la instalación de hello tooinclude de una versión más reciente de .NET en las tareas de inicio de saludo de la implementación.</span><span class="sxs-lookup"><span data-stu-id="8d772-160">For Azure Cloud Services, you need tooinclude hello installation of a newer .NET version into hello startup tasks of your deployment.</span></span> <span data-ttu-id="8d772-161">conceptos de Hola y pasos se documentan en [instalar .NET en un rol de servicio de nube](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="8d772-161">hello concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="8d772-162">Tenga en cuenta que Hola instalador para .NET 4.6.1 puede requerir más espacio de almacenamiento temporal durante Hola arranque proceso en los servicios de nube de Azure de Hola a instalador de .NET 4.6.</span><span class="sxs-lookup"><span data-stu-id="8d772-162">Note that hello installer for .NET 4.6.1 may require more temporary storage during hello bootstrapping process on Azure cloud services than hello installer for .NET 4.6.</span></span> <span data-ttu-id="8d772-163">tooensure una instalación correcta, se necesita tooincrease almacenamiento temporal para el servicio de nube de Azure en el archivo ServiceDefinition.csdef, en la sección de LocalResources de Hola y configuración del entorno de saludo de la tarea de inicio, como se muestra en la siguiente Hola ejemplo:</span><span class="sxs-lookup"><span data-stu-id="8d772-163">tooensure a successful installation, you need tooincrease temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in hello LocalResources section and hello environment settings of your startup task, as shown in hello following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="8d772-164">Transacciones entre varios servidores</span><span class="sxs-lookup"><span data-stu-id="8d772-164">Transactions across multiple servers</span></span>
<span data-ttu-id="8d772-165">Se admiten transacciones de la base de datos elástica entre diferentes servidores lógicos en Base de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="8d772-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="8d772-166">Cuando las transacciones cruzan los límites del servidor lógico, los servidores participantes Hola primero deben toobe especificado en una relación mutua de comunicación.</span><span class="sxs-lookup"><span data-stu-id="8d772-166">When transactions cross logical server boundaries, hello participating servers first need toobe entered into a mutual communication relationship.</span></span> <span data-ttu-id="8d772-167">Una vez que se haya establecido la relación de comunicación de hello, cualquier base de datos en cualquiera de hello dos servidores pueden participar en transacciones elásticas con bases de datos de Hola a otro servidor.</span><span class="sxs-lookup"><span data-stu-id="8d772-167">Once hello communication relationship has been established, any database in any of hello two servers can participate in elastic transactions with databases from hello other server.</span></span> <span data-ttu-id="8d772-168">Con transacciones distribuidas en más de dos servidores lógicos, una relación de comunicación debe toobe en lugar de cualquier par de servidores lógicos.</span><span class="sxs-lookup"><span data-stu-id="8d772-168">With transactions spanning more than two logical servers, a communication relationship needs toobe in place for any pair of logical servers.</span></span>

<span data-ttu-id="8d772-169">Usar hello siguiendo las relaciones de toomanage comunicación entre servidores cmdlets de PowerShell para las transacciones de base de datos elástica:</span><span class="sxs-lookup"><span data-stu-id="8d772-169">Use hello following PowerShell cmdlets toomanage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="8d772-170">**Nueva AzureRmSqlServerCommunicationLink**: Utilice esta toocreate cmdlet una nueva relación de comunicación entre dos servidores lógicos de base de datos de SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="8d772-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet toocreate a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="8d772-171">relación de Hello es simétrica, lo que significa que ambos servidores pueden iniciar transacciones con hello otro servidor.</span><span class="sxs-lookup"><span data-stu-id="8d772-171">hello relationship is symmetric which means both servers can initiate transactions with hello other server.</span></span>
* <span data-ttu-id="8d772-172">**Get-AzureRmSqlServerCommunicationLink**: Utilice esta comunicación existente de cmdlet tooretrieve relaciones y sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="8d772-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooretrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="8d772-173">**Remove-AzureRmSqlServerCommunicationLink**: Utilice esta tooremove cmdlet una relación de comunicación existente.</span><span class="sxs-lookup"><span data-stu-id="8d772-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooremove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="8d772-174">Supervisión del estado de la transacción</span><span class="sxs-lookup"><span data-stu-id="8d772-174">Monitoring transaction status</span></span>
<span data-ttu-id="8d772-175">Usar vistas de administración dinámica (DMV) en la base de datos SQL toomonitor estado y progreso de las transacciones de base de datos elástica en curso.</span><span class="sxs-lookup"><span data-stu-id="8d772-175">Use Dynamic Management Views (DMVs) in SQL DB toomonitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="8d772-176">Todos los tootransactions relacionados de DMV son relevantes para las transacciones distribuidas en la base de datos de SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-176">All DMVs related tootransactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="8d772-177">Puede encontrar Hola correspondiente lista DMV aquí: [transacciones relacionadas Dynamic Management Views y funciones (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d772-177">You can find hello corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="8d772-178">Estas DMV son especialmente útiles:</span><span class="sxs-lookup"><span data-stu-id="8d772-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="8d772-179">**sys.dm\_tran\_active\_transactions**: enumera las transacciones actualmente activas y su estado.</span><span class="sxs-lookup"><span data-stu-id="8d772-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="8d772-180">Hello columna UOW (unidad de trabajo) puede identificar Hola secundarios diferentes las transacciones que pertenecen toohello mismo una transacción distribuida.</span><span class="sxs-lookup"><span data-stu-id="8d772-180">hello UOW (Unit Of Work) column can identify hello different child transactions that belong toohello same distributed transaction.</span></span> <span data-ttu-id="8d772-181">Todas las transacciones dentro de hello llevar la misma transacción distribuida Hola mismo valor UOW.</span><span class="sxs-lookup"><span data-stu-id="8d772-181">All transactions within hello same distributed transaction carry hello same UOW value.</span></span> <span data-ttu-id="8d772-182">Vea hello [documentación DMV](https://msdn.microsoft.com/library/ms174302.aspx) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="8d772-182">See hello [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="8d772-183">**Sys.DM\_tran\_base de datos\_transacciones**: proporciona información adicional sobre las transacciones, como la colocación de transacción de hello en el registro de hello.</span><span class="sxs-lookup"><span data-stu-id="8d772-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of hello transaction in hello log.</span></span> <span data-ttu-id="8d772-184">Vea hello [documentación DMV](https://msdn.microsoft.com/library/ms186957.aspx) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="8d772-184">See hello [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="8d772-185">**Sys.DM\_tran\_bloqueos**: proporciona información sobre los bloqueos de Hola que actualmente se incluyen en las transacciones en curso.</span><span class="sxs-lookup"><span data-stu-id="8d772-185">**sys.dm\_tran\_locks**: Provides information about hello locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="8d772-186">Vea hello [documentación DMV](https://msdn.microsoft.com/library/ms190345.aspx) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="8d772-186">See hello [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="8d772-187">Limitaciones</span><span class="sxs-lookup"><span data-stu-id="8d772-187">Limitations</span></span>
<span data-ttu-id="8d772-188">Hola después actualmente limitaciones aplica tooelastic transacciones de bases de datos en la base de datos SQL:</span><span class="sxs-lookup"><span data-stu-id="8d772-188">hello following limitations currently apply tooelastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="8d772-189">Se admiten únicamente transacciones entre bases de datos en Base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="8d772-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="8d772-190">Otros proveedores de recursos y bases de datos de [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) externos a Base de datos SQL no podrán participar en transacciones de base de datos elástica.</span><span class="sxs-lookup"><span data-stu-id="8d772-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="8d772-191">Esto significa que dichas transacciones no pueden extenderse entre bases de datos locales de SQL Server y SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="8d772-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="8d772-192">Para las transacciones distribuidas de forma local, continuar toouse MSDTC.</span><span class="sxs-lookup"><span data-stu-id="8d772-192">For distributed transactions on premises, continue toouse MSDTC.</span></span> 
* <span data-ttu-id="8d772-193">Solo se admiten transacciones coordinadas por el cliente desde una aplicación .NET.</span><span class="sxs-lookup"><span data-stu-id="8d772-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="8d772-194">Está prevista la compatibilidad en el lado servidor con T-SQL, por ejemplo, INICIAR TRANSACCIÓN DISTRIBUIDA, pero aún no se encuentra disponible.</span><span class="sxs-lookup"><span data-stu-id="8d772-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="8d772-195">No se admiten las transacciones por los servicios de WCF.</span><span class="sxs-lookup"><span data-stu-id="8d772-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="8d772-196">Por ejemplo, tiene un método de servicio de WCF que se ejecuta una transacción.</span><span class="sxs-lookup"><span data-stu-id="8d772-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="8d772-197">Envolvente Hola llamada dentro de un ámbito de transacción se producirá un error como un [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="8d772-197">Enclosing hello call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8d772-198">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="8d772-198">Next steps</span></span>
<span data-ttu-id="8d772-199">Si tiene preguntas, póngase en contacto toous en hello [foro de base de datos SQL](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) y para las solicitudes de características, agréguelos toohello [foro de comentarios de la base de datos SQL](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="8d772-199">For questions, please reach out toous on hello [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them toohello [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



