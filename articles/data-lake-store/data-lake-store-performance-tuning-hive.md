---
title: "aaaAzure datos Lake almacén Hive rendimiento directrices de ajuste | Documentos de Microsoft"
description: "Directrices para la optimización del rendimiento de Hive en Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: e44daeb6ad3b64e893c709df63b56444a330729f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-hive-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="4324d-103">Guía para la optimización del rendimiento de Hive en HDInsight y Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="4324d-103">Performance tuning guidance for Hive on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="4324d-104">configuración predeterminada de Hola se establecieron tooprovide un buen rendimiento en muchos casos de uso diferentes.</span><span class="sxs-lookup"><span data-stu-id="4324d-104">hello default settings have been set tooprovide good performance across many different use cases.</span></span>  <span data-ttu-id="4324d-105">Para las consultas de uso intensivo de E/S, subárbol puede ser un mejor rendimiento de tooget optimizada con ADLS.</span><span class="sxs-lookup"><span data-stu-id="4324d-105">For I/O intensive queries, Hive can be tuned tooget better performance with ADLS.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="4324d-106">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="4324d-106">Prerequisites</span></span>

* <span data-ttu-id="4324d-107">**Una suscripción de Azure**.</span><span class="sxs-lookup"><span data-stu-id="4324d-107">**An Azure subscription**.</span></span> <span data-ttu-id="4324d-108">Vea [Obtener evaluación gratuita de Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="4324d-108">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="4324d-109">**Una cuenta de Almacén de Azure Data Lake**.</span><span class="sxs-lookup"><span data-stu-id="4324d-109">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="4324d-110">Para obtener instrucciones sobre cómo toocreate un, consulte [empezar a trabajar con el almacén de Azure Data Lake](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="4324d-110">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="4324d-111">**Clúster de HDInsight de Azure** con acceso tooa cuenta de almacén de Data Lake.</span><span class="sxs-lookup"><span data-stu-id="4324d-111">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="4324d-112">Consulte [Creación de un clúster de HDInsight con Data Lake Store mediante el Portal de Azure](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="4324d-112">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="4324d-113">Asegúrese de que habilitar Escritorio remoto para el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="4324d-113">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="4324d-114">**Ejecución de Hive en HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="4324d-114">**Running Hive on HDInsight**.</span></span>  <span data-ttu-id="4324d-115">toolearn acerca de cómo ejecutar trabajos de Hive en HDInsight, vea [uso Hive en HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span><span class="sxs-lookup"><span data-stu-id="4324d-115">toolearn about running Hive jobs on HDInsight, see [Use Hive on HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span></span>
* <span data-ttu-id="4324d-116">**Directrices para la optimización del rendimiento en ADLS**.</span><span class="sxs-lookup"><span data-stu-id="4324d-116">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="4324d-117">Para conocer los conceptos generales de rendimiento, consulte [Guía para la optimización del rendimiento de Azure Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="4324d-117">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span>

## <a name="parameters"></a><span data-ttu-id="4324d-118">parameters</span><span class="sxs-lookup"><span data-stu-id="4324d-118">Parameters</span></span>

<span data-ttu-id="4324d-119">A continuación, incluimos hello tootune más importante de configuración para mejorar el rendimiento de ADLS:</span><span class="sxs-lookup"><span data-stu-id="4324d-119">Here are hello most important settings tootune for improved ADLS performance:</span></span>

* <span data-ttu-id="4324d-120">**Hive.tez.Container.Size** : cantidad de Hola de memoria usada por cada tareas</span><span class="sxs-lookup"><span data-stu-id="4324d-120">**hive.tez.container.size** – hello amount of memory used by each tasks</span></span>

* <span data-ttu-id="4324d-121">**tez.grouping.min-size**: tamaño mínimo de cada asignador.</span><span class="sxs-lookup"><span data-stu-id="4324d-121">**tez.grouping.min-size** – minimum size of each mapper</span></span>

* <span data-ttu-id="4324d-122">**tez.grouping.min-size**: tamaño mínimo de cada asignador.</span><span class="sxs-lookup"><span data-stu-id="4324d-122">**tez.grouping.max-size** – maximum size of each mapper</span></span>

* <span data-ttu-id="4324d-123">**hive.exec.reducer.bytes.per.reducer**: tamaño de cada reductor.</span><span class="sxs-lookup"><span data-stu-id="4324d-123">**hive.exec.reducer.bytes.per.reducer** – size of each reducer</span></span>

<span data-ttu-id="4324d-124">**Hive.tez.Container.Size** -tamaño del contenedor de hello determina la cantidad de memoria está disponible para cada tarea.</span><span class="sxs-lookup"><span data-stu-id="4324d-124">**hive.tez.container.size** - hello container size determines how much memory is available for each task.</span></span>  <span data-ttu-id="4324d-125">Se trata de entrada principal de Hola para control de simultaneidad de hello en el subárbol.</span><span class="sxs-lookup"><span data-stu-id="4324d-125">This is hello main input for controlling hello concurrency in Hive.</span></span>  

<span data-ttu-id="4324d-126">**tamaño de tez.GROUPING.min** : este parámetro permite un tamaño mínimo de hello tooset de cada asignador.</span><span class="sxs-lookup"><span data-stu-id="4324d-126">**tez.grouping.min-size** – This parameter allows you tooset hello minimum size of each mapper.</span></span>  <span data-ttu-id="4324d-127">Si el número de Hola de asignadores que Tez elige es menor que el valor de Hola de este parámetro, Tez utilizará valor Hola establecido aquí.</span><span class="sxs-lookup"><span data-stu-id="4324d-127">If hello number of mappers that Tez chooses is smaller than hello value of this parameter, then Tez will use hello value set here.</span></span>  

<span data-ttu-id="4324d-128">**tamaño de tez.GROUPING.max** : parámetro hello permite un tamaño máximo de hello tooset de cada asignador.</span><span class="sxs-lookup"><span data-stu-id="4324d-128">**tez.grouping.max-size** – hello parameter allows you tooset hello maximum size of each mapper.</span></span>  <span data-ttu-id="4324d-129">Si el número de Hola de asignadores que elige Tez es mayor que el valor de Hola de este parámetro, Tez utilizará valor Hola establecido aquí.</span><span class="sxs-lookup"><span data-stu-id="4324d-129">If hello number of mappers that Tez chooses is larger than hello value of this parameter, then Tez will use hello value set here.</span></span>  

<span data-ttu-id="4324d-130">**Hive.Exec.reducer.bytes.per.reducer** : este parámetro establece el tamaño de Hola de cada reductor.</span><span class="sxs-lookup"><span data-stu-id="4324d-130">**hive.exec.reducer.bytes.per.reducer** – This parameter sets hello size of each reducer.</span></span>  <span data-ttu-id="4324d-131">De forma predeterminada, cada reductor tiene 256 MB.</span><span class="sxs-lookup"><span data-stu-id="4324d-131">By default, each reducer is 256MB.</span></span>  

## <a name="guidance"></a><span data-ttu-id="4324d-132">Guía</span><span class="sxs-lookup"><span data-stu-id="4324d-132">Guidance</span></span>

<span data-ttu-id="4324d-133">**Establecer hive.exec.reducer.bytes.per.reducer** : valor predeterminado de hello funciona bien cuando los datos de hello están sin comprimir.</span><span class="sxs-lookup"><span data-stu-id="4324d-133">**Set hive.exec.reducer.bytes.per.reducer** – hello default value works well when hello data is uncompressed.</span></span>  <span data-ttu-id="4324d-134">Para los datos que se ha comprimido, debe reducir tamaño de hello del reductor Hola.</span><span class="sxs-lookup"><span data-stu-id="4324d-134">For data that is compressed, you should reduce hello size of hello reducer.</span></span>  

<span data-ttu-id="4324d-135">**Set hive.tez.container.size**: en cada nodo, la memoria se especifica mediante yarn.nodemanager.resource.memory-mb y se debe establecer correctamente en el clúster de HDI de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="4324d-135">**Set hive.tez.container.size** – In each node, memory is specified by yarn.nodemanager.resource.memory-mb and should be correctly set on HDI cluster by default.</span></span>  <span data-ttu-id="4324d-136">Para obtener información adicional acerca de la configuración de memoria apropiada de hello en hilo, consulte este [registrar](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span><span class="sxs-lookup"><span data-stu-id="4324d-136">For additional information on setting hello appropriate memory in YARN, see this [post](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span></span>

<span data-ttu-id="4324d-137">Cargas de trabajo intensivas de E/S pueden beneficiarse de paralelismo más reduciendo el tamaño del contenedor Tez Hola.</span><span class="sxs-lookup"><span data-stu-id="4324d-137">I/O intensive workloads can benefit from more parallelism by decreasing hello Tez container size.</span></span> <span data-ttu-id="4324d-138">Esto proporciona al usuario hello más contenedores que aumenta la simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="4324d-138">This gives hello user more containers which increases concurrency.</span></span>  <span data-ttu-id="4324d-139">Sin embargo, algunas consultas de Hive requieren una cantidad significativa de memoria (p. ej. MapJoin).</span><span class="sxs-lookup"><span data-stu-id="4324d-139">However, some Hive queries require a significant amount of memory (e.g. MapJoin).</span></span>  <span data-ttu-id="4324d-140">Si la tarea hello no tiene suficiente memoria, obtendrá un excepción de memoria insuficiente durante el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="4324d-140">If hello task does not have enough memory, you will get an out of memory exception during runtime.</span></span>  <span data-ttu-id="4324d-141">Si recibe excepciones por memoria insuficiente, debe aumentar la memoria de Hola.</span><span class="sxs-lookup"><span data-stu-id="4324d-141">If you receive out of memory exceptions, then you should increase hello memory.</span></span>   

<span data-ttu-id="4324d-142">Hola simultáneas número de tareas en ejecución o paralelismo estarán enlazado por total de memoria YARN Hola.</span><span class="sxs-lookup"><span data-stu-id="4324d-142">hello concurrent number of tasks running or parallelism will be bounded by hello total YARN memory.</span></span>  <span data-ttu-id="4324d-143">número de Hola de contenedores YARN determinará cuántas tareas simultáneas puedan ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="4324d-143">hello number of YARN containers will dictate how many concurrent tasks can run.</span></span>  <span data-ttu-id="4324d-144">memoria de hilo de hello toofind por nodo, puede ir tooAmbari.</span><span class="sxs-lookup"><span data-stu-id="4324d-144">toofind hello YARN memory per node, you can go tooAmbari.</span></span>  <span data-ttu-id="4324d-145">Navegue tooYARN y ver la ficha de configuraciones de Hola.  Hola memoria YARN se muestra en esta ventana.</span><span class="sxs-lookup"><span data-stu-id="4324d-145">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  

        Total YARN memory = nodes * YARN memory per node
        # of YARN containers = Total YARN memory / Tez container size
<span data-ttu-id="4324d-146">rendimiento de clave tooimproving de Hello mediante ADLS es simultaneidad de hello tooincrease tanto como sea posible.</span><span class="sxs-lookup"><span data-stu-id="4324d-146">hello key tooimproving performance using ADLS is tooincrease hello concurrency as much as possible.</span></span>  <span data-ttu-id="4324d-147">Tez calcula automáticamente el número de Hola de tareas que se debe crear por lo que no es necesario tooset lo.</span><span class="sxs-lookup"><span data-stu-id="4324d-147">Tez automatically calculates hello number of tasks that should be created so you do not need tooset it.</span></span>   

## <a name="example-calculation"></a><span data-ttu-id="4324d-148">Cálculo de ejemplo</span><span class="sxs-lookup"><span data-stu-id="4324d-148">Example Calculation</span></span>

<span data-ttu-id="4324d-149">Supongamos que tiene un clúster D14 de 8 nodos.</span><span class="sxs-lookup"><span data-stu-id="4324d-149">Let’s say you have an 8 node D14 cluster.</span></span>  

    Total YARN memory = nodes * YARN memory per node
    Total YARN memory = 8 nodes * 96GB = 768GB
    # of YARN containers = 768GB / 3072MB = 256

## <a name="limitations"></a><span data-ttu-id="4324d-150">Limitaciones</span><span class="sxs-lookup"><span data-stu-id="4324d-150">Limitations</span></span>
<span data-ttu-id="4324d-151">**Limitación de ADLS**</span><span class="sxs-lookup"><span data-stu-id="4324d-151">**ADLS throttling**</span></span> 

<span data-ttu-id="4324d-152">UIf aciertos Hola los límites de ancho de banda proporcionados por ADLS, tendría que empezar por errores en la tarea toosee.</span><span class="sxs-lookup"><span data-stu-id="4324d-152">UIf you hit hello limits of bandwidth provided by ADLS, you would start toosee task failures.</span></span> <span data-ttu-id="4324d-153">Esto puede identificarse observando los errores de limitación en los registros de tarea.</span><span class="sxs-lookup"><span data-stu-id="4324d-153">This could be identified by observing throttling errors in task logs.</span></span>  <span data-ttu-id="4324d-154">Puede reducir el paralelismo de Hola al aumentar el tamaño del contenedor Tez.</span><span class="sxs-lookup"><span data-stu-id="4324d-154">You can decrease hello parallelism by increasing Tez container size.</span></span>  <span data-ttu-id="4324d-155">Si necesita más simultaneidad para su trabajo, póngase en contacto con nosotros.</span><span class="sxs-lookup"><span data-stu-id="4324d-155">If you need more concurrency for your job, please contact us.</span></span>   

<span data-ttu-id="4324d-156">toocheck si están obteniendo limitados, deberá tooenable Hola registro de depuración en el lado del cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="4324d-156">toocheck if you are getting throttled, you need tooenable hello debug logging on hello client side.</span></span> <span data-ttu-id="4324d-157">Así es cómo debe hacerlo:</span><span class="sxs-lookup"><span data-stu-id="4324d-157">Here’s how you can do that:</span></span>

1. <span data-ttu-id="4324d-158">Hola Put después de propiedad en las propiedades de log4j hello en la configuración de Hive. Esto puede hacerse desde Vista Ambari: log4j.logger.com.microsoft.azure.datalake.store=DEBUG reiniciar todos los nodos/servicio hello para el efecto de hello config tootake.</span><span class="sxs-lookup"><span data-stu-id="4324d-158">Put hello following property in hello log4j properties in Hive config. This can be done from Ambari view: log4j.logger.com.microsoft.azure.datalake.store=DEBUG Restart all hello nodes/service for hello config tootake effect.</span></span>

2. <span data-ttu-id="4324d-159">Si están obteniendo limitados, verá el código de error HTTP 429 hello en el archivo de registro de hello hive.</span><span class="sxs-lookup"><span data-stu-id="4324d-159">If you are getting throttled, you’ll see hello HTTP 429 error code in hello hive log file.</span></span> <span data-ttu-id="4324d-160">archivo de registro del subárbol de Hello está en /tmp/&lt;usuario&gt;/hive.log</span><span class="sxs-lookup"><span data-stu-id="4324d-160">hello hive log file is in /tmp/&lt;user&gt;/hive.log</span></span>

## <a name="further-information-on-hive-tuning"></a><span data-ttu-id="4324d-161">Información adicional sobre la optimización de Hive</span><span class="sxs-lookup"><span data-stu-id="4324d-161">Further information on Hive tuning</span></span>

<span data-ttu-id="4324d-162">Estos son algunos blogs que le ayudará a optimizar las consultas de Hive:</span><span class="sxs-lookup"><span data-stu-id="4324d-162">Here are a few blogs that will help tune your Hive queries:</span></span>
* [<span data-ttu-id="4324d-163">Optimizar consultas de Hive para Hadoop en HDInsight</span><span class="sxs-lookup"><span data-stu-id="4324d-163">Optimize Hive queries for Hadoop in HDInsight</span></span>](https://azure.microsoft.com/en-us/documentation/articles/hdinsight-hadoop-optimize-hive-query/)
* <span data-ttu-id="4324d-164">[Troubleshooting Hive query performance](https://blogs.msdn.microsoft.com/bigdatasupport/2015/08/13/troubleshooting-hive-query-performance-in-hdinsight-hadoop-cluster/) (Solución de problemas de rendimiento de consultas de Hive)</span><span class="sxs-lookup"><span data-stu-id="4324d-164">[Troubleshooting Hive query performance](https://blogs.msdn.microsoft.com/bigdatasupport/2015/08/13/troubleshooting-hive-query-performance-in-hdinsight-hadoop-cluster/)</span></span>
* <span data-ttu-id="4324d-165">[Ignite talk on optimize Hive on HDInsight](https://channel9.msdn.com/events/Machine-Learning-and-Data-Sciences-Conference/Data-Science-Summit-2016/MSDSS25) (Acalorada charla sobre la optimización de Hive en HDInsight)</span><span class="sxs-lookup"><span data-stu-id="4324d-165">[Ignite talk on optimize Hive on HDInsight](https://channel9.msdn.com/events/Machine-Learning-and-Data-Sciences-Conference/Data-Science-Summit-2016/MSDSS25)</span></span>
