---
title: "aaaAzure datos Lake almacén Spark Performance Tuning Guidelines | Documentos de Microsoft"
description: "Directrices para la optimización del rendimiento de Spark en Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: da1d172e9cb1199ad95605ea1718e78559f79650
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="77c8b-103">Guía para la optimización del rendimiento de Spark en HDInsight y Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="77c8b-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="77c8b-104">Al ajustar el rendimiento en Spark, necesita tooconsider Hola número de aplicaciones que se ejecutarán en el clúster.</span><span class="sxs-lookup"><span data-stu-id="77c8b-104">When tuning performance on Spark, you need tooconsider hello number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="77c8b-105">De forma predeterminada, puede ejecutar 4 aplicaciones simultáneamente en el clúster HDI (Nota: saludo predeterminado es toochange asunto).</span><span class="sxs-lookup"><span data-stu-id="77c8b-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: hello default setting is subject toochange).</span></span>  <span data-ttu-id="77c8b-106">Puede decidir toouse menos aplicaciones para que pueda reemplazar la configuración predeterminada de Hola y utilizar más de clúster de Hola para esas aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="77c8b-106">You may decide toouse fewer apps so you can override hello default settings and use more of hello cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="77c8b-107">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="77c8b-107">Prerequisites</span></span>

* <span data-ttu-id="77c8b-108">**Una suscripción de Azure**.</span><span class="sxs-lookup"><span data-stu-id="77c8b-108">**An Azure subscription**.</span></span> <span data-ttu-id="77c8b-109">Vea [Obtener evaluación gratuita de Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="77c8b-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="77c8b-110">**Una cuenta de Almacén de Azure Data Lake**.</span><span class="sxs-lookup"><span data-stu-id="77c8b-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="77c8b-111">Para obtener instrucciones sobre cómo toocreate un, consulte [empezar a trabajar con el almacén de Azure Data Lake](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="77c8b-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="77c8b-112">**Clúster de HDInsight de Azure** con acceso tooa cuenta de almacén de Data Lake.</span><span class="sxs-lookup"><span data-stu-id="77c8b-112">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="77c8b-113">Consulte [Creación de un clúster de HDInsight con Data Lake Store mediante el Portal de Azure](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="77c8b-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="77c8b-114">Asegúrese de que habilitar Escritorio remoto para el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="77c8b-115">**Ejecutar el clúster de Spark en Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="77c8b-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="77c8b-116">Para obtener más información, vea [datos de uso HDInsight Spark clúster tooanalyze en almacén de Data Lake](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="77c8b-116">For more information, see [Use HDInsight Spark cluster tooanalyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="77c8b-117">**Directrices para la optimización del rendimiento en ADLS**.</span><span class="sxs-lookup"><span data-stu-id="77c8b-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="77c8b-118">Para conocer los conceptos generales de rendimiento, consulte [Guía para la optimización del rendimiento de Azure Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="77c8b-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="77c8b-119">parameters</span><span class="sxs-lookup"><span data-stu-id="77c8b-119">Parameters</span></span>

<span data-ttu-id="77c8b-120">Al ejecutar los trabajos de Spark, esta es la configuración de más importante de Hola que puede mejorar el rendimiento optimizadas tooincrease en ADLS:</span><span class="sxs-lookup"><span data-stu-id="77c8b-120">When running Spark jobs, here are hello most important settings that can be tuned tooincrease performance on ADLS:</span></span>

* <span data-ttu-id="77c8b-121">**Ejecutor de NUM** -Hola número de tareas simultáneas que se pueden ejecutar.</span><span class="sxs-lookup"><span data-stu-id="77c8b-121">**Num-executors** - hello number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="77c8b-122">**Memoria de ejecutor** -Hola cantidad de memoria asignada tooeach ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-122">**Executor-memory** - hello amount of memory allocated tooeach executor.</span></span>

* <span data-ttu-id="77c8b-123">**Núcleos de ejecutor** -Hola número de núcleos asignados tooeach ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-123">**Executor-cores** - hello number of cores allocated tooeach executor.</span></span>                     

<span data-ttu-id="77c8b-124">**Ejecutor de NUM** Num ejecutor establecerá el número máximo de Hola de tareas que se pueden ejecutar en paralelo.</span><span class="sxs-lookup"><span data-stu-id="77c8b-124">**Num-executors** Num-executors will set hello maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="77c8b-125">número real de Hola de tareas que se pueden ejecutar en paralelo está limitado por la memoria de Hola y recursos de CPU disponibles en el clúster.</span><span class="sxs-lookup"><span data-stu-id="77c8b-125">hello actual number of tasks that can run in parallel is bounded by hello memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="77c8b-126">**Memoria de ejecutor** es Hola cantidad de memoria que se asigna el ejecutor de tooeach.</span><span class="sxs-lookup"><span data-stu-id="77c8b-126">**Executor-memory** This is hello amount of memory that is being allocated tooeach executor.</span></span>  <span data-ttu-id="77c8b-127">memoria de Hello necesaria para cada elemento de ejecución es dependiente de trabajo de Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-127">hello memory needed for each executor is dependent on hello job.</span></span>  <span data-ttu-id="77c8b-128">Para operaciones más complejas, memoria de hello debe toobe superior.</span><span class="sxs-lookup"><span data-stu-id="77c8b-128">For complex operations, hello memory needs toobe higher.</span></span>  <span data-ttu-id="77c8b-129">En cambio, para las simples como la lectura y escritura, los requisitos de memoria serán menores.</span><span class="sxs-lookup"><span data-stu-id="77c8b-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="77c8b-130">Hola cantidad de memoria para cada elemento de ejecución puede verse en Ambari.</span><span class="sxs-lookup"><span data-stu-id="77c8b-130">hello amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="77c8b-131">En Ambari, navegue tooSpark y ver la ficha de configuraciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-131">In Ambari, navigate tooSpark and view hello Configs tab.</span></span>  

<span data-ttu-id="77c8b-132">**Núcleos de ejecutor** Esto establece la cantidad de Hola de núcleos usados por ejecutor, que determina el número de Hola de subprocesos paralelos que se pueden ejecutar por ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-132">**Executor-cores** This sets hello amount of cores used per executor, which determines hello number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="77c8b-133">Por ejemplo, si ejecutor núcleos = 2, después cada ejecutor puede ejecutar 2 tareas paralelas en el ejecutor de Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in hello executor.</span></span>  <span data-ttu-id="77c8b-134">Hola ejecutor-núcleos necesitan dependerá trabajo Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-134">hello executor-cores needed will be dependent on hello job.</span></span>  <span data-ttu-id="77c8b-135">Los trabajos con muchas E/S no requieren una gran cantidad de memoria por tarea, por lo que cada ejecutor puede administrar más tareas paralelas.</span><span class="sxs-lookup"><span data-stu-id="77c8b-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="77c8b-136">De forma predeterminada, se definen dos núcleos YARN virtuales para cada núcleo físico cuando se ejecuta Spark en HDInsight.</span><span class="sxs-lookup"><span data-stu-id="77c8b-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="77c8b-137">Este número proporciona un buen equilibrio entre simultaneidad y la cantidad de cambios de contexto desde varios subprocesos.</span><span class="sxs-lookup"><span data-stu-id="77c8b-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="77c8b-138">Guía</span><span class="sxs-lookup"><span data-stu-id="77c8b-138">Guidance</span></span>

<span data-ttu-id="77c8b-139">Mientras se ejecuta Spark toowork de las cargas de trabajo de análisis con los datos de almacén de Data Lake, le recomendamos que use hello más reciente HDInsight versión tooget Hola un rendimiento óptimo con almacén de Data Lake.</span><span class="sxs-lookup"><span data-stu-id="77c8b-139">While running Spark analytic workloads toowork with data in Data Lake Store, we recommend that you use hello most recent HDInsight version tooget hello best performance with Data Lake Store.</span></span> <span data-ttu-id="77c8b-140">Cuando el trabajo es más intensiva de E/S, ciertos parámetros pueden ser rendimiento tooimprove configurado.</span><span class="sxs-lookup"><span data-stu-id="77c8b-140">When your job is more I/O intensive, then certain parameters can be configured tooimprove performance.</span></span>  <span data-ttu-id="77c8b-141">Azure Data Lake Store es una plataforma de almacenamiento altamente escalable que puede controlar un alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="77c8b-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="77c8b-142">Si el trabajo de hello está compuesto principalmente de lectura o escritura, a continuación, aumenta la simultaneidad para tooand de E/S de almacén de Azure Data Lake podría mejorar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="77c8b-142">If hello job mainly consists of read or writes, then increasing concurrency for I/O tooand from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="77c8b-143">Hay unos cuantos simultaneidad de tooincrease métodos generales para los trabajos de uso intensivo de E/S.</span><span class="sxs-lookup"><span data-stu-id="77c8b-143">There are a few general ways tooincrease concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="77c8b-144">**Paso 1: Determinar las aplicaciones se ejecutan en el clúster** – debe conocer las aplicaciones se ejecutan en clúster de hello incluidos Hola actual.</span><span class="sxs-lookup"><span data-stu-id="77c8b-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on hello cluster including hello current one.</span></span>  <span data-ttu-id="77c8b-145">valores predeterminados Hola para cada Spark configuración asume que hay 4 aplicaciones que se ejecutan simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="77c8b-145">hello default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="77c8b-146">Por lo tanto, solo tendrá el 25% del clúster de hello están disponibles para cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="77c8b-146">Therefore, you will only have 25% of hello cluster available for each app.</span></span>  <span data-ttu-id="77c8b-147">tooget un mejor rendimiento, puede invalidar los valores predeterminados de Hola cambiando el número de Hola de ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-147">tooget better performance, you can override hello defaults by changing hello number of executors.</span></span>  

<span data-ttu-id="77c8b-148">**Paso 2: Establecer la memoria de ejecutor** : hello lo primero que tooset es Hola ejecutor memoria.</span><span class="sxs-lookup"><span data-stu-id="77c8b-148">**Step 2: Set executor-memory** – hello first thing tooset is hello executor-memory.</span></span>  <span data-ttu-id="77c8b-149">memoria de Hello dependerá trabajo Hola que son toorun continuo.</span><span class="sxs-lookup"><span data-stu-id="77c8b-149">hello memory will be dependent on hello job that you are going toorun.</span></span>  <span data-ttu-id="77c8b-150">Puede aumentar la simultaneidad asignando menos memoria a cada ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="77c8b-151">Si ve excepciones por memoria insuficiente al ejecutar el trabajo, debe aumentar el valor Hola para este parámetro.</span><span class="sxs-lookup"><span data-stu-id="77c8b-151">If you see out of memory exceptions when you run your job, then you should increase hello value for this parameter.</span></span>  <span data-ttu-id="77c8b-152">Una alternativa es tooget más memoria usando un clúster que tiene la mayor cantidad de memoria o aumentar el tamaño de hello del clúster.</span><span class="sxs-lookup"><span data-stu-id="77c8b-152">One alternative is tooget more memory by using a cluster that has higher amounts of memory or increasing hello size of your cluster.</span></span>  <span data-ttu-id="77c8b-153">Más memoria, habilitará más toobe ejecutor utilizado, lo que significa más de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="77c8b-153">More memory will enable more executors toobe used, which means more concurrency.</span></span>

<span data-ttu-id="77c8b-154">**Paso 3: Establecer ejecutor núcleos** – i/OS intensivas cargas de trabajo que no tienen operaciones complejas, es buena toostart con un alto número de núcleos de ejecutor tooincrease Hola tareas paralelas por ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good toostart with a high number of executor-cores tooincrease hello number of parallel tasks per executor.</span></span>  <span data-ttu-id="77c8b-155">Establecer ejecutor núcleos too4 es un buen punto de partida.</span><span class="sxs-lookup"><span data-stu-id="77c8b-155">Setting executor-cores too4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="77c8b-156">Aumentar Hola número de núcleos de ejecutor le proporcionará más paralelismo para que pueda experimentar con diferentes ejecutor-núcleos.</span><span class="sxs-lookup"><span data-stu-id="77c8b-156">Increasing hello number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="77c8b-157">Para los trabajos que tienen operaciones más complejas, debería reducir el número de Hola de núcleos por ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-157">For jobs that have more complex operations, you should reduce hello number of cores per executor.</span></span>  <span data-ttu-id="77c8b-158">Si executor-cores se ha establecido en un número mayor que 4, puede que la recolección de elementos no utilizados sea ineficaz y el rendimiento se vea degradado.</span><span class="sxs-lookup"><span data-stu-id="77c8b-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="77c8b-159">**Paso 4: determine la cantidad de memoria YARN en el clúster**. Esta información está disponible en Ambari.</span><span class="sxs-lookup"><span data-stu-id="77c8b-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="77c8b-160">Navegue tooYARN y ver la ficha de configuraciones de Hola.  Hola memoria YARN se muestra en esta ventana.</span><span class="sxs-lookup"><span data-stu-id="77c8b-160">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="77c8b-161">Nota: mientras estás en ventana hello, también puede ver tamaño de contenedor de hilo de hello predeterminado.</span><span class="sxs-lookup"><span data-stu-id="77c8b-161">Note: while you are in hello window, you can also see hello default YARN container size.</span></span>  <span data-ttu-id="77c8b-162">Hola tamaño de contenedor YARN es Hola igual a la memoria por cada parámetro de elemento de ejecución.</span><span class="sxs-lookup"><span data-stu-id="77c8b-162">hello YARN container size is hello same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="77c8b-163">**Paso 5: calcule num-executors**</span><span class="sxs-lookup"><span data-stu-id="77c8b-163">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="77c8b-164">**Calcular la restricción de memoria** -parámetro num ejecutor de hello está restringido por la memoria o CPU.</span><span class="sxs-lookup"><span data-stu-id="77c8b-164">**Calculate memory constraint** - hello num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="77c8b-165">restricción de memoria de Hello viene determinado por la cantidad de Hola de memoria YARN disponible para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="77c8b-165">hello memory constraint is determined by hello amount of available YARN memory for your application.</span></span>  <span data-ttu-id="77c8b-166">Tome la memoria total de YARN y divídala por la memoria del ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-166">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="77c8b-167">restricción de Hello necesita toobe anular escalar para número de Hola de aplicaciones por lo que se divida por número de Hola de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="77c8b-167">hello constraint needs toobe de-scaled for hello number of apps so we divide by hello number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="77c8b-168">**Calcular la restricción de CPU** -Hola restricción de CPU se calcula como Hola total núcleos virtuales divididos por el número de núcleos por ejecutor Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-168">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total virtual cores divided by hello number of cores per executor.</span></span>  <span data-ttu-id="77c8b-169">Hay 2 núcleos virtuales para cada núcleo físico.</span><span class="sxs-lookup"><span data-stu-id="77c8b-169">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="77c8b-170">Restricción de memoria toohello similar, tenemos división por número de Hola de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="77c8b-170">Similar toohello memory constraint, we have divide by hello number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="77c8b-171">**Establecer num ejecutor** : parámetro num ejecutor de hello se determina teniendo Hola mínimo de restricciones de memoria de Hola y Hola CPU.</span><span class="sxs-lookup"><span data-stu-id="77c8b-171">**Set num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="77c8b-172">El hecho de establecer un número mayor de ejecutores no tiene por qué aumentar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="77c8b-172">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="77c8b-173">Debe tener en cuenta que al agregar más ejecutores pondrá una sobrecarga adicional a cada ejecutor que agregue, lo que podría reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="77c8b-173">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="77c8b-174">Ejecutor de NUM está limitado por los recursos de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-174">Num-executors is bounded by hello cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="77c8b-175">Cálculo de ejemplo</span><span class="sxs-lookup"><span data-stu-id="77c8b-175">Example Calculation</span></span>

<span data-ttu-id="77c8b-176">Supongamos que actualmente tiene un clúster compuesto de 8 nodos D4v2 ejecución 2 aplicaciones incluidas Hola que va toorun.</span><span class="sxs-lookup"><span data-stu-id="77c8b-176">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including hello one you are going toorun.</span></span>  

<span data-ttu-id="77c8b-177">**Paso 1: Determinar las aplicaciones se ejecutan en el clúster** – sabe que tiene 2 aplicaciones en el clúster, incluidos los Hola uno va toorun.</span><span class="sxs-lookup"><span data-stu-id="77c8b-177">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including hello one you are going toorun.</span></span>  

<span data-ttu-id="77c8b-178">**Paso 2: establezca executor-memory**. En este ejemplo, determinamos que 6 GB de memoria de ejecutor serán suficientes para trabajos con uso intensivo de E/S.</span><span class="sxs-lookup"><span data-stu-id="77c8b-178">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="77c8b-179">**Paso 3: Establecer ejecutor núcleos** : puesto que se trata de un trabajo de uso intensivo de E/S, podemos establecer número de Hola de núcleos para cada too4 ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-179">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set hello number of cores for each executor too4.</span></span>  <span data-ttu-id="77c8b-180">Configuración de núcleos por toolarger ejecutor de 4 puede causar problemas de la colección de elementos no utilizados.</span><span class="sxs-lookup"><span data-stu-id="77c8b-180">Setting cores per executor toolarger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="77c8b-181">**Paso 4: Determinar la cantidad de memoria YARN en clúster** – naveguemos tooAmbari toofind espera que cada D4v2 tiene 25 GB de memoria YARN.</span><span class="sxs-lookup"><span data-stu-id="77c8b-181">**Step 4: Determine amount of YARN memory in cluster** – We navigate tooAmbari toofind out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="77c8b-182">Dado que hay 8 nodos, la memoria disponible de hilo de Hola se multiplica por 8.</span><span class="sxs-lookup"><span data-stu-id="77c8b-182">Since there are 8 nodes, hello available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="77c8b-183">**Paso 5: Calcular num ejecutor** : parámetro de ejecutor num hello viene determinado por tomar Hola mínima de memoria hello y restricción de CPU de hello dividido por hello n.º de aplicaciones que se ejecutan en Spark.</span><span class="sxs-lookup"><span data-stu-id="77c8b-183">**Step 5: Calculate num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint divided by hello # of apps running on Spark.</span></span>    

<span data-ttu-id="77c8b-184">**Calcular la restricción de memoria** : restricción de memoria de Hola se calcula como Hola hilo de memoria total dividida por la memoria de Hola por ejecutor.</span><span class="sxs-lookup"><span data-stu-id="77c8b-184">**Calculate memory constraint** – hello memory constraint is calculated as hello total YARN memory divided by hello memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="77c8b-185">**Calcular la restricción de CPU** -Hola restricción de CPU se calcula como Hola núcleos yarn total divididos por el número de núcleos por ejecutor Hola.</span><span class="sxs-lookup"><span data-stu-id="77c8b-185">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total yarn cores divided by hello number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="77c8b-186">**Establezca num-executors**</span><span class="sxs-lookup"><span data-stu-id="77c8b-186">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

