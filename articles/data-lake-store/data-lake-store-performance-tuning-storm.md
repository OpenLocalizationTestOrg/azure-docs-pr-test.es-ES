---
title: "directrices de ajuste del rendimiento de aaaAzure aluvión de almacén de datos Lake | Documentos de Microsoft"
description: "Guía para la optimización del rendimiento de Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 5412fd46cf2373f5877030913df4fe1fc6f5473a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="11f16-103">Guía para la optimización del rendimiento de Storm en HDInsight y Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="11f16-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="11f16-104">Entender los factores de Hola que deben tenerse en cuenta al optimizar el rendimiento de Hola de una topología de aluvión de Azure.</span><span class="sxs-lookup"><span data-stu-id="11f16-104">Understand hello factors that should be considered when you tune hello performance of an Azure Storm topology.</span></span> <span data-ttu-id="11f16-105">Por ejemplo, es importante toounderstand características de Hola de trabajo de Hola Hola spouts y tornillos hello (si el trabajo de hello está intensivo de memoria o E/S).</span><span class="sxs-lookup"><span data-stu-id="11f16-105">For example, it's important toounderstand hello characteristics of hello work done by hello spouts and hello bolts (whether hello work is I/O or memory intensive).</span></span> <span data-ttu-id="11f16-106">En este artículo se describen varias directrices de optimización del rendimiento y se incluyen soluciones a problemas comunes.</span><span class="sxs-lookup"><span data-stu-id="11f16-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="11f16-107">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="11f16-107">Prerequisites</span></span>

* <span data-ttu-id="11f16-108">**Una suscripción de Azure**.</span><span class="sxs-lookup"><span data-stu-id="11f16-108">**An Azure subscription**.</span></span> <span data-ttu-id="11f16-109">Vea [Obtener evaluación gratuita de Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="11f16-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="11f16-110">**Una cuenta de Almacén de Azure Data Lake**.</span><span class="sxs-lookup"><span data-stu-id="11f16-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="11f16-111">Para obtener instrucciones sobre cómo toocreate un, consulte [empezar a trabajar con el almacén de Azure Data Lake](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="11f16-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="11f16-112">**Un clúster de HDInsight de Azure** con acceso tooa cuenta de almacén de Data Lake.</span><span class="sxs-lookup"><span data-stu-id="11f16-112">**An Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="11f16-113">Consulte [Creación de un clúster de HDInsight con Data Lake Store mediante el Portal de Azure](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="11f16-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="11f16-114">Asegúrese de que habilitar Escritorio remoto para el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="11f16-115">**Ejecución de un clúster de Storm en Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="11f16-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="11f16-116">Para más información, consulte [Storm en HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="11f16-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="11f16-117">**Guía para la optimización del rendimiento en Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="11f16-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="11f16-118">Para conocer los conceptos generales sobre rendimiento, consulte [Guía para la optimización del rendimiento de Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="11f16-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-hello-parallelism-of-hello-topology"></a><span data-ttu-id="11f16-119">Optimizar el paralelismo de Hola de topología de Hola</span><span class="sxs-lookup"><span data-stu-id="11f16-119">Tune hello parallelism of hello topology</span></span>

<span data-ttu-id="11f16-120">Es posible que pueda tooimprove rendimiento por la simultaneidad de hello creciente de hello tooand de E/S de almacén de Data Lake.</span><span class="sxs-lookup"><span data-stu-id="11f16-120">You might be able tooimprove performance by increasing hello concurrency of hello I/O tooand from Data Lake Store.</span></span> <span data-ttu-id="11f16-121">Una topología de Storm tiene un conjunto de configuraciones que determinan el paralelismo de hello:</span><span class="sxs-lookup"><span data-stu-id="11f16-121">A Storm topology has a set of configurations that determine hello parallelism:</span></span>
* <span data-ttu-id="11f16-122">Número de procesos de trabajo (trabajadores de Hola se distribuyen uniformemente entre las máquinas virtuales de hello).</span><span class="sxs-lookup"><span data-stu-id="11f16-122">Number of worker processes (hello workers are evenly distributed across hello VMs).</span></span>
* <span data-ttu-id="11f16-123">Número de instancias de ejecutor de spout</span><span class="sxs-lookup"><span data-stu-id="11f16-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="11f16-124">Número de instancias de ejecutor de bolt</span><span class="sxs-lookup"><span data-stu-id="11f16-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="11f16-125">Número de tareas de spout</span><span class="sxs-lookup"><span data-stu-id="11f16-125">Number of spout tasks.</span></span>
* <span data-ttu-id="11f16-126">Número de tareas de bolt</span><span class="sxs-lookup"><span data-stu-id="11f16-126">Number of bolt tasks.</span></span>

<span data-ttu-id="11f16-127">Por ejemplo, en un clúster con 4 VM y 4 procesos de trabajo, ejecutor pitorro 32 y 32 pitorro tareas y 256 ejecutor de rayo y tareas de rayo 512, tenga en cuenta Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="11f16-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider hello following:</span></span>

<span data-ttu-id="11f16-128">Cada supervisor, que es un nodo de trabajo, tiene un solo proceso de trabajo de máquina virtual Java (JVM).</span><span class="sxs-lookup"><span data-stu-id="11f16-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="11f16-129">Este proceso de JVM administra 4 subprocesos de spout y 64 subprocesos de bolt.</span><span class="sxs-lookup"><span data-stu-id="11f16-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="11f16-130">Dentro de cada subproceso, las tareas se ejecutan secuencialmente.</span><span class="sxs-lookup"><span data-stu-id="11f16-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="11f16-131">Con hello anterior configuración, cada subproceso pitorro tiene 1 tarea y, cada subproceso de rayo tiene 2 tareas.</span><span class="sxs-lookup"><span data-stu-id="11f16-131">With hello preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="11f16-132">En Storm, presentamos Hola diversos componentes implicados y cómo afectan al nivel de Hola de paralelismo que tiene:</span><span class="sxs-lookup"><span data-stu-id="11f16-132">In Storm, here are hello various components involved, and how they affect hello level of parallelism you have:</span></span>
* <span data-ttu-id="11f16-133">Hola y nodo principal (llamado Nimbus en Storm) usado toosubmit administrar trabajos.</span><span class="sxs-lookup"><span data-stu-id="11f16-133">hello head node (called Nimbus in Storm) is used toosubmit and manage jobs.</span></span> <span data-ttu-id="11f16-134">Estos nodos tienen ningún impacto en el grado de paralelismo Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-134">These nodes have no impact on hello degree of parallelism.</span></span>
* <span data-ttu-id="11f16-135">nodos de supervisor de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-135">hello supervisor nodes.</span></span> <span data-ttu-id="11f16-136">En HDInsight, esto corresponde el nodo de trabajo tooa máquina virtual de Azure.</span><span class="sxs-lookup"><span data-stu-id="11f16-136">In HDInsight, this corresponds tooa worker node Azure VM.</span></span>
* <span data-ttu-id="11f16-137">tareas del trabajador Hola son procesos de Storm que se ejecutan en máquinas virtuales de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-137">hello worker tasks are Storm processes running in hello VMs.</span></span> <span data-ttu-id="11f16-138">Cada tarea de trabajo corresponde la instancia JVM tooa.</span><span class="sxs-lookup"><span data-stu-id="11f16-138">Each worker task corresponds tooa JVM instance.</span></span> <span data-ttu-id="11f16-139">Storm distribuye número Hola de procesos de trabajo especificar nodos de trabajador toohello lo más uniformemente posible.</span><span class="sxs-lookup"><span data-stu-id="11f16-139">Storm distributes hello number of worker processes you specify toohello worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="11f16-140">Instancias de ejecutor de bolt y spout.</span><span class="sxs-lookup"><span data-stu-id="11f16-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="11f16-141">Cada instancia del ejecutor corresponde tooa subproceso que se ejecuta dentro de los trabajadores de hello (JVMs).</span><span class="sxs-lookup"><span data-stu-id="11f16-141">Each executor instance corresponds tooa thread running within hello workers (JVMs).</span></span>
* <span data-ttu-id="11f16-142">Tareas de Storm.</span><span class="sxs-lookup"><span data-stu-id="11f16-142">Storm tasks.</span></span> <span data-ttu-id="11f16-143">Son tareas lógicas que ejecuta cada uno de estos subprocesos.</span><span class="sxs-lookup"><span data-stu-id="11f16-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="11f16-144">Esto no cambia el nivel de Hola de paralelismo, por lo que se debe evaluar si tiene varias tareas por ejecutor o no.</span><span class="sxs-lookup"><span data-stu-id="11f16-144">This does not change hello level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-hello-best-performance-from-data-lake-store"></a><span data-ttu-id="11f16-145">Obtenga un rendimiento mejor Hola del almacén de Data Lake</span><span class="sxs-lookup"><span data-stu-id="11f16-145">Get hello best performance from Data Lake Store</span></span>

<span data-ttu-id="11f16-146">Cuando se trabaja con el almacén de Data Lake, obtendrá un rendimiento mejor Hola si Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="11f16-146">When working with Data Lake Store, you get hello best performance if you do hello following:</span></span>
* <span data-ttu-id="11f16-147">Fusione sus anexos más pequeños en tamaños más grandes (lo ideal son 4 MB).</span><span class="sxs-lookup"><span data-stu-id="11f16-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="11f16-148">Realice tantas solicitudes simultáneas como pueda.</span><span class="sxs-lookup"><span data-stu-id="11f16-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="11f16-149">Dado que cada subproceso de rayo está realizando lecturas bloqueo, es conveniente toohave en algún lugar de intervalo de Hola de 8 a 12 subprocesos por núcleo.</span><span class="sxs-lookup"><span data-stu-id="11f16-149">Because each bolt thread is doing blocking reads, you want toohave somewhere in hello range of 8-12 threads per core.</span></span> <span data-ttu-id="11f16-150">Esto impide que la CPU de hello y formación de hello también utilizado.</span><span class="sxs-lookup"><span data-stu-id="11f16-150">This keeps hello NIC and hello CPU well utilized.</span></span> <span data-ttu-id="11f16-151">Una máquina virtual más grande permite más solicitudes simultáneas.</span><span class="sxs-lookup"><span data-stu-id="11f16-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="11f16-152">Topología de ejemplo</span><span class="sxs-lookup"><span data-stu-id="11f16-152">Example topology</span></span>

<span data-ttu-id="11f16-153">Supongamos que tiene un clúster de 8 nodos de trabajo con una máquina virtual de Azure D13v2.</span><span class="sxs-lookup"><span data-stu-id="11f16-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="11f16-154">Esta VM tiene 8 núcleos, por lo que entre Hola 8 nodos de trabajador, tendrá que 64 núcleos total.</span><span class="sxs-lookup"><span data-stu-id="11f16-154">This VM has 8 cores, so among hello 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="11f16-155">Digamos que hacemos 8 subprocesos de bolt por núcleo.</span><span class="sxs-lookup"><span data-stu-id="11f16-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="11f16-156">Como hay 64 núcleos, significa que queremos 512 instancias de ejecutor de bolt (es decir, subprocesos) en total.</span><span class="sxs-lookup"><span data-stu-id="11f16-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="11f16-157">En este caso, supongamos que se inicie con una JVM por máquina virtual y utiliza principalmente la simultaneidad de subprocesos de hello dentro de simultaneidad de hello JVM tooachieve.</span><span class="sxs-lookup"><span data-stu-id="11f16-157">In this case, let’s say we start with one JVM per VM, and mainly use hello thread concurrency within hello JVM tooachieve concurrency.</span></span> <span data-ttu-id="11f16-158">Esto significa que necesitamos 8 tareas de trabajo (una por cada VM de Azure) y 512 ejecutores de bolt.</span><span class="sxs-lookup"><span data-stu-id="11f16-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="11f16-159">Dada esta configuración, Storm intenta toodistribute Hola los trabajadores de manera uniforme entre los nodos de trabajo (también conocidos como nodos de supervisor), dando a cada nodo de trabajo 1 JVM.</span><span class="sxs-lookup"><span data-stu-id="11f16-159">Given this configuration, Storm tries toodistribute hello workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="11f16-160">Ahora en los supervisores de hello, Storm intenta ejecutor de hello toodistribute uniformemente entre los supervisores, lo que proporciona cada supervisor (es decir, JVM) 8 subprocesos cada uno.</span><span class="sxs-lookup"><span data-stu-id="11f16-160">Now within hello supervisors, Storm tries toodistribute hello executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="11f16-161">Ajuste de parámetros adicionales</span><span class="sxs-lookup"><span data-stu-id="11f16-161">Tune additional parameters</span></span>
<span data-ttu-id="11f16-162">Una vez haya topología básica de hello, tenga en cuenta si desea tootweak alguno de los parámetros de hello:</span><span class="sxs-lookup"><span data-stu-id="11f16-162">After you have hello basic topology, you can consider whether you want tootweak any of hello parameters:</span></span>
* <span data-ttu-id="11f16-163">**Number of JVMs per worker node** (Número total de JVM por nodo de trabajo).</span><span class="sxs-lookup"><span data-stu-id="11f16-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="11f16-164">Si tiene una estructura de datos de gran tamaño (por ejemplo, una tabla de búsqueda) que se hospeda en memoria, cada JVM requiere una copia independiente.</span><span class="sxs-lookup"><span data-stu-id="11f16-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="11f16-165">Como alternativa, puede utilizar estructura de datos de hello en muchos subprocesos si tiene menos JVMs.</span><span class="sxs-lookup"><span data-stu-id="11f16-165">Alternatively, you can use hello data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="11f16-166">Para la E/S del rayo hello, número de Hola de JVMs no tiene tanta una diferencia como número de Hola de subprocesos que se agregan a través de esas JVMs.</span><span class="sxs-lookup"><span data-stu-id="11f16-166">For hello bolt’s I/O, hello number of JVMs does not make as much of a difference as hello number of threads added across those JVMs.</span></span> <span data-ttu-id="11f16-167">Para simplificar, es un toohave buena idea una JVM por trabajo.</span><span class="sxs-lookup"><span data-stu-id="11f16-167">For simplicity, it's a good idea toohave one JVM per worker.</span></span> <span data-ttu-id="11f16-168">Dependiendo de lo que está haciendo el rayo o la aplicación de procesamiento necesita, sin embargo, puede que necesite toochange este número.</span><span class="sxs-lookup"><span data-stu-id="11f16-168">Depending on what your bolt is doing or what application processing you require, though, you may need toochange this number.</span></span>
* <span data-ttu-id="11f16-169">**Number of spout executors** (Número de ejecutores de spout)</span><span class="sxs-lookup"><span data-stu-id="11f16-169">**Number of spout executors.**</span></span> <span data-ttu-id="11f16-170">Dado que hello en el ejemplo anterior se utiliza tornillos para escribir tooData Lake almacén, el número de Hola de spouts no es rendimiento de rayo toohello directamente relevante.</span><span class="sxs-lookup"><span data-stu-id="11f16-170">Because hello preceding example uses bolts for writing tooData Lake Store, hello number of spouts is not directly relevant toohello bolt performance.</span></span> <span data-ttu-id="11f16-171">Sin embargo, dependiendo de la cantidad de Hola de procesamiento o E/S ocurre en pitorro hello, es una buena idea hello tootune spouts para mejorar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="11f16-171">However, depending on hello amount of processing or I/O happening in hello spout, it's a good idea tootune hello spouts for best performance.</span></span> <span data-ttu-id="11f16-172">Asegúrese de que tiene suficiente spouts toobe tookeep capaz de hello tornillos ocupado.</span><span class="sxs-lookup"><span data-stu-id="11f16-172">Ensure that you have enough spouts toobe able tookeep hello bolts busy.</span></span> <span data-ttu-id="11f16-173">tasas de salida de Hello de hello spouts deben coincidir con rendimiento Hola de hello tornillos.</span><span class="sxs-lookup"><span data-stu-id="11f16-173">hello output rates of hello spouts should match hello throughput of hello bolts.</span></span> <span data-ttu-id="11f16-174">configuración real de Hello depende pitorro Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-174">hello actual configuration depends on hello spout.</span></span>
* <span data-ttu-id="11f16-175">**Number of tasks** (Número de tareas)</span><span class="sxs-lookup"><span data-stu-id="11f16-175">**Number of tasks.**</span></span> <span data-ttu-id="11f16-176">Cada bolt se ejecuta como un único subproceso.</span><span class="sxs-lookup"><span data-stu-id="11f16-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="11f16-177">Las tareas adicionales por bolt no proporcionan ninguna simultaneidad adicional.</span><span class="sxs-lookup"><span data-stu-id="11f16-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="11f16-178">Hola única ocasión en que son de beneficio es si el proceso de confirmación de tupla hello tiene una gran proporción del tiempo de ejecución de rayo.</span><span class="sxs-lookup"><span data-stu-id="11f16-178">hello only time they are of benefit is if your process of acknowledging hello tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="11f16-179">Es un toogroup buena idea que muchos tuplas en un mayor anexar antes de enviar una confirmación de rayo Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-179">It's a good idea toogroup many tuples into a larger append before you send an acknowledgement from hello bolt.</span></span> <span data-ttu-id="11f16-180">Por lo tanto, en la mayoría de los casos, varias tareas no proporcionan ninguna ventaja adicional.</span><span class="sxs-lookup"><span data-stu-id="11f16-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="11f16-181">**Local or shuffle grouping** (Agrupación local o aleatoria)</span><span class="sxs-lookup"><span data-stu-id="11f16-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="11f16-182">Cuando esta opción está habilitada, las tuplas se envían toobolts dentro de hello mismo proceso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="11f16-182">When this setting is enabled, tuples are sent toobolts within hello same worker process.</span></span> <span data-ttu-id="11f16-183">Esta opción reduce las llamadas de red y la comunicación entre procesos.</span><span class="sxs-lookup"><span data-stu-id="11f16-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="11f16-184">Se recomienda su uso para la mayoría de las topologías.</span><span class="sxs-lookup"><span data-stu-id="11f16-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="11f16-185">Este escenario básico es un buen punto de partida.</span><span class="sxs-lookup"><span data-stu-id="11f16-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="11f16-186">Pruebe con su propio hello tootweak de datos anterior a un rendimiento óptimo tooachieve parámetros.</span><span class="sxs-lookup"><span data-stu-id="11f16-186">Test with your own data tootweak hello preceding parameters tooachieve optimal performance.</span></span>

## <a name="tune-hello-spout"></a><span data-ttu-id="11f16-187">Optimizar pitorro Hola</span><span class="sxs-lookup"><span data-stu-id="11f16-187">Tune hello spout</span></span>

<span data-ttu-id="11f16-188">Puede modificar Hola después configuración tootune Hola pitorro.</span><span class="sxs-lookup"><span data-stu-id="11f16-188">You can modify hello following settings tootune hello spout.</span></span>

- <span data-ttu-id="11f16-189">**Tuple timeout (Tiempo de espera de tupla): topology.message.timeout.secs**.</span><span class="sxs-lookup"><span data-stu-id="11f16-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="11f16-190">Esta configuración determina Hola tiempo tarda un mensaje toocomplete y recibir la confirmación, antes de que se considere error.</span><span class="sxs-lookup"><span data-stu-id="11f16-190">This setting determines hello amount of time a message takes toocomplete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="11f16-191">**Max memory per worker process (Memoria máxima por proceso de trabajo): worker.childopts**.</span><span class="sxs-lookup"><span data-stu-id="11f16-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="11f16-192">Esta configuración permite especificar los trabajadores de Java de toohello de parámetros de línea de comandos adicionales.</span><span class="sxs-lookup"><span data-stu-id="11f16-192">This setting lets you specify additional command-line parameters toohello Java workers.</span></span> <span data-ttu-id="11f16-193">Hola más frecuente establecer aquí es XmX, que determina el montón de JVM de hello memoria máxima asignada tooa.</span><span class="sxs-lookup"><span data-stu-id="11f16-193">hello most commonly used setting here is XmX, which determines hello maximum memory allocated tooa JVM’s heap.</span></span>

- <span data-ttu-id="11f16-194">**Max spout pending (Spouts máximos pendientes): topology.max.spout.pending**.</span><span class="sxs-lookup"><span data-stu-id="11f16-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="11f16-195">Esta configuración determina el número de Hola de tuplas que se pueden en vuelo (aún no se ha confirmado en todos los nodos de la topología de hello) por subproceso pitorro en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="11f16-195">This setting determines hello number of tuples that can in be flight (not yet acknowledged at all nodes in hello topology) per spout thread at any time.</span></span>

 <span data-ttu-id="11f16-196">Un buen cálculo toodo es el tamaño de Hola de tooestimate de cada uno de sus tuplas.</span><span class="sxs-lookup"><span data-stu-id="11f16-196">A good calculation toodo is tooestimate hello size of each of your tuples.</span></span> <span data-ttu-id="11f16-197">Después, averigüe cuánta memoria tiene un subproceso de spout.</span><span class="sxs-lookup"><span data-stu-id="11f16-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="11f16-198">Hello memoria total asignada tooa subproceso, dividido por este valor, debe darle límite superior de Hola para pitorro max de hello pendiente de parámetro.</span><span class="sxs-lookup"><span data-stu-id="11f16-198">hello total memory allocated tooa thread, divided by this value, should give you hello upper bound for hello max spout pending parameter.</span></span>

## <a name="tune-hello-bolt"></a><span data-ttu-id="11f16-199">Optimizar rayo Hola</span><span class="sxs-lookup"><span data-stu-id="11f16-199">Tune hello bolt</span></span>
<span data-ttu-id="11f16-200">Cuando escriba tooData Lake almacén, establecer una directiva de sincronización de tamaño (el búfer en el lado del cliente de hello) too4 MB.</span><span class="sxs-lookup"><span data-stu-id="11f16-200">When you're writing tooData Lake Store, set a size sync policy (buffer on hello client side) too4 MB.</span></span> <span data-ttu-id="11f16-201">A continuación, se realiza un vaciado o hsync() sólo cuando el tamaño del búfer de hello es hello en este valor.</span><span class="sxs-lookup"><span data-stu-id="11f16-201">A flushing or hsync() is then performed only when hello buffer size is hello at this value.</span></span> <span data-ttu-id="11f16-202">controlador de almacén de Data Lake Hello en el trabajo de hello VM realiza automáticamente este almacenamiento en búfer, a menos que realice explícitamente un hsync().</span><span class="sxs-lookup"><span data-stu-id="11f16-202">hello Data Lake Store driver on hello worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="11f16-203">rayo de Hello predeterminado aluvión de almacén de datos Lake tiene un parámetro de directiva de sincronización de tamaño (fileBufferSize) que puede ser tootune usa este parámetro.</span><span class="sxs-lookup"><span data-stu-id="11f16-203">hello default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used tootune this parameter.</span></span>

<span data-ttu-id="11f16-204">En estas topologías intensivas de entrada, es una buena idea toohave cada subproceso de rayo escribir archivo propio tooits y tooset una directiva de rotación de archivo (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="11f16-204">In I/O-intensive topologies, it's a good idea toohave each bolt thread write tooits own file, and tooset a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="11f16-205">Cuando el archivo hello alcanza un determinado tamaño, automáticamente se vacía en el flujo de Hola y se escribe un nuevo archivo en.</span><span class="sxs-lookup"><span data-stu-id="11f16-205">When hello file reaches a certain size, hello stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="11f16-206">Hola tamaño de archivo para el giro recomendado es 1 GB.</span><span class="sxs-lookup"><span data-stu-id="11f16-206">hello recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="11f16-207">Administración de los datos de la tupla</span><span class="sxs-lookup"><span data-stu-id="11f16-207">Handle tuple data</span></span>

<span data-ttu-id="11f16-208">En Storm, un pitorro contiene en tooa tupla hasta que se confirman de forma explícita por el rayo Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-208">In Storm, a spout holds on tooa tuple until it is explicitly acknowledged by hello bolt.</span></span> <span data-ttu-id="11f16-209">Si una tupla ha sido leída por el rayo Hola pero no se han confirmado aún, podría pitorro hello no se conservan en back-end de almacén de Data Lake.</span><span class="sxs-lookup"><span data-stu-id="11f16-209">If a tuple has been read by hello bolt but has not been acknowledged yet, hello spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="11f16-210">Después de que se confirma una tupla, pitorro Hola puede garantizarse persistencia por rayo de hello y, a continuación, puede eliminar datos de origen de Hola de cualquier origen que se está leyendo.</span><span class="sxs-lookup"><span data-stu-id="11f16-210">After a tuple is acknowledged, hello spout can be guaranteed persistence by hello bolt, and can then delete hello source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="11f16-211">Para obtener el mejor rendimiento en el almacén de Data Lake, tienen rayo Hola búfer de 4 MB de datos de la tupla.</span><span class="sxs-lookup"><span data-stu-id="11f16-211">For best performance on Data Lake Store, have hello bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="11f16-212">A continuación, escribir toohello nuevo almacén de Data Lake terminan siendo una escritura de 4 MB.</span><span class="sxs-lookup"><span data-stu-id="11f16-212">Then write toohello Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="11f16-213">Después de los datos de hello toohello correctamente escrito almacén (mediante hflush()) que realiza la llamada, rayo Hola puede reconocer Hola datos toohello atrás pitorro.</span><span class="sxs-lookup"><span data-stu-id="11f16-213">After hello data has been successfully written toohello store (by calling hflush()), hello bolt can acknowledge hello data back toohello spout.</span></span> <span data-ttu-id="11f16-214">Este es el ejemplo hello tornillo proporcionado hace aquí.</span><span class="sxs-lookup"><span data-stu-id="11f16-214">This is what hello example bolt supplied here does.</span></span> <span data-ttu-id="11f16-215">También es aceptable toohold un mayor número de tuplas antes de que se realiza la llamada de hflush() de Hola y Hola tuplas confirmado.</span><span class="sxs-lookup"><span data-stu-id="11f16-215">It is also acceptable toohold a larger number of tuples before hello hflush() call is made and hello tuples acknowledged.</span></span> <span data-ttu-id="11f16-216">Sin embargo, esto aumenta el número de Hola de tuplas en vuelo que pitorro Hola necesita toohold, y, por tanto, aumenta Hola cantidad de memoria necesaria por JVM.</span><span class="sxs-lookup"><span data-stu-id="11f16-216">However, this increases hello number of tuples in flight that hello spout needs toohold, and therefore increases hello amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="11f16-217">Las aplicaciones pueden presentar un tuplas de tooacknowledge de requisito con más frecuencia (en tamaños de datos es menor que 4 MB) por otras razones de rendimiento no.</span><span class="sxs-lookup"><span data-stu-id="11f16-217">Applications might have a requirement tooacknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="11f16-218">Sin embargo, que podrían afectar a Hola E/S rendimiento toohello almacenamiento back-end.</span><span class="sxs-lookup"><span data-stu-id="11f16-218">However, that might affect hello I/O throughput toohello storage back end.</span></span> <span data-ttu-id="11f16-219">Detenidamente esta compensación con respecto al rendimiento de E/S del rayo Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-219">Carefully weigh this tradeoff against hello bolt’s I/O performance.</span></span>

<span data-ttu-id="11f16-220">Si la velocidad de entrada de Hola de tuplas es no alta, por lo que el búfer de 4 MB de hello toma un toofill mucho tiempo, considere la posibilidad de mitigar este problema si:</span><span class="sxs-lookup"><span data-stu-id="11f16-220">If hello incoming rate of tuples is not high, so hello 4-MB buffer takes a long time toofill, consider mitigating this by:</span></span>
* <span data-ttu-id="11f16-221">Reducir el número de Hola de tornillos, por lo que hay menos toofill de búferes.</span><span class="sxs-lookup"><span data-stu-id="11f16-221">Reducing hello number of bolts, so there are fewer buffers toofill.</span></span>
* <span data-ttu-id="11f16-222">Tener una directiva basada en tiempo o basadas en recuento, donde es un hflush() desencadena cada x vaciados o cada milisegundos y y tuplas Hola acumulados hasta ahora se envía una confirmación.</span><span class="sxs-lookup"><span data-stu-id="11f16-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and hello tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="11f16-223">Tenga en cuenta que rendimiento hello en este caso es inferior, pero con una velocidad lenta de eventos, el rendimiento máximo no es Hola mayor objetivo todos modos.</span><span class="sxs-lookup"><span data-stu-id="11f16-223">Note that hello throughput in this case is lower, but with a slow rate of events, maximum throughput is not hello biggest objective anyway.</span></span> <span data-ttu-id="11f16-224">Estas soluciones le ayudarán a reducir Hola el tiempo total que tarda en un tooflow tupla a través de la tienda de toohello.</span><span class="sxs-lookup"><span data-stu-id="11f16-224">These mitigations help you reduce hello total time that it takes for a tuple tooflow through toohello store.</span></span> <span data-ttu-id="11f16-225">Esto podría ser importante si quiere una canalización en tiempo real incluso con una tasa baja de eventos.</span><span class="sxs-lookup"><span data-stu-id="11f16-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="11f16-226">Tenga en cuenta también que si la tasa entrante de la tupla es baja, debe ajustar parámetro topology.message.timeout_secs de hello, por lo que las tuplas de hello no tiempo de espera mientras está obteniendo almacenando en búfer o procesar.</span><span class="sxs-lookup"><span data-stu-id="11f16-226">Also note that if your incoming tuple rate is low, you should adjust hello topology.message.timeout_secs parameter, so hello tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="11f16-227">Supervisión de la topología en Storm</span><span class="sxs-lookup"><span data-stu-id="11f16-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="11f16-228">Mientras se ejecuta la topología, se puede supervisar en interfaz de usuario de Storm Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-228">While your topology is running, you can monitor it in hello Storm user interface.</span></span> <span data-ttu-id="11f16-229">Estos son toolook parámetros principales de hello en:</span><span class="sxs-lookup"><span data-stu-id="11f16-229">Here are hello main parameters toolook at:</span></span>

* <span data-ttu-id="11f16-230">**Total process execution latency (Latencia total de ejecución de procesos).**</span><span class="sxs-lookup"><span data-stu-id="11f16-230">**Total process execution latency.**</span></span> <span data-ttu-id="11f16-231">Se trata de tiempo promedio de hello una tupla toma toobe emitidos por pitorro hello, procesados por el rayo de Hola y confirmado.</span><span class="sxs-lookup"><span data-stu-id="11f16-231">This is hello average time one tuple takes toobe emitted by hello spout, processed by hello bolt, and acknowledged.</span></span>

* <span data-ttu-id="11f16-232">**Total bolt process latency (Latencia total de proceso del bolt).**</span><span class="sxs-lookup"><span data-stu-id="11f16-232">**Total bolt process latency.**</span></span> <span data-ttu-id="11f16-233">Se trata de hello tiempo medio por tupla de hello en el rayo Hola hasta que recibe una confirmación.</span><span class="sxs-lookup"><span data-stu-id="11f16-233">This is hello average time spent by hello tuple at hello bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="11f16-234">**Total bolt execute latency (Latencia total de ejecución del bolt).**</span><span class="sxs-lookup"><span data-stu-id="11f16-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="11f16-235">Se trata de promedio de hello tiempo invertido por el rayo de Hola Hola execute (método).</span><span class="sxs-lookup"><span data-stu-id="11f16-235">This is hello average time spent by hello bolt in hello execute method.</span></span>

* <span data-ttu-id="11f16-236">**Number of failures (Número de errores).**</span><span class="sxs-lookup"><span data-stu-id="11f16-236">**Number of failures.**</span></span> <span data-ttu-id="11f16-237">Esto refiere toohello número de tuplas que no se pudo toobe procesado totalmente antes de que agotó el tiempo.</span><span class="sxs-lookup"><span data-stu-id="11f16-237">This refers toohello number of tuples that failed toobe fully processed before they timed out.</span></span>

* <span data-ttu-id="11f16-238">**Capacity (Capacidad).**</span><span class="sxs-lookup"><span data-stu-id="11f16-238">**Capacity.**</span></span> <span data-ttu-id="11f16-239">Se trata de una medida de lo ocupado que está su sistema.</span><span class="sxs-lookup"><span data-stu-id="11f16-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="11f16-240">Si este número es 1, los bolts trabajan tan rápido como pueden.</span><span class="sxs-lookup"><span data-stu-id="11f16-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="11f16-241">Si es menor que 1, aumentar el paralelismo de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-241">If it is less than 1, increase hello parallelism.</span></span> <span data-ttu-id="11f16-242">Si es mayor que 1, reducir el paralelismo de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-242">If it is greater than 1, reduce hello parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="11f16-243">Solución de problemas comunes</span><span class="sxs-lookup"><span data-stu-id="11f16-243">Troubleshoot common problems</span></span>
<span data-ttu-id="11f16-244">Estos son algunos escenarios comunes de solución de problemas.</span><span class="sxs-lookup"><span data-stu-id="11f16-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="11f16-245">**El tiempo de espera de muchas tuplas se está agotando.** Buscar en cada nodo de hello topología toodetermine donde es el cuello de botella de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-245">**Many tuples are timing out.** Look at each node in hello topology toodetermine where hello bottleneck is.</span></span> <span data-ttu-id="11f16-246">razón más común de Hola para este es que Hola tornillos no son tookeep capaz de seguridad con spouts Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-246">hello most common reason for this is that hello bolts are not able tookeep up with hello spouts.</span></span> <span data-ttu-id="11f16-247">Esto conduce tootuples atascada por los búferes internos de hello mientras toobe espera procesados.</span><span class="sxs-lookup"><span data-stu-id="11f16-247">This leads tootuples clogging hello internal buffers while waiting toobe processed.</span></span> <span data-ttu-id="11f16-248">Considere la posibilidad de aumentar el valor de tiempo de espera de Hola o reduciendo pitorro max de hello pendientes.</span><span class="sxs-lookup"><span data-stu-id="11f16-248">Consider increasing hello timeout value or decreasing hello max spout pending.</span></span>

* <span data-ttu-id="11f16-249">**Existe una latencia alta total en la ejecución de los procesos, pero una latencia baja en los procesos de bolt.**</span><span class="sxs-lookup"><span data-stu-id="11f16-249">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="11f16-250">En este caso, es posible que Hola tuplas no son va a reconocer suficientemente rápido.</span><span class="sxs-lookup"><span data-stu-id="11f16-250">In this case, it is possible that hello tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="11f16-251">Compruebe que hay un número suficiente de elementos de reconocimiento.</span><span class="sxs-lookup"><span data-stu-id="11f16-251">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="11f16-252">Otra posibilidad es que están esperando en la cola de Hola durante demasiado tiempo antes de hello tornillos inicio procesarlos.</span><span class="sxs-lookup"><span data-stu-id="11f16-252">Another possibility is that they are waiting in hello queue for too long before hello bolts start processing them.</span></span> <span data-ttu-id="11f16-253">Disminuir pitorro max de hello pendientes.</span><span class="sxs-lookup"><span data-stu-id="11f16-253">Decrease hello max spout pending.</span></span>

* <span data-ttu-id="11f16-254">**Existe una latencia alta en la ejecución de bolts.**</span><span class="sxs-lookup"><span data-stu-id="11f16-254">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="11f16-255">Esto significa que Hola método Execute () de su rayo está tardando demasiado.</span><span class="sxs-lookup"><span data-stu-id="11f16-255">This means that hello execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="11f16-256">Optimizar el código de hello, o buscar en tamaños de escritura y vaciar el comportamiento.</span><span class="sxs-lookup"><span data-stu-id="11f16-256">Optimize hello code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="11f16-257">Limitación de Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="11f16-257">Data Lake Store throttling</span></span>
<span data-ttu-id="11f16-258">Si alcanza los límites de Hola de ancho de banda proporcionada por el almacén de Data Lake, podrá ver los errores de la tarea.</span><span class="sxs-lookup"><span data-stu-id="11f16-258">If you hit hello limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="11f16-259">Compruebe los registros de la tarea para ver los errores de limitación.</span><span class="sxs-lookup"><span data-stu-id="11f16-259">Check task logs for throttling errors.</span></span> <span data-ttu-id="11f16-260">Puede reducir el paralelismo de hello al aumentar el tamaño del contenedor.</span><span class="sxs-lookup"><span data-stu-id="11f16-260">You can decrease hello parallelism by increasing container size.</span></span>    

<span data-ttu-id="11f16-261">toocheck si están obteniendo limitados, habilitar el registro en el lado del cliente de Hola de depuración de hello:</span><span class="sxs-lookup"><span data-stu-id="11f16-261">toocheck if you are getting throttled, enable hello debug logging on hello client side:</span></span>

1. <span data-ttu-id="11f16-262">En **Ambari** > **Storm** > **Config** > **avanzada storm-worker-log4j**, cambiar  **&lt;raíz nivel = "info"&gt;**  demasiado**&lt;raíz nivel = "debug"&gt;**.</span><span class="sxs-lookup"><span data-stu-id="11f16-262">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** too**&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="11f16-263">Reiniciar todos los nodos de Hola/servicio con efecto de tootake de configuración de Hola.</span><span class="sxs-lookup"><span data-stu-id="11f16-263">Restart all hello nodes/service for hello configuration tootake effect.</span></span>
2. <span data-ttu-id="11f16-264">Registros de monitor Hola Storm topología en nodos de trabajador (bajo /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;puerto&gt;/worker.log) para el almacén de Data Lake excepciones de limitación.</span><span class="sxs-lookup"><span data-stu-id="11f16-264">Monitor hello Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="11f16-265">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="11f16-265">Next steps</span></span>
<span data-ttu-id="11f16-266">Puede consultar este [blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/) para saber más sobre la optimización del rendimiento adicional de Storm.</span><span class="sxs-lookup"><span data-stu-id="11f16-266">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="11f16-267">Para una toorun ejemplo adicional, vea [ésta en GitHub](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="11f16-267">For an additional example toorun, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
