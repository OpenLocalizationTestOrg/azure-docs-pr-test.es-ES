---
title: "Directrices para la optimización del rendimiento de Azure Data Lake Store | Microsoft Docs"
description: "Directrices para la optimización del rendimiento de Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: cgronlun
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 06/30/2017
ms.author: stewu
ms.openlocfilehash: e7ea83465328bd4c7479dec4093cd94700463854
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="tuning-azure-data-lake-store-for-performance"></a><span data-ttu-id="9d6cc-103">Optimización del rendimiento de Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="9d6cc-103">Tuning Azure Data Lake Store for performance</span></span>

<span data-ttu-id="9d6cc-104">Data Lake Store permite un alto rendimiento en el movimiento de datos y el análisis de consumo de la entrada y salida.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-104">Data Lake Store supports high-throughput for I/O intensive analytics and data movement.</span></span>  <span data-ttu-id="9d6cc-105">En Azure Data Lake Store, usar toda la capacidad de proceso disponible (la cantidad de datos que se pueden leer o escribir por segundo) es importante para obtener el mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-105">In Azure Data Lake Store, using all available throughput – the amount of data that can be read or written per second – is important to get the best performance.</span></span>  <span data-ttu-id="9d6cc-106">Se consigue realizando tantas lecturas y escrituras en paralelo como sea posible.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-106">This is achieved by performing as many reads and writes in parallel as possible.</span></span>

![Rendimiento de Data Lake Store](./media/data-lake-store-performance-tuning-guidance/throughput.png)

<span data-ttu-id="9d6cc-108">Azure Data Lake Store puede escalar para ofrecer la capacidad de proceso necesaria para todos los escenarios de análisis.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-108">Azure Data Lake Store can scale to provide the necessary throughput for all analytics scenario.</span></span> <span data-ttu-id="9d6cc-109">De forma predeterminada, una cuenta Azure Data Lake Store proporciona automáticamente la capacidad suficiente para satisfacer las necesidades de una amplia variedad de casos de uso.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-109">By default, an Azure Data Lake Store account provides automatically enough throughput to meet the needs of a broad category of use cases.</span></span> <span data-ttu-id="9d6cc-110">Cuando los clientes llegan al límite predeterminado, la cuenta ADLS se puede configurar para proporcionar más rendimiento, si se ponen en contacto con el soporte técnico de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-110">For the cases where customers run into the default limit, the ADLS account can be configured to provide more throughput by contacting Microsoft support.</span></span>

## <a name="data-ingestion"></a><span data-ttu-id="9d6cc-111">Ingesta de datos</span><span class="sxs-lookup"><span data-stu-id="9d6cc-111">Data ingestion</span></span>

<span data-ttu-id="9d6cc-112">Cuando se ingieren datos de un sistema de origen para ADLS, es importante tener en cuenta que el hardware de origen, el hardware de red de origen y la conectividad de red con ADLS pueden constituir un cuello de botella.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-112">When ingesting data from a source system to ADLS, it is important to consider that the source hardware, source network hardware, and network connectivity to ADLS can be the bottleneck.</span></span>  

![Rendimiento de Data Lake Store](./media/data-lake-store-performance-tuning-guidance/bottleneck.png)

<span data-ttu-id="9d6cc-114">Es importante asegurarse de que el movimiento de datos no se ve afectado por estos factores.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-114">It is important to ensure that the data movement is not affected by these factors.</span></span>

### <a name="source-hardware"></a><span data-ttu-id="9d6cc-115">Hardware de origen</span><span class="sxs-lookup"><span data-stu-id="9d6cc-115">Source Hardware</span></span>

<span data-ttu-id="9d6cc-116">Si usa máquinas locales o máquinas virtuales en Azure, debe seleccionar cuidadosamente el hardware apropiado.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-116">Whether you are using on-premises machines or VMs in Azure, you should carefully select the appropriate hardware.</span></span> <span data-ttu-id="9d6cc-117">Como hardware del disco de origen, elija SSD antes que HDD y seleccione el hardware de disco con los ejes más rápidos.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-117">For Source Disk Hardware, prefer SSDs to HDDs and pick disk hardware with faster spindles.</span></span> <span data-ttu-id="9d6cc-118">Como hardware de la red de origen, use los NIC más rápidos que sea posible.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-118">For Source Network Hardware, use the fastest NICs possible.</span></span>  <span data-ttu-id="9d6cc-119">En Azure, se recomienda que las máquinas virtuales de Azure D14 tengan el hardware de red y de disco con la capacidad apropiada.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-119">On Azure, we recommend Azure D14 VMs which have the appropriately powerful disk and networking hardware.</span></span>

### <a name="network-connectivity-to-azure-data-lake-store"></a><span data-ttu-id="9d6cc-120">Conectividad de red a Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="9d6cc-120">Network Connectivity to Azure Data Lake Store</span></span>

<span data-ttu-id="9d6cc-121">La conectividad de red entre los datos de origen y Azure Data Lake Store a veces puede constituir un cuello de botella.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-121">The network connectivity between your source data and Azure Data Lake store can sometimes be the bottleneck.</span></span> <span data-ttu-id="9d6cc-122">Cuando los datos de origen están en local, considere el uso de un vínculo dedicado con [Azure ExpressRoute](https://azure.microsoft.com/en-us/services/expressroute/).</span><span class="sxs-lookup"><span data-stu-id="9d6cc-122">When your source data is On-Premises, consider using a dedicated link with [Azure ExpressRoute](https://azure.microsoft.com/en-us/services/expressroute/) .</span></span> <span data-ttu-id="9d6cc-123">Si los datos de origen están en Azure, el rendimiento será el mejor cuando los datos se encuentren en la misma región de Azure que Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-123">If your source data is in Azure, the performance will be best when the data is in the same Azure region as the Data Lake Store.</span></span>

### <a name="configure-data-ingestion-tools-for-maximum-parallelization"></a><span data-ttu-id="9d6cc-124">Configuración de herramientas de ingesta de datos para lograr una paralelización máxima</span><span class="sxs-lookup"><span data-stu-id="9d6cc-124">Configure Data Ingestion tools for maximum parallelization</span></span>

<span data-ttu-id="9d6cc-125">Una vez haya solucionado los cuellos de botella de la conectividad de la red y del hardware de origen, estará listo para configurar las herramientas de ingesta.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-125">Once you have addressed the source hardware and network connectivity bottlenecks above, you are ready to configure your ingestion tools.</span></span> <span data-ttu-id="9d6cc-126">En la tabla siguiente se resume la configuración básica de varias herramientas de ingesta populares y se ofrecen artículos detallados sobre la optimización del rendimiento relacionados con ellas.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-126">The following table summarizes the key settings for several popular ingestion tools and provides in-depth performance tuning articles for them.</span></span>  <span data-ttu-id="9d6cc-127">Para más información sobre la herramienta adecuada para su escenario, consulte este [artículo](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-scenarios).</span><span class="sxs-lookup"><span data-stu-id="9d6cc-127">To learn more about which tool to use for your scenario, visit this [article](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-scenarios).</span></span>

| <span data-ttu-id="9d6cc-128">Herramienta</span><span class="sxs-lookup"><span data-stu-id="9d6cc-128">Tool</span></span>               | <span data-ttu-id="9d6cc-129">Configuración</span><span class="sxs-lookup"><span data-stu-id="9d6cc-129">Settings</span></span>     | <span data-ttu-id="9d6cc-130">Más detalles</span><span class="sxs-lookup"><span data-stu-id="9d6cc-130">More Details</span></span>                                                                 |
|--------------------|------------------------------------------------------|------------------------------|
| <span data-ttu-id="9d6cc-131">PowerShell</span><span class="sxs-lookup"><span data-stu-id="9d6cc-131">Powershell</span></span>       | <span data-ttu-id="9d6cc-132">PerFileThreadCount, ConcurrentFileCount</span><span class="sxs-lookup"><span data-stu-id="9d6cc-132">PerFileThreadCount, ConcurrentFileCount</span></span> |  [<span data-ttu-id="9d6cc-133">Vínculo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-133">Link</span></span>](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-get-started-powershell#performance-guidance-while-using-powershell)   |
| <span data-ttu-id="9d6cc-134">AdlCopy</span><span class="sxs-lookup"><span data-stu-id="9d6cc-134">AdlCopy</span></span>    | <span data-ttu-id="9d6cc-135">Unidades de Azure Data Lake Analytics</span><span class="sxs-lookup"><span data-stu-id="9d6cc-135">Azure Data Lake Analytics units</span></span>  |   [<span data-ttu-id="9d6cc-136">Vínculo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-136">Link</span></span>](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-copy-data-azure-storage-blob#performance-considerations-for-using-adlcopy)         |
| <span data-ttu-id="9d6cc-137">DistCp</span><span class="sxs-lookup"><span data-stu-id="9d6cc-137">DistCp</span></span>            | <span data-ttu-id="9d6cc-138">-m (mapper)</span><span class="sxs-lookup"><span data-stu-id="9d6cc-138">-m (mapper)</span></span>   | [<span data-ttu-id="9d6cc-139">Vínculo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-139">Link</span></span>](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-copy-data-wasb-distcp#performance-considerations-while-using-distcp)                             |
| <span data-ttu-id="9d6cc-140">Azure Data Factory</span><span class="sxs-lookup"><span data-stu-id="9d6cc-140">Azure Data Factory</span></span>| <span data-ttu-id="9d6cc-141">parallelCopies</span><span class="sxs-lookup"><span data-stu-id="9d6cc-141">parallelCopies</span></span>    | [<span data-ttu-id="9d6cc-142">Vínculo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-142">Link</span></span>](../data-factory/data-factory-copy-activity-performance.md)                          |
| <span data-ttu-id="9d6cc-143">Sqoop</span><span class="sxs-lookup"><span data-stu-id="9d6cc-143">Sqoop</span></span>           | <span data-ttu-id="9d6cc-144">fs.azure.block.size, -m (mapper)</span><span class="sxs-lookup"><span data-stu-id="9d6cc-144">fs.azure.block.size, -m (mapper)</span></span>    |   [<span data-ttu-id="9d6cc-145">Vínculo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-145">Link</span></span>](https://blogs.msdn.microsoft.com/bigdatasupport/2015/02/17/sqoop-job-performance-tuning-in-hdinsight-hadoop/)        |

## <a name="structure-your-data-set"></a><span data-ttu-id="9d6cc-146">Estructuración del conjunto de datos</span><span class="sxs-lookup"><span data-stu-id="9d6cc-146">Structure your data set</span></span>

<span data-ttu-id="9d6cc-147">Cuando los datos se almacenan en Data Lake Store, el tamaño de los archivos, su número y la estructura de carpetas afectan al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-147">When data is stored in Data Lake Store, the file size, number of files, and folder structure have an impact on performance.</span></span>  <span data-ttu-id="9d6cc-148">En la siguiente sección se describen los procedimientos recomendados en estas áreas.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-148">The following section describes best practices in these areas.</span></span>  

### <a name="file-size"></a><span data-ttu-id="9d6cc-149">Tamaño de archivo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-149">File size</span></span>

<span data-ttu-id="9d6cc-150">Normalmente, los motores de análisis como HDInsight y Azure Data Lake Analytics tienen una sobrecarga por cada archivo.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-150">Typically, analytics engines such as HDInsight and Azure Data Lake Analytics have a per-file overhead.</span></span>  <span data-ttu-id="9d6cc-151">Si los datos se almacenan en muchos archivos pequeños, puede afectar desfavorablemente al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-151">If you store your data as many small files, this can negatively affect performance.</span></span>  

<span data-ttu-id="9d6cc-152">En general, organice los datos en archivos de un tamaño mayor para mejorar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-152">In general, organize your data into larger sized files for better performance.</span></span>  <span data-ttu-id="9d6cc-153">Como regla general, organice los conjuntos de datos en archivos de 256 MB o más.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-153">As a rule of thumb, organize data sets in files of 256MB or larger.</span></span> <span data-ttu-id="9d6cc-154">En algunos casos, como para las imágenes y datos binarios, no es posible procesarlos en paralelo.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-154">In some cases such as images and binary data, it is not possible to process them in parallel.</span></span>  <span data-ttu-id="9d6cc-155">En estos casos, se recomienda mantener los archivos individuales por debajo de 2 GB.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-155">In these cases, it is recommended to keep individual files under 2GB.</span></span>

<span data-ttu-id="9d6cc-156">A veces, las canalizaciones de datos ejercen un control limitado sobre los datos sin procesar que tienen una gran cantidad de archivos pequeños.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-156">Sometimes, data pipelines have limited control over the raw data which has lots of small files.</span></span>  <span data-ttu-id="9d6cc-157">Se recomienda disponer de un proceso de "cocinado" que genere archivos de mayor tamaño para usarlos en las aplicaciones de bajada.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-157">It is recommended to have a “cooking” process that generates larger files to use for downstream applications.</span></span>  

### <a name="organizing-time-series-data-in-folders"></a><span data-ttu-id="9d6cc-158">Organización de los datos de serie temporal en carpetas</span><span class="sxs-lookup"><span data-stu-id="9d6cc-158">Organizing Time Series data in folders</span></span>

<span data-ttu-id="9d6cc-159">En las cargas de trabajo de Hive y ADLA, la eliminación de las particiones de los datos de serie temporal puede ayudar a algunas consultas a leer solo un subconjunto de los datos, lo que mejora el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-159">For Hive and ADLA workloads, partition pruning of time-series data can help some queries read only a subset of the data which improves performance.</span></span>    

<span data-ttu-id="9d6cc-160">Aquellas canalizaciones que ingieren datos de serie temporal suelen ubicar sus archivos con una nomenclatura muy estructurada para los archivos y las carpetas.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-160">Those pipelines that ingest time-series data, often place their files with a very structured naming for files and folders.</span></span> <span data-ttu-id="9d6cc-161">A continuación se muestra un ejemplo muy común para los datos estructurados por fecha:</span><span class="sxs-lookup"><span data-stu-id="9d6cc-161">Below is a very common example we see for data that is structured by date:</span></span>

    \DataSet\YYYY\MM\DD\datafile_YYYY_MM_DD.tsv

<span data-ttu-id="9d6cc-162">Observe que la información de fecha y hora aparece tanto en las carpetas como en el nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-162">Notice that the datetime information appears both as folders and in the filename.</span></span>

<span data-ttu-id="9d6cc-163">Para la fecha y la hora, el siguiente es un patrón común</span><span class="sxs-lookup"><span data-stu-id="9d6cc-163">For date and time, the following is a common pattern</span></span>

    \DataSet\YYYY\MM\DD\HH\mm\datafile_YYYY_MM_DD_HH_mm.tsv

<span data-ttu-id="9d6cc-164">De nuevo, su elección de organización de los archivos y carpetas debería ser la que consiga un tamaño de archivo mayor y un número razonable de archivos en cada carpeta.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-164">Again, the choice you make with the folder and file organization should optimize for the larger file sizes and a reasonable number of files in each folder.</span></span>

## <a name="optimizing-io-intensive-jobs-on-hadoop-and-spark-workloads-on-hdinsight"></a><span data-ttu-id="9d6cc-165">Optimización de trabajos con muchas operaciones de E/S en las cargas de trabajo de Hadoop y Spark en HDInsight</span><span class="sxs-lookup"><span data-stu-id="9d6cc-165">Optimizing I/O intensive jobs on Hadoop and Spark workloads on HDInsight</span></span>

<span data-ttu-id="9d6cc-166">Los trabajos se dividen en una de las siguientes tres categorías:</span><span class="sxs-lookup"><span data-stu-id="9d6cc-166">Jobs fall into one of the following three categories:</span></span>

* <span data-ttu-id="9d6cc-167">**Gran uso de CPU.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-167">**CPU intensive.**</span></span>  <span data-ttu-id="9d6cc-168">Estos trabajos tienen tiempos de cálculo largos con tiempos de E/S mínimos.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-168">These jobs have long computation times with minimal I/O times.</span></span>  <span data-ttu-id="9d6cc-169">Algunos ejemplos son los trabajos de procesamiento del lenguaje natural y el aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-169">Examples include machine learning and natural language processing jobs.</span></span>  
* <span data-ttu-id="9d6cc-170">**Gran uso de memoria.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-170">**Memory intensive.**</span></span>  <span data-ttu-id="9d6cc-171">Estos trabajos usan una gran cantidad de memoria.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-171">These jobs use lots of memory.</span></span>  <span data-ttu-id="9d6cc-172">Algunos ejemplos son los trabajos de análisis en tiempo real y PageRank.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-172">Examples include PageRank and real-time analytics jobs.</span></span>  
* <span data-ttu-id="9d6cc-173">**Gran uso de operaciones de E/S.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-173">**I/O intensive.**</span></span>  <span data-ttu-id="9d6cc-174">Estos trabajos dedican la mayor parte de su tiempo a realizar operaciones de E/S.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-174">These jobs spend most of their time doing I/O.</span></span>  <span data-ttu-id="9d6cc-175">Un ejemplo común es un trabajo de copia que solo realice operaciones de lectura y escritura.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-175">A common example is a copy job which does only read and write operations.</span></span>  <span data-ttu-id="9d6cc-176">Otros ejemplos son los trabajos de preparación de datos que leen una gran cantidad de datos, realizan alguna transformación en ellos y luego los escriben de nuevo en el almacén.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-176">Other examples include data preparation jobs that read a lot of data, performs some data transformation, and then writes the data back to the store.</span></span>  

<span data-ttu-id="9d6cc-177">Las siguientes instrucciones solo se pueden aplicar a los trabajos que usan mucho las operaciones de E/S.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-177">The following guidance is only applicable to I/O intensive jobs.</span></span>

### <a name="general-considerations-for-an-hdinsight-cluster"></a><span data-ttu-id="9d6cc-178">Consideraciones generales para un clúster de HDInsight</span><span class="sxs-lookup"><span data-stu-id="9d6cc-178">General Considerations for an HDInsight cluster</span></span>

* <span data-ttu-id="9d6cc-179">**Versiones de HDInsight.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-179">**HDInsight versions.**</span></span> <span data-ttu-id="9d6cc-180">Para obtener el mejor rendimiento, utilice la versión más reciente de HDInsight.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-180">For best performance, use the latest release of HDInsight.</span></span>
* <span data-ttu-id="9d6cc-181">**Regiones.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-181">**Regions.**</span></span> <span data-ttu-id="9d6cc-182">Coloque Data Lake Store en la misma región que el clúster de HDInsight.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-182">Place the Data Lake Store in the same region as the HDInsight cluster.</span></span>  

<span data-ttu-id="9d6cc-183">Un clúster de HDInsight se compone de dos nodos principales y algunos nodos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-183">An HDInsight cluster is composed of two head nodes and some worker nodes.</span></span> <span data-ttu-id="9d6cc-184">Cada nodo de trabajo proporciona una cantidad específica de núcleos y de memoria, lo que se determina según el tipo de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-184">Each worker node provides a specific number of cores and memory, which is determined by the VM-type.</span></span>  <span data-ttu-id="9d6cc-185">Cuando se ejecuta un trabajo, YARN es el negociador de recursos que asigna la memoria disponible y los núcleos para crear los contenedores.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-185">When running a job, YARN is the resource negotiator that allocates the available memory and cores to create containers.</span></span>  <span data-ttu-id="9d6cc-186">Cada contenedor ejecuta las tareas necesarias para completar el trabajo.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-186">Each container runs the tasks needed to complete the job.</span></span>  <span data-ttu-id="9d6cc-187">Los contenedores se ejecutan en paralelo para procesar las tareas rápidamente.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-187">Containers run in parallel to process tasks quickly.</span></span> <span data-ttu-id="9d6cc-188">Por lo tanto, el rendimiento se mejora ejecutando tantos contenedores en paralelo como sea posible.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-188">Therefore, performance is improved by running as many parallel containers as possible.</span></span>

<span data-ttu-id="9d6cc-189">Hay tres niveles dentro de un clúster de HDInsight que se pueden optimizar para aumentar el número de contenedores y usar toda la capacidad de proceso disponible.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-189">There are three layers within an HDInsight cluster that can be tuned to increase the number of containers and use all available throughput.</span></span>  

* <span data-ttu-id="9d6cc-190">**Nivel físico**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-190">**Physical layer**</span></span>
* <span data-ttu-id="9d6cc-191">**Nivel de YARN**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-191">**YARN layer**</span></span>
* <span data-ttu-id="9d6cc-192">**Nivel de carga de trabajo**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-192">**Workload layer**</span></span>

### <a name="physical-layer"></a><span data-ttu-id="9d6cc-193">Nivel físico</span><span class="sxs-lookup"><span data-stu-id="9d6cc-193">Physical Layer</span></span>

<span data-ttu-id="9d6cc-194">**Ejecute el clúster con más nodos o máquinas virtuales de un tamaño mayor.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-194">**Run cluster with more nodes and/or larger sized VMs.**</span></span>  <span data-ttu-id="9d6cc-195">Un clúster mayor le permitirá ejecutar más contenedores de YARN, tal como se muestra en la ilustración siguiente.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-195">A larger cluster will enable you to run more YARN containers as shown in the picture below.</span></span>

![Rendimiento de Data Lake Store](./media/data-lake-store-performance-tuning-guidance/VM.png)

<span data-ttu-id="9d6cc-197">**Use máquinas virtuales con más ancho de banda de red.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-197">**Use VMs with more network bandwidth.**</span></span>  <span data-ttu-id="9d6cc-198">La cantidad de ancho de banda de red puede ser un cuello de botella, si hay menos de lo que necesita la capacidad de proceso de Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-198">The amount of network bandwidth can be a bottleneck if there is less network bandwidth than Data Lake Store throughput.</span></span>  <span data-ttu-id="9d6cc-199">Diferentes máquinas virtuales tendrán varios tamaños de ancho de banda de red.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-199">Different VMs will have varying network bandwidth sizes.</span></span>  <span data-ttu-id="9d6cc-200">Elija un tipo de máquina virtual que tenga el mayor ancho de banda de red posible.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-200">Choose a VM-type that has the largest possible network bandwidth.</span></span>

### <a name="yarn-layer"></a><span data-ttu-id="9d6cc-201">Nivel de YARN</span><span class="sxs-lookup"><span data-stu-id="9d6cc-201">YARN Layer</span></span>

<span data-ttu-id="9d6cc-202">**Use contenedores de YARN menores.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-202">**Use smaller YARN containers.**</span></span>  <span data-ttu-id="9d6cc-203">Reduzca el tamaño de cada contenedor de YARN para crear más contenedores con la misma cantidad de recursos.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-203">Reduce the size of each YARN container to create more containers with the same amount of resources.</span></span>

![Rendimiento de Data Lake Store](./media/data-lake-store-performance-tuning-guidance/small-containers.png)

<span data-ttu-id="9d6cc-205">En función de la carga de trabajo, siempre habrá un tamaño de contenedor de YARN mínimo que se necesite.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-205">Depending on your workload, there will always be a minimum YARN container size that is needed.</span></span> <span data-ttu-id="9d6cc-206">Si elige un contenedor demasiado pequeño, los trabajos no tendrán memoria suficiente.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-206">If you pick too small a container, your jobs will run into out-of-memory issues.</span></span> <span data-ttu-id="9d6cc-207">Normalmente, los contenedores de YARN no deben ser menores de 1 GB.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-207">Typically YARN containers should be no smaller than 1GB.</span></span> <span data-ttu-id="9d6cc-208">Es habitual ver contenedores de YARN de 3 GB.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-208">It’s common to see 3GB YARN containers.</span></span> <span data-ttu-id="9d6cc-209">Para algunas cargas de trabajo, puede que necesite contenedores de YARN mayores.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-209">For some workloads, you may need larger YARN containers.</span></span>  

<span data-ttu-id="9d6cc-210">**Aumente los núcleos para cada contenedor de YARN.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-210">**Increase cores per YARN container.**</span></span>  <span data-ttu-id="9d6cc-211">Aumente el número de núcleos asignados a cada contenedor para incrementar las tareas en paralelo que se ejecutan en cada uno.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-211">Increase the number of cores allocated to each container to increase the number of parallel tasks that run in each container.</span></span>  <span data-ttu-id="9d6cc-212">Funciona en las aplicaciones como Spark que ejecutan varias tareas por contenedor.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-212">This works for applications like Spark which run multiple tasks per container.</span></span>  <span data-ttu-id="9d6cc-213">En las aplicaciones como Hive que ejecutan un único subproceso en cada contenedor, es mejor tener varios contenedores en lugar de más núcleos por contenedor.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-213">For applications like Hive which run a single thread in each container, it is better to have more containers rather than more cores per container.</span></span>   

### <a name="workload-layer"></a><span data-ttu-id="9d6cc-214">Nivel de carga de trabajo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-214">Workload Layer</span></span>

<span data-ttu-id="9d6cc-215">**Use todos los contenedores disponibles.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-215">**Use all available containers.**</span></span>  <span data-ttu-id="9d6cc-216">Establezca el número de tareas para que sea igual o mayor que el número de contenedores disponibles de modo que se usen todos los recursos.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-216">Set the number of tasks to be equal or larger than the number of available containers so that all resources are utilized.</span></span>

![Rendimiento de Data Lake Store](./media/data-lake-store-performance-tuning-guidance/use-containers.png)

<span data-ttu-id="9d6cc-218">**Los errores de las tareas son costosos.**</span><span class="sxs-lookup"><span data-stu-id="9d6cc-218">**Failed tasks are costly.**</span></span> <span data-ttu-id="9d6cc-219">Si cada tarea tiene una gran cantidad de datos que se van a procesar, el error de una tarea provoca un reintento que resulta caro.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-219">If each task has a large amount of data to process, then failure of a task results in an expensive retry.</span></span>  <span data-ttu-id="9d6cc-220">Por lo tanto, es mejor que cree más tareas y que cada una procese una pequeña cantidad de datos.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-220">Therefore, it is better to create more tasks, each of which processes a small amount of data.</span></span>

<span data-ttu-id="9d6cc-221">Además de las directrices generales anteriores, cada aplicación tiene diferentes parámetros disponibles que pueden optimizarse para ella en concreto.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-221">In addition to the general guidelines above, each application has different parameters available to tune for that specific application.</span></span> <span data-ttu-id="9d6cc-222">En la tabla siguiente se enumeran algunos de los parámetros y los vínculos para empezar a optimizar el rendimiento de cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="9d6cc-222">The table below lists some of the parameters and links to get started with performance tuning for each application.</span></span>

| <span data-ttu-id="9d6cc-223">Carga de trabajo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-223">Workload</span></span>               | <span data-ttu-id="9d6cc-224">Parámetro para establecer tareas</span><span class="sxs-lookup"><span data-stu-id="9d6cc-224">Parameter to set tasks</span></span>                                                         |
|--------------------|-------------------------------------------------------------------------------------|
| [<span data-ttu-id="9d6cc-225">Spark en HDInisight</span><span class="sxs-lookup"><span data-stu-id="9d6cc-225">Spark on HDInisight</span></span>](data-lake-store-performance-tuning-spark.md)       | <ul><li><span data-ttu-id="9d6cc-226">Num-executors</span><span class="sxs-lookup"><span data-stu-id="9d6cc-226">Num-executors</span></span></li><li><span data-ttu-id="9d6cc-227">Memoria del ejecutor</span><span class="sxs-lookup"><span data-stu-id="9d6cc-227">Executor-memory</span></span></li><li><span data-ttu-id="9d6cc-228">Executor-cores</span><span class="sxs-lookup"><span data-stu-id="9d6cc-228">Executor-cores</span></span></li></ul> |
| [<span data-ttu-id="9d6cc-229">Hive en HDInsight</span><span class="sxs-lookup"><span data-stu-id="9d6cc-229">Hive on HDInsight</span></span>](data-lake-store-performance-tuning-hive.md)    | <ul><li><span data-ttu-id="9d6cc-230">hive.tez.container.size</span><span class="sxs-lookup"><span data-stu-id="9d6cc-230">hive.tez.container.size</span></span></li></ul>         |
| [<span data-ttu-id="9d6cc-231">MapReduce en HDInsight</span><span class="sxs-lookup"><span data-stu-id="9d6cc-231">MapReduce on HDInsight</span></span>](data-lake-store-performance-tuning-mapreduce.md)            | <ul><li><span data-ttu-id="9d6cc-232">Mapreduce.map.memory</span><span class="sxs-lookup"><span data-stu-id="9d6cc-232">Mapreduce.map.memory</span></span></li><li><span data-ttu-id="9d6cc-233">Mapreduce.job.maps</span><span class="sxs-lookup"><span data-stu-id="9d6cc-233">Mapreduce.job.maps</span></span></li><li><span data-ttu-id="9d6cc-234">Mapreduce.reduce.memory</span><span class="sxs-lookup"><span data-stu-id="9d6cc-234">Mapreduce.reduce.memory</span></span></li><li><span data-ttu-id="9d6cc-235">Mapreduce.job.reduces</span><span class="sxs-lookup"><span data-stu-id="9d6cc-235">Mapreduce.job.reduces</span></span></li></ul> |
| [<span data-ttu-id="9d6cc-236">Storm en HDInsight</span><span class="sxs-lookup"><span data-stu-id="9d6cc-236">Storm on HDInsight</span></span>](data-lake-store-performance-tuning-storm.md)| <ul><li><span data-ttu-id="9d6cc-237">Número de procesos de trabajo</span><span class="sxs-lookup"><span data-stu-id="9d6cc-237">Number of worker processes</span></span></li><li><span data-ttu-id="9d6cc-238">Número de instancias de ejecutor de spout</span><span class="sxs-lookup"><span data-stu-id="9d6cc-238">Number of spout executor instances</span></span></li><li><span data-ttu-id="9d6cc-239">Número de instancias de ejecutor de bolt</span><span class="sxs-lookup"><span data-stu-id="9d6cc-239">Number of bolt executor instances</span></span> </li><li><span data-ttu-id="9d6cc-240">Número de tareas de spout</span><span class="sxs-lookup"><span data-stu-id="9d6cc-240">Number of spout tasks</span></span></li><li><span data-ttu-id="9d6cc-241">Número de tareas de bolt</span><span class="sxs-lookup"><span data-stu-id="9d6cc-241">Number of bolt tasks</span></span></li></ul>|

## <a name="see-also"></a><span data-ttu-id="9d6cc-242">Consulte también</span><span class="sxs-lookup"><span data-stu-id="9d6cc-242">See also</span></span>
* [<span data-ttu-id="9d6cc-243">Información general del Almacén de Azure Data Lake</span><span class="sxs-lookup"><span data-stu-id="9d6cc-243">Overview of Azure Data Lake Store</span></span>](data-lake-store-overview.md)
* [<span data-ttu-id="9d6cc-244">Tutorial: Introducción a Análisis de Azure Data Lake mediante el Portal de vista previa de Azure</span><span class="sxs-lookup"><span data-stu-id="9d6cc-244">Get Started with Azure Data Lake Analytics</span></span>](../data-lake-analytics/data-lake-analytics-get-started-portal.md)
