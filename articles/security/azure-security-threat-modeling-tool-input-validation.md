---
title: "Validación de entrada: Microsoft Threat Modeling Tool (Azure) | Microsoft Docs"
description: mitigaciones para amenazas expuestas en Threat Modeling Tool
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: b7ce6f353cf8cf48d5fb038ee77b0d3fdae16fb7
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-input-validation--mitigations"></a><span data-ttu-id="dbcc0-103">Marco de seguridad: Validación de entrada | Mitigaciones</span><span class="sxs-lookup"><span data-stu-id="dbcc0-103">Security Frame: Input Validation | Mitigations</span></span> 
| <span data-ttu-id="dbcc0-104">Producto o servicio</span><span class="sxs-lookup"><span data-stu-id="dbcc0-104">Product/Service</span></span> | <span data-ttu-id="dbcc0-105">Artículo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="dbcc0-106">**Aplicación web**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-106">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="dbcc0-107">Deshabilite el scripting XSLT para todas las transformaciones mediante hojas de estilos no de confianza</span><span class="sxs-lookup"><span data-stu-id="dbcc0-107">Disable XSLT scripting for all transforms using untrusted style sheets</span></span>](#disable-xslt)</li><li>[<span data-ttu-id="dbcc0-108">Compruebe que cada página que pueda incluir contenido controlable por el usuario quede excluida del rastreo de MIME automático</span><span class="sxs-lookup"><span data-stu-id="dbcc0-108">Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>](#out-sniffing)</li><li>[<span data-ttu-id="dbcc0-109">Proteja o deshabilite la resolución de entidades XML</span><span class="sxs-lookup"><span data-stu-id="dbcc0-109">Harden or Disable XML Entity Resolution</span></span>](#xml-resolution)</li><li>[<span data-ttu-id="dbcc0-110">Las aplicaciones que usan http.sys realizan la comprobación de canonización de URL</span><span class="sxs-lookup"><span data-stu-id="dbcc0-110">Applications utilizing http.sys perform URL canonicalization verification</span></span>](#app-verification)</li><li>[<span data-ttu-id="dbcc0-111">Asegúrese de que los controles adecuados estén en vigor al aceptar archivos de usuarios</span><span class="sxs-lookup"><span data-stu-id="dbcc0-111">Ensure appropriate controls are in place when accepting files from users</span></span>](#controls-users)</li><li>[<span data-ttu-id="dbcc0-112">Asegúrese de que se usen parámetros con seguridad de tipos en la aplicación web para el acceso a datos</span><span class="sxs-lookup"><span data-stu-id="dbcc0-112">Ensure that type-safe parameters are used in Web Application for data access</span></span>](#typesafe)</li><li>[<span data-ttu-id="dbcc0-113">Use clases de enlace de modelos distintas o listas de filtros de enlace para evitar la vulnerabilidad de asignación masiva de MVC</span><span class="sxs-lookup"><span data-stu-id="dbcc0-113">Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>](#binding-mvc)</li><li>[<span data-ttu-id="dbcc0-114">Codifique la salida web que no sea de confianza antes de representarla</span><span class="sxs-lookup"><span data-stu-id="dbcc0-114">Encode untrusted web output prior to rendering</span></span>](#rendering)</li><li>[<span data-ttu-id="dbcc0-115">Lleve a cabo la validación de entrada y el filtrado para todas las propiedades de modelo de tipo cadena</span><span class="sxs-lookup"><span data-stu-id="dbcc0-115">Perform input validation and filtering on all string type Model properties</span></span>](#typemodel)</li><li>[<span data-ttu-id="dbcc0-116">Se debería aplicar la comprobación de estado a los campos de formulario que acepten todos los caracteres, por ejemplo, editor de texto enriquecido</span><span class="sxs-lookup"><span data-stu-id="dbcc0-116">Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>](#richtext)</li><li>[<span data-ttu-id="dbcc0-117">No asigne elementos DOM a receptores que carezcan de codificación integrada</span><span class="sxs-lookup"><span data-stu-id="dbcc0-117">Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>](#inbuilt-encode)</li><li>[<span data-ttu-id="dbcc0-118">Valide que todos los redireccionamientos dentro de la aplicación se cierren o se realicen de forma segura</span><span class="sxs-lookup"><span data-stu-id="dbcc0-118">Validate all redirects within the application are closed or done safely</span></span>](#redirect-safe)</li><li>[<span data-ttu-id="dbcc0-119">Implemente la validación de entrada en todos los parámetros de tipo cadena aceptados por métodos de controlador</span><span class="sxs-lookup"><span data-stu-id="dbcc0-119">Implement input validation on all string type parameters accepted by Controller methods</span></span>](#string-method)</li><li>[<span data-ttu-id="dbcc0-120">Establezca el tiempo de espera del límite superior para el procesamiento de expresiones regulares con el fin de impedir ataques DoS causados por expresiones regulares incorrectas</span><span class="sxs-lookup"><span data-stu-id="dbcc0-120">Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>](#dos-expression)</li><li>[<span data-ttu-id="dbcc0-121">No use Html.Raw en las vistas Razor</span><span class="sxs-lookup"><span data-stu-id="dbcc0-121">Avoid using Html.Raw in Razor views</span></span>](#html-razor)</li></ul> | 
| <span data-ttu-id="dbcc0-122">**Base de datos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-122">**Database**</span></span> | <ul><li>[<span data-ttu-id="dbcc0-123">No use consultas dinámicas en procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="dbcc0-123">Do not use dynamic queries in stored procedures</span></span>](#stored-proc)</li></ul> |
| <span data-ttu-id="dbcc0-124">**API web**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-124">**Web API**</span></span> | <ul><li>[<span data-ttu-id="dbcc0-125">Asegúrese de que se lleve a cabo la validación del modelo en métodos de API web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-125">Ensure that model validation is done on Web API methods</span></span>](#validation-api)</li><li>[<span data-ttu-id="dbcc0-126">Implemente la validación de entrada en todos los parámetros de tipo cadena aceptados por métodos de API web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-126">Implement input validation on all string type parameters accepted by Web API methods</span></span>](#string-api)</li><li>[<span data-ttu-id="dbcc0-127">Asegúrese de que se usen parámetros con seguridad de tipos en la API web para el acceso a datos</span><span class="sxs-lookup"><span data-stu-id="dbcc0-127">Ensure that type-safe parameters are used in Web API for data access</span></span>](#typesafe-api)</li></ul> | 
| <span data-ttu-id="dbcc0-128">**Azure Document DB**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-128">**Azure Document DB**</span></span> | <ul><li>[<span data-ttu-id="dbcc0-129">Use consultas SQL parametrizadas para DocumentDB</span><span class="sxs-lookup"><span data-stu-id="dbcc0-129">Use parametrized SQL queries for DocumentDB</span></span>](#sql-docdb)</li></ul> | 
| <span data-ttu-id="dbcc0-130">**WCF**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-130">**WCF**</span></span> | <ul><li>[<span data-ttu-id="dbcc0-131">Validación de entrada de WCF mediante enlaces de esquema</span><span class="sxs-lookup"><span data-stu-id="dbcc0-131">WCF Input validation through Schema binding</span></span>](#schema-binding)</li><li>[<span data-ttu-id="dbcc0-132">Validación de entrada de WCF mediante inspectores de parámetros</span><span class="sxs-lookup"><span data-stu-id="dbcc0-132">WCF- Input validation through Parameter Inspectors</span></span>](#parameters)</li></ul> |

## <span data-ttu-id="dbcc0-133"><a id="disable-xslt"></a>Deshabilite el scripting XSLT para todas las transformaciones mediante hojas de estilos no de confianza</span><span class="sxs-lookup"><span data-stu-id="dbcc0-133"><a id="disable-xslt"></a>Disable XSLT scripting for all transforms using untrusted style sheets</span></span>

| <span data-ttu-id="dbcc0-134">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-134">Title</span></span>                   | <span data-ttu-id="dbcc0-135">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-135">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-136">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-136">**Component**</span></span>               | <span data-ttu-id="dbcc0-137">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-137">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-138">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-138">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-139">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-139">Build</span></span> |  
| <span data-ttu-id="dbcc0-140">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-140">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-141">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-141">Generic</span></span> |
| <span data-ttu-id="dbcc0-142">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-142">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-143">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-143">N/A</span></span>  |
| <span data-ttu-id="dbcc0-144">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-144">**References**</span></span>              | <span data-ttu-id="dbcc0-145">[Seguridad XSLT](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [Propiedad XsltSettings.EnableScript](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-145">[XSLT Security](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span></span> |
| <span data-ttu-id="dbcc0-146">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-146">**Steps**</span></span> | <span data-ttu-id="dbcc0-147">XSLT es compatible con el scripting dentro de hojas de estilos mediante el elemento `<msxml:script>`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-147">XSLT supports scripting inside style sheets using the `<msxml:script>` element.</span></span> <span data-ttu-id="dbcc0-148">Esto permite que se usen funciones personalizadas en una transformación XSLT.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-148">This allows custom functions to be used in an XSLT transformation.</span></span> <span data-ttu-id="dbcc0-149">El script se ejecuta en el contexto del proceso que lleva a cabo la transformación.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-149">The script is executed under the context of the process performing the transform.</span></span> <span data-ttu-id="dbcc0-150">El script XSLT debe estar deshabilitado cuando se encuentra en un entorno que no sea de confianza para evitar la ejecución de código no de confianza.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-150">XSLT script must be disabled when in an untrusted environment to prevent execution of untrusted code.</span></span> <span data-ttu-id="dbcc0-151">*Si usa .NET:* el scripting XSLT está deshabilitado de forma predeterminada; sin embargo, debe asegurarse de que no se haya habilitado explícitamente por medio de la propiedad `XsltSettings.EnableScript`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-151">*If using .NET:* XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the `XsltSettings.EnableScript` property.</span></span>|

### <a name="example"></a><span data-ttu-id="dbcc0-152">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-152">Example</span></span> 

```C#
XsltSettings settings = new XsltSettings();
settings.EnableScript = true; // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="dbcc0-153">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-153">Example</span></span>
<span data-ttu-id="dbcc0-154">Si lo usa con MSXML 6.0, el scripting XSLT está deshabilitado de forma predeterminada. Sin embargo, debe asegurarse de que no se haya habilitado explícitamente por medio de la propiedad AllowXsltScript del objeto DOM XML.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-154">If you are using using MSXML 6.0, XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the XML DOM object property AllowXsltScript.</span></span> 

```C#
doc.setProperty("AllowXsltScript", true); // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="dbcc0-155">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-155">Example</span></span>
<span data-ttu-id="dbcc0-156">Si usa MSXML 5 o una versión anterior, el scripting XSLT está habilitado de forma predeterminada y debe deshabilitarlo explícitamente.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-156">If you are using MSXML 5 or below, XSLT scripting is enabled by default and you must explicitly disable it.</span></span> <span data-ttu-id="dbcc0-157">Establezca la propiedad AllowXsltScript del objeto DOM XML en false.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-157">Set the XML DOM object property AllowXsltScript to false.</span></span> 

```C#
doc.setProperty("AllowXsltScript", false); // CORRECT. Setting to false disables XSLT scripting.
```

## <span data-ttu-id="dbcc0-158"><a id="out-sniffing"></a>Compruebe que cada página que pueda incluir contenido controlable por el usuario quede excluida del rastreo de MIME automático</span><span class="sxs-lookup"><span data-stu-id="dbcc0-158"><a id="out-sniffing"></a>Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>

| <span data-ttu-id="dbcc0-159">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-159">Title</span></span>                   | <span data-ttu-id="dbcc0-160">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-160">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-161">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-161">**Component**</span></span>               | <span data-ttu-id="dbcc0-162">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-162">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-163">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-163">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-164">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-164">Build</span></span> |  
| <span data-ttu-id="dbcc0-165">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-165">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-166">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-166">Generic</span></span> |
| <span data-ttu-id="dbcc0-167">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-167">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-168">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-168">N/A</span></span>  |
| <span data-ttu-id="dbcc0-169">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-169">**References**</span></span>              | <span data-ttu-id="dbcc0-170">[IE8 Security Part V - Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx) (Seguridad de IE8 (parte V): Protección completa)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-170">[IE8 Security Part V - Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)</span></span>  |
| <span data-ttu-id="dbcc0-171">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-171">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-172">Para cada página que podría incluir contenido controlable por el usuario, debe usar el encabezado HTTP `X-Content-Type-Options:nosniff`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-172">For each page that could contain user controllable content, you must use the HTTP Header `X-Content-Type-Options:nosniff`.</span></span> <span data-ttu-id="dbcc0-173">Para cumplir este requisito, puede establecer el encabezado necesario página a página solo para aquellas que puedan incluir contenido controlable por el usuario o puede establecerlo globalmente para todas las páginas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-173">To comply with this requirement, you can either set the required header page by page for only those pages that might contain user-controllable content, or you can set it globally for all pages in the application.</span></span></p><p><span data-ttu-id="dbcc0-174">Cada tipo de archivo que se entregue desde un servidor web tiene asociado un [tipo MIME](http://en.wikipedia.org/wiki/Mime_type) (también llamado *content-type*) que describe la naturaleza del contenido (es decir, imagen, texto, aplicación, etc.).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-174">Each type of file delivered from a web server has an associated [MIME type](http://en.wikipedia.org/wiki/Mime_type) (also called a *content-type*) that describes the nature of the content (that is, image, text, application, etc.)</span></span></p><p><span data-ttu-id="dbcc0-175">El encabezado X-Content-Type-Options es un encabezado HTTP que permite a los desarrolladores especificar que su contenido no se debe someter a un rastreo de MIME.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-175">The X-Content-Type-Options header is an HTTP header that allows developers to specify that their content should not be MIME-sniffed.</span></span> <span data-ttu-id="dbcc0-176">Este encabezado se ha diseñado para mitigar los ataques de rastreo de MIME.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-176">This header is designed to mitigate MIME-Sniffing attacks.</span></span> <span data-ttu-id="dbcc0-177">Se agregó compatibilidad con este encabezado en Internet Explorer 8 (IE8).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-177">Support for this header was added in Internet Explorer 8 (IE8)</span></span></p><p><span data-ttu-id="dbcc0-178">Los únicos que se beneficiarán de X-Content-Type-Options son los usuarios de Internet Explorer 8 (IE8).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-178">Only users of Internet Explorer 8 (IE8) will benefit from X-Content-Type-Options.</span></span> <span data-ttu-id="dbcc0-179">Las versiones anteriores de Internet Explorer no respetan actualmente el encabezado X-Content-Type-Options.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-179">Previous versions of Internet Explorer do not currently respect the X-Content-Type-Options header</span></span></p><p><span data-ttu-id="dbcc0-180">Internet Explorer 8 (y versiones posteriores) es el único explorador importante que implementa una característica para excluir del rastreo de MIME.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-180">Internet Explorer 8 (and later) are the only major browsers to implement a MIME-sniffing opt-out feature.</span></span> <span data-ttu-id="dbcc0-181">Cuando otros exploradores importantes (Firefox, Safari, Chrome) implementen características similares, si lo hacen, se actualizará esta recomendación para incluir también la sintaxis de esos exploradores.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-181">If and when other major browsers (Firefox, Safari, Chrome) implement similar features, this recommendation will be updated to include syntax for those browsers as well</span></span></p>|

### <a name="example"></a><span data-ttu-id="dbcc0-182">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-182">Example</span></span>
<span data-ttu-id="dbcc0-183">Para habilitar de forma global el encabezado necesario para todas las páginas de la aplicación, puede realizar una de las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-183">To enable the required header globally for all pages in the application, you can do one of the following:</span></span> 

* <span data-ttu-id="dbcc0-184">Agregue el encabezado en el archivo Web.config si la aplicación está hospedada con Internet Information Services (IIS) 7.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-184">Add the header in the web.config file if the application is hosted by Internet Information Services (IIS) 7</span></span> 

```
<system.webServer> 
  <httpProtocol> 
    <customHeaders> 
      <add name=""X-Content-Type-Options"" value=""nosniff""/>
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

* <span data-ttu-id="dbcc0-185">Agregue el encabezado mediante el método Application\_BeginRequest global.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-185">Add the header through the global Application\_BeginRequest</span></span> 

``` 
void Application_BeginRequest(object sender, EventArgs e)
{
  this.Response.Headers[""X-Content-Type-Options""] = ""nosniff"";
} 
```

* <span data-ttu-id="dbcc0-186">Implemente un módulo HTTP personalizado</span><span class="sxs-lookup"><span data-stu-id="dbcc0-186">Implement custom HTTP module</span></span> 

``` 
public class XContentTypeOptionsModule : IHttpModule 
  {
    #region IHttpModule Members 
    public void Dispose() 
    { 

    } 
    public void Init(HttpApplication context)
    { 
      context.PreSendRequestHeaders += newEventHandler(context_PreSendRequestHeaders); 
    } 
    #endregion 
    void context_PreSendRequestHeaders(object sender, EventArgs e) 
      { 
        HttpApplication application = sender as HttpApplication; 
        if (application == null) 
          return; 
        if (application.Response.Headers[""X-Content-Type-Options ""] != null) 
          return; 
        application.Response.Headers.Add(""X-Content-Type-Options "", ""nosniff""); 
      } 
  } 

``` 

* <span data-ttu-id="dbcc0-187">Puede habilitar el encabezado necesario solo para páginas específicas si lo agrega a respuestas individuales:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-187">You can enable the required header only for specific pages by adding it to individual responses:</span></span> 

```
this.Response.Headers[""X-Content-Type-Options""] = ""nosniff""; 
``` 

## <span data-ttu-id="dbcc0-188"><a id="xml-resolution"></a>Proteja o deshabilite la resolución de entidades XML</span><span class="sxs-lookup"><span data-stu-id="dbcc0-188"><a id="xml-resolution"></a>Harden or Disable XML Entity Resolution</span></span>

| <span data-ttu-id="dbcc0-189">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-189">Title</span></span>                   | <span data-ttu-id="dbcc0-190">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-190">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-191">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-191">**Component**</span></span>               | <span data-ttu-id="dbcc0-192">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-192">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-193">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-193">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-194">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-194">Build</span></span> |  
| <span data-ttu-id="dbcc0-195">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-195">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-196">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-196">Generic</span></span> |
| <span data-ttu-id="dbcc0-197">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-197">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-198">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-198">N/A</span></span>  |
| <span data-ttu-id="dbcc0-199">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-199">**References**</span></span>              | <span data-ttu-id="dbcc0-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html) (Expansión de entidad XML), [Ataques por denegación de servicio y defensas XML](http://msdn.microsoft.com/magazine/ee335713.aspx), [Información general de seguridad MSXML](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Prácticas recomendadas para proteger el código MSXML](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html) (Referencia del protocolo NSXMLParserDelegate), [Resolver recursos externos](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx), [MSXML Security Overview](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Best Practices for Securing MSXML Code](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolving External References](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span></span> |
| <span data-ttu-id="dbcc0-201">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-201">**Steps**</span></span>| <p><span data-ttu-id="dbcc0-202">Aunque no está generalizada, hay una característica de XML que permite al analizador XML expandir las entidades de macro con valores definidos dentro del propio documento o desde orígenes externos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-202">Although it is not widely used, there is a feature of XML that allows the XML parser to expand macro entities with values defined either within the document itself or from external sources.</span></span> <span data-ttu-id="dbcc0-203">Por ejemplo, el documento podría definir una entidad "companyname" con el valor "Microsoft", de forma que, cada vez que aparezca el texto "&companyname;" en el documento, se reemplace automáticamente por el texto Microsoft.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-203">For example, the document might define an entity "companyname" with the value "Microsoft," so that every time the text "&companyname;" appears in the document, it is automatically replaced with the text Microsoft.</span></span> <span data-ttu-id="dbcc0-204">O bien, el documento podría definir una entidad "MSFTStock" que hace referencia a un servicio web externo para capturar el valor actual de las acciones de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-204">Or, the document might define an entity "MSFTStock" that references an external web service to fetch the current value of Microsoft stock.</span></span></p><p><span data-ttu-id="dbcc0-205">Después, siempre que "&MSFTStock;" aparezca en el documento, se reemplazará automáticamente por el precio actual de las acciones.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-205">Then any time "&MSFTStock;" appears in the document, it is automatically replaced with the current stock price.</span></span> <span data-ttu-id="dbcc0-206">Sin embargo, se puede abusar de esta funcionalidad para crear las condiciones para una denegación de servicio (DoS).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-206">However, this functionality can be abused to create denial of service (DoS) conditions.</span></span> <span data-ttu-id="dbcc0-207">Un atacante puede anidar varias entidades para crear una bomba XML de expansión exponencial que consuma toda la memoria disponible en el sistema.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-207">An attacker can nest multiple entities to create an exponential expansion XML bomb that consumes all available memory on the system.</span></span> </p><p><span data-ttu-id="dbcc0-208">También puede crear una referencia externa que transmita de vuelta una cantidad infinita de datos o que simplemente bloquee el subproceso.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-208">Alternatively, he can create an external reference that streams back an infinite amount of data or that simply hangs the thread.</span></span> <span data-ttu-id="dbcc0-209">Como resultado, todos los equipos deben deshabilitar por completo la resolución de entidades XML internas o externas si su aplicación no la usa o limitar de forma manual la cantidad de memoria y el tiempo que la aplicación puede consumir para la resolución de entidades si esta funcionalidad es absolutamente necesaria.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-209">As a result, all teams must disable internal and/or external XML entity resolution entirely if their application does not use it, or manually limit the amount of memory and time that the application can consume for entity resolution if this functionality is absolutely necessary.</span></span> <span data-ttu-id="dbcc0-210">Si la aplicación no necesita la resolución de entidades, deshabilítela.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-210">If entity resolution is not required by your application, then disable it.</span></span> </p>|

### <a name="example"></a><span data-ttu-id="dbcc0-211">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-211">Example</span></span>
<span data-ttu-id="dbcc0-212">Para el código de .NET Framework, puede usar los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-212">For .NET Framework code, you can use the following approaches:</span></span>

```C#
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true;

XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);

// for .NET 4
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="dbcc0-213">Tenga en cuenta que el valor predeterminado de `ProhibitDtd` en `XmlReaderSettings` es true, pero en `XmlTextReader` es false.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-213">Note that the default value of `ProhibitDtd` in `XmlReaderSettings` is true, but in `XmlTextReader` it is false.</span></span> <span data-ttu-id="dbcc0-214">Si usa XmlReaderSettings, no es necesario establecer ProhibitDtd en true de forma explícita, pero se recomienda por seguridad.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-214">If you are using XmlReaderSettings, you do not need to set ProhibitDtd to true explicitly, but it is recommended for safety sake that you do.</span></span> <span data-ttu-id="dbcc0-215">Tenga en cuenta que la clase XmlDocument permite la resolución de entidades de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-215">Also note that the XmlDocument class allows entity resolution by default.</span></span> 

### <a name="example"></a><span data-ttu-id="dbcc0-216">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-216">Example</span></span>
<span data-ttu-id="dbcc0-217">Para deshabilitar la resolución de entidades para XmlDocuments, use la sobrecarga `XmlDocument.Load(XmlReader)` del método Load y establezca las propiedades adecuadas en el argumento XmlReader para deshabilitar la resolución, como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-217">To disable entity resolution for XmlDocuments, use the `XmlDocument.Load(XmlReader)` overload of the Load method and set the appropriate properties in the XmlReader argument to disable resolution, as illustrated in the following code:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);
XmlDocument doc = new XmlDocument();
doc.Load(reader);
```

### <a name="example"></a><span data-ttu-id="dbcc0-218">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-218">Example</span></span>
<span data-ttu-id="dbcc0-219">Si no es posible deshabilitar la resolución de entidades para su aplicación, establezca la propiedad XmlReaderSettings.MaxCharactersFromEntities en un valor razonable según las necesidades de su aplicación.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-219">If disabling entity resolution is not possible for your application, set the XmlReaderSettings.MaxCharactersFromEntities property to a reasonable value according to your application's needs.</span></span> <span data-ttu-id="dbcc0-220">Esto limitará el impacto de posibles ataques DoS de expansión exponencial.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-220">This will limit the impact of potential exponential expansion DoS attacks.</span></span> <span data-ttu-id="dbcc0-221">En el código siguiente se muestra un ejemplo de este enfoque:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-221">The following code provides an example of this approach:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
XmlReader reader = XmlReader.Create(stream, settings);
```

### <a name="example"></a><span data-ttu-id="dbcc0-222">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-222">Example</span></span>
<span data-ttu-id="dbcc0-223">Si tiene que resolver entidades en línea pero no necesita resolver externas, establezca la propiedad XmlReaderSettings.XmlResolver en null.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-223">If you need to resolve inline entities but do not need to resolve external entities, set the XmlReaderSettings.XmlResolver property to null.</span></span> <span data-ttu-id="dbcc0-224">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-224">For example:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
settings.XmlResolver = null;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="dbcc0-225">Tenga en cuenta que en MSXML6, ProhibitDTD está establecido en true (deshabilitar el procesamiento de DTD) de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-225">Note that in MSXML6, ProhibitDTD is set to true (disabling DTD processing) by default.</span></span> <span data-ttu-id="dbcc0-226">Para el código de Apple OSX e iOS, puede usar uno de estos dos analizadores XML: NSXMLParser y libXML2.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-226">For Apple OSX/iOS code, there are two XML parsers you can use: NSXMLParser and libXML2.</span></span> 

## <span data-ttu-id="dbcc0-227"><a id="app-verification"></a>Las aplicaciones que usan http.sys realizan la comprobación de canonización de URL</span><span class="sxs-lookup"><span data-stu-id="dbcc0-227"><a id="app-verification"></a>Applications utilizing http.sys perform URL canonicalization verification</span></span>

| <span data-ttu-id="dbcc0-228">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-228">Title</span></span>                   | <span data-ttu-id="dbcc0-229">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-229">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-230">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-230">**Component**</span></span>               | <span data-ttu-id="dbcc0-231">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-231">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-232">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-232">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-233">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-233">Build</span></span> |  
| <span data-ttu-id="dbcc0-234">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-234">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-235">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-235">Generic</span></span> |
| <span data-ttu-id="dbcc0-236">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-236">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-237">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-237">N/A</span></span>  |
| <span data-ttu-id="dbcc0-238">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-238">**References**</span></span>              | <span data-ttu-id="dbcc0-239">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-239">N/A</span></span>  |
| <span data-ttu-id="dbcc0-240">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-240">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-241">Cualquier aplicación que use http.sys debe seguir estas instrucciones:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-241">Any application that uses http.sys should follow these guidelines:</span></span></p><ul><li><span data-ttu-id="dbcc0-242">Limite la longitud de la dirección URL a no más de 16 384 caracteres (ASCII o Unicode).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-242">Limit the URL length to no more than 16,384 characters (ASCII or Unicode).</span></span> <span data-ttu-id="dbcc0-243">Se trata de la longitud máxima absoluta para una dirección URL según la configuración predeterminada de Internet Information Services (IIS) 6.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-243">This is the absolute maximum URL length based on the default Internet Information Services (IIS) 6 setting.</span></span> <span data-ttu-id="dbcc0-244">Se debe procurar que los sitios web usen direcciones URL más cortas, de ser posible.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-244">Websites should strive for a length shorter than this if possible</span></span></li><li><span data-ttu-id="dbcc0-245">Utilice las clases de E/S de archivos estándar de .NET Framework (por ejemplo, FileStream), ya que aprovecharán las reglas de canonización en .NET FX.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-245">Use the standard .NET Framework file I/O classes (such as FileStream) as these will take advantage of the canonicalization rules in the .NET FX</span></span></li><li><span data-ttu-id="dbcc0-246">Cree explícitamente una lista de nombres de archivo conocidos permitidos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-246">Explicitly build an allow-list of known filenames</span></span></li><li><span data-ttu-id="dbcc0-247">Rechace de forma explícita los tipos de archivo conocidos a los que no servirá rechazos de UrlScan: archivos exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, ini, pol, dat y de impresora.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-247">Explicitly reject known filetypes you will not serve UrlScan rejects: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat files</span></span></li><li><span data-ttu-id="dbcc0-248">Detecte las siguientes excepciones:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-248">Catch the following exceptions:</span></span><ul><li><span data-ttu-id="dbcc0-249">System.ArgumentException (para nombres de dispositivo)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-249">System.ArgumentException (for device names)</span></span></li><li><span data-ttu-id="dbcc0-250">System.NotSupportedException (para flujos de datos)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-250">System.NotSupportedException (for data streams)</span></span></li><li><span data-ttu-id="dbcc0-251">System.IO.FileNotFoundException (para nombres de archivo con escape no válidos)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-251">System.IO.FileNotFoundException (for invalid escaped filenames)</span></span></li><li><span data-ttu-id="dbcc0-252">System.IO.DirectoryNotFoundException (para directorios con escape no válidos)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-252">System.IO.DirectoryNotFoundException (for invalid escaped dirs)</span></span></li></ul></li><li><span data-ttu-id="dbcc0-253">*No* llame a las API de E/S de archivos Win32.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-253">*Do not* call out to Win32 file I/O APIs.</span></span> <span data-ttu-id="dbcc0-254">En una dirección URL no válida, devuelva un error 400 correctamente al usuario y registre el error real.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-254">On an invalid URL gracefully return a 400 error to the user, and log the real error.</span></span></li></ul>|

## <span data-ttu-id="dbcc0-255"><a id="controls-users"></a>Asegúrese de que los controles adecuados estén en vigor al aceptar archivos de usuarios</span><span class="sxs-lookup"><span data-stu-id="dbcc0-255"><a id="controls-users"></a>Ensure appropriate controls are in place when accepting files from users</span></span>

| <span data-ttu-id="dbcc0-256">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-256">Title</span></span>                   | <span data-ttu-id="dbcc0-257">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-257">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-258">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-258">**Component**</span></span>               | <span data-ttu-id="dbcc0-259">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-259">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-260">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-260">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-261">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-261">Build</span></span> |  
| <span data-ttu-id="dbcc0-262">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-262">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-263">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-263">Generic</span></span> |
| <span data-ttu-id="dbcc0-264">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-264">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-265">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-265">N/A</span></span>  |
| <span data-ttu-id="dbcc0-266">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-266">**References**</span></span>              | <span data-ttu-id="dbcc0-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload) (Carga de archivos sin restricciones), [File Signature Table](http://www.garykessler.net/library/file_sigs.html) (Tabla de firmas de archivo)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table](http://www.garykessler.net/library/file_sigs.html)</span></span> |
| <span data-ttu-id="dbcc0-268">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-268">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-269">Los archivos cargados presentan un riesgo notable para las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-269">Uploaded files represent a significant risk to applications.</span></span></p><p><span data-ttu-id="dbcc0-270">El primer paso en muchos ataques consiste en incluir código en el sistema que va a sufrir el ataque.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-270">The first step in many attacks is to get some code to the system to be attacked.</span></span> <span data-ttu-id="dbcc0-271">Después, el ataque solo necesita encontrar una manera de que se ejecute el código.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-271">Then the attack only needs to find a way to get the code executed.</span></span> <span data-ttu-id="dbcc0-272">El uso de la carga de archivos ayuda al atacante a llevar a cabo el primer paso.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-272">Using a file upload helps the attacker accomplish the first step.</span></span> <span data-ttu-id="dbcc0-273">Las consecuencias de la carga de archivos sin restricciones varían, desde la toma de control de todo el sistema, la sobrecarga del sistema de archivos o la base de datos, o el reenvío de ataques a sistemas back-end hasta una simple alteración.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-273">The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, and simple defacement.</span></span></p><p><span data-ttu-id="dbcc0-274">Depende de lo que haga la aplicación con el archivo cargado y especialmente de dónde se almacene.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-274">It depends on what the application does with the uploaded file and especially where it is stored.</span></span> <span data-ttu-id="dbcc0-275">Falta la validación del lado servidor para las cargas de archivos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-275">Server side validation of file uploads is missing.</span></span> <span data-ttu-id="dbcc0-276">Se deberían implementar los siguientes controles de seguridad para la funcionalidad de carga de archivos:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-276">Following security controls should be implemented for File Upload functionality:</span></span></p><ul><li><span data-ttu-id="dbcc0-277">Comprobación de la extensión del archivo (solo se debe aceptar un conjunto válido de tipos de archivo permitidos)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-277">File Extension check (only a valid set of allowed file type should be accepted)</span></span></li><li><span data-ttu-id="dbcc0-278">Límite máximo de tamaño de archivo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-278">Maximum file size limit</span></span></li><li><span data-ttu-id="dbcc0-279">No se debe cargar el archivo a webroot; la ubicación debe ser un directorio en una unidad que no sea del sistema.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-279">File should not be uploaded to webroot; the location should be a directory on non-system drive</span></span></li><li><span data-ttu-id="dbcc0-280">Se debe seguir la convención de nomenclatura, por ejemplo, que el nombre del archivo cargado contenga elementos aleatorios, para evitar que se sobrescriban archivos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-280">Naming convention should be followed, such that the uploaded file name have some randomness, so as to prevent file overwrites</span></span></li><li><span data-ttu-id="dbcc0-281">Se deben examinar los archivos en busca de virus antes de escribirlos en el disco.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-281">Files should be scanned for anti-virus before writing to the disk</span></span></li><li><span data-ttu-id="dbcc0-282">Asegúrese de que el nombre de archivo y cualquier otro metadato (como la ruta de acceso del archivo) se validen en busca de caracteres malintencionados.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-282">Ensure that the file name and any other metadata (e.g., file path) are validated for malicious characters</span></span></li><li><span data-ttu-id="dbcc0-283">Se debe comprobar la firma de formato del archivo para evitar que un usuario cargue un archivo enmascarado (por ejemplo, un archivo exe cuya extensión se haya cambiado a txt).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-283">File format signature should be checked, to prevent a user from uploading a masqueraded file (e.g., uploading an exe file by changing extension to txt)</span></span></li></ul>| 

### <a name="example"></a><span data-ttu-id="dbcc0-284">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-284">Example</span></span>
<span data-ttu-id="dbcc0-285">En lo que respecta al último punto sobre la validación de la firma de formato del archivo, consulte más detalles en la clase que sigue:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-285">For the last point regarding file format signature validation, refer to the class below for details:</span></span> 

```C#
        private static Dictionary<string, List<byte[]>> fileSignature = new Dictionary<string, List<byte[]>>
                    {
                    { ".DOC", new List<byte[]> { new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 } } },
                    { ".DOCX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".PDF", new List<byte[]> { new byte[] { 0x25, 0x50, 0x44, 0x46 } } },
                    { ".ZIP", new List<byte[]> 
                                            {
                                              new byte[] { 0x50, 0x4B, 0x03, 0x04 },
                                              new byte[] { 0x50, 0x4B, 0x4C, 0x49, 0x54, 0x55 },
                                              new byte[] { 0x50, 0x4B, 0x53, 0x70, 0x58 },
                                              new byte[] { 0x50, 0x4B, 0x05, 0x06 },
                                              new byte[] { 0x50, 0x4B, 0x07, 0x08 },
                                              new byte[] { 0x57, 0x69, 0x6E, 0x5A, 0x69, 0x70 }
                                                }
                                            },
                    { ".PNG", new List<byte[]> { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A } } },
                    { ".JPG", new List<byte[]>
                                    {
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE1 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE8 }
                                    }
                                    },
                    { ".JPEG", new List<byte[]>
                                        { 
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE2 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE3 }
                                        }
                                        },
                    { ".XLS", new List<byte[]>
                                            {
                                              new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 },
                                              new byte[] { 0x09, 0x08, 0x10, 0x00, 0x00, 0x06, 0x05, 0x00 },
                                              new byte[] { 0xFD, 0xFF, 0xFF, 0xFF }
                                            }
                                            },
                    { ".XLSX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".GIF", new List<byte[]> { new byte[] { 0x47, 0x49, 0x46, 0x38 } } }
                };

        public static bool IsValidFileExtension(string fileName, byte[] fileData, byte[] allowedChars)
        {
            if (string.IsNullOrEmpty(fileName) || fileData == null || fileData.Length == 0)
            {
                return false;
            }

            bool flag = false;
            string ext = Path.GetExtension(fileName);
            if (string.IsNullOrEmpty(ext))
            {
                return false;
            }

            ext = ext.ToUpperInvariant();

            if (ext.Equals(".TXT") || ext.Equals(".CSV") || ext.Equals(".PRN"))
            {
                foreach (byte b in fileData)
                {
                    if (b > 0x7F)
                    {
                        if (allowedChars != null)
                        {
                            if (!allowedChars.Contains(b))
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }

                return true;
            }

            if (!fileSignature.ContainsKey(ext))
            {
                return true;
            }

            List<byte[]> sig = fileSignature[ext];
            foreach (byte[] b in sig)
            {
                var curFileSig = new byte[b.Length];
                Array.Copy(fileData, curFileSig, b.Length);
                if (curFileSig.SequenceEqual(b))
                {
                    flag = true;
                    break;
                }
            }

            return flag;
        }
```

## <span data-ttu-id="dbcc0-286"><a id="typesafe"></a>Asegúrese de que se usen parámetros con seguridad de tipos en la aplicación web para el acceso a datos</span><span class="sxs-lookup"><span data-stu-id="dbcc0-286"><a id="typesafe"></a>Ensure that type-safe parameters are used in Web Application for data access</span></span>

| <span data-ttu-id="dbcc0-287">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-287">Title</span></span>                   | <span data-ttu-id="dbcc0-288">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-288">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-289">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-289">**Component**</span></span>               | <span data-ttu-id="dbcc0-290">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-290">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-291">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-291">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-292">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-292">Build</span></span> |  
| <span data-ttu-id="dbcc0-293">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-293">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-294">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-294">Generic</span></span> |
| <span data-ttu-id="dbcc0-295">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-295">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-296">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-296">N/A</span></span>  |
| <span data-ttu-id="dbcc0-297">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-297">**References**</span></span>              | <span data-ttu-id="dbcc0-298">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-298">N/A</span></span>  |
| <span data-ttu-id="dbcc0-299">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-299">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-300">Si usa la colección de parámetros, SQL trata la entrada como valor literal en lugar de como código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-300">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="dbcc0-301">La colección de parámetros se puede usar para aplicar restricciones de tipo y longitud a los datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-301">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="dbcc0-302">Los valores fuera del intervalo desencadenan una excepción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-302">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="dbcc0-303">Si no se usan parámetros SQL con seguridad de tipos, los atacantes podrían ejecutar ataques por inyección que se insertan en la entrada sin filtrar.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-303">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="dbcc0-304">Use parámetros con seguridad de tipos al construir consultas SQL para evitar posibles ataques por inyección de código SQL que pueden producirse con la entrada sin filtrar.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-304">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="dbcc0-305">Puede usar parámetros con seguridad de tipos con procedimientos almacenados e instrucciones SQL dinámicas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-305">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="dbcc0-306">Los parámetros se tratan como valores literales en la base de datos y no como código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-306">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="dbcc0-307">También se comprueban el tipo y la longitud de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-307">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="dbcc0-308">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-308">Example</span></span> 
<span data-ttu-id="dbcc0-309">En el código siguiente, se muestra cómo usar parámetros con seguridad de tipos con SqlParameterCollection al llamar a un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-309">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="dbcc0-310">En el ejemplo de código anterior, el valor de entrada no puede tener más de 11 caracteres.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-310">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="dbcc0-311">Si los datos no se ajustan al tipo o la longitud definidos en el parámetro, la clase SqlParameter produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-311">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="dbcc0-312"><a id="binding-mvc"></a>Use clases de enlace de modelos distintas o listas de filtros de enlace para evitar la vulnerabilidad de asignación masiva de MVC</span><span class="sxs-lookup"><span data-stu-id="dbcc0-312"><a id="binding-mvc"></a>Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>

| <span data-ttu-id="dbcc0-313">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-313">Title</span></span>                   | <span data-ttu-id="dbcc0-314">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-314">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-315">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-315">**Component**</span></span>               | <span data-ttu-id="dbcc0-316">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-316">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-317">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-317">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-318">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-318">Build</span></span> |  
| <span data-ttu-id="dbcc0-319">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-319">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-320">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-320">MVC5, MVC6</span></span> |
| <span data-ttu-id="dbcc0-321">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-321">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-322">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-322">N/A</span></span>  |
| <span data-ttu-id="dbcc0-323">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-323">**References**</span></span>              | <span data-ttu-id="dbcc0-324">[Atributos de metadatos](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation) (Vulnerabilidad de seguridad de clave pública y mitigación), [Guía completa para la asignación masiva en ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Introducción a EF mediante MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-324">[Metadata Attributes](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide to Mass Assignment in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span></span> |
| <span data-ttu-id="dbcc0-325">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-325">**Steps**</span></span> | <ul><li><span data-ttu-id="dbcc0-326">**¿Cuándo debería buscar vulnerabilidades por publicación excesiva?** Las vulnerabilidades por publicación excesiva se pueden producir en cualquier lugar donde se enlacen clases de modelo desde la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-326">**When should I look for over-posting vulnerabilities? -** Over-posting vulnerabilities can occur any place you bind model classes from user input.</span></span> <span data-ttu-id="dbcc0-327">Los marcos de trabajo como MVC pueden representar datos de usuario en clases .NET personalizadas, incluidos los objetos CLR estándar (POCO).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-327">Frameworks like MVC can represent user data in custom .NET classes, including Plain Old CLR Objects (POCOs).</span></span> <span data-ttu-id="dbcc0-328">MVC rellena automáticamente estas clases de modelo con datos de la solicitud y proporciona una representación cómoda para tratar la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-328">MVC automatically populates these model classes with data from the request, providing a convenient representation for dealing with user input.</span></span> <span data-ttu-id="dbcc0-329">Cuando estas clases incluyen propiedades que el usuario no debería establecer, la aplicación puede ser vulnerable a ataques por publicación excesiva, que permiten que el usuario controle datos que la aplicación no pretendía que controlara.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-329">When these classes include properties that should not be set by the user, the application can be vulnerable to over-posting attacks, which allow user control of data that the application never intended.</span></span> <span data-ttu-id="dbcc0-330">Al igual que el enlace de modelos de MVC, las tecnologías de acceso a bases de datos, como los asignadores de objetos/relacionales (por ejemplo, Entity Framework), a menudo también admiten el uso de objetos POCO para representar datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-330">Like MVC model binding, database access technologies such as object/relational mappers like Entity Framework often also support using POCO objects to represent database data.</span></span> <span data-ttu-id="dbcc0-331">Estas clases del modelo de datos proporcionan la misma comodidad al tratar con datos de la base de datos que MVC al tratar la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-331">These data model classes provide the same convenience in dealing with database data as MVC does in dealing with user input.</span></span> <span data-ttu-id="dbcc0-332">Ya que MVC y la base de datos admiten modelos similares, como los objetos POCO, parece sencillo reutilizar las mismas clases para ambos fines.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-332">Because both MVC and the database support similar models, like POCO objects, it seems easy to reuse the same classes for both purposes.</span></span> <span data-ttu-id="dbcc0-333">Esta práctica no respeta la separación de aspectos y es un área habitual en la que se exponen propiedades imprevistas al enlace de modelos, lo que hace posibles los ataques por publicación excesiva.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-333">This practice fails to preserve separation of concerns, and it is one common area where unintended properties are exposed to model binding, enabling over-posting attacks.</span></span></li><li><span data-ttu-id="dbcc0-334">**¿Por qué no debo usar mis clases de modelo de base de datos sin filtrar como parámetros para acciones de MVC?** Porque el enlace de modelos de MVC enlazará cualquier elemento de esa clase.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-334">**Why shouldn't I use my unfiltered database model classes as parameters to my MVC actions? -** Because MVC model binding will bind anything in that class.</span></span> <span data-ttu-id="dbcc0-335">Incluso si los datos no aparecen en la vista, un usuario malintencionado puede enviar una solicitud HTTP con estos datos incluidos y MVC la enlazará sin reparos, porque la acción indica que la clase de base de datos tiene la forma de datos que debería aceptar para la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-335">Even if the data does not appear in your view, a malicious user can send an HTTP request with this data included, and MVC will gladly bind it because your action says that database class is the shape of data it should accept for user input.</span></span></li><li><span data-ttu-id="dbcc0-336">**¿Por qué debo preocuparme por la forma usada para el enlace de modelos?** El uso del enlace de modelos de ASP.NET MVC con modelos demasiado amplios expone a la aplicación a ataques por publicación excesiva.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-336">**Why should I care about the shape used for model binding? -** Using ASP.NET MVC model binding with overly broad models exposes an application to over-posting attacks.</span></span> <span data-ttu-id="dbcc0-337">La publicación excesiva podría permitir que los atacantes cambiaran los datos de la aplicación más allá de lo previsto por el desarrollador, por ejemplo, invalidar el precio de un artículo o los privilegios de seguridad de una cuenta.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-337">Over-posting could enable attackers to change application data beyond what the developer intended, such as overriding the price for an item or the security privileges for an account.</span></span> <span data-ttu-id="dbcc0-338">Las aplicaciones deben utilizar modelos de enlace específicos de la acción (o listas de filtros de propiedad permitidos específicos) para proporcionar un contrato explícito sobre la entrada no de confianza que se permitirá mediante el enlace de modelos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-338">Applications should use action-specific binding models (or specific allowed property filter lists) to provide an explicit contract for what untrusted input to allow via model binding.</span></span></li><li><span data-ttu-id="dbcc0-339">**¿Tener modelos de enlace independientes sirve solo para duplicar el código?** No, es cuestión de separar los aspectos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-339">**Is having separate binding models just duplicating code? -** No, it is a matter of separation of concerns.</span></span> <span data-ttu-id="dbcc0-340">Si reutiliza modelos de base de datos en los métodos de acción, lo que indica es que el usuario puede establecer cualquier propiedad (o subpropiedad) de esa clase en una solicitud HTTP.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-340">If you reuse database models in action methods, you are saying any property (or sub-property) in that class can be set by the user in an HTTP request.</span></span> <span data-ttu-id="dbcc0-341">Si no desea que MVC haga esto, necesita una lista de filtros o una forma de clase diferente para mostrar a MVC qué datos pueden proceder de la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-341">If that is not what you want MVC to do, you need a filter list or a separate class shape to show MVC what data can come from user input instead.</span></span></li><li><span data-ttu-id="dbcc0-342">**Si dispongo de modelos de enlace independientes para la entrada del usuario, ¿tengo que duplicar todos los atributos de anotación de datos?** No necesariamente.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-342">**If I have separate binding models for user input, do I have to duplicate all my data annotation attributes? -** Not necessarily.</span></span> <span data-ttu-id="dbcc0-343">Puede usar MetadataTypeAttribute en la clase de modelo de base de datos para vincular a los metadatos en una clase de enlace de modelos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-343">You can use MetadataTypeAttribute on the database model class to link to the metadata on a model binding class.</span></span> <span data-ttu-id="dbcc0-344">Tenga en cuenta que el tipo al que hace referencia MetadataTypeAttribute debe ser un subconjunto del tipo de referencia (puede tener menos propiedades, pero no más).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-344">Just note that the type referenced by the MetadataTypeAttribute must be a subset of the referencing type (it can have fewer properties, but not more).</span></span></li><li><span data-ttu-id="dbcc0-345">**Mover los datos entre los modelos de entrada de usuario y los modelos de base de datos es una tarea tediosa. ¿Puedo simplemente copiar todas las propiedades mediante reflexión?** Sí.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-345">**Moving data back and forth between user input models and database models is tedious. Can I just copy over all properties using reflection? -** Yes.</span></span> <span data-ttu-id="dbcc0-346">Las únicas propiedades que aparecen en los modelos de enlace son las que haya determinado que son seguras para la entrada de usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-346">The only properties that appear in the binding models are the ones you have determined to be safe for user input.</span></span> <span data-ttu-id="dbcc0-347">No existe ninguna razón de seguridad que impida usar la reflexión para copiar todas las propiedades en común entre estos dos modelos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-347">There is no security reason that prevents using reflection to copy over all properties that exist in common between these two models.</span></span></li><li><span data-ttu-id="dbcc0-348">**¿Y [Bind(Exclude ="â€¦")]? ¿Lo puedo usar en lugar de tener modelos de enlace independientes?** No se recomienda este enfoque.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-348">**What about [Bind(Exclude ="â€¦")]. Can I use that instead of having separate binding models? -** This approach is not recommended.</span></span> <span data-ttu-id="dbcc0-349">Si se usa [Bind(Exclude ="â€¦")], quiere decir que cualquier propiedad nueva se puede enlazar de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-349">Using [Bind(Exclude ="â€¦")] means that any new property is bindable by default.</span></span> <span data-ttu-id="dbcc0-350">Cuando se agrega una nueva propiedad, hay que recordar un paso adicional para mantener la seguridad, es decir, el diseño no es seguro de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-350">When a new property is added, there is an extra step to remember to keep things secure, rather than having the design be secure by default.</span></span> <span data-ttu-id="dbcc0-351">Confiar en que el desarrollador compruebe esta lista cada vez que se agregue una propiedad es arriesgado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-351">Depending on the developer checking this list every time a property is added is risky.</span></span></li><li><span data-ttu-id="dbcc0-352">**¿Es [Bind(Include ="â€¦")] útil para las operaciones de edición?** No.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-352">**Is [Bind(Include ="â€¦")] useful for Edit operations? -** No.</span></span> <span data-ttu-id="dbcc0-353">[Bind(Include ="â€¦")] solo vale para las operaciones de estilo INSERT (agregar datos nuevos).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-353">[Bind(Include ="â€¦")] is only suitable for INSERT-style operations (adding new data).</span></span> <span data-ttu-id="dbcc0-354">Para las operaciones de estilo UPDATE (modificar datos existentes), se usa otro enfoque, como tener modelos de enlace independientes o pasar una lista explícita de propiedades permitidas a UpdateModel o TryUpdateModel.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-354">For UPDATE-style operations (revising existing data), use another approach, like having separate binding models or passing an explicit list of allowed properties to UpdateModel or TryUpdateModel.</span></span> <span data-ttu-id="dbcc0-355">Agregar un atributo [Bind(Include ="â€¦")] en una operación de edición significa que MVC creará una instancia de objeto y establecerá solo las propiedades explicitadas, es decir, dejará todas las demás con sus valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-355">Adding a [Bind(Include ="â€¦")] attribute on an Edit operation means that MVC will create an object instance and set only the listed properties, leaving all others at their default values.</span></span> <span data-ttu-id="dbcc0-356">Cuando los datos sean persistentes, reemplazarán por completo la entidad existente y restablecerán los valores predeterminados de las propiedades omitidas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-356">When the data is persisted, it will entirely replace the existing entity, resetting the values for any omitted properties to their defaults.</span></span> <span data-ttu-id="dbcc0-357">Por ejemplo, si se omitió IsAdmin de un atributo [Bind(Include ="â€¦")] en una operación de edición, cualquier usuario cuyo nombre se editara mediante esta acción se restablecería a IsAdmin = false (cualquier usuario editado perdería el estado de administrador).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-357">For example, if IsAdmin was omitted from a [Bind(Include ="â€¦")] attribute on an Edit operation, any user whose name was edited via this action would be reset to IsAdmin = false (any edited user would lose administrator status).</span></span> <span data-ttu-id="dbcc0-358">Si desea evitar que se actualicen determinadas propiedades, use uno de los otros enfoques anteriores.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-358">If you want to prevent updates to certain properties, use one of the other approaches above.</span></span> <span data-ttu-id="dbcc0-359">Tenga en cuenta que algunas versiones de las herramientas de MVC generan clases de controlador con [Bind(Include ="â€¦")] en acciones de edición e indican que la eliminación de una propiedad de esa lista impedirá los ataques por publicación excesiva.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-359">Note that some versions of MVC tooling generate controller classes with [Bind(Include ="â€¦")] on Edit actions and imply that removing a property from that list will prevent over-posting attacks.</span></span> <span data-ttu-id="dbcc0-360">Sin embargo, como se ha descrito antes, ese enfoque no funciona según lo previsto y, en su lugar, restablecerá los valores predeterminados de los datos en las propiedades omitidas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-360">However, as described above, that approach does not work as intended and instead will reset any data in the omitted properties to their default values.</span></span></li><li><span data-ttu-id="dbcc0-361">**Para las operaciones Create, ¿hay alguna advertencia sobre el uso de [Bind(Include ="â€¦")] en lugar de modelos de enlace independientes? -** Sí.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-361">**For Create operations, are there any caveats using [Bind(Include ="â€¦")] rather than separate binding models? -** Yes.</span></span> <span data-ttu-id="dbcc0-362">En primer lugar, este enfoque no funciona para los escenarios de edición, por lo que es necesario mantener dos enfoques independientes para mitigar todas las vulnerabilidades por publicación excesiva.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-362">First this approach does not work for Edit scenarios, requiring maintaining two separate approaches for mitigating all over-posting vulnerabilities.</span></span> <span data-ttu-id="dbcc0-363">En segundo lugar, los modelos de enlace independientes imponen la separación de aspectos entre la forma usada para la entrada de usuario y la usada para la persistencia, algo que [Bind(Include ="â€¦")] no hace.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-363">Second, separate binding models enforce separation of concerns between the shape used for user input and the shape used for persistence, something [Bind(Include ="â€¦")] does not do.</span></span> <span data-ttu-id="dbcc0-364">En tercer lugar, tenga en cuenta que [Bind(Include ="â€¦")] solo puede controlar propiedades de nivel superior; no puede permitir únicamente partes de subpropiedades (por ejemplo, "Details.Name") en el atributo.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-364">Third, note that [Bind(Include ="â€¦")] can only handle top-level properties; you cannot allow only portions of sub-properties (such as "Details.Name") in the attribute.</span></span> <span data-ttu-id="dbcc0-365">Por último, el punto que quizás sea el más importante: cuando se usa [Bind(Include ="â€¦")], se debe recordar un paso adicional siempre que se use la clase para el enlace de modelos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-365">Finally, and perhaps most importantly, using [Bind(Include ="â€¦")] adds an extra step that must be remembered any time the class is used for model binding.</span></span> <span data-ttu-id="dbcc0-366">Si un nuevo método de acción enlaza a la clase de datos directamente y se olvida de incluir un atributo [Bind(Include ="â€¦")], puede ser vulnerable a ataques por publicación excesiva, por lo que el enfoque con [Bind(Include ="â€¦")] es algo menos seguro de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-366">If a new action method binds to the data class directly and forgets to include a [Bind(Include ="â€¦")] attribute, it can be vulnerable to over-posting attacks, so the [Bind(Include ="â€¦")] approach is somewhat less secure by default.</span></span> <span data-ttu-id="dbcc0-367">Si usa [Bind(Include ="â€¦")], asegúrese siempre de especificarlo cada vez que las clases de datos aparezcan como parámetros de método de acción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-367">If you use [Bind(Include ="â€¦")], take care always to remember to specify it every time your data classes appear as action method parameters.</span></span></li><li><span data-ttu-id="dbcc0-368">**Para las operaciones Create, ¿qué tal colocar el atributo [Bind(Include ="â€¦")] en la propia clase de modelo? ¿No evita este enfoque la necesidad de acordarse de colocar el atributo en cada método de acción?** Este enfoque funciona en algunos casos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-368">**For Create operations, what about putting the [Bind(Include ="â€¦")] attribute on the model class itself? Does not this approach avoid the need to remember putting the attribute on every action method? -** This approach works in some cases.</span></span> <span data-ttu-id="dbcc0-369">Si se usa [Bind(Include ="â€¦")] en el propio tipo de modelo (en lugar de en parámetros de acción que usen esta clase), sí se evita tener que acordarse de incluir el atributo [Bind(Include ="â€¦")] en cada método de acción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-369">Using [Bind(Include ="â€¦")] on the model type itself (rather than on action parameters using this class), does avoid the need to remember to include the [Bind(Include ="â€¦")] attribute on every action method.</span></span> <span data-ttu-id="dbcc0-370">Efectivamente, al usarse el atributo directamente en la clase, se crea un área expuesta de esta clase distinta para el enlace de modelos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-370">Using the attribute directly on the class effectively creates a separate surface area of this class for model binding purposes.</span></span> <span data-ttu-id="dbcc0-371">Sin embargo, este enfoque solo permite una forma de enlace de modelos por cada clase de modelo.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-371">However, this approach only allows for one model binding shape per model class.</span></span> <span data-ttu-id="dbcc0-372">Si un método de acción necesita permitir el enlace de modelos de un campo (por ejemplo, una acción solo de administrador que actualiza roles de usuario) y otras acciones deben evitar el enlace de modelos de este campo, este enfoque no funcionará.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-372">If one action method needs to allow model binding of a field (for example, an administrator-only action that updates user roles) and other actions need to prevent model binding of this field, this approach will not work.</span></span> <span data-ttu-id="dbcc0-373">Cada clase solo puede tener una forma de enlace de modelos. Si diferentes acciones necesitan distintas formas de enlace de modelos, necesitan representar estas formas independientes mediante clases de enlace de modelos independientes o mediante atributos [Bind(Include ="â€¦")] distintos en los métodos de acción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-373">Each class can only have one model binding shape; if different actions need different model binding shapes, they need to represent these separate shapes using either separate model binding classes or separate [Bind(Include ="â€¦")] attributes on the action methods.</span></span></li><li><span data-ttu-id="dbcc0-374">**¿Qué son los modelos de enlace? ¿Son lo mismo que los modelos de vista?** Se trata de dos conceptos relacionados.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-374">**What are binding models? Are they the same thing as view models? -** These are two related concepts.</span></span> <span data-ttu-id="dbcc0-375">El término modelo de enlace hace referencia a una clase de modelo usada en una lista de parámetros de acción (la forma que se pasa del enlace de modelos de MVC al método de acción).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-375">The term binding model refers to a model class used in an action is parameter list (the shape passed from MVC model binding to the action method).</span></span> <span data-ttu-id="dbcc0-376">El término modelo de vista hace referencia a una clase de modelo que se pasa de un método de acción a una vista.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-376">The term view model refers to a model class passed from an action method to a view.</span></span> <span data-ttu-id="dbcc0-377">El uso de un modelo específico de la vista es un enfoque habitual para pasar datos de un método de acción a una vista.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-377">Using a view-specific model is a common approach for passing data from an action method to a view.</span></span> <span data-ttu-id="dbcc0-378">A menudo, esta forma también es adecuada para el enlace de modelos, y el modelo de vista de términos puede usarse para hacer referencia el mismo modelo que se utiliza en ambos lugares.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-378">Often, this shape is also suitable for model binding, and the term view model can be used to refer the same model used in both places.</span></span> <span data-ttu-id="dbcc0-379">Para ser exactos, este procedimiento se refiere en concreto a los modelos de enlace y se centra en la forma pasada a la acción, que es lo que realmente importa para la asignación masiva.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-379">To be precise, this procedure talks specifically about binding models, focusing on the shape passed to the action, which is what matters for mass assignment purposes.</span></span></li></ul>| 

## <span data-ttu-id="dbcc0-380"><a id="rendering"></a>Codifique la salida web que no sea de confianza antes de representarla</span><span class="sxs-lookup"><span data-stu-id="dbcc0-380"><a id="rendering"></a>Encode untrusted web output prior to rendering</span></span>

| <span data-ttu-id="dbcc0-381">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-381">Title</span></span>                   | <span data-ttu-id="dbcc0-382">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-382">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-383">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-383">**Component**</span></span>               | <span data-ttu-id="dbcc0-384">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-384">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-385">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-385">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-386">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-386">Build</span></span> |  
| <span data-ttu-id="dbcc0-387">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-387">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-388">Genérico, formularios Web Forms, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-388">Generic, Web Forms, MVC5, MVC6</span></span> |
| <span data-ttu-id="dbcc0-389">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-389">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-390">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-390">N/A</span></span>  |
| <span data-ttu-id="dbcc0-391">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-391">**References**</span></span>              | <span data-ttu-id="dbcc0-392">[Cómo evitar scripting entre sitios en ASP.NET﻿](http://msdn.microsoft.com/library/ms998274.aspx), [Scripting entre sitios](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet) (Hoja de referencia para evitar XSS [scripting entre sitios])</span><span class="sxs-lookup"><span data-stu-id="dbcc0-392">[How to prevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span></span> |
| <span data-ttu-id="dbcc0-393">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-393">**Steps**</span></span> | <span data-ttu-id="dbcc0-394">El scripting entre sitios (normalmente abreviado como XSS) es un vector de ataque para servicios en línea o cualquier aplicación o componente que consuma una entrada desde la Web.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-394">Cross-site scripting (commonly abbreviated as XSS) is an attack vector for online services or any application/component that consumes input from the web.</span></span> <span data-ttu-id="dbcc0-395">Las vulnerabilidades de XSS pueden permitir que un atacante ejecute un script en la máquina de otro usuario por medio de una aplicación web vulnerable.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-395">XSS vulnerabilities may allow an attacker to execute script on another user's machine through a vulnerable web application.</span></span> <span data-ttu-id="dbcc0-396">Los scripts malintencionados sirven para robar cookies y alterar de otras formas la máquina de la víctima mediante JavaScript.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-396">Malicious scripts can be used to steal cookies and otherwise tamper with a victim's machine through JavaScript.</span></span> <span data-ttu-id="dbcc0-397">Se impide el XSS mediante la validación de la entrada del usuario para asegurarse de que esté bien formada y codificada antes de representarla en una página web.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-397">XSS is prevented by validating user input, ensuring it is well formed and encoding before it is rendered in a web page.</span></span> <span data-ttu-id="dbcc0-398">La validación de la entrada y la codificación de la salida se pueden realizar con Web Protection Library.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-398">Input validation and output encoding can be done by using Web Protection Library.</span></span> <span data-ttu-id="dbcc0-399">Para el código administrado (C\#, VB.net, etc.), use uno o varios métodos de codificación adecuados de Web Protection (Anti-XSS) Library, según el contexto donde se manifieste la entrada del usuario:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-399">For Managed code (C\#, VB.net, etc.), use one or more appropriate encoding methods from the Web Protection (Anti-XSS) Library, depending on the context where the user input gets manifested:</span></span>| 

### <a name="example"></a><span data-ttu-id="dbcc0-400">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-400">Example</span></span>

```C#
* Encoder.HtmlEncode 
* Encoder.HtmlAttributeEncode 
* Encoder.JavaScriptEncode 
* Encoder.UrlEncode
* Encoder.VisualBasicScriptEncode 
* Encoder.XmlEncode 
* Encoder.XmlAttributeEncode 
* Encoder.CssEncode 
* Encoder.LdapEncode 
```

## <span data-ttu-id="dbcc0-401"><a id="typemodel"></a>Lleve a cabo la validación de entrada y el filtrado para todas las propiedades de modelo de tipo cadena</span><span class="sxs-lookup"><span data-stu-id="dbcc0-401"><a id="typemodel"></a>Perform input validation and filtering on all string type Model properties</span></span>

| <span data-ttu-id="dbcc0-402">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-402">Title</span></span>                   | <span data-ttu-id="dbcc0-403">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-403">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-404">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-404">**Component**</span></span>               | <span data-ttu-id="dbcc0-405">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-405">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-406">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-406">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-407">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-407">Build</span></span> |  
| <span data-ttu-id="dbcc0-408">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-408">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-409">Genérico, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-409">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="dbcc0-410">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-410">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-411">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-411">N/A</span></span>  |
| <span data-ttu-id="dbcc0-412">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-412">**References**</span></span>              | <span data-ttu-id="dbcc0-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation) (Incorporación de validación), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Validación de datos de modelo en una aplicación de MVC), [Principios orientativos para las aplicaciones de ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="dbcc0-414">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-414">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-415">Todos los parámetros de entrada se deben validar antes de usarse en la aplicación para asegurarse de que la aplicación esté protegida ante las entradas de usuarios malintencionados.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-415">All the input parameters must be validated before they are used in the application to ensure that the application is safeguarded against malicious user inputs.</span></span> <span data-ttu-id="dbcc0-416">Compruebe los valores de entrada mediante validaciones con expresiones regulares en el lado servidor con una estrategia de validación con lista de permitidos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-416">Validate the input values using regular expression validations on server side with a whitelist validation strategy.</span></span> <span data-ttu-id="dbcc0-417">La entrada de usuario o los parámetros sin sanear pasados a los métodos pueden ocasionar vulnerabilidades por inyección de código.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-417">Unsanitized user inputs / parameters passed to the methods can cause code injection vulnerabilities.</span></span></p><p><span data-ttu-id="dbcc0-418">Para las aplicaciones web, los puntos de entrada también pueden ser campos de formulario, QueryStrings, cookies, encabezados HTTP y parámetros de servicio web.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-418">For web applications, entry points can also include form fields, QueryStrings, cookies, HTTP headers, and web service parameters.</span></span></p><p><span data-ttu-id="dbcc0-419">Se deben realizar las siguientes comprobaciones de validación de entrada con el enlace de modelos:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-419">The following input validation checks must be performed upon model binding:</span></span></p><ul><li><span data-ttu-id="dbcc0-420">Las propiedades del modelo se deben anotar con la anotación RegularExpression para que acepten los caracteres permitidos y la longitud máxima permitida.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-420">The model properties should be annotated with RegularExpression annotation, for accepting allowed characters and maximum permissible length</span></span></li><li><span data-ttu-id="dbcc0-421">Los métodos de controlador deberían llevar a cabo la comprobación de validez ModelState.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-421">The controller methods should perform ModelState validity</span></span></li></ul>|

## <span data-ttu-id="dbcc0-422"><a id="richtext"></a>Se debería aplicar la comprobación de estado a los campos de formulario que acepten todos los caracteres, por ejemplo, editor de texto enriquecido</span><span class="sxs-lookup"><span data-stu-id="dbcc0-422"><a id="richtext"></a>Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>

| <span data-ttu-id="dbcc0-423">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-423">Title</span></span>                   | <span data-ttu-id="dbcc0-424">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-424">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-425">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-425">**Component**</span></span>               | <span data-ttu-id="dbcc0-426">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-426">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-427">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-427">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-428">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-428">Build</span></span> |  
| <span data-ttu-id="dbcc0-429">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-429">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-430">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-430">Generic</span></span> |
| <span data-ttu-id="dbcc0-431">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-431">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-432">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-432">N/A</span></span>  |
| <span data-ttu-id="dbcc0-433">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-433">**References**</span></span>              | <span data-ttu-id="dbcc0-434">[Codificación de la entrada no segura](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTMLSanitizer](https://github.com/mganss/HtmlSanitizer)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span></span> |
| <span data-ttu-id="dbcc0-435">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-435">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-436">Identifique todas las etiquetas de marcado estático que desea usar.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-436">Identify all static markup tags that you want to use.</span></span> <span data-ttu-id="dbcc0-437">Es habitual restringir el formato a elementos HTML seguros, como `<b>` (negrita) e `<i>` (cursiva).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-437">A common practice is to restrict formatting to safe HTML elements, such as `<b>` (bold) and `<i>` (italic).</span></span></p><p><span data-ttu-id="dbcc0-438">Antes de escribir los datos, codifíquelos en HTML.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-438">Before writing the data, HTML-encode it.</span></span> <span data-ttu-id="dbcc0-439">Esto anula el peligro de cualquier script malintencionado, ya que hace que se traten como texto y no como código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-439">This makes any malicious script safe by causing it to be handled as text, not as executable code.</span></span></p><ol><li><span data-ttu-id="dbcc0-440">Deshabilite la validación de solicitudes ASP.NET agregando el atributo ValidateRequest="false" a la directiva @ Page.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-440">Disable ASP.NET request validation by the adding the ValidateRequest="false" attribute to the @ Page directive</span></span></li><li><span data-ttu-id="dbcc0-441">Codifique la entrada de cadena con el método HtmlEncode.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-441">Encode the string input with the HtmlEncode method</span></span></li><li><span data-ttu-id="dbcc0-442">Use un objeto StringBuilder y llame a su método Replace para quitar de forma selectiva la codificación de los elementos HTML que desea permitir.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-442">Use a StringBuilder and call its Replace method to selectively remove the encoding on the HTML elements that you want to permit</span></span></li></ol><p><span data-ttu-id="dbcc0-443">La página en las referencias deshabilita la validación de solicitudes ASP.NET al establecer `ValidateRequest="false"`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-443">The page-in the references disables ASP.NET request validation by setting `ValidateRequest="false"`.</span></span> <span data-ttu-id="dbcc0-444">Se codifica en HTML la entrada y se permiten de forma selectiva los elementos `<b>` e `<i>`. O bien, también se puede usar una biblioteca .NET para la comprobación de estado de HTML.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-444">It HTML-encodes the input and selectively allows the `<b>` and `<i>` Alternatively, a .NET library for HTML sanitization may also be used.</span></span></p><p><span data-ttu-id="dbcc0-445">HtmlSanitizer es una biblioteca .NET que limpia las construcciones que pueden dar lugar a ataques XSS en fragmentos y documentos HTML.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-445">HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead to XSS attacks.</span></span> <span data-ttu-id="dbcc0-446">Utiliza AngleSharp para analizar, manipular y representar HTML y CSS.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-446">It uses AngleSharp to parse, manipulate, and render HTML and CSS.</span></span> <span data-ttu-id="dbcc0-447">Se puede instalar HtmlSanitizer como paquete NuGet, y se puede pasar la entrada del usuario por los métodos de comprobación de estado de HTML o CSS pertinentes, según corresponda, en el lado servidor.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-447">HtmlSanitizer can be installed as a NuGet package, and the user input can be passed through relevant HTML or CSS sanitization methods, as applicable, on the server side.</span></span> <span data-ttu-id="dbcc0-448">Tenga en cuenta que la comprobación de estado como control de seguridad se debe considerar la última opción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-448">Please note that Sanitization as a security control should be considered only as a last option.</span></span></p><p><span data-ttu-id="dbcc0-449">La validación de entrada y la codificación de salida son los controles de seguridad que se consideran mejores.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-449">Input validation and Output Encoding are considered better security controls.</span></span></p> |

## <span data-ttu-id="dbcc0-450"><a id="inbuilt-encode"></a>No asigne elementos DOM a receptores que carezcan de codificación integrada</span><span class="sxs-lookup"><span data-stu-id="dbcc0-450"><a id="inbuilt-encode"></a>Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>

| <span data-ttu-id="dbcc0-451">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-451">Title</span></span>                   | <span data-ttu-id="dbcc0-452">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-452">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-453">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-453">**Component**</span></span>               | <span data-ttu-id="dbcc0-454">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-454">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-455">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-455">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-456">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-456">Build</span></span> |  
| <span data-ttu-id="dbcc0-457">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-457">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-458">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-458">Generic</span></span> |
| <span data-ttu-id="dbcc0-459">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-459">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-460">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-460">N/A</span></span>  |
| <span data-ttu-id="dbcc0-461">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-461">**References**</span></span>              | <span data-ttu-id="dbcc0-462">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-462">N/A</span></span>  |
| <span data-ttu-id="dbcc0-463">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-463">**Steps**</span></span> | <span data-ttu-id="dbcc0-464">Muchas funciones JavaScript no codifican de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-464">Many javascript functions don't do encoding by default.</span></span> <span data-ttu-id="dbcc0-465">Cuando se asigna una entrada que no sea de confianza a elementos DOM mediante estas funciones, es posible que se produzcan ejecuciones de scripts entre sitios (XSS).</span><span class="sxs-lookup"><span data-stu-id="dbcc0-465">When assigning untrusted input to DOM elements via such functions, may result in cross site script (XSS) executions.</span></span>| 

### <a name="example"></a><span data-ttu-id="dbcc0-466">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-466">Example</span></span>
<span data-ttu-id="dbcc0-467">Los siguientes son ejemplos inseguros:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-467">Following are insecure examples:</span></span> 

```
document.getElementByID("div1").innerHtml = value;
$("#userName").html(res.Name);
return $('<div/>').html(value)
$('body').append(resHTML);   
```
<span data-ttu-id="dbcc0-468">No utilice `innerHtml`; en su lugar, use `innerText`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-468">Don't use `innerHtml`; instead use `innerText`.</span></span> <span data-ttu-id="dbcc0-469">Igualmente, en lugar de `$("#elm").html()`, use `$("#elm").text()`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-469">Similarly, instead of `$("#elm").html()`, use `$("#elm").text()`</span></span> 

## <span data-ttu-id="dbcc0-470"><a id="redirect-safe"></a>Valide que todos los redireccionamientos dentro de la aplicación se cierren o se realicen de forma segura</span><span class="sxs-lookup"><span data-stu-id="dbcc0-470"><a id="redirect-safe"></a>Validate all redirects within the application are closed or done safely</span></span>

| <span data-ttu-id="dbcc0-471">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-471">Title</span></span>                   | <span data-ttu-id="dbcc0-472">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-472">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-473">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-473">**Component**</span></span>               | <span data-ttu-id="dbcc0-474">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-474">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-475">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-475">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-476">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-476">Build</span></span> |  
| <span data-ttu-id="dbcc0-477">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-477">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-478">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-478">Generic</span></span> |
| <span data-ttu-id="dbcc0-479">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-479">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-480">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-480">N/A</span></span>  |
| <span data-ttu-id="dbcc0-481">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-481">**References**</span></span>              | <span data-ttu-id="dbcc0-482">[The OAuth 2.0 Authorization Framework - Open Redirectors](http://tools.ietf.org/html/rfc6749#section-10.15) (Marco de autorización OAuth 2.0: redirectores abiertos)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-482">[The OAuth 2.0 Authorization Framework - Open Redirectors](http://tools.ietf.org/html/rfc6749#section-10.15)</span></span> |
| <span data-ttu-id="dbcc0-483">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-483">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-484">El diseño de aplicaciones que requieren redireccionamiento a una ubicación proporcionada por el usuario debe restringir los destinos de redireccionamiento posibles a una lista predefinida de sitios o dominios "seguros".</span><span class="sxs-lookup"><span data-stu-id="dbcc0-484">Application design requiring redirection to a user-supplied location must constrain the possible redirection targets to a predefined "safe" list of sites or domains.</span></span> <span data-ttu-id="dbcc0-485">Todos los redireccionamientos en la aplicación deben ser cerrados y seguros.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-485">All redirects in the application must be closed/safe.</span></span></p><p><span data-ttu-id="dbcc0-486">Para ello, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-486">To do this:</span></span></p><ul><li><span data-ttu-id="dbcc0-487">Identifique todos los redireccionamientos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-487">Identify all redirects</span></span></li><li><span data-ttu-id="dbcc0-488">Implemente una mitigación adecuada para cada tipo de redireccionamiento.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-488">Implement an appropriate mitigation for each redirect.</span></span> <span data-ttu-id="dbcc0-489">Entre las mitigaciones adecuadas, se incluye la lista de redireccionamientos permitidos o la confirmación del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-489">Appropriate mitigations include redirect whitelist or user confirmation.</span></span> <span data-ttu-id="dbcc0-490">Si un sitio web o servicio con una vulnerabilidad de redireccionamiento abierto usa proveedores de identidades de Facebook, OAuth u OpenID, un atacante puede robar el token de inicio de sesión de un usuario y suplantarle.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-490">If a web site or service with an open redirect vulnerability uses Facebook/OAuth/OpenID identity providers, an attacker can steal a user's logon token and impersonate that user.</span></span> <span data-ttu-id="dbcc0-491">Se trata de un riesgo inherente al uso de OAuth, que se describe en la RFC 6749 sobre el marco de autorización OAuth 2.0, en la sección 10.15 sobre redireccionamientos abiertos. De forma similar, las credenciales de los usuarios pueden correr peligro por ataques de suplantación de identidad (spear-phishing) que usan redireccionamientos abiertos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-491">This is an inherent risk when using OAuth, which is documented in RFC 6749 "The OAuth 2.0 Authorization Framework", Section 10.15 "Open Redirects" Similarly, users' credentials can be compromised by spear phishing attacks using open redirects</span></span></li></ul>|

## <span data-ttu-id="dbcc0-492"><a id="string-method"></a>Implemente la validación de entrada en todos los parámetros de tipo cadena aceptados por métodos de controlador</span><span class="sxs-lookup"><span data-stu-id="dbcc0-492"><a id="string-method"></a>Implement input validation on all string type parameters accepted by Controller methods</span></span>

| <span data-ttu-id="dbcc0-493">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-493">Title</span></span>                   | <span data-ttu-id="dbcc0-494">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-494">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-495">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-495">**Component**</span></span>               | <span data-ttu-id="dbcc0-496">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-496">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-497">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-497">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-498">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-498">Build</span></span> |  
| <span data-ttu-id="dbcc0-499">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-499">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-500">Genérico, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-500">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="dbcc0-501">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-501">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-502">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-502">N/A</span></span>  |
| <span data-ttu-id="dbcc0-503">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-503">**References**</span></span>              | <span data-ttu-id="dbcc0-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Validación de datos de modelo en una aplicación de MVC), [Principios orientativos para las aplicaciones de ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="dbcc0-505">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-505">**Steps**</span></span> | <span data-ttu-id="dbcc0-506">Para los métodos que solo acepten el tipo primitivo de datos como argumento, pero no modelos, se debe realizar la validación de entrada mediante expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-506">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="dbcc0-507">Aquí se debería usar Regex.IsMatch con un patrón de regex válido.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-507">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="dbcc0-508">Si la entrada no coincide con la expresión regular especificada, el control no debería continuar y se debería mostrar una advertencia adecuada con respecto al error de validación.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-508">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>| 

## <span data-ttu-id="dbcc0-509"><a id="dos-expression"></a>Establezca el tiempo de espera del límite superior para el procesamiento de expresiones regulares con el fin de impedir ataques DoS causados por expresiones regulares incorrectas</span><span class="sxs-lookup"><span data-stu-id="dbcc0-509"><a id="dos-expression"></a>Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>

| <span data-ttu-id="dbcc0-510">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-510">Title</span></span>                   | <span data-ttu-id="dbcc0-511">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-511">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-512">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-512">**Component**</span></span>               | <span data-ttu-id="dbcc0-513">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-513">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-514">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-514">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-515">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-515">Build</span></span> |  
| <span data-ttu-id="dbcc0-516">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-516">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-517">Genérico, formularios Web Forms, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-517">Generic, Web Forms, MVC5, MVC6</span></span>  |
| <span data-ttu-id="dbcc0-518">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-518">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-519">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-519">N/A</span></span>  |
| <span data-ttu-id="dbcc0-520">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-520">**References**</span></span>              | [<span data-ttu-id="dbcc0-521">Propiedad DefaultRegexMatchTimeout</span><span class="sxs-lookup"><span data-stu-id="dbcc0-521">DefaultRegexMatchTimeout Property </span></span>](https://msdn.microsoft.com/library/system.web.configuration.httpruntimesection.defaultregexmatchtimeout.aspx) |
| <span data-ttu-id="dbcc0-522">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-522">**Steps**</span></span> | <span data-ttu-id="dbcc0-523">Para evitar los ataques por denegación de servicio contra expresiones regulares creadas incorrectamente, que causan grandes retrocesos, establezca el tiempo de espera predeterminado global.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-523">To ensure denial of service attacks against badly created regular expressions, that cause a lot of backtracking, set the global default timeout.</span></span> <span data-ttu-id="dbcc0-524">Si el tiempo de procesamiento es mayor que el límite superior definido, se produce una excepción de tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-524">If the processing time takes longer than the defined upper limit, it would throw a Timeout exception.</span></span> <span data-ttu-id="dbcc0-525">Si no se configura nada, el tiempo de espera sería infinito.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-525">If nothing is configured, the timeout would be infinite.</span></span>| 

### <a name="example"></a><span data-ttu-id="dbcc0-526">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-526">Example</span></span>
<span data-ttu-id="dbcc0-527">Por ejemplo, la siguiente configuración produce una excepción RegexMatchTimeoutException si el procesamiento excede los 5 segundos:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-527">For example, the following configuration will throw a RegexMatchTimeoutException, if the processing takes more than 5 seconds:</span></span> 

```C#
<httpRuntime targetFramework="4.5" defaultRegexMatchTimeout="00:00:05" />
```

## <span data-ttu-id="dbcc0-528"><a id="html-razor"></a>No use Html.Raw en las vistas Razor</span><span class="sxs-lookup"><span data-stu-id="dbcc0-528"><a id="html-razor"></a>Avoid using Html.Raw in Razor views</span></span>

| <span data-ttu-id="dbcc0-529">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-529">Title</span></span>                   | <span data-ttu-id="dbcc0-530">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-530">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-531">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-531">**Component**</span></span>               | <span data-ttu-id="dbcc0-532">Aplicación web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-532">Web Application</span></span> | 
| <span data-ttu-id="dbcc0-533">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-533">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-534">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-534">Build</span></span> |  
| <span data-ttu-id="dbcc0-535">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-535">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-536">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-536">MVC5, MVC6</span></span> |
| <span data-ttu-id="dbcc0-537">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-537">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-538">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-538">N/A</span></span>  |
| <span data-ttu-id="dbcc0-539">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-539">**References**</span></span>              | <span data-ttu-id="dbcc0-540">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-540">N/A</span></span>  |
| <span data-ttu-id="dbcc0-541">Paso</span><span class="sxs-lookup"><span data-stu-id="dbcc0-541">Step</span></span> | <span data-ttu-id="dbcc0-542">Las páginas Web ASP.Net (Razor) realizan la codificación de HTML automáticamente.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-542">ASP.Net WebPages (Razor) perform automatic HTML encoding.</span></span> <span data-ttu-id="dbcc0-543">Todas las cadenas impresas por fragmentos de código insertados (bloques @) se codifican en HTML de forma automática.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-543">All strings printed by embedded code nuggets (@ blocks) are automatically HTML-encoded.</span></span> <span data-ttu-id="dbcc0-544">Sin embargo, cuando se invoca el método `HtmlHelper.Raw`, devuelve marcado que no está codificado en HTML.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-544">However, when `HtmlHelper.Raw` Method is invoked, it returns markup that is not HTML encoded.</span></span> <span data-ttu-id="dbcc0-545">Si se utiliza el método auxiliar `Html.Raw()`, omite la protección de codificación automática que proporciona Razor.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-545">If `Html.Raw()` helper method is used, it bypasses the automatic encoding protection that Razor provides.</span></span>|

### <a name="example"></a><span data-ttu-id="dbcc0-546">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-546">Example</span></span>
<span data-ttu-id="dbcc0-547">El siguiente ejemplo es inseguro:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-547">Following is an insecure example:</span></span> 

```C#
<div class="form-group">
            @Html.Raw(Model.AccountConfirmText)
        </div>
        <div class="form-group">
            @Html.Raw(Model.PaymentConfirmText)
        </div>
</div>
```
<span data-ttu-id="dbcc0-548">No utilice `Html.Raw()` a menos que necesite mostrar marcado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-548">Do not use `Html.Raw()` unless you need to display markup.</span></span> <span data-ttu-id="dbcc0-549">Este método no realiza la codificación de salida implícitamente.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-549">This method does not perform output encoding implicitly.</span></span> <span data-ttu-id="dbcc0-550">Use otros métodos auxiliares de ASP.NET, como `@Html.DisplayFor()`.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-550">Use other ASP.NET helpers e.g., `@Html.DisplayFor()`</span></span> 

## <span data-ttu-id="dbcc0-551"><a id="stored-proc"></a>No use consultas dinámicas en procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="dbcc0-551"><a id="stored-proc"></a>Do not use dynamic queries in stored procedures</span></span>

| <span data-ttu-id="dbcc0-552">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-552">Title</span></span>                   | <span data-ttu-id="dbcc0-553">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-553">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-554">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-554">**Component**</span></span>               | <span data-ttu-id="dbcc0-555">Base de datos</span><span class="sxs-lookup"><span data-stu-id="dbcc0-555">Database</span></span> | 
| <span data-ttu-id="dbcc0-556">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-556">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-557">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-557">Build</span></span> |  
| <span data-ttu-id="dbcc0-558">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-558">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-559">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-559">Generic</span></span> |
| <span data-ttu-id="dbcc0-560">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-560">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-561">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-561">N/A</span></span>  |
| <span data-ttu-id="dbcc0-562">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-562">**References**</span></span>              | <span data-ttu-id="dbcc0-563">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-563">N/A</span></span>  |
| <span data-ttu-id="dbcc0-564">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-564">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-565">Un ataque por inyección de código SQL aprovecha vulnerabilidades en la validación de entrada para ejecutar comandos arbitrarios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-565">A SQL injection attack exploits vulnerabilities in input validation to run arbitrary commands in the database.</span></span> <span data-ttu-id="dbcc0-566">Puede suceder cuando la aplicación usa una entrada para construir instrucciones SQL dinámicas para acceder a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-566">It can occur when your application uses input to construct dynamic SQL statements to access the database.</span></span> <span data-ttu-id="dbcc0-567">También puede producirse si el código usa procedimientos almacenados a los que se pasan cadenas que contienen entrada de usuario sin procesar.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-567">It can also occur if your code uses stored procedures that are passed strings that contain raw user input.</span></span> <span data-ttu-id="dbcc0-568">Mediante un ataque por inyección de código SQL, el atacante puede ejecutar comandos arbitrarios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-568">Using the SQL injection attack, the attacker can execute arbitrary commands in the database.</span></span> <span data-ttu-id="dbcc0-569">Todas las instrucciones SQL (incluidas las que se encuentran en procedimientos almacenados) deben estar parametrizadas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-569">All SQL statements (including the SQL statements in stored procedures) must be parameterized.</span></span> <span data-ttu-id="dbcc0-570">Las instrucciones SQL parametrizadas aceptarán caracteres que tengan un significado especial en SQL (por ejemplo, las comillas simples) sin problemas porque están fuertemente tipadas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-570">Parameterized SQL statements will accept characters that have special meaning to SQL (like single quote) without problems because they are strongly typed.</span></span> |

### <a name="example"></a><span data-ttu-id="dbcc0-571">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-571">Example</span></span>
<span data-ttu-id="dbcc0-572">El ejemplo siguiente es de un procedimiento almacenado dinámico inseguro:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-572">Following is an example of insecure dynamic Stored Procedure:</span></span> 

```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteria]
(
  @productName nvarchar(200) = NULL,
  @startPrice float = NULL,
  @endPrice float = NULL
)
AS
 BEGIN
  DECLARE @sql nvarchar(max)
  SELECT @sql = ' SELECT ProductID, ProductName, Description, UnitPrice, ImagePath' +
       ' FROM dbo.Products WHERE 1 = 1 '
       PRINT @sql
  IF @productName IS NOT NULL
     SELECT @sql = @sql + ' AND ProductName LIKE ''%' + @productName + '%'''
  IF @startPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice > ''' + CONVERT(VARCHAR(10),@startPrice) + ''''
  IF @endPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice < ''' + CONVERT(VARCHAR(10),@endPrice) + ''''

  PRINT @sql
  EXEC(@sql)
 END
```

### <a name="example"></a><span data-ttu-id="dbcc0-573">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-573">Example</span></span>
<span data-ttu-id="dbcc0-574">Este es el mismo procedimiento almacenado pero implementado de forma segura:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-574">Following is the same stored procedure implemented securely:</span></span> 
```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteriaSecure]
(
             @productName nvarchar(200) = NULL,
             @startPrice float = NULL,
             @endPrice float = NULL
)
AS
       BEGIN
             SELECT ProductID, ProductName, Description, UnitPrice, ImagePath
             FROM dbo.Products where
             (@productName IS NULL or ProductName like '%'+ @productName +'%')
             AND
             (@startPrice IS NULL or UnitPrice > @startPrice)
             AND
             (@endPrice IS NULL or UnitPrice < @endPrice)         
       END
```

## <span data-ttu-id="dbcc0-575"><a id="validation-api"></a>Asegúrese de que se lleve a cabo la validación del modelo en métodos de API web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-575"><a id="validation-api"></a>Ensure that model validation is done on Web API methods</span></span>

| <span data-ttu-id="dbcc0-576">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-576">Title</span></span>                   | <span data-ttu-id="dbcc0-577">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-577">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-578">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-578">**Component**</span></span>               | <span data-ttu-id="dbcc0-579">API Web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-579">Web API</span></span> | 
| <span data-ttu-id="dbcc0-580">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-580">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-581">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-581">Build</span></span> |  
| <span data-ttu-id="dbcc0-582">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-582">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-583">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-583">MVC5, MVC6</span></span> |
| <span data-ttu-id="dbcc0-584">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-584">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-585">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-585">N/A</span></span>  |
| <span data-ttu-id="dbcc0-586">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-586">**References**</span></span>              | <span data-ttu-id="dbcc0-587">[Model Validation in ASP.NET Web API](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api) (Validación de modelo en ASP.NET Web API)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-587">[Model Validation in ASP.NET Web API ](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api)</span></span> |
| <span data-ttu-id="dbcc0-588">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-588">**Steps**</span></span> | <span data-ttu-id="dbcc0-589">Cuando un cliente envía datos a una API web, es obligatorio que valide los datos antes de realizar cualquier procesamiento.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-589">When a client sends data to a web API, it is mandatory to validate the data before doing any processing.</span></span> <span data-ttu-id="dbcc0-590">Para las API web de ASP.NET, cuando aceptan modelos como entrada, utilice anotaciones de datos en los modelos para establecer reglas de validación en las propiedades del modelo.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-590">For ASP.NET Web APIs which accept models as input, use data annotations on models to set validation rules on the properties of the model.</span></span>|

### <a name="example"></a><span data-ttu-id="dbcc0-591">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-591">Example</span></span>
<span data-ttu-id="dbcc0-592">El código siguiente lo demuestra:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-592">The following code demonstrates the same:</span></span> 

```C#
using System.ComponentModel.DataAnnotations;

namespace MyApi.Models
{
    public class Product
    {
        public int Id { get; set; }
        [Required]
        [RegularExpression(@"^[a-zA-Z0-9]*$", ErrorMessage="Only alphanumeric characters are allowed.")]
        public string Name { get; set; }
        public decimal Price { get; set; }
        [Range(0, 999)]
        public double Weight { get; set; }
    }
}
```

### <a name="example"></a><span data-ttu-id="dbcc0-593">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-593">Example</span></span>
<span data-ttu-id="dbcc0-594">En el método de acción de los controladores de API, la validez del modelo se debe comprobar explícitamente como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="dbcc0-594">In the action method of the API controllers, validity of the model has to be explicitly checked as shown below:</span></span> 

```C#
namespace MyApi.Controllers
{
    public class ProductsController : ApiController
    {
        public HttpResponseMessage Post(Product product)
        {
            if (ModelState.IsValid)
            {
                // Do something with the product (not shown).

                return new HttpResponseMessage(HttpStatusCode.OK);
            }
            else
            {
                return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState);
            }
        }
    }
}
```

## <span data-ttu-id="dbcc0-595"><a id="string-api"></a>Implemente la validación de entrada en todos los parámetros de tipo cadena aceptados por métodos de API web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-595"><a id="string-api"></a>Implement input validation on all string type parameters accepted by Web API methods</span></span>

| <span data-ttu-id="dbcc0-596">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-596">Title</span></span>                   | <span data-ttu-id="dbcc0-597">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-597">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-598">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-598">**Component**</span></span>               | <span data-ttu-id="dbcc0-599">API Web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-599">Web API</span></span> | 
| <span data-ttu-id="dbcc0-600">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-600">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-601">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-601">Build</span></span> |  
| <span data-ttu-id="dbcc0-602">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-602">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-603">Genérico, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="dbcc0-603">Generic, MVC 5, MVC 6</span></span> |
| <span data-ttu-id="dbcc0-604">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-604">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-605">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-605">N/A</span></span>  |
| <span data-ttu-id="dbcc0-606">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-606">**References**</span></span>              | <span data-ttu-id="dbcc0-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Validación de datos de modelo en una aplicación de MVC), [Principios orientativos para las aplicaciones de ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="dbcc0-608">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-608">**Steps**</span></span> | <span data-ttu-id="dbcc0-609">Para los métodos que solo acepten el tipo primitivo de datos como argumento, pero no modelos, se debe realizar la validación de entrada mediante expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-609">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="dbcc0-610">Aquí se debería usar Regex.IsMatch con un patrón de regex válido.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-610">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="dbcc0-611">Si la entrada no coincide con la expresión regular especificada, el control no debería continuar y se debería mostrar una advertencia adecuada con respecto al error de validación.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-611">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>|

## <span data-ttu-id="dbcc0-612"><a id="typesafe-api"></a>Asegúrese de que se usen parámetros con seguridad de tipos en la API web para el acceso a datos</span><span class="sxs-lookup"><span data-stu-id="dbcc0-612"><a id="typesafe-api"></a>Ensure that type-safe parameters are used in Web API for data access</span></span>

| <span data-ttu-id="dbcc0-613">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-613">Title</span></span>                   | <span data-ttu-id="dbcc0-614">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-614">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-615">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-615">**Component**</span></span>               | <span data-ttu-id="dbcc0-616">API Web</span><span class="sxs-lookup"><span data-stu-id="dbcc0-616">Web API</span></span> | 
| <span data-ttu-id="dbcc0-617">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-617">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-618">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-618">Build</span></span> |  
| <span data-ttu-id="dbcc0-619">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-619">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-620">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-620">Generic</span></span> |
| <span data-ttu-id="dbcc0-621">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-621">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-622">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-622">N/A</span></span>  |
| <span data-ttu-id="dbcc0-623">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-623">**References**</span></span>              | <span data-ttu-id="dbcc0-624">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-624">N/A</span></span>  |
| <span data-ttu-id="dbcc0-625">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-625">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-626">Si usa la colección de parámetros, SQL trata la entrada como valor literal en lugar de como código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-626">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="dbcc0-627">La colección de parámetros se puede usar para aplicar restricciones de tipo y longitud a los datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-627">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="dbcc0-628">Los valores fuera del intervalo desencadenan una excepción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-628">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="dbcc0-629">Si no se usan parámetros SQL con seguridad de tipos, los atacantes podrían ejecutar ataques por inyección que se insertan en la entrada sin filtrar.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-629">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="dbcc0-630">Use parámetros con seguridad de tipos al construir consultas SQL para evitar posibles ataques por inyección de código SQL que pueden producirse con la entrada sin filtrar.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-630">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="dbcc0-631">Puede usar parámetros con seguridad de tipos con procedimientos almacenados e instrucciones SQL dinámicas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-631">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="dbcc0-632">Los parámetros se tratan como valores literales en la base de datos y no como código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-632">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="dbcc0-633">También se comprueban el tipo y la longitud de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-633">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="dbcc0-634">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="dbcc0-634">Example</span></span>
<span data-ttu-id="dbcc0-635">En el código siguiente, se muestra cómo usar parámetros con seguridad de tipos con SqlParameterCollection al llamar a un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-635">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="dbcc0-636">En el ejemplo de código anterior, el valor de entrada no puede tener más de 11 caracteres.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-636">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="dbcc0-637">Si los datos no se ajustan al tipo o la longitud definidos en el parámetro, la clase SqlParameter produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-637">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="dbcc0-638"><a id="sql-docdb"></a>Uso de consultas SQL parametrizadas con Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="dbcc0-638"><a id="sql-docdb"></a>Use parametrized SQL queries for Cosmos DB</span></span>

| <span data-ttu-id="dbcc0-639">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-639">Title</span></span>                   | <span data-ttu-id="dbcc0-640">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-640">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-641">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-641">**Component**</span></span>               | <span data-ttu-id="dbcc0-642">Azure DocumentDB</span><span class="sxs-lookup"><span data-stu-id="dbcc0-642">Azure Document DB</span></span> | 
| <span data-ttu-id="dbcc0-643">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-643">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-644">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-644">Build</span></span> |  
| <span data-ttu-id="dbcc0-645">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-645">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-646">Genérico</span><span class="sxs-lookup"><span data-stu-id="dbcc0-646">Generic</span></span> |
| <span data-ttu-id="dbcc0-647">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-647">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-648">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-648">N/A</span></span>  |
| <span data-ttu-id="dbcc0-649">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-649">**References**</span></span>              | <span data-ttu-id="dbcc0-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/) (Anuncio de la parametrización de SQL en DocumentDB)</span><span class="sxs-lookup"><span data-stu-id="dbcc0-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/)</span></span> |
| <span data-ttu-id="dbcc0-651">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-651">**Steps**</span></span> | <span data-ttu-id="dbcc0-652">Aunque DocumentDB solo admite consultas de solo lectura, todavía es posible inyectar código SQL si las consultas se crean mediante la concatenación con la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-652">Although DocumentDB only supports read-only queries, SQL injection is still possible if queries are constructed by concatenating with user input.</span></span> <span data-ttu-id="dbcc0-653">Es posible que un usuario obtenga acceso a datos a los que no debería acceder dentro de la misma colección mediante el diseño de consultas SQL malintencionadas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-653">It might be possible for a user to gain access to data they shouldn’t be accessing within the same collection by crafting malicious SQL queries.</span></span> <span data-ttu-id="dbcc0-654">Use consultas SQL parametrizadas si las consultas se construyen tomando como base la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-654">Use parameterized SQL queries if queries are constructed based on user input.</span></span> |

## <span data-ttu-id="dbcc0-655"><a id="schema-binding"></a>Validación de entrada de WCF mediante enlaces de esquema</span><span class="sxs-lookup"><span data-stu-id="dbcc0-655"><a id="schema-binding"></a>WCF Input validation through Schema binding</span></span>

| <span data-ttu-id="dbcc0-656">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-656">Title</span></span>                   | <span data-ttu-id="dbcc0-657">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-657">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-658">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-658">**Component**</span></span>               | <span data-ttu-id="dbcc0-659">WCF</span><span class="sxs-lookup"><span data-stu-id="dbcc0-659">WCF</span></span> | 
| <span data-ttu-id="dbcc0-660">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-660">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-661">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-661">Build</span></span> |  
| <span data-ttu-id="dbcc0-662">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-662">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-663">Genérico, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="dbcc0-663">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="dbcc0-664">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-664">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-665">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-665">N/A</span></span>  |
| <span data-ttu-id="dbcc0-666">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-666">**References**</span></span>              | [<span data-ttu-id="dbcc0-667">MSDN</span><span class="sxs-lookup"><span data-stu-id="dbcc0-667">MSDN</span></span>](https://msdn.microsoft.com/library/ff647820.aspx) |
| <span data-ttu-id="dbcc0-668">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-668">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-669">La falta de validación conlleva diferentes tipos de ataque por inyección.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-669">Lack of validation leads to different type injection attacks.</span></span></p><p><span data-ttu-id="dbcc0-670">La validación de mensajes constituye una línea de defensa para la protección de la aplicación WCF.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-670">Message validation represents one line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="dbcc0-671">Con este enfoque, se validan los mensajes mediante esquemas para proteger las operaciones del servicio WCF frente al ataque de un cliente malintencionado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-671">With this approach, you validate messages using schemas to protect WCF service operations from attack by a malicious client.</span></span> <span data-ttu-id="dbcc0-672">Valide todos los mensajes recibidos por el cliente para protegerlo frente al ataque de un servicio malintencionado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-672">Validate all messages received by the client to protect the client from attack by a malicious service.</span></span> <span data-ttu-id="dbcc0-673">La validación de mensajes permite validar mensajes cuando las operaciones consumen contratos de mensaje o de datos, algo que no se puede llevar a cabo mediante la validación de parámetros.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-673">Message validation makes it possible to validate messages when operations consume message contracts or data contracts, which cannot be done using parameter validation.</span></span> <span data-ttu-id="dbcc0-674">La validación de mensajes le permite crear lógica de validación dentro de esquemas, lo cual proporciona más flexibilidad y reduce el tiempo de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-674">Message validation allows you to create validation logic inside schemas, thereby providing more flexibility and reducing development time.</span></span> <span data-ttu-id="dbcc0-675">Los esquemas se pueden reutilizar en distintas aplicaciones dentro de la organización y así crear estándares para la representación de datos.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-675">Schemas can be reused across different applications inside the organization, creating standards for data representation.</span></span> <span data-ttu-id="dbcc0-676">Además, la validación de mensajes permite proteger las operaciones cuando consumen tipos de datos más complejos con contratos que representan lógica de negocios.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-676">Additionally, message validation allows you to protect operations when they consume more complex data types involving contracts representing business logic.</span></span></p><p><span data-ttu-id="dbcc0-677">Para realizar la validación de mensajes, primero cree un esquema que represente las operaciones del servicio y los tipos de datos consumidos por esas operaciones.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-677">To perform message validation, you first build a schema that represents the operations of your service and the data types consumed by those operations.</span></span> <span data-ttu-id="dbcc0-678">Después, cree una clase .NET que implemente un inspector de mensajes de cliente personalizado y un inspector de mensajes de distribuidor personalizado para validar los mensajes enviados al servicio o recibidos desde él.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-678">You then create a .NET class that implements a custom client message inspector and custom dispatcher message inspector to validate the messages sent/received to/from the service.</span></span> <span data-ttu-id="dbcc0-679">A continuación, implemente un comportamiento de punto de conexión personalizado para habilitar la validación de mensajes en el cliente y el servicio.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-679">Next, you implement a custom endpoint behavior to enable message validation on both the client and the service.</span></span> <span data-ttu-id="dbcc0-680">Por último, implemente un elemento de configuración personalizado en la clase que permita exponer el comportamiento de punto de conexión personalizado extendido en el archivo de configuración del servicio o el cliente.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-680">Finally, you implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client"</span></span></p>|

## <span data-ttu-id="dbcc0-681"><a id="parameters"></a>Validación de entrada de WCF mediante inspectores de parámetros</span><span class="sxs-lookup"><span data-stu-id="dbcc0-681"><a id="parameters"></a>WCF- Input validation through Parameter Inspectors</span></span>

| <span data-ttu-id="dbcc0-682">Título</span><span class="sxs-lookup"><span data-stu-id="dbcc0-682">Title</span></span>                   | <span data-ttu-id="dbcc0-683">Detalles</span><span class="sxs-lookup"><span data-stu-id="dbcc0-683">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="dbcc0-684">**Componente**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-684">**Component**</span></span>               | <span data-ttu-id="dbcc0-685">WCF</span><span class="sxs-lookup"><span data-stu-id="dbcc0-685">WCF</span></span> | 
| <span data-ttu-id="dbcc0-686">**Fase de SDL**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-686">**SDL Phase**</span></span>               | <span data-ttu-id="dbcc0-687">Compilación</span><span class="sxs-lookup"><span data-stu-id="dbcc0-687">Build</span></span> |  
| <span data-ttu-id="dbcc0-688">**Tecnologías aplicables**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-688">**Applicable Technologies**</span></span> | <span data-ttu-id="dbcc0-689">Genérico, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="dbcc0-689">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="dbcc0-690">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-690">**Attributes**</span></span>              | <span data-ttu-id="dbcc0-691">N/D</span><span class="sxs-lookup"><span data-stu-id="dbcc0-691">N/A</span></span>  |
| <span data-ttu-id="dbcc0-692">**Referencias**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-692">**References**</span></span>              | [<span data-ttu-id="dbcc0-693">MSDN</span><span class="sxs-lookup"><span data-stu-id="dbcc0-693">MSDN</span></span>](https://msdn.microsoft.com/library/ff647875.aspx) |
| <span data-ttu-id="dbcc0-694">**Pasos**</span><span class="sxs-lookup"><span data-stu-id="dbcc0-694">**Steps**</span></span> | <p><span data-ttu-id="dbcc0-695">La validación de datos y de entrada constituye una importante línea de defensa para la protección de la aplicación WCF.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-695">Input and data validation represents one important line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="dbcc0-696">Debería validar todos los parámetros expuestos en las operaciones del servicio WCF para proteger el servicio frente al ataque de un cliente malintencionado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-696">You should validate all parameters exposed in WCF service operations to protect the service from attack by a malicious client.</span></span> <span data-ttu-id="dbcc0-697">A la inversa, debería validar todos los valores devueltos recibidos por el cliente para protegerlo frente al ataque de un servicio malintencionado.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-697">Conversely, you should also validate all return values received by the client to protect the client from attack by a malicious service</span></span></p><p><span data-ttu-id="dbcc0-698">WCF proporciona diferentes puntos de extensibilidad que permiten personalizar el comportamiento en tiempo de ejecución de WCF mediante la creación de extensiones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-698">WCF provides different extensibility points that allow you to customize the WCF runtime behavior by creating custom extensions.</span></span> <span data-ttu-id="dbcc0-699">Los inspectores de mensajes y de parámetros son dos mecanismos de extensibilidad que se usan para ejercer un mayor control sobre los datos que pasan entre un cliente y un servicio.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-699">Message Inspectors and Parameter Inspectors are two extensibility mechanisms used to gain greater control over the data passing between a client and a service.</span></span> <span data-ttu-id="dbcc0-700">Debería usar inspectores de parámetros para la validación de entrada e inspectores de mensajes solo cuando necesite inspeccionar el mensaje completo que fluye dentro y fuera de un servicio.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-700">You should use parameter inspectors for input validation and use message inspectors only when you need to inspect the entire message flowing in and out of a service.</span></span></p><p><span data-ttu-id="dbcc0-701">Para llevar a cabo la validación de entrada, generará una clase .NET e implementará un inspector de parámetros personalizado para validar los parámetros en las operaciones de su servicio.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-701">To perform input validation, you will build a .NET class and implement a custom parameter inspector in order to validate parameters on operations in your service.</span></span> <span data-ttu-id="dbcc0-702">Después, implementará un comportamiento de punto de conexión personalizado para habilitar la validación tanto en el cliente como en el servicio.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-702">You will then implement a custom endpoint behavior to enable validation on both the client and the service.</span></span> <span data-ttu-id="dbcc0-703">Por último, implementará un elemento de configuración personalizado en la clase que permita exponer el comportamiento de punto de conexión personalizado extendido en el archivo de configuración del servicio o del cliente.</span><span class="sxs-lookup"><span data-stu-id="dbcc0-703">Finally, you will implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client</span></span></p>|
