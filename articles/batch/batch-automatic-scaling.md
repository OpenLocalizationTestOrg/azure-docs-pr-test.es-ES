---
title: "escala de aaaAutomatically nodos de cálculo en un grupo de lote de Azure | Documentos de Microsoft"
description: "Habilitar el escalado automático en un toodynamically de grupo en la nube ajuste el número de Hola de nodos de proceso en el grupo de Hola."
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: b6d1e0c5d8e0e56e15a4d3588150f2466a689f19
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="97dec-103">Creación de una fórmula de escala automática para escalar nodos de proceso en un grupo de Batch</span><span class="sxs-lookup"><span data-stu-id="97dec-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="97dec-104">Azure Batch puede escalar grupos automáticamente en función de los parámetros que defina.</span><span class="sxs-lookup"><span data-stu-id="97dec-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="97dec-105">Con el escalado automático, lote agrega dinámicamente el grupo de nodos tooa como tarea aumente la demanda y quita nodos de proceso disminuir.</span><span class="sxs-lookup"><span data-stu-id="97dec-105">With automatic scaling, Batch dynamically adds nodes tooa pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="97dec-106">Puede ahorrarle tiempo y dinero mediante el ajuste automático de número de Hola de nodos de cálculo usados por la aplicación de lote.</span><span class="sxs-lookup"><span data-stu-id="97dec-106">You can save both time and money by automatically adjusting hello number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="97dec-107">Habilite el escalado automático en un grupo de nodos de ejecución asociándolo a una *fórmula de escalado automático* que se puede definir.</span><span class="sxs-lookup"><span data-stu-id="97dec-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="97dec-108">Hola servicio por lotes utiliza a Hola escalado automático el número de Hola de toodetermine fórmulas de nodos de proceso que son necesario tooexecute la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="97dec-108">hello Batch service uses hello autoscale formula toodetermine hello number of compute nodes that are needed tooexecute your workload.</span></span> <span data-ttu-id="97dec-109">Los nodos de ejecución pueden ser nodos dedicados o [nodos de prioridad baja](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="97dec-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="97dec-110">Lote responde tooservice datos de métricas que se recopilaron periódicamente.</span><span class="sxs-lookup"><span data-stu-id="97dec-110">Batch responds tooservice metrics data that is collected periodically.</span></span> <span data-ttu-id="97dec-111">Con estos datos de métricas, lote ajusta número Hola de nodos de proceso de grupo de hello en función de la fórmula y en un intervalo configurable.</span><span class="sxs-lookup"><span data-stu-id="97dec-111">Using this metrics data, Batch adjusts hello number of compute nodes in hello pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="97dec-112">Puede habilitar el escalado automático al crear un grupo o bien en un grupo existente.</span><span class="sxs-lookup"><span data-stu-id="97dec-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="97dec-113">También puede cambiar una fórmula existente en un grupo configurado para el escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="97dec-114">Lote le permite tooevaluate las fórmulas antes de asignarlas toopools y toomonitor estado Hola de ajuste de escala automática se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="97dec-114">Batch enables you tooevaluate your formulas before assigning them toopools and toomonitor hello status of automatic scaling runs.</span></span>

<span data-ttu-id="97dec-115">Este artículo describe Hola distintas entidades que forman las fórmulas de escalado automático, incluidas las variables, operadores, las operaciones y funciones.</span><span class="sxs-lookup"><span data-stu-id="97dec-115">This article discusses hello various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="97dec-116">Se describe cómo tooobtain diversas métricas de recursos y tareas de lote de proceso.</span><span class="sxs-lookup"><span data-stu-id="97dec-116">We discuss how tooobtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="97dec-117">Puede usar estos tooadjust métricas el número de nodos de la agrupación según el estado de tarea y de uso de recursos.</span><span class="sxs-lookup"><span data-stu-id="97dec-117">You can use these metrics tooadjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="97dec-118">A continuación, se describe cómo tooconstruct una fórmula y habilitación automática de ajuste de escala en un grupo mediante el uso de ambos hello las API de .NET y REST de lote.</span><span class="sxs-lookup"><span data-stu-id="97dec-118">We then describe how tooconstruct a formula and enable automatic scaling on a pool by using both hello Batch REST and .NET APIs.</span></span> <span data-ttu-id="97dec-119">Por último, terminaremos con algunas fórmulas de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="97dec-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="97dec-120">Cuando se crea una cuenta de lote, puede especificar hello [configuración de la cuenta](batch-api-basics.md#account), que determina si se asignan grupos en una suscripción a un servicio de lote (valor predeterminado de hello), o en su suscripción de usuario.</span><span class="sxs-lookup"><span data-stu-id="97dec-120">When you create a Batch account, you can specify hello [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (hello default), or in your user subscription.</span></span> <span data-ttu-id="97dec-121">Si ha creado su cuenta de lote con la configuración predeterminada del servicio de lote de hello, su cuenta es tooa limita el número máximo de núcleos que se puede usar para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="97dec-121">If you created your Batch account with hello default Batch Service configuration, then your account is limited tooa maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="97dec-122">Hola servicio por lotes escala nodos de proceso solo una toothat límite de núcleos.</span><span class="sxs-lookup"><span data-stu-id="97dec-122">hello Batch service scales compute nodes only up toothat core limit.</span></span> <span data-ttu-id="97dec-123">Por esta razón, Hola servicio por lotes puede no llegó al número de destino de Hola de nodos de proceso especificado por una fórmula de Autoescala.</span><span class="sxs-lookup"><span data-stu-id="97dec-123">For this reason, hello Batch service may not reach hello target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="97dec-124">Vea [las cuotas y límites de hello servicio Azure Batch](batch-quota-limit.md) para obtener información sobre cómo ver y aumentar las cuotas de cuenta.</span><span class="sxs-lookup"><span data-stu-id="97dec-124">See [Quotas and limits for hello Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="97dec-125">Si ha creado su cuenta con la configuración de suscripción de usuario de hello, su cuenta de recursos compartidos de cuota de núcleos de hello para la suscripción de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-125">If you created your account with hello User Subscription configuration, then your account shares in hello core quota for hello subscription.</span></span> <span data-ttu-id="97dec-126">Para más información, consulte [Límites de Virtual Machines](../azure-subscription-service-limits.md#virtual-machines-limits) en [Límites, cuotas y restricciones de suscripción y servicios de Microsoft Azure](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="97dec-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="97dec-127">Fórmulas de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-127">Automatic scaling formulas</span></span>
<span data-ttu-id="97dec-128">Una fórmula de escalado automático es un valor de cadena que el usuario define y contiene una o varias instrucciones.</span><span class="sxs-lookup"><span data-stu-id="97dec-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="97dec-129">fórmula de Autoescala de Hola se asigna del grupo de tooa [autoScaleFormula] [ rest_autoscaleformula] elemento (REST de lote) o [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] propiedad (lote. NET).</span><span class="sxs-lookup"><span data-stu-id="97dec-129">hello autoscale formula is assigned tooa pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="97dec-130">Hola servicio por lotes utiliza su número de destino de hello toodetermine fórmulas de nodos de proceso en grupo de hello para el siguiente intervalo de procesamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-130">hello Batch service uses your formula toodetermine hello target number of compute nodes in hello pool for hello next interval of processing.</span></span> <span data-ttu-id="97dec-131">cadena de fórmula de Hello no puede superar los 8 KB, puede incluir los informes de too100 que están separados por punto y coma y pueden incluir saltos de línea y comentarios.</span><span class="sxs-lookup"><span data-stu-id="97dec-131">hello formula string cannot exceed 8 KB, can include up too100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="97dec-132">Puede imaginarse que las fórmulas de escalado automático son un "lenguaje" de escalado automático de Batch.</span><span class="sxs-lookup"><span data-stu-id="97dec-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="97dec-133">Instrucciones fórmulas son expresiones de forma libre que pueden incluir variables definidas por el servicio (variables definidas por el servicio por lotes Hola) y variables definidas por el usuario (variables que defina).</span><span class="sxs-lookup"><span data-stu-id="97dec-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by hello Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="97dec-134">Pueden realizar diversas operaciones en estos valores mediante funciones, operadores y tipos integrados.</span><span class="sxs-lookup"><span data-stu-id="97dec-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="97dec-135">Por ejemplo, una instrucción puede tardar Hola siguiente forma:</span><span class="sxs-lookup"><span data-stu-id="97dec-135">For example, a statement might take hello following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="97dec-136">Las fórmulas suelen tener varias instrucciones que realizan operaciones en los valores obtenidos en las instrucciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="97dec-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="97dec-137">Por ejemplo, en primer lugar se obtienen un valor para `variable1`, a continuación, páselo tooa función toopopulate `variable2`:</span><span class="sxs-lookup"><span data-stu-id="97dec-137">For example, first we obtain a value for `variable1`, then pass it tooa function toopopulate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="97dec-138">Incluya estas instrucciones en el tooarrive de fórmula de escalado automático en un número de destino de nodos de proceso.</span><span class="sxs-lookup"><span data-stu-id="97dec-138">Include these statements in your autoscale formula tooarrive at a target number of compute nodes.</span></span> <span data-ttu-id="97dec-139">Los nodos dedicados y los nodos de prioridad baja tienen sus propios valores de destino, por lo que puede definir un destino para cada tipo de nodo.</span><span class="sxs-lookup"><span data-stu-id="97dec-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="97dec-140">Una fórmula de escalado automático puede incluir un valor de destino para los nodos dedicados, un valor de destino para los nodos de prioridad baja o ambos.</span><span class="sxs-lookup"><span data-stu-id="97dec-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="97dec-141">número de destino de Hola de nodos podría estar superior, inferior, o igual que el número actual de Hola de nodos de ese tipo en el grupo de Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-141">hello target number of nodes may be higher, lower, or hello same as hello current number of nodes of that type in hello pool.</span></span> <span data-ttu-id="97dec-142">Batch evalúa la fórmula de escalado automático del grupo según un intervalo específico (consulte [Intervalo de escalado automático](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="97dec-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="97dec-143">Lote ajusta el número de destino de Hola de cada tipo de nodo en el número de toohello de grupo de Hola que especifica la fórmula de escalado automático en tiempo de Hola de evaluación.</span><span class="sxs-lookup"><span data-stu-id="97dec-143">Batch adjusts hello target number of each type of node in hello pool toohello number that your autoscale formula specifies at hello time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="97dec-144">Fórmula de escalado automático de muestras</span><span class="sxs-lookup"><span data-stu-id="97dec-144">Sample autoscale formula</span></span>

<span data-ttu-id="97dec-145">Este es un ejemplo de una fórmula de Autoescala que puede ser toowork ajustada para la mayoría de los escenarios.</span><span class="sxs-lookup"><span data-stu-id="97dec-145">Here is an example of an autoscale formula that can be adjusted toowork for most scenarios.</span></span> <span data-ttu-id="97dec-146">Hola variables `startingNumberOfVMs` y `maxNumberofVMs` en hello fórmula de ejemplo puede ser ajustado tooyour necesidades.</span><span class="sxs-lookup"><span data-stu-id="97dec-146">hello variables `startingNumberOfVMs` and `maxNumberofVMs` in hello example formula can be adjusted tooyour needs.</span></span> <span data-ttu-id="97dec-147">Esta fórmula escala nodos dedicados, pero puede ser modificado tooapply tooscale también nodos de prioridad baja.</span><span class="sxs-lookup"><span data-stu-id="97dec-147">This formula scales dedicated nodes, but can be modified tooapply tooscale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="97dec-148">Con esta fórmula de escalado automático, grupo de Hola se crea inicialmente con una sola máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="97dec-148">With this autoscale formula, hello pool is initially created with a single VM.</span></span> <span data-ttu-id="97dec-149">Hola `$PendingTasks` métrica define el número de Hola de tareas que están en cola o en ejecución.</span><span class="sxs-lookup"><span data-stu-id="97dec-149">hello `$PendingTasks` metric defines hello number of tasks that are running or queued.</span></span> <span data-ttu-id="97dec-150">fórmula de Hello busca Hola promedio de las tareas pendientes de hello últimos 180 segundos y establece hello `$TargetDedicatedNodes` variable según corresponda.</span><span class="sxs-lookup"><span data-stu-id="97dec-150">hello formula finds hello average number of pending tasks in hello last 180 seconds and sets hello `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="97dec-151">fórmula de Hello garantiza que número de destino de Hola de nodos dedicados nunca supere el 25 máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="97dec-151">hello formula ensures that hello target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="97dec-152">Las tareas nuevas se envían, grupo de hello automáticamente a medida que aumenta.</span><span class="sxs-lookup"><span data-stu-id="97dec-152">As new tasks are submitted, hello pool automatically grows.</span></span> <span data-ttu-id="97dec-153">Como tareas se completan, las máquinas virtuales se convierten en uno por uno libre y fórmula de Autoescala de hello disminuye grupo Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-153">As tasks complete, VMs become free one by one and hello autoscaling formula shrinks hello pool.</span></span>

## <a name="variables"></a><span data-ttu-id="97dec-154">variables</span><span class="sxs-lookup"><span data-stu-id="97dec-154">Variables</span></span>
<span data-ttu-id="97dec-155">En las fórmulas de escalado automático puede usar tanto variables **definidas por el servicio** como variables **definidas por el usuario**.</span><span class="sxs-lookup"><span data-stu-id="97dec-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="97dec-156">se crean variables definidas por el servicio de Hello en toohello servicio por lotes.</span><span class="sxs-lookup"><span data-stu-id="97dec-156">hello service-defined variables are built in toohello Batch service.</span></span> <span data-ttu-id="97dec-157">Algunas variables definidas por el servicio son de lectura y escritura, mientras que otras son de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="97dec-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="97dec-158">Las variables definidas por el usuario son las que usted define.</span><span class="sxs-lookup"><span data-stu-id="97dec-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="97dec-159">En la fórmula de ejemplo de Hola se muestra en la sección anterior de hello, `$TargetDedicatedNodes` y `$PendingTasks` son variables definidas por el servicio.</span><span class="sxs-lookup"><span data-stu-id="97dec-159">In hello example formula shown in hello previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="97dec-160">Las variables `startingNumberOfVMs` y `maxNumberofVMs` son variables definidas por el usuario.</span><span class="sxs-lookup"><span data-stu-id="97dec-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="97dec-161">Las variables definidas por el servicio van siempre precedidas de un símbolo de dólar ($).</span><span class="sxs-lookup"><span data-stu-id="97dec-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="97dec-162">Para variables definidas por el usuario, el signo de dólar de hello es opcional.</span><span class="sxs-lookup"><span data-stu-id="97dec-162">For user-defined variables, hello dollar sign is optional.</span></span>
>
>

<span data-ttu-id="97dec-163">Hola las tablas siguientes se muestra ambos lectura / escritura y variables de solo lectura que se definen mediante Hola servicio por lotes.</span><span class="sxs-lookup"><span data-stu-id="97dec-163">hello following tables show both read-write and read-only variables that are defined by hello Batch service.</span></span>

<span data-ttu-id="97dec-164">Puede obtener y establecer valores de hello de estas variables definidas por el servicio de número de hello toomanage de nodos de proceso en un grupo de:</span><span class="sxs-lookup"><span data-stu-id="97dec-164">You can get and set hello values of these service-defined variables toomanage hello number of compute nodes in a pool:</span></span>

| <span data-ttu-id="97dec-165">Variables definidas por el servicio de solo escritura</span><span class="sxs-lookup"><span data-stu-id="97dec-165">Read-write service-defined variables</span></span> | <span data-ttu-id="97dec-166">Descripción</span><span class="sxs-lookup"><span data-stu-id="97dec-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="97dec-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="97dec-168">número de destino de Hola de dedicado nodos de grupo de Hola de ejecución.</span><span class="sxs-lookup"><span data-stu-id="97dec-168">hello target number of dedicated compute nodes for hello pool.</span></span> <span data-ttu-id="97dec-169">número de Hola de nodos dedicados se especifica como un destino como un grupo puede no siempre se consigue un número de hello deseado de nodos.</span><span class="sxs-lookup"><span data-stu-id="97dec-169">hello number of dedicated nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="97dec-170">Por ejemplo, si se modifica el número de destino de Hola de nodos dedicados por una evaluación de escalado automático antes de hello grupo alcanza el destino inicial hello, a continuación, grupo hello no puede llegar al destino de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-170">For example, if hello target number of dedicated nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <br /><br /> <span data-ttu-id="97dec-171">Un grupo en una cuenta creada con la configuración de servicio por lotes de hello no puede alcance su destino si el destino de hello supera una cuota de nodos o núcleos de la cuenta de lote.</span><span class="sxs-lookup"><span data-stu-id="97dec-171">A pool in an account created with hello Batch Service configuration may not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="97dec-172">Un grupo en una cuenta creada con la configuración de suscripción de usuario de hello no puede alcance su destino si el destino de hello supera la cuota de núcleo compartido de hello para la suscripción de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-172">A pool in an account created with hello User Subscription configuration may not achieve its target if hello target exceeds hello shared core quota for hello subscription.</span></span>|
| <span data-ttu-id="97dec-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="97dec-174">número de destino de Hola de prioridad baja nodos de grupo de Hola de ejecución.</span><span class="sxs-lookup"><span data-stu-id="97dec-174">hello target number of low-priority compute nodes for hello pool.</span></span> <span data-ttu-id="97dec-175">número de Hola de nodos de prioridad baja se especifica como un destino como un grupo puede no siempre se consigue un número de hello deseado de nodos.</span><span class="sxs-lookup"><span data-stu-id="97dec-175">hello number of low-priority nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="97dec-176">Por ejemplo, si se modifica el número de destino de Hola de nodos de prioridad baja por una evaluación de escalado automático antes de hello grupo alcanza el destino inicial hello, a continuación, grupo hello no puede llegar al destino de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-176">For example, if hello target number of low-priority nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <span data-ttu-id="97dec-177">Un grupo puede también no se alcance su destino si el destino de hello supera una cuota de nodos o núcleos de la cuenta de lote.</span><span class="sxs-lookup"><span data-stu-id="97dec-177">A pool may also not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="97dec-178">Para obtener más información sobre los nodos de ejecución de prioridad baja, consulte [Uso de máquinas virtuales de prioridad baja con Batch (versión preliminar)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="97dec-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="97dec-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="97dec-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="97dec-180">acción de Hola que tiene lugar cuando se quitan nodos de proceso de un grupo.</span><span class="sxs-lookup"><span data-stu-id="97dec-180">hello action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="97dec-181">Los valores posibles son:</span><span class="sxs-lookup"><span data-stu-id="97dec-181">Possible values are:</span></span><ul><li><span data-ttu-id="97dec-182">**colocarlo en cola**: finaliza las tareas inmediatamente y pone en cola de trabajos de Hola para que se vuelve a programar.</span><span class="sxs-lookup"><span data-stu-id="97dec-182">**requeue**--Terminates tasks immediately and puts them back on hello job queue so that they are rescheduled.</span></span><li><span data-ttu-id="97dec-183">**terminar**: finaliza las tareas inmediatamente y elimina de la cola de trabajos de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-183">**terminate**--Terminates tasks immediately and removes them from hello job queue.</span></span><li><span data-ttu-id="97dec-184">**taskcompletion**--espera que está ejecutando tareas toofinish y, a continuación, quita el nodo de Hola de grupo de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-184">**taskcompletion**--Waits for currently running tasks toofinish and then removes hello node from hello pool.</span></span><li><span data-ttu-id="97dec-185">**retaineddata**--espera a que todos los Hola conservan tarea datos locales en hello nodo toobe limpia antes de quitar el nodo de Hola de grupo de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-185">**retaineddata**--Waits for all hello local task-retained data on hello node toobe cleaned up before removing hello node from hello pool.</span></span></ul> |

<span data-ttu-id="97dec-186">Puede obtener valor de Hola de estos ajustes de toomake de variables definidas por el servicio que se basan en las métricas de servicio por lotes de hello:</span><span class="sxs-lookup"><span data-stu-id="97dec-186">You can get hello value of these service-defined variables toomake adjustments that are based on metrics from hello Batch service:</span></span>

| <span data-ttu-id="97dec-187">Variables definidas por el servicio de solo lectura</span><span class="sxs-lookup"><span data-stu-id="97dec-187">Read-only service-defined variables</span></span> | <span data-ttu-id="97dec-188">Description</span><span class="sxs-lookup"><span data-stu-id="97dec-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="97dec-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="97dec-189">$CPUPercent</span></span> |<span data-ttu-id="97dec-190">Porcentaje medio de Hello del uso de CPU.</span><span class="sxs-lookup"><span data-stu-id="97dec-190">hello average percentage of CPU usage.</span></span> |
| <span data-ttu-id="97dec-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="97dec-191">$WallClockSeconds</span></span> |<span data-ttu-id="97dec-192">número de Hola de segundos consumidos.</span><span class="sxs-lookup"><span data-stu-id="97dec-192">hello number of seconds consumed.</span></span> |
| <span data-ttu-id="97dec-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-193">$MemoryBytes</span></span> |<span data-ttu-id="97dec-194">promedio de Hola de megabytes utilizados.</span><span class="sxs-lookup"><span data-stu-id="97dec-194">hello average number of megabytes used.</span></span> |
| <span data-ttu-id="97dec-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-195">$DiskBytes</span></span> |<span data-ttu-id="97dec-196">promedio de Hola de gigabytes usados en los discos locales de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-196">hello average number of gigabytes used on hello local disks.</span></span> |
| <span data-ttu-id="97dec-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-197">$DiskReadBytes</span></span> |<span data-ttu-id="97dec-198">número de Hola de bytes leídos.</span><span class="sxs-lookup"><span data-stu-id="97dec-198">hello number of bytes read.</span></span> |
| <span data-ttu-id="97dec-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-199">$DiskWriteBytes</span></span> |<span data-ttu-id="97dec-200">número de Hola de bytes escritos.</span><span class="sxs-lookup"><span data-stu-id="97dec-200">hello number of bytes written.</span></span> |
| <span data-ttu-id="97dec-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="97dec-201">$DiskReadOps</span></span> |<span data-ttu-id="97dec-202">se realiza el recuento de Hola de operaciones de lectura en el disco.</span><span class="sxs-lookup"><span data-stu-id="97dec-202">hello count of read disk operations performed.</span></span> |
| <span data-ttu-id="97dec-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="97dec-203">$DiskWriteOps</span></span> |<span data-ttu-id="97dec-204">recuento de Hola de operaciones de disco de escritura realizadas.</span><span class="sxs-lookup"><span data-stu-id="97dec-204">hello count of write disk operations performed.</span></span> |
| <span data-ttu-id="97dec-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-205">$NetworkInBytes</span></span> |<span data-ttu-id="97dec-206">número de Hola de bytes de entrada.</span><span class="sxs-lookup"><span data-stu-id="97dec-206">hello number of inbound bytes.</span></span> |
| <span data-ttu-id="97dec-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-207">$NetworkOutBytes</span></span> |<span data-ttu-id="97dec-208">número de Hola de bytes de salida.</span><span class="sxs-lookup"><span data-stu-id="97dec-208">hello number of outbound bytes.</span></span> |
| <span data-ttu-id="97dec-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="97dec-209">$SampleNodeCount</span></span> |<span data-ttu-id="97dec-210">recuento de Hola de nodos de proceso.</span><span class="sxs-lookup"><span data-stu-id="97dec-210">hello count of compute nodes.</span></span> |
| <span data-ttu-id="97dec-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-211">$ActiveTasks</span></span> |<span data-ttu-id="97dec-212">número de Hola de tareas que son tooexecute listo pero aún no se ejecute.</span><span class="sxs-lookup"><span data-stu-id="97dec-212">hello number of tasks that are ready tooexecute but are not yet executing.</span></span> <span data-ttu-id="97dec-213">recuento de Hello $ActiveTasks incluye todas las tareas que están en estado activo de Hola y cuyas dependencias se han cumplido.</span><span class="sxs-lookup"><span data-stu-id="97dec-213">hello $ActiveTasks count includes all tasks that are in hello active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="97dec-214">Las tareas que están en estado activo de hello pero no se han cumplido cuyas dependencias se excluyen de recuento de hello $ActiveTasks.</span><span class="sxs-lookup"><span data-stu-id="97dec-214">Any tasks that are in hello active state but whose dependencies have not been satisfied are excluded from hello $ActiveTasks count.</span></span>|
| <span data-ttu-id="97dec-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-215">$RunningTasks</span></span> |<span data-ttu-id="97dec-216">número de Hola de tareas en un estado de ejecución.</span><span class="sxs-lookup"><span data-stu-id="97dec-216">hello number of tasks in a running state.</span></span> |
| <span data-ttu-id="97dec-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-217">$PendingTasks</span></span> |<span data-ttu-id="97dec-218">suma de Hola de $ActiveTasks y $RunningTasks.</span><span class="sxs-lookup"><span data-stu-id="97dec-218">hello sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="97dec-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-219">$SucceededTasks</span></span> |<span data-ttu-id="97dec-220">número de Hola de tareas que finalizaron correctamente.</span><span class="sxs-lookup"><span data-stu-id="97dec-220">hello number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="97dec-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-221">$FailedTasks</span></span> |<span data-ttu-id="97dec-222">número de Hola de tareas que no se pudo.</span><span class="sxs-lookup"><span data-stu-id="97dec-222">hello number of tasks that failed.</span></span> |
| <span data-ttu-id="97dec-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="97dec-224">número actual de Hola de dedicado nodos de proceso.</span><span class="sxs-lookup"><span data-stu-id="97dec-224">hello current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="97dec-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="97dec-226">número actual de Hola de prioridad baja de proceso nodos, incluidos los que se han da.</span><span class="sxs-lookup"><span data-stu-id="97dec-226">hello current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="97dec-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="97dec-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="97dec-228">número de Hola de nodos de grupo de Hola que están en un estado de da.</span><span class="sxs-lookup"><span data-stu-id="97dec-228">hello number of nodes in hello pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="97dec-229">Hello definida por el servicio de solo lectura, las variables que se muestran en la tabla anterior de hello están *objetos* que proporcionan varios métodos datos tooaccess asociadas a cada una.</span><span class="sxs-lookup"><span data-stu-id="97dec-229">hello read-only, service-defined variables that are shown in hello previous table are *objects* that provide various methods tooaccess data associated with each.</span></span> <span data-ttu-id="97dec-230">Para obtener más información, consulte la sección [Obtención de datos de ejemplo](#getsampledata), descrita más adelante en este artículo.</span><span class="sxs-lookup"><span data-stu-id="97dec-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="97dec-231">Tipos</span><span class="sxs-lookup"><span data-stu-id="97dec-231">Types</span></span>
<span data-ttu-id="97dec-232">Estos son los tipos que se admiten en las fórmulas:</span><span class="sxs-lookup"><span data-stu-id="97dec-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="97dec-233">double</span><span class="sxs-lookup"><span data-stu-id="97dec-233">double</span></span>
* <span data-ttu-id="97dec-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-234">doubleVec</span></span>
* <span data-ttu-id="97dec-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="97dec-235">doubleVecList</span></span>
* <span data-ttu-id="97dec-236">cadena</span><span class="sxs-lookup"><span data-stu-id="97dec-236">string</span></span>
* <span data-ttu-id="97dec-237">marca de tiempo: marca de tiempo es una estructura compuesta que contiene Hola siguientes a miembros:</span><span class="sxs-lookup"><span data-stu-id="97dec-237">timestamp--timestamp is a compound structure that contains hello following members:</span></span>

  * <span data-ttu-id="97dec-238">year</span><span class="sxs-lookup"><span data-stu-id="97dec-238">year</span></span>
  * <span data-ttu-id="97dec-239">mes (1-12)</span><span class="sxs-lookup"><span data-stu-id="97dec-239">month (1-12)</span></span>
  * <span data-ttu-id="97dec-240">día (1-31)</span><span class="sxs-lookup"><span data-stu-id="97dec-240">day (1-31)</span></span>
  * <span data-ttu-id="97dec-241">día de la semana (en formato de Hola de número; por ejemplo, 1 para el lunes)</span><span class="sxs-lookup"><span data-stu-id="97dec-241">weekday (in hello format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="97dec-242">hora (en formato de número de 24 horas; por ejemplo, 13 significa 1 p.m.)</span><span class="sxs-lookup"><span data-stu-id="97dec-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="97dec-243">minuto (00-59)</span><span class="sxs-lookup"><span data-stu-id="97dec-243">minute (00-59)</span></span>
  * <span data-ttu-id="97dec-244">segundo (00-59)</span><span class="sxs-lookup"><span data-stu-id="97dec-244">second (00-59)</span></span>
* <span data-ttu-id="97dec-245">timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-245">timeinterval</span></span>

  * <span data-ttu-id="97dec-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="97dec-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="97dec-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="97dec-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="97dec-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="97dec-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="97dec-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="97dec-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="97dec-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="97dec-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="97dec-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="97dec-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="97dec-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="97dec-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="97dec-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="97dec-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="97dec-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="97dec-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="97dec-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="97dec-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="97dec-256">Operaciones</span><span class="sxs-lookup"><span data-stu-id="97dec-256">Operations</span></span>
<span data-ttu-id="97dec-257">Estas operaciones se permiten en los tipos de Hola que figuran en la sección anterior de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-257">These operations are allowed on hello types that are listed in hello previous section.</span></span>

| <span data-ttu-id="97dec-258">Operación</span><span class="sxs-lookup"><span data-stu-id="97dec-258">Operation</span></span> | <span data-ttu-id="97dec-259">Operadores admitidos</span><span class="sxs-lookup"><span data-stu-id="97dec-259">Supported operators</span></span> | <span data-ttu-id="97dec-260">Tipo de resultado</span><span class="sxs-lookup"><span data-stu-id="97dec-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="97dec-261">double *operador* double</span><span class="sxs-lookup"><span data-stu-id="97dec-261">double *operator* double</span></span> |<span data-ttu-id="97dec-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="97dec-262">+, -, *, /</span></span> |<span data-ttu-id="97dec-263">double</span><span class="sxs-lookup"><span data-stu-id="97dec-263">double</span></span> |
| <span data-ttu-id="97dec-264">double *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="97dec-265">timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-265">timeinterval</span></span> |
| <span data-ttu-id="97dec-266">doubleVec *operador* double</span><span class="sxs-lookup"><span data-stu-id="97dec-266">doubleVec *operator* double</span></span> |<span data-ttu-id="97dec-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="97dec-267">+, -, *, /</span></span> |<span data-ttu-id="97dec-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-268">doubleVec</span></span> |
| <span data-ttu-id="97dec-269">doubleVec *operador* doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="97dec-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="97dec-270">+, -, *, /</span></span> |<span data-ttu-id="97dec-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-271">doubleVec</span></span> |
| <span data-ttu-id="97dec-272">timeinterval *operador* double</span><span class="sxs-lookup"><span data-stu-id="97dec-272">timeinterval *operator* double</span></span> |<span data-ttu-id="97dec-273">*, /</span><span class="sxs-lookup"><span data-stu-id="97dec-273">*, /</span></span> |<span data-ttu-id="97dec-274">timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-274">timeinterval</span></span> |
| <span data-ttu-id="97dec-275">timeinterval *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="97dec-276">+, -</span><span class="sxs-lookup"><span data-stu-id="97dec-276">+, -</span></span> |<span data-ttu-id="97dec-277">timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-277">timeinterval</span></span> |
| <span data-ttu-id="97dec-278">timeinterval *operador* timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="97dec-279">timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-279">timestamp</span></span> |
| <span data-ttu-id="97dec-280">timestamp *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="97dec-281">timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-281">timestamp</span></span> |
| <span data-ttu-id="97dec-282">timestamp *operador* timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="97dec-283">timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-283">timeinterval</span></span> |
| <span data-ttu-id="97dec-284">*operador*double</span><span class="sxs-lookup"><span data-stu-id="97dec-284">*operator*double</span></span> |<span data-ttu-id="97dec-285">-, !</span><span class="sxs-lookup"><span data-stu-id="97dec-285">-, !</span></span> |<span data-ttu-id="97dec-286">double</span><span class="sxs-lookup"><span data-stu-id="97dec-286">double</span></span> |
| <span data-ttu-id="97dec-287">*operador*timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="97dec-288">timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-288">timeinterval</span></span> |
| <span data-ttu-id="97dec-289">double *operador* double</span><span class="sxs-lookup"><span data-stu-id="97dec-289">double *operator* double</span></span> |<span data-ttu-id="97dec-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="97dec-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="97dec-291">double</span><span class="sxs-lookup"><span data-stu-id="97dec-291">double</span></span> |
| <span data-ttu-id="97dec-292">string *operador* string</span><span class="sxs-lookup"><span data-stu-id="97dec-292">string *operator* string</span></span> |<span data-ttu-id="97dec-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="97dec-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="97dec-294">double</span><span class="sxs-lookup"><span data-stu-id="97dec-294">double</span></span> |
| <span data-ttu-id="97dec-295">timestamp *operador* timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="97dec-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="97dec-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="97dec-297">double</span><span class="sxs-lookup"><span data-stu-id="97dec-297">double</span></span> |
| <span data-ttu-id="97dec-298">timeinterval *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="97dec-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="97dec-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="97dec-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="97dec-300">double</span><span class="sxs-lookup"><span data-stu-id="97dec-300">double</span></span> |
| <span data-ttu-id="97dec-301">double *operador* double</span><span class="sxs-lookup"><span data-stu-id="97dec-301">double *operator* double</span></span> |<span data-ttu-id="97dec-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="97dec-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="97dec-303">double</span><span class="sxs-lookup"><span data-stu-id="97dec-303">double</span></span> |

<span data-ttu-id="97dec-304">Cuando se prueba un valor double con un operador ternario (`double ? statement1 : statement2`), el valor distinto de cero es **true** y cero es **false**.</span><span class="sxs-lookup"><span data-stu-id="97dec-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="97dec-305">Functions</span><span class="sxs-lookup"><span data-stu-id="97dec-305">Functions</span></span>
<span data-ttu-id="97dec-306">Estos predefinidos **funciones** están disponibles para toouse en la definición de una fórmula de escala automática.</span><span class="sxs-lookup"><span data-stu-id="97dec-306">These predefined **functions** are available for you toouse in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="97dec-307">Función</span><span class="sxs-lookup"><span data-stu-id="97dec-307">Function</span></span> | <span data-ttu-id="97dec-308">Tipo de valor devuelto</span><span class="sxs-lookup"><span data-stu-id="97dec-308">Return type</span></span> | <span data-ttu-id="97dec-309">Description</span><span class="sxs-lookup"><span data-stu-id="97dec-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="97dec-310">avg(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-310">avg(doubleVecList)</span></span> |<span data-ttu-id="97dec-311">double</span><span class="sxs-lookup"><span data-stu-id="97dec-311">double</span></span> |<span data-ttu-id="97dec-312">Devuelve Hola valor promedio de todos los valores de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-312">Returns hello average value for all values in hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-313">len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-313">len(doubleVecList)</span></span> |<span data-ttu-id="97dec-314">double</span><span class="sxs-lookup"><span data-stu-id="97dec-314">double</span></span> |<span data-ttu-id="97dec-315">Devuelve Hola longitud del vector de Hola que se crea a partir de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-315">Returns hello length of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-316">lg(double)</span><span class="sxs-lookup"><span data-stu-id="97dec-316">lg(double)</span></span> |<span data-ttu-id="97dec-317">double</span><span class="sxs-lookup"><span data-stu-id="97dec-317">double</span></span> |<span data-ttu-id="97dec-318">Devuelve Hola logaritmo en base 2 de hello dobles.</span><span class="sxs-lookup"><span data-stu-id="97dec-318">Returns hello log base 2 of hello double.</span></span> |
| <span data-ttu-id="97dec-319">lg(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-319">lg(doubleVecList)</span></span> |<span data-ttu-id="97dec-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-320">doubleVec</span></span> |<span data-ttu-id="97dec-321">Devuelve registros todos Hola base 2 de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-321">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="97dec-322">Un vec (Double) se debe pasar explícitamente para el parámetro hello.</span><span class="sxs-lookup"><span data-stu-id="97dec-322">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="97dec-323">En caso contrario, se supone la versión de lg(double) dobles de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-323">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="97dec-324">ln(double)</span><span class="sxs-lookup"><span data-stu-id="97dec-324">ln(double)</span></span> |<span data-ttu-id="97dec-325">double</span><span class="sxs-lookup"><span data-stu-id="97dec-325">double</span></span> |<span data-ttu-id="97dec-326">Devuelve Hola logaritmo natural de hello doble.</span><span class="sxs-lookup"><span data-stu-id="97dec-326">Returns hello natural log of hello double.</span></span> |
| <span data-ttu-id="97dec-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-327">ln(doubleVecList)</span></span> |<span data-ttu-id="97dec-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-328">doubleVec</span></span> |<span data-ttu-id="97dec-329">Devuelve registros todos Hola base 2 de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-329">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="97dec-330">Un vec (Double) se debe pasar explícitamente para el parámetro hello.</span><span class="sxs-lookup"><span data-stu-id="97dec-330">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="97dec-331">En caso contrario, se supone la versión de lg(double) dobles de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-331">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="97dec-332">log(double)</span><span class="sxs-lookup"><span data-stu-id="97dec-332">log(double)</span></span> |<span data-ttu-id="97dec-333">double</span><span class="sxs-lookup"><span data-stu-id="97dec-333">double</span></span> |<span data-ttu-id="97dec-334">Devuelve Hola logaritmo en base 10 de hello dobles.</span><span class="sxs-lookup"><span data-stu-id="97dec-334">Returns hello log base 10 of hello double.</span></span> |
| <span data-ttu-id="97dec-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-335">log(doubleVecList)</span></span> |<span data-ttu-id="97dec-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="97dec-336">doubleVec</span></span> |<span data-ttu-id="97dec-337">Devuelve registros todos hello en base 10 de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-337">Returns hello component-wise log base 10 of hello doubleVecList.</span></span> <span data-ttu-id="97dec-338">Un vec (Double) se debe pasar explícitamente para un parámetro double único Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-338">A vec(double) must be explicitly passed for hello single double parameter.</span></span> <span data-ttu-id="97dec-339">En caso contrario, se supone la versión de log(double) dobles de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-339">Otherwise, hello double log(double) version is assumed.</span></span> |
| <span data-ttu-id="97dec-340">max(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-340">max(doubleVecList)</span></span> |<span data-ttu-id="97dec-341">double</span><span class="sxs-lookup"><span data-stu-id="97dec-341">double</span></span> |<span data-ttu-id="97dec-342">Devuelve Hola valor máximo en doubleVecList Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-342">Returns hello maximum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-343">min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-343">min(doubleVecList)</span></span> |<span data-ttu-id="97dec-344">double</span><span class="sxs-lookup"><span data-stu-id="97dec-344">double</span></span> |<span data-ttu-id="97dec-345">Devuelve Hola valor mínimo de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-345">Returns hello minimum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-346">norm(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-346">norm(doubleVecList)</span></span> |<span data-ttu-id="97dec-347">double</span><span class="sxs-lookup"><span data-stu-id="97dec-347">double</span></span> |<span data-ttu-id="97dec-348">Devuelve Hola norma dos del vector de Hola que se crea a partir de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-348">Returns hello two-norm of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-349">percentile(doubleVec v, double p)</span><span class="sxs-lookup"><span data-stu-id="97dec-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="97dec-350">double</span><span class="sxs-lookup"><span data-stu-id="97dec-350">double</span></span> |<span data-ttu-id="97dec-351">Devuelve Hola elemento de percentil del vector de hello v.</span><span class="sxs-lookup"><span data-stu-id="97dec-351">Returns hello percentile element of hello vector v.</span></span> |
| <span data-ttu-id="97dec-352">rand()</span><span class="sxs-lookup"><span data-stu-id="97dec-352">rand()</span></span> |<span data-ttu-id="97dec-353">double</span><span class="sxs-lookup"><span data-stu-id="97dec-353">double</span></span> |<span data-ttu-id="97dec-354">Devuelve un valor aleatorio entre 0,0 y 1,0.</span><span class="sxs-lookup"><span data-stu-id="97dec-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="97dec-355">range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-355">range(doubleVecList)</span></span> |<span data-ttu-id="97dec-356">double</span><span class="sxs-lookup"><span data-stu-id="97dec-356">double</span></span> |<span data-ttu-id="97dec-357">Devuelve la diferencia de hello entre los valores máximo y mínimo de Hola de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-357">Returns hello difference between hello min and max values in hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-358">std(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-358">std(doubleVecList)</span></span> |<span data-ttu-id="97dec-359">double</span><span class="sxs-lookup"><span data-stu-id="97dec-359">double</span></span> |<span data-ttu-id="97dec-360">Devuelve Hola desviación estándar de muestra de los valores de hello en hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-360">Returns hello sample standard deviation of hello values in hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-361">stop()</span><span class="sxs-lookup"><span data-stu-id="97dec-361">stop()</span></span> | |<span data-ttu-id="97dec-362">Detiene la evaluación de expresión de escalado automático de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-362">Stops evaluation of hello autoscaling expression.</span></span> |
| <span data-ttu-id="97dec-363">sum(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="97dec-363">sum(doubleVecList)</span></span> |<span data-ttu-id="97dec-364">double</span><span class="sxs-lookup"><span data-stu-id="97dec-364">double</span></span> |<span data-ttu-id="97dec-365">Devuelve Hola suma de todos los componentes de Hola de hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="97dec-365">Returns hello sum of all hello components of hello doubleVecList.</span></span> |
| <span data-ttu-id="97dec-366">time(string dateTime="")</span><span class="sxs-lookup"><span data-stu-id="97dec-366">time(string dateTime="")</span></span> |<span data-ttu-id="97dec-367">timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-367">timestamp</span></span> |<span data-ttu-id="97dec-368">Devuelve marca de tiempo de Hola de hello hora actual si no hay parámetros se pasan u Hola marca de tiempo de la cadena de fecha y hora de hello si se pasa.</span><span class="sxs-lookup"><span data-stu-id="97dec-368">Returns hello time stamp of hello current time if no parameters are passed, or hello time stamp of hello dateTime string if it is passed.</span></span> <span data-ttu-id="97dec-369">Los formatos de dateTime compatibles son W3C-DTF y RFC 1123.</span><span class="sxs-lookup"><span data-stu-id="97dec-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="97dec-370">val(doubleVec v, double i)</span><span class="sxs-lookup"><span data-stu-id="97dec-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="97dec-371">double</span><span class="sxs-lookup"><span data-stu-id="97dec-371">double</span></span> |<span data-ttu-id="97dec-372">Devuelve el valor de hello del elemento hello en la posición i del vector v, con el índice inicial de cero.</span><span class="sxs-lookup"><span data-stu-id="97dec-372">Returns hello value of hello element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="97dec-373">Algunas de las funciones de Hola que se describen en la tabla anterior de hello pueden aceptar una lista como argumento.</span><span class="sxs-lookup"><span data-stu-id="97dec-373">Some of hello functions that are described in hello previous table can accept a list as an argument.</span></span> <span data-ttu-id="97dec-374">lista separada por comas de Hello es cualquier combinación de *doble* y *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="97dec-374">hello comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="97dec-375">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="97dec-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="97dec-376">Hola *doubleVecList* valor es convertido tooa único *doubleVec* antes de evaluación.</span><span class="sxs-lookup"><span data-stu-id="97dec-376">hello *doubleVecList* value is converted tooa single *doubleVec* before evaluation.</span></span> <span data-ttu-id="97dec-377">Por ejemplo, si `v = [1,2,3]`, a continuación, llamar a `avg(v)` es equivalente toocalling `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="97dec-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent toocalling `avg(1,2,3)`.</span></span> <span data-ttu-id="97dec-378">Al llamar a `avg(v, 7)` es equivalente toocalling `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="97dec-378">Calling `avg(v, 7)` is equivalent toocalling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="97dec-379"><a name="getsampledata"></a>Obtención de datos de ejemplo</span><span class="sxs-lookup"><span data-stu-id="97dec-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="97dec-380">Las fórmulas de Autoescala actúan en los datos de las métricas (ejemplos) proporcionada por hello servicio por lotes.</span><span class="sxs-lookup"><span data-stu-id="97dec-380">Autoscale formulas act on metrics data (samples) that is provided by hello Batch service.</span></span> <span data-ttu-id="97dec-381">Una fórmula aumenta o reduce el tamaño del grupo en función de los valores de hello que obtiene del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-381">A formula grows or shrinks pool size based on hello values that it obtains from hello service.</span></span> <span data-ttu-id="97dec-382">variables definidas por el servicio de Hola que se describieron anteriormente son objetos que proporcionan varios métodos tooaccess datos que está asociados a ese objeto.</span><span class="sxs-lookup"><span data-stu-id="97dec-382">hello service-defined variables that were described previously are objects that provide various methods tooaccess data that is associated with that object.</span></span> <span data-ttu-id="97dec-383">Por ejemplo, hello expresión siguiente muestra un saludo de solicitud tooget últimos cinco minutos de uso de CPU:</span><span class="sxs-lookup"><span data-stu-id="97dec-383">For example, hello following expression shows a request tooget hello last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="97dec-384">Método</span><span class="sxs-lookup"><span data-stu-id="97dec-384">Method</span></span> | <span data-ttu-id="97dec-385">Description</span><span class="sxs-lookup"><span data-stu-id="97dec-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="97dec-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="97dec-386">GetSample()</span></span> |<span data-ttu-id="97dec-387">Hola `GetSample()` método devuelve un vector de muestras de datos.</span><span class="sxs-lookup"><span data-stu-id="97dec-387">hello `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="97dec-388">Un ejemplo tiene un valor de 30 segundos de datos de métrica.</span><span class="sxs-lookup"><span data-stu-id="97dec-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="97dec-389">En otras palabras, las muestras se obtienen cada 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="97dec-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="97dec-390">Pero tal y como se indica a continuación, hay un retraso entre cuando se recopila una muestra y cuándo es fórmula tooa disponible.</span><span class="sxs-lookup"><span data-stu-id="97dec-390">But as noted below, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="97dec-391">Por lo tanto, puede que no todos los ejemplos durante un período de tiempo determinado estén disponibles para la evaluación a través de una fórmula.</span><span class="sxs-lookup"><span data-stu-id="97dec-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="97dec-392">Especifica el número de Hola de tooobtain de ejemplos de muestras más recientes de Hola que se han recopilado.</span><span class="sxs-lookup"><span data-stu-id="97dec-392">Specifies hello number of samples tooobtain from hello most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="97dec-393">`GetSample(1)`Devuelve la última muestra disponible de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-393">`GetSample(1)` returns hello last available sample.</span></span> <span data-ttu-id="97dec-394">Para las métricas como `$CPUPercent`, sin embargo, esto no se recomienda porque es imposible tooknow *cuando* recopiló el ejemplo hello.</span><span class="sxs-lookup"><span data-stu-id="97dec-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible tooknow *when* hello sample was collected.</span></span> <span data-ttu-id="97dec-395">Puede ser reciente o, debido a problemas del sistema, puede ser mucho más antiguo.</span><span class="sxs-lookup"><span data-stu-id="97dec-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="97dec-396">Es mejor en tal toouse casos un intervalo de tiempo, tal y como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="97dec-396">It is better in such cases toouse a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="97dec-397">Especifica un período de tiempo para recopilar datos de muestra.</span><span class="sxs-lookup"><span data-stu-id="97dec-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="97dec-398">Opcionalmente, especifica porcentaje Hola de ejemplos que deben estar disponibles en hello solicitó el período de tiempo.</span><span class="sxs-lookup"><span data-stu-id="97dec-398">Optionally, it also specifies hello percentage of samples that must be available in hello requested time frame.</span></span><br/><br/><span data-ttu-id="97dec-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`devolvería 20 muestras si están presentes en el historial de hello CPUPercent todos los ejemplos de hello últimos 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="97dec-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for hello last 10 minutes are present in hello CPUPercent history.</span></span> <span data-ttu-id="97dec-400">Sin embargo, si Hola último minuto de historial no estaba disponible, se devolvería sólo 18 ejemplos.</span><span class="sxs-lookup"><span data-stu-id="97dec-400">If hello last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="97dec-401">En este caso:</span><span class="sxs-lookup"><span data-stu-id="97dec-401">In this case:</span></span><br/><br/><span data-ttu-id="97dec-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`produciría un error porque solo el 90 por ciento de los ejemplos de hello están disponibles.</span><span class="sxs-lookup"><span data-stu-id="97dec-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of hello samples are available.</span></span><br/><br/><span data-ttu-id="97dec-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` se realizaría correctamente.</span><span class="sxs-lookup"><span data-stu-id="97dec-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="97dec-404">Especifica un período de tiempo para recopilar datos, con una hora de inicio y una hora de finalización.</span><span class="sxs-lookup"><span data-stu-id="97dec-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="97dec-405">Como se mencionó anteriormente, hay un retraso entre cuando se recopila una muestra y cuándo es fórmula tooa disponible.</span><span class="sxs-lookup"><span data-stu-id="97dec-405">As mentioned above, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="97dec-406">Tenga en cuenta este retraso al usar hello `GetSample` método.</span><span class="sxs-lookup"><span data-stu-id="97dec-406">Consider this delay when you use hello `GetSample` method.</span></span> <span data-ttu-id="97dec-407">Consulte `GetSamplePercent` a continuación.</span><span class="sxs-lookup"><span data-stu-id="97dec-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="97dec-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="97dec-408">GetSamplePeriod()</span></span> |<span data-ttu-id="97dec-409">Devuelve el período de Hola de muestras que se realizaron en un conjunto de datos de ejemplo históricos.</span><span class="sxs-lookup"><span data-stu-id="97dec-409">Returns hello period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="97dec-410">Count()</span><span class="sxs-lookup"><span data-stu-id="97dec-410">Count()</span></span> |<span data-ttu-id="97dec-411">Devuelve Hola número total de muestras en el historial de métricas de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-411">Returns hello total number of samples in hello metric history.</span></span> |
| <span data-ttu-id="97dec-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="97dec-412">HistoryBeginTime()</span></span> |<span data-ttu-id="97dec-413">Devuelve Hola marca de tiempo de muestra de datos disponibles más antigua de Hola de métrica de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-413">Returns hello time stamp of hello oldest available data sample for hello metric.</span></span> |
| <span data-ttu-id="97dec-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="97dec-414">GetSamplePercent()</span></span> |<span data-ttu-id="97dec-415">Devuelve Hola porcentaje de muestras que están disponibles para un intervalo de tiempo determinado.</span><span class="sxs-lookup"><span data-stu-id="97dec-415">Returns hello percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="97dec-416">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="97dec-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="97dec-417">Porque hello `GetSample` método produce un error si el porcentaje de Hola de muestras que se devuelve es menor que hello `samplePercent` especificado, puede usar hello `GetSamplePercent` método toocheck primero.</span><span class="sxs-lookup"><span data-stu-id="97dec-417">Because hello `GetSample` method fails if hello percentage of samples returned is less than hello `samplePercent` specified, you can use hello `GetSamplePercent` method toocheck first.</span></span> <span data-ttu-id="97dec-418">A continuación, puede realizar una acción alternativa si están presentes, suficientes muestras sin detener la evaluación de escala automática de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-418">Then you can perform an alternate action if insufficient samples are present, without halting hello automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-hello-getsample-method"></a><span data-ttu-id="97dec-419">Hola, porcentaje de ejemplo y ejemplos de *GetSample()* (método)</span><span class="sxs-lookup"><span data-stu-id="97dec-419">Samples, sample percentage, and hello *GetSample()* method</span></span>
<span data-ttu-id="97dec-420">funcionamiento básico de Hola de una fórmula de Autoescala es tooobtain datos métricos tareas y recursos y, a continuación, ajustar el tamaño de grupo basado en esos datos.</span><span class="sxs-lookup"><span data-stu-id="97dec-420">hello core operation of an autoscale formula is tooobtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="97dec-421">Por lo tanto, es importante toohave una idea clara de cómo las fórmulas de Autoescala interactúan con datos de métricas (ejemplos).</span><span class="sxs-lookup"><span data-stu-id="97dec-421">As such, it is important toohave a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="97dec-422">**Ejemplos**</span><span class="sxs-lookup"><span data-stu-id="97dec-422">**Samples**</span></span>

<span data-ttu-id="97dec-423">Hola servicio por lotes periódicamente toma muestras de métricas de tareas y recursos y hace que las fórmulas de Autoescala de tooyour disponible.</span><span class="sxs-lookup"><span data-stu-id="97dec-423">hello Batch service periodically takes samples of task and resource metrics and makes them available tooyour autoscale formulas.</span></span> <span data-ttu-id="97dec-424">Estos ejemplos se registran cada 30 segundos Hola servicio por lotes.</span><span class="sxs-lookup"><span data-stu-id="97dec-424">These samples are recorded every 30 seconds by hello Batch service.</span></span> <span data-ttu-id="97dec-425">Sin embargo, suele haber un retraso entre cuando se registraron esos ejemplos y cuando se ponen a disposición demasiado (y puede ser leídos por) las fórmulas de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-425">However, there is typically a delay between when those samples were recorded and when they are made available too(and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="97dec-426">Además, debido a factores toovarious como red u otros problemas de infraestructura, ejemplos no se pueden grabar para un intervalo determinado.</span><span class="sxs-lookup"><span data-stu-id="97dec-426">Additionally, due toovarious factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="97dec-427">**Porcentaje de muestras**</span><span class="sxs-lookup"><span data-stu-id="97dec-427">**Sample percentage**</span></span>

<span data-ttu-id="97dec-428">Cuando `samplePercent` se pasa toohello `GetSample()` método o hello `GetSamplePercent()` método se llama, _por ciento_ hace referencia tooa comparación entre el número total de posibles Hola de muestras que se registran en hello servicio por lotes y número de Hola de ejemplos de fórmula de Autoescala tooyour disponible.</span><span class="sxs-lookup"><span data-stu-id="97dec-428">When `samplePercent` is passed toohello `GetSample()` method or hello `GetSamplePercent()` method is called, _percent_ refers tooa comparison between hello total possible number of samples that are recorded by hello Batch service and hello number of samples that are available tooyour autoscale formula.</span></span>

<span data-ttu-id="97dec-429">Echemos un vistazo a un intervalo de tiempo de 10 minutos como ejemplo.</span><span class="sxs-lookup"><span data-stu-id="97dec-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="97dec-430">Como ejemplos se registran cada 30 segundos dentro de un intervalo de tiempo de 10 minutos, número total máximo de Hola de muestras que se registran por lote sería 20 muestras (2 por minuto).</span><span class="sxs-lookup"><span data-stu-id="97dec-430">Because samples are recorded every 30 seconds within a 10-minute timespan, hello maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="97dec-431">Sin embargo, debido a toohello latencia inherente de hello reporting mecanismo y otros problemas dentro de Azure, puede haber solo 15 ejemplos de fórmula de Autoescala tooyour disponibles para su lectura.</span><span class="sxs-lookup"><span data-stu-id="97dec-431">However, due toohello inherent latency of hello reporting mechanism and other issues within Azure, there may be only 15 samples that are available tooyour autoscale formula for reading.</span></span> <span data-ttu-id="97dec-432">Por lo tanto, por ejemplo, durante ese período de 10 minutos, sólo el 75% del número total de Hola de muestras que se registran puede ser fórmula tooyour disponible.</span><span class="sxs-lookup"><span data-stu-id="97dec-432">So, for example, for that 10-minute period, only 75% of hello total number of samples recorded may be available tooyour formula.</span></span>

<span data-ttu-id="97dec-433">**GetSample() e intervalos de muestra**</span><span class="sxs-lookup"><span data-stu-id="97dec-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="97dec-434">Las fórmulas de escalado automático son continuo toobe creciendo y reducir las agrupaciones de &mdash; agregar nodos o quitar nodos.</span><span class="sxs-lookup"><span data-stu-id="97dec-434">Your autoscale formulas are going toobe growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="97dec-435">Como nodos cuestan dinero, es conveniente tooensure que las fórmulas utilizan un método de análisis que se basa en datos suficientes inteligente.</span><span class="sxs-lookup"><span data-stu-id="97dec-435">Because nodes cost you money, you want tooensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="97dec-436">Por lo tanto, recomendamos que use un análisis de tipo tendencias en las fórmulas.</span><span class="sxs-lookup"><span data-stu-id="97dec-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="97dec-437">Este tipo aumenta y reduce los grupos basándose en un intervalo de ejemplos recopilados.</span><span class="sxs-lookup"><span data-stu-id="97dec-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="97dec-438">por lo tanto, use toodo `GetSample(interval look-back start, interval look-back end)` tooreturn un vector de muestras:</span><span class="sxs-lookup"><span data-stu-id="97dec-438">toodo so, use `GetSample(interval look-back start, interval look-back end)` tooreturn a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="97dec-439">Cuando se evalúa Hola por encima de la línea de proceso por lotes, devuelve un intervalo de muestras como un vector de valores.</span><span class="sxs-lookup"><span data-stu-id="97dec-439">When hello above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="97dec-440">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="97dec-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="97dec-441">Una vez que haya recopilado vector Hola de muestras, a continuación, puede usar funciones como `min()`, `max()`, y `avg()` tooderive valores significativos de hello recopilan intervalo.</span><span class="sxs-lookup"><span data-stu-id="97dec-441">Once you've collected hello vector of samples, you can then use functions like `min()`, `max()`, and `avg()` tooderive meaningful values from hello collected range.</span></span>

<span data-ttu-id="97dec-442">Para obtener seguridad adicional, puede forzar una toofail de evaluación de fórmulas si menor que un determinado porcentaje de ejemplo está disponible durante un período de tiempo determinado.</span><span class="sxs-lookup"><span data-stu-id="97dec-442">For additional security, you can force a formula evaluation toofail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="97dec-443">Cuando se fuerza un toofail de evaluación de fórmulas, indicar toocease de lote más evaluación de la fórmula de hello si Hola especifica el porcentaje de muestras no está disponible.</span><span class="sxs-lookup"><span data-stu-id="97dec-443">When you force a formula evaluation toofail, you instruct Batch toocease further evaluation of hello formula if hello specified percentage of samples is not available.</span></span> <span data-ttu-id="97dec-444">En este caso, el tamaño del grupo de toohello se realiza ningún cambio.</span><span class="sxs-lookup"><span data-stu-id="97dec-444">In this case, no change is made toohello pool size.</span></span> <span data-ttu-id="97dec-445">toospecify un porcentaje de muestras para toosucceed de evaluación de hello, necesario especificarla como Hola tercer parámetro demasiado`GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="97dec-445">toospecify a required percentage of samples for hello evaluation toosucceed, specify it as hello third parameter too`GetSample()`.</span></span> <span data-ttu-id="97dec-446">En este caso, se especifica un requisito del 75 por ciento de muestras:</span><span class="sxs-lookup"><span data-stu-id="97dec-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="97dec-447">Dado que puede haber un retraso en la disponibilidad de ejemplo, es importante tooalways especifique un intervalo de tiempo con una hora de inicio de la devolución de la apariencia que es anterior a un minuto.</span><span class="sxs-lookup"><span data-stu-id="97dec-447">Because there may be a delay in sample availability, it is important tooalways specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="97dec-448">Tarda aproximadamente un minuto para toopropagate ejemplos a través del sistema de hello, por lo que ejemplos en el intervalo de hello `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` no estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="97dec-448">It takes approximately one minute for samples toopropagate through hello system, so samples in hello range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="97dec-449">Nuevo, puede usar el parámetro de porcentaje de hello de `GetSample()` tooforce un requisito de porcentaje de ejemplo concreto.</span><span class="sxs-lookup"><span data-stu-id="97dec-449">Again, you can use hello percentage parameter of `GetSample()` tooforce a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="97dec-450">Es **muy recomendable** que **evite confiar *solo* en**  en las fórmulas de escalado automático`GetSample(1)`.</span><span class="sxs-lookup"><span data-stu-id="97dec-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="97dec-451">Esto es porque `GetSample(1)` esencialmente dice servicio por lotes de toohello, "Dar me Hola última muestra tiene, no importa cuánto tiempo hace que recuperó."</span><span class="sxs-lookup"><span data-stu-id="97dec-451">This is because `GetSample(1)` essentially says toohello Batch service, "Give me hello last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="97dec-452">Dado que es solo una muestra única, y puede ser un ejemplo anterior, no puede ser representativos de imágenes más grandes de Hola de tareas recientes o estado del recurso.</span><span class="sxs-lookup"><span data-stu-id="97dec-452">Since it is only a single sample, and it may be an older sample, it may not be representative of hello larger picture of recent task or resource state.</span></span> <span data-ttu-id="97dec-453">Si usa `GetSample(1)`, asegúrese de que es parte de una instrucción mayor y no Hola punto de datos que depende de la fórmula.</span><span class="sxs-lookup"><span data-stu-id="97dec-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not hello only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="97dec-454">Métricas</span><span class="sxs-lookup"><span data-stu-id="97dec-454">Metrics</span></span>
<span data-ttu-id="97dec-455">Puede usar tanto métricas de recurso como de tarea al definir una fórmula.</span><span class="sxs-lookup"><span data-stu-id="97dec-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="97dec-456">Ajustar el número de destino de Hola de dedicado nodos grupo de hello basado en datos de métricas de Hola que recibe y evaluar.</span><span class="sxs-lookup"><span data-stu-id="97dec-456">You adjust hello target number of dedicated nodes in hello pool based on hello metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="97dec-457">Vea hello [Variables](#variables) sección anterior para obtener más información sobre cada métrica.</span><span class="sxs-lookup"><span data-stu-id="97dec-457">See hello [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="97dec-458">Métrica</span><span class="sxs-lookup"><span data-stu-id="97dec-458">Metric</span></span></th>
    <th><span data-ttu-id="97dec-459">Descripción</span><span class="sxs-lookup"><span data-stu-id="97dec-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="97dec-460"><b>Recurso</b></span><span class="sxs-lookup"><span data-stu-id="97dec-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="97dec-461">Métricas de recursos se basan en hello CPU, el ancho de banda de hello, el uso de memoria de Hola de nodos de proceso y Hola número de nodos.</span><span class="sxs-lookup"><span data-stu-id="97dec-461">Resource metrics are based on hello CPU, hello bandwidth, hello memory usage of compute nodes, and hello number of nodes.</span></span></p>
        <p> <span data-ttu-id="97dec-462">Estas variables definidas por el servicio se usan para realizar ajustes basados en el número de nodos:</span><span class="sxs-lookup"><span data-stu-id="97dec-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="97dec-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="97dec-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="97dec-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="97dec-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="97dec-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="97dec-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="97dec-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="97dec-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="97dec-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="97dec-469">Estas variables definidas por el servicio se usan para realizar ajustes basados en el uso de recursos de nodo:</span><span class="sxs-lookup"><span data-stu-id="97dec-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="97dec-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="97dec-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="97dec-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="97dec-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="97dec-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="97dec-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="97dec-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="97dec-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="97dec-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="97dec-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="97dec-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="97dec-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="97dec-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="97dec-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="97dec-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="97dec-480"><b>Task</b></span><span class="sxs-lookup"><span data-stu-id="97dec-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="97dec-481">Las métricas de la tarea se basan en estado de Hola de tareas, como por ejemplo activo, pendiente y completadas.</span><span class="sxs-lookup"><span data-stu-id="97dec-481">Task metrics are based on hello status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="97dec-482">Hello siguientes variables definidas por el servicio son útiles para realizar ajustes de tamaño del grupo según las métricas de tarea:</span><span class="sxs-lookup"><span data-stu-id="97dec-482">hello following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="97dec-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="97dec-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="97dec-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="97dec-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="97dec-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="97dec-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="97dec-488">Escritura de una fórmula de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-488">Write an autoscale formula</span></span>
<span data-ttu-id="97dec-489">Crear una fórmula de Autoescala que forman las instrucciones que utilizan Hola por encima de los componentes y luego combinar estas instrucciones en una fórmula completa.</span><span class="sxs-lookup"><span data-stu-id="97dec-489">You build an autoscale formula by forming statements that use hello above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="97dec-490">En esta sección vamos a crear una fórmula de escalado automático de ejemplo que puede tomar algunas decisiones reales de escalado.</span><span class="sxs-lookup"><span data-stu-id="97dec-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="97dec-491">En primer lugar, vamos a definir los requisitos de hello para la nueva fórmula de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-491">First, let's define hello requirements for our new autoscale formula.</span></span> <span data-ttu-id="97dec-492">fórmula de Hello debe:</span><span class="sxs-lookup"><span data-stu-id="97dec-492">hello formula should:</span></span>

1. <span data-ttu-id="97dec-493">Aumentar el número de destino de Hola de nodos de cálculo específico en un grupo si el uso de CPU es alto.</span><span class="sxs-lookup"><span data-stu-id="97dec-493">Increase hello target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="97dec-494">Reduzca el número de destino de Hola de nodos de cálculo específico en un grupo cuando el uso de CPU es bajo.</span><span class="sxs-lookup"><span data-stu-id="97dec-494">Decrease hello target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="97dec-495">Siempre restringir el número máximo de Hola de too400 nodos dedicado.</span><span class="sxs-lookup"><span data-stu-id="97dec-495">Always restrict hello maximum number of dedicated nodes too400.</span></span>

<span data-ttu-id="97dec-496">número de hello tooincrease de nodos durante el uso elevado de CPU, defina la instrucción de Hola que rellena una variable definida por el usuario (`$totalDedicatedNodes`) con un valor que es 110 por ciento del número de destino actual de Hola de nodos dedicados, pero solo si Hola mínimo uso medio de CPU últimos 10 minutos era por encima del 70 por ciento durante Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-496">tooincrease hello number of nodes during high CPU usage, define hello statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of hello current target number of dedicated nodes, but only if hello minimum average CPU usage during hello last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="97dec-497">En caso contrario, utilice el valor de hello para el número actual de Hola de nodos dedicados.</span><span class="sxs-lookup"><span data-stu-id="97dec-497">Otherwise, use hello value for hello current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="97dec-498">demasiado*disminuir* Hola número de nodos dedicados durante el uso de CPU bajo, Hola Next en nuestro Hola conjuntos fórmulas mismo `$totalDedicatedNodes` por ciento de variable too90 del número de destino actual de Hola de nodos dedicados si hello promedio de uso de CPU Hola últimos 60 minutos en fue 20 por ciento.</span><span class="sxs-lookup"><span data-stu-id="97dec-498">too*decrease* hello number of dedicated nodes during low CPU usage, hello next statement in our formula sets hello same `$totalDedicatedNodes` variable too90 percent of hello current target number of dedicated nodes if hello average CPU usage in hello past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="97dec-499">En caso contrario, usar el valor actual de Hola de `$totalDedicatedNodes` que se rellena en la instrucción de hello anterior.</span><span class="sxs-lookup"><span data-stu-id="97dec-499">Otherwise, use hello current value of `$totalDedicatedNodes` that we populated in hello statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="97dec-500">Ahora limitar número de destino de Hola de máximo de tooa de nodos de proceso dedicado de 400:</span><span class="sxs-lookup"><span data-stu-id="97dec-500">Now limit hello target number of dedicated compute nodes tooa maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="97dec-501">Esta es la fórmula completa de hello:</span><span class="sxs-lookup"><span data-stu-id="97dec-501">Here's hello complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="97dec-502">Crear un grupo habilitado para el escalado automático con .NET</span><span class="sxs-lookup"><span data-stu-id="97dec-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="97dec-503">toocreate un grupo con Autoescala habilitada en. NET, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="97dec-503">toocreate a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="97dec-504">Crear grupo de hello con [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="97dec-504">Create hello pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="97dec-505">Conjunto hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) propiedad demasiado`true`.</span><span class="sxs-lookup"><span data-stu-id="97dec-505">Set hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property too`true`.</span></span>
3. <span data-ttu-id="97dec-506">Conjunto hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) propiedad con la fórmula de Autoescala.</span><span class="sxs-lookup"><span data-stu-id="97dec-506">Set hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="97dec-507">(Opcional) Conjunto hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) propiedad (el valor predeterminado es 15 minutos).</span><span class="sxs-lookup"><span data-stu-id="97dec-507">(Optional) Set hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="97dec-508">Confirmar el grupo de hello con [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) o [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="97dec-508">Commit hello pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="97dec-509">Hello fragmento de código siguiente crea un grupo de escalado automático habilitado en. NET.</span><span class="sxs-lookup"><span data-stu-id="97dec-509">hello following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="97dec-510">Hello fórmula de Autoescala del grupo establece Hola destino número de nodos dedicado too5 lunes y 1 en todos los días de la semana de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-510">hello pool's autoscale formula sets hello target number of dedicated nodes too5 on Mondays, and 1 on every other day of hello week.</span></span> <span data-ttu-id="97dec-511">Hola [intervalo de ajuste de escala automático](#automatic-scaling-interval) es establecer too30 minutos.</span><span class="sxs-lookup"><span data-stu-id="97dec-511">hello [automatic scaling interval](#automatic-scaling-interval) is set too30 minutes.</span></span> <span data-ttu-id="97dec-512">En esta y Hola otros fragmentos de código C# en este artículo, `myBatchClient` es una instancia inicializada correctamente de hello [BatchClient] [ net_batchclient] clase.</span><span class="sxs-lookup"><span data-stu-id="97dec-512">In this and hello other C# snippets in this article, `myBatchClient` is a properly initialized instance of hello [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="97dec-513">Cuando se crea un grupo de escalado automático habilitado, no especifique hello _targetDedicatedComputeNodes_ parámetro o hello _targetLowPriorityComputeNodes_ parámetro en hello llamada demasiado **CreatePool**.</span><span class="sxs-lookup"><span data-stu-id="97dec-513">When you create an autoscale-enabled pool, do not specify hello _targetDedicatedComputeNodes_ parameter or hello _targetLowPriorityComputeNodes_ parameter on hello call too**CreatePool**.</span></span> <span data-ttu-id="97dec-514">En su lugar, especifique hello **AutoScaleEnabled** y **AutoScaleFormula** propiedades de grupo de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-514">Instead, specify hello **AutoScaleEnabled** and **AutoScaleFormula** properties on hello pool.</span></span> <span data-ttu-id="97dec-515">valores de Hello para estas propiedades determinan número de destino de Hola de cada tipo de nodo.</span><span class="sxs-lookup"><span data-stu-id="97dec-515">hello values for these properties determine hello target number of each type of node.</span></span> <span data-ttu-id="97dec-516">Además, toomanually cambiar el tamaño de un grupo de escalado automático habilitado (por ejemplo, con [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), primero **deshabilitar** el escalado automático en Hola de grupo y, a continuación, cambiar su tamaño.</span><span class="sxs-lookup"><span data-stu-id="97dec-516">Also, toomanually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on hello pool, then resize it.</span></span>
>
>

<span data-ttu-id="97dec-517">Además tooBatch. NET, puede usar cualquiera de hello otro [SDK de lote](batch-apis-tools.md#azure-accounts-for-batch-development), [REST de lote](https://docs.microsoft.com/rest/api/batchservice/), [cmdlets de PowerShell lote](batch-powershell-cmdlets-get-started.md), hello y [lote CLI](batch-cli-get-started.md)tooconfigure Autoescala.</span><span class="sxs-lookup"><span data-stu-id="97dec-517">In addition tooBatch .NET, you can use any of hello other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and hello [Batch CLI](batch-cli-get-started.md) tooconfigure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="97dec-518">Intervalo de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-518">Automatic scaling interval</span></span>
<span data-ttu-id="97dec-519">De forma predeterminada, Hola servicio por lotes ajusta el tamaño de la agrupación según la fórmula de Autoescala de tooits cada 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="97dec-519">By default, hello Batch service adjusts a pool's size according tooits autoscale formula every 15 minutes.</span></span> <span data-ttu-id="97dec-520">Este intervalo es configurable mediante el uso de hello propiedades de grupo siguientes:</span><span class="sxs-lookup"><span data-stu-id="97dec-520">This interval is configurable by using hello following pool properties:</span></span>

* <span data-ttu-id="97dec-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (.NET para Batch)</span><span class="sxs-lookup"><span data-stu-id="97dec-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="97dec-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (API de REST)</span><span class="sxs-lookup"><span data-stu-id="97dec-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="97dec-523">intervalo mínimo de Hello es de cinco minutos y Hola máximo es 168 horas.</span><span class="sxs-lookup"><span data-stu-id="97dec-523">hello minimum interval is five minutes, and hello maximum is 168 hours.</span></span> <span data-ttu-id="97dec-524">Si se especifica un intervalo fuera de este intervalo, Hola servicio por lotes devuelve un error de solicitud incorrecta (400).</span><span class="sxs-lookup"><span data-stu-id="97dec-524">If an interval outside this range is specified, hello Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="97dec-525">Escalado automático no está previsto actualmente toorespond toochanges en menos de un minuto, pero en su lugar es diseñado tooadjust tamaño de Hola de su grupo gradualmente como ejecutar una carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="97dec-525">Autoscaling is not currently intended toorespond toochanges in less than a minute, but rather is intended tooadjust hello size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="97dec-526">Habilitación del escalado automático en un grupo existente</span><span class="sxs-lookup"><span data-stu-id="97dec-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="97dec-527">Cada lote SDK proporciona una escala de tooenable de forma automática.</span><span class="sxs-lookup"><span data-stu-id="97dec-527">Each Batch SDK provides a way tooenable autoscaling.</span></span> <span data-ttu-id="97dec-528">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="97dec-528">For example:</span></span>

* <span data-ttu-id="97dec-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span><span class="sxs-lookup"><span data-stu-id="97dec-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="97dec-530">[Activar la escala automática en un grupo de servidores][rest_enableautoscale] (API de REST)</span><span class="sxs-lookup"><span data-stu-id="97dec-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="97dec-531">Cuando se habilita el escalado automático en un grupo existente, tenga en Hola de cuenta siguientes puntos:</span><span class="sxs-lookup"><span data-stu-id="97dec-531">When you enable autoscaling on an existing pool, keep in mind hello following points:</span></span>

* <span data-ttu-id="97dec-532">Si el escalado automático está deshabilitado actualmente en el grupo de Hola al emitir Hola solicitud tooenable Autoescala, debe especificar una fórmula de Autoescala válido cuando se emite la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="97dec-532">If automatic scaling is currently disabled on hello pool when you issue hello request tooenable autoscaling, you must specify a valid autoscale formula when you issue hello request.</span></span> <span data-ttu-id="97dec-533">También puede especificar un intervalo de evaluación de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="97dec-534">Si no especifica un intervalo, se utiliza el valor predeterminado de Hola de 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="97dec-534">If you do not specify an interval, hello default value of 15 minutes is used.</span></span>
* <span data-ttu-id="97dec-535">Si el escalado automático está habilitada en el grupo de hello, puede especificar una fórmula de Autoescala, un intervalo de evaluación o ambos.</span><span class="sxs-lookup"><span data-stu-id="97dec-535">If autoscale is currently enabled on hello pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="97dec-536">Debe especificar al menos una de estas propiedades.</span><span class="sxs-lookup"><span data-stu-id="97dec-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="97dec-537">Si especifica un nuevo intervalo de evaluación de escalado automático, a continuación, se detiene la programación de evaluación de hello existente y se inicia una nueva programación.</span><span class="sxs-lookup"><span data-stu-id="97dec-537">If you specify a new autoscale evaluation interval, then hello existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="97dec-538">hora de inicio de la nueva programación de Hello es hora de Hola a qué Hola se emitió solicitud tooenable Autoescala.</span><span class="sxs-lookup"><span data-stu-id="97dec-538">hello new schedule's start time is hello time at which hello request tooenable autoscaling was issued.</span></span>
  * <span data-ttu-id="97dec-539">Si se omite cualquier intervalo de fórmula o evaluación de escalado automático de hello, Hola servicio por lotes continúa valor actual de toouse Hola de dicha configuración.</span><span class="sxs-lookup"><span data-stu-id="97dec-539">If you omit either hello autoscale formula or evaluation interval, hello Batch service continues toouse hello current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="97dec-540">Si especifica valores para hello *targetDedicatedComputeNodes* o *targetLowPriorityComputeNodes* parámetros de hello **CreatePool** método cuando creaste Hola bloque en. NET, o para los parámetros comparables de hello en otro idioma, a continuación, esos valores se omiten cuando se evalúa la fórmula de escala automática Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-540">If you specified values for hello *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of hello **CreatePool** method when you created hello pool in .NET, or for hello comparable parameters in another language, then those values are ignored when hello automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="97dec-541">Este fragmento de código de C# utiliza hello [.NET de lotes] [ net_api] biblioteca tooenable Autoescala en un grupo existente:</span><span class="sxs-lookup"><span data-stu-id="97dec-541">This C# code snippet uses hello [Batch .NET][net_api] library tooenable autoscaling on an existing pool:</span></span>

```csharp
// Define hello autoscaling formula. This formula sets hello target number of nodes
// too5 on Mondays, and 1 on every other day of hello week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set hello autoscale formula on hello existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="97dec-542">Actualización de una fórmula de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-542">Update an autoscale formula</span></span>

<span data-ttu-id="97dec-543">fórmula de hello tooupdate en un grupo existente de escalado automático habilitado, llamada Hola operación tooenable Autoescala nuevo con la nueva fórmula de saludo.</span><span class="sxs-lookup"><span data-stu-id="97dec-543">tooupdate hello formula on an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new formula.</span></span> <span data-ttu-id="97dec-544">Por ejemplo, si ya está habilitado el escalado automático en `myexistingpool` cuando Hola siguiente código de .NET se ejecuta, su fórmula de Autoescala se reemplaza con contenido de Hola de `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="97dec-544">For example, if autoscaling is already enabled on `myexistingpool` when hello following .NET code is executed, its autoscale formula is replaced with hello contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-hello-autoscale-interval"></a><span data-ttu-id="97dec-545">Intervalo de actualización Hola escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-545">Update hello autoscale interval</span></span>

<span data-ttu-id="97dec-546">tooupdate el intervalo de evaluación de escalado automático de saludo de un grupo existente de escalado automático habilitado, llamada Hola operación tooenable Autoescala nuevo con el nuevo intervalo de saludo.</span><span class="sxs-lookup"><span data-stu-id="97dec-546">tooupdate hello autoscale evaluation interval of an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new interval.</span></span> <span data-ttu-id="97dec-547">Por ejemplo, tooset Hola escalado automático evaluación intervalo too60 minutos para un grupo que ya está habilitada para el escalado automático en. NET:</span><span class="sxs-lookup"><span data-stu-id="97dec-547">For example, tooset hello autoscale evaluation interval too60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="97dec-548">Evaluación de una fórmula de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="97dec-549">Puede evaluar una fórmula antes de aplicarla tooa grupo.</span><span class="sxs-lookup"><span data-stu-id="97dec-549">You can evaluate a formula before applying it tooa pool.</span></span> <span data-ttu-id="97dec-550">De esta manera, puede probar hello toosee fórmulas cómo sus instrucciones evaluación antes de poner fórmula hello en producción.</span><span class="sxs-lookup"><span data-stu-id="97dec-550">In this way, you can test hello formula toosee how its statements evaluate before you put hello formula into production.</span></span>

<span data-ttu-id="97dec-551">tooevaluate una fórmula de Autoescala, primero debe habilitar la escala automática en el grupo de hello con una fórmula válida.</span><span class="sxs-lookup"><span data-stu-id="97dec-551">tooevaluate an autoscale formula, you must first enable autoscaling on hello pool with a valid formula.</span></span> <span data-ttu-id="97dec-552">tootest una fórmula en un grupo que no tiene todavía escalado automático habilitado, utilice Hola una línea fórmula `$TargetDedicatedNodes = 0` cuando se habilita escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-552">tootest a formula on a pool that doesn't yet have autoscaling enabled, use hello one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="97dec-553">A continuación, use uno de hello después de la fórmula de hello tooevaluate desea tootest:</span><span class="sxs-lookup"><span data-stu-id="97dec-553">Then, use one of hello following tooevaluate hello formula you want tootest:</span></span>

* <span data-ttu-id="97dec-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) o [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="97dec-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="97dec-555">Estos métodos de .NET de lotes requieren Id. de Hola de un grupo existente y una cadena que contiene tooevaluate de fórmula de escalado automático de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-555">These Batch .NET methods require hello ID of an existing pool and a string containing hello autoscale formula tooevaluate.</span></span>

* [<span data-ttu-id="97dec-556">Evaluación de una fórmula de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="97dec-557">En esta solicitud de API de REST, especifique el Id. de grupo de Hola Hola URI y Hola fórmula de Autoescala en hello *autoScaleFormula* elemento Hola del cuerpo de solicitud.</span><span class="sxs-lookup"><span data-stu-id="97dec-557">In this REST API request, specify hello pool ID in hello URI, and hello autoscale formula in hello *autoScaleFormula* element of hello request body.</span></span> <span data-ttu-id="97dec-558">respuesta de Hola de operación de hello contiene cualquier información de error que podría ser fórmula toohello relacionados.</span><span class="sxs-lookup"><span data-stu-id="97dec-558">hello response of hello operation contains any error information that might be related toohello formula.</span></span>

<span data-ttu-id="97dec-559">En este fragmento de código de [Batch .NET][net_api] se evalúa una fórmula de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="97dec-560">Si el grupo de hello no tiene Autoescala habilitada, hemos habilitar primero.</span><span class="sxs-lookup"><span data-stu-id="97dec-560">If hello pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference tooan existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on hello pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula tooenable autoscaling on the
    // pool. This formula is valid, but won't resize hello pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls tooonce every 30 seconds.
    // Because we want tooapply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here tooensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh hello properties of hello pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on hello pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // hello formula tooevaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform hello autoscale formula evaluation. Note that this code does not
    // actually apply hello formula toohello pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print hello results of hello AutoScaleRun.
        // This will display hello values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply hello formula toohello pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output hello message associated with hello error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="97dec-561">Evaluación correcta de la fórmula de saludo que se muestra en este fragmento de código produce resultados similares a:</span><span class="sxs-lookup"><span data-stu-id="97dec-561">Successful evaluation of hello formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="97dec-562">Obtención de información sobre la ejecución del escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-562">Get information about autoscale runs</span></span>

<span data-ttu-id="97dec-563">tooensure que está realizando la fórmula como se esperaba, se recomienda que compruebe periódicamente los resultados de Hola de ejecuciones de escalado automático de Hola que lleva a cabo en el grupo de lote.</span><span class="sxs-lookup"><span data-stu-id="97dec-563">tooensure that your formula is performing as expected, we recommend that you periodically check hello results of hello autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="97dec-564">toodo por lo tanto, get (o actualizar) un toohello de referencia de grupo y examinar las propiedades de Hola de su última ejecución de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="97dec-564">toodo so, get (or refresh) a reference toohello pool, and examine hello properties of its last autoscale run.</span></span>

<span data-ttu-id="97dec-565">En .NET de lote, Hola [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) propiedad tiene varias propiedades que proporcionan información sobre hello más reciente el escalado automático ejecutarlo realizadas en el grupo de hello:</span><span class="sxs-lookup"><span data-stu-id="97dec-565">In Batch .NET, hello [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about hello latest automatic scaling run performed on hello pool:</span></span>

* [<span data-ttu-id="97dec-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="97dec-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="97dec-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="97dec-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="97dec-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="97dec-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="97dec-569">Hola API de REST, Hola [obtener información acerca de un grupo](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) solicitud devuelve información sobre el grupo de hello, que incluye hello más reciente el escalado automático ejecuten información en hello [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) propiedad.</span><span class="sxs-lookup"><span data-stu-id="97dec-569">In hello REST API, hello [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about hello pool, which includes hello latest automatic scaling run information in hello [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="97dec-570">Hello siguiente fragmento de código de C# utiliza la Hola .NET de lote biblioteca tooprint información acerca Hola los ejecutarlo en grupo de escalado automático última _myPool_:</span><span class="sxs-lookup"><span data-stu-id="97dec-570">hello following C# code snippet uses hello Batch .NET library tooprint information about hello last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="97dec-571">Resultados del ejemplo de Hola anterior fragmento de código:</span><span class="sxs-lookup"><span data-stu-id="97dec-571">Sample output of hello preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="97dec-572">Ejemplo de fórmulas de escalado automático</span><span class="sxs-lookup"><span data-stu-id="97dec-572">Example autoscale formulas</span></span>
<span data-ttu-id="97dec-573">Echemos un vistazo a algunas fórmulas que muestran la cantidad de hello tooadjust de maneras diferentes de los recursos de proceso en un grupo.</span><span class="sxs-lookup"><span data-stu-id="97dec-573">Let's look at a few formulas that show different ways tooadjust hello amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="97dec-574">Ejemplo 1: Ajuste basado en la fecha y hora</span><span class="sxs-lookup"><span data-stu-id="97dec-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="97dec-575">Imagine que desea el tamaño del grupo de hello tooadjust según Hola día de semana de Hola y la hora del día.</span><span class="sxs-lookup"><span data-stu-id="97dec-575">Suppose you want tooadjust hello pool size based on hello day of hello week and time of day.</span></span> <span data-ttu-id="97dec-576">Este ejemplo muestra cómo tooincrease o disminuir el número de Hola de nodos de hello grupo según corresponda.</span><span class="sxs-lookup"><span data-stu-id="97dec-576">This example shows how tooincrease or decrease hello number of nodes in hello pool accordingly.</span></span>

<span data-ttu-id="97dec-577">fórmula de Hello obtiene primero Hola hora actual.</span><span class="sxs-lookup"><span data-stu-id="97dec-577">hello formula first obtains hello current time.</span></span> <span data-ttu-id="97dec-578">Si es un día de la semana (1-5) y dentro del horario laboral (8 A.M. too6 PM), tamaño del grupo de destino de Hola se establece too20 nodos.</span><span class="sxs-lookup"><span data-stu-id="97dec-578">If it's a weekday (1-5) and within working hours (8 AM too6 PM), hello target pool size is set too20 nodes.</span></span> <span data-ttu-id="97dec-579">En caso contrario, estableció too10 nodos.</span><span class="sxs-lookup"><span data-stu-id="97dec-579">Otherwise, it's set too10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="97dec-580">Ejemplo 2: Ajuste basado en tareas</span><span class="sxs-lookup"><span data-stu-id="97dec-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="97dec-581">En este ejemplo, el tamaño del grupo de Hola se ajusta según Hola número de tareas en cola Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-581">In this example, hello pool size is adjusted based on hello number of tasks in hello queue.</span></span> <span data-ttu-id="97dec-582">Las cadenas de la fórmula aceptan tanto comentarios como saltos de línea.</span><span class="sxs-lookup"><span data-stu-id="97dec-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for hello past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use hello last sample point,
// otherwise we use hello maximum of last sample point and hello history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM toopending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// hello pool size is capped at 20, if target VM value is more than that, set it
// too20. This value should be adjusted according tooyour use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="97dec-583">Ejemplo 3: Contabilidad para tareas paralelas</span><span class="sxs-lookup"><span data-stu-id="97dec-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="97dec-584">Este ejemplo ajusta el tamaño de bloque de hello según el número de Hola de tareas.</span><span class="sxs-lookup"><span data-stu-id="97dec-584">This example adjusts hello pool size based on hello number of tasks.</span></span> <span data-ttu-id="97dec-585">Esta fórmula también se toma en hello cuenta [MaxTasksPerComputeNode] [ net_maxtasks] valor que se ha establecido para el grupo de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-585">This formula also takes into account hello [MaxTasksPerComputeNode][net_maxtasks] value that has been set for hello pool.</span></span> <span data-ttu-id="97dec-586">Este enfoque es útil en aquellas situaciones en las que la [ejecución de tareas paralelas](batch-parallel-node-tasks.md) se ha habilitado en el grupo.</span><span class="sxs-lookup"><span data-stu-id="97dec-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of hello samples have been recorded in hello past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set hello number of nodes tooadd tooone-fourth hello number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set too4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt toogrow hello number of compute nodes toomatch hello number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep hello nodes active until hello tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="97dec-587">Ejemplo 4: Configuración de un tamaño de grupo inicial</span><span class="sxs-lookup"><span data-stu-id="97dec-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="97dec-588">En este ejemplo de fragmento de código con una fórmula de Autoescala que establece el código C# se muestra hello tooa de tamaño de bloque especificado número de nodos para un período de tiempo inicial.</span><span class="sxs-lookup"><span data-stu-id="97dec-588">This example shows a C# code snippet with an autoscale formula that sets hello pool size tooa specified number of nodes for an initial time period.</span></span> <span data-ttu-id="97dec-589">A continuación, ajusta el tamaño del grupo de hello según el número de saludo de la ejecución y tareas activas después de hello inicial del período de tiempo ha transcurrido.</span><span class="sxs-lookup"><span data-stu-id="97dec-589">Then it adjusts hello pool size based on hello number of running and active tasks after hello initial time period has elapsed.</span></span>

<span data-ttu-id="97dec-590">fórmula de Hola Hola siguiente fragmento de código:</span><span class="sxs-lookup"><span data-stu-id="97dec-590">hello formula in hello following code snippet:</span></span>

* <span data-ttu-id="97dec-591">Establece un grupo inicial de hello nodos toofour de tamaño.</span><span class="sxs-lookup"><span data-stu-id="97dec-591">Sets hello initial pool size toofour nodes.</span></span>
* <span data-ttu-id="97dec-592">No se ajustar el tamaño de bloque de hello dentro de hello primeros 10 minutos del ciclo de vida del grupo de Hola.</span><span class="sxs-lookup"><span data-stu-id="97dec-592">Does not adjust hello pool size within hello first 10 minutes of hello pool's lifecycle.</span></span>
* <span data-ttu-id="97dec-593">Después de 10 minutos, obtiene el valor máximo de Hola Hola active y del número de la ejecución de tareas dentro de Hola últimos 60 minutos.</span><span class="sxs-lookup"><span data-stu-id="97dec-593">After 10 minutes, obtains hello max value of hello number of running and active tasks within hello past 60 minutes.</span></span>
  * <span data-ttu-id="97dec-594">Si ambos valores son 0 (lo que indica que no hay ninguna tarea eran active Hola o en ejecución últimos 60 minutos), el tamaño del grupo de Hola se establece too0.</span><span class="sxs-lookup"><span data-stu-id="97dec-594">If both values are 0 (indicating that no tasks were running or active in hello last 60 minutes), hello pool size is set too0.</span></span>
  * <span data-ttu-id="97dec-595">Si cualquier valor es mayor que cero, no hay cambios.</span><span class="sxs-lookup"><span data-stu-id="97dec-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="97dec-596">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="97dec-596">Next steps</span></span>
* <span data-ttu-id="97dec-597">[Maximizar el uso de recursos de proceso por lotes de Azure con las tareas de nodo simultáneos](batch-parallel-node-tasks.md) contiene los detalles sobre cómo puede ejecutar varias tareas simultáneamente en nodos de proceso de hello en el grupo.</span><span class="sxs-lookup"><span data-stu-id="97dec-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on hello compute nodes in your pool.</span></span> <span data-ttu-id="97dec-598">Además tooautoscaling, esta característica puede ayudar toolower duración del trabajo para algunas cargas de trabajo, lo que ahorra dinero.</span><span class="sxs-lookup"><span data-stu-id="97dec-598">In addition tooautoscaling, this feature may help toolower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="97dec-599">Para otro ajuste de eficacia, asegúrese de que las consultas de la aplicación de lote Hola servicio por lotes en hello mayoría de forma óptima.</span><span class="sxs-lookup"><span data-stu-id="97dec-599">For another efficiency booster, ensure that your Batch application queries hello Batch service in hello most optimal way.</span></span> <span data-ttu-id="97dec-600">Vea [consultar el servicio de Azure Batch Hola eficazmente](batch-efficient-list-queries.md) toolearn cómo toolimit Hola cantidad de datos que atraviesan el cable Hola al consultar el estado de Hola de potencialmente miles de proceso nodos o tareas.</span><span class="sxs-lookup"><span data-stu-id="97dec-600">See [Query hello Azure Batch service efficiently](batch-efficient-list-queries.md) toolearn how toolimit hello amount of data that crosses hello wire when you query hello status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
