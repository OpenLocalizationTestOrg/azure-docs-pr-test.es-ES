---
title: aaaPersist trabajos y tareas de salida tooAzure almacenamiento con hello API del servicio de Azure Batch | Documentos de Microsoft
description: "Obtenga información acerca de cómo trabajos y tareas de lote toopersist toouse API del servicio de lote de salida tooAzure almacenamiento."
services: batch
author: tamram
manager: timlt
editor: 
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/16/2017
ms.author: tamram
ms.openlocfilehash: 71b3f7c0dda2d2a9d8eb3eef83229873c70ca22c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="persist-task-data-tooazure-storage-with-hello-batch-service-api"></a><span data-ttu-id="28015-103">Conservar datos tooAzure almacenamiento de tarea con hello API del servicio de lote</span><span class="sxs-lookup"><span data-stu-id="28015-103">Persist task data tooAzure Storage with hello Batch service API</span></span>

[!INCLUDE [batch-task-output-include](../../includes/batch-task-output-include.md)]

<span data-ttu-id="28015-104">A partir de la versión de 2017-05-01, Hola API del servicio por lotes admite tooAzure de datos de persistencia salida almacenamiento tareas y tareas de administrador de trabajos que se ejecutan en grupos con la configuración de máquina virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="28015-104">Starting with version 2017-05-01, hello Batch service API supports persisting output data tooAzure Storage for tasks and job manager tasks that run on pools with hello virtual machine configuration.</span></span> <span data-ttu-id="28015-105">Cuando se agrega una tarea, puede especificar un contenedor de almacenamiento de Azure como destino de hello para la salida de la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-105">When you add a task, you can specify a container in Azure Storage as hello destination for hello task's output.</span></span> <span data-ttu-id="28015-106">el servicio de lote de Hello, a continuación, escribe cualquier contenedor de toothat de datos de salida cuando se completa la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-106">hello Batch service then writes any output data toothat container when hello task is complete.</span></span>

<span data-ttu-id="28015-107">Se está ejecutando un Hola de toousing ventaja lote resultado de la tarea de servicio API toopersist es que no es necesario aplicación Hola toomodify Hola tarea.</span><span class="sxs-lookup"><span data-stu-id="28015-107">An advantage toousing hello Batch service API toopersist task output is that you do not need toomodify hello application that hello task is running.</span></span> <span data-ttu-id="28015-108">En su lugar, con aplicación de cliente de tooyour de algunas modificaciones simples, puede conservar la salida de la tarea de Hola desde dentro del código de hello crea la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-108">Instead, with a few simple modifications tooyour client application, you can persist hello task's output from within hello code that creates hello task.</span></span>   

## <a name="when-do-i-use-hello-batch-service-api-toopersist-task-output"></a><span data-ttu-id="28015-109">¿Cuando usa el resultado de la tarea toopersist Hola API del servicio de lote?</span><span class="sxs-lookup"><span data-stu-id="28015-109">When do I use hello Batch service API toopersist task output?</span></span>

<span data-ttu-id="28015-110">Lote de Azure proporciona toopersist más de una manera de resultado de la tarea.</span><span class="sxs-lookup"><span data-stu-id="28015-110">Azure Batch provides more than one way toopersist task output.</span></span> <span data-ttu-id="28015-111">Utilizar Hola API del servicio de lote es un método cómodo que es mejor escenarios toothese adecuado:</span><span class="sxs-lookup"><span data-stu-id="28015-111">Using hello Batch service API is a convenient approach that's best suited toothese scenarios:</span></span>

- <span data-ttu-id="28015-112">Desea toowrite código toopersist resultado de la tarea desde dentro de la aplicación cliente, sin modificar la aplicación hello que se ejecuta la tarea.</span><span class="sxs-lookup"><span data-stu-id="28015-112">You want toowrite code toopersist task output from within your client application, without modifying hello application that your task is running.</span></span>
- <span data-ttu-id="28015-113">Desea que los resultados de toopersist de tareas por lotes y las tareas de administrador en los grupos creados con la configuración de máquina virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="28015-113">You want toopersist output from Batch tasks and job manager tasks in pools created with hello virtual machine configuration.</span></span>
- <span data-ttu-id="28015-114">Desea que el contenedor de almacenamiento Azure tooan toopersist de salida con un nombre arbitrario.</span><span class="sxs-lookup"><span data-stu-id="28015-114">You want toopersist output tooan Azure Storage container with an arbitrary name.</span></span>
- <span data-ttu-id="28015-115">Desea que el contenedor de almacenamiento de Azure toopersist salida tooan denominado toohello correspondiente [estándar convenciones de archivo por lotes](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="28015-115">You want toopersist output tooan Azure Storage container named according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> 

<span data-ttu-id="28015-116">Si su escenario difiere de los mencionados anteriormente, deberá tooconsider un enfoque diferente.</span><span class="sxs-lookup"><span data-stu-id="28015-116">If your scenario differs from those listed above, you may need tooconsider a different approach.</span></span> <span data-ttu-id="28015-117">Por ejemplo, API del servicio de lote de hello no actualmente admite tooAzure de salida de transmisión por secuencias almacenamiento mientras se ejecuta la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-117">For example, hello Batch service API does not currently support streaming output tooAzure Storage while hello task is running.</span></span> <span data-ttu-id="28015-118">toostream de salida, considere el uso de la biblioteca de convenciones de archivo por lotes hello, está disponible para. NET.</span><span class="sxs-lookup"><span data-stu-id="28015-118">toostream output, consider using hello Batch File Conventions library, available for .NET.</span></span> <span data-ttu-id="28015-119">Para otros idiomas, necesitará tooimplement su propia solución.</span><span class="sxs-lookup"><span data-stu-id="28015-119">For other languages, you'll need tooimplement your own solution.</span></span> <span data-ttu-id="28015-120">Para obtener más información sobre otras opciones para guardar resultado de la tarea, consulte [Persist trabajos y tareas de salida tooAzure almacenamiento](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="28015-120">For more information on other options for persisting task output, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span> 

## <a name="create-a-container-in-azure-storage"></a><span data-ttu-id="28015-121">Creación de un contenedor en Azure Storage</span><span class="sxs-lookup"><span data-stu-id="28015-121">Create a container in Azure Storage</span></span>

<span data-ttu-id="28015-122">salida de la tarea de toopersist tooAzure almacenamiento, deberá toocreate un contenedor que actúa como destino de Hola para los archivos de salida.</span><span class="sxs-lookup"><span data-stu-id="28015-122">toopersist task output tooAzure Storage, you'll need toocreate a container that serves as hello destination for your output files.</span></span> <span data-ttu-id="28015-123">Crear contenedor de hello antes de ejecutar la tarea, preferiblemente antes de enviar el trabajo.</span><span class="sxs-lookup"><span data-stu-id="28015-123">Create hello container before you run your task, preferably before you submit your job.</span></span> <span data-ttu-id="28015-124">contenedor de hello toocreate, biblioteca de cliente de almacenamiento de Azure adecuada de uso Hola o SDK.</span><span class="sxs-lookup"><span data-stu-id="28015-124">toocreate hello container, use hello appropriate Azure Storage client library or SDK.</span></span> <span data-ttu-id="28015-125">Para obtener más información acerca de las API de almacenamiento de Azure, vea hello [documentación del almacenamiento de Azure](https://docs.microsoft.com/azure/storage/).</span><span class="sxs-lookup"><span data-stu-id="28015-125">For more information about Azure Storage APIs, see hello [Azure Storage documentation](https://docs.microsoft.com/azure/storage/).</span></span>

<span data-ttu-id="28015-126">Por ejemplo, si está escribiendo la aplicación en C#, utilice hello [biblioteca de cliente de almacenamiento de Azure para .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span><span class="sxs-lookup"><span data-stu-id="28015-126">For example, if you are writing your application in C#, use hello [Azure Storage client library for .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span></span> <span data-ttu-id="28015-127">Hola siguiente ejemplo se muestra cómo toocreate un contenedor:</span><span class="sxs-lookup"><span data-stu-id="28015-127">hello following example shows how toocreate a container:</span></span>

```csharp
CloudBlobContainer container = storageAccount.CreateCloudBlobClient().GetContainerReference(containerName);
await conainer.CreateIfNotExists();
```

## <a name="get-a-shared-access-signature-for-hello-container"></a><span data-ttu-id="28015-128">Obtener una firma de acceso compartido para el contenedor de Hola</span><span class="sxs-lookup"><span data-stu-id="28015-128">Get a shared access signature for hello container</span></span>

<span data-ttu-id="28015-129">Después de crear el contenedor de hello, obtener una firma de acceso compartido (SAS) con acceso de escritura toohello contenedor.</span><span class="sxs-lookup"><span data-stu-id="28015-129">After you create hello container, get a shared access signature (SAS) with write access toohello container.</span></span> <span data-ttu-id="28015-130">Una SAS proporciona el contenedor de toohello de acceso delegado.</span><span class="sxs-lookup"><span data-stu-id="28015-130">A SAS provides delegated access toohello container.</span></span> <span data-ttu-id="28015-131">Hola SAS concede acceso con un conjunto especificado de permisos y en un intervalo de tiempo especificado.</span><span class="sxs-lookup"><span data-stu-id="28015-131">hello SAS grants access with a specified set of permissions and over a specified time interval.</span></span> <span data-ttu-id="28015-132">Hola servicio por lotes debe una SAS con el contenedor de toohello de la salida de tarea de escritura permisos toowrite.</span><span class="sxs-lookup"><span data-stu-id="28015-132">hello Batch service needs a SAS with write permissions toowrite task output toohello container.</span></span> <span data-ttu-id="28015-133">Para más información sobre las firmas de acceso compartido, consulte [Uso de firmas de acceso compartido \(SAS\) en Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="28015-133">For more information about SAS, see [Using shared access signatures \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

<span data-ttu-id="28015-134">Cuando se obtiene una SAS con hello las API de almacenamiento de Azure, Hola API devuelve una cadena de token de SAS.</span><span class="sxs-lookup"><span data-stu-id="28015-134">When you get a SAS using hello Azure Storage APIs, hello API returns a SAS token string.</span></span> <span data-ttu-id="28015-135">Esta cadena de tokens incluye todos los parámetros de hello SAS, incluidos los permisos de Hola y el intervalo de saludo sobre qué Hola SAS es válido.</span><span class="sxs-lookup"><span data-stu-id="28015-135">This token string includes all parameters of hello SAS, including hello permissions and hello interval over which hello SAS is valid.</span></span> <span data-ttu-id="28015-136">toouse Hola SAS tooaccess un contenedor de almacenamiento de Azure, deberá tooappend Hola SAS cadena de token toohello URI de recurso.</span><span class="sxs-lookup"><span data-stu-id="28015-136">toouse hello SAS tooaccess a container in Azure Storage, you need tooappend hello SAS token string toohello resource URI.</span></span> <span data-ttu-id="28015-137">recurso de Hello URI, junto con hello anexa el token de SAS, proporciona acceso autenticado tooAzure almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="28015-137">hello resource URI, together with hello appended SAS token, provides authenticated access tooAzure Storage.</span></span>

<span data-ttu-id="28015-138">Hello en el ejemplo siguiente se muestra cómo tooget una SAS de solo escritura símbolo (token) de cadena para el contenedor de Hola y anexa el URI del contenedor de toohello Hola SAS:</span><span class="sxs-lookup"><span data-stu-id="28015-138">hello following example shows how tooget a write-only SAS token string for hello container, then appends hello SAS toohello container URI:</span></span>

```csharp
string containerSasToken = container.GetSharedAccessSignature(new SharedAccessBlobPolicy()
{
    SharedAccessExpiryTime = DateTimeOffset.UtcNow.AddDays(1),
    Permissions = SharedAccessBlobPermissions.Write
});

string containerSasUrl = container.Uri.AbsoluteUri + containerSasToken; 
```

## <a name="specify-output-files-for-task-output"></a><span data-ttu-id="28015-139">Especificar archivos de salida para la salida de la tarea</span><span class="sxs-lookup"><span data-stu-id="28015-139">Specify output files for task output</span></span>

<span data-ttu-id="28015-140">archivos de salida de toospecify para una tarea, crear una colección de [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objetos y asignar toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) propiedad cuando se crea la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-140">toospecify output files for a task, create a collection of [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objects and assign it toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) property when you create hello task.</span></span> 

<span data-ttu-id="28015-141">ejemplo de código de .NET siguiente Hello crea una tarea que escribe números aleatorios tooa archivo denominado `output.txt`.</span><span class="sxs-lookup"><span data-stu-id="28015-141">hello following .NET code example creates a task that writes random numbers tooa file named `output.txt`.</span></span> <span data-ttu-id="28015-142">ejemplo de Hola crea un archivo de salida para `output.txt` toobe escrito toohello contenedor.</span><span class="sxs-lookup"><span data-stu-id="28015-142">hello example creates an output file for `output.txt` toobe written toohello container.</span></span> <span data-ttu-id="28015-143">ejemplo de Hola también crea archivos de salida para los archivos de registro que coinciden con el patrón de archivo hello `std*.txt` (_p. ej._, `stdout.txt` y `stderr.txt`).</span><span class="sxs-lookup"><span data-stu-id="28015-143">hello example also creates output files for any log files that match hello file pattern `std*.txt` (_e.g._, `stdout.txt` and `stderr.txt`).</span></span> <span data-ttu-id="28015-144">dirección URL del contenedor de Hello requiere Hola SAS que se creó anteriormente para el contenedor de Hola.</span><span class="sxs-lookup"><span data-stu-id="28015-144">hello container URL requires hello SAS that was created previously for hello container.</span></span> <span data-ttu-id="28015-145">Hola servicio por lotes utiliza contenedor toohello de hello SAS tooauthenticate acceso:</span><span class="sxs-lookup"><span data-stu-id="28015-145">hello Batch service uses hello SAS tooauthenticate access toohello container:</span></span> 

```csharp
new CloudTask(taskId, "cmd /v:ON /c \"echo off && set && (FOR /L %i IN (1,1,100000) DO (ECHO !RANDOM!)) > output.txt\"")
{
    OutputFiles = new List<OutputFile>
    {
        new OutputFile(
            filePattern: @"..\std*.txt",
            destination: new OutputFileDestination(
         new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId)),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
        new OutputFile(
            filePattern: @"output.txt",
            destination: 
         new OutputFileDestination(new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId + @"\output.txt")),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
}
```

### <a name="specify-a-file-pattern-for-matching"></a><span data-ttu-id="28015-146">Especifique un patrón de archivos para buscar coincidencias</span><span class="sxs-lookup"><span data-stu-id="28015-146">Specify a file pattern for matching</span></span>

<span data-ttu-id="28015-147">Cuando se especifica un archivo de salida, puede usar hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) toospecify propiedad un patrón de archivo para hacer coincidir.</span><span class="sxs-lookup"><span data-stu-id="28015-147">When you specify an output file, you can use hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) property toospecify a file pattern for matching.</span></span> <span data-ttu-id="28015-148">patrón de archivo Hello puede coincidir con cero archivos, un único archivo o un conjunto de archivos que se crean mediante la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-148">hello file pattern may match zero files, a single file, or a set of files that are created by hello task.</span></span>

<span data-ttu-id="28015-149">Hola **FilePattern** propiedad admite caracteres comodín de sistema de archivos estándar, como `*` (para que coincida con no recursivo) y `**` (para que coincida con recursivo).</span><span class="sxs-lookup"><span data-stu-id="28015-149">hello **FilePattern** property supports standard filesystem wildcards such as `*` (for non-recursive matches) and `**` (for recursive matches).</span></span> <span data-ttu-id="28015-150">Por ejemplo, el ejemplo de código de hello anterior especifica Hola archivo patrón toomatch `std*.txt` de manera no recursiva:</span><span class="sxs-lookup"><span data-stu-id="28015-150">For example, hello code sample above specifies hello file pattern toomatch `std*.txt` non-recursively:</span></span> 

`filePattern: @"..\std*.txt"`

<span data-ttu-id="28015-151">tooupload un solo archivo, especifique un patrón de archivo con ningún carácter comodín.</span><span class="sxs-lookup"><span data-stu-id="28015-151">tooupload a single file, specify a file pattern with no wildcards.</span></span> <span data-ttu-id="28015-152">Por ejemplo, el ejemplo de código de hello anterior especifica Hola archivo patrón toomatch `output.txt`:</span><span class="sxs-lookup"><span data-stu-id="28015-152">For example, hello code sample above specifies hello file pattern toomatch `output.txt`:</span></span>

`filePattern: @"output.txt"`

### <a name="specify-an-upload-condition"></a><span data-ttu-id="28015-153">Especificar una condición de carga</span><span class="sxs-lookup"><span data-stu-id="28015-153">Specify an upload condition</span></span>

<span data-ttu-id="28015-154">Hola [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) propiedad permite cargar condicional de archivos de salida.</span><span class="sxs-lookup"><span data-stu-id="28015-154">hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) property permits conditional uploading of output files.</span></span> <span data-ttu-id="28015-155">Un escenario común es tooupload un conjunto de archivos si Hola tarea se ejecuta correctamente y un conjunto diferente de archivos si se produce un error.</span><span class="sxs-lookup"><span data-stu-id="28015-155">A common scenario is tooupload one set of files if hello task succeeds, and a different set of files if it fails.</span></span> <span data-ttu-id="28015-156">Por ejemplo, puede que desee archivos de registro detallados tooupload solo cuando se produce un error de tarea hello y finaliza con un código de salida distinto de cero.</span><span class="sxs-lookup"><span data-stu-id="28015-156">For example, you may want tooupload verbose log files only when hello task fails and exits with a nonzero exit code.</span></span> <span data-ttu-id="28015-157">De forma similar, puede que desee los archivos de resultados tooupload solo si se realiza correctamente la tarea hello, que pueden ser esos archivos falta o está incompleto si se produce un error en la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="28015-157">Similarly, you may want tooupload result files only if hello task succeeds, as those files may be missing or incomplete if hello task fails.</span></span>

<span data-ttu-id="28015-158">ejemplo de código anterior Hello establece hello **UploadCondition** propiedad demasiado**TaskCompletion**.</span><span class="sxs-lookup"><span data-stu-id="28015-158">hello code sample above sets hello **UploadCondition** property too**TaskCompletion**.</span></span> <span data-ttu-id="28015-159">Esta configuración especifica que el archivo hello esté toobe cargado al finalizar tareas hello, independientemente del valor Hola de código de salida de hello.</span><span class="sxs-lookup"><span data-stu-id="28015-159">This setting specifies that hello file is toobe uploaded after hello tasks completes, regardless of hello value of hello exit code.</span></span> 

`uploadCondition: OutputFileUploadCondition.TaskCompletion`

<span data-ttu-id="28015-160">Para otras configuraciones, vea hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span><span class="sxs-lookup"><span data-stu-id="28015-160">For other settings, see hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span></span>

### <a name="disambiguate-files-with-hello-same-name"></a><span data-ttu-id="28015-161">Eliminar la ambigüedad de los archivos con hello mismo nombre</span><span class="sxs-lookup"><span data-stu-id="28015-161">Disambiguate files with hello same name</span></span>

<span data-ttu-id="28015-162">tareas de Hello en un trabajo pueden producir archivos que tienen Hola mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="28015-162">hello tasks in a job may produce files that have hello same name.</span></span> <span data-ttu-id="28015-163">Por ejemplo, `stdout.txt` y `stderr.txt` se crean para todas las tareas que se ejecutan en un trabajo.</span><span class="sxs-lookup"><span data-stu-id="28015-163">For example, `stdout.txt` and `stderr.txt` are created for every task that runs in a job.</span></span> <span data-ttu-id="28015-164">Dado que cada tarea se ejecuta en su propio contexto, estos archivos no están en conflicto en el sistema de archivos del nodo de Hola.</span><span class="sxs-lookup"><span data-stu-id="28015-164">Because each task runs in its own context, these files don't conflict on hello node's file system.</span></span> <span data-ttu-id="28015-165">Sin embargo, al cargar archivos desde varios contenedores compartidos tooa de tareas, deberá toodisambiguate archivos con hello mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="28015-165">However, when you upload files from multiple tasks tooa shared container, you'll need toodisambiguate files with hello same name.</span></span>

<span data-ttu-id="28015-166">Hola [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) propiedad especifica el blob de destino de Hola o el directorio virtual para los archivos de salida.</span><span class="sxs-lookup"><span data-stu-id="28015-166">hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) property specifies hello destination blob or virtual directory for output files.</span></span> <span data-ttu-id="28015-167">Puede usar hello **ruta de acceso** blob de propiedad tooname Hola o el directorio virtual de tal manera que con el mismo nombre se denominan de forma unívoca en el almacenamiento de Azure de hello archivos de salida.</span><span class="sxs-lookup"><span data-stu-id="28015-167">You can use hello **Path** property tooname hello blob or virtual directory in such a way that output files with hello same name are uniquely named in Azure Storage.</span></span> <span data-ttu-id="28015-168">Con el Id. de tarea de hello en ruta de acceso de hello es una buena manera tooensure los nombres únicos e identificar fácilmente los archivos.</span><span class="sxs-lookup"><span data-stu-id="28015-168">Using hello task ID in hello path is a good way tooensure unique names and easily identify files.</span></span>

<span data-ttu-id="28015-169">Si hello **FilePattern** propiedad se establece la expresión de caracteres comodín tooa, a continuación, todos los archivos que coinciden con el patrón de hello están cargados toohello directorio virtual especificado por hello **ruta de acceso** propiedad.</span><span class="sxs-lookup"><span data-stu-id="28015-169">If hello **FilePattern** property is set tooa wildcard expression, then all files that match hello pattern are uploaded toohello virtual directory specified by hello **Path** property.</span></span> <span data-ttu-id="28015-170">Por ejemplo, si hello contenedor es `mycontainer`, es el Id. de tarea de hello `mytask`, y es el patrón de archivo hello `..\std*.txt`, a continuación, Hola absoluto URI toohello archivos de salida en el almacenamiento de Azure será similares al:</span><span class="sxs-lookup"><span data-stu-id="28015-170">For example, if hello container is `mycontainer`, hello task ID is `mytask`, and hello file pattern is `..\std*.txt`, then hello absolute URIs toohello output files in Azure Storage will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/mytask/stderr.txt
https://myaccount.blob.core.windows.net/mycontainer/mytask/stdout.txt
```

<span data-ttu-id="28015-171">Si hello **FilePattern** propiedad es conjunto toomatch un solo nombre de archivo, a continuación, lo que significa que no contiene todos los caracteres comodín, Hola valo hello **ruta de acceso** propiedad especifica el nombre de blob completo Hola .</span><span class="sxs-lookup"><span data-stu-id="28015-171">If hello **FilePattern** property is set toomatch a single file name, meaning it does not contain any wildcard characters, then hello value of hello **Path** property specifies hello fully qualified blob name.</span></span> <span data-ttu-id="28015-172">Para evitar conflictos de nomenclatura con un único archivo de varias tareas, a continuación, incluir nombre de hello del directorio virtual de hello como parte de toodisambiguate de nombre de archivo de hello esos archivos.</span><span class="sxs-lookup"><span data-stu-id="28015-172">If you anticipate naming conflicts with a single file from multiple tasks, then include hello name of hello virtual directory as part of hello file name toodisambiguate those files.</span></span> <span data-ttu-id="28015-173">Por ejemplo, un conjunto de hello **ruta de acceso** propiedad tooinclude Id. de tarea hello, carácter de delimitador de hello (normalmente una barra diagonal) y nombre de archivo de hello:</span><span class="sxs-lookup"><span data-stu-id="28015-173">For example, set hello **Path** property tooinclude hello task ID, hello delimiter character (typically a forward slash), and hello file name:</span></span>

`path: taskId + @"/output.txt"`

<span data-ttu-id="28015-174">Hola absolutos archivos de salida de URI toohello para un conjunto de tareas será similares al:</span><span class="sxs-lookup"><span data-stu-id="28015-174">hello absolute URIs toohello output files for a set of tasks will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/task1/output.txt
https://myaccount.blob.core.windows.net/mycontainer/task2/output.txt
```

<span data-ttu-id="28015-175">Para obtener más información acerca de los directorios virtuales en el almacenamiento de Azure, consulte [enumerar blobs hello en un contenedor](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span><span class="sxs-lookup"><span data-stu-id="28015-175">For more information about virtual directories in Azure Storage, see [List hello blobs in a container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span></span>


## <a name="diagnose-file-upload-errors"></a><span data-ttu-id="28015-176">Diagnóstico de errores de carga de archivos</span><span class="sxs-lookup"><span data-stu-id="28015-176">Diagnose file upload errors</span></span>

<span data-ttu-id="28015-177">Si carga salida archivos tooAzure almacenamiento se produce un error, tarea hello mueve toohello **completado** hello y estado [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) propiedad está establecida.</span><span class="sxs-lookup"><span data-stu-id="28015-177">If uploading output files tooAzure Storage fails, then hello task moves toohello **Completed** state and hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) property is set.</span></span> <span data-ttu-id="28015-178">Examinar hello **FailureInformation** toodetermine propiedad cuál fue el error.</span><span class="sxs-lookup"><span data-stu-id="28015-178">Examine hello **FailureInformation** property toodetermine what error occurred.</span></span> <span data-ttu-id="28015-179">Por ejemplo, este es un error que se produce en la carga de archivos si no se encuentra el contenedor de hello:</span><span class="sxs-lookup"><span data-stu-id="28015-179">For example, here is an error that occurs on file upload if hello container cannot be found:</span></span> 

```
Category: UserError
Code: FileUploadContainerNotFound
Message: One of hello specified Azure container(s) was not found while attempting tooupload an output file
```

<span data-ttu-id="28015-180">En cada carga de archivos por lotes escribe dos nodos de proceso de toohello de archivos, de registro `fileuploadout.txt` y `fileuploaderr.txt`.</span><span class="sxs-lookup"><span data-stu-id="28015-180">On every file upload, Batch writes two log files toohello compute node, `fileuploadout.txt` and `fileuploaderr.txt`.</span></span> <span data-ttu-id="28015-181">Puede examinar estos toolearn de archivos de registro más de un error específico.</span><span class="sxs-lookup"><span data-stu-id="28015-181">You can examine these log files toolearn more about a specific failure.</span></span> <span data-ttu-id="28015-182">En casos donde cargar el archivo hello nunca intentó, por ejemplo porque no se pudo ejecutar la tarea hello propio, a continuación, estos archivos de registro no existe.</span><span class="sxs-lookup"><span data-stu-id="28015-182">In cases where hello file upload was never attempted, for example because hello task itself couldn’t run, then these log files will not exist.</span></span>

## <a name="diagnose-file-upload-performance"></a><span data-ttu-id="28015-183">Diagnóstico del rendimiento de la carga de archivos</span><span class="sxs-lookup"><span data-stu-id="28015-183">Diagnose file upload performance</span></span>

<span data-ttu-id="28015-184">Hola `fileuploadout.txt` archivo registra el progreso de la carga.</span><span class="sxs-lookup"><span data-stu-id="28015-184">hello `fileuploadout.txt` file logs upload progress.</span></span> <span data-ttu-id="28015-185">Puede examinar este toolearn de archivo están tardando más información acerca de cuánto tiempo se carga el archivo.</span><span class="sxs-lookup"><span data-stu-id="28015-185">You can examine this file toolearn more about how long your file uploads are taking.</span></span> <span data-ttu-id="28015-186">Tenga en cuenta que hay muchos factores que contribuyen rendimiento tooupload, incluido el tamaño de hello del nodo de hello, otra actividad en el nodo de hello en tiempo de Hola de carga de hello, si es el contenedor de destino de Hola Hola misma región que el grupo de lote de hello, cuántos nodos son Cargando cuenta de almacenamiento de toohello en hello al mismo tiempo y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="28015-186">Keep in mind that there are many contributing factors tooupload performance, including hello size of hello node, other activity on hello node at hello time of hello upload, whether hello target container is in hello same region as hello Batch pool, how many nodes are uploading toohello storage account at hello same time, and so on.</span></span>

## <a name="use-hello-batch-service-api-with-hello-batch-file-conventions-standard"></a><span data-ttu-id="28015-187">Usa la API del servicio de lote de hello con hello convenciones de archivo por lotes estándar</span><span class="sxs-lookup"><span data-stu-id="28015-187">Use hello Batch service API with hello Batch File Conventions standard</span></span>

<span data-ttu-id="28015-188">Al mantener el resultado de la tarea con hello API del servicio de lote, se puede asignar un nombre el contenedor de destino y sin embargo al igual que los blobs.</span><span class="sxs-lookup"><span data-stu-id="28015-188">When you persist task output with hello Batch service API, you can name your destination container and blobs however you like.</span></span> <span data-ttu-id="28015-189">También puede elegir tooname ellas según toohello [estándar convenciones de archivo por lotes](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="28015-189">You can also choose tooname them according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> <span data-ttu-id="28015-190">estándar de archivo convenciones Hola determina los nombres de hello del contenedor de destino de Hola y de blob en el almacenamiento de Azure para un archivo de salida determinado basándose en los nombres de Hola de hello trabajos y tareas.</span><span class="sxs-lookup"><span data-stu-id="28015-190">hello File Conventions standard determines hello names of hello destination container and blob in Azure Storage for a given output file based on hello names of hello job and task.</span></span> <span data-ttu-id="28015-191">Si utilizas Hola convenciones de archivo estándar para asignar nombres a archivos de salida, los archivos de salida están disponibles para su visualización en hello [portal de Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="28015-191">If you do use hello File Conventions standard for naming output files, then your output files are available for viewing in hello [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="28015-192">Si está programando en C#, puede utilizar métodos de hello integradas hello [biblioteca convenciones de archivo por lotes para .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span><span class="sxs-lookup"><span data-stu-id="28015-192">If you are developing in C#, you can use hello methods built into hello [Batch File Conventions library for .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span></span> <span data-ttu-id="28015-193">Esta biblioteca crea Hola correctamente denominado contenedores y las rutas de acceso de blob para usted.</span><span class="sxs-lookup"><span data-stu-id="28015-193">This library creates hello properly named containers and blob paths for you.</span></span> <span data-ttu-id="28015-194">Por ejemplo, puede llamar a Hola API tooget Hola correcta nombre hello contenedor, tomando como base el nombre del trabajo de hello:</span><span class="sxs-lookup"><span data-stu-id="28015-194">For example, you can call hello API tooget hello correct name for hello container, based on hello job name:</span></span>

```csharp
string containerName = job.OutputStorageContainerName();
```

<span data-ttu-id="28015-195">Puede usar hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) método tooreturn una dirección URL de firma (SAS) de acceso compartido que es usado toowrite toohello contenedor.</span><span class="sxs-lookup"><span data-stu-id="28015-195">You can use hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) method tooreturn a shared access signature (SAS) URL that is used toowrite toohello container.</span></span> <span data-ttu-id="28015-196">A continuación, puede pasar este toohello SAS [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span><span class="sxs-lookup"><span data-stu-id="28015-196">You can then pass this SAS toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span></span>

<span data-ttu-id="28015-197">Si está desarrollando en un lenguaje distinto de C#, deberá estándar de tooimplement Hola convenciones archivos usted mismo.</span><span class="sxs-lookup"><span data-stu-id="28015-197">If you are developing in a language other than C#, you will need tooimplement hello File Conventions standard yourself.</span></span>

## <a name="code-sample"></a><span data-ttu-id="28015-198">Código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="28015-198">Code sample</span></span>

<span data-ttu-id="28015-199">Hola [PersistOutputs] [ github_persistoutputs] proyecto de ejemplo es uno de hello [ejemplos de código de Azure Batch] [ github_samples] en GitHub.</span><span class="sxs-lookup"><span data-stu-id="28015-199">hello [PersistOutputs][github_persistoutputs] sample project is one of hello [Azure Batch code samples][github_samples] on GitHub.</span></span> <span data-ttu-id="28015-200">Esta solución de Visual Studio muestra cómo la biblioteca de cliente de toouse Hola por lotes para tareas de .NET toopersist había salida toodurable almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="28015-200">This Visual Studio solution demonstrates how toouse hello Batch client library for .NET toopersist task output toodurable storage.</span></span> <span data-ttu-id="28015-201">Hola toorun de ejemplo, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="28015-201">toorun hello sample, follow these steps:</span></span>

1. <span data-ttu-id="28015-202">Proyecto abierto hello en **Visual Studio 2015 o versiones más recientes**.</span><span class="sxs-lookup"><span data-stu-id="28015-202">Open hello project in **Visual Studio 2015 or newer**.</span></span>
2. <span data-ttu-id="28015-203">Agregue el lote y el almacenamiento **las credenciales de cuentas** demasiado**AccountSettings.settings** en proyecto de Microsoft.Azure.Batch.Samples.Common Hola.</span><span class="sxs-lookup"><span data-stu-id="28015-203">Add your Batch and Storage **account credentials** too**AccountSettings.settings** in hello Microsoft.Azure.Batch.Samples.Common project.</span></span>
3. <span data-ttu-id="28015-204">**Generar** (pero no podrán ejecutar) Hola solución.</span><span class="sxs-lookup"><span data-stu-id="28015-204">**Build** (but do not run) hello solution.</span></span> <span data-ttu-id="28015-205">Si se le solicita, restaure los paquetes NuGet.</span><span class="sxs-lookup"><span data-stu-id="28015-205">Restore any NuGet packages if prompted.</span></span>
4. <span data-ttu-id="28015-206">Hola de uso tooupload portal Azure un [paquete de aplicación](batch-application-packages.md) para **PersistOutputsTask**.</span><span class="sxs-lookup"><span data-stu-id="28015-206">Use hello Azure portal tooupload an [application package](batch-application-packages.md) for **PersistOutputsTask**.</span></span> <span data-ttu-id="28015-207">Incluir hello `PersistOutputsTask.exe` y sus ensamblados dependientes en paquete de extensión .zip hello, identificador de la aplicación hello conjunto demasiado "PersistOutputsTask" y la aplicación hello empaquetar versión demasiado "1.0".</span><span class="sxs-lookup"><span data-stu-id="28015-207">Include hello `PersistOutputsTask.exe` and its dependent assemblies in hello .zip package, set hello application ID too"PersistOutputsTask", and hello application package version too"1.0".</span></span>
5. <span data-ttu-id="28015-208">**Iniciar** Hola (ejecutar) **PersistOutputs** proyecto.</span><span class="sxs-lookup"><span data-stu-id="28015-208">**Start** (run) hello **PersistOutputs** project.</span></span>
6. <span data-ttu-id="28015-209">Cuando escriba toochoose solicitadas Hola persistencia tecnología toouse de ejecución ejemplo hello, **2** ejemplo de Hola a toorun utilizando el resultado de la tarea toopersist Hola API del servicio de lote.</span><span class="sxs-lookup"><span data-stu-id="28015-209">When prompted toochoose hello persistence technology toouse for running hello sample, enter **2** toorun hello sample using hello Batch service API toopersist task output.</span></span>
7. <span data-ttu-id="28015-210">Si lo desea, ejemplo de Hola a volver a ejecutar, escribir **3** toopersist salida Hola API del servicio de lote, y también tooname Hola contenedor y blob de ruta de destino según toohello convenciones de archivo estándar.</span><span class="sxs-lookup"><span data-stu-id="28015-210">If desired, run hello sample again, entering **3** toopersist output with hello Batch service API, and also tooname hello destination container and blob path according toohello File Conventions standard.</span></span>

## <a name="next-steps"></a><span data-ttu-id="28015-211">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="28015-211">Next steps</span></span>

- <span data-ttu-id="28015-212">Para obtener más información sobre Guardar resultado de la tarea con la biblioteca de convenciones de archivos de Hola para. NET, vea [conservar trabajos y tareas tooAzure datos almacenamiento con la biblioteca de convenciones de archivo por lotes de Hola para .NET toopersist ](batch-task-output-file-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="28015-212">For more information on persisting task output with hello File Conventions library for .NET, see [Persist job and task data tooAzure Storage with hello Batch File Conventions library for .NET toopersist ](batch-task-output-file-conventions.md).</span></span>
- <span data-ttu-id="28015-213">Para obtener información sobre otros métodos para almacenar datos de salida en el lote de Azure, consulte [Persist trabajos y tareas de salida tooAzure almacenamiento](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="28015-213">For information on other approaches for persisting output data in Azure Batch, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span>

[github_persistoutputs]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/PersistOutputs
[github_samples]: https://github.com/Azure/azure-batch-samples
