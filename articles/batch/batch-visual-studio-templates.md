---
title: aaaStart compilar soluciones de lote con plantillas de proyecto de Visual Studio - Azure | Documentos de Microsoft
description: "Descubra cómo las plantillas de proyecto de Visual Studio pueden ayudarlo a implementar y ejecutar cargas de trabajo de proceso intensivo en Azure Batch."
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a61c480ddc4dffd66c01220a137a3e852e39c338
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="use-visual-studio-project-templates-toojump-start-batch-solutions"></a><span data-ttu-id="09d03-103">Usar soluciones de Visual Studio project plantillas toojump inicio por lotes</span><span class="sxs-lookup"><span data-stu-id="09d03-103">Use Visual Studio project templates toojump-start Batch solutions</span></span>

<span data-ttu-id="09d03-104">Hola **Administrador de trabajos** y **plantillas de Visual Studio de procesador de tarea** para lote proporcionar código toohelp tooimplement y ejecutar las cargas de trabajo de proceso intensivo en el lote con Hola menos cantidad de trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-104">hello **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code toohelp you tooimplement and run your compute-intensive workloads on Batch with hello least amount of effort.</span></span> <span data-ttu-id="09d03-105">Este documento describe estas plantillas y se proporcionan instrucciones sobre cómo toouse ellos.</span><span class="sxs-lookup"><span data-stu-id="09d03-105">This document describes these templates and provides guidance for how toouse them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="09d03-106">En este artículo se describen las plantillas de toothese aplicables dos información única y se da por supuesto que está familiarizado con el servicio de lote de Hola y conceptos clave relacionados tooit: grupos de nodos, trabajos y tareas, el administrador tareas, las variables de entorno y otro de proceso información pertinente.</span><span class="sxs-lookup"><span data-stu-id="09d03-106">This article discusses only information applicable toothese two templates, and assumes that you are familiar with hello Batch service and key concepts related tooit: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="09d03-107">Puede encontrar más información en [conceptos básicos de Azure Batch](batch-technical-overview.md), [Introducción a la característica por lotes para los desarrolladores](batch-api-basics.md), y [empezar a trabajar con la biblioteca de hello Azure Batch para .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="09d03-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with hello Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="09d03-108">Información general de alto nivel</span><span class="sxs-lookup"><span data-stu-id="09d03-108">High-level overview</span></span>
<span data-ttu-id="09d03-109">las plantillas de administrador de trabajos y el procesador de tareas de Hello pueden ser toocreate usa dos componentes útiles:</span><span class="sxs-lookup"><span data-stu-id="09d03-109">hello Job Manager and Task Processor templates can be used toocreate two useful components:</span></span>

* <span data-ttu-id="09d03-110">Una tarea del administrador de trabajos que implementa un separador de trabajo que puede desglosar un trabajo en varias tareas que se pueden ejecutar de forma independiente, en paralelo.</span><span class="sxs-lookup"><span data-stu-id="09d03-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="09d03-111">Un procesador de tareas que puede ser utilizados tooperform previas a procesamiento y el procesamiento posterior alrededor de una línea de comandos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d03-111">A task processor that can be used tooperform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="09d03-112">Por ejemplo, en un escenario de representación de la película, divisor de trabajo de hello podría convertir un trabajo de película único en cientos o miles de tareas independientes que se procesan fotogramas individuales por separado.</span><span class="sxs-lookup"><span data-stu-id="09d03-112">For example, in a movie rendering scenario, hello job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="09d03-113">En consecuencia, procesador de tareas de hello podría invocar Hola representar la aplicación y todos los procesos dependientes que se necesitan toorender cada fotograma, así como realizar ninguna acción adicional (por ejemplo, copia Hola representan marco tooa ubicación de almacenamiento).</span><span class="sxs-lookup"><span data-stu-id="09d03-113">Correspondingly, hello task processor would invoke hello rendering application and all dependent processes that are needed toorender each frame, as well as perform any additional actions (for example, copying hello rendered frame tooa storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="09d03-114">plantillas de administrador de trabajos y el procesador de tareas de Hello son independientes entre sí, para que pueda elegir toouse ambos o solo una de ellas, dependiendo de los requisitos de Hola de su trabajo de proceso y de las preferencias.</span><span class="sxs-lookup"><span data-stu-id="09d03-114">hello Job Manager and Task Processor templates are independent of each other, so you can choose toouse both, or only one of them, depending on hello requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="09d03-115">Como se muestra en el siguiente diagrama de hello, un trabajo de proceso que usa estas plantillas pasará a través de tres fases:</span><span class="sxs-lookup"><span data-stu-id="09d03-115">As shown in hello diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="09d03-116">código de cliente de Hello (p. ej., aplicación, servicio web, etc.) envía un servicio por lotes en Azure, especificando que su programa de administrador de trabajo manager tarea hello trabajo toohello de trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-116">hello client code (e.g., application, web service, etc.) submits a job toohello Batch service on Azure, specifying as its job manager task hello job manager program.</span></span>
2. <span data-ttu-id="09d03-117">servicio de lote de Hello ejecuta la tarea del Administrador de trabajos de hello en un nodo de proceso y hello trabajo divisor inicia Hola especifica varias tareas del procesador de tareas, según muchos nodos de ejecución según sea necesario, en función de los parámetros de Hola y especificaciones en el código de hello trabajo divisor.</span><span class="sxs-lookup"><span data-stu-id="09d03-117">hello Batch service runs hello job manager task on a compute node and hello job splitter launches hello specified number of task processor tasks, on as many compute nodes as required, based on hello parameters and specifications in hello job splitter code.</span></span>
3. <span data-ttu-id="09d03-118">Hola tarea procesador tareas ejecutan de forma independiente, en paralelo, tooprocess los datos de entrada de Hola y generan datos de salida de saludo.</span><span class="sxs-lookup"><span data-stu-id="09d03-118">hello task processor tasks run independently, in parallel, tooprocess hello input data and generate hello output data.</span></span>

![Diagrama que muestra cómo interactúa el código de cliente con hello servicio por lotes][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="09d03-120">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="09d03-120">Prerequisites</span></span>
<span data-ttu-id="09d03-121">plantillas de proceso por lotes de hello toouse, necesitará siguiente hello:</span><span class="sxs-lookup"><span data-stu-id="09d03-121">toouse hello Batch templates, you will need hello following:</span></span>

* <span data-ttu-id="09d03-122">Un equipo con Visual Studio 2015 instalado.</span><span class="sxs-lookup"><span data-stu-id="09d03-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="09d03-123">Las plantillas de proceso por lotes solo se admiten actualmente para Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="09d03-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="09d03-124">plantillas de proceso por lotes Hello, que están disponibles en hello [Galería de Visual Studio] [ vs_gallery] como extensiones de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="09d03-124">hello Batch templates, which are available from hello [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="09d03-125">Hay dos maneras en las plantillas de Hola tooget:</span><span class="sxs-lookup"><span data-stu-id="09d03-125">There are two ways tooget hello templates:</span></span>
  
  * <span data-ttu-id="09d03-126">Instalar plantillas de hello mediante hello **extensiones y actualizaciones** cuadro de diálogo de Visual Studio (para obtener más información, consulte [buscar y usar extensiones de Visual Studio][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="09d03-126">Install hello templates using hello **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="09d03-127">Hola **extensiones y actualizaciones** cuadro de diálogo, búsqueda y descarga Hola siguiendo dos extensiones:</span><span class="sxs-lookup"><span data-stu-id="09d03-127">In hello **Extensions and Updates** dialog box, search and download hello following two extensions:</span></span>
    
    * <span data-ttu-id="09d03-128">Administrador de trabajos de Azure Batch con separador de trabajos</span><span class="sxs-lookup"><span data-stu-id="09d03-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="09d03-129">Procesador de tareas de Azure Batch</span><span class="sxs-lookup"><span data-stu-id="09d03-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="09d03-130">Descargar plantillas de Hola de galería en línea de Hola para Visual Studio: [plantillas de proyecto de Microsoft Azure por lotes][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="09d03-130">Download hello templates from hello online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="09d03-131">Si tiene previsto hello toouse [paquetes de aplicación](batch-application-packages.md) nodos de proceso de administrador de trabajos de característica toodeploy hello y toohello de procesador de tarea por lotes, deberá toolink un tooyour de cuenta de almacenamiento cuenta de lote.</span><span class="sxs-lookup"><span data-stu-id="09d03-131">If you plan toouse hello [Application Packages](batch-application-packages.md) feature toodeploy hello job manager and task processor toohello Batch compute nodes, you need toolink a storage account tooyour Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="09d03-132">Preparación</span><span class="sxs-lookup"><span data-stu-id="09d03-132">Preparation</span></span>
<span data-ttu-id="09d03-133">Se recomienda crear una solución que puede contener el Administrador de trabajos, así como el procesador de tareas, ya que esto puede que sea más fácil código tooshare entre el Administrador de trabajos y los programas de procesamiento de tareas.</span><span class="sxs-lookup"><span data-stu-id="09d03-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier tooshare code between your job manager and task processor programs.</span></span> <span data-ttu-id="09d03-134">toocreate esta solución, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="09d03-134">toocreate this solution, follow these steps:</span></span>

1. <span data-ttu-id="09d03-135">Abra Visual Studio, seleccione **Archivo** > **Nuevo** > **Proyecto**.</span><span class="sxs-lookup"><span data-stu-id="09d03-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="09d03-136">En **Plantillas**, expanda **Otros tipos de proyectos**, haga clic en **Soluciones de Visual Studio** y, luego, seleccione **Solución en blanco**.</span><span class="sxs-lookup"><span data-stu-id="09d03-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="09d03-137">Escriba un nombre que describa su propósito hello y aplicación de esta solución (p. ej., "LitwareBatchTaskPrograms").</span><span class="sxs-lookup"><span data-stu-id="09d03-137">Type a name that describes your application and hello purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="09d03-138">toocreate Hola nueva solución, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="09d03-138">toocreate hello new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="09d03-139">Plantilla del administrador de trabajos</span><span class="sxs-lookup"><span data-stu-id="09d03-139">Job Manager template</span></span>
<span data-ttu-id="09d03-140">plantilla de administrador de trabajos de Hello ayuda tooimplement una tarea del Administrador de trabajos que puede llevar a cabo Hola siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="09d03-140">hello Job Manager template helps you tooimplement a job manager task that can perform hello following actions:</span></span>

* <span data-ttu-id="09d03-141">Separar un trabajo en varias tareas.</span><span class="sxs-lookup"><span data-stu-id="09d03-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="09d03-142">Enviar esos toorun tareas en lote.</span><span class="sxs-lookup"><span data-stu-id="09d03-142">Submit those tasks toorun on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="09d03-143">Para obtener más información sobre las tareas del administrador de trabajos, vea [Información general de las características de Batch para desarrolladores](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="09d03-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-hello-template"></a><span data-ttu-id="09d03-144">Crear un administrador de trabajos con plantilla Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-144">Create a Job Manager using hello template</span></span>
<span data-ttu-id="09d03-145">tooadd una solución de toohello de administrador de trabajos que creó anteriormente, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="09d03-145">tooadd a job manager toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="09d03-146">Abra la solución existente en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="09d03-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="09d03-147">En el Explorador de soluciones, solución de hello del menú contextual, haga clic en **agregar** > **nuevo proyecto**.</span><span class="sxs-lookup"><span data-stu-id="09d03-147">In Solution Explorer, right-click hello solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="09d03-148">En **Visual C#**, haga clic en **Nube** y, luego, haga clic en **Administrador de trabajos de Azure Batch con separador de trabajos**.</span><span class="sxs-lookup"><span data-stu-id="09d03-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="09d03-149">Escriba un nombre que describe la aplicación e identifica este proyecto como administrador de trabajos de hello (p. ej. "LitwareJobManager").</span><span class="sxs-lookup"><span data-stu-id="09d03-149">Type a name that describes your application and identifies this project as hello job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="09d03-150">proyecto de hello toocreate, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="09d03-150">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="09d03-151">Por último, compilación Hola proyecto tooforce Visual Studio tooload todos los hace referencia a paquetes de NuGet y tooverify que Hola proyecto es válido antes de comenzar a modificarlo.</span><span class="sxs-lookup"><span data-stu-id="09d03-151">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="09d03-152">Archivos de plantilla del administrador de trabajos y su propósito</span><span class="sxs-lookup"><span data-stu-id="09d03-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="09d03-153">Cuando se crea un proyecto mediante la plantilla de administrador de trabajos de hello, genera tres grupos de archivos de código:</span><span class="sxs-lookup"><span data-stu-id="09d03-153">When you create a project using hello Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="09d03-154">archivo de programa principal Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="09d03-154">hello main program file (Program.cs).</span></span> <span data-ttu-id="09d03-155">Esto contiene el punto de entrada del programa Hola y el control de excepciones de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="09d03-155">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="09d03-156">Normalmente no será necesario toomodify esto.</span><span class="sxs-lookup"><span data-stu-id="09d03-156">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="09d03-157">directorio de .NET Framework de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-157">hello Framework directory.</span></span> <span data-ttu-id="09d03-158">Contiene archivos Hola responsables de hello 'reutilizable' trabajo de programa de administrador de trabajo de hello: desempaquetar parámetros, agregar el trabajo por lotes de tareas toohello, etcetera. Normalmente no necesita toomodify estos archivos.</span><span class="sxs-lookup"><span data-stu-id="09d03-158">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="09d03-159">archivo de división del trabajo Hello (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="09d03-159">hello job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="09d03-160">Aquí es donde colocará la lógica específica de la aplicación para separar un trabajo en tareas.</span><span class="sxs-lookup"><span data-stu-id="09d03-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="09d03-161">Por supuesto puede agregar archivos adicionales como toosupport requiere el código de divisor de trabajo, dependiendo de complejidad de Hola de trabajo de hello división lógica.</span><span class="sxs-lookup"><span data-stu-id="09d03-161">Of course you can add additional files as required toosupport your job splitter code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="09d03-162">plantilla de Hello también genera archivos de proyecto estándar de .NET como un archivo .csproj, app.config, packages.config, etcetera.</span><span class="sxs-lookup"><span data-stu-id="09d03-162">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="09d03-163">resto de Hola de esta sección describe Hola distintos archivos y su estructura de código y explica lo que hace cada clase.</span><span class="sxs-lookup"><span data-stu-id="09d03-163">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Explorador de soluciones de Visual Studio que muestra la solución de plantilla de administrador de trabajos de Hola][solution_explorer01]

<span data-ttu-id="09d03-165">**Archivos de Framework**</span><span class="sxs-lookup"><span data-stu-id="09d03-165">**Framework files**</span></span>

* <span data-ttu-id="09d03-166">`Configuration.cs`: Encapsula la carga de Hola de datos de configuración de trabajo, como los detalles de la cuenta, las credenciales de cuenta de almacenamiento vinculadas, información de trabajos y tareas y parámetros del trabajo por lotes.</span><span class="sxs-lookup"><span data-stu-id="09d03-166">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="09d03-167">También proporciona acceso a las variables de entorno definida por el tooBatch (vea la configuración del entorno para las tareas, en la documentación de lote de hello) a través de la clase de hello Configuration.EnvironmentVariable.</span><span class="sxs-lookup"><span data-stu-id="09d03-167">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="09d03-168">`IConfiguration.cs`: Hola de resúmenes implementación de la clase de configuración de hello, para que pueda el divisor de trabajo mediante un objeto de configuración falsificados o de simulacro de pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="09d03-168">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="09d03-169">`JobManager.cs`: Orquesta componentes Hola de programa de administrador de trabajos de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-169">`JobManager.cs`: Orchestrates hello components of hello job manager program.</span></span> <span data-ttu-id="09d03-170">Es responsable de hello inicializar divisor de trabajo de hello, invocar divisor de trabajo de hello, y enviar tareas Hola devueltos por el emisor de la tarea de hello trabajo divisor toohello.</span><span class="sxs-lookup"><span data-stu-id="09d03-170">It is responsible for hello initializing hello job splitter, invoking hello job splitter, and dispatching hello tasks returned by hello job splitter toohello task submitter.</span></span>
* <span data-ttu-id="09d03-171">`JobManagerException.cs`: Representa un error que requiere Hola trabajo manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="09d03-171">`JobManagerException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="09d03-172">JobManagerException es toowrap usado 'se esperaba' errores donde se puede proporcionar información de diagnóstico específica como parte de terminación.</span><span class="sxs-lookup"><span data-stu-id="09d03-172">JobManagerException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="09d03-173">`TaskSubmitter.cs`: Esta clase es tareas tooadding responsables devueltas Hola divisor toohello por lotes de trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-173">`TaskSubmitter.cs`: This class is responsible tooadding tasks returned by hello job splitter toohello Batch job.</span></span> <span data-ttu-id="09d03-174">clase de Hello JobManager agrega la secuencia de Hola de tareas en lotes de trabajo de toohello adición eficaz pero oportuna y, a continuación, llama TaskSubmitter.SubmitTasks en un subproceso en segundo plano para cada lote.</span><span class="sxs-lookup"><span data-stu-id="09d03-174">hello JobManager class aggregates hello sequence of tasks into batches for efficient but timely addition toohello job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="09d03-175">**Separador de trabajos**</span><span class="sxs-lookup"><span data-stu-id="09d03-175">**Job Splitter**</span></span>

<span data-ttu-id="09d03-176">`JobSplitter.cs`: Esta clase contiene la lógica específica de la aplicación para dividir el trabajo de hello en tareas.</span><span class="sxs-lookup"><span data-stu-id="09d03-176">`JobSplitter.cs`: This class contains application-specific logic for splitting hello job into tasks.</span></span> <span data-ttu-id="09d03-177">marco de trabajo Hello invoca hello JobSplitter.Split método tooobtain una secuencia de tareas, que agregan trabajo toohello como método hello devuelve.</span><span class="sxs-lookup"><span data-stu-id="09d03-177">hello framework invokes hello JobSplitter.Split method tooobtain a sequence of tasks, which it adds toohello job as hello method returns them.</span></span> <span data-ttu-id="09d03-178">Esto es clase hello donde se inyectar lógica de Hola de su trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-178">This is hello class where you will inject hello logic of your job.</span></span> <span data-ttu-id="09d03-179">Implementar Hola división método tooreturn una secuencia de instancias de CloudTask que representan tareas de hello en el que desea que el trabajo de Hola de toopartition.</span><span class="sxs-lookup"><span data-stu-id="09d03-179">Implement hello Split method tooreturn a sequence of CloudTask instances representing hello tasks into which you want toopartition hello job.</span></span>

<span data-ttu-id="09d03-180">**Archivos de proyecto de línea de comandos de .NET estándar**</span><span class="sxs-lookup"><span data-stu-id="09d03-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="09d03-181">`App.config`: archivo de configuración de la aplicación. NET estándar.</span><span class="sxs-lookup"><span data-stu-id="09d03-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="09d03-182">`Packages.config`: archivo de dependencia de paquetes NuGet estándar.</span><span class="sxs-lookup"><span data-stu-id="09d03-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="09d03-183">`Program.cs`: Contiene el punto de entrada del programa Hola y el control de excepciones de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="09d03-183">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

### <a name="implementing-hello-job-splitter"></a><span data-ttu-id="09d03-184">Divisor de trabajo de implementación Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-184">Implementing hello job splitter</span></span>
<span data-ttu-id="09d03-185">Cuando se abre el proyecto de plantilla de administrador de trabajos de hello, proyecto de hello tendrá archivo JobSplitter.cs de hello abierta de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="09d03-185">When you open hello Job Manager template project, hello project will have hello JobSplitter.cs file open by default.</span></span> <span data-ttu-id="09d03-186">Puede implementar Hola dividir lógica para las tareas de hello en la carga de trabajo mediante el uso de hello Split() método se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="09d03-186">You can implement hello split logic for hello tasks in your workload by using hello Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets hello tasks into which toosplit hello job. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello job manager framework invokes hello Split method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and hello "yield return" statement; this allows tasks toobe added
/// and toostart running while splitting is still in progress.
/// </summary>
/// <returns>hello tasks toobe added toohello job. Tasks are added automatically
/// by hello job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for hello split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="09d03-187">Hola anotado sección Hola `Split()` método es sección sólo para Hola de hello código de plantilla de administrador de trabajos que está diseñado para toomodify agregando los trabajos de hello lógica toosplit en tareas distintas.</span><span class="sxs-lookup"><span data-stu-id="09d03-187">hello annotated section in hello `Split()` method is hello only section of hello Job Manager template code that is intended for you toomodify by adding hello logic toosplit your jobs into different tasks.</span></span> <span data-ttu-id="09d03-188">Si desea que toomodify otra sección de la plantilla de hello, asegúrese de que se familiarice con el funcionamiento de lote y pruebe algunas de hello [ejemplos de código de lote][github_samples].</span><span class="sxs-lookup"><span data-stu-id="09d03-188">If you want toomodify a different section of hello template, please ensure you are familiarized with how Batch works, and try out a few of hello [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="09d03-189">La implementación de Split() dispone de acceso a:</span><span class="sxs-lookup"><span data-stu-id="09d03-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="09d03-190">Hola parámetros del trabajo, a través de hello `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="09d03-190">hello job parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="09d03-191">Hola CloudJob de objetos que representan trabajos de hello, a través de hello `_job` campo.</span><span class="sxs-lookup"><span data-stu-id="09d03-191">hello CloudJob object representing hello job, via hello `_job` field.</span></span>
* <span data-ttu-id="09d03-192">Hola CloudTask de objetos que representan tarea del Administrador de trabajos hello, a través de hello `_jobManagerTask` campo.</span><span class="sxs-lookup"><span data-stu-id="09d03-192">hello CloudTask object representing hello job manager task, via hello `_jobManagerTask` field.</span></span>

<span data-ttu-id="09d03-193">Su `Split()` implementación no es necesario trabajo toohello de tooadd tareas directamente.</span><span class="sxs-lookup"><span data-stu-id="09d03-193">Your `Split()` implementation does not need tooadd tasks toohello job directly.</span></span> <span data-ttu-id="09d03-194">En su lugar, el código debe devolver una secuencia de objetos de CloudTask y estos se agregarán toohello trabajo automáticamente las clases de framework de Hola que invocan la división del trabajo de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-194">Instead, your code should return a sequence of CloudTask objects, and these will be added toohello job automatically by hello framework classes that invoke hello job splitter.</span></span> <span data-ttu-id="09d03-195">Es común iterador toouse C# (`yield return`) tooimplement divisores de trabajo de características como así Hola tareas toostart ejecuta tan pronto como sea posible, en lugar de esperar toobe de todas las tareas calcularse.</span><span class="sxs-lookup"><span data-stu-id="09d03-195">It's common toouse C#'s iterator (`yield return`) feature tooimplement job splitters as this allows hello tasks toostart running as soon as possible rather than waiting for all tasks toobe calculated.</span></span>

<span data-ttu-id="09d03-196">**Error del separador de trabajos**</span><span class="sxs-lookup"><span data-stu-id="09d03-196">**Job splitter failure**</span></span>

<span data-ttu-id="09d03-197">Si el separador de trabajos detecta un error, debe:</span><span class="sxs-lookup"><span data-stu-id="09d03-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="09d03-198">Finalizar la secuencia de hello utilizando Hola C# `yield break` instrucción, en el que Administrador de trabajos de hello mayúsculas se tratará como correcto; o</span><span class="sxs-lookup"><span data-stu-id="09d03-198">Terminate hello sequence using hello C# `yield break` statement, in which case hello job manager will be treated as successful; or</span></span>
* <span data-ttu-id="09d03-199">Producir una excepción, en el que Administrador de trabajos de hello mayúsculas se tratará como erróneo y se puede reintentar dependiendo de cómo haya configurado el cliente de hello).</span><span class="sxs-lookup"><span data-stu-id="09d03-199">Throw an exception, in which case hello job manager will be treated as failed and may be retried depending on how hello client has configured it).</span></span>

<span data-ttu-id="09d03-200">En ambos casos, las tareas ya devuelven divisor de trabajo de Hola y proceso agregado toohello serán toorun apto.</span><span class="sxs-lookup"><span data-stu-id="09d03-200">In both cases, any tasks already returned by hello job splitter and added toohello Batch job will be eligible toorun.</span></span> <span data-ttu-id="09d03-201">Si no desea que este toohappen, a continuación, se puede realizar:</span><span class="sxs-lookup"><span data-stu-id="09d03-201">If you don't want this toohappen, then you could:</span></span>

* <span data-ttu-id="09d03-202">Terminar el trabajo de hello antes de volver del divisor de trabajo de Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-202">Terminate hello job before returning from hello job splitter</span></span>
* <span data-ttu-id="09d03-203">Formular colección de tareas completa Hola antes de devolverlo (es decir, devolver un `ICollection<CloudTask>` o `IList<CloudTask>` en lugar de implementar el divisor de trabajo mediante un iterador de C#)</span><span class="sxs-lookup"><span data-stu-id="09d03-203">Formulate hello entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="09d03-204">Usar tareas dependencias toomake que todas las tareas dependen de la finalización correcta de Hola de administrador de trabajos de Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-204">Use task dependencies toomake all tasks depend on hello successful completion of hello job manager</span></span>

<span data-ttu-id="09d03-205">**Reintentos del administrador de trabajos**</span><span class="sxs-lookup"><span data-stu-id="09d03-205">**Job manager retries**</span></span>

<span data-ttu-id="09d03-206">Si se produce un error en el Administrador de trabajos de hello, se puede reintentar Hola servicio por lotes según la configuración de reintento de cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-206">If hello job manager fails, it may be retried by hello Batch service depending on hello client retry settings.</span></span> <span data-ttu-id="09d03-207">En general, esto es seguro, porque cuando el marco de trabajo de hello agrega trabajo toohello de tareas, omite cualquier tarea que ya existe.</span><span class="sxs-lookup"><span data-stu-id="09d03-207">In general, this is safe, because when hello framework adds tasks toohello job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="09d03-208">Sin embargo, si es costoso calcular las tareas, no puede llamar tooincur costo de Hola de volver a calcular las tareas que ya se han agregado trabajo toohello; por el contrario, si Hola vuelva a ejecuta se toogenerate no está garantizado Hola mismos identificadores de tarea, a continuación, el comportamiento de 'Omitir duplicados' hello no activará.</span><span class="sxs-lookup"><span data-stu-id="09d03-208">However, if calculating tasks is expensive, you may not wish tooincur hello cost of recalculating tasks that have already been added toohello job; conversely, if hello re-run is not guaranteed toogenerate hello same task IDs then hello 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="09d03-209">En estos casos debe diseñar su trabajo divisor toodetect Hola trabajo ya se ha realizado y no consiste en Repetir, por ejemplo mediante la realización de una CloudJob.ListTasks antes de iniciar tareas tooyield.</span><span class="sxs-lookup"><span data-stu-id="09d03-209">In these cases you should design your job splitter toodetect hello work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting tooyield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-job-manager-template"></a><span data-ttu-id="09d03-210">Salir de códigos y las excepciones producidas en la plantilla de administrador de trabajos de Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-210">Exit codes and exceptions in hello Job Manager template</span></span>
<span data-ttu-id="09d03-211">Códigos de salida y las excepciones proporcionan un resultado de hello toodetermine mecanismo de ejecutar un programa, y pueden ayudar a tooidentify algún problema relacionado con la ejecución del programa Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-211">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help tooidentify any problems with hello execution of hello program.</span></span> <span data-ttu-id="09d03-212">plantilla de administrador de trabajos de Hello implementa códigos de salida de hello y excepciones que se describen en esta sección.</span><span class="sxs-lookup"><span data-stu-id="09d03-212">hello Job Manager template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="09d03-213">Una tarea del Administrador de trabajos que se implementa con la plantilla de administrador de trabajos de hello puede devolver tres códigos de salida posibles:</span><span class="sxs-lookup"><span data-stu-id="09d03-213">A job manager task that is implemented with hello Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="09d03-214">Código</span><span class="sxs-lookup"><span data-stu-id="09d03-214">Code</span></span> | <span data-ttu-id="09d03-215">Description</span><span class="sxs-lookup"><span data-stu-id="09d03-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="09d03-216">0</span><span class="sxs-lookup"><span data-stu-id="09d03-216">0</span></span> |<span data-ttu-id="09d03-217">Administrador de trabajos de Hola que se completó correctamente.</span><span class="sxs-lookup"><span data-stu-id="09d03-217">hello job manager completed successfully.</span></span> <span data-ttu-id="09d03-218">El código de la división de trabajo ejecuta toocompletion y todas las tareas se hayan agregado toohello trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-218">Your job splitter code ran toocompletion, and all tasks were added toohello job.</span></span> |
| <span data-ttu-id="09d03-219">1</span><span class="sxs-lookup"><span data-stu-id="09d03-219">1</span></span> |<span data-ttu-id="09d03-220">tarea del Administrador de trabajos de Hello error con una excepción en una parte 'esperada' del programa Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-220">hello job manager task failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="09d03-221">excepción de Hello fue traducido tooa JobManagerException con información de diagnóstico y, siempre que sea posible, sugerencias para resolver Hola error.</span><span class="sxs-lookup"><span data-stu-id="09d03-221">hello exception was translated tooa JobManagerException with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="09d03-222">2</span><span class="sxs-lookup"><span data-stu-id="09d03-222">2</span></span> |<span data-ttu-id="09d03-223">tarea del Administrador de trabajos de Hello error con una excepción 'inesperada'.</span><span class="sxs-lookup"><span data-stu-id="09d03-223">hello job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="09d03-224">Hello excepción toostandard registrado de salida, pero el Administrador de trabajos de hello es tooadd no se puede cualquier información adicional de diagnóstico o corrección.</span><span class="sxs-lookup"><span data-stu-id="09d03-224">hello exception was logged toostandard output, but hello job manager was unable tooadd any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="09d03-225">En caso de hello de error de tarea del Administrador de trabajos, algunas tareas pueden todavía se agregaron toohello servicio antes de producirse el error de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-225">In hello case of job manager task failure, some tasks may still have been added toohello service before hello error occurred.</span></span> <span data-ttu-id="09d03-226">Estas tareas se ejecutarán como normales.</span><span class="sxs-lookup"><span data-stu-id="09d03-226">These tasks will run as normal.</span></span> <span data-ttu-id="09d03-227">Vea la sección "Error del separador de trabajos" más arriba para consultar el análisis de esta ruta de acceso del código.</span><span class="sxs-lookup"><span data-stu-id="09d03-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="09d03-228">Toda la información de hello devuelta por las excepciones se escribe en los archivos stdout.txt y stderr.txt.</span><span class="sxs-lookup"><span data-stu-id="09d03-228">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="09d03-229">Para obtener más información, vea [Control de errores](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="09d03-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="09d03-230">Consideraciones de cliente</span><span class="sxs-lookup"><span data-stu-id="09d03-230">Client considerations</span></span>
<span data-ttu-id="09d03-231">En esta sección se describen algunos requisitos de implementación de cliente al invocar un administrador de trabajos basado en esta plantilla.</span><span class="sxs-lookup"><span data-stu-id="09d03-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="09d03-232">Vea [cómo toopass parámetros y variables de entorno de Hola código de cliente](#pass-environment-settings) para obtener más información sobre cómo pasar parámetros y configuración del entorno.</span><span class="sxs-lookup"><span data-stu-id="09d03-232">See [How toopass parameters and environment variables from hello client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="09d03-233">**Credenciales obligatorias**</span><span class="sxs-lookup"><span data-stu-id="09d03-233">**Mandatory credentials**</span></span>

<span data-ttu-id="09d03-234">En orden tooadd tareas toohello Azure proceso, tarea del Administrador de trabajos de hello requiere el URL de la cuenta de lote de Azure y la clave.</span><span class="sxs-lookup"><span data-stu-id="09d03-234">In order tooadd tasks toohello Azure Batch job, hello job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="09d03-235">Debe pasar estos datos en variables de entorno denominadas YOUR_BATCH_URL y YOUR_BATCH_KEY.</span><span class="sxs-lookup"><span data-stu-id="09d03-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="09d03-236">Puede establecer estas opciones en el Administrador de trabajos de hello configuración del entorno de tarea.</span><span class="sxs-lookup"><span data-stu-id="09d03-236">You can set these in hello Job Manager task environment settings.</span></span> <span data-ttu-id="09d03-237">Por ejemplo, en un cliente de C#:</span><span class="sxs-lookup"><span data-stu-id="09d03-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="09d03-238">**Credenciales de almacenamiento**</span><span class="sxs-lookup"><span data-stu-id="09d03-238">**Storage credentials**</span></span>

<span data-ttu-id="09d03-239">Por lo general, cliente hello no necesita tooprovide Hola almacenamiento vinculado cuenta credenciales toohello trabajo tarea del administrador porque (a) la mayoría de los administradores de trabajos no es necesario cuenta de almacenamiento de tooexplicitly acceso Hola vinculado y (b) hello cuenta de almacenamiento vinculada se proporciona con frecuencia tareas de tooall como una configuración de entorno comunes para el trabajo de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-239">Typically, hello client does not need tooprovide hello linked storage account credentials toohello job manager task because (a) most job managers do not need tooexplicitly access hello linked storage account and (b) hello linked storage account is often provided tooall tasks as a common environment setting for hello job.</span></span> <span data-ttu-id="09d03-240">Si no va a proporcionar Hola vinculado cuenta de almacenamiento a través de la configuración de entorno común de hello y Administrador de trabajos de hello requiere acceso toolinked almacenamiento, a continuación, también debe proporcionar las credenciales de almacenamiento de hello vinculado como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="09d03-240">If you are not providing hello linked storage account via hello common environment settings, and hello job manager requires access toolinked storage, then you should supply hello linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="09d03-241">**Configuración de tareas del administrador de trabajos**</span><span class="sxs-lookup"><span data-stu-id="09d03-241">**Job manager task settings**</span></span>

<span data-ttu-id="09d03-242">cliente de Hello debe establecer el Administrador de trabajos de hello *killJobOnCompletion* marca demasiado**false**.</span><span class="sxs-lookup"><span data-stu-id="09d03-242">hello client should set hello job manager *killJobOnCompletion* flag too**false**.</span></span>

<span data-ttu-id="09d03-243">Normalmente es seguro para hello cliente tooset *runExclusive* demasiado**false**.</span><span class="sxs-lookup"><span data-stu-id="09d03-243">It is usually safe for hello client tooset *runExclusive* too**false**.</span></span>

<span data-ttu-id="09d03-244">debe usar el cliente de Hola Hola *resourceFiles* o *applicationPackageReferences* toohello de nodos de proceso de implementada de administrador de trabajos de recopilación toohave Hola ejecutable (y su archivos DLL necesarios).</span><span class="sxs-lookup"><span data-stu-id="09d03-244">hello client should use hello *resourceFiles* or *applicationPackageReferences* collection toohave hello job manager executable (and its required DLLs) deployed toohello compute node.</span></span>

<span data-ttu-id="09d03-245">De forma predeterminada, el Administrador de trabajos de hello no se reintentará si se produce un error.</span><span class="sxs-lookup"><span data-stu-id="09d03-245">By default, hello job manager will not be retried if it fails.</span></span> <span data-ttu-id="09d03-246">Dependiendo de la lógica de administrador de trabajos, cliente hello puede querer reintentos tooenable a través de *restricciones*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="09d03-246">Depending on your job manager logic, hello client may want tooenable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="09d03-247">**Configuración de trabajos**</span><span class="sxs-lookup"><span data-stu-id="09d03-247">**Job settings**</span></span>

<span data-ttu-id="09d03-248">Si divisor de trabajo de hello emite tareas con dependencias, el cliente de hello debe establecer tootrue de usesTaskDependencies del trabajo de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-248">If hello job splitter emits tasks with dependencies, hello client must set hello job's usesTaskDependencies tootrue.</span></span>

<span data-ttu-id="09d03-249">En modelo del divisor de trabajo de hello, es poco común para los clientes toowish tooadd tareas toojobs además crea el divisor de trabajo Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-249">In hello job splitter model, it is unusual for clients toowish tooadd tasks toojobs over and above what hello job splitter creates.</span></span> <span data-ttu-id="09d03-250">cliente de Hello, por tanto, normalmente debe establecer del trabajo de hello *onAllTasksComplete* demasiado**terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="09d03-250">hello client should therefore normally set hello job's *onAllTasksComplete* too**terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="09d03-251">Plantilla del procesador de tareas</span><span class="sxs-lookup"><span data-stu-id="09d03-251">Task Processor template</span></span>
<span data-ttu-id="09d03-252">Una plantilla de procesador de tareas Ayuda a tooimplement un procesador de tareas que puede llevar a cabo Hola siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="09d03-252">A Task Processor template helps you tooimplement a task processor that can perform hello following actions:</span></span>

* <span data-ttu-id="09d03-253">Configurar la información de hello requerido por cada toorun de tarea por lotes.</span><span class="sxs-lookup"><span data-stu-id="09d03-253">Set up hello information required by each Batch task toorun.</span></span>
* <span data-ttu-id="09d03-254">Ejecutar todas las acciones requeridas por cada tarea de Batch.</span><span class="sxs-lookup"><span data-stu-id="09d03-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="09d03-255">Guardar resultados de tarea toopersistent almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="09d03-255">Save task outputs toopersistent storage.</span></span>

<span data-ttu-id="09d03-256">Aunque un procesador de tareas no es necesario toorun tareas en lote, ventaja clave de hello del uso de un procesador de tareas es que proporciona un contenedor tooimplement todas las acciones de ejecución de tareas en una ubicación.</span><span class="sxs-lookup"><span data-stu-id="09d03-256">Although a task processor is not required toorun tasks on Batch, hello key advantage of using a task processor is that it provides a wrapper tooimplement all task execution actions in one location.</span></span> <span data-ttu-id="09d03-257">Por ejemplo, si necesita toorun varias aplicaciones en el contexto de Hola de cada tarea, o si necesita toopersistent almacenamiento de datos de toocopy después de completar cada tarea.</span><span class="sxs-lookup"><span data-stu-id="09d03-257">For example, if you need toorun several applications in hello context of each task, or if you need toocopy data toopersistent storage after completing each task.</span></span>

<span data-ttu-id="09d03-258">las acciones de Hello realizadas por el procesador de tareas de hello pueden ser como simple o complejo y muchos o pocos, según sea necesario mediante la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-258">hello actions performed by hello task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="09d03-259">Además, mediante la implementación de todas las acciones de la tarea en un procesador de tareas, puede fácilmente actualizar o agregar acciones según los requisitos de carga de trabajo o tooapplications de cambios.</span><span class="sxs-lookup"><span data-stu-id="09d03-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes tooapplications or workload requirements.</span></span> <span data-ttu-id="09d03-260">Sin embargo, en algunos casos un procesador de tareas no sería mejor solución para su implementación de hello tal y como puede agregar una complejidad innecesaria, por ejemplo cuando se ejecutan los trabajos que se pueden iniciar rápidamente desde una línea de comandos simple.</span><span class="sxs-lookup"><span data-stu-id="09d03-260">However, in some cases a task processor might not be hello optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-hello-template"></a><span data-ttu-id="09d03-261">Crear un procesador de tareas mediante la plantilla de Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-261">Create a Task Processor using hello template</span></span>
<span data-ttu-id="09d03-262">tooadd una solución de toohello de procesador de tarea que creó anteriormente, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="09d03-262">tooadd a task processor toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="09d03-263">Abra la solución existente en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="09d03-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="09d03-264">En el Explorador de soluciones, solución de hello del menú contextual, haga clic en **agregar**y, a continuación, haga clic en **nuevo proyecto**.</span><span class="sxs-lookup"><span data-stu-id="09d03-264">In Solution Explorer, right-click hello solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="09d03-265">En **Visual C#**, haga clic en **Nube** y, luego, haga clic en **Procesador de tareas de Azure Batch**.</span><span class="sxs-lookup"><span data-stu-id="09d03-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="09d03-266">Escriba un nombre que describe la aplicación e identifica este proyecto como Hola procesador de tareas (p. ej. "LitwareTaskProcessor").</span><span class="sxs-lookup"><span data-stu-id="09d03-266">Type a name that describes your application and identifies this project as hello task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="09d03-267">proyecto de hello toocreate, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="09d03-267">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="09d03-268">Por último, compilación Hola proyecto tooforce Visual Studio tooload todos los hace referencia a paquetes de NuGet y tooverify que Hola proyecto es válido antes de comenzar a modificarlo.</span><span class="sxs-lookup"><span data-stu-id="09d03-268">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="09d03-269">Archivos de plantilla del procesador de tareas y su propósito</span><span class="sxs-lookup"><span data-stu-id="09d03-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="09d03-270">Cuando se crea un proyecto mediante la plantilla de procesador de tarea hello, genera tres grupos de archivos de código:</span><span class="sxs-lookup"><span data-stu-id="09d03-270">When you create a project using hello task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="09d03-271">archivo de programa principal Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="09d03-271">hello main program file (Program.cs).</span></span> <span data-ttu-id="09d03-272">Esto contiene el punto de entrada del programa Hola y el control de excepciones de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="09d03-272">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="09d03-273">Normalmente no será necesario toomodify esto.</span><span class="sxs-lookup"><span data-stu-id="09d03-273">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="09d03-274">directorio de .NET Framework de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-274">hello Framework directory.</span></span> <span data-ttu-id="09d03-275">Contiene archivos Hola responsables de hello 'reutilizable' trabajo de programa de administrador de trabajo de hello: desempaquetar parámetros, agregar el trabajo por lotes de tareas toohello, etcetera. Normalmente no necesita toomodify estos archivos.</span><span class="sxs-lookup"><span data-stu-id="09d03-275">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="09d03-276">archivo de procesador de la tarea Hello (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="09d03-276">hello task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="09d03-277">Esto es donde colocará la lógica específica de la aplicación para la ejecución de una tarea (normalmente mediante una llamada a cabo ejecutable existente tooan).</span><span class="sxs-lookup"><span data-stu-id="09d03-277">This is where you will put your application-specific logic for executing a task (typically by calling out tooan existing executable).</span></span> <span data-ttu-id="09d03-278">Código de procesamiento previo y posterior, como descargar datos adicionales o cargar archivos de resultados, que también va aquí.</span><span class="sxs-lookup"><span data-stu-id="09d03-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="09d03-279">Por supuesto puede agregar archivos adicionales como toosupport requiere el código de procesador de tarea, dependiendo de complejidad de Hola de trabajo de hello división lógica.</span><span class="sxs-lookup"><span data-stu-id="09d03-279">Of course you can add additional files as required toosupport your task processor code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="09d03-280">plantilla de Hello también genera archivos de proyecto estándar de .NET como un archivo .csproj, app.config, packages.config, etcetera.</span><span class="sxs-lookup"><span data-stu-id="09d03-280">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="09d03-281">resto de Hola de esta sección describe Hola distintos archivos y su estructura de código y explica lo que hace cada clase.</span><span class="sxs-lookup"><span data-stu-id="09d03-281">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Explorador de soluciones de Visual Studio que muestra la solución de plantilla de procesador de tareas de Hola][solution_explorer02]

<span data-ttu-id="09d03-283">**Archivos de Framework**</span><span class="sxs-lookup"><span data-stu-id="09d03-283">**Framework files**</span></span>

* <span data-ttu-id="09d03-284">`Configuration.cs`: Encapsula la carga de Hola de datos de configuración de trabajo, como los detalles de la cuenta, las credenciales de cuenta de almacenamiento vinculadas, información de trabajos y tareas y parámetros del trabajo por lotes.</span><span class="sxs-lookup"><span data-stu-id="09d03-284">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="09d03-285">También proporciona acceso a las variables de entorno definida por el tooBatch (vea la configuración del entorno para las tareas, en la documentación de lote de hello) a través de la clase de hello Configuration.EnvironmentVariable.</span><span class="sxs-lookup"><span data-stu-id="09d03-285">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="09d03-286">`IConfiguration.cs`: Hola de resúmenes implementación de la clase de configuración de hello, para que pueda el divisor de trabajo mediante un objeto de configuración falsificados o de simulacro de pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="09d03-286">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="09d03-287">`TaskProcessorException.cs`: Representa un error que requiere Hola trabajo manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="09d03-287">`TaskProcessorException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="09d03-288">TaskProcessorException es toowrap usado 'se esperaba' errores donde se puede proporcionar información de diagnóstico específica como parte de terminación.</span><span class="sxs-lookup"><span data-stu-id="09d03-288">TaskProcessorException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="09d03-289">**Procesador de tareas**</span><span class="sxs-lookup"><span data-stu-id="09d03-289">**Task Processor**</span></span>

* <span data-ttu-id="09d03-290">`TaskProcessor.cs`: Ejecuta la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="09d03-290">`TaskProcessor.cs`: Runs hello task.</span></span> <span data-ttu-id="09d03-291">marco de trabajo de Hello invoca el método de hello TaskProcessor.Run.</span><span class="sxs-lookup"><span data-stu-id="09d03-291">hello framework invokes hello TaskProcessor.Run method.</span></span> <span data-ttu-id="09d03-292">Esto es clase hello donde se insertará lógica específica de la aplicación de hello de la tarea.</span><span class="sxs-lookup"><span data-stu-id="09d03-292">This is hello class where you will inject hello application-specific logic of your task.</span></span> <span data-ttu-id="09d03-293">Implemente el método de ejecución de Hola para:</span><span class="sxs-lookup"><span data-stu-id="09d03-293">Implement hello Run method to:</span></span>
  * <span data-ttu-id="09d03-294">Analizar y validar todos los parámetros de la tarea</span><span class="sxs-lookup"><span data-stu-id="09d03-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="09d03-295">Crear línea de comandos de Hola en cualquier programa externo que desee tooinvoke</span><span class="sxs-lookup"><span data-stu-id="09d03-295">Compose hello command line for any external program you want tooinvoke</span></span>
  * <span data-ttu-id="09d03-296">Registra cualquier información de diagnóstico que necesita para fines de depuración</span><span class="sxs-lookup"><span data-stu-id="09d03-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="09d03-297">Iniciar un proceso mediante la línea de comandos</span><span class="sxs-lookup"><span data-stu-id="09d03-297">Start a process using that command line</span></span>
  * <span data-ttu-id="09d03-298">Espere a que hello tooexit de proceso</span><span class="sxs-lookup"><span data-stu-id="09d03-298">Wait for hello process tooexit</span></span>
  * <span data-ttu-id="09d03-299">Capturar el código de salida de hello de hello proceso toodetermine si se realizó correctamente o no se pudo</span><span class="sxs-lookup"><span data-stu-id="09d03-299">Capture hello exit code of hello process toodetermine if it succeeded or failed</span></span>
  * <span data-ttu-id="09d03-300">Guardar los archivos de salida que desee tookeep toopersistent almacenamiento</span><span class="sxs-lookup"><span data-stu-id="09d03-300">Save any output files you want tookeep toopersistent storage</span></span>

<span data-ttu-id="09d03-301">**Archivos de proyecto de línea de comandos de .NET estándar**</span><span class="sxs-lookup"><span data-stu-id="09d03-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="09d03-302">`App.config`: archivo de configuración de la aplicación. NET estándar.</span><span class="sxs-lookup"><span data-stu-id="09d03-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="09d03-303">`Packages.config`: archivo de dependencia de paquetes NuGet estándar.</span><span class="sxs-lookup"><span data-stu-id="09d03-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="09d03-304">`Program.cs`: Contiene el punto de entrada del programa Hola y el control de excepciones de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="09d03-304">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

## <a name="implementing-hello-task-processor"></a><span data-ttu-id="09d03-305">Procesador de tareas de implementación Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-305">Implementing hello task processor</span></span>
<span data-ttu-id="09d03-306">Cuando se abre el proyecto de plantilla de procesador de tareas de hello, proyecto de hello tendrá archivo TaskProcessor.cs de hello abierta de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="09d03-306">When you open hello Task Processor template project, hello project will have hello TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="09d03-307">Se pueden implementar la lógica de Hola ejecutar para tareas de hello en la carga de trabajo utilizando el método Run() de Hola que se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="09d03-307">You can implement hello run logic for hello tasks in your workload by using hello Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs hello task processing logic. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello task processor framework invokes hello Run method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check hello exit code of that program and
/// save output files toopersistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for hello task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="09d03-308">Hello sección anotado en el método Run() de hello es Hola solo sección de código de plantilla de procesador de tareas de Hola que sirve para toomodify mediante la adición de lógica de hello ejecutar para tareas de hello en la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-308">hello annotated section in hello Run() method is hello only section of hello Task Processor template code that is intended for you toomodify by adding hello run logic for hello tasks in your workload.</span></span> <span data-ttu-id="09d03-309">Si desea toomodify otra sección de la plantilla de hello, póngase en primer lugar familiarizarse con el funcionamiento de lote revisando la documentación de lote de Hola y probar algunos de los ejemplos de código de hello por lotes.</span><span class="sxs-lookup"><span data-stu-id="09d03-309">If you want toomodify a different section of hello template, please first familiarize yourself with how Batch works by reviewing hello Batch documentation and trying out a few of hello Batch code samples.</span></span>
> 
> 

<span data-ttu-id="09d03-310">método Run() de Hello es responsable de iniciar la línea de comandos de Hola, a partir de uno o varios procesos, esperando toocomplete de todos los procesos, guardar los resultados de Hola y por último, se devuelve con un código de salida.</span><span class="sxs-lookup"><span data-stu-id="09d03-310">hello Run() method is responsible for launching hello command line, starting one or more processes, waiting for all process toocomplete, saving hello results, and finally returning with an exit code.</span></span> <span data-ttu-id="09d03-311">método Run() de Hello es donde se implementa Hola lógica para las tareas de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="09d03-311">hello Run() method is where you implement hello processing logic for your tasks.</span></span> <span data-ttu-id="09d03-312">marco de trabajo de procesador de tarea de Hello invoca el método Run() de hello no es necesario toocall usted mismo.</span><span class="sxs-lookup"><span data-stu-id="09d03-312">hello task processor framework invokes hello Run() method for you; you do not need toocall it yourself.</span></span>

<span data-ttu-id="09d03-313">La implementación de Run() dispone de acceso a:</span><span class="sxs-lookup"><span data-stu-id="09d03-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="09d03-314">Hola parámetros de tareas, a través de hello `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="09d03-314">hello task parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="09d03-315">Hola identificadores de trabajos y tareas, a través de hello `_jobId` y `_taskId` campos.</span><span class="sxs-lookup"><span data-stu-id="09d03-315">hello job and task ids, via hello `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="09d03-316">configuración de la tarea de Hello, a través de hello `_configuration` campo.</span><span class="sxs-lookup"><span data-stu-id="09d03-316">hello task configuration, via hello `_configuration` field.</span></span>

<span data-ttu-id="09d03-317">**Error de tarea**</span><span class="sxs-lookup"><span data-stu-id="09d03-317">**Task failure**</span></span>

<span data-ttu-id="09d03-318">En caso de error, puede salir del método Run() de hello iniciando una excepción, pero esto deja el controlador de excepciones de nivel superior de hello en control de código de salida de tarea de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-318">In case of failure, you can exit hello Run() method by throwing an exception, but this leaves hello top level exception handler in control of hello task exit code.</span></span> <span data-ttu-id="09d03-319">Si tiene código de salida de hello toocontrol para que pueda distinguir diferentes tipos de error, por ejemplo con fines de diagnóstico o porque deben finalizar algunos modos de error trabajo hello y otros usuarios no deberían, a continuación, debe salir método Run() de hello devolviendo un código de salida distinto de cero.</span><span class="sxs-lookup"><span data-stu-id="09d03-319">If you need toocontrol hello exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate hello job and others should not, then you should exit hello Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="09d03-320">Esto se convierte en código de salida de tarea de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-320">This becomes hello task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-task-processor-template"></a><span data-ttu-id="09d03-321">Salir de códigos y las excepciones producidas en la plantilla de procesador de tareas de Hola</span><span class="sxs-lookup"><span data-stu-id="09d03-321">Exit codes and exceptions in hello Task Processor template</span></span>
<span data-ttu-id="09d03-322">Códigos de salida y las excepciones proporcionan un resultado de hello toodetermine mecanismo de ejecutar un programa, y pueden ayudar a identificar los problemas con la ejecución del programa Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-322">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help identify any problems with hello execution of hello program.</span></span> <span data-ttu-id="09d03-323">plantilla de procesador de tareas de Hello implementa códigos de salida de hello y excepciones que se describen en esta sección.</span><span class="sxs-lookup"><span data-stu-id="09d03-323">hello Task Processor template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="09d03-324">Una tarea de procesador de tarea que se implementa con la plantilla de procesador de tareas de hello puede devolver tres códigos de salida posibles:</span><span class="sxs-lookup"><span data-stu-id="09d03-324">A task processor task that is implemented with hello Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="09d03-325">Código</span><span class="sxs-lookup"><span data-stu-id="09d03-325">Code</span></span> | <span data-ttu-id="09d03-326">Descripción</span><span class="sxs-lookup"><span data-stu-id="09d03-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="09d03-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="09d03-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="09d03-328">procesador de la tarea de Hello ejecutó toocompletion.</span><span class="sxs-lookup"><span data-stu-id="09d03-328">hello task processor ran toocompletion.</span></span> <span data-ttu-id="09d03-329">Tenga en cuenta que esto no implica ese programa Hola invocó fue correcto, sólo dicho procesador de la tarea de hello lo invocó correctamente y realiza cualquier procesamiento posterior sin excepciones.</span><span class="sxs-lookup"><span data-stu-id="09d03-329">Note that this does not imply that hello program you invoked was successful – only that hello task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="09d03-330">significado de Hola de código de salida de hello depende de programa Hola invocada: normalmente el código de salida 0 significa programa Hola se realizó correctamente y cualquier otro código de salida significa programa Hola produjo un error.</span><span class="sxs-lookup"><span data-stu-id="09d03-330">hello meaning of hello exit code depends on hello invoked program – typically exit code 0 means hello program succeeded and any other exit code means hello program failed.</span></span> |
| <span data-ttu-id="09d03-331">1</span><span class="sxs-lookup"><span data-stu-id="09d03-331">1</span></span> |<span data-ttu-id="09d03-332">procesador de la tarea de Hello error con una excepción en una parte 'esperada' del programa Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-332">hello task processor failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="09d03-333">excepción Hello fue tooa traducido `TaskProcessorException` con información de diagnóstico y, siempre que sea posible, sugerencias para resolver Hola error.</span><span class="sxs-lookup"><span data-stu-id="09d03-333">hello exception was translated tooa `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="09d03-334">2</span><span class="sxs-lookup"><span data-stu-id="09d03-334">2</span></span> |<span data-ttu-id="09d03-335">procesador de la tarea de Hello error con una excepción 'inesperada'.</span><span class="sxs-lookup"><span data-stu-id="09d03-335">hello task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="09d03-336">Hello excepción toostandard registrado de salida, pero procesador de tareas de hello es tooadd no se puede cualquier información adicional de diagnóstico o corrección.</span><span class="sxs-lookup"><span data-stu-id="09d03-336">hello exception was logged toostandard output, but hello task processor was unable tooadd any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="09d03-337">Si programa Hola que invocar utiliza modos de error específico de tooindicate de salida códigos 1 y 2, a continuación, usar códigos de salida 1 y 2 para errores del procesador de tareas es ambiguo.</span><span class="sxs-lookup"><span data-stu-id="09d03-337">If hello program you invoke uses exit codes 1 and 2 tooindicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="09d03-338">Puede cambiar estos códigos de salida de tarea procesador error códigos toodistinctive mediante la edición de casos de excepción de hello en el archivo Program.cs de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-338">You can change these task processor error codes toodistinctive exit codes by editing hello exception cases in hello Program.cs file.</span></span>
> 
> 

<span data-ttu-id="09d03-339">Toda la información de hello devuelta por las excepciones se escribe en los archivos stdout.txt y stderr.txt.</span><span class="sxs-lookup"><span data-stu-id="09d03-339">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="09d03-340">Para obtener más información, vea control de errores, en hello documentación de lote.</span><span class="sxs-lookup"><span data-stu-id="09d03-340">For more information, see Error Handling, in hello Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="09d03-341">Consideraciones de cliente</span><span class="sxs-lookup"><span data-stu-id="09d03-341">Client considerations</span></span>
<span data-ttu-id="09d03-342">**Credenciales de almacenamiento**</span><span class="sxs-lookup"><span data-stu-id="09d03-342">**Storage credentials**</span></span>

<span data-ttu-id="09d03-343">Si el procesador de tareas utiliza salidas de toopersist de almacenamiento de blobs de Azure, por ejemplo mediante la biblioteca auxiliar de hello archivo convenciones, a continuación, necesita acceso demasiado*cualquier* Hola las credenciales de cuenta de almacenamiento de nube *o* una URL de contenedor de blob que incluya una firma de acceso compartido (SAS).</span><span class="sxs-lookup"><span data-stu-id="09d03-343">If your task processor uses Azure blob storage toopersist outputs, for example using hello file conventions helper library, then it needs access too*either* hello cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="09d03-344">plantilla de Hello incluye compatibilidad para proporcionar las credenciales a través de las variables de entorno comunes.</span><span class="sxs-lookup"><span data-stu-id="09d03-344">hello template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="09d03-345">El cliente puede pasar las credenciales de almacenamiento de hello como sigue:</span><span class="sxs-lookup"><span data-stu-id="09d03-345">Your client can pass hello storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="09d03-346">cuenta de almacenamiento de Hello, a continuación, está disponible en hello TaskProcessor clase a través de hello `_configuration.StorageAccount` propiedad.</span><span class="sxs-lookup"><span data-stu-id="09d03-346">hello storage account is then available in hello TaskProcessor class via hello `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="09d03-347">Si lo prefiere toouse una dirección URL del contenedor con SAS, también, puede pasar a través de una configuración de entorno de trabajo comunes, pero plantilla de procesador de tarea hello no incluye compatibilidad integrada para este actualmente.</span><span class="sxs-lookup"><span data-stu-id="09d03-347">If you prefer toouse a container URL with SAS, you can also pass this via an job common environment setting, but hello task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="09d03-348">**Configuración de almacenamiento**</span><span class="sxs-lookup"><span data-stu-id="09d03-348">**Storage setup**</span></span>

<span data-ttu-id="09d03-349">Se recomienda esa tarea del Administrador de cliente o el trabajo de hello crear cualquier contenedor necesita tareas antes de agregar Hola tareas toohello trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-349">It is recommended that hello client or job manager task create any containers required by tasks before adding hello tasks toohello job.</span></span> <span data-ttu-id="09d03-350">Esto es obligatorio que si usa una dirección URL del contenedor con SAS, como por ejemplo, una dirección URL no incluye permiso toocreate Hola contenedor.</span><span class="sxs-lookup"><span data-stu-id="09d03-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission toocreate hello container.</span></span> <span data-ttu-id="09d03-351">Se recomienda incluso si pasa las credenciales de cuenta de almacenamiento, tal y como se guarda todas las tareas de tener toocall CloudBlobContainer.CreateIfNotExistsAsync en el contenedor de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-351">It is recommended even if you pass storage account credentials, as it saves every task having toocall CloudBlobContainer.CreateIfNotExistsAsync on hello container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="09d03-352">Transferencia de parámetros y variables de entorno</span><span class="sxs-lookup"><span data-stu-id="09d03-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="09d03-353">Configuración del entorno de transferencia</span><span class="sxs-lookup"><span data-stu-id="09d03-353">Pass environment settings</span></span>
<span data-ttu-id="09d03-354">Un cliente puede pasar la tarea del Administrador de trabajos de información toohello en forma de Hola de configuración del entorno.</span><span class="sxs-lookup"><span data-stu-id="09d03-354">A client can pass information toohello job manager task in hello form of environment settings.</span></span> <span data-ttu-id="09d03-355">Tarea del Administrador de trabajos de hello, a continuación, puede usar esta información al trabajo de proceso de generación Hola tareas procesador las tareas que se ejecutarán como parte del programa Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-355">This information can then be used by hello job manager task when generating hello task processor tasks that will run as part of hello compute job.</span></span> <span data-ttu-id="09d03-356">Son ejemplos de información de Hola que se puede pasar como configuración del entorno:</span><span class="sxs-lookup"><span data-stu-id="09d03-356">Examples of hello information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="09d03-357">Claves de cuenta y nombre de cuenta de Storage</span><span class="sxs-lookup"><span data-stu-id="09d03-357">Storage account name and account keys</span></span>
* <span data-ttu-id="09d03-358">Dirección URL de la cuenta de Batch</span><span class="sxs-lookup"><span data-stu-id="09d03-358">Batch account URL</span></span>
* <span data-ttu-id="09d03-359">Clave de cuenta de Batch</span><span class="sxs-lookup"><span data-stu-id="09d03-359">Batch account key</span></span>

<span data-ttu-id="09d03-360">Hola servicio por lotes tiene una tarea del administrador mecanismo simple toopass entorno configuración tooa trabajo mediante el uso de hello `EnvironmentSettings` propiedad en [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="09d03-360">hello Batch service has a simple mechanism toopass environment settings tooa job manager task by using hello `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="09d03-361">Por ejemplo, tooget hello `BatchClient` instancia para una cuenta de lote, puede pasar como variables de entorno de cliente de Hola Hola URL de código y comparten las credenciales de clave para la cuenta de lote de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-361">For example, tooget hello `BatchClient` instance for a Batch account, you can pass as environment variables from hello client code hello URL and shared key credentials for hello Batch account.</span></span> <span data-ttu-id="09d03-362">Del mismo modo, cuenta de almacenamiento de hello tooaccess que está había vinculada toohello cuenta de lote, puede pasar el nombre de cuenta de almacenamiento de Hola y clave de cuenta de almacenamiento de hello como variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="09d03-362">Likewise, tooaccess hello storage account that is linked toohello Batch account, you can pass hello storage account name and hello storage account key as environment variables.</span></span>

### <a name="pass-parameters-toohello-job-manager-template"></a><span data-ttu-id="09d03-363">Pase la plantilla de administrador de trabajos de parámetros toohello</span><span class="sxs-lookup"><span data-stu-id="09d03-363">Pass parameters toohello Job Manager template</span></span>
<span data-ttu-id="09d03-364">En muchos casos, resulta útil toopass por trabajo parámetros toohello trabajo tarea del administrador, cualquier trabajo de hello toocontrol dividir el proceso o tareas de hello tooconfigure para Hola trabajo.</span><span class="sxs-lookup"><span data-stu-id="09d03-364">In many cases, it's useful toopass per-job parameters toohello job manager task, either toocontrol hello job splitting process or tooconfigure hello tasks for hello job.</span></span> <span data-ttu-id="09d03-365">Puede hacerlo mediante la carga de un archivo JSON denominado parameters.json como un archivo de recursos para la tarea del Administrador de trabajos de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-365">You can do this by uploading a JSON file named parameters.json as a resource file for hello job manager task.</span></span> <span data-ttu-id="09d03-366">parámetros de Hello, a continuación, pueden estar disponibles en hello `JobSplitter._parameters` campo en la plantilla de administrador de trabajos de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-366">hello parameters can then become available in hello `JobSplitter._parameters` field in hello Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="09d03-367">controlador de parámetros integrados de Hello admite solamente los diccionarios de cadena a la cadena.</span><span class="sxs-lookup"><span data-stu-id="09d03-367">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="09d03-368">Si desea toopass valores complejos de JSON como valores de parámetro, se necesita toopass como cadenas y analizarlos en divisor de trabajo de Hola o modificar un marco hello `Configuration.GetJobParameters` método.</span><span class="sxs-lookup"><span data-stu-id="09d03-368">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello job splitter, or modify hello framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-toohello-task-processor-template"></a><span data-ttu-id="09d03-369">Pase la plantilla de procesador de tareas de parámetros toohello</span><span class="sxs-lookup"><span data-stu-id="09d03-369">Pass parameters toohello Task Processor template</span></span>
<span data-ttu-id="09d03-370">También puede pasar parámetros de tareas tooindividual implementa mediante la plantilla de procesador de tareas de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-370">You can also pass parameters tooindividual tasks implemented using hello Task Processor template.</span></span> <span data-ttu-id="09d03-371">Al igual que con la plantilla de administrador de trabajo de hello, Hola tarea procesador plantilla busca un archivo de recursos denominado</span><span class="sxs-lookup"><span data-stu-id="09d03-371">Just as with hello job manager template, hello task processor template looks for a resource file named</span></span>

<span data-ttu-id="09d03-372">Parameters.JSON y si lo encuentra se carga como diccionario de parámetros de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-372">parameters.json, and if found it loads it as hello parameters dictionary.</span></span> <span data-ttu-id="09d03-373">Hay un par de opciones sobre cómo toopass parámetros toohello tareas del procesador de tareas:</span><span class="sxs-lookup"><span data-stu-id="09d03-373">There are a couple of options for how toopass parameters toohello task processor tasks:</span></span>

* <span data-ttu-id="09d03-374">Reutilizar parámetros del trabajo Hola JSON.</span><span class="sxs-lookup"><span data-stu-id="09d03-374">Reuse hello job parameters JSON.</span></span> <span data-ttu-id="09d03-375">Esto funciona bien si Hola únicos parámetros son las de todo el trabajo (por ejemplo, una representación alto y ancho).</span><span class="sxs-lookup"><span data-stu-id="09d03-375">This works well if hello only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="09d03-376">toodo, al crear un CloudTask en divisor de trabajo de hello, agregar un objeto de archivo de recursos de referencia toohello parameters.json desde ResourceFiles la tarea del Administrador de trabajo hello (`JobSplitter._jobManagerTask.ResourceFiles`) colección de ResourceFiles del toohello CloudTask.</span><span class="sxs-lookup"><span data-stu-id="09d03-376">toodo this, when creating a CloudTask in hello job splitter, add a reference toohello parameters.json resource file object from hello job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="09d03-377">Generar y cargar un documento específico de la tarea parameters.json como parte de la ejecución del divisor de trabajo y hacer referencia a ese blob en la colección de archivos de recursos de la tarea de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in hello task's resource files collection.</span></span> <span data-ttu-id="09d03-378">Esto es necesario si diferentes tareas tienen parámetros distintos.</span><span class="sxs-lookup"><span data-stu-id="09d03-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="09d03-379">Un ejemplo podría ser un escenario de representación en 3D donde índice de marcos de Hola se pasa toohello tareas como un parámetro.</span><span class="sxs-lookup"><span data-stu-id="09d03-379">An example might be a 3D rendering scenario where hello frame index is passed toohello task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="09d03-380">controlador de parámetros integrados de Hello admite solamente los diccionarios de cadena a la cadena.</span><span class="sxs-lookup"><span data-stu-id="09d03-380">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="09d03-381">Si desea toopass valores complejos de JSON como valores de parámetro, se necesita toopass como cadenas y analizarlos en el procesador de la tarea de Hola o modificar un marco hello `Configuration.GetTaskParameters` método.</span><span class="sxs-lookup"><span data-stu-id="09d03-381">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello task processor, or modify hello framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="09d03-382">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="09d03-382">Next steps</span></span>
### <a name="persist-job-and-task-output-tooazure-storage"></a><span data-ttu-id="09d03-383">Conservar el trabajo y salida tooAzure almacenamiento de tareas</span><span class="sxs-lookup"><span data-stu-id="09d03-383">Persist job and task output tooAzure Storage</span></span>
<span data-ttu-id="09d03-384">Otra herramienta útil en el desarrollo de soluciones de Batch es [Azure Batch File Conventions][nuget_package] (Convenciones de archivos de Azure Batch).</span><span class="sxs-lookup"><span data-stu-id="09d03-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="09d03-385">Utilice esta biblioteca de clases de .NET (actualmente en versión preliminar) en el almacén de tooeasily de aplicaciones .NET de lotes y recupere tooand de salidas de tareas desde el almacenamiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="09d03-385">Use this .NET class library (currently in preview) in your Batch .NET applications tooeasily store and retrieve task outputs tooand from Azure Storage.</span></span> <span data-ttu-id="09d03-386">[Conservar la salida de trabajos y tareas de Azure Batch](batch-task-output.md) contiene una descripción completa de la biblioteca de Hola y su uso.</span><span class="sxs-lookup"><span data-stu-id="09d03-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of hello library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="09d03-387">Foro de Batch</span><span class="sxs-lookup"><span data-stu-id="09d03-387">Batch Forum</span></span>
<span data-ttu-id="09d03-388">Hola [foro de lote de Azure] [ forum] en MSDN es una gran colocar toodiscuss por lotes y formular preguntas acerca del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="09d03-388">hello [Azure Batch Forum][forum] on MSDN is a great place toodiscuss Batch and ask questions about hello service.</span></span> <span data-ttu-id="09d03-389">Lea los mensajes útiles publicados y envíe sus preguntas a medida que surjan mientras compila sus soluciones del servicio Batch.</span><span class="sxs-lookup"><span data-stu-id="09d03-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
