---
title: "Usar autenticación de Azure AD para acceder a la API de Azure Media Services con REST | Microsoft Docs"
description: "Aprenda a acceder a la API de Azure Media Services con la autenticación de Azure Active Directory mediante REST."
services: media-services
documentationcenter: 
author: willzhan
manager: cfowler
editor: 
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/17/2017
ms.author: willzhan;juliako
ms.openlocfilehash: 1c62857699fb29b3583363e1c6f2dc7874635f40
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="use-azure-ad-authentication-to-access-the-azure-media-services-api-with-rest"></a><span data-ttu-id="d55e3-103">Usar autenticación de Azure AD para acceder a la API de Azure Media Services con REST</span><span class="sxs-lookup"><span data-stu-id="d55e3-103">Use Azure AD authentication to access the Azure Media Services API with REST</span></span>

<span data-ttu-id="d55e3-104">El equipo de Azure Media Services ha lanzado la compatibilidad con la autenticación de Azure Active Directory (Azure AD) para el acceso a Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-104">The Azure Media Services team has released Azure Active Directory (Azure AD) authentication support for Azure Media Services access.</span></span> <span data-ttu-id="d55e3-105">También ha anunciado planes para dejar de usar la autenticación de Azure Access Control Service para el acceso a Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-105">It also announced plans to deprecate Azure Access Control service authentication for Media Services access.</span></span> <span data-ttu-id="d55e3-106">Dado que cada suscripción de Azure y cada cuenta de Media Services están asociadas a un inquilino de Azure AD, la compatibilidad con la autenticación de Azure AD ofrece muchas ventajas de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d55e3-106">Because every Azure subscription, and every Media Services account, is attached to an Azure AD tenant, Azure AD authentication support brings many security benefits.</span></span> <span data-ttu-id="d55e3-107">Para obtener detalles sobre este cambio y esta migración (si usa el SDK de .NET para Media Services para la aplicación), vea las entradas de blog y los artículos siguientes:</span><span class="sxs-lookup"><span data-stu-id="d55e3-107">For details about this change and migration (if you use the Media Services .NET SDK for your app), see the following blog posts and articles:</span></span>

- <span data-ttu-id="d55e3-108">[Azure Media Services announces support for Azure AD and deprecation of Access Control authentication](https://azure.microsoft.com/blog/azure%20media%20service%20aad%20auth%20and%20acs%20deprecation) (Azure Media Services anuncia la compatibilidad con Azure AD y el desuso de la autenticación de Access Control)</span><span class="sxs-lookup"><span data-stu-id="d55e3-108">[Azure Media Services announces support for Azure AD and deprecation of Access Control authentication](https://azure.microsoft.com/blog/azure%20media%20service%20aad%20auth%20and%20acs%20deprecation)</span></span>
- <span data-ttu-id="d55e3-109">[Access Azure Media Services API by using Azure AD authentication](media-services-use-aad-auth-to-access-ams-api.md) (Acceder a la API de Azure Media Services mediante la autenticación de Azure AD)</span><span class="sxs-lookup"><span data-stu-id="d55e3-109">[Access Azure Media Services API by using Azure AD authentication](media-services-use-aad-auth-to-access-ams-api.md)</span></span>
- <span data-ttu-id="d55e3-110">[Use Azure AD authentication to access Azure Media Services API by using Microsoft .NET](media-services-dotnet-get-started-with-aad.md) (Usar autenticación de Azure AD para acceder a la API de Azure Media Services con Microsoft .NET)</span><span class="sxs-lookup"><span data-stu-id="d55e3-110">[Use Azure AD authentication to access Azure Media Services API by using Microsoft .NET](media-services-dotnet-get-started-with-aad.md)</span></span>
- <span data-ttu-id="d55e3-111">[Getting started with Azure AD authentication by using the Azure portal](media-services-portal-get-started-with-aad.md) (Introducción a la autenticación de Azure AD mediante Azure Portal)</span><span class="sxs-lookup"><span data-stu-id="d55e3-111">[Getting started with Azure AD authentication by using the Azure portal](media-services-portal-get-started-with-aad.md)</span></span>

<span data-ttu-id="d55e3-112">Algunos clientes necesitan desarrollar sus soluciones de Media Services con las restricciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="d55e3-112">Some customers need to develop their Media Services solutions under the following constraints:</span></span>

*   <span data-ttu-id="d55e3-113">Usan un lenguaje de programación que no es Microsoft .NET ni C#, o el entorno de runtime no es Windows.</span><span class="sxs-lookup"><span data-stu-id="d55e3-113">They use a programming language that is not Microsoft .NET or C#, or the runtime environment is not Windows.</span></span>
*   <span data-ttu-id="d55e3-114">Las bibliotecas de Azure AD, como la Biblioteca de autenticación de Active Directory, no están disponibles para el lenguaje de programación o no se pueden usar para su entorno de runtime.</span><span class="sxs-lookup"><span data-stu-id="d55e3-114">Azure AD libraries such as Active Directory Authentication Libraries are not available for the programming language or can't be used for their runtime environment.</span></span>

<span data-ttu-id="d55e3-115">Algunos clientes han desarrollado aplicaciones mediante la API de REST para la autenticación de Access Control y el acceso a Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-115">Some customers have developed applications by using REST API for both Access Control authentication and Azure Media Services access.</span></span> <span data-ttu-id="d55e3-116">Para estos clientes, necesita una forma de usar solo la API de REST para la autenticación de Azure AD y el subsiguiente acceso a Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-116">For these customers, you need a way to use only the REST API for Azure AD authentication and subsequent Azure Media Services access.</span></span> <span data-ttu-id="d55e3-117">Necesita no depender de ninguna de las bibliotecas de Azure AD ni del SDK de .NET para Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-117">You need to not rely on any of the Azure AD libraries or on the Media Services .NET SDK.</span></span> <span data-ttu-id="d55e3-118">En este artículo se describe una solución y se proporciona código de ejemplo para este escenario.</span><span class="sxs-lookup"><span data-stu-id="d55e3-118">In this article, we describe a solution and provide sample code for this scenario.</span></span> <span data-ttu-id="d55e3-119">Dado que el código es todo llamadas API de REST, sin ninguna dependencia con ninguna biblioteca de Azure AD o Azure Media Services, se puede traducir fácilmente a cualquier otro lenguaje de programación.</span><span class="sxs-lookup"><span data-stu-id="d55e3-119">Because the code is all REST API calls, with no dependency on any Azure AD or Azure Media Services library, the code can easily be translated to any other programming language.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d55e3-120">Actualmente Media Services es compatible con el modelo de autenticación de Azure Access Control Service.</span><span class="sxs-lookup"><span data-stu-id="d55e3-120">Currently, Media Services supports the Azure Access Control services authentication model.</span></span> <span data-ttu-id="d55e3-121">No obstante, la autenticación de Access Control dejará de usarse el 1 de junio de 2018.</span><span class="sxs-lookup"><span data-stu-id="d55e3-121">However, Access Control authentication will be deprecated June 1, 2018.</span></span> <span data-ttu-id="d55e3-122">Se recomienda migrar tan pronto como sea posible al modelo de autenticación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d55e3-122">We recommend that you migrate to the Azure AD authentication model as soon as possible.</span></span>


## <a name="design"></a><span data-ttu-id="d55e3-123">Diseño</span><span class="sxs-lookup"><span data-stu-id="d55e3-123">Design</span></span>

<span data-ttu-id="d55e3-124">En este artículo se usa el siguiente diseño de autenticación y autorización:</span><span class="sxs-lookup"><span data-stu-id="d55e3-124">In this article, we use the following authentication and authorization design:</span></span>

*  <span data-ttu-id="d55e3-125">Protocolo de autorización: OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="d55e3-125">Authorization protocol: OAuth 2.0.</span></span> <span data-ttu-id="d55e3-126">OAuth 2.0 es un estándar de seguridad web que cubre la autenticación y la autorización.</span><span class="sxs-lookup"><span data-stu-id="d55e3-126">OAuth 2.0 is a web security standard that covers both authentication and authorization.</span></span> <span data-ttu-id="d55e3-127">Es compatible con Google, Microsoft, Facebook y PayPal.</span><span class="sxs-lookup"><span data-stu-id="d55e3-127">It is supported by Google, Microsoft, Facebook, and PayPal.</span></span> <span data-ttu-id="d55e3-128">Se ratificó en octubre de 2012.</span><span class="sxs-lookup"><span data-stu-id="d55e3-128">It was ratified October 2012.</span></span> <span data-ttu-id="d55e3-129">Microsoft es firme partidario de OAuth 2.0 y OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="d55e3-129">Microsoft firmly supports OAuth 2.0 and OpenID Connect.</span></span> <span data-ttu-id="d55e3-130">Ambos estándares son compatibles con varios servicios y bibliotecas de cliente, incluidos Azure Active Directory, Open Web Interface for .NET (OWIN), Katana y las bibliotecas de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d55e3-130">Both of these standards are supported in multiple services and client libraries, including Azure Active Directory, Open Web Interface for .NET (OWIN) Katana, and Azure AD libraries.</span></span>
*  <span data-ttu-id="d55e3-131">Tipo de concesión: credenciales de cliente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-131">Grant type: Client credentials grant type.</span></span> <span data-ttu-id="d55e3-132">Credenciales de cliente es uno de los cuatro tipos de concesión de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="d55e3-132">Client credentials is one of the four grant types in OAuth 2.0.</span></span> <span data-ttu-id="d55e3-133">A menudo se usa para el acceso a la API de Microsoft Graph de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d55e3-133">It's often used for Azure AD Microsoft Graph API access.</span></span>
*  <span data-ttu-id="d55e3-134">Modo de autenticación: entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="d55e3-134">Authentication mode: Service principal.</span></span> <span data-ttu-id="d55e3-135">El otro modo de autenticación es la autenticación interactiva o de usuario.</span><span class="sxs-lookup"><span data-stu-id="d55e3-135">The other authentication mode is user or interactive authentication.</span></span>

<span data-ttu-id="d55e3-136">En el flujo de autenticación y autorización de Azure AD para el uso de Media Services hay implicados un total de cuatro aplicaciones o servicios.</span><span class="sxs-lookup"><span data-stu-id="d55e3-136">A total of four applications or services are involved in the Azure AD authentication and authorization flow for using Media Services.</span></span> <span data-ttu-id="d55e3-137">Las aplicaciones, los servicios y el flujo se describen en la tabla siguiente:</span><span class="sxs-lookup"><span data-stu-id="d55e3-137">The applications and services, and the flow, are described in the following table:</span></span>

|<span data-ttu-id="d55e3-138">Tipo de aplicación</span><span class="sxs-lookup"><span data-stu-id="d55e3-138">Application type</span></span> |<span data-ttu-id="d55e3-139">Application</span><span class="sxs-lookup"><span data-stu-id="d55e3-139">Application</span></span> |<span data-ttu-id="d55e3-140">Flujo</span><span class="sxs-lookup"><span data-stu-id="d55e3-140">Flow</span></span>|
|---|---|---|
|<span data-ttu-id="d55e3-141">Cliente</span><span class="sxs-lookup"><span data-stu-id="d55e3-141">Client</span></span> | <span data-ttu-id="d55e3-142">Aplicación o solución de cliente</span><span class="sxs-lookup"><span data-stu-id="d55e3-142">Customer app or solution</span></span> | <span data-ttu-id="d55e3-143">Esta aplicación (en realidad, su proxy) se registra en el inquilino de Azure AD en el que residen la suscripción de Azure y la cuenta del servicio multimedia.</span><span class="sxs-lookup"><span data-stu-id="d55e3-143">This app (actually, its proxy) is registered in the Azure AD tenant in which the Azure subscription and the media service account reside.</span></span> <span data-ttu-id="d55e3-144">Luego se concede a la entidad de servicio de la aplicación registrada el rol de Propietario o Colaborador en el control de acceso (IAM) de la cuenta del servicio multimedia.</span><span class="sxs-lookup"><span data-stu-id="d55e3-144">The service principal of the registered app is then granted with Owner or Contributor role in the Access Control (IAM) of the media service account.</span></span> <span data-ttu-id="d55e3-145">La entidad de servicio se representa mediante el identificador de cliente de la aplicación y el secreto de cliente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-145">The service principal is represented by the app client ID and client secret.</span></span> |
|<span data-ttu-id="d55e3-146">Proveedor de identidades (IDP)</span><span class="sxs-lookup"><span data-stu-id="d55e3-146">Identity Provider (IDP)</span></span> | <span data-ttu-id="d55e3-147">Azure AD como IDP</span><span class="sxs-lookup"><span data-stu-id="d55e3-147">Azure AD as IDP</span></span> | <span data-ttu-id="d55e3-148">La entidad de servicio de la aplicación registrada (id. de cliente y secreto de cliente) se autentica con Azure AD como IDP.</span><span class="sxs-lookup"><span data-stu-id="d55e3-148">The registered app service principal (client ID and client secret) is authenticated by Azure AD as the IDP.</span></span> <span data-ttu-id="d55e3-149">Esta autenticación se realiza interna e implícitamente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-149">This authentication is performed internally and implicitly.</span></span> <span data-ttu-id="d55e3-150">Como en el flujo de credenciales de cliente, se autentica el cliente en lugar del usuario.</span><span class="sxs-lookup"><span data-stu-id="d55e3-150">As in client credentials flow, the client is authenticated instead of the user.</span></span> |
|<span data-ttu-id="d55e3-151">Servicio de token seguro (STS) o servidor OAuth</span><span class="sxs-lookup"><span data-stu-id="d55e3-151">Secure Token Service (STS)/OAuth server</span></span> | <span data-ttu-id="d55e3-152">Azure AD como STS</span><span class="sxs-lookup"><span data-stu-id="d55e3-152">Azure AD as STS</span></span> | <span data-ttu-id="d55e3-153">Después de la autenticación mediante el IDP (o el servidor OAuth en términos de OAuth 2.0), Azure AD emite un token de acceso o JSON Web Token (JWT) como STS o servidor OAuth para el acceso al recurso de nivel intermedio: en nuestro caso, el punto de conexión de la API de REST de Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-153">After authentication by the IDP (or OAuth Server in OAuth 2.0 terms), an access token or JSON Web Token (JWT) is issued by Azure AD as STS/OAuth Server for access to the middle-tier resource: in our case, the Media Services REST API endpoint.</span></span> |
|<span data-ttu-id="d55e3-154">Recurso</span><span class="sxs-lookup"><span data-stu-id="d55e3-154">Resource</span></span> | <span data-ttu-id="d55e3-155">API de REST de Media Services</span><span class="sxs-lookup"><span data-stu-id="d55e3-155">Media Services REST API</span></span> | <span data-ttu-id="d55e3-156">Todas las llamadas API de REST de Media Services son autorizadas por un token de acceso emitido por Azure AD como STS o servidor OAuth.</span><span class="sxs-lookup"><span data-stu-id="d55e3-156">Every Media Services REST API call is authorized by an access token that is issued by Azure AD as STS or the OAuth server.</span></span> |

<span data-ttu-id="d55e3-157">Si ejecuta el código de ejemplo y captura un JWT o un token de acceso, el JWT tiene los siguientes atributos:</span><span class="sxs-lookup"><span data-stu-id="d55e3-157">If you run the sample code and capture a JWT or an access token, the JWT has the following attributes:</span></span>

    aud: "https://rest.media.azure.net",

    iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/",

    iat: 1497146280,

    nbf: 1497146280,
    exp: 1497150180,

    aio: "Y2ZgYDjuy7SptPzO/muf+uRu1B+ZDQA=",

    appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6",

    appidacr: "1",

    idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/",

    oid: "a938cfcc-d3de-479c-b0dd-d4ffe6f50f7c",

    sub: "a938cfcc-d3de-479c-b0dd-d4ffe6f50f7c",

    tid: "72f988bf-86f1-41af-91ab-2d7cd011db47",

<span data-ttu-id="d55e3-158">Estas son las asignaciones entre los atributos del JWT y las cuatro aplicaciones o servicios de la tabla anterior:</span><span class="sxs-lookup"><span data-stu-id="d55e3-158">Here are the mappings between the attributes in the JWT and the four applications or services in the preceding table:</span></span>

|<span data-ttu-id="d55e3-159">Tipo de aplicación</span><span class="sxs-lookup"><span data-stu-id="d55e3-159">Application type</span></span> |<span data-ttu-id="d55e3-160">Application</span><span class="sxs-lookup"><span data-stu-id="d55e3-160">Application</span></span> |<span data-ttu-id="d55e3-161">Atributo del JWT</span><span class="sxs-lookup"><span data-stu-id="d55e3-161">JWT attribute</span></span> |
|---|---|---|
|<span data-ttu-id="d55e3-162">Cliente</span><span class="sxs-lookup"><span data-stu-id="d55e3-162">Client</span></span> |<span data-ttu-id="d55e3-163">Aplicación o solución de cliente</span><span class="sxs-lookup"><span data-stu-id="d55e3-163">Customer app or solution</span></span> |<span data-ttu-id="d55e3-164">appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6".</span><span class="sxs-lookup"><span data-stu-id="d55e3-164">appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6".</span></span> <span data-ttu-id="d55e3-165">Identificador de cliente de una aplicación que se registrará en Azure AD en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-165">The client ID of an application you will register to Azure AD in the next section.</span></span> |
|<span data-ttu-id="d55e3-166">Proveedor de identidades (IDP)</span><span class="sxs-lookup"><span data-stu-id="d55e3-166">Identity Provider (IDP)</span></span> | <span data-ttu-id="d55e3-167">Azure AD como IDP</span><span class="sxs-lookup"><span data-stu-id="d55e3-167">Azure AD as IDP</span></span> |<span data-ttu-id="d55e3-168">idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span><span class="sxs-lookup"><span data-stu-id="d55e3-168">idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span></span>  <span data-ttu-id="d55e3-169">El GUID es el identificador del inquilino de Microsoft (microsoft.onmicrosoft.com).</span><span class="sxs-lookup"><span data-stu-id="d55e3-169">The GUID is the ID of Microsoft tenant (microsoft.onmicrosoft.com).</span></span> <span data-ttu-id="d55e3-170">Cada inquilino tiene su propio identificador único.</span><span class="sxs-lookup"><span data-stu-id="d55e3-170">Each tenant has its own, unique ID.</span></span> |
|<span data-ttu-id="d55e3-171">Servicio de token seguro (STS) o servidor OAuth</span><span class="sxs-lookup"><span data-stu-id="d55e3-171">Secure Token Service (STS)/OAuth server</span></span> |<span data-ttu-id="d55e3-172">Azure AD como STS</span><span class="sxs-lookup"><span data-stu-id="d55e3-172">Azure AD as STS</span></span> | <span data-ttu-id="d55e3-173">iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span><span class="sxs-lookup"><span data-stu-id="d55e3-173">iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span></span> <span data-ttu-id="d55e3-174">El GUID es el identificador del inquilino de Microsoft (microsoft.onmicrosoft.com).</span><span class="sxs-lookup"><span data-stu-id="d55e3-174">The GUID is the ID of Microsoft tenant (microsoft.onmicrosoft.com).</span></span> |
|<span data-ttu-id="d55e3-175">Recurso</span><span class="sxs-lookup"><span data-stu-id="d55e3-175">Resource</span></span> | <span data-ttu-id="d55e3-176">API de REST de Media Services</span><span class="sxs-lookup"><span data-stu-id="d55e3-176">Media Services REST API</span></span> |<span data-ttu-id="d55e3-177">aud: "https://rest.media.azure.net".</span><span class="sxs-lookup"><span data-stu-id="d55e3-177">aud: "https://rest.media.azure.net".</span></span> <span data-ttu-id="d55e3-178">Destinatario o audiencia del token de acceso.</span><span class="sxs-lookup"><span data-stu-id="d55e3-178">The recipient or audience of the access token.</span></span> |

## <a name="steps-for-setup"></a><span data-ttu-id="d55e3-179">Pasos de configuración</span><span class="sxs-lookup"><span data-stu-id="d55e3-179">Steps for setup</span></span>

<span data-ttu-id="d55e3-180">Para registrar y configurar una aplicación de Azure AD para la autenticación de Azure AD y para obtener un token de acceso para llamar a un punto de conexión de la API de REST de Azure Media Services, realice los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="d55e3-180">To register and set up an Azure AD application for Azure AD authentication, and to obtain an access token for calling the Azure Media Services REST API endpoint, complete the following steps:</span></span>

1.  <span data-ttu-id="d55e3-181">En el [portal de Azure clásico](http://go.microsoft.com/fwlink/?LinkID=213885), registre una aplicación de Azure AD (por ejemplo, wzmediaservice) para el inquilino de Azure AD (por ejemplo, microsoft.onmicrosoft.com).</span><span class="sxs-lookup"><span data-stu-id="d55e3-181">In the [Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=213885), register an Azure AD application (for example, wzmediaservice) to the Azure AD tenant (for example, microsoft.onmicrosoft.com).</span></span> <span data-ttu-id="d55e3-182">No importa si se ha registrado como aplicación web o nativa.</span><span class="sxs-lookup"><span data-stu-id="d55e3-182">It doesn't matter whether you registered as web app or native app.</span></span> <span data-ttu-id="d55e3-183">Además, puede elegir cualquier dirección URL de inicio de sesión y de respuesta (por ejemplo, http://wzmediaservice.com para ambas).</span><span class="sxs-lookup"><span data-stu-id="d55e3-183">Also, you can choose any sign-on URL and reply URL (for example, http://wzmediaservice.com for both).</span></span>
2. <span data-ttu-id="d55e3-184">En el [portal de Azure clásico](http://go.microsoft.com/fwlink/?LinkID=213885), vaya a la pestaña **Configurar** de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d55e3-184">In the [Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=213885), go to the **Configure** tab of your application.</span></span> <span data-ttu-id="d55e3-185">Anote el **Id. de cliente**.</span><span class="sxs-lookup"><span data-stu-id="d55e3-185">Note the **client ID**.</span></span> <span data-ttu-id="d55e3-186">Luego, en **Claves**, genere una **clave de cliente** (secreto del cliente).</span><span class="sxs-lookup"><span data-stu-id="d55e3-186">Then, under **Keys**, generate a **client key** (client secret).</span></span> 

    > [!NOTE] 
    > <span data-ttu-id="d55e3-187">Anote el secreto del cliente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-187">Take note of the client secret.</span></span> <span data-ttu-id="d55e3-188">No se volverá a mostrar.</span><span class="sxs-lookup"><span data-stu-id="d55e3-188">It won't be shown again.</span></span>
    
3.  <span data-ttu-id="d55e3-189">En [Azure Portal](http://ms.portal.azure.com), vaya a la cuenta de Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-189">In the [Azure portal](http://ms.portal.azure.com), go to the Media Services account.</span></span> <span data-ttu-id="d55e3-190">Seleccione el panel **Control de acceso (IAM)**.</span><span class="sxs-lookup"><span data-stu-id="d55e3-190">Select the **Access Control** (IAM) pane.</span></span> <span data-ttu-id="d55e3-191">Agregue un nuevo miembro que tenga el rol Propietario o Colaborador.</span><span class="sxs-lookup"><span data-stu-id="d55e3-191">Add a new member that has either the Owner or the Contributor role.</span></span> <span data-ttu-id="d55e3-192">Para la entidad de seguridad, busque el nombre de la aplicación registrada en el paso 1 (en este ejemplo, wzmediaservice).</span><span class="sxs-lookup"><span data-stu-id="d55e3-192">For the principal, search for the application name you registered in step 1 (in this example, wzmediaservice).</span></span>

## <a name="info-to-collect"></a><span data-ttu-id="d55e3-193">Información que se debe recopilar</span><span class="sxs-lookup"><span data-stu-id="d55e3-193">Info to collect</span></span>

<span data-ttu-id="d55e3-194">Para preparar la codificación de REST, recopile los siguientes puntos de datos que se incluirán en el código:</span><span class="sxs-lookup"><span data-stu-id="d55e3-194">To prepare REST coding, collect the following data points to include in the code:</span></span>

*   <span data-ttu-id="d55e3-195">Azure AD como punto de conexión de STS: https://login.microsoftonline.com/microsoft.onmicrosoft.com/oauth2/token.</span><span class="sxs-lookup"><span data-stu-id="d55e3-195">Azure AD as an STS endpoint: https://login.microsoftonline.com/microsoft.onmicrosoft.com/oauth2/token.</span></span> <span data-ttu-id="d55e3-196">Desde este punto de conexión se solicita un token de acceso JWT.</span><span class="sxs-lookup"><span data-stu-id="d55e3-196">From this endpoint, a JWT access token is requested.</span></span> <span data-ttu-id="d55e3-197">Además de actuar como IDP, Azure AD también lo hace como STS.</span><span class="sxs-lookup"><span data-stu-id="d55e3-197">In addition to serving as an IDP, Azure AD also serves as an STS.</span></span> <span data-ttu-id="d55e3-198">Azure AD emite un JWT para el acceso a los recursos (un token de acceso).</span><span class="sxs-lookup"><span data-stu-id="d55e3-198">Azure AD issues a JWT for resource access (an access token).</span></span> <span data-ttu-id="d55e3-199">Un token JWT tiene distintas notificaciones.</span><span class="sxs-lookup"><span data-stu-id="d55e3-199">A JWT token has various claims.</span></span>
*   <span data-ttu-id="d55e3-200">API de REST de Azure Media Services como recurso o audiencia: https://rest.media.azure.net.</span><span class="sxs-lookup"><span data-stu-id="d55e3-200">Azure Media Services REST API as resource or audience: https://rest.media.azure.net.</span></span>
*   <span data-ttu-id="d55e3-201">Id. de cliente: vea el paso 2 de [Pasos de configuración](#steps-for-setup).</span><span class="sxs-lookup"><span data-stu-id="d55e3-201">Client ID: See step 2 in [Steps for setup](#steps-for-setup).</span></span>
*   <span data-ttu-id="d55e3-202">Secreto del cliente: vea el paso 2 de [Pasos de configuración](#steps-for-setup).</span><span class="sxs-lookup"><span data-stu-id="d55e3-202">Client secret: See step 2 in  [Steps for setup](#steps-for-setup).</span></span>
*   <span data-ttu-id="d55e3-203">El punto de conexión de la API de REST de la cuenta de Media Services en el formato siguiente:</span><span class="sxs-lookup"><span data-stu-id="d55e3-203">Your Media Services account REST API endpoint in the following format:</span></span>

    <span data-ttu-id="d55e3-204">https://[media_service_account_name].restv2.[data_center].media.azure.net/API</span><span class="sxs-lookup"><span data-stu-id="d55e3-204">https://[media_service_account_name].restv2.[data_center].media.azure.net/API</span></span> 

    <span data-ttu-id="d55e3-205">Este es el punto de conexión en el que se realizan todas las llamadas API de REST de Media Services en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d55e3-205">This is the endpoint against which all Media Services REST API calls in your application are made.</span></span> <span data-ttu-id="d55e3-206">Por ejemplo, https://willzhanmswjapan.restv2.japanwest.media.azure.net/API.</span><span class="sxs-lookup"><span data-stu-id="d55e3-206">For example, https://willzhanmswjapan.restv2.japanwest.media.azure.net/API.</span></span>

<span data-ttu-id="d55e3-207">Luego puede colocar estos cinco parámetros en el archivo web.config o app.config para su uso en el código.</span><span class="sxs-lookup"><span data-stu-id="d55e3-207">You can then put these five parameters in your web.config or app.config file, to use in your code.</span></span>

## <a name="sample-code"></a><span data-ttu-id="d55e3-208">Código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="d55e3-208">Sample code</span></span>

<span data-ttu-id="d55e3-209">Puede encontrar el código de ejemplo en [Azure AD Authentication for Azure Media Services Access: Both via REST API](https://github.com/willzhan/WAMSRESTSoln) (Autenticación de Azure AD para el acceso a Azure Media Services: a través de la API de REST).</span><span class="sxs-lookup"><span data-stu-id="d55e3-209">You can find the sample code in [Azure AD Authentication for Azure Media Services Access: Both via REST API](https://github.com/willzhan/WAMSRESTSoln).</span></span>

<span data-ttu-id="d55e3-210">El código de ejemplo tiene dos partes:</span><span class="sxs-lookup"><span data-stu-id="d55e3-210">The sample code has two parts:</span></span>

*   <span data-ttu-id="d55e3-211">Un proyecto de biblioteca DLL que tiene todo el código de la API de REST para la autorización y autenticación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d55e3-211">A DLL library project that has all the REST API code for Azure AD authentication and authorization.</span></span> <span data-ttu-id="d55e3-212">También tiene un método para realizar llamadas API de REST al punto de conexión de la API de REST de Media Services, con el token de acceso.</span><span class="sxs-lookup"><span data-stu-id="d55e3-212">It also has a method for making REST API calls to the Media Services REST API endpoint, with the access token.</span></span>
*   <span data-ttu-id="d55e3-213">Un cliente de prueba de consola, que inicia la autenticación de Azure AD y llama a distintas API de REST de Media Services.</span><span class="sxs-lookup"><span data-stu-id="d55e3-213">A console test client, which initiates Azure AD authentication and calls different Media Services REST API.</span></span>

<span data-ttu-id="d55e3-214">El proyecto de ejemplo tiene tres características:</span><span class="sxs-lookup"><span data-stu-id="d55e3-214">The sample project has three features:</span></span>

*   <span data-ttu-id="d55e3-215">Autenticaciones de Azure AD a través de la concesión de credenciales de cliente mediante la API de REST únicamente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-215">Azure AD authentications via the client credentials grant by using only the REST API.</span></span>
*   <span data-ttu-id="d55e3-216">Acceso a Azure Media Services mediante la API de REST únicamente.</span><span class="sxs-lookup"><span data-stu-id="d55e3-216">Azure Media Services access by using only the REST API.</span></span>
*   <span data-ttu-id="d55e3-217">Acceso a Azure Storage mediante la API de REST únicamente (al igual que para crear una cuenta de Media Services, mediante la API de REST).</span><span class="sxs-lookup"><span data-stu-id="d55e3-217">Azure Storage access by using only the REST API (as used to create a Media Services account, by using REST API).</span></span>


## <a name="where-is-the-refresh-token"></a><span data-ttu-id="d55e3-218">¿Dónde está el token de actualización?</span><span class="sxs-lookup"><span data-stu-id="d55e3-218">Where is the refresh token?</span></span>

<span data-ttu-id="d55e3-219">Algunos lectores podrían preguntar: ¿dónde está el token de actualización?</span><span class="sxs-lookup"><span data-stu-id="d55e3-219">Some readers might ask: Where is the refresh token?</span></span> <span data-ttu-id="d55e3-220">¿Por qué no usar aquí un token de actualización?</span><span class="sxs-lookup"><span data-stu-id="d55e3-220">Why not use a refresh token here?</span></span>

<span data-ttu-id="d55e3-221">El propósito de un token de actualización no es actualizar un token de acceso.</span><span class="sxs-lookup"><span data-stu-id="d55e3-221">The purpose of a refresh token is not to refresh an access token.</span></span> <span data-ttu-id="d55e3-222">Por el contrario, está diseñado para omitir la intervención del usuario o la autenticación del usuario final y aun así obtener un token de acceso válido cuando expire un token anterior.</span><span class="sxs-lookup"><span data-stu-id="d55e3-222">Instead, it is designed to bypass end-user authentication or user intervention and still get a valid access token when an earlier token expires.</span></span> <span data-ttu-id="d55e3-223">Un nombre más adecuado para un token de actualización sería algo como "token de omisión de reinicio de sesión de usuario".</span><span class="sxs-lookup"><span data-stu-id="d55e3-223">A better name for a refresh token might be something like "bypass user re-sign-in token."</span></span>

<span data-ttu-id="d55e3-224">Si usa el flujo de concesión de autorización de OAuth 2.0 (nombre de usuario y contraseña que actúan en nombre de un usuario), un token de actualización ayuda a obtener un token de acceso renovado sin solicitar intervención del usuario.</span><span class="sxs-lookup"><span data-stu-id="d55e3-224">If you use the OAuth 2.0 authorization grant flow (username and password, acting on behalf of a user), a refresh token helps you get a renewed access token without requesting user intervention.</span></span> <span data-ttu-id="d55e3-225">Pero para el flujo de concesión de credenciales de cliente de OAuth 2.0 que se describe en este artículo, el cliente actúa en su propio nombre.</span><span class="sxs-lookup"><span data-stu-id="d55e3-225">However, for the OAuth 2.0 client credentials grant flow that we describe in this article, the client acts on its own behalf.</span></span> <span data-ttu-id="d55e3-226">No necesita ninguna intervención del usuario y el servidor de autorización no necesita (ni va a) proporcionar un token de actualización.</span><span class="sxs-lookup"><span data-stu-id="d55e3-226">You don't need user intervention at all, and the authorization server doesn't need to (and won't) give you a refresh token.</span></span> <span data-ttu-id="d55e3-227">Si depura el método **GetUrlEncodedJWT**, observe que la respuesta desde el punto de conexión del token tiene un token de acceso, pero ningún token de actualización.</span><span class="sxs-lookup"><span data-stu-id="d55e3-227">If you debug the **GetUrlEncodedJWT** method, you notice that the response from the token endpoint has an access token, but no refresh token.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d55e3-228">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="d55e3-228">Next steps</span></span>

<span data-ttu-id="d55e3-229">Empiece a trabajar en la [carga de archivos en la cuenta](media-services-dotnet-upload-files.md).</span><span class="sxs-lookup"><span data-stu-id="d55e3-229">Get started with [uploading files to your account](media-services-dotnet-upload-files.md).</span></span>
