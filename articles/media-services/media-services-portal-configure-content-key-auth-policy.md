---
title: "uso de directivas de autorización de clave de contenido de aaaConfigure Hola portal de Azure | Documentos de Microsoft"
description: "Obtenga información acerca de cómo tooconfigure una directiva de autorización para una clave de contenido."
services: media-services
documentationcenter: 
author: juliako
manager: cfowler
editor: 
ms.assetid: ee82a3fa-c34b-48f2-a108-8ba321f1691e
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/09/2017
ms.author: juliako
ms.openlocfilehash: 157fb691b7f71f4889228817e1dc64555e327d48
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="configure-content-key-authorization-policy"></a><span data-ttu-id="15e1d-103">Configuración de la directiva de autorización de claves de contenido</span><span class="sxs-lookup"><span data-stu-id="15e1d-103">Configure Content Key Authorization Policy</span></span>
[!INCLUDE [media-services-selector-content-key-auth-policy](../../includes/media-services-selector-content-key-auth-policy.md)]

## <a name="overview"></a><span data-ttu-id="15e1d-104">Información general</span><span class="sxs-lookup"><span data-stu-id="15e1d-104">Overview</span></span>
<span data-ttu-id="15e1d-105">Servicios de multimedia de Microsoft Azure le permite toodeliver MPEG-DASH, Smooth Streaming y secuencias de HTTP-Live-Streaming (HLS) protegidas con Advanced Encryption Standard (AES) (con claves de cifrado de 128 bits) o [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span><span class="sxs-lookup"><span data-stu-id="15e1d-105">Microsoft Azure Media Services enables you toodeliver MPEG-DASH, Smooth Streaming, and HTTP-Live-Streaming (HLS) streams protected with Advanced Encryption Standard (AES) (using 128-bit encryption keys) or [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span></span> <span data-ttu-id="15e1d-106">AMS también permite toodeliver guión streams cifrado con Widevine DRM.</span><span class="sxs-lookup"><span data-stu-id="15e1d-106">AMS also enables you toodeliver DASH streams encrypted with Widevine DRM.</span></span> <span data-ttu-id="15e1d-107">PlayReady y Widevine se cifran por hello especificación de cifrado común (ISO/IEC 23001-7 CENC).</span><span class="sxs-lookup"><span data-stu-id="15e1d-107">Both PlayReady and Widevine are encrypted per hello Common Encryption (ISO/IEC 23001-7 CENC) specification.</span></span>

<span data-ttu-id="15e1d-108">Servicios multimedia también ofrecen una **servicio de entrega de clave/licencia** de que los clientes pueden obtener claves de AES o tooplay de licencias de PlayReady/Widevine Hola contenido cifrado.</span><span class="sxs-lookup"><span data-stu-id="15e1d-108">Media Services also provides a **Key/License Delivery Service** from which clients can obtain AES keys or PlayReady/Widevine licenses tooplay hello encrypted content.</span></span>

<span data-ttu-id="15e1d-109">Este tema muestra cómo toouse Hola directiva de autorización de clave de contenido de hello tooconfigure de portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="15e1d-109">This topic shows how toouse hello Azure portal tooconfigure hello content key authorization policy.</span></span> <span data-ttu-id="15e1d-110">se pueden utilizar posteriormente clave Hello toodynamically cifrar el contenido.</span><span class="sxs-lookup"><span data-stu-id="15e1d-110">hello key can later be used toodynamically encrypt your content.</span></span> <span data-ttu-id="15e1d-111">Tenga en cuenta que actualmente se puede cifrar Hola después de formatos de streaming: HLS, MPEG DASH y Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="15e1d-111">Note that currently you can encrypt hello following streaming formats: HLS, MPEG DASH, and Smooth Streaming.</span></span> <span data-ttu-id="15e1d-112">No se pueden cifrar las descargas progresivas.</span><span class="sxs-lookup"><span data-stu-id="15e1d-112">You cannot encrypt progressive downloads.</span></span>

<span data-ttu-id="15e1d-113">Cuando un Reproductor solicita una secuencia que se establece toobe dinámicamente cifrado, servicios multimedia usa Hola configurado clave toodynamically cifrar el contenido con cifrado de AES o DRM.</span><span class="sxs-lookup"><span data-stu-id="15e1d-113">When a player requests a stream that is set toobe dynamically encrypted, Media Services uses hello configured key toodynamically encrypt your content using AES or DRM encryption.</span></span> <span data-ttu-id="15e1d-114">secuencia de hello toodecrypt, Hola Reproductor solicitará clave Hola del servicio de entrega de claves de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-114">toodecrypt hello stream, hello player will request hello key from hello key delivery service.</span></span> <span data-ttu-id="15e1d-115">toodecide si es usuario de hello autorizado tooget clave de hello, servicio de hello evalúa las directivas de autorización de Hola que especificó para la clave de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-115">toodecide whether or not hello user is authorized tooget hello key, hello service evaluates hello authorization policies that you specified for hello key.</span></span>

<span data-ttu-id="15e1d-116">Si plan toohave varias claves de contenido o si desea toospecify una **servicio de entrega de clave/licencia** dirección URL distinta a Hola servicio de entrega de claves de servicios multimedia, use Media Services .NET SDK o las API de REST.</span><span class="sxs-lookup"><span data-stu-id="15e1d-116">If you plan toohave multiple content keys or want toospecify a **Key/License Delivery Service** URL other than hello Media Services key delivery service, use Media Services .NET SDK or REST APIs.</span></span>

[<span data-ttu-id="15e1d-117">Configuración de la directiva de autorización de claves mediante el SDK de Servicios multimedia para .NET</span><span class="sxs-lookup"><span data-stu-id="15e1d-117">Configure Content Key Authorization Policy using Media Services .NET SDK</span></span>](media-services-dotnet-configure-content-key-auth-policy.md)

[<span data-ttu-id="15e1d-118">Configuración de la directiva de autorización de claves mediante la API de REST de Servicios multimedia</span><span class="sxs-lookup"><span data-stu-id="15e1d-118">Configure Content Key Authorization Policy using Media Services REST API</span></span>](media-services-rest-configure-content-key-auth-policy.md)

### <a name="some-considerations-apply"></a><span data-ttu-id="15e1d-119">Se aplican algunas consideraciones:</span><span class="sxs-lookup"><span data-stu-id="15e1d-119">Some considerations apply:</span></span>
* <span data-ttu-id="15e1d-120">Cuando se crea la cuenta de AMS un **predeterminado** extremo de streaming se agrega la cuenta tooyour Hola **detenido** estado.</span><span class="sxs-lookup"><span data-stu-id="15e1d-120">When your AMS account is created a **default** streaming endpoint is added  tooyour account in hello **Stopped** state.</span></span> <span data-ttu-id="15e1d-121">toostart transmisión por secuencias el contenido y beneficiarse del empaquetado dinámico y cifrado dinámico, el extremo de streaming tiene toobe en hello **ejecutando** estado.</span><span class="sxs-lookup"><span data-stu-id="15e1d-121">toostart streaming your content and take advantage of dynamic packaging and dynamic encryption, your streaming endpoint has toobe in hello **Running** state.</span></span> 
* <span data-ttu-id="15e1d-122">El recurso debe contener un conjunto de archivos MP4 de velocidad de bits adaptable o archivos Smooth Streaming de velocidad de bits adaptable.</span><span class="sxs-lookup"><span data-stu-id="15e1d-122">Your asset must contain a set of adaptive bitrate MP4s or adaptive bitrate Smooth Streaming files.</span></span> <span data-ttu-id="15e1d-123">Para obtener más información, consulte [Codificación de un recurso](media-services-encode-asset.md).</span><span class="sxs-lookup"><span data-stu-id="15e1d-123">For more information, see [Encode an asset](media-services-encode-asset.md).</span></span>
* <span data-ttu-id="15e1d-124">Hola servicio de entrega de claves almacena en caché ContentKeyAuthorizationPolicy y sus objetos relacionados (opciones de directivas y restricciones) durante 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="15e1d-124">hello Key Delivery service caches ContentKeyAuthorizationPolicy and its related objects (policy options and restrictions) for 15 minutes.</span></span>  <span data-ttu-id="15e1d-125">Si una contentkeyauthorizationpolicy y especificar una restricción de "Token", toouse, a continuación, probarlo y, a continuación, actualizar la directiva de Hola "Abierto" demasiado restricción, se tardará aproximadamente 15 minutos antes de hello conmutadores toohello "Abierta" versión de la directiva de directiva de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-125">If you create a ContentKeyAuthorizationPolicy and specify toouse a “Token” restriction, then test it, and then update hello policy too“Open” restriction, it will take roughly 15 minutes before hello policy switches toohello “Open” version of hello policy.</span></span>

## <a name="how-to-configure-hello-key-authorization-policy"></a><span data-ttu-id="15e1d-126">Cómo: configurar la directiva de autorización de claves de Hola</span><span class="sxs-lookup"><span data-stu-id="15e1d-126">How to: configure hello key authorization policy</span></span>
<span data-ttu-id="15e1d-127">Directiva de autorización de claves de hello tooconfigure, seleccione hello **protección de contenido** página.</span><span class="sxs-lookup"><span data-stu-id="15e1d-127">tooconfigure hello key authorization policy, select hello **CONTENT PROTECTION** page.</span></span>

<span data-ttu-id="15e1d-128">Servicios multimedia admite varias formas de autenticar a los usuarios que realizan solicitudes de clave.</span><span class="sxs-lookup"><span data-stu-id="15e1d-128">Media Services supports multiple ways of authenticating users who make key requests.</span></span> <span data-ttu-id="15e1d-129">pueden tener directivas de autorización de clave de contenido de Hello **abrir**, **token**, o **IP** restricciones de autorización (**IP** pueden configurarse con SDK de .NET o REST).</span><span class="sxs-lookup"><span data-stu-id="15e1d-129">hello content key authorization policy can have **open**, **token**, or **IP** authorization restrictions (**IP** can be configured with REST or .NET SDK).</span></span>

### <a name="open-restriction"></a><span data-ttu-id="15e1d-130">Restricción open</span><span class="sxs-lookup"><span data-stu-id="15e1d-130">Open restriction</span></span>
<span data-ttu-id="15e1d-131">Hola **abrir** restricción significa sistema Hola ofrecerá hello tooanyone clave que realiza una solicitud de clave.</span><span class="sxs-lookup"><span data-stu-id="15e1d-131">hello **open** restriction means hello system will deliver hello key tooanyone who makes a key request.</span></span> <span data-ttu-id="15e1d-132">Esta restricción puede ser útil para realizar pruebas.</span><span class="sxs-lookup"><span data-stu-id="15e1d-132">This restriction might be useful for testing purposes.</span></span>

![OpenPolicy][open_policy]

### <a name="token-restriction"></a><span data-ttu-id="15e1d-134">Restricción de token</span><span class="sxs-lookup"><span data-stu-id="15e1d-134">Token restriction</span></span>
<span data-ttu-id="15e1d-135">Directiva, presione Hola restringida por token de hello toochoose **TOKEN** botón.</span><span class="sxs-lookup"><span data-stu-id="15e1d-135">toochoose hello token restricted policy, press hello **TOKEN** button.</span></span>

<span data-ttu-id="15e1d-136">Hola **token** directiva restringida debe ir acompañada de un token emitido por un **servicio de Token seguro** (STS).</span><span class="sxs-lookup"><span data-stu-id="15e1d-136">hello **token** restricted policy must be accompanied by a token issued by a **Secure Token Service** (STS).</span></span> <span data-ttu-id="15e1d-137">Servicios multimedia admite tokens en hello **Tokens Web simples** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) formato y **JSON Web Token** formato (JWT).</span><span class="sxs-lookup"><span data-stu-id="15e1d-137">Media Services supports tokens in hello **Simple Web Tokens** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) format and **JSON Web Token** (JWT) format.</span></span> <span data-ttu-id="15e1d-138">Para obtener información, consulte [Autenticación de token JWT](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span><span class="sxs-lookup"><span data-stu-id="15e1d-138">For information, see [JWT token authentication](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span></span>

<span data-ttu-id="15e1d-139">Servicios multimedia no proporciona **Servicios de tokens seguros**.</span><span class="sxs-lookup"><span data-stu-id="15e1d-139">Media Services does not provide **Secure Token Services**.</span></span> <span data-ttu-id="15e1d-140">Puede crear a un STS personalizado o aprovechar símbolos (tokens) de Microsoft Azure ACS tooissue.</span><span class="sxs-lookup"><span data-stu-id="15e1d-140">You can create a custom STS or leverage Microsoft Azure ACS tooissue tokens.</span></span> <span data-ttu-id="15e1d-141">Hola STS debe estar configurado toocreate un token firmado con hello especificado clave y emitir notificaciones que especificó en la configuración de restricción de token de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-141">hello STS must be configured toocreate a token signed with hello specified key and issue claims that you specified in hello token restriction configuration.</span></span> <span data-ttu-id="15e1d-142">Hello servicio de entrega de claves de servicios multimedia devolverá a cliente de toohello clave de cifrado de hello si Hola token es válido y hello notificaciones de token de hello coinciden con los configurados para la clave de contenido de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-142">hello Media Services key delivery service will return hello encryption key toohello client if hello token is valid and hello claims in hello token match those configured for hello content key.</span></span> <span data-ttu-id="15e1d-143">Para obtener más información, consulte [tokens de ACS de Azure de uso tooissue](http://mingfeiy.com/acs-with-key-services).</span><span class="sxs-lookup"><span data-stu-id="15e1d-143">For more information, see [Use Azure ACS tooissue tokens](http://mingfeiy.com/acs-with-key-services).</span></span>

<span data-ttu-id="15e1d-144">Al configurar hello **TOKEN** directiva restringida, debe establecer valores para **clave de verificación**, **emisor** y **audiencia**.</span><span class="sxs-lookup"><span data-stu-id="15e1d-144">When configuring hello **TOKEN** restricted policy, you must set values for **verification key**, **issuer** and **audience**.</span></span> <span data-ttu-id="15e1d-145">clave de verificación principal Hello contiene Hola clave que Hola token se firmó con, el emisor es Hola servicio de token seguro que emite el token de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-145">hello primary verification key contains hello key that hello token was signed with, issuer is hello secure token service that issues hello token.</span></span> <span data-ttu-id="15e1d-146">audiencia de Hello (a veces denominado ámbito) describe intención de hello del token de Hola u Hola recursos Hola token autoriza acceso.</span><span class="sxs-lookup"><span data-stu-id="15e1d-146">hello audience (sometimes called scope) describes hello intent of hello token or hello resource hello token authorizes access to.</span></span> <span data-ttu-id="15e1d-147">Hola servicio de entrega de claves de servicios multimedia valida que estos valores de símbolo (token) de hello coinciden con los valores de hello en plantilla Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-147">hello Media Services key delivery service validates that these values in hello token match hello values in hello template.</span></span>

### <a name="playready"></a><span data-ttu-id="15e1d-148">PlayReady</span><span class="sxs-lookup"><span data-stu-id="15e1d-148">PlayReady</span></span>
<span data-ttu-id="15e1d-149">Al proteger el contenido con **PlayReady**, uno de cosas Hola que debe toospecify en la directiva de autorización es una cadena XML que define la plantilla de licencia de PlayReady de Hola.</span><span class="sxs-lookup"><span data-stu-id="15e1d-149">When protecting your content with **PlayReady**, one of hello things you need toospecify in your authorization policy is an XML string that defines hello PlayReady license template.</span></span> <span data-ttu-id="15e1d-150">De forma predeterminada, se establece Hola después de la directiva:</span><span class="sxs-lookup"><span data-stu-id="15e1d-150">By default, hello following policy is set:</span></span>

<span data-ttu-id="15e1d-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"><LicenseTemplates><PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices><ContentKey i:type="ContentEncryptionKeyFromHeader" /><LicenseType>Nonpersistent</LicenseType><PlayRight><AllowPassingVideoContentToUnknownOutput>Permitido</AllowPassingVideoContentToUnknownOutput></PlayRight></PlayReadyLicenseTemplate></LicenseTemplates></PlayReadyLicenseResponseTemplate></span><span class="sxs-lookup"><span data-stu-id="15e1d-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"> <LicenseTemplates> <PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices> <ContentKey i:type="ContentEncryptionKeyFromHeader" /> <LicenseType>Nonpersistent</LicenseType> <PlayRight> <AllowPassingVideoContentToUnknownOutput>Allowed</AllowPassingVideoContentToUnknownOutput> </PlayRight> </PlayReadyLicenseTemplate> </LicenseTemplates> </PlayReadyLicenseResponseTemplate></span></span>

<span data-ttu-id="15e1d-152">Puede hacer clic en hello **Importar directiva xml** botón y proporcionar un XML diferente que se ajusta toohello esquema XML definido [aquí](media-services-playready-license-template-overview.md).</span><span class="sxs-lookup"><span data-stu-id="15e1d-152">You can click hello **import policy xml** button and provide a different XML which conforms toohello  XML Schema defined [here](media-services-playready-license-template-overview.md).</span></span>

## <a name="next-step"></a><span data-ttu-id="15e1d-153">Paso siguiente</span><span class="sxs-lookup"><span data-stu-id="15e1d-153">Next step</span></span>
<span data-ttu-id="15e1d-154">Consulte las rutas de aprendizaje de Servicios multimedia.</span><span class="sxs-lookup"><span data-stu-id="15e1d-154">Review Media Services learning paths.</span></span>

[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a><span data-ttu-id="15e1d-155">Envío de comentarios</span><span class="sxs-lookup"><span data-stu-id="15e1d-155">Provide feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

[open_policy]: ./media/media-services-portal-configure-content-key-auth-policy/media-services-protect-content-with-open-restriction.png
[token_policy]: ./media/media-services-key-authorization-policy/media-services-protect-content-with-token-restriction.png

