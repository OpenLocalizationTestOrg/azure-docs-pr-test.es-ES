---
title: "Información sobre la mensajería de nube a dispositivo de Azure IoT Hub | Microsoft Docs"
description: "Guía del desarrollador: cómo utilizar la mensajería de nube a dispositivo con IoT Hub. Incluye información sobre el ciclo de vida de los mensajes y las opciones de configuración."
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: dobett
ms.openlocfilehash: 04ac46498c912b0503036f70b7f3d0e28e5a82b8
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="send-cloud-to-device-messages-from-iot-hub"></a><span data-ttu-id="f2725-104">Envío de mensajes de nube a dispositivo desde IoT Hub</span><span class="sxs-lookup"><span data-stu-id="f2725-104">Send cloud-to-device messages from IoT Hub</span></span>

<span data-ttu-id="f2725-105">Para enviar notificaciones unidireccionales a la aplicación para dispositivo desde el back-end de la solución, envíe mensajes de nube a dispositivo desde su centro de IoT al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-105">To send one-way notifications to the device app from your solution back end, send cloud-to-devices messages from your IoT hub to your device.</span></span> <span data-ttu-id="f2725-106">Para obtener una explicación de otras opciones de nube a dispositivos compatibles con IoT Hub, consulte [Guía de comunicación de nube a dispositivo][lnk-c2d-guidance].</span><span class="sxs-lookup"><span data-stu-id="f2725-106">For a discussion of other cloud-to-devices options supported by IoT Hub, see [Cloud-to-device communications guidance][lnk-c2d-guidance].</span></span>

<span data-ttu-id="f2725-107">Se envían mensajes de la nube al dispositivo mediante un punto de conexión orientado al servicio (**/messages/devicebound**).</span><span class="sxs-lookup"><span data-stu-id="f2725-107">You send cloud-to-device messages through a service-facing endpoint (**/messages/devicebound**).</span></span> <span data-ttu-id="f2725-108">Luego, un dispositivo recibe los mensajes mediante un punto de conexión específico del dispositivo (**/devices/{IdDeDispositivo}/messages/devicebound**).</span><span class="sxs-lookup"><span data-stu-id="f2725-108">A device then receives the messages through a device-specific endpoint (**/devices/{deviceId}/messages/devicebound**).</span></span>

<span data-ttu-id="f2725-109">Cada mensaje de la nube al dispositivo se dirige a un único dispositivo al establecer la propiedad **to** en **/devices/{IdDeDispositivo}/messages/devicebound**.</span><span class="sxs-lookup"><span data-stu-id="f2725-109">Each cloud-to-device message is targeted at a single device by setting the **to** property to **/devices/{deviceId}/messages/devicebound**.</span></span>

<span data-ttu-id="f2725-110">La cola de cada dispositivo puede contener como máximo 50 mensajes de la nube al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-110">Each device queue holds at most 50 cloud-to-device messages.</span></span> <span data-ttu-id="f2725-111">Si se intenta enviar más mensajes al mismo dispositivo, se producirá un error.</span><span class="sxs-lookup"><span data-stu-id="f2725-111">Trying to send more messages to the same device results in an error.</span></span>

## <a name="the-cloud-to-device-message-lifecycle"></a><span data-ttu-id="f2725-112">El ciclo de vida de los mensajes de nube a dispositivo</span><span class="sxs-lookup"><span data-stu-id="f2725-112">The cloud-to-device message lifecycle</span></span>

<span data-ttu-id="f2725-113">Para garantizar la entrega de mensajes al menos una vez, IoT Hub conserva los mensajes de nube a dispositivo en colas para cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-113">To guarantee at-least-once message delivery, IoT Hub persists cloud-to-device messages in per-device queues.</span></span> <span data-ttu-id="f2725-114">Los dispositivos tienen que confirmar explícitamente la *finalización* para que el Centro de IoT los quite de la cola.</span><span class="sxs-lookup"><span data-stu-id="f2725-114">Devices must explicitly acknowledge *completion* for IoT Hub to remove them from the queue.</span></span> <span data-ttu-id="f2725-115">Esto garantiza la resistencia frente a errores de dispositivo y de conectividad.</span><span class="sxs-lookup"><span data-stu-id="f2725-115">This approach guarantees resiliency against connectivity and device failures.</span></span>

<span data-ttu-id="f2725-116">En el diagrama siguiente se detalla el gráfico de estado del ciclo de vida de un mensaje de nube a dispositivo en IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="f2725-116">The following diagram shows the lifecycle state graph for a cloud-to-device message in IoT Hub.</span></span>

![Ciclo de vida de los mensajes de nube a dispositivo][img-lifecycle]

<span data-ttu-id="f2725-118">Cuando el servicio IoT Hub envía un mensaje a un dispositivo, el servicio establece el estado del mensaje en **En cola**.</span><span class="sxs-lookup"><span data-stu-id="f2725-118">When the IoT Hub service sends a message to a device, the service sets the message state to **Enqueued**.</span></span> <span data-ttu-id="f2725-119">Cuando un dispositivo quiere *recibir* un mensaje, IoT Hub *bloquea* dicho mensaje (estableciendo el estado en **Invisible**), lo que permite que otros subprocesos del dispositivo empiecen a recibir otros mensajes.</span><span class="sxs-lookup"><span data-stu-id="f2725-119">When a device wants to *receive* a message, IoT Hub *locks* the message (by setting the state to **Invisible**), which allows other threads on the device to start receiving other messages.</span></span> <span data-ttu-id="f2725-120">Cuando el subproceso de un dispositivo termina de procesar un mensaje, informa al Centro de IoT *finalizando* dicho mensaje.</span><span class="sxs-lookup"><span data-stu-id="f2725-120">When a device thread completes the processing of a message, it notifies IoT Hub by *completing* the message.</span></span> <span data-ttu-id="f2725-121">Luego, IoT Hub establece el estado en **Completado**.</span><span class="sxs-lookup"><span data-stu-id="f2725-121">IoT Hub then sets the state to **Completed**.</span></span>

<span data-ttu-id="f2725-122">Un dispositivo también puede hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f2725-122">A device can also choose to:</span></span>

* <span data-ttu-id="f2725-123">*Rechazar* el mensaje, lo que hace que el Centro de IoT lo establezca en estado **Deadlettered** (Procesado como devuelto).</span><span class="sxs-lookup"><span data-stu-id="f2725-123">*Reject* the message, which causes IoT Hub to set it to the **Deadlettered** state.</span></span> <span data-ttu-id="f2725-124">Los dispositivos que se conectan mediante el protocolo MQTT no pueden rechazar mensajes de nube a dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-124">Devices that connect over the MQTT protocol cannot reject cloud-to-device messages.</span></span>
* <span data-ttu-id="f2725-125">*Abandonar* el mensaje, lo que hace que el Centro de IoT vuelva a ponerlo en la cola con el estado **Enqueued**(En cola).</span><span class="sxs-lookup"><span data-stu-id="f2725-125">*Abandon* the message, which causes IoT Hub to put the message back in the queue, with the state set to **Enqueued**.</span></span>

<span data-ttu-id="f2725-126">Podría producirse un error en el subproceso al procesar un mensaje sin notificar a Centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="f2725-126">A thread could fail to process a message without notifying IoT Hub.</span></span> <span data-ttu-id="f2725-127">En este caso, los mensajes pasan automáticamente del estado **Invisible** al estado **Enqueued** (En cola) después de un *tiempo de espera de visibilidad (o bloqueo)*.</span><span class="sxs-lookup"><span data-stu-id="f2725-127">In this case, messages automatically transition from the **Invisible** state back to the **Enqueued** state after a *visibility (or lock) timeout*.</span></span> <span data-ttu-id="f2725-128">El valor predeterminado de este tiempo de espera es un minuto.</span><span class="sxs-lookup"><span data-stu-id="f2725-128">The default value of this timeout is one minute.</span></span>

<span data-ttu-id="f2725-129">Un mensaje puede cambiar entre los estados **Enqueued** (En cola) e **Invisible**, como mucho, el número de veces especificado en la propiedad **Número máximo de entregas** en IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="f2725-129">A message can transition between the **Enqueued** and **Invisible** states for, at most, the number of times specified in the **max delivery count** property on IoT Hub.</span></span> <span data-ttu-id="f2725-130">Después de ese número de transiciones, el Centro de IoT establece el estado del mensaje en **Deadlettered**(Procesado como devuelto).</span><span class="sxs-lookup"><span data-stu-id="f2725-130">After that number of transitions, IoT Hub sets the state of the message to **Deadlettered**.</span></span> <span data-ttu-id="f2725-131">De igual forma, IoT Hub establece el estado de un mensaje en **Deadlettered** (Procesado como devuelto) después de su fecha de caducidad [consulte [Expiración de mensajes (periodo de vida)][lnk-ttl]].</span><span class="sxs-lookup"><span data-stu-id="f2725-131">Similarly, IoT Hub sets the state of a message to **Deadlettered** after its expiration time (see [Time to live][lnk-ttl]).</span></span>

<span data-ttu-id="f2725-132">El tutorial [Envío de mensajes desde la nube al dispositivo con IoT Hub][lnk-c2d-tutorial] muestra cómo enviar mensajes de nube a dispositivo y cómo recibir estos mensajes en un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-132">The [How to send cloud-to-device messages with IoT Hub][lnk-c2d-tutorial] shows you how to send cloud-to-device messages from the cloud and receive them on a device.</span></span>

<span data-ttu-id="f2725-133">Normalmente, un dispositivo completa un mensaje de nube a dispositivo cuando la pérdida del mensaje no afecta a la lógica de aplicación;</span><span class="sxs-lookup"><span data-stu-id="f2725-133">Typically, a device completes a cloud-to-device message when the loss of the message does not affect the application logic.</span></span> <span data-ttu-id="f2725-134">por ejemplo, cuando el dispositivo conserva el contenido del mensaje localmente o ha ejecutado correctamente una operación.</span><span class="sxs-lookup"><span data-stu-id="f2725-134">For example, when the device has persisted the message content locally or has successfully executed an operation.</span></span> <span data-ttu-id="f2725-135">El mensaje también puede llevar información transitoria, cuya pérdida no afectaría a la funcionalidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f2725-135">The message could also carry transient information, whose loss would not impact the functionality of the application.</span></span> <span data-ttu-id="f2725-136">A veces, para tareas de larga duración, puede completar el mensaje de nube a dispositivo después de guardar la descripción de la tarea en el almacenamiento local.</span><span class="sxs-lookup"><span data-stu-id="f2725-136">Sometimes, for long-running tasks, you can complete the cloud-to-device message after persisting the task description in local storage.</span></span> <span data-ttu-id="f2725-137">A continuación, se puede notificar al back-end de solución con uno o más mensajes de dispositivo a nube en distintas fases de progreso de la tarea.</span><span class="sxs-lookup"><span data-stu-id="f2725-137">Then you can notify the solution back end with one or more device-to-cloud messages at various stages of progress of the task.</span></span>

## <a name="message-expiration-time-to-live"></a><span data-ttu-id="f2725-138">Expiración de mensajes (período de vida)</span><span class="sxs-lookup"><span data-stu-id="f2725-138">Message expiration (time to live)</span></span>

<span data-ttu-id="f2725-139">Cada mensaje de nube a dispositivo tiene una fecha de expiración.</span><span class="sxs-lookup"><span data-stu-id="f2725-139">Every cloud-to-device message has an expiration time.</span></span> <span data-ttu-id="f2725-140">La puede establecer el servicio (en la propiedad **ExpiryTimeUtc**), o bien IoT Hub mediante el *período de vida* predeterminado especificado como propiedad de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="f2725-140">This time is set either by the service (in the **ExpiryTimeUtc** property), or by IoT Hub using the default *time to live* specified as an IoT Hub property.</span></span> <span data-ttu-id="f2725-141">Consulte [Opciones de configuración de la nube al dispositivo][lnk-c2d-configuration].</span><span class="sxs-lookup"><span data-stu-id="f2725-141">See [Cloud-to-device configuration options][lnk-c2d-configuration].</span></span>

<span data-ttu-id="f2725-142">Una forma habitual de aprovechar la expiración de los mensajes y evitar enviarlos a dispositivos desconectados consiste en establecer valores cortos de período de vida.</span><span class="sxs-lookup"><span data-stu-id="f2725-142">A common way to take advantage of message expiration and avoid sending messages to disconnected devices, is to set short time to live values.</span></span> <span data-ttu-id="f2725-143">Así se consigue el mismo resultado que al mantener el estado de la conexión de los dispositivos, con la diferencia de que la primera opción resulta más eficiente.</span><span class="sxs-lookup"><span data-stu-id="f2725-143">This approach achieves the same result as maintaining the device connection state, while being more efficient.</span></span> <span data-ttu-id="f2725-144">Cuando solicita confirmaciones de mensajes, IoT Hub le notificará qué dispositivos pueden recibir mensajes y qué dispositivos no están conectados o presentan errores.</span><span class="sxs-lookup"><span data-stu-id="f2725-144">When you request message acknowledgements, IoT Hub notifies you which devices are able to receive messages, and which devices are not online or have failed.</span></span>

## <a name="message-feedback"></a><span data-ttu-id="f2725-145">Comentarios de mensajes</span><span class="sxs-lookup"><span data-stu-id="f2725-145">Message feedback</span></span>

<span data-ttu-id="f2725-146">Cuando envía un mensaje de nube a dispositivo, el servicio puede solicitar la entrega de los comentarios de cada mensaje en relación con el estado final de ese mensaje.</span><span class="sxs-lookup"><span data-stu-id="f2725-146">When you send a cloud-to-device message, the service can request the delivery of per-message feedback regarding the final state of that message.</span></span>

| <span data-ttu-id="f2725-147">Propiedad Ack</span><span class="sxs-lookup"><span data-stu-id="f2725-147">Ack property</span></span> | <span data-ttu-id="f2725-148">Comportamiento</span><span class="sxs-lookup"><span data-stu-id="f2725-148">Behavior</span></span> |
| ------------ | -------- |
| <span data-ttu-id="f2725-149">**positive**</span><span class="sxs-lookup"><span data-stu-id="f2725-149">**positive**</span></span> | <span data-ttu-id="f2725-150">IoT Hub genera un mensaje de comentarios únicamente si el mensaje de nube a dispositivo alcanza el estado **Completado**.</span><span class="sxs-lookup"><span data-stu-id="f2725-150">IoT Hub generates a feedback message if, and only if, the cloud-to-device message reached the **Completed** state.</span></span> |
| <span data-ttu-id="f2725-151">**negative**</span><span class="sxs-lookup"><span data-stu-id="f2725-151">**negative**</span></span> | <span data-ttu-id="f2725-152">IoT Hub genera un mensaje de comentarios únicamente si el mensaje de nube a dispositivo alcanza el estado **Deadlettered** (Procesado como devuelto).</span><span class="sxs-lookup"><span data-stu-id="f2725-152">IoT Hub generates a feedback message, if and only if, the cloud-to-device message reaches the **Deadlettered** state.</span></span> |
| <span data-ttu-id="f2725-153">**full**</span><span class="sxs-lookup"><span data-stu-id="f2725-153">**full**</span></span>     | <span data-ttu-id="f2725-154">IoT Hub genera un mensaje de comentarios en cualquiera de los casos.</span><span class="sxs-lookup"><span data-stu-id="f2725-154">IoT Hub generates a feedback message in either case.</span></span> |

<span data-ttu-id="f2725-155">Si **Ack** es **full** y no recibe un mensaje de comentarios, significa que este ha expirado.</span><span class="sxs-lookup"><span data-stu-id="f2725-155">If **Ack** is **full**, and you don't receive a feedback message, it means that the feedback message expired.</span></span> <span data-ttu-id="f2725-156">El servicio no puede saber qué ha ocurrido con el mensaje original.</span><span class="sxs-lookup"><span data-stu-id="f2725-156">The service can't know what happened to the original message.</span></span> <span data-ttu-id="f2725-157">En la práctica, un servicio debe asegurarse de que puede procesar el comentario antes de que expire.</span><span class="sxs-lookup"><span data-stu-id="f2725-157">In practice, a service should ensure that it can process the feedback before it expires.</span></span> <span data-ttu-id="f2725-158">El tiempo de expiración máximo es de dos días, lo que permite tener tiempo suficiente para poner de nuevo en funcionamiento el servicio en caso de error.</span><span class="sxs-lookup"><span data-stu-id="f2725-158">The maximum expiry time is two days, which allows plenty of time to get the service running again if a failure occurs.</span></span>

<span data-ttu-id="f2725-159">Como se explica en [Puntos de conexión][lnk-endpoints], IoT Hub envía los comentarios a través de un punto de conexión accesible desde el servicio (**/messages/servicebound/feedback**) en forma de mensajes.</span><span class="sxs-lookup"><span data-stu-id="f2725-159">As explained in [Endpoints][lnk-endpoints], IoT Hub delivers feedback through a service-facing endpoint (**/messages/servicebound/feedback**) as messages.</span></span> <span data-ttu-id="f2725-160">La semántica de recepción de los comentarios es la misma que para los mensajes de la nube al dispositivo; además, tienen el mismo [ciclo de vida de los mensajes][lnk-lifecycle].</span><span class="sxs-lookup"><span data-stu-id="f2725-160">The semantics for receiving feedback are the same as for cloud-to-device messages, and have the same [Message lifecycle][lnk-lifecycle].</span></span> <span data-ttu-id="f2725-161">Siempre que sea posible, los comentarios de mensajes se agrupan en un único mensaje, con el formato siguiente:</span><span class="sxs-lookup"><span data-stu-id="f2725-161">Whenever possible, message feedback is batched in a single message, with the following format:</span></span>

| <span data-ttu-id="f2725-162">Propiedad</span><span class="sxs-lookup"><span data-stu-id="f2725-162">Property</span></span>     | <span data-ttu-id="f2725-163">Description</span><span class="sxs-lookup"><span data-stu-id="f2725-163">Description</span></span> |
| ------------ | ----------- |
| <span data-ttu-id="f2725-164">EnqueuedTime</span><span class="sxs-lookup"><span data-stu-id="f2725-164">EnqueuedTime</span></span> | <span data-ttu-id="f2725-165">Marca de tiempo que indica cuándo se creó el mensaje.</span><span class="sxs-lookup"><span data-stu-id="f2725-165">Timestamp indicating when the message was created.</span></span> |
| <span data-ttu-id="f2725-166">UserId</span><span class="sxs-lookup"><span data-stu-id="f2725-166">UserId</span></span>       | `{iot hub name}` |
| <span data-ttu-id="f2725-167">ContentType</span><span class="sxs-lookup"><span data-stu-id="f2725-167">ContentType</span></span>  | `application/vnd.microsoft.iothub.feedback.json` |

<span data-ttu-id="f2725-168">El cuerpo es una matriz serializada de JSON de registros, cada uno con las siguientes propiedades:</span><span class="sxs-lookup"><span data-stu-id="f2725-168">The body is a JSON-serialized array of records, each with the following properties:</span></span>

| <span data-ttu-id="f2725-169">Propiedad</span><span class="sxs-lookup"><span data-stu-id="f2725-169">Property</span></span>           | <span data-ttu-id="f2725-170">Description</span><span class="sxs-lookup"><span data-stu-id="f2725-170">Description</span></span> |
| ------------------ | ----------- |
| <span data-ttu-id="f2725-171">EnqueuedTimeUtc</span><span class="sxs-lookup"><span data-stu-id="f2725-171">EnqueuedTimeUtc</span></span>    | <span data-ttu-id="f2725-172">Marca de tiempo que indica cuándo se produjo el resultado del mensaje.</span><span class="sxs-lookup"><span data-stu-id="f2725-172">Timestamp indicating when the outcome of the message happened.</span></span> <span data-ttu-id="f2725-173">Por ejemplo, el dispositivo completado o el mensaje expirado.</span><span class="sxs-lookup"><span data-stu-id="f2725-173">For example, the device completed or the message expired.</span></span> |
| <span data-ttu-id="f2725-174">OriginalMessageId</span><span class="sxs-lookup"><span data-stu-id="f2725-174">OriginalMessageId</span></span>  | <span data-ttu-id="f2725-175">**MessageId** del mensaje de nube a dispositivo con el que está relacionada esta información de comentarios.</span><span class="sxs-lookup"><span data-stu-id="f2725-175">**MessageId** of the cloud-to-device message to which this feedback information relates.</span></span> |
| <span data-ttu-id="f2725-176">StatusCode</span><span class="sxs-lookup"><span data-stu-id="f2725-176">StatusCode</span></span>         | <span data-ttu-id="f2725-177">Cadena necesaria.</span><span class="sxs-lookup"><span data-stu-id="f2725-177">Required string.</span></span> <span data-ttu-id="f2725-178">Se utiliza en los mensajes de comentarios generados por el Centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="f2725-178">Used in feedback messages generated by IoT Hub.</span></span> <br/> <span data-ttu-id="f2725-179">"Success"</span><span class="sxs-lookup"><span data-stu-id="f2725-179">'Success'</span></span> <br/> <span data-ttu-id="f2725-180">"Expired"</span><span class="sxs-lookup"><span data-stu-id="f2725-180">'Expired'</span></span> <br/> <span data-ttu-id="f2725-181">'DeliveryCountExceeded'</span><span class="sxs-lookup"><span data-stu-id="f2725-181">'DeliveryCountExceeded'</span></span> <br/> <span data-ttu-id="f2725-182">"Rejected"</span><span class="sxs-lookup"><span data-stu-id="f2725-182">'Rejected'</span></span> <br/> <span data-ttu-id="f2725-183">'Purged'</span><span class="sxs-lookup"><span data-stu-id="f2725-183">'Purged'</span></span> |
| <span data-ttu-id="f2725-184">Descripción</span><span class="sxs-lookup"><span data-stu-id="f2725-184">Description</span></span>        | <span data-ttu-id="f2725-185">Valores de cadena para **StatusCode**.</span><span class="sxs-lookup"><span data-stu-id="f2725-185">String values for **StatusCode**.</span></span> |
| <span data-ttu-id="f2725-186">deviceId</span><span class="sxs-lookup"><span data-stu-id="f2725-186">DeviceId</span></span>           | <span data-ttu-id="f2725-187">**DeviceId** del dispositivo de destino del mensaje de nube a dispositivo con el que está relacionado este elemento de comentarios.</span><span class="sxs-lookup"><span data-stu-id="f2725-187">**DeviceId** of the target device of the cloud-to-device message to which this piece of feedback relates.</span></span> |
| <span data-ttu-id="f2725-188">DeviceGenerationId</span><span class="sxs-lookup"><span data-stu-id="f2725-188">DeviceGenerationId</span></span> | <span data-ttu-id="f2725-189">**DeviceGenerationId** del dispositivo de destino del mensaje de nube a dispositivo con el que está relacionado este elemento de comentarios.</span><span class="sxs-lookup"><span data-stu-id="f2725-189">**DeviceGenerationId** of the target device of the cloud-to-device message to which this piece of feedback relates.</span></span> |

<span data-ttu-id="f2725-190">El servicio tiene que especificar un valor de **MessageId** para el mensaje de nube a dispositivo para poder correlacionar sus comentarios con el mensaje original.</span><span class="sxs-lookup"><span data-stu-id="f2725-190">The service must specify a **MessageId** for the cloud-to-device message to be able to correlate its feedback with the original message.</span></span>

<span data-ttu-id="f2725-191">En el ejemplo siguiente se muestra el cuerpo de un mensaje de comentarios.</span><span class="sxs-lookup"><span data-stu-id="f2725-191">The following example shows the body of a feedback message.</span></span>

```json
[
  {
    "OriginalMessageId": "0987654321",
    "EnqueuedTimeUtc": "2015-07-28T16:24:48.789Z",
    "StatusCode": 0,
    "Description": "Success",
    "DeviceId": "123",
    "DeviceGenerationId": "abcdefghijklmnopqrstuvwxyz"
  },
  {
    ...
  },
  ...
]
```

## <a name="cloud-to-device-configuration-options"></a><span data-ttu-id="f2725-192">Opciones de configuración de la nube al dispositivo</span><span class="sxs-lookup"><span data-stu-id="f2725-192">Cloud-to-device configuration options</span></span>

<span data-ttu-id="f2725-193">Cada centro de IoT expone las siguientes opciones de configuración para la mensajería de nube a dispositivo:</span><span class="sxs-lookup"><span data-stu-id="f2725-193">Each IoT hub exposes the following configuration options for cloud-to-device messaging:</span></span>

| <span data-ttu-id="f2725-194">Propiedad</span><span class="sxs-lookup"><span data-stu-id="f2725-194">Property</span></span>                  | <span data-ttu-id="f2725-195">Description</span><span class="sxs-lookup"><span data-stu-id="f2725-195">Description</span></span> | <span data-ttu-id="f2725-196">Intervalo y valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="f2725-196">Range and default</span></span> |
| ------------------------- | ----------- | ----------------- |
| <span data-ttu-id="f2725-197">defaultTtlAsIso8601</span><span class="sxs-lookup"><span data-stu-id="f2725-197">defaultTtlAsIso8601</span></span>       | <span data-ttu-id="f2725-198">TTL predeterminado para los mensajes de nube a dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-198">Default TTL for cloud-to-device messages.</span></span> | <span data-ttu-id="f2725-199">Intervalo de ISO_8601 hasta 2D (1 minuto como mínimo).</span><span class="sxs-lookup"><span data-stu-id="f2725-199">ISO_8601 interval up to 2D (minimum 1 minute).</span></span> <span data-ttu-id="f2725-200">Valor predeterminado: 1 hora.</span><span class="sxs-lookup"><span data-stu-id="f2725-200">Default: 1 hour.</span></span> |
| <span data-ttu-id="f2725-201">maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="f2725-201">maxDeliveryCount</span></span>          | <span data-ttu-id="f2725-202">Número máximo de entregas para las colas de nube a dispositivo por dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2725-202">Maximum delivery count for cloud-to-device per-device queues.</span></span> | <span data-ttu-id="f2725-203">De 1 a 100.</span><span class="sxs-lookup"><span data-stu-id="f2725-203">1 to 100.</span></span> <span data-ttu-id="f2725-204">Valor predeterminado: 10</span><span class="sxs-lookup"><span data-stu-id="f2725-204">Default: 10.</span></span> |
| <span data-ttu-id="f2725-205">feedback.ttlAsIso8601</span><span class="sxs-lookup"><span data-stu-id="f2725-205">feedback.ttlAsIso8601</span></span>     | <span data-ttu-id="f2725-206">Retención de mensajes de comentarios del límite de servicio.</span><span class="sxs-lookup"><span data-stu-id="f2725-206">Retention for service-bound feedback messages.</span></span> | <span data-ttu-id="f2725-207">Intervalo de ISO_8601 hasta 2D (1 minuto como mínimo).</span><span class="sxs-lookup"><span data-stu-id="f2725-207">ISO_8601 interval up to 2D (minimum 1 minute).</span></span> <span data-ttu-id="f2725-208">Valor predeterminado: 1 hora.</span><span class="sxs-lookup"><span data-stu-id="f2725-208">Default: 1 hour.</span></span> |
| <span data-ttu-id="f2725-209">feedback.maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="f2725-209">feedback.maxDeliveryCount</span></span> |<span data-ttu-id="f2725-210">Número máximo de entregas para la cola de comentarios.</span><span class="sxs-lookup"><span data-stu-id="f2725-210">Maximum delivery count for feedback queue.</span></span> | <span data-ttu-id="f2725-211">De 1 a 100.</span><span class="sxs-lookup"><span data-stu-id="f2725-211">1 to 100.</span></span> <span data-ttu-id="f2725-212">Valor predeterminado: 100.</span><span class="sxs-lookup"><span data-stu-id="f2725-212">Default: 100.</span></span> |

<span data-ttu-id="f2725-213">Para obtener más información sobre cómo establecer estas opciones de configuración, consulte [Crear instancias de IoT Hub][lnk-portal].</span><span class="sxs-lookup"><span data-stu-id="f2725-213">For more information about how to set these configuration options, see [Create IoT hubs][lnk-portal].</span></span>

## <a name="next-steps"></a><span data-ttu-id="f2725-214">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="f2725-214">Next steps</span></span>

<span data-ttu-id="f2725-215">Para obtener información sobre los SDK que puede utilizar para recibir mensajes de nube a dispositivo, consulte [SDK de Azure IoT][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="f2725-215">For information about the SDKs you can use to receive cloud-to-device messages, see [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="f2725-216">Para probar la recepción de mensajes de nube a dispositivo, consulte el tutorial [Envío de mensajes desde la nube al dispositivo][lnk-c2d-tutorial].</span><span class="sxs-lookup"><span data-stu-id="f2725-216">To try out receiving cloud-to-device messages, see the [Send cloud-to-device][lnk-c2d-tutorial] tutorial.</span></span>

[img-lifecycle]: ./media/iot-hub-devguide-messages-c2d/lifecycle.png

[lnk-portal]: iot-hub-create-through-portal.md
[lnk-c2d-guidance]: iot-hub-devguide-c2d-guidance.md
[lnk-endpoints]: iot-hub-devguide-endpoints.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-ttl]: #message-expiration-time-to-live
[lnk-c2d-configuration]: #cloud-to-device-configuration-options
[lnk-lifecycle]: #message-lifecycle
[lnk-c2d-tutorial]: iot-hub-csharp-csharp-c2d.md
