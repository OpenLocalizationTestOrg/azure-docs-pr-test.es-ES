---
title: dispositivos de IoT aaaAzure SDK para C - IoTHubClient | Documentos de Microsoft
description: La biblioteca de IoTHubClient toouse hello en dispositivo de hello IoT de Azure SDK para aplicaciones de C toocreate dispositivos que se comunican con un centro de IoT.
services: iot-hub
documentationcenter: 
author: olivierbloch
manager: timlt
editor: 
ms.assetid: 828cf2bf-999d-4b8a-8a28-c7c901629600
ms.service: iot-hub
ms.devlang: cpp
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/06/2016
ms.author: obloch
ms.openlocfilehash: d1ece79e9ba6d1e5fd45cabb8fca393b24052e07
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="azure-iot-device-sdk-for-c--more-about-iothubclient"></a><span data-ttu-id="af093-103">SDK de dispositivo IoT de Microsoft Azure para C: más información sobre IoTHubClient</span><span class="sxs-lookup"><span data-stu-id="af093-103">Azure IoT device SDK for C – more about IoTHubClient</span></span>
<span data-ttu-id="af093-104">Hola [primero el artículo](iot-hub-device-sdk-c-intro.md) en este Hola serie introducida **dispositivos de IoT de Azure SDK para C**. En este artículo se explicaba que hay dos capas de arquitectura en el SDK.</span><span class="sxs-lookup"><span data-stu-id="af093-104">hello [first article](iot-hub-device-sdk-c-intro.md) in this series introduced hello **Azure IoT device SDK for C**. That article explained that there are two architectural layers in SDK.</span></span> <span data-ttu-id="af093-105">En la base de hello es hello **IoTHubClient** biblioteca que administra directamente la comunicación con el centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="af093-105">At hello base is hello **IoTHubClient** library which directly manages communication with IoT Hub.</span></span> <span data-ttu-id="af093-106">También hay hello **serializador** biblioteca que se basa en dicha tooprovide servicios de serialización.</span><span class="sxs-lookup"><span data-stu-id="af093-106">There's also hello **serializer** library that builds on top of that tooprovide serialization services.</span></span> <span data-ttu-id="af093-107">En este artículo proporcionaremos información adicional sobre hello **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="af093-107">In this article we'll provide additional detail on hello **IoTHubClient** library.</span></span>

<span data-ttu-id="af093-108">artículo anterior de Hola se describe cómo hello toouse **IoTHubClient** tooIoT de eventos de biblioteca toosend concentrador y recibir mensajes.</span><span class="sxs-lookup"><span data-stu-id="af093-108">hello previous article described how toouse hello **IoTHubClient** library toosend events tooIoT Hub and receive messages.</span></span> <span data-ttu-id="af093-109">En este artículo se extiende esa discusión mediante la explicación de cómo administrar precisamente toomore *cuando* enviar y recibir datos, se presenta toohello **API de nivel inferior**.</span><span class="sxs-lookup"><span data-stu-id="af093-109">This article extends that discussion by explaining how toomore precisely manage *when* you send and receive data, introducing you toohello **lower-level APIs**.</span></span> <span data-ttu-id="af093-110">También explicaremos cómo tooattach propiedades tooevents (y recuperarlos a partir de mensajes) mediante la propiedad Hola controlar características en hello **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="af093-110">We'll also explain how tooattach properties tooevents (and retrieve them from messages) using hello property handling features in hello **IoTHubClient** library.</span></span> <span data-ttu-id="af093-111">Por último, le presentaremos una explicación adicional de maneras diferentes toohandle mensajes recibidos desde el centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="af093-111">Finally, we'll provide additional explanation of different ways toohandle messages received from IoT Hub.</span></span>

<span data-ttu-id="af093-112">Hello artículo concluye al cubrir un par de varios temas, incluidos más información acerca de las credenciales del dispositivo y cómo toochange Hola comportamiento de hello **IoTHubClient** mediante opciones de configuración.</span><span class="sxs-lookup"><span data-stu-id="af093-112">hello article concludes by covering a couple of miscellaneous topics, including more about device credentials and how toochange hello behavior of hello **IoTHubClient** through configuration options.</span></span>

<span data-ttu-id="af093-113">Vamos a usar hello **IoTHubClient** ejemplos de SDK de tooexplain estos temas.</span><span class="sxs-lookup"><span data-stu-id="af093-113">We'll use hello **IoTHubClient** SDK samples tooexplain these topics.</span></span> <span data-ttu-id="af093-114">Si desea que toofollow a lo largo de, vea hello **el centro de IOT\_cliente\_ejemplo\_http** y **el centro de IOT\_cliente\_ejemplo\_amqp** las aplicaciones que se incluyen en el dispositivo de hello IoT de Azure SDK para C. todo lo descrito en hello las secciones siguientes se muestra en estos ejemplos.</span><span class="sxs-lookup"><span data-stu-id="af093-114">If you want toofollow along, see hello **iothub\_client\_sample\_http** and **iothub\_client\_sample\_amqp** applications that are included in hello Azure IoT device SDK for C. Everything described in hello following sections is demonstrated in these samples.</span></span>

<span data-ttu-id="af093-115">Puede encontrar Hola [ **dispositivos de IoT de Azure SDK para C** ](https://github.com/Azure/azure-iot-sdk-c) GitHub repositorio y ver los detalles de la API de Hola Hola [referencia de la API de C](https://azure.github.io/azure-iot-sdk-c/index.html).</span><span class="sxs-lookup"><span data-stu-id="af093-115">You can find hello [**Azure IoT device SDK for C**](https://github.com/Azure/azure-iot-sdk-c) GitHub repository and view details of hello API in hello [C API reference](https://azure.github.io/azure-iot-sdk-c/index.html).</span></span>

## <a name="hello-lower-level-apis"></a><span data-ttu-id="af093-116">Hola las API de nivel inferior</span><span class="sxs-lookup"><span data-stu-id="af093-116">hello lower-level APIs</span></span>
<span data-ttu-id="af093-117">artículo anterior de Hola describe la operación básica de Hola de hello **IotHubClient** en contexto de Hola de hello **el centro de IOT\_cliente\_ejemplo\_amqp** aplicación.</span><span class="sxs-lookup"><span data-stu-id="af093-117">hello previous article described hello basic operation of hello **IotHubClient** within hello context of hello **iothub\_client\_sample\_amqp** application.</span></span> <span data-ttu-id="af093-118">Por ejemplo, explica cómo tooinitialize Hola biblioteca con este código.</span><span class="sxs-lookup"><span data-stu-id="af093-118">For example, it explained how tooinitialize hello library using this code.</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="af093-119">También se describe cómo los eventos toosend usando esta llamada de función.</span><span class="sxs-lookup"><span data-stu-id="af093-119">It also described how toosend events using this function call.</span></span>

```
IoTHubClient_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message);
```

<span data-ttu-id="af093-120">artículo de Hello también describe cómo los mensajes tooreceive registrando una función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="af093-120">hello article also described how tooreceive messages by registering a callback function.</span></span>

```
int receiveContext = 0;
IoTHubClient_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext);
```

<span data-ttu-id="af093-121">artículo de Hello también se ha explicado cómo recursos toofree mediante código como el siguiente de saludo.</span><span class="sxs-lookup"><span data-stu-id="af093-121">hello article also showed how toofree resources using code such as hello following.</span></span>

```
IoTHubClient_Destroy(iotHubClientHandle);
```

<span data-ttu-id="af093-122">Sin embargo, hay tooeach de funciones complementarias de estas API:</span><span class="sxs-lookup"><span data-stu-id="af093-122">However there are companion functions tooeach of these APIs:</span></span>

* <span data-ttu-id="af093-123">IoTHubClient\_LL\_CreateFromConnectionString</span><span class="sxs-lookup"><span data-stu-id="af093-123">IoTHubClient\_LL\_CreateFromConnectionString</span></span>
* <span data-ttu-id="af093-124">IoTHubClient\_LL\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="af093-124">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="af093-125">IoTHubClient\_LL\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="af093-125">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="af093-126">IoTHubClient\_LL\_Destroy</span><span class="sxs-lookup"><span data-stu-id="af093-126">IoTHubClient\_LL\_Destroy</span></span>

<span data-ttu-id="af093-127">Estas funciones incluyen "LL" en nombre de la API de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-127">These functions all include “LL” in hello API name.</span></span> <span data-ttu-id="af093-128">Aparte de eso, los parámetros de Hola de cada una de estas funciones son equivalentes de no LL tootheir idénticos.</span><span class="sxs-lookup"><span data-stu-id="af093-128">Other than that, hello parameters of each of these functions are identical tootheir non-LL counterparts.</span></span> <span data-ttu-id="af093-129">Sin embargo, el comportamiento de Hola de estas funciones es diferente en un aspecto importante.</span><span class="sxs-lookup"><span data-stu-id="af093-129">However, hello behavior of these functions is different in one important way.</span></span>

<span data-ttu-id="af093-130">Cuando se llama a **IoTHubClient\_CreateFromConnectionString**, bibliotecas subyacente Hola crean un nuevo subproceso que se ejecuta en segundo plano de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-130">When you call **IoTHubClient\_CreateFromConnectionString**, hello underlying libraries create a new thread that runs in hello background.</span></span> <span data-ttu-id="af093-131">Este subproceso envía eventos al Centro de IoT y recibe mensajes del mismo.</span><span class="sxs-lookup"><span data-stu-id="af093-131">This thread sends events to, and receives messages from, IoT Hub.</span></span> <span data-ttu-id="af093-132">Ningún subproceso de este tipo se crea cuando se trabaja con hello "LL" API.</span><span class="sxs-lookup"><span data-stu-id="af093-132">No such thread is created when working with hello "LL" APIs.</span></span> <span data-ttu-id="af093-133">creación de Hello de subproceso en segundo plano hello es un desarrollador de toohello comodidad.</span><span class="sxs-lookup"><span data-stu-id="af093-133">hello creation of hello background thread is a convenience toohello developer.</span></span> <span data-ttu-id="af093-134">No es necesario tooworry sobre explícitamente eventos de enviar y recibir mensajes desde el centro de IoT--se produce automáticamente en segundo plano de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-134">You don’t have tooworry about explicitly sending events and receiving messages from IoT Hub -- it happens automatically in hello background.</span></span> <span data-ttu-id="af093-135">En cambio, Hola "LL" API proporcionan un control explícito sobre la comunicación con el centro de IoT, si lo necesita.</span><span class="sxs-lookup"><span data-stu-id="af093-135">In contrast, hello "LL" APIs give you explicit control over communication with IoT Hub, if you need it.</span></span>

<span data-ttu-id="af093-136">toounderstand este mejor, echemos un vistazo a un ejemplo:</span><span class="sxs-lookup"><span data-stu-id="af093-136">toounderstand this better, let’s look at an example:</span></span>

<span data-ttu-id="af093-137">Cuando se llama a **IoTHubClient\_SendEventAsync**, lo que realmente está haciendo es sinónimo de poner eventos hello en un búfer.</span><span class="sxs-lookup"><span data-stu-id="af093-137">When you call **IoTHubClient\_SendEventAsync**, what you're actually doing is putting hello event in a buffer.</span></span> <span data-ttu-id="af093-138">Hola subproceso en segundo plano creado cuando se llama a **IoTHubClient\_CreateFromConnectionString** continuamente supervisa este búfer y envíe cualquier dato que contiene tooIoT concentrador.</span><span class="sxs-lookup"><span data-stu-id="af093-138">hello background thread created when you call **IoTHubClient\_CreateFromConnectionString** continually monitors this buffer and sends any data that it contains tooIoT Hub.</span></span> <span data-ttu-id="af093-139">Esto sucede en segundo plano de hello en hello mismo tiempo que Hola subproceso principal está realizando otro trabajo.</span><span class="sxs-lookup"><span data-stu-id="af093-139">This happens in hello background at hello same time that hello main thread is performing other work.</span></span>

<span data-ttu-id="af093-140">De forma similar, al registrar una función de devolución de llamada para mensajes con **IoTHubClient\_SetMessageCallback**, está dando a fondo de hello SDK toohave Hola subproceso invocar la función de devolución de llamada de hello cuando un mensaje recibido, independiente del subproceso principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-140">Similarly, when you register a callback function for messages using **IoTHubClient\_SetMessageCallback**, you're instructing hello SDK toohave hello background thread invoke hello callback function when a message is received, independent of hello main thread.</span></span>

<span data-ttu-id="af093-141">Hola "LL" API no se crean un subproceso en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="af093-141">hello "LL" APIs don’t create a background thread.</span></span> <span data-ttu-id="af093-142">En su lugar, una nueva API debe llamarse tooexplicitly enviar y recibir datos desde el centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="af093-142">Instead, a new API must be called tooexplicitly send and receive data from IoT Hub.</span></span> <span data-ttu-id="af093-143">Esto se muestra en el siguiente ejemplo de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-143">This is demonstrated in hello following example.</span></span>

<span data-ttu-id="af093-144">Hola **el centro de IOT\_cliente\_ejemplo\_http** aplicaciones que estén incluidas en la muestra de SDK de Hola Hola las API de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="af093-144">hello **iothub\_client\_sample\_http** application that’s included in hello SDK demonstrates hello lower-level APIs.</span></span> <span data-ttu-id="af093-145">En ese ejemplo, enviamos tooIoT concentrador de eventos con código como Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="af093-145">In that sample, we send events tooIoT Hub with code such as hello following:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Message_%d_From_IoTHubClient_LL_Over_HTTP", i);
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));

IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="af093-146">tres primeras líneas Hello crean mensajes de bienvenida y última línea de hello envía eventos de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-146">hello first three lines create hello message, and hello last line sends hello event.</span></span> <span data-ttu-id="af093-147">Sin embargo, como se mencionó anteriormente, "Enviar" eventos de hello significa que los datos de hello simplemente se colocan en un búfer.</span><span class="sxs-lookup"><span data-stu-id="af093-147">However, as mentioned previously, "sending" hello event means that hello data is simply placed in a buffer.</span></span> <span data-ttu-id="af093-148">Nada se transmite en la red de hello cuando se llama a **IoTHubClient\_LL\_SendEventAsync**.</span><span class="sxs-lookup"><span data-stu-id="af093-148">Nothing is transmitted on hello network when we call **IoTHubClient\_LL\_SendEventAsync**.</span></span> <span data-ttu-id="af093-149">En orden tooactually entrada Hola datos tooIoT concentrador, se debe llamar a **IoTHubClient\_LL\_DoWork**, como en este ejemplo:</span><span class="sxs-lookup"><span data-stu-id="af093-149">In order tooactually ingress hello data tooIoT Hub, you must call **IoTHubClient\_LL\_DoWork**, as in this example:</span></span>

```
while (1)
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="af093-150">Este código (de hello **el centro de IOT\_cliente\_ejemplo\_http** aplicación) llama repetidamente **IoTHubClient\_LL\_DoWork** .</span><span class="sxs-lookup"><span data-stu-id="af093-150">This code (from hello **iothub\_client\_sample\_http** application) repeatedly calls **IoTHubClient\_LL\_DoWork**.</span></span> <span data-ttu-id="af093-151">Cada vez que **IoTHubClient\_LL\_DoWork** es llama, envía algunos eventos de hello búfer tooIoT concentrador y recupera un mensaje en cola que se envían toohello dispositivo.</span><span class="sxs-lookup"><span data-stu-id="af093-151">Each time **IoTHubClient\_LL\_DoWork** is called, it sends some events from hello buffer tooIoT Hub and it retrieves a queued message being sent toohello device.</span></span> <span data-ttu-id="af093-152">este último caso de Hello significa que si se registra una función de devolución de llamada para los mensajes, a continuación, se invoca la devolución de llamada de hello (suponiendo que se ponen en cola los mensajes de).</span><span class="sxs-lookup"><span data-stu-id="af093-152">hello latter case means that if we registered a callback function for messages, then hello callback is invoked (assuming any messages are queued up).</span></span> <span data-ttu-id="af093-153">Una función de devolución de llamada de este tipo se habría registrado con código como Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="af093-153">We would have registered such a callback function with code such as hello following:</span></span>

```
IoTHubClient_LL_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext)
```

<span data-ttu-id="af093-154">Hola motivo que **IoTHubClient\_LL\_DoWork** se denomina a menudo en un bucle es que cada vez que se llama, envía *algunos* almacenado en búfer eventos tooIoT concentrador y recupera *Hola junto* mensaje en la cola para el dispositivo de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-154">hello reason that **IoTHubClient\_LL\_DoWork** is often called in a loop is that each time it’s called, it sends *some* buffered events tooIoT Hub and retrieves *hello next* message queued up for hello device.</span></span> <span data-ttu-id="af093-155">Cada llamada no está garantizado toosend de almacenamiento en búfer todos los eventos o en cola tooretrieve todos los mensajes.</span><span class="sxs-lookup"><span data-stu-id="af093-155">Each call isn’t guaranteed toosend all buffered events or tooretrieve all queued messages.</span></span> <span data-ttu-id="af093-156">Si desea que todos los eventos de hello almacene en búfer y, a continuación, continuar con el resto del procesamiento de toosend puede reemplazar este bucle con código como Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="af093-156">If you want toosend all events in hello buffer and then continue on with other processing you can replace this loop with code such as hello following:</span></span>

```
IOTHUB_CLIENT_STATUS status;

while ((IoTHubClient_LL_GetSendStatus(iotHubClientHandle, &status) == IOTHUB_CLIENT_OK) && (status == IOTHUB_CLIENT_SEND_STATUS_BUSY))
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="af093-157">Este código llama **IoTHubClient\_LL\_DoWork** hasta que todos los eventos en el búfer de Hola se han enviado tooIoT concentrador.</span><span class="sxs-lookup"><span data-stu-id="af093-157">This code calls **IoTHubClient\_LL\_DoWork** until all events in hello buffer have been sent tooIoT Hub.</span></span> <span data-ttu-id="af093-158">Tenga en cuenta que esto no significa que se recibieran todos los mensajes en cola.</span><span class="sxs-lookup"><span data-stu-id="af093-158">Note this does not also imply that all queued messages have been received.</span></span> <span data-ttu-id="af093-159">Parte del motivo hello es que comprobar si hay mensajes "all" no es determinista como una acción.</span><span class="sxs-lookup"><span data-stu-id="af093-159">Part of hello reason for this is that checking for "all" messages isn’t as deterministic an action.</span></span> <span data-ttu-id="af093-160">¿Qué ocurre si recuperar "todos" de los mensajes de Hola, pero, a continuación, otro se envía toohello dispositivo inmediatamente después?</span><span class="sxs-lookup"><span data-stu-id="af093-160">What happens if you retrieve "all" of hello messages, but then another one is sent toohello device immediately after?</span></span> <span data-ttu-id="af093-161">Un toodeal de manera mejor con la es con un tiempo de espera programado.</span><span class="sxs-lookup"><span data-stu-id="af093-161">A better way toodeal with that is with a programmed timeout.</span></span> <span data-ttu-id="af093-162">Por ejemplo, función de devolución de llamada de mensajes de Hola pudo restablecer un temporizador cada vez que se invoca.</span><span class="sxs-lookup"><span data-stu-id="af093-162">For example, hello message callback function could reset a timer every time it’s invoked.</span></span> <span data-ttu-id="af093-163">A continuación, puede escribir procesamiento de toocontinue la lógica si, por ejemplo, se ha recibido ningún mensaje de Hola última *X* segundos.</span><span class="sxs-lookup"><span data-stu-id="af093-163">You can then write logic toocontinue processing if, for example, no messages have been received in hello last *X* seconds.</span></span>

<span data-ttu-id="af093-164">Cuando está terminado ingressing eventos y recibir mensajes, para ser seguro toocall Hola correspondiente función tooclean los recursos.</span><span class="sxs-lookup"><span data-stu-id="af093-164">When you’re finished ingressing events and receiving messages, be sure toocall hello corresponding function tooclean up resources.</span></span>

```
IoTHubClient_LL_Destroy(iotHubClientHandle);
```

<span data-ttu-id="af093-165">Básicamente hay solo un conjunto de API toosend y recibir datos con un subproceso en segundo plano y otro conjunto de API que Hola lo mismo sin subproceso en segundo plano Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-165">Basically there’s only one set of APIs toosend and receive data with a background thread and another set of APIs that does hello same thing without hello background thread.</span></span> <span data-ttu-id="af093-166">Muchos de los desarrolladores quizás prefiera Hola LL API no pero hello las API de nivel inferior son útiles cuando Hola programador desea un control explícito sobre las transmisiones de red.</span><span class="sxs-lookup"><span data-stu-id="af093-166">A lot of developers may prefer hello non-LL APIs, but hello lower-level APIs are useful when hello developer wants explicit control over network transmissions.</span></span> <span data-ttu-id="af093-167">Por ejemplo, algunos dispositivos recopilan datos con el tiempo y solo incorporan eventos a intervalos especificados (por ejemplo, una vez cada hora o una vez al día).</span><span class="sxs-lookup"><span data-stu-id="af093-167">For example, some devices collect data over time and only ingress events at specified intervals (for example, once an hour or once a day).</span></span> <span data-ttu-id="af093-168">Hola Hola control tooexplicitly de capacidad al enviar y recibir datos desde el centro de IoT ofrecen a las API de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="af093-168">hello lower-level APIs give you hello ability tooexplicitly control when you send and receive data from IoT Hub.</span></span> <span data-ttu-id="af093-169">Otros simplemente preferirán simplicidad Hola ese Hola que proporcionan las API de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="af093-169">Others will simply prefer hello simplicity that hello lower-level APIs provide.</span></span> <span data-ttu-id="af093-170">Todo lo que ocurre en el subproceso principal de hello en lugar de algunos ocurra de trabajo en segundo plano de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-170">Everything happens on hello main thread rather than some work happening in hello background.</span></span>

<span data-ttu-id="af093-171">Cualquier modelo que elija, ser seguro toobe consistente en que las API que use.</span><span class="sxs-lookup"><span data-stu-id="af093-171">Whichever model you choose, be sure toobe consistent in which APIs you use.</span></span> <span data-ttu-id="af093-172">Si inicia mediante una llamada a **IoTHubClient\_LL\_CreateFromConnectionString**, asegúrese de usar solo Hola correspondiente a las API de nivel inferior para cualquier trabajo de seguimiento:</span><span class="sxs-lookup"><span data-stu-id="af093-172">If you start by calling **IoTHubClient\_LL\_CreateFromConnectionString**, be sure you only use hello corresponding lower-level APIs for any follow-up work:</span></span>

* <span data-ttu-id="af093-173">IoTHubClient\_LL\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="af093-173">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="af093-174">IoTHubClient\_LL\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="af093-174">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="af093-175">IoTHubClient\_LL\_Destroy</span><span class="sxs-lookup"><span data-stu-id="af093-175">IoTHubClient\_LL\_Destroy</span></span>
* <span data-ttu-id="af093-176">IoTHubClient\_LL\_DoWork</span><span class="sxs-lookup"><span data-stu-id="af093-176">IoTHubClient\_LL\_DoWork</span></span>

<span data-ttu-id="af093-177">Hola opuesto también es true.</span><span class="sxs-lookup"><span data-stu-id="af093-177">hello opposite is true as well.</span></span> <span data-ttu-id="af093-178">Si empieza con **IoTHubClient\_CreateFromConnectionString**, a continuación, use Hola LL API no para cualquier procesamiento adicional.</span><span class="sxs-lookup"><span data-stu-id="af093-178">If you start with **IoTHubClient\_CreateFromConnectionString**, then use hello non-LL APIs for any additional processing.</span></span>

<span data-ttu-id="af093-179">En dispositivos de IoT de Azure de hello SDK para C, vea hello **el centro de IOT\_cliente\_ejemplo\_http** inferior-nivel de aplicación para obtener un ejemplo completo de hello API.</span><span class="sxs-lookup"><span data-stu-id="af093-179">In hello Azure IoT device SDK for C, see hello **iothub\_client\_sample\_http** application for a complete example of hello lower-level APIs.</span></span> <span data-ttu-id="af093-180">Hola **el centro de IOT\_cliente\_ejemplo\_amqp** puede hacer referencia a aplicación para obtener un ejemplo completo de Hola LL API no.</span><span class="sxs-lookup"><span data-stu-id="af093-180">hello **iothub\_client\_sample\_amqp** application can be referenced for a full example of hello non-LL APIs.</span></span>

## <a name="property-handling"></a><span data-ttu-id="af093-181">Administración de propiedades</span><span class="sxs-lookup"><span data-stu-id="af093-181">Property handling</span></span>
<span data-ttu-id="af093-182">Hasta ahora cuando hemos descrito envío de datos, nos hemos ha hace referencia toohello cuerpo del mensaje de bienvenida.</span><span class="sxs-lookup"><span data-stu-id="af093-182">So far when we've described sending data, we've been referring toohello body of hello message.</span></span> <span data-ttu-id="af093-183">Por ejemplo, considere este código:</span><span class="sxs-lookup"><span data-stu-id="af093-183">For example, consider this code:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Hello World");
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));
IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="af093-184">Este ejemplo envía un tooIoT mensaje concentrador con texto hello "Hola mundo".</span><span class="sxs-lookup"><span data-stu-id="af093-184">This example sends a message tooIoT Hub with hello text "Hello World."</span></span> <span data-ttu-id="af093-185">Sin embargo, centro de IoT también permite el mensaje de propiedades toobe tooeach adjunto.</span><span class="sxs-lookup"><span data-stu-id="af093-185">However, IoT Hub also allows properties toobe attached tooeach message.</span></span> <span data-ttu-id="af093-186">Propiedades son pares de nombre/valor que pueden ser mensajes toohello adjunto.</span><span class="sxs-lookup"><span data-stu-id="af093-186">Properties are name/value pairs that can be attached toohello message.</span></span> <span data-ttu-id="af093-187">Por ejemplo, se podrá modificar Hola anterior código tooattach un mensaje de toohello de propiedad:</span><span class="sxs-lookup"><span data-stu-id="af093-187">For example, we can modify hello previous code tooattach a property toohello message:</span></span>

```
MAP_HANDLE propMap = IoTHubMessage_Properties(message.messageHandle);
sprintf_s(propText, sizeof(propText), "%d", i);
Map_AddOrUpdate(propMap, "SequenceNumber", propText);
```

<span data-ttu-id="af093-188">Comenzamos llamando **IoTHubMessage\_propiedades** y pasándole el identificador hello de nuestro mensaje.</span><span class="sxs-lookup"><span data-stu-id="af093-188">We start by calling **IoTHubMessage\_Properties** and passing it hello handle of our message.</span></span> <span data-ttu-id="af093-189">Lo que obtenemos es un **mapa\_controlar** referencia que nos permite agregar propiedades de toostart.</span><span class="sxs-lookup"><span data-stu-id="af093-189">What we get back is a **MAP\_HANDLE** reference that enables us toostart adding properties.</span></span> <span data-ttu-id="af093-190">Hola este último se lleva a cabo mediante una llamada a **mapa\_AddOrUpdate**, que toma un mapa de referencia tooa\_identificador, el nombre de la propiedad de Hola y el valor de propiedad de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-190">hello latter is accomplished by calling **Map\_AddOrUpdate**, which takes a reference tooa MAP\_HANDLE, hello property name, and hello property value.</span></span> <span data-ttu-id="af093-191">Con esta API, podemos se pueden agregar todas la propiedades que se desee.</span><span class="sxs-lookup"><span data-stu-id="af093-191">With this API we can add as many properties as we like.</span></span>

<span data-ttu-id="af093-192">Cuando se leen los eventos de Hola de **centros de eventos**, receptor de hello puede mostrar propiedades de Hola y recuperar sus valores correspondientes.</span><span class="sxs-lookup"><span data-stu-id="af093-192">When hello event is read from **Event Hubs**, hello receiver can enumerate hello properties and retrieve their corresponding values.</span></span> <span data-ttu-id="af093-193">Por ejemplo, en .NET esto se lograría accediendo hello [colección de propiedades del objeto de hello EventData](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span><span class="sxs-lookup"><span data-stu-id="af093-193">For example, in .NET this would be accomplished by accessing hello [Properties collection on hello EventData object](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span></span>

<span data-ttu-id="af093-194">En el ejemplo anterior de hello, vamos a adjuntar eventos de tooan de propiedades que enviamos tooIoT concentrador.</span><span class="sxs-lookup"><span data-stu-id="af093-194">In hello previous example, we’re attaching properties tooan event that we send tooIoT Hub.</span></span> <span data-ttu-id="af093-195">Propiedades también pueden ser toomessages adjunto recibido desde el centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="af093-195">Properties can also be attached toomessages received from IoT Hub.</span></span> <span data-ttu-id="af093-196">Si lo deseamos tooretrieve propiedades de un mensaje, podemos utilizar código como Hola siguiente en la función de devolución de llamada de mensaje:</span><span class="sxs-lookup"><span data-stu-id="af093-196">If we want tooretrieve properties from a message, we can use code such as hello following in our message callback function:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .

    // Retrieve properties from hello message
    MAP_HANDLE mapProperties = IoTHubMessage_Properties(message);
    if (mapProperties != NULL)
    {
        const char*const* keys;
        const char*const* values;
        size_t propertyCount = 0;
        if (Map_GetInternals(mapProperties, &keys, &values, &propertyCount) == MAP_OK)
        {
            if (propertyCount > 0)
            {
                printf("Message Properties:\r\n");
                for (size_t index = 0; index < propertyCount; index++)
                {
                    printf("\tKey: %s Value: %s\r\n", keys[index], values[index]);
                }
                printf("\r\n");
            }
        }
    }

    . . .
}
```

<span data-ttu-id="af093-197">Hola llamada demasiado**IoTHubMessage\_propiedades** devuelve hello **mapa\_controlar** referencia.</span><span class="sxs-lookup"><span data-stu-id="af093-197">hello call too**IoTHubMessage\_Properties** returns hello **MAP\_HANDLE** reference.</span></span> <span data-ttu-id="af093-198">, A continuación, pasar dicha referencia demasiado**mapa\_GetInternals** tooobtain una matriz de tooan de referencia de nombre/valor de hello pares (así como un recuento de propiedades de hello).</span><span class="sxs-lookup"><span data-stu-id="af093-198">We then pass that reference too**Map\_GetInternals** tooobtain a reference tooan array of hello name/value pairs (as well as a count of hello properties).</span></span> <span data-ttu-id="af093-199">En ese momento es cuestión de enumerar Hola propiedades tooget toohello valores que deseamos.</span><span class="sxs-lookup"><span data-stu-id="af093-199">At that point it's a simple matter of enumerating hello properties tooget toohello values we want.</span></span>

<span data-ttu-id="af093-200">No tiene propiedades toouse en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="af093-200">You don't have toouse properties in your application.</span></span> <span data-ttu-id="af093-201">Sin embargo, si necesita tooset usarlas en eventos o recuperarlos desde mensajes, hello **IoTHubClient** biblioteca facilita el proceso.</span><span class="sxs-lookup"><span data-stu-id="af093-201">However, if you need tooset them on events or retrieve them from messages, hello **IoTHubClient** library makes it easy.</span></span>

## <a name="message-handling"></a><span data-ttu-id="af093-202">Administración de mensajes</span><span class="sxs-lookup"><span data-stu-id="af093-202">Message handling</span></span>
<span data-ttu-id="af093-203">Como se mencionó anteriormente, cuando llegan los mensajes de Hola de centro de IoT **IoTHubClient** biblioteca responde al invocar una función de devolución de llamada registrada.</span><span class="sxs-lookup"><span data-stu-id="af093-203">As stated previously, when messages arrive from IoT Hub hello **IoTHubClient** library responds by invoking a registered callback function.</span></span> <span data-ttu-id="af093-204">Hay un parámetro de valor devuelto de esta función que merece una explicación adicional.</span><span class="sxs-lookup"><span data-stu-id="af093-204">There is a return parameter of this function that deserves some additional explanation.</span></span> <span data-ttu-id="af093-205">Este es un extracto de la función de devolución de llamada de hello en hello **el centro de IOT\_cliente\_ejemplo\_http** aplicación de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="af093-205">Here’s an excerpt of hello callback function in hello **iothub\_client\_sample\_http** sample application:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .
    return IOTHUBMESSAGE_ACCEPTED;
}
```

<span data-ttu-id="af093-206">Tenga en cuenta que es el tipo de valor devuelto de hello **IOTHUBMESSAGE\_DISPOSITION\_resultado** y en este caso particular, devolvemos **IOTHUBMESSAGE\_aceptado**.</span><span class="sxs-lookup"><span data-stu-id="af093-206">Note that hello return type is **IOTHUBMESSAGE\_DISPOSITION\_RESULT** and in this particular case we return **IOTHUBMESSAGE\_ACCEPTED**.</span></span> <span data-ttu-id="af093-207">Hay otros valores, podemos devolvemos desde esta función que cambiar cómo Hola **IoTHubClient** biblioteca reacciona devolución de llamada de toohello mensaje.</span><span class="sxs-lookup"><span data-stu-id="af093-207">There are other values we can return from this function that change how hello **IoTHubClient** library reacts toohello message callback.</span></span> <span data-ttu-id="af093-208">Estas son opciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-208">Here are hello options.</span></span>

* <span data-ttu-id="af093-209">**IOTHUBMESSAGE\_aceptado** : mensaje de bienvenida se ha procesado correctamente.</span><span class="sxs-lookup"><span data-stu-id="af093-209">**IOTHUBMESSAGE\_ACCEPTED** – hello message has been processed successfully.</span></span> <span data-ttu-id="af093-210">Hola **IoTHubClient** biblioteca no invocará la función de devolución de llamada de hello nuevo con hello mismo mensaje.</span><span class="sxs-lookup"><span data-stu-id="af093-210">hello **IoTHubClient** library will not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="af093-211">**IOTHUBMESSAGE\_rechazado** : no se procesó el mensaje de bienvenida y no hay ningún toodo deseo en Hola futuras.</span><span class="sxs-lookup"><span data-stu-id="af093-211">**IOTHUBMESSAGE\_REJECTED** – hello message was not processed and there is no desire toodo so in hello future.</span></span> <span data-ttu-id="af093-212">Hola **IoTHubClient** biblioteca no debe invocar la función de devolución de llamada de hello nuevo con hello mismo mensaje.</span><span class="sxs-lookup"><span data-stu-id="af093-212">hello **IoTHubClient** library should not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="af093-213">**IOTHUBMESSAGE\_ABANDONED** : no se procesó correctamente el mensaje de bienvenida, pero Hola **IoTHubClient** biblioteca debe invocar la función de devolución de llamada de hello nuevo con hello mismo mensaje.</span><span class="sxs-lookup"><span data-stu-id="af093-213">**IOTHUBMESSAGE\_ABANDONED** – hello message was not processed successfully, but hello **IoTHubClient** library should invoke hello callback function again with hello same message.</span></span>

<span data-ttu-id="af093-214">Para hello primero dos códigos de retorno, hello **IoTHubClient** biblioteca envía un tooIoT de mensaje que indica ese mensaje Hola de concentrador debe eliminarse de cola de dispositivo de hello y no entregado de nuevo.</span><span class="sxs-lookup"><span data-stu-id="af093-214">For hello first two return codes, hello **IoTHubClient** library sends a message tooIoT Hub indicating that hello message should be deleted from hello device queue and not delivered again.</span></span> <span data-ttu-id="af093-215">efecto neto de Hello es Hola igual (mensaje de bienvenida se elimina de la cola de dispositivo de hello), pero todavía se registra si los mensajes de bienvenida se ha aceptado o rechazado.</span><span class="sxs-lookup"><span data-stu-id="af093-215">hello net effect is hello same (hello message is deleted from hello device queue), but whether hello message was accepted or rejected is still recorded.</span></span>  <span data-ttu-id="af093-216">La grabación de esta distinción es útil toosenders de mensaje de bienvenida que pueden realizar escuchas de los comentarios y averiguar si un dispositivo ha aceptado o rechazado un mensaje determinado.</span><span class="sxs-lookup"><span data-stu-id="af093-216">Recording this distinction is useful toosenders of hello message who can listen for feedback and find out if a device has accepted or rejected a particular message.</span></span>

<span data-ttu-id="af093-217">En caso último Hola se envía un mensaje también tooIoT concentrador, pero indica que ese mensaje Hola debería volverse a entregar.</span><span class="sxs-lookup"><span data-stu-id="af093-217">In hello last case a message is also sent tooIoT Hub, but it indicates that hello message should be redelivered.</span></span> <span data-ttu-id="af093-218">Normalmente podrá abandonar un mensaje si encuentra algún error, pero desea tootry tooprocess Hola mensaje nuevo.</span><span class="sxs-lookup"><span data-stu-id="af093-218">Typically you’ll abandon a message if you encounter some error but want tootry tooprocess hello message again.</span></span> <span data-ttu-id="af093-219">En cambio, rechazar un mensaje es adecuado cuando se produce un error irrecuperable (o si simplemente decide que no desea que el mensaje de bienvenida de tooprocess).</span><span class="sxs-lookup"><span data-stu-id="af093-219">In contrast, rejecting a message is appropriate when you encounter an unrecoverable error (or if you simply decide you don’t want tooprocess hello message).</span></span>

<span data-ttu-id="af093-220">En cualquier caso, tener en cuenta distintos códigos de retorno Hola por lo que puede susciten comportamiento de Hola que desea en hello **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="af093-220">In any case, be aware of hello different return codes so that you can elicit hello behavior you want from hello **IoTHubClient** library.</span></span>

## <a name="alternate-device-credentials"></a><span data-ttu-id="af093-221">Credenciales de dispositivo alternativas</span><span class="sxs-lookup"><span data-stu-id="af093-221">Alternate device credentials</span></span>
<span data-ttu-id="af093-222">Como se explicó anteriormente, Hola toodo lo primero que cuando se trabaja con hello **IoTHubClient** biblioteca es tooobtain una **el centro de IOT\_cliente\_controlar** con una llamada como Hola Después de:</span><span class="sxs-lookup"><span data-stu-id="af093-222">As explained previously, hello first thing toodo when working with hello **IoTHubClient** library is tooobtain a **IOTHUB\_CLIENT\_HANDLE** with a call such as hello following:</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="af093-223">Hola argumentos demasiado**IoTHubClient\_CreateFromConnectionString** son de cadena de conexión de dispositivo de Hola y un parámetro que indica el protocolo de hello usamos toocommunicate con centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="af093-223">hello arguments too**IoTHubClient\_CreateFromConnectionString** are hello device connection string and a parameter that indicates hello protocol we use toocommunicate with IoT Hub.</span></span> <span data-ttu-id="af093-224">cadena de conexión de dispositivo de Hello tiene un formato que aparece como sigue:</span><span class="sxs-lookup"><span data-stu-id="af093-224">hello device connection string has a format that appears as follows:</span></span>

```
HostName=IOTHUBNAME.IOTHUBSUFFIX;DeviceId=DEVICEID;SharedAccessKey=SHAREDACCESSKEY
```

<span data-ttu-id="af093-225">Hay cuatro grupos de información en esta cadena: nombre del Centro de IoT, sufijo del Centro de IoT, identificador de dispositivo y clave de acceso compartido.</span><span class="sxs-lookup"><span data-stu-id="af093-225">There are four pieces of information in this string: IoT Hub name, IoT Hub suffix, device ID, and shared access key.</span></span> <span data-ttu-id="af093-226">Obtener nombre de dominio completo (FQDN) de Hola de un centro de IoT cuando se crea la instancia del concentrador IoT en hello portal de Azure, esto da nombre (Hola primera parte del programa Hola FQDN) del centro de IoT de Hola y el sufijo de centro de IoT hello (resto de Hola de hello FQDN).</span><span class="sxs-lookup"><span data-stu-id="af093-226">You obtain hello fully qualified domain name (FQDN) of an IoT hub when you create your IoT hub instance in hello Azure portal — this gives you hello IoT hub name (hello first part of hello FQDN) and hello IoT hub suffix (hello rest of hello FQDN).</span></span> <span data-ttu-id="af093-227">Obtener Id. de dispositivo de Hola y la clave de acceso compartido de hello al registrar el dispositivo con el centro de IoT (como se describe en hello [artículo anterior](iot-hub-device-sdk-c-intro.md)).</span><span class="sxs-lookup"><span data-stu-id="af093-227">You get hello device ID and hello shared access key when you register your device with IoT Hub (as described in hello [previous article](iot-hub-device-sdk-c-intro.md)).</span></span>

<span data-ttu-id="af093-228">**IoTHubClient\_CreateFromConnectionString** le ofrece la biblioteca de hello tooinitialize unidireccional.</span><span class="sxs-lookup"><span data-stu-id="af093-228">**IoTHubClient\_CreateFromConnectionString** gives you one way tooinitialize hello library.</span></span> <span data-ttu-id="af093-229">Si lo prefiere, puede crear un nuevo **el centro de IOT\_cliente\_controlar** mediante el uso de estos parámetros individuales en lugar de la cadena de conexión de dispositivo de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-229">If you prefer, you can create a new **IOTHUB\_CLIENT\_HANDLE** by using these individual parameters rather than hello device connection string.</span></span> <span data-ttu-id="af093-230">Esto se logra con hello siguiente código:</span><span class="sxs-lookup"><span data-stu-id="af093-230">This is achieved with hello following code:</span></span>

```
IOTHUB_CLIENT_CONFIG iotHubClientConfig;
iotHubClientConfig.iotHubName = "";
iotHubClientConfig.deviceId = "";
iotHubClientConfig.deviceKey = "";
iotHubClientConfig.iotHubSuffix = "";
iotHubClientConfig.protocol = HTTP_Protocol;
IOTHUB_CLIENT_HANDLE iotHubClientHandle = IoTHubClient_LL_Create(&iotHubClientConfig);
```

<span data-ttu-id="af093-231">Esto lleva a cabo Hola lo mismo que **IoTHubClient\_CreateFromConnectionString**.</span><span class="sxs-lookup"><span data-stu-id="af093-231">This accomplishes hello same thing as **IoTHubClient\_CreateFromConnectionString**.</span></span>

<span data-ttu-id="af093-232">Puede parecer obvio que desearía toouse **IoTHubClient\_CreateFromConnectionString** en lugar de este método de inicialización más detallado.</span><span class="sxs-lookup"><span data-stu-id="af093-232">It may seem obvious that you would want toouse **IoTHubClient\_CreateFromConnectionString** rather than this more verbose method of initialization.</span></span> <span data-ttu-id="af093-233">Sin embargo, tenga en cuenta que cuando se registra un dispositivo en el Centro de IoT, lo que obtenemos es un identificador de dispositivo y una clave de dispositivo (no una cadena de conexión).</span><span class="sxs-lookup"><span data-stu-id="af093-233">Keep in mind, however, that when you register a device in IoT Hub what you get is a device ID and device key (not a connection string).</span></span> <span data-ttu-id="af093-234">Hola *explorador del dispositivo* herramienta SDK que se introduce en hello [artículo anterior](iot-hub-device-sdk-c-intro.md) usa las bibliotecas en hello **IoT de Azure SDK del servicio** cadena de conexión de dispositivo toocreate Hola desde Id. de dispositivo de Hello, clave de dispositivo y nombre de host del centro de IoT.</span><span class="sxs-lookup"><span data-stu-id="af093-234">hello *device explorer* SDK tool introduced in hello [previous article](iot-hub-device-sdk-c-intro.md) uses libraries in hello **Azure IoT service SDK** toocreate hello device connection string from hello device ID, device key, and IoT Hub host name.</span></span> <span data-ttu-id="af093-235">Por lo que una llamada a **IoTHubClient\_LL\_crear** puede ser preferible porque ahorra paso Hola consiste en generar una cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="af093-235">So calling **IoTHubClient\_LL\_Create** may be preferable because it saves you hello step of generating a connection string.</span></span> <span data-ttu-id="af093-236">Use el método que le resulte conveniente.</span><span class="sxs-lookup"><span data-stu-id="af093-236">Use whichever method is convenient.</span></span>

## <a name="configuration-options"></a><span data-ttu-id="af093-237">Opciones de configuración</span><span class="sxs-lookup"><span data-stu-id="af093-237">Configuration options</span></span>
<span data-ttu-id="af093-238">Hasta ahora todo lo que se describe sobre Hola Hola de manera **IoTHubClient** biblioteca works refleja su comportamiento predeterminado.</span><span class="sxs-lookup"><span data-stu-id="af093-238">So far everything described about hello way hello **IoTHubClient** library works reflects its default behavior.</span></span> <span data-ttu-id="af093-239">Sin embargo, hay algunas opciones que se puede establecer toochange cómo funciona la biblioteca de Hola.</span><span class="sxs-lookup"><span data-stu-id="af093-239">However, there are a few options that you can set toochange how hello library works.</span></span> <span data-ttu-id="af093-240">Esto se logra mediante el aprovechamiento de hello **IoTHubClient\_LL\_SetOption** API.</span><span class="sxs-lookup"><span data-stu-id="af093-240">This is accomplished by leveraging hello **IoTHubClient\_LL\_SetOption** API.</span></span> <span data-ttu-id="af093-241">En este ejemplo:</span><span class="sxs-lookup"><span data-stu-id="af093-241">Consider this example:</span></span>

```
unsigned int timeout = 30000;
IoTHubClient_LL_SetOption(iotHubClientHandle, "timeout", &timeout);
```

<span data-ttu-id="af093-242">Hay un par de opciones que se usan con frecuencia:</span><span class="sxs-lookup"><span data-stu-id="af093-242">There are a couple of options that are commonly used:</span></span>

* <span data-ttu-id="af093-243">**SetBatching** (bool): si **true**, entonces tooIoT centro de datos que se envían se envía en lotes.</span><span class="sxs-lookup"><span data-stu-id="af093-243">**SetBatching** (bool) – If **true**, then data sent tooIoT Hub is sent in batches.</span></span> <span data-ttu-id="af093-244">Si es **false**, los mensajes se envían individualmente.</span><span class="sxs-lookup"><span data-stu-id="af093-244">If **false**, then messages are sent individually.</span></span> <span data-ttu-id="af093-245">valor predeterminado de Hello es **false**.</span><span class="sxs-lookup"><span data-stu-id="af093-245">hello default is **false**.</span></span> <span data-ttu-id="af093-246">Tenga en cuenta que hello **SetBatching** opción solo aplica toohello HTTP y no toohello MQTT o AMQP protocolos.</span><span class="sxs-lookup"><span data-stu-id="af093-246">Note that hello **SetBatching** option only applies toohello HTTP protocol and not toohello MQTT or AMQP protocols.</span></span>
* <span data-ttu-id="af093-247">**Tiempo de espera** (entero sin sino): este valor se representa en milisegundos.</span><span class="sxs-lookup"><span data-stu-id="af093-247">**Timeout** (unsigned int) – This value is represented in milliseconds.</span></span> <span data-ttu-id="af093-248">Si envía una solicitud HTTP o recibir una respuesta tarda más tiempo, a continuación, Hola se agota.</span><span class="sxs-lookup"><span data-stu-id="af093-248">If sending an HTTP request or receiving a response takes longer than this time, then hello connection times out.</span></span>

<span data-ttu-id="af093-249">opción de procesamiento por lotes de Hello es importante.</span><span class="sxs-lookup"><span data-stu-id="af093-249">hello batching option is important.</span></span> <span data-ttu-id="af093-250">De forma predeterminada, Hola eventos de biblioteca de ingresses individualmente (un único evento es lo que se pase demasiado**IoTHubClient\_LL\_SendEventAsync**).</span><span class="sxs-lookup"><span data-stu-id="af093-250">By default, hello library ingresses events individually (a single event is whatever you pass too**IoTHubClient\_LL\_SendEventAsync**).</span></span> <span data-ttu-id="af093-251">Si es la opción de procesamiento por lotes de Hola **true**, biblioteca de hello recopila todos los eventos como sea posible de búfer de hello (arriba toohello tamaño máximo del mensaje que aceptará centro de IoT).</span><span class="sxs-lookup"><span data-stu-id="af093-251">If hello batching option is **true**, hello library collects as many events as it can from hello buffer (up toohello maximum message size that IoT Hub will accept).</span></span>  <span data-ttu-id="af093-252">Hello lote de eventos se envía tooIoT concentrador en una única llamada HTTP (eventos individuales de hello están agrupados en una matriz JSON).</span><span class="sxs-lookup"><span data-stu-id="af093-252">hello event batch is sent tooIoT Hub in a single HTTP call (hello individual events are bundled into a JSON array).</span></span> <span data-ttu-id="af093-253">Habilitar el procesamiento por lotes normalmente da como resultado un gran aumento del rendimiento ya que se reducen los recorridos de ida y vuelta de red.</span><span class="sxs-lookup"><span data-stu-id="af093-253">Enabling batching typically results in big performance gains since you’re reducing network round-trips.</span></span> <span data-ttu-id="af093-254">Además, reduce considerablemente el ancho de banda porque se envía un conjunto de encabezados HTTP con un lote de eventos en lugar de un conjunto de encabezados para cada evento individual.</span><span class="sxs-lookup"><span data-stu-id="af093-254">It also significantly reduces bandwidth since you are sending one set of HTTP headers with an event batch rather than a set of headers for each individual event.</span></span> <span data-ttu-id="af093-255">A menos que tenga un motivo concreto toodo en caso contrario, normalmente querrá tooenable procesamiento por lotes.</span><span class="sxs-lookup"><span data-stu-id="af093-255">Unless you have a specific reason toodo otherwise, typically you’ll want tooenable batching.</span></span>

## <a name="next-steps"></a><span data-ttu-id="af093-256">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="af093-256">Next steps</span></span>
<span data-ttu-id="af093-257">Este artículo se describen en el comportamiento de Hola de detalle de hello **IoTHubClient** biblioteca se encuentra en hello **dispositivos de IoT de Azure SDK para C**. Con esta información, debe tener un buen conocimiento de las capacidades de Hola de hello **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="af093-257">This article describes in detail hello behavior of hello **IoTHubClient** library found in hello **Azure IoT device SDK for C**. With this information, you should have a good understanding of hello capabilities of hello **IoTHubClient** library.</span></span> <span data-ttu-id="af093-258">Hola [artículo siguiente](iot-hub-device-sdk-c-serializer.md) proporciona detalles similares en hello **serializador** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="af093-258">hello [next article](iot-hub-device-sdk-c-serializer.md) provides similar detail on hello **serializer** library.</span></span>

<span data-ttu-id="af093-259">toolearn más sobre el desarrollo de centro de IoT, vea hello [SDK de Azure IoT][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="af093-259">toolearn more about developing for IoT Hub, see hello [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="af093-260">toofurther explorar las capacidades de Hola de centro de IoT, vea:</span><span class="sxs-lookup"><span data-stu-id="af093-260">toofurther explore hello capabilities of IoT Hub, see:</span></span>

* <span data-ttu-id="af093-261">[Simular un dispositivo con Azure IoT Edge][lnk-iotedge]</span><span class="sxs-lookup"><span data-stu-id="af093-261">[Simulating a device with Azure IoT Edge][lnk-iotedge]</span></span>

[lnk-sdks]: iot-hub-devguide-sdks.md

[lnk-iotedge]: iot-hub-linux-iot-edge-simulated-device.md
