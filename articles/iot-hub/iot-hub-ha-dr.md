---
title: "Alta disponibilidad y recuperación ante desastres de Azure IoT Hub | Microsoft Docs"
description: "Describe las características de Azure e IoT Hub que lo ayudarán a crear soluciones de IoT de Azure de alta disponibilidad con funcionalidades de recuperación ante desastres."
services: iot-hub
documentationcenter: 
author: fsautomata
manager: timlt
editor: 
ms.assetid: ae320e58-aa20-45b9-abdc-fa4faae8e6dd
ms.service: iot-hub
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/16/2016
ms.author: elioda
ms.openlocfilehash: 76c3187549e1821908263c30e394db26ee6f75e6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="iot-hub-high-availability-and-disaster-recovery"></a><span data-ttu-id="8c8aa-103">Alta disponibilidad y recuperación ante desastres del Centro de IoT</span><span class="sxs-lookup"><span data-stu-id="8c8aa-103">IoT Hub high availability and disaster recovery</span></span>
<span data-ttu-id="8c8aa-104">Como un servicio de Azure, el Centro de IoT proporciona alta disponibilidad (HA) usando redundancias en la región de Azure, sin que la solución tenga que realizar ningún trabajo adicional.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-104">As an Azure service, IoT Hub provides high availability (HA) using redundancies at the Azure region level, without any additional work required by the solution.</span></span> <span data-ttu-id="8c8aa-105">La plataforma Microsoft Azure también incluye características para ayudarle a crear soluciones con funcionalidades de recuperación ante desastres o disponibilidad entre regiones.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-105">The Microsoft Azure platform also includes features to help you build solutions with disaster recovery (DR) capabilities or cross-region availability.</span></span> <span data-ttu-id="8c8aa-106">Si desea proporcionar alta disponibilidad global entre regiones para dispositivos o usuarios, debe diseñar y preparar las soluciones para que aprovechen estas características de recuperación ante desastres de Azure.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-106">If you want to provide global, cross-region high availability for devices or users, design and prepare your solutions to take advantage of these Azure DR features.</span></span> <span data-ttu-id="8c8aa-107">En el artículo [Guía técnica sobre la continuidad empresarial de Azure](../resiliency/resiliency-technical-guidance.md) , se describen las características integradas en Azure para la continuidad empresarial y la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-107">The article [Azure Business Continuity Technical Guidance](../resiliency/resiliency-technical-guidance.md) describes the built-in features in Azure for business continuity and DR.</span></span> <span data-ttu-id="8c8aa-108">El documento [Recuperación ante desastres y alta disponibilidad para aplicaciones de Azure][Disaster recovery and high availability for Azure applications] proporciona una guía de arquitectura enfocada a estrategias para que las aplicaciones de Azure logren alta disponibilidad y recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-108">The [Disaster recovery and high availability for Azure applications][Disaster recovery and high availability for Azure applications] paper provides architecture guidance on strategies for Azure applications to achieve HA and DR.</span></span>

## <a name="azure-iot-hub-dr"></a><span data-ttu-id="8c8aa-109">Recuperación ante desastres de Centro de IoT de Azure</span><span class="sxs-lookup"><span data-stu-id="8c8aa-109">Azure IoT Hub DR</span></span>
<span data-ttu-id="8c8aa-110">Además de la alta disponibilidad dentro de una región, Centro de IoT implementa mecanismos de conmutación por error para recuperación ante desastres que no requieren intervención del usuario.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-110">In addition to intra-region HA, IoT Hub implements failover mechanisms for disaster recovery that require no intervention from the user.</span></span> <span data-ttu-id="8c8aa-111">La recuperación ante desastres del Centro de IoT se inicia automáticamente y tiene un objetivo de tiempo de recuperación (RTO) de 2 a 26 horas y los siguientes objetivos de punto de recuperación (RPO).</span><span class="sxs-lookup"><span data-stu-id="8c8aa-111">IoT Hub DR is self-initiated and has a recovery time objective (RTO) of 2-26 hours, and the following recovery point objectives (RPOs).</span></span>

| <span data-ttu-id="8c8aa-112">Funcionalidad</span><span class="sxs-lookup"><span data-stu-id="8c8aa-112">Functionality</span></span> | <span data-ttu-id="8c8aa-113">RPO</span><span class="sxs-lookup"><span data-stu-id="8c8aa-113">RPO</span></span> |
| --- | --- |
| <span data-ttu-id="8c8aa-114">Disponibilidad de servicio para las operaciones de registro y comunicación</span><span class="sxs-lookup"><span data-stu-id="8c8aa-114">Service availability for registry and communication operations</span></span> |<span data-ttu-id="8c8aa-115">Posible pérdida de CName</span><span class="sxs-lookup"><span data-stu-id="8c8aa-115">Possible CName loss</span></span> |
| <span data-ttu-id="8c8aa-116">Datos de identidad en el registro de identidad</span><span class="sxs-lookup"><span data-stu-id="8c8aa-116">Identity data in identity registry</span></span> |<span data-ttu-id="8c8aa-117">Pérdida de datos de 0-5 minutos</span><span class="sxs-lookup"><span data-stu-id="8c8aa-117">0-5 mins data loss</span></span> |
| <span data-ttu-id="8c8aa-118">Mensajes de dispositivo a nube</span><span class="sxs-lookup"><span data-stu-id="8c8aa-118">Device-to-cloud messages</span></span> |<span data-ttu-id="8c8aa-119">Se pierden todos los mensajes no leídos</span><span class="sxs-lookup"><span data-stu-id="8c8aa-119">All unread messages are lost</span></span> |
| <span data-ttu-id="8c8aa-120">Mensajes de supervisión de operaciones</span><span class="sxs-lookup"><span data-stu-id="8c8aa-120">Operations monitoring messages</span></span> |<span data-ttu-id="8c8aa-121">Se pierden todos los mensajes no leídos</span><span class="sxs-lookup"><span data-stu-id="8c8aa-121">All unread messages are lost</span></span> |
| <span data-ttu-id="8c8aa-122">Mensajes de nube a dispositivo</span><span class="sxs-lookup"><span data-stu-id="8c8aa-122">Cloud-to-device messages</span></span> |<span data-ttu-id="8c8aa-123">Pérdida de datos de 0-5 minutos</span><span class="sxs-lookup"><span data-stu-id="8c8aa-123">0-5 mins data loss</span></span> |
| <span data-ttu-id="8c8aa-124">Cola de comentarios de nube a dispositivo</span><span class="sxs-lookup"><span data-stu-id="8c8aa-124">Cloud-to-device feedback queue</span></span> |<span data-ttu-id="8c8aa-125">Se pierden todos los mensajes no leídos</span><span class="sxs-lookup"><span data-stu-id="8c8aa-125">All unread messages are lost</span></span> |

## <a name="regional-failover-with-iot-hub"></a><span data-ttu-id="8c8aa-126">Conmutación por error regional con el Centro de IoT</span><span class="sxs-lookup"><span data-stu-id="8c8aa-126">Regional failover with IoT Hub</span></span>
<span data-ttu-id="8c8aa-127">El objetivo de este artículo no es proporcionar una descripción completa de las topologías de implementación de soluciones de IoT.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-127">A complete treatment of deployment topologies in IoT solutions is outside the scope of this article.</span></span> <span data-ttu-id="8c8aa-128">Este artículo explica el modelo de implementación de *conmutación por error regional* para la alta disponibilidad y la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-128">The article discusses the *regional failover* deployment model for the purpose of high availability and disaster recovery.</span></span>

<span data-ttu-id="8c8aa-129">En un modelo de conmutación por error regional, el back-end de solución se ejecuta principalmente en la ubicación de un centro de datos y un centro de IoT secundario y back-end se implementan otra ubicación de centro de datos.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-129">In a regional failover model, the solution back end runs primarily in one datacenter location, and a secondary IoT hub and back end are deployed in another datacenter location.</span></span> <span data-ttu-id="8c8aa-130">Si el centro de IoT Hub del centro de datos principal sufre un corte o se interrumpe la conectividad de red del dispositivo al centro de datos principal.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-130">If the IoT hub in the primary datacenter suffers an outage or the network connectivity from the device to the primary datacenter is interrupted.</span></span> <span data-ttu-id="8c8aa-131">Los dispositivos usan un punto de conexión de servicio secundario siempre que no se puede alcanzar la puerta de enlace principal.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-131">Devices use a secondary service endpoint whenever the primary gateway cannot be reached.</span></span> <span data-ttu-id="8c8aa-132">Con la capacidad de conmutación por error entre regiones, la disponibilidad de la solución puede mejorar más allá de la alta disponibilidad de una única región.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-132">With a cross-region failover capability, the solution availability can be improved beyond the high availability of a single region.</span></span>

<span data-ttu-id="8c8aa-133">A grandes rasgos, para implementar un modelo de conmutación por error regional con IoT Hub, necesitará la siguiente:</span><span class="sxs-lookup"><span data-stu-id="8c8aa-133">At a high level, to implement a regional failover model with IoT Hub, you need the following:</span></span>

* <span data-ttu-id="8c8aa-134">**Un Centro de IoT secundario y lógica de enrutamiento de dispositivo**: si se produce una interrupción del servicio en la región primaria, los dispositivos deben empezar a conectarse a la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-134">**A secondary IoT hub and device routing logic**: In the case of a service disruption in your primary region, devices must start connecting to your secondary region.</span></span> <span data-ttu-id="8c8aa-135">Como se conoce el estado de la mayoría de los servicios implicados, es habitual que los administradores de la solución desencadenen el proceso de conmutación por error entre regiones.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-135">Given the state-aware nature of most services involved, it is common for solution administrators to trigger the inter-region failover process.</span></span> <span data-ttu-id="8c8aa-136">La mejor forma de comunicar el nuevo punto de conexión con los dispositivos, sin perder el control del proceso, es hacer que comprueben periódicamente un servicio de *conserje* para el punto de conexión activo actual.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-136">The best way to communicate the new endpoint to devices, while maintaining control of the process, is to have them regularly check a *concierge* service for the current active endpoint.</span></span> <span data-ttu-id="8c8aa-137">El servicio de conserje puede ser una aplicación web simple que se replica y se mantiene accesible mediante técnicas de redirección de DNS (por ejemplo, con el [Azure Traffic Manager][Azure Traffic Manager]).</span><span class="sxs-lookup"><span data-stu-id="8c8aa-137">The concierge service can be a web application that is replicated and kept reachable using DNS-redirection techniques (for example, using [Azure Traffic Manager][Azure Traffic Manager]).</span></span>
* <span data-ttu-id="8c8aa-138">**Replicación del registro de identidad**: para que el centro de IoT secundario pueda usarse, debe contener todas las identidades de dispositivo que se pueden conectar a la solución.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-138">**Identity registry replication** - To be usable, the secondary IoT hub must contain all device identities that can connect to the solution.</span></span> <span data-ttu-id="8c8aa-139">La solución debe conservar copias de seguridad de replicación geográfica de las identidades de dispositivo y cargarlas en el Centro de IoT secundario antes de cambiar el punto de conexión activo de los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-139">The solution should keep geo-replicated backups of device identities, and upload them to the secondary IoT hub before switching the active endpoint for the devices.</span></span> <span data-ttu-id="8c8aa-140">La funcionalidad de exportación de identidades de dispositivo de IoT Hub resulta muy útil en este contexto.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-140">The device identity export functionality of IoT Hub is useful in this context.</span></span> <span data-ttu-id="8c8aa-141">Para obtener más información, consulte la [guía para desarrolladores de IoT Hub sobre registro de identidad][IoT Hub developer guide - identity registry].</span><span class="sxs-lookup"><span data-stu-id="8c8aa-141">For more information, see [IoT Hub developer guide - identity registry][IoT Hub developer guide - identity registry].</span></span>
* <span data-ttu-id="8c8aa-142">**Lógica de combinación** : cuando la región primaria vuelve a estar disponible, todos los estados y datos que se crearon en el sitio secundario deben volver a migrarse a la región primaria.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-142">**Merging logic** - When the primary region becomes available again, all the state and data that have been created in the secondary site must be migrated back to the primary region.</span></span> <span data-ttu-id="8c8aa-143">Este estado y estos datos tienen que ver principalmente con las identidades de dispositivo y los metadatos de aplicación, que deben combinarse con el centro de IoT principal y con otros almacenes específicos de la aplicación en la región primaria.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-143">This state and data mostly relates to device identities and application metadata, which must be merged with the primary IoT hub and any other application-specific stores in the primary region.</span></span> <span data-ttu-id="8c8aa-144">Para simplificar este paso, debe usar las operaciones de idempotente.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-144">To simplify this step, you should use idempotent operations.</span></span> <span data-ttu-id="8c8aa-145">Estas minimizan los efectos secundarios de la posible distribución uniforme de eventos y de los duplicados o la entrega desordenada de eventos.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-145">Idempotent operations minimize the side-effects from the eventual consistent distribution of events, and from duplicates or out-of-order delivery of events.</span></span> <span data-ttu-id="8c8aa-146">Además, la lógica de aplicación debe diseñarse para que tolere posibles incoherencias o un estado "algo" desactualizado.</span><span class="sxs-lookup"><span data-stu-id="8c8aa-146">In addition, the application logic should be designed to tolerate potential inconsistencies or "slightly" out of date-state.</span></span> <span data-ttu-id="8c8aa-147">Esta situación se puede producir debido al tiempo adicional que tarda el sistema en "repararse" según los objetivos de punto de recuperación (RPO).</span><span class="sxs-lookup"><span data-stu-id="8c8aa-147">This situation can occur due to the additional time it takes for the system to "heal" based on recovery point objectives (RPO).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8c8aa-148">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="8c8aa-148">Next steps</span></span>
<span data-ttu-id="8c8aa-149">Siga estos vínculos para obtener más información sobre el Centro de IoT de Azure:</span><span class="sxs-lookup"><span data-stu-id="8c8aa-149">Follow these links to learn more about Azure IoT Hub:</span></span>

* <span data-ttu-id="8c8aa-150">[Introducción a los centros de IoT (tutorial)][lnk-get-started]</span><span class="sxs-lookup"><span data-stu-id="8c8aa-150">[Get started with IoT Hubs (Tutorial)][lnk-get-started]</span></span>
* <span data-ttu-id="8c8aa-151">[¿Qué es Azure IoT Hub?][What is Azure IoT Hub?]</span><span class="sxs-lookup"><span data-stu-id="8c8aa-151">[What is Azure IoT Hub?][What is Azure IoT Hub?]</span></span>

[Disaster recovery and high availability for Azure applications]: ../resiliency/resiliency-disaster-recovery-high-availability-azure-applications.md
[Azure Business Continuity Technical Guidance]: https://azure.microsoft.com/documentation/articles/resiliency-technical-guidance/
[Azure Traffic Manager]: https://azure.microsoft.com/documentation/services/traffic-manager/
[IoT Hub developer guide - identity registry]: iot-hub-devguide-identity-registry.md

[lnk-get-started]: iot-hub-csharp-csharp-getstarted.md
[What is Azure IoT Hub?]: iot-hub-what-is-iot-hub.md
