---
title: "Azure Active Directory B2C: solución de problemas de directivas personalizadas | Microsoft Docs"
description: "Obtenga información acerca de métodos toosolving errores cuando se trabaja con las directivas personalizadas en Azure Active Directory."
services: active-directory-b2c
documentationcenter: 
author: rojasja
manager: krassk
editor: rojasja
ms.assetid: 
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/07/2017
ms.author: joroja
ms.openlocfilehash: b9e1b46df1ddb29cdb90953e4a0d6f1dd085441f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-azure-ad-b2c-custom-policies-and-identity-experience-framework"></a><span data-ttu-id="5a8dc-103">Solución de problemas de directivas personalizadas de Azure AD B2C y el marco de experiencia de identidad</span><span class="sxs-lookup"><span data-stu-id="5a8dc-103">Troubleshoot Azure AD B2C custom policies and Identity Experience Framework</span></span>

<span data-ttu-id="5a8dc-104">Si utiliza Azure Active Directory B2C (Azure AD B2C) directivas personalizadas, es posible que experimente desafíos configurar Hola Identity Framework de experiencia en el formato XML de lenguaje de directiva.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-104">If you use Azure Active Directory B2C (Azure AD B2C) custom policies, you might experience challenges setting up hello Identity Experience Framework in its policy language XML format.</span></span>  <span data-ttu-id="5a8dc-105">Directivas personalizadas de aprendizaje toowrite pueden ser como un nuevo lenguaje de aprendizaje.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-105">Learning toowrite custom policies can be like learning a new language.</span></span> <span data-ttu-id="5a8dc-106">En este artículo se describen las herramientas y las sugerencias que pueden ayudarle a detectar y solucionar problemas rápidamente.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-106">In this article, we describe tools and tips that can help you quickly discover and resolve issues.</span></span> 

> [!NOTE]
> <span data-ttu-id="5a8dc-107">Este artículo se centra en la solución de problemas de configuración de directivas personalizadas de Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-107">This article focuses on troubleshooting your Azure AD B2C custom policy configuration.</span></span> <span data-ttu-id="5a8dc-108">No aborda Hola su biblioteca de identidad o aplicación de usuario de confianza.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-108">It doesn't address hello relying party application or its identity library.</span></span>

## <a name="xml-editing"></a><span data-ttu-id="5a8dc-109">Edición de XML</span><span class="sxs-lookup"><span data-stu-id="5a8dc-109">XML editing</span></span>

<span data-ttu-id="5a8dc-110">Hola error más comunes de configuración de directivas personalizadas es incorrecto con formato XML.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-110">hello most common error in setting up custom policies is improperly formatted XML.</span></span> <span data-ttu-id="5a8dc-111">Es fundamental contar con un buen editor XML.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-111">A good XML editor is nearly essential.</span></span> <span data-ttu-id="5a8dc-112">Un buen editor XML muestra XML nativo y contenido codificado por colores, rellena previamente términos comunes, mantiene los elementos XML indexados y puede validar con esquemas.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-112">A good XML editor displays XML natively, color-codes content, prefills common terms, keeps XML elements indexed, and can validate with schema.</span></span> <span data-ttu-id="5a8dc-113">Dos de nuestros editores XML favoritos son:</span><span class="sxs-lookup"><span data-stu-id="5a8dc-113">Here are two of our favorite XML editors:</span></span>

* [<span data-ttu-id="5a8dc-114">código de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5a8dc-114">Visual Studio Code</span></span>](https://code.visualstudio.com/)
* [<span data-ttu-id="5a8dc-115">Notepad++</span><span class="sxs-lookup"><span data-stu-id="5a8dc-115">Notepad++</span></span>](https://notepad-plus-plus.org/)

<span data-ttu-id="5a8dc-116">La validación del esquema XML identifica los errores antes de cargar el archivo XML.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-116">XML schema validation identifies errors before you upload your XML file.</span></span> <span data-ttu-id="5a8dc-117">En la carpeta raíz de Hola de módulo de inicio de hello, obtener definición de esquemas XML de hello TrustFrameworkPolicy_0.3.0.0.xsd.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-117">In hello root folder of hello starter pack, get hello XML schema definition TrustFrameworkPolicy_0.3.0.0.xsd.</span></span> <span data-ttu-id="5a8dc-118">Para obtener más información, en la documentación de Hola de su editor XML, busque *herramientas XML* y *validación XML*.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-118">For more information, in hello documentation of your XML editor, look for *XML tools* and *XML validation*.</span></span>

<span data-ttu-id="5a8dc-119">Podría resultarle útil revisar las reglas del código XML.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-119">You might find a review of XML rules helpful.</span></span> <span data-ttu-id="5a8dc-120">Azure AD B2C rechaza todos los errores de formato XML que detecta.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-120">Azure AD B2C rejects any XML formatting errors that it detects.</span></span> <span data-ttu-id="5a8dc-121">En ocasiones, un formato XML incorrecto puede dar lugar a mensajes de error que resultan engañosos.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-121">Occasionally, incorrectly formatted XML might cause error messages that are misleading.</span></span>

## <a name="upload-policies-and-policy-validation"></a><span data-ttu-id="5a8dc-122">Validación de directivas y directivas de carga</span><span class="sxs-lookup"><span data-stu-id="5a8dc-122">Upload policies and policy validation</span></span>

 <span data-ttu-id="5a8dc-123">La validación de la carga de archivos XML es automática.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-123">XML file upload validation is automatic.</span></span> <span data-ttu-id="5a8dc-124">Mayoría de los errores provocar Hola carga toofail.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-124">Most errors cause hello upload toofail.</span></span> <span data-ttu-id="5a8dc-125">Validación incluye el archivo de directiva de Hola que va a cargar.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-125">Validation includes hello policy file that you are uploading.</span></span> <span data-ttu-id="5a8dc-126">También incluye la cadena de Hola de archivos de archivo de carga de hello hace referencia demasiado (Hola archivo de directiva de entidad de confianza, archivo de extensiones de hello y archivo de base de hello).</span><span class="sxs-lookup"><span data-stu-id="5a8dc-126">It also includes hello chain of files hello upload file refers too(hello relying party policy file, hello extensions file, and hello base file).</span></span> 
 
 <span data-ttu-id="5a8dc-127">Errores de validación comunes siguientes Hola.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-127">Common validation errors include hello following.</span></span>

<span data-ttu-id="5a8dc-128">Fragmento de código de error: `... makes a reference tooClaimType with id "displaName" but neither hello policy nor any of its base policies contain such an element`</span><span class="sxs-lookup"><span data-stu-id="5a8dc-128">Error snippet: `... makes a reference tooClaimType with id "displaName" but neither hello policy nor any of its base policies contain such an element`</span></span>
* <span data-ttu-id="5a8dc-129">Hola ClaimType valor podría estar mal escrito, o no existe en el esquema de Hola.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-129">hello ClaimType value might be misspelled, or does not exist in hello schema.</span></span>
* <span data-ttu-id="5a8dc-130">ClaimType valores deben definirse en al menos uno de los archivos de hello en la directiva de Hola.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-130">ClaimType values must be defined in at least one of hello files in hello policy.</span></span> 
    <span data-ttu-id="5a8dc-131">Por ejemplo: ` <ClaimType Id="socialIdpUserId">`</span><span class="sxs-lookup"><span data-stu-id="5a8dc-131">For example: ` <ClaimType Id="socialIdpUserId">`</span></span>
* <span data-ttu-id="5a8dc-132">Si ClaimType se define en el archivo de extensiones de hello, pero también se utiliza un valor de TechnicalProfile en el archivo de base de hello, cargar el archivo de base de hello produce un error.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-132">If ClaimType is defined in hello extensions file, but it's also used in a TechnicalProfile value in hello base file, uploading hello base file results in an error.</span></span>

<span data-ttu-id="5a8dc-133">Fragmento de código de error: `...makes a reference tooa ClaimsTransformation with id...`</span><span class="sxs-lookup"><span data-stu-id="5a8dc-133">Error snippet: `...makes a reference tooa ClaimsTransformation with id...`</span></span>
* <span data-ttu-id="5a8dc-134">Hola causas de error Hola podría ser Hola igual para error de ClaimType Hola.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-134">hello causes for hello error might be hello same as for hello ClaimType error.</span></span>

<span data-ttu-id="5a8dc-135">Fragmento de código de error: `Reason: User is currently logged as a user of 'yourtenant.onmicrosoft.com' tenant. In order toomanage 'yourtenant.onmicrosoft.com', please login as a user of 'yourtenant.onmicrosoft.com' tenant`</span><span class="sxs-lookup"><span data-stu-id="5a8dc-135">Error snippet: `Reason: User is currently logged as a user of 'yourtenant.onmicrosoft.com' tenant. In order toomanage 'yourtenant.onmicrosoft.com', please login as a user of 'yourtenant.onmicrosoft.com' tenant`</span></span>
* <span data-ttu-id="5a8dc-136">Compruebe ese valor de TenantId de Hola Hola  **\<TrustFrameworkPolicy\>**  y  **\<BasePolicy\>**  elementos coinciden con el destino de Azure AD B2C inquilino.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-136">Check that hello TenantId value in hello **\<TrustFrameworkPolicy\>** and **\<BasePolicy\>** elements match your target Azure AD B2C tenant.</span></span>  

## <a name="troubleshoot-hello-runtime"></a><span data-ttu-id="5a8dc-137">Solucionar problemas en tiempo de ejecución de Hola</span><span class="sxs-lookup"><span data-stu-id="5a8dc-137">Troubleshoot hello runtime</span></span>

* <span data-ttu-id="5a8dc-138">Use `Run Now` y `https://jwt.io` tootest las directivas independientemente de la web o aplicaciones móviles.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-138">Use `Run Now` and `https://jwt.io` tootest your policies independently of your web or mobile application.</span></span> <span data-ttu-id="5a8dc-139">Este sitio web actúa como una aplicación de usuario de confianza.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-139">This website acts like a relying party application.</span></span> <span data-ttu-id="5a8dc-140">Muestra el contenido de Hola de hello JSON Web Token (JWT) que se genera mediante la directiva de Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-140">It displays hello contents of hello JSON Web Token (JWT) that is generated by your Azure AD B2C policy.</span></span> <span data-ttu-id="5a8dc-141">toocreate una aplicación de prueba de identidad experiencia Framework, Hola de uso después de valores:</span><span class="sxs-lookup"><span data-stu-id="5a8dc-141">toocreate a test application in Identity Experience Framework, use hello following values:</span></span>
    * <span data-ttu-id="5a8dc-142">Nombre: TestApp</span><span class="sxs-lookup"><span data-stu-id="5a8dc-142">Name: TestApp</span></span>
    * <span data-ttu-id="5a8dc-143">Aplicación web/API web: No</span><span class="sxs-lookup"><span data-stu-id="5a8dc-143">Web App/Web API: No</span></span>
    * <span data-ttu-id="5a8dc-144">Cliente nativo: No</span><span class="sxs-lookup"><span data-stu-id="5a8dc-144">Native client: No</span></span>

* <span data-ttu-id="5a8dc-145">intercambio de hello tootrace de mensajes entre el explorador del cliente y Azure AD B2C, use [Fiddler](http://www.telerik.com/fiddler).</span><span class="sxs-lookup"><span data-stu-id="5a8dc-145">tootrace hello exchange of messages between your client browser and Azure AD B2C, use [Fiddler](http://www.telerik.com/fiddler).</span></span> <span data-ttu-id="5a8dc-146">Puede ayudarle a detectar un error en el recorrido del usuario en los pasos de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-146">It can help you get an indication of where your user journey is failing in your orchestration steps.</span></span>

* <span data-ttu-id="5a8dc-147">En **modo de desarrollo**, use **Application Insights** actividad de hello tootrace de su viaje de usuario de marco de la experiencia de identidad.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-147">In **Development mode**, use **Application Insights** tootrace hello activity of your Identity Experience Framework user journey.</span></span> <span data-ttu-id="5a8dc-148">En **modo de desarrollo**, puede observar exchange Hola de notificaciones entre Hola Framework de la experiencia de identidad y hello distintos proveedor de notificaciones que se define mediante perfiles técnicos, como proveedores de identidades, servicios basados en la API directorio de usuarios de Azure AD B2C Hello y otros servicios, como varios-Factor-autenticación de Azure.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-148">In **Development mode**, you can observe hello exchange of claims between hello Identity Experience Framework and hello various claims providers that are defined by technical profiles, such as identity providers, API-based services, hello Azure AD B2C user directory, and other services, like Azure Multi-Factor-Authentication.</span></span>  

## <a name="recommended-practices"></a><span data-ttu-id="5a8dc-149">Procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="5a8dc-149">Recommended practices</span></span>

<span data-ttu-id="5a8dc-150">**Mantenga varias versiones de los escenarios. Agrúpelas en un proyecto con la aplicación.**</span><span class="sxs-lookup"><span data-stu-id="5a8dc-150">**Keep multiple versions of your scenarios. Group them in a project with your application.**</span></span> <span data-ttu-id="5a8dc-151">base de Hello, extensiones y archivos de entidad de confianza dependen directamente entre sí.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-151">hello base, extensions, and relying party files are directly dependent on each other.</span></span> <span data-ttu-id="5a8dc-152">Guárdelos como un grupo.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-152">Save them as a group.</span></span> <span data-ttu-id="5a8dc-153">Tal y como se agregaron características nuevas directivas de tooyour, mantener versiones distintas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-153">As new features are added tooyour policies, keep separate working versions.</span></span> <span data-ttu-id="5a8dc-154">Versiones de trabajo de la fase en su propio sistema con código de la aplicación hello interactúan de archivos.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-154">Stage working versions in your own file system with hello application code they interact with.</span></span>  <span data-ttu-id="5a8dc-155">Las aplicaciones pueden invocar muchas directivas de usuario de confianza diferentes en un inquilino.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-155">Your applications might invoke many different relying party policies in a tenant.</span></span> <span data-ttu-id="5a8dc-156">Estén depende de las notificaciones de Hola que esperan desde sus directivas de Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-156">They might become dependent on hello claims that they expect from your Azure AD B2C policies.</span></span>

<span data-ttu-id="5a8dc-157">**Desarrolle y pruebe perfiles técnicos con recorridos de usuario conocidos.**</span><span class="sxs-lookup"><span data-stu-id="5a8dc-157">**Develop and test technical profiles with known user journeys.**</span></span> <span data-ttu-id="5a8dc-158">Directivas de uso probado starter pack tooset sus perfiles técnicos de.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-158">Use tested starter pack policies tooset up your technical profiles.</span></span> <span data-ttu-id="5a8dc-159">Pruébelas por separado antes de incorporarlas a sus propios recorridos de usuario.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-159">Test them separately before you incorporate them into your own user journeys.</span></span>

<span data-ttu-id="5a8dc-160">**Desarrolle y pruebe recorridos de usuario con perfiles técnicos conocidos.**</span><span class="sxs-lookup"><span data-stu-id="5a8dc-160">**Develop and test user journeys with tested technical profiles.**</span></span> <span data-ttu-id="5a8dc-161">Cambiar los pasos de orquestación Hola de un viaje de usuario de forma incremental.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-161">Change hello orchestration steps of a user journey incrementally.</span></span> <span data-ttu-id="5a8dc-162">Compile progresivamente los escenarios previstos.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-162">Progressively build your intended scenarios.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5a8dc-163">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="5a8dc-163">Next steps</span></span>

* <span data-ttu-id="5a8dc-164">En GitHub, descargue el archivo de .zip (https://github.com/Azure-Samples/active-directory-b2c-custom-policy-starterpack/archive/master.zip) [active-directory-b2c-custom-policy-starterpack] de Hola.</span><span class="sxs-lookup"><span data-stu-id="5a8dc-164">In GitHub, download hello [active-directory-b2c-custom-policy-starterpack] (https://github.com/Azure-Samples/active-directory-b2c-custom-policy-starterpack/archive/master.zip) .zip file.</span></span>
