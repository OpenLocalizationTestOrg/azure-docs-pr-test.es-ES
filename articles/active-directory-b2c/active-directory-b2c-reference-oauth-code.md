---
title: "Flujo de código de autorización - Azure AD B2C | Microsoft Docs"
description: "Aprenda a crear aplicaciones web mediante el protocolo de autenticación de Azure AD B2C y OpenID Connect."
services: active-directory-b2c
documentationcenter: 
author: saeedakhter-msft
manager: krassk
editor: parakhj
ms.assetid: c371aaab-813a-4317-97df-b62e2f53d865
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/16/2017
ms.author: saeedakhter-msft
ms.openlocfilehash: dfc4f2e84704307ccbea6141c0dbc8d089733b22
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="azure-active-directory-b2c-oauth-20-authorization-code-flow"></a><span data-ttu-id="219eb-103">Azure Active Directory B2C: flujo de código de autorización de OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="219eb-103">Azure Active Directory B2C: OAuth 2.0 authorization code flow</span></span>
<span data-ttu-id="219eb-104">Puede usar la concesión de un código de autorización de OAuth 2.0 en las aplicaciones instaladas en un dispositivo para obtener acceso a recursos protegidos, como las API web.</span><span class="sxs-lookup"><span data-stu-id="219eb-104">You can use the OAuth 2.0 authorization code grant in apps installed on a device to gain access to protected resources, such as web APIs.</span></span> <span data-ttu-id="219eb-105">Mediante la implementación de OAuth 2.0 de Azure Active Directory B2C (Azure AD B2C) puede agregar tareas de registro, inicio de sesión y otras tareas de administración de identidades a las aplicaciones móviles y de escritorio.</span><span class="sxs-lookup"><span data-stu-id="219eb-105">By using the Azure Active Directory B2C (Azure AD B2C) implementation of OAuth 2.0, you can add sign-up, sign-in, and other identity management tasks to your mobile and desktop apps.</span></span> <span data-ttu-id="219eb-106">Este artículo es independiente del lenguaje</span><span class="sxs-lookup"><span data-stu-id="219eb-106">This article is language-independent.</span></span> <span data-ttu-id="219eb-107">y en él describimos cómo enviar y recibir mensajes HTTP sin usar ninguna biblioteca de código abierto.</span><span class="sxs-lookup"><span data-stu-id="219eb-107">In the article, we describe how to send and receive HTTP messages without using any open-source libraries.</span></span>

<!-- TODO: Need link to libraries -->

<span data-ttu-id="219eb-108">El flujo de código de autorización de OAuth 2.0 se describe en la [sección 4.1 de la especificación de OAuth 2.0](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="219eb-108">The OAuth 2.0 authorization code flow is described in [section 4.1 of the OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="219eb-109">Puede usarlo para llevar a cabo la autenticación y la autorización en la mayoría de los tipos de aplicación, incluidas las [aplicaciones web](active-directory-b2c-apps.md#web-apps) y las [aplicaciones instaladas de forma nativa](active-directory-b2c-apps.md#mobile-and-native-apps).</span><span class="sxs-lookup"><span data-stu-id="219eb-109">You can use it for authentication and authorization in most app types, including [web apps](active-directory-b2c-apps.md#web-apps) and [natively installed apps](active-directory-b2c-apps.md#mobile-and-native-apps).</span></span> <span data-ttu-id="219eb-110">Puede usar el flujo de código de autorización de OAuth 2.0 para adquirir *tokens de acceso* de forma segura para las aplicaciones, que se pueden usar para obtener acceso a los recursos protegidos por un [servidor de autorización](active-directory-b2c-reference-protocols.md#the-basics).</span><span class="sxs-lookup"><span data-stu-id="219eb-110">You can use the OAuth 2.0 authorization code flow to securely acquire *access tokens* for your apps, which can be used to access resources that are secured by an [authorization server](active-directory-b2c-reference-protocols.md#the-basics).</span></span>

<span data-ttu-id="219eb-111">Este artículo se centra en el flujo de código de autorización de OAuth 2.0 de **clientes públicos**.</span><span class="sxs-lookup"><span data-stu-id="219eb-111">This article focuses on the **public clients** OAuth 2.0 authorization code flow.</span></span> <span data-ttu-id="219eb-112">Un cliente público es cualquier aplicación cliente que no es de confianza para mantener la integridad de una contraseña secreta de forma segura.</span><span class="sxs-lookup"><span data-stu-id="219eb-112">A public client is any client application that cannot be trusted to securely maintain the integrity of a secret password.</span></span> <span data-ttu-id="219eb-113">Esto incluye las aplicaciones móviles, las aplicaciones de escritorio y prácticamente cualquier aplicación que se ejecute en un dispositivo y necesite obtener tokens de acceso.</span><span class="sxs-lookup"><span data-stu-id="219eb-113">This includes mobile apps, desktop apps, and essentially any application that runs on a device and needs to get access tokens.</span></span> 

> [!NOTE]
> <span data-ttu-id="219eb-114">Para agregar la administración de identidades a una aplicación web mediante Azure AD B2C, use [OpenID Connect](active-directory-b2c-reference-oidc.md) en lugar de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="219eb-114">To add identity management to a web app by using Azure AD B2C, use [OpenID Connect](active-directory-b2c-reference-oidc.md) instead of OAuth 2.0.</span></span>

<span data-ttu-id="219eb-115">Azure AD B2C extiende los flujos de OAuth 2.0 estándar para realizar algo más que una autorización y autenticación simples.</span><span class="sxs-lookup"><span data-stu-id="219eb-115">Azure AD B2C extends the standard OAuth 2.0 flows to do more than simple authentication and authorization.</span></span> <span data-ttu-id="219eb-116">Introduce el [parámetro de directiva](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="219eb-116">It introduces the [policy parameter](active-directory-b2c-reference-policies.md).</span></span> <span data-ttu-id="219eb-117">Con las directivas integradas puede usar OAuth 2.0 para agregar experiencias de usuario a la aplicación, como el registro, el inicio de sesión y la administración de perfiles.</span><span class="sxs-lookup"><span data-stu-id="219eb-117">With built-in policies, you can use OAuth 2.0 to add user experiences to your app, such as sign-up, sign-in, and profile management.</span></span> <span data-ttu-id="219eb-118">En este artículo le mostramos cómo usar OAuth 2.0 y las directivas para implementar cada una de estas experiencias en sus aplicaciones nativas.</span><span class="sxs-lookup"><span data-stu-id="219eb-118">In this article, we show you how to use OAuth 2.0 and policies to implement each of these experiences in your native applications.</span></span> <span data-ttu-id="219eb-119">También le mostramos cómo obtener tokens de acceso para obtener acceso a las API web.</span><span class="sxs-lookup"><span data-stu-id="219eb-119">We also show you how to get access tokens for accessing web APIs.</span></span>

<span data-ttu-id="219eb-120">En las solicitudes HTTP de ejemplo de este artículo se usa nuestro directorio de ejemplo de Azure AD B2C, **fabrikamb2c.onmicrosoft.com**. También se usa nuestra aplicación y nuestras directivas de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="219eb-120">In the example HTTP requests in this article, we use our sample Azure AD B2C directory, **fabrikamb2c.onmicrosoft.com**. We also use our sample application and policies.</span></span> <span data-ttu-id="219eb-121">Puede probar las solicitudes por sí mismo con estos valores, o bien puede reemplazarlos por los suyos propios.</span><span class="sxs-lookup"><span data-stu-id="219eb-121">You can try the requests yourself by using these values, or you can replace them with your own values.</span></span>
<span data-ttu-id="219eb-122">Obtenga información sobre cómo [obtener su propio directorio, aplicación y directivas de Azure AD B2C](#use-your-own-azure-ad-b2c-directory).</span><span class="sxs-lookup"><span data-stu-id="219eb-122">Learn how to [get your own Azure AD B2C directory, application, and policies](#use-your-own-azure-ad-b2c-directory).</span></span>

## <a name="1-get-an-authorization-code"></a><span data-ttu-id="219eb-123">1. Obtener un código de autorización</span><span class="sxs-lookup"><span data-stu-id="219eb-123">1. Get an authorization code</span></span>
<span data-ttu-id="219eb-124">El flujo del código de autorización comienza con el cliente dirigiendo al usuario al punto de conexión `/authorize` .</span><span class="sxs-lookup"><span data-stu-id="219eb-124">The authorization code flow begins with the client directing the user to the `/authorize` endpoint.</span></span> <span data-ttu-id="219eb-125">Esta es la parte interactiva del flujo, en la que el usuario lleva a cabo la acción.</span><span class="sxs-lookup"><span data-stu-id="219eb-125">This is the interactive part of the flow, where the user takes action.</span></span> <span data-ttu-id="219eb-126">En esta solicitud, el cliente indica en el parámetro `scope` los permisos que debe obtener por parte del usuario.</span><span class="sxs-lookup"><span data-stu-id="219eb-126">In this request, the client indicates in the `scope` parameter the permissions that it needs to acquire from the user.</span></span> <span data-ttu-id="219eb-127">En el parámetro `p` indica la directiva que se debe ejecutar.</span><span class="sxs-lookup"><span data-stu-id="219eb-127">In the `p` parameter, it indicates the policy to execute.</span></span> <span data-ttu-id="219eb-128">Los siguientes tres ejemplos (con saltos de línea para facilitar la lectura) usan directivas diferentes.</span><span class="sxs-lookup"><span data-stu-id="219eb-128">The following three examples (with line breaks for readability) each use a different policy.</span></span>

### <a name="use-a-sign-in-policy"></a><span data-ttu-id="219eb-129">Uso de una directiva de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="219eb-129">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code
&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob
&response_mode=query
&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&p=b2c_1_sign_in
```

### <a name="use-a-sign-up-policy"></a><span data-ttu-id="219eb-130">Uso de una directiva de registro</span><span class="sxs-lookup"><span data-stu-id="219eb-130">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code
&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob
&response_mode=query
&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&p=b2c_1_sign_up
```

### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="219eb-131">Uso de una directiva de edición de perfil</span><span class="sxs-lookup"><span data-stu-id="219eb-131">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code
&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob
&response_mode=query
&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&p=b2c_1_edit_profile
```

| <span data-ttu-id="219eb-132">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-132">Parameter</span></span> | <span data-ttu-id="219eb-133">¿Necesario?</span><span class="sxs-lookup"><span data-stu-id="219eb-133">Required?</span></span> | <span data-ttu-id="219eb-134">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-134">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="219eb-135">client_id</span><span class="sxs-lookup"><span data-stu-id="219eb-135">client_id</span></span> |<span data-ttu-id="219eb-136">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-136">Required</span></span> |<span data-ttu-id="219eb-137">Identificador de aplicación asignado a la aplicación en [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="219eb-137">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="219eb-138">response_type</span><span class="sxs-lookup"><span data-stu-id="219eb-138">response_type</span></span> |<span data-ttu-id="219eb-139">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-139">Required</span></span> |<span data-ttu-id="219eb-140">El tipo de respuesta, que debe incluir `code` para el flujo de código de autorización.</span><span class="sxs-lookup"><span data-stu-id="219eb-140">The response type, which must include `code` for the authorization code flow.</span></span> |
| <span data-ttu-id="219eb-141">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="219eb-141">redirect_uri</span></span> |<span data-ttu-id="219eb-142">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-142">Required</span></span> |<span data-ttu-id="219eb-143">El URI de redirección de la aplicación, donde su aplicación envía y recibe las respuestas de autenticación.</span><span class="sxs-lookup"><span data-stu-id="219eb-143">The redirect URI of your app, where authentication responses are sent and received by your app.</span></span> <span data-ttu-id="219eb-144">Debe coincidir exactamente con uno de los URI de redirección que registró en el portal, con la excepción de que debe estar codificado como URL.</span><span class="sxs-lookup"><span data-stu-id="219eb-144">It must exactly match one of the redirect URIs that you registered in the portal, except that it must be URL-encoded.</span></span> |
| <span data-ttu-id="219eb-145">ámbito</span><span class="sxs-lookup"><span data-stu-id="219eb-145">scope</span></span> |<span data-ttu-id="219eb-146">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-146">Required</span></span> |<span data-ttu-id="219eb-147">Una lista de ámbitos separada por espacios.</span><span class="sxs-lookup"><span data-stu-id="219eb-147">A space-separated list of scopes.</span></span> <span data-ttu-id="219eb-148">Un valor de ámbito único indica a Azure Active Directory (Azure AD) los dos permisos que se solicitan.</span><span class="sxs-lookup"><span data-stu-id="219eb-148">A single scope value indicates to Azure Active Directory (Azure AD) both of the permissions that are being requested.</span></span> <span data-ttu-id="219eb-149">El uso del identificador de cliente como ámbito indica que la aplicación necesita un token de acceso que se puede usar con su propio servicio o API web, representado por el mismo identificador de cliente.</span><span class="sxs-lookup"><span data-stu-id="219eb-149">Using the client ID as the scope indicates that your app needs an access token that can be used against your own service or web API, represented by the same client ID.</span></span>  <span data-ttu-id="219eb-150">El ámbito `offline_access` indica que la aplicación necesita un token de actualización para un acceso de larga duración a los recursos.</span><span class="sxs-lookup"><span data-stu-id="219eb-150">The `offline_access` scope indicates that your app needs a refresh token for long-lived access to resources.</span></span> <span data-ttu-id="219eb-151">También puede usar el ámbito `openid` para solicitar un token de identificador desde Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="219eb-151">You also can use the `openid` scope to request an ID token from Azure AD B2C.</span></span> |
| <span data-ttu-id="219eb-152">response_mode</span><span class="sxs-lookup"><span data-stu-id="219eb-152">response_mode</span></span> |<span data-ttu-id="219eb-153">Recomendado</span><span class="sxs-lookup"><span data-stu-id="219eb-153">Recommended</span></span> |<span data-ttu-id="219eb-154">El método que se usa para devolver el código de autorización resultante a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="219eb-154">The method that you use to send the resulting authorization code back to your app.</span></span> <span data-ttu-id="219eb-155">Puede ser `query`, `form_post` o `fragment`.</span><span class="sxs-lookup"><span data-stu-id="219eb-155">It can be `query`, `form_post`, or `fragment`.</span></span> |
| <span data-ttu-id="219eb-156">state</span><span class="sxs-lookup"><span data-stu-id="219eb-156">state</span></span> |<span data-ttu-id="219eb-157">Recomendado</span><span class="sxs-lookup"><span data-stu-id="219eb-157">Recommended</span></span> |<span data-ttu-id="219eb-158">Un valor incluido en la solicitud que se devolverá en la respuesta del token.</span><span class="sxs-lookup"><span data-stu-id="219eb-158">A value included in the request that is returned in the token response.</span></span> <span data-ttu-id="219eb-159">Puede ser una cadena de cualquier contenido que quiera usar.</span><span class="sxs-lookup"><span data-stu-id="219eb-159">It can be a string of any content that you want to use.</span></span> <span data-ttu-id="219eb-160">Se suele usar un valor único generado de forma aleatoria para evitar los ataques de falsificación de solicitudes entre sitios.</span><span class="sxs-lookup"><span data-stu-id="219eb-160">Usually, a randomly generated unique value is  used, to prevent cross-site request forgery attacks.</span></span> <span data-ttu-id="219eb-161">El estado también se usa para codificar información sobre el estado del usuario en la aplicación antes de que se haya producido la solicitud de autenticación.</span><span class="sxs-lookup"><span data-stu-id="219eb-161">The state also is used to encode information about the user's state in the app before the authentication request occurred.</span></span> <span data-ttu-id="219eb-162">Por ejemplo, la página en la que se encontraba el usuario o la directiva que se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="219eb-162">For example, the page the user was on, or the policy that was being executed.</span></span> |
| <span data-ttu-id="219eb-163">p</span><span class="sxs-lookup"><span data-stu-id="219eb-163">p</span></span> |<span data-ttu-id="219eb-164">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-164">Required</span></span> |<span data-ttu-id="219eb-165">La directiva que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="219eb-165">The policy that is executed.</span></span> <span data-ttu-id="219eb-166">Es el nombre de una directiva que se crea en el directorio de Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="219eb-166">It's the name of a policy that is created in your Azure AD B2C directory.</span></span> <span data-ttu-id="219eb-167">El valor del nombre de directiva debe comenzar por **b2c\_1\_**.</span><span class="sxs-lookup"><span data-stu-id="219eb-167">The policy name value should begin with **b2c\_1\_**.</span></span> <span data-ttu-id="219eb-168">Para obtener más información sobre las directivas, consulte [Azure Active Directory B2C: marco de directivas extensible](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="219eb-168">To learn more about policies, see [Azure AD B2C built-in policies](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="219eb-169">símbolo del sistema</span><span class="sxs-lookup"><span data-stu-id="219eb-169">prompt</span></span> |<span data-ttu-id="219eb-170">Opcional</span><span class="sxs-lookup"><span data-stu-id="219eb-170">Optional</span></span> |<span data-ttu-id="219eb-171">El tipo de interacción necesaria con el usuario.</span><span class="sxs-lookup"><span data-stu-id="219eb-171">The type of user interaction that is required.</span></span> <span data-ttu-id="219eb-172">Actualmente, el único valor válido es `login`, que obliga al usuario a escribir sus credenciales en esa solicitud.</span><span class="sxs-lookup"><span data-stu-id="219eb-172">Currently, the only valid value is `login`, which forces the user to enter their credentials on that request.</span></span> <span data-ttu-id="219eb-173">El inicio de sesión único no surtirá efecto.</span><span class="sxs-lookup"><span data-stu-id="219eb-173">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="219eb-174">En este punto se pedirá al usuario que complete el flujo de trabajo de la directiva.</span><span class="sxs-lookup"><span data-stu-id="219eb-174">At this point, the user is asked to complete the policy's workflow.</span></span> <span data-ttu-id="219eb-175">Esto puede implicar que el usuario tenga que escribir su nombre de usuario y contraseña, iniciar sesión con una identidad social, registrarse en el directorio o realizar otros pasos.</span><span class="sxs-lookup"><span data-stu-id="219eb-175">This might involve the user entering their username and password, signing in with a social identity, signing up for the directory, or any other number of steps.</span></span> <span data-ttu-id="219eb-176">Las acciones del usuario dependerán de cómo se defina la directiva.</span><span class="sxs-lookup"><span data-stu-id="219eb-176">User actions depend on how the policy is defined.</span></span>

<span data-ttu-id="219eb-177">Cuando el usuario haya completado la directiva, Azure AD devolverá una respuesta a la aplicación en el valor que ha usado para `redirect_uri`.</span><span class="sxs-lookup"><span data-stu-id="219eb-177">After the user completes the policy, Azure AD returns a response to your app at the value you used for `redirect_uri`.</span></span> <span data-ttu-id="219eb-178">Usa el método especificado en el parámetro `response_mode`.</span><span class="sxs-lookup"><span data-stu-id="219eb-178">It uses the method specified in the `response_mode` parameter.</span></span> <span data-ttu-id="219eb-179">La respuesta es exactamente la misma para cada uno de los escenarios de acción del usuario, independientemente de la directiva que se haya ejecutado.</span><span class="sxs-lookup"><span data-stu-id="219eb-179">The response is exactly the same for each of the user action scenarios, independent of the policy that was executed.</span></span>

<span data-ttu-id="219eb-180">Una respuesta correcta que usa `response_mode=query` tiene este aspecto:</span><span class="sxs-lookup"><span data-stu-id="219eb-180">A successful response that uses `response_mode=query` looks like this:</span></span>

```
GET urn:ietf:wg:oauth:2.0:oob?
code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...        // the authorization_code, truncated
&state=arbitrary_data_you_can_receive_in_the_response                // the value provided in the request
```

| <span data-ttu-id="219eb-181">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-181">Parameter</span></span> | <span data-ttu-id="219eb-182">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-182">Description</span></span> |
| --- | --- |
| <span data-ttu-id="219eb-183">código</span><span class="sxs-lookup"><span data-stu-id="219eb-183">code</span></span> |<span data-ttu-id="219eb-184">El código de autorización que la aplicación solicitó.</span><span class="sxs-lookup"><span data-stu-id="219eb-184">The authorization code that the app requested.</span></span> <span data-ttu-id="219eb-185">La aplicación puede usar el código de autorización para solicitar un token de acceso para un recurso de destino.</span><span class="sxs-lookup"><span data-stu-id="219eb-185">The app can use the authorization code to request an access token for a target resource.</span></span> <span data-ttu-id="219eb-186">Los códigos de autorización tienen una duración muy breve.</span><span class="sxs-lookup"><span data-stu-id="219eb-186">Authorization codes are very short-lived.</span></span> <span data-ttu-id="219eb-187">Normalmente, caducan al cabo de unos 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="219eb-187">Typically, they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="219eb-188">state</span><span class="sxs-lookup"><span data-stu-id="219eb-188">state</span></span> |<span data-ttu-id="219eb-189">Vea la descripción completa en la tabla de la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="219eb-189">See the full description in the table in the preceding section.</span></span> <span data-ttu-id="219eb-190">Si un parámetro `state` está incluido en la solicitud, debería aparecer el mismo valor en la respuesta.</span><span class="sxs-lookup"><span data-stu-id="219eb-190">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="219eb-191">La aplicación debe comprobar que los valores `state` de la solicitud y de la respuesta sean idénticos.</span><span class="sxs-lookup"><span data-stu-id="219eb-191">The app should verify that the `state` values in the request and response are identical.</span></span> |

<span data-ttu-id="219eb-192">Las respuestas de error también se pueden enviar al URI de redirección para que la aplicación pueda controlarlas correctamente:</span><span class="sxs-lookup"><span data-stu-id="219eb-192">Error responses also can be sent to the redirect URI so that the app can handle them appropriately:</span></span>

```
GET urn:ietf:wg:oauth:2.0:oob?
error=access_denied
&error_description=The+user+has+cancelled+entering+self-asserted+information
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="219eb-193">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-193">Parameter</span></span> | <span data-ttu-id="219eb-194">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-194">Description</span></span> |
| --- | --- |
| <span data-ttu-id="219eb-195">error</span><span class="sxs-lookup"><span data-stu-id="219eb-195">error</span></span> |<span data-ttu-id="219eb-196">Una cadena de código de error que se puede usar para clasificar los tipos de errores que se producen.</span><span class="sxs-lookup"><span data-stu-id="219eb-196">An error code string that you can use to classify the types of errors that occur.</span></span> <span data-ttu-id="219eb-197">También puede usar la cadena para reaccionar frente a errores.</span><span class="sxs-lookup"><span data-stu-id="219eb-197">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="219eb-198">error_description</span><span class="sxs-lookup"><span data-stu-id="219eb-198">error_description</span></span> |<span data-ttu-id="219eb-199">Un mensaje de error específico que puede ayudarlo a identificar la causa raíz de un error de autenticación.</span><span class="sxs-lookup"><span data-stu-id="219eb-199">A specific error message that can help you identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="219eb-200">state</span><span class="sxs-lookup"><span data-stu-id="219eb-200">state</span></span> |<span data-ttu-id="219eb-201">Vea la descripción completa en la tabla anterior.</span><span class="sxs-lookup"><span data-stu-id="219eb-201">See the full description in the preceding table.</span></span> <span data-ttu-id="219eb-202">Si un parámetro `state` está incluido en la solicitud, debería aparecer el mismo valor en la respuesta.</span><span class="sxs-lookup"><span data-stu-id="219eb-202">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="219eb-203">La aplicación debe comprobar que los valores `state` de la solicitud y de la respuesta sean idénticos.</span><span class="sxs-lookup"><span data-stu-id="219eb-203">The app should verify that the `state` values in the request and response are identical.</span></span> |

## <a name="2-get-a-token"></a><span data-ttu-id="219eb-204">2. Obtención de un token</span><span class="sxs-lookup"><span data-stu-id="219eb-204">2. Get a token</span></span>
<span data-ttu-id="219eb-205">Ahora que ha adquirido un código de autorización, puede canjear el elemento `code` por un token al recurso deseado mediante el envío de una solicitud POST al punto de conexión `/token`.</span><span class="sxs-lookup"><span data-stu-id="219eb-205">Now that you've acquired an authorization code, you can redeem the `code` for a token to the intended resource by sending a POST request to the `/token` endpoint.</span></span> <span data-ttu-id="219eb-206">En Azure AD B2C, el único recurso para el que puede solicitar un token es la API web de back-end de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="219eb-206">In Azure AD B2C, the only resource that you can request a token for is your app's own back-end web API.</span></span> <span data-ttu-id="219eb-207">La convención usada para solicitar un token para sí mismo consiste en usar el identificador de cliente de la aplicación como ámbito:</span><span class="sxs-lookup"><span data-stu-id="219eb-207">The convention that's used for requesting a token to yourself is to use your app's client ID as the scope:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob

```

| <span data-ttu-id="219eb-208">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-208">Parameter</span></span> | <span data-ttu-id="219eb-209">¿Necesario?</span><span class="sxs-lookup"><span data-stu-id="219eb-209">Required?</span></span> | <span data-ttu-id="219eb-210">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-210">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="219eb-211">p</span><span class="sxs-lookup"><span data-stu-id="219eb-211">p</span></span> |<span data-ttu-id="219eb-212">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-212">Required</span></span> |<span data-ttu-id="219eb-213">La directiva usada para adquirir el código de autorización.</span><span class="sxs-lookup"><span data-stu-id="219eb-213">The policy that was used to acquire the authorization code.</span></span> <span data-ttu-id="219eb-214">No puede usar una directiva diferente en esta solicitud.</span><span class="sxs-lookup"><span data-stu-id="219eb-214">You cannot use a different policy in this request.</span></span> <span data-ttu-id="219eb-215">Tenga en cuenta que este parámetro se agrega a la *cadena de consulta*, no al cuerpo de POST.</span><span class="sxs-lookup"><span data-stu-id="219eb-215">Note that you add this parameter to the *query string*, not in the POST body.</span></span> |
| <span data-ttu-id="219eb-216">client_id</span><span class="sxs-lookup"><span data-stu-id="219eb-216">client_id</span></span> |<span data-ttu-id="219eb-217">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-217">Required</span></span> |<span data-ttu-id="219eb-218">Identificador de aplicación asignado a la aplicación en [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="219eb-218">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="219eb-219">grant_type</span><span class="sxs-lookup"><span data-stu-id="219eb-219">grant_type</span></span> |<span data-ttu-id="219eb-220">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-220">Required</span></span> |<span data-ttu-id="219eb-221">Tipo de concesión.</span><span class="sxs-lookup"><span data-stu-id="219eb-221">The type of grant.</span></span> <span data-ttu-id="219eb-222">Para el flujo de código de autorización, el tipo de concesión debe ser `authorization_code`.</span><span class="sxs-lookup"><span data-stu-id="219eb-222">For the authorization code flow, the grant type must be `authorization_code`.</span></span> |
| <span data-ttu-id="219eb-223">ámbito</span><span class="sxs-lookup"><span data-stu-id="219eb-223">scope</span></span> |<span data-ttu-id="219eb-224">Recomendado</span><span class="sxs-lookup"><span data-stu-id="219eb-224">Recommended</span></span> |<span data-ttu-id="219eb-225">Una lista de ámbitos separada por espacios.</span><span class="sxs-lookup"><span data-stu-id="219eb-225">A space-separated list of scopes.</span></span> <span data-ttu-id="219eb-226">Un valor de ámbito único indica a Azure AD los dos permisos que se solicitan.</span><span class="sxs-lookup"><span data-stu-id="219eb-226">A single scope value indicates to Azure AD both of the permissions that are being requested.</span></span> <span data-ttu-id="219eb-227">El uso del identificador de cliente como ámbito indica que la aplicación necesita un token de acceso que se puede usar con su propio servicio o API web, representado por el mismo identificador de cliente.</span><span class="sxs-lookup"><span data-stu-id="219eb-227">Using the client ID as the scope indicates that your app needs an access token that can be used against your own service or web API, represented by the same client ID.</span></span>  <span data-ttu-id="219eb-228">El ámbito `offline_access` indica que la aplicación necesita un token de actualización para un acceso de larga duración a los recursos.</span><span class="sxs-lookup"><span data-stu-id="219eb-228">The `offline_access` scope indicates that your app needs a refresh token for long-lived access to resources.</span></span>  <span data-ttu-id="219eb-229">También puede usar el ámbito `openid` para solicitar un token de identificador desde Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="219eb-229">You also can use the `openid` scope to request an ID token from Azure AD B2C.</span></span> |
| <span data-ttu-id="219eb-230">código</span><span class="sxs-lookup"><span data-stu-id="219eb-230">code</span></span> |<span data-ttu-id="219eb-231">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-231">Required</span></span> |<span data-ttu-id="219eb-232">El código de autorización que adquirió en el primer segmento del flujo.</span><span class="sxs-lookup"><span data-stu-id="219eb-232">The authorization code that you acquired in the first leg of the flow.</span></span> |
| <span data-ttu-id="219eb-233">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="219eb-233">redirect_uri</span></span> |<span data-ttu-id="219eb-234">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-234">Required</span></span> |<span data-ttu-id="219eb-235">El URI de redirección de la aplicación en la que recibió el código de autorización.</span><span class="sxs-lookup"><span data-stu-id="219eb-235">The redirect URI of the application where you received the authorization code.</span></span> |

<span data-ttu-id="219eb-236">Una respuesta correcta del token tiene el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="219eb-236">A successful token response looks like this:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="219eb-237">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-237">Parameter</span></span> | <span data-ttu-id="219eb-238">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-238">Description</span></span> |
| --- | --- |
| <span data-ttu-id="219eb-239">not_before</span><span class="sxs-lookup"><span data-stu-id="219eb-239">not_before</span></span> |<span data-ttu-id="219eb-240">Hora a la que el token se considera válido, en tiempo de época.</span><span class="sxs-lookup"><span data-stu-id="219eb-240">The time at which the token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="219eb-241">token_type</span><span class="sxs-lookup"><span data-stu-id="219eb-241">token_type</span></span> |<span data-ttu-id="219eb-242">El valor del tipo de token.</span><span class="sxs-lookup"><span data-stu-id="219eb-242">The token type value.</span></span> <span data-ttu-id="219eb-243">El único tipo que admite Azure AD es portador.</span><span class="sxs-lookup"><span data-stu-id="219eb-243">The only type that Azure AD supports is Bearer.</span></span> |
| <span data-ttu-id="219eb-244">access_token</span><span class="sxs-lookup"><span data-stu-id="219eb-244">access_token</span></span> |<span data-ttu-id="219eb-245">El JSON Web Token (JWT) firmado que ha solicitado.</span><span class="sxs-lookup"><span data-stu-id="219eb-245">The signed JSON Web Token (JWT) that you requested.</span></span> |
| <span data-ttu-id="219eb-246">ámbito</span><span class="sxs-lookup"><span data-stu-id="219eb-246">scope</span></span> |<span data-ttu-id="219eb-247">Los ámbitos para los que el token es válido.</span><span class="sxs-lookup"><span data-stu-id="219eb-247">The scopes that the token is valid for.</span></span> <span data-ttu-id="219eb-248">También puede usar ámbitos para almacenar en caché los tokens para su posterior uso.</span><span class="sxs-lookup"><span data-stu-id="219eb-248">You also can use scopes to cache tokens for later use.</span></span> |
| <span data-ttu-id="219eb-249">expires_in</span><span class="sxs-lookup"><span data-stu-id="219eb-249">expires_in</span></span> |<span data-ttu-id="219eb-250">El período de tiempo que el token es válido (en segundos).</span><span class="sxs-lookup"><span data-stu-id="219eb-250">The length of time that the token is valid (in seconds).</span></span> |
| <span data-ttu-id="219eb-251">refresh_token</span><span class="sxs-lookup"><span data-stu-id="219eb-251">refresh_token</span></span> |<span data-ttu-id="219eb-252">Un token de actualización de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="219eb-252">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="219eb-253">La aplicación puede usar este token para adquirir tokens adicionales una vez que expire el token actual.</span><span class="sxs-lookup"><span data-stu-id="219eb-253">The app can use this token to acquire additional tokens after the current token expires.</span></span> <span data-ttu-id="219eb-254">Los tokens de actualización tienen una duración larga.</span><span class="sxs-lookup"><span data-stu-id="219eb-254">Refresh tokens are long-lived.</span></span> <span data-ttu-id="219eb-255">Puede usarlos para conservar el acceso a los recursos durante largos períodos de tiempo.</span><span class="sxs-lookup"><span data-stu-id="219eb-255">You can use them to retain access to resources for extended periods of time.</span></span> <span data-ttu-id="219eb-256">Para obtener más información, consulte [Azure AD B2C: referencia de tokens](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="219eb-256">For more information, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="219eb-257">Las respuestas de error tienen un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="219eb-257">Error responses look like this:</span></span>

```
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| <span data-ttu-id="219eb-258">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-258">Parameter</span></span> | <span data-ttu-id="219eb-259">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-259">Description</span></span> |
| --- | --- |
| <span data-ttu-id="219eb-260">error</span><span class="sxs-lookup"><span data-stu-id="219eb-260">error</span></span> |<span data-ttu-id="219eb-261">Una cadena de código de error que se puede usar para clasificar los tipos de errores que se producen.</span><span class="sxs-lookup"><span data-stu-id="219eb-261">An error code string that you can use to classify the types of errors that occur.</span></span> <span data-ttu-id="219eb-262">También puede usar la cadena para reaccionar frente a errores.</span><span class="sxs-lookup"><span data-stu-id="219eb-262">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="219eb-263">error_description</span><span class="sxs-lookup"><span data-stu-id="219eb-263">error_description</span></span> |<span data-ttu-id="219eb-264">Un mensaje de error específico que puede ayudarlo a identificar la causa raíz de un error de autenticación.</span><span class="sxs-lookup"><span data-stu-id="219eb-264">A specific error message that can help you identify the root cause of an authentication error.</span></span> |

## <a name="3-use-the-token"></a><span data-ttu-id="219eb-265">3. Uso del token</span><span class="sxs-lookup"><span data-stu-id="219eb-265">3. Use the token</span></span>
<span data-ttu-id="219eb-266">Ahora que ha adquirido correctamente un token de acceso, puede usar el token en las solicitudes a las API web de back-end incluyéndolo en el encabezado `Authorization`:</span><span class="sxs-lookup"><span data-stu-id="219eb-266">Now that you've successfully acquired an access token, you can use the token in requests to your back-end web APIs by including it in the `Authorization` header:</span></span>

```
GET /tasks
Host: https://mytaskwebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
```

## <a name="4-refresh-the-token"></a><span data-ttu-id="219eb-267">4. Actualización del token</span><span class="sxs-lookup"><span data-stu-id="219eb-267">4. Refresh the token</span></span>
<span data-ttu-id="219eb-268">Los tokens de acceso y los tokens de identificación tienen una corta duración.</span><span class="sxs-lookup"><span data-stu-id="219eb-268">Access tokens and ID tokens are short-lived.</span></span> <span data-ttu-id="219eb-269">Una vez expirados, debe actualizarlos para poder seguir obteniendo acceso a los recursos.</span><span class="sxs-lookup"><span data-stu-id="219eb-269">After they expire, you must refresh them to continue to access resources.</span></span> <span data-ttu-id="219eb-270">Para ello, envíe otra solicitud POST al punto de conexión `/token`.</span><span class="sxs-lookup"><span data-stu-id="219eb-270">To do this, submit another POST request to the `/token` endpoint.</span></span> <span data-ttu-id="219eb-271">Esta vez, proporcione el elemento `refresh_token`, en lugar de `code`:</span><span class="sxs-lookup"><span data-stu-id="219eb-271">This time, provide the `refresh_token` instead of the `code`:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&refresh_token=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob
```

| <span data-ttu-id="219eb-272">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-272">Parameter</span></span> | <span data-ttu-id="219eb-273">¿Necesario?</span><span class="sxs-lookup"><span data-stu-id="219eb-273">Required?</span></span> | <span data-ttu-id="219eb-274">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-274">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="219eb-275">p</span><span class="sxs-lookup"><span data-stu-id="219eb-275">p</span></span> |<span data-ttu-id="219eb-276">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-276">Required</span></span> |<span data-ttu-id="219eb-277">La directiva usada para adquirir el token de actualización original.</span><span class="sxs-lookup"><span data-stu-id="219eb-277">The policy that was used to acquire the original refresh token.</span></span> <span data-ttu-id="219eb-278">No puede usar una directiva diferente en esta solicitud.</span><span class="sxs-lookup"><span data-stu-id="219eb-278">You cannot use a different policy in this request.</span></span> <span data-ttu-id="219eb-279">Tenga en cuenta que este parámetro se agrega a la *cadena de consulta*, no al cuerpo de POST.</span><span class="sxs-lookup"><span data-stu-id="219eb-279">Note that you add this parameter to the *query string*, not in the POST body.</span></span> |
| <span data-ttu-id="219eb-280">client_id</span><span class="sxs-lookup"><span data-stu-id="219eb-280">client_id</span></span> |<span data-ttu-id="219eb-281">Recomendado</span><span class="sxs-lookup"><span data-stu-id="219eb-281">Recommended</span></span> |<span data-ttu-id="219eb-282">Identificador de aplicación asignado a la aplicación en [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="219eb-282">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="219eb-283">grant_type</span><span class="sxs-lookup"><span data-stu-id="219eb-283">grant_type</span></span> |<span data-ttu-id="219eb-284">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-284">Required</span></span> |<span data-ttu-id="219eb-285">Tipo de concesión.</span><span class="sxs-lookup"><span data-stu-id="219eb-285">The type of grant.</span></span> <span data-ttu-id="219eb-286">Para este segmento del flujo de código de autorización, el tipo de concesión debe ser `refresh_token`.</span><span class="sxs-lookup"><span data-stu-id="219eb-286">For this leg of the authorization code flow, the grant type must be `refresh_token`.</span></span> |
| <span data-ttu-id="219eb-287">ámbito</span><span class="sxs-lookup"><span data-stu-id="219eb-287">scope</span></span> |<span data-ttu-id="219eb-288">Recomendado</span><span class="sxs-lookup"><span data-stu-id="219eb-288">Recommended</span></span> |<span data-ttu-id="219eb-289">Una lista de ámbitos separada por espacios.</span><span class="sxs-lookup"><span data-stu-id="219eb-289">A space-separated list of scopes.</span></span> <span data-ttu-id="219eb-290">Un valor de ámbito único indica a Azure AD los dos permisos que se solicitan.</span><span class="sxs-lookup"><span data-stu-id="219eb-290">A single scope value indicates to Azure AD both of the permissions that are being requested.</span></span> <span data-ttu-id="219eb-291">El uso del identificador de cliente como ámbito indica que la aplicación necesita un token de acceso que se puede usar con su propio servicio o API web, representado por el mismo identificador de cliente.</span><span class="sxs-lookup"><span data-stu-id="219eb-291">Using the client ID as the scope indicates that your app needs an access token that can be used against your own service or web API, represented by the same client ID.</span></span>  <span data-ttu-id="219eb-292">El ámbito `offline_access` indica que la aplicación necesitará un token de actualización para un acceso de larga duración a los recursos.</span><span class="sxs-lookup"><span data-stu-id="219eb-292">The `offline_access` scope indicates that your app will need a refresh token for long-lived access to resources.</span></span>  <span data-ttu-id="219eb-293">También puede usar el ámbito `openid` para solicitar un token de identificador desde Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="219eb-293">You also can use the `openid` scope to request an ID token from Azure AD B2C.</span></span> |
| <span data-ttu-id="219eb-294">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="219eb-294">redirect_uri</span></span> |<span data-ttu-id="219eb-295">Opcional</span><span class="sxs-lookup"><span data-stu-id="219eb-295">Optional</span></span> |<span data-ttu-id="219eb-296">El URI de redirección de la aplicación en la que recibió el código de autorización.</span><span class="sxs-lookup"><span data-stu-id="219eb-296">The redirect URI of the application where you received the authorization code.</span></span> |
| <span data-ttu-id="219eb-297">refresh_token</span><span class="sxs-lookup"><span data-stu-id="219eb-297">refresh_token</span></span> |<span data-ttu-id="219eb-298">Obligatorio</span><span class="sxs-lookup"><span data-stu-id="219eb-298">Required</span></span> |<span data-ttu-id="219eb-299">El token de actualización original que adquirió en el segundo segmento del flujo.</span><span class="sxs-lookup"><span data-stu-id="219eb-299">The original refresh token that you acquired in the second leg of the flow.</span></span> |

<span data-ttu-id="219eb-300">Una respuesta correcta del token tiene el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="219eb-300">A successful token response looks like this:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="219eb-301">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-301">Parameter</span></span> | <span data-ttu-id="219eb-302">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-302">Description</span></span> |
| --- | --- |
| <span data-ttu-id="219eb-303">not_before</span><span class="sxs-lookup"><span data-stu-id="219eb-303">not_before</span></span> |<span data-ttu-id="219eb-304">Hora a la que el token se considera válido, en tiempo de época.</span><span class="sxs-lookup"><span data-stu-id="219eb-304">The time at which the token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="219eb-305">token_type</span><span class="sxs-lookup"><span data-stu-id="219eb-305">token_type</span></span> |<span data-ttu-id="219eb-306">El valor del tipo de token.</span><span class="sxs-lookup"><span data-stu-id="219eb-306">The token type value.</span></span> <span data-ttu-id="219eb-307">El único tipo que admite Azure AD es portador.</span><span class="sxs-lookup"><span data-stu-id="219eb-307">The only type that Azure AD supports is Bearer.</span></span> |
| <span data-ttu-id="219eb-308">access_token</span><span class="sxs-lookup"><span data-stu-id="219eb-308">access_token</span></span> |<span data-ttu-id="219eb-309">El JWT firmado que ha solicitado.</span><span class="sxs-lookup"><span data-stu-id="219eb-309">The signed JWT that you requested.</span></span> |
| <span data-ttu-id="219eb-310">ámbito</span><span class="sxs-lookup"><span data-stu-id="219eb-310">scope</span></span> |<span data-ttu-id="219eb-311">Los ámbitos para los que el token es válido.</span><span class="sxs-lookup"><span data-stu-id="219eb-311">The scopes that the token is valid for.</span></span> <span data-ttu-id="219eb-312">También puede usar los ámbitos para almacenar en caché los tokens para su posterior uso.</span><span class="sxs-lookup"><span data-stu-id="219eb-312">You also can use the scopes to cache tokens for later use.</span></span> |
| <span data-ttu-id="219eb-313">expires_in</span><span class="sxs-lookup"><span data-stu-id="219eb-313">expires_in</span></span> |<span data-ttu-id="219eb-314">El período de tiempo que el token es válido (en segundos).</span><span class="sxs-lookup"><span data-stu-id="219eb-314">The length of time that the token is valid (in seconds).</span></span> |
| <span data-ttu-id="219eb-315">refresh_token</span><span class="sxs-lookup"><span data-stu-id="219eb-315">refresh_token</span></span> |<span data-ttu-id="219eb-316">Un token de actualización de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="219eb-316">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="219eb-317">La aplicación puede usar este token para adquirir tokens adicionales una vez que expire el token actual.</span><span class="sxs-lookup"><span data-stu-id="219eb-317">The app can use this token to acquire additional tokens after the current token expires.</span></span> <span data-ttu-id="219eb-318">Los tokens de actualización son de larga duración y pueden usarse para conservar el acceso a los recursos durante largos periodos.</span><span class="sxs-lookup"><span data-stu-id="219eb-318">Refresh tokens are long-lived, and can be used to retain access to resources for extended periods of time.</span></span> <span data-ttu-id="219eb-319">Para obtener más información, consulte [Azure AD B2C: referencia de tokens](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="219eb-319">For more information, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="219eb-320">Las respuestas de error tienen un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="219eb-320">Error responses look like this:</span></span>

```
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| <span data-ttu-id="219eb-321">Parámetro</span><span class="sxs-lookup"><span data-stu-id="219eb-321">Parameter</span></span> | <span data-ttu-id="219eb-322">Description</span><span class="sxs-lookup"><span data-stu-id="219eb-322">Description</span></span> |
| --- | --- |
| <span data-ttu-id="219eb-323">error</span><span class="sxs-lookup"><span data-stu-id="219eb-323">error</span></span> |<span data-ttu-id="219eb-324">Una cadena de código de error que se puede usar para clasificar los tipos de errores que se producen.</span><span class="sxs-lookup"><span data-stu-id="219eb-324">An error code string that you can use to classify types of errors that occur.</span></span> <span data-ttu-id="219eb-325">También puede usar la cadena para reaccionar frente a errores.</span><span class="sxs-lookup"><span data-stu-id="219eb-325">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="219eb-326">error_description</span><span class="sxs-lookup"><span data-stu-id="219eb-326">error_description</span></span> |<span data-ttu-id="219eb-327">Un mensaje de error específico que puede ayudarlo a identificar la causa raíz de un error de autenticación.</span><span class="sxs-lookup"><span data-stu-id="219eb-327">A specific error message that can help you identify the root cause of an authentication error.</span></span> |

## <a name="use-your-own-azure-ad-b2c-directory"></a><span data-ttu-id="219eb-328">Usar su propio directorio de Azure AD B2C</span><span class="sxs-lookup"><span data-stu-id="219eb-328">Use your own Azure AD B2C directory</span></span>
<span data-ttu-id="219eb-329">Para probar estas solicitudes, lleve a cabo los siguientes pasos.</span><span class="sxs-lookup"><span data-stu-id="219eb-329">To try these requests yourself, complete the following steps.</span></span> <span data-ttu-id="219eb-330">Reemplace los valores de ejemplo que hemos usado en este artículo por los suyos propios.</span><span class="sxs-lookup"><span data-stu-id="219eb-330">Replace the example values we used in this article with your own values.</span></span>

1. <span data-ttu-id="219eb-331">[Cree un directorio de Azure AD B2C](active-directory-b2c-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="219eb-331">[Create an Azure AD B2C directory](active-directory-b2c-get-started.md).</span></span> <span data-ttu-id="219eb-332">Use el nombre del directorio en las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="219eb-332">Use the name of your directory in the requests.</span></span>
2. <span data-ttu-id="219eb-333">[Cree una aplicación](active-directory-b2c-app-registration.md) para obtener un identificador de aplicación y un URI de redirección.</span><span class="sxs-lookup"><span data-stu-id="219eb-333">[Create an application](active-directory-b2c-app-registration.md) to obtain an application ID and a redirect URI.</span></span> <span data-ttu-id="219eb-334">Incluya un cliente nativo en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="219eb-334">Include a native client in your app.</span></span>
3. <span data-ttu-id="219eb-335">[Crear directivas](active-directory-b2c-reference-policies.md) para obtener los nombres de las directivas.</span><span class="sxs-lookup"><span data-stu-id="219eb-335">[Create your policies](active-directory-b2c-reference-policies.md) to obtain your policy names.</span></span>

