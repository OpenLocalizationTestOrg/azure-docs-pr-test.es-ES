---
title: "Correlación de Telemetría de Application Insights | Microsoft Docs"
description: "Correlación de Telemetría de Application Insights"
services: application-insights
documentationcenter: .net
author: SergeyKanzhelev
manager: carmonm
ms.service: application-insights
ms.workload: TBD
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 04/25/2017
ms.author: bwren
ms.openlocfilehash: 747c00842f4df9c7fbd816c99771ba8a267106a4
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/18/2017
---
# <a name="telemetry-correlation-in-application-insights"></a><span data-ttu-id="4a29d-103">Correlación de Telemetría en Application Insights</span><span class="sxs-lookup"><span data-stu-id="4a29d-103">Telemetry correlation in Application Insights</span></span>

<span data-ttu-id="4a29d-104">En el mundo de los microservicios, todas las operaciones lógicas requieren que se realice el trabajo en diversos componentes del servicio.</span><span class="sxs-lookup"><span data-stu-id="4a29d-104">In the world of micro services, every logical operation requires work done in various components of the service.</span></span> <span data-ttu-id="4a29d-105">Cada uno de estos componentes puede supervisarse por separado mediante [Application Insights](app-insights-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4a29d-105">Each of these components can be separately monitored by [Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="4a29d-106">El componente de la aplicación web se comunica con el componente del proveedor de autenticación para validar las credenciales de usuario y con el componente de API a fin de obtener datos para su visualización.</span><span class="sxs-lookup"><span data-stu-id="4a29d-106">The web app component communicates with authentication provider component to validate user credentials, and with the API component to get data for visualization.</span></span> <span data-ttu-id="4a29d-107">El componente de API, a su vez, puede consultar datos de otros servicios, usar componentes de proveedor de la caché e informar al componente de facturación sobre esta llamada.</span><span class="sxs-lookup"><span data-stu-id="4a29d-107">The API component in its turn can query data from other services and use cache-provider components and notify the billing component about this call.</span></span> <span data-ttu-id="4a29d-108">Application Insights admite la correlación de telemetría distribuida.</span><span class="sxs-lookup"><span data-stu-id="4a29d-108">Application Insights supports distributed telemetry correlation.</span></span> <span data-ttu-id="4a29d-109">Permite detectar qué componente es responsable de los errores o las degradaciones del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="4a29d-109">It allows you to detect which component is responsible for failures or performance degradation.</span></span>

<span data-ttu-id="4a29d-110">Este artículo explica el modelo de datos utilizado por Application Insights para poner en correlación la telemetría enviada por varios componentes.</span><span class="sxs-lookup"><span data-stu-id="4a29d-110">This article explains the data model used by Application Insights to correlate telemetry sent by multiple components.</span></span> <span data-ttu-id="4a29d-111">En él se tratan las técnicas y protocolos de propagación de contexto.</span><span class="sxs-lookup"><span data-stu-id="4a29d-111">It covers the context propagation techniques and protocols.</span></span> <span data-ttu-id="4a29d-112">También se trata la implementación de los conceptos de correlación en distintos idiomas y plataformas.</span><span class="sxs-lookup"><span data-stu-id="4a29d-112">It also covers the implementation of the correlation concepts on different languages and platforms.</span></span>

## <a name="telemetry-correlation-data-model"></a><span data-ttu-id="4a29d-113">Modelo de datos de correlación de telemetría</span><span class="sxs-lookup"><span data-stu-id="4a29d-113">Telemetry correlation data model</span></span>

<span data-ttu-id="4a29d-114">Application Insights define el [modelo de datos](application-insights-data-model.md) para la correlación de telemetría distribuida.</span><span class="sxs-lookup"><span data-stu-id="4a29d-114">Application Insights defines a [data model](application-insights-data-model.md) for distributed telemetry correlation.</span></span> <span data-ttu-id="4a29d-115">Para asociar la telemetría con la operación lógica, todos los elementos de telemetría tienen el campo de contexto denominado `operation_Id`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-115">To associate telemetry with the logical operation, every telemetry item has a context field called `operation_Id`.</span></span> <span data-ttu-id="4a29d-116">Todos los elementos de telemetría comparten este identificador en el seguimiento distribuido.</span><span class="sxs-lookup"><span data-stu-id="4a29d-116">This identifier is shared by every telemetry item in the distributed trace.</span></span> <span data-ttu-id="4a29d-117">De este modo, aun con la pérdida de telemetría de una sola capa, todavía puede asociar la telemetría notificada por otros componentes.</span><span class="sxs-lookup"><span data-stu-id="4a29d-117">So even with loss of telemetry from a single layer you still can associate telemetry reported by other components.</span></span>

<span data-ttu-id="4a29d-118">Normalmente, la operación lógica distribuida consta de un conjunto de operaciones más pequeñas: solicitudes procesadas por uno de los componentes.</span><span class="sxs-lookup"><span data-stu-id="4a29d-118">Distributed logical operation typically consists of a set of smaller operations - requests processed by one of the components.</span></span> <span data-ttu-id="4a29d-119">La [telemetría de solicitudes](application-insights-data-model-request-telemetry.md) define esas operaciones.</span><span class="sxs-lookup"><span data-stu-id="4a29d-119">Those operations are defined by [request telemetry](application-insights-data-model-request-telemetry.md).</span></span> <span data-ttu-id="4a29d-120">Cada telemetría de solicitudes cuenta con su propio `id`, que la identifica global y exclusivamente.</span><span class="sxs-lookup"><span data-stu-id="4a29d-120">Every request telemetry has its own `id` that uniquely globally identifies it.</span></span> <span data-ttu-id="4a29d-121">Además, toda la telemetría (seguimientos, excepciones, etc.) asociada a esta solicitud debe establecer `operation_parentId` en el valor de la solicitud `id`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-121">And all telemetry - traces, exceptions, etc. associated with this request should set the `operation_parentId` to the value of the request `id`.</span></span>

<span data-ttu-id="4a29d-122">La [telemetría de dependencia](application-insights-data-model-dependency-telemetry.md) representa todas las operaciones salientes como, por ejemplo, la llamada HTTP a otro componente.</span><span class="sxs-lookup"><span data-stu-id="4a29d-122">Every outgoing operation like http call to another component represented by [dependency telemetry](application-insights-data-model-dependency-telemetry.md).</span></span> <span data-ttu-id="4a29d-123">La telemetría de dependencia también define su propio `id`, que es globalmente único.</span><span class="sxs-lookup"><span data-stu-id="4a29d-123">Dependency telemetry also defines its own `id` that is globally unique.</span></span> <span data-ttu-id="4a29d-124">La telemetría de solicitudes, iniciada por esta llamada de dependencia, la usa como `operation_parentId`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-124">Request telemetry, initiated by this dependency call, uses it as `operation_parentId`.</span></span>

<span data-ttu-id="4a29d-125">Puede crear la vista de la operación lógica distribuida usando `operation_Id`, `operation_parentId` y `request.id` con `dependency.id`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-125">You can build the view of distributed logical operation using `operation_Id`, `operation_parentId`, and `request.id` with `dependency.id`.</span></span> <span data-ttu-id="4a29d-126">Esos campos también definen el orden de causalidad de las llamadas de telemetría.</span><span class="sxs-lookup"><span data-stu-id="4a29d-126">Those fields also define the causality order of telemetry calls.</span></span>

<span data-ttu-id="4a29d-127">En el entorno de los microservicios, los seguimientos de componentes pueden ir a los distintos almacenamientos.</span><span class="sxs-lookup"><span data-stu-id="4a29d-127">In micro services environment, traces from components may go to the different storages.</span></span> <span data-ttu-id="4a29d-128">Cada componente puede tener su propia clave de instrumentación en Application Insights.</span><span class="sxs-lookup"><span data-stu-id="4a29d-128">Every component may have its own instrumentation key in Application Insights.</span></span> <span data-ttu-id="4a29d-129">A fin de obtener la telemetría para la operación lógica, es necesario consultar los datos de cada almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="4a29d-129">To get telemetry for the logical operation, you need to query data from every storage.</span></span> <span data-ttu-id="4a29d-130">Si el número de almacenamientos es muy elevado, debe tener una idea de dónde mirar a continuación.</span><span class="sxs-lookup"><span data-stu-id="4a29d-130">When number of storages is huge, you need to have a hint on where to look next.</span></span>

<span data-ttu-id="4a29d-131">El modelo de datos de Application Insights define dos campos, `request.source` y `dependency.target`, para solucionar este problema.</span><span class="sxs-lookup"><span data-stu-id="4a29d-131">Application Insights data model defines two fields to solve this problem: `request.source` and `dependency.target`.</span></span> <span data-ttu-id="4a29d-132">El primer campo identifica el componente que inició la solicitud de dependencia y, el segundo, el componente que devolvió la respuesta de la llamada de dependencia.</span><span class="sxs-lookup"><span data-stu-id="4a29d-132">The first field identifies the component that initiated the dependency request, and the second identifies which component returned the response of the dependency call.</span></span>


## <a name="example"></a><span data-ttu-id="4a29d-133">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="4a29d-133">Example</span></span>

<span data-ttu-id="4a29d-134">Tomemos como ejemplo una aplicación COTIZACIONES BURSÁTILES que muestra el precio de mercado actual de una acción con una API externa denominada API DE COTIZACIONES.</span><span class="sxs-lookup"><span data-stu-id="4a29d-134">Let's take an example of an application STOCK PRICES showing the current market price of a stock using the external API called STOCKS API.</span></span> <span data-ttu-id="4a29d-135">La aplicación COTIZACIONES BURSÁTILES tiene una página `Stock page` abierta por el explorador web de cliente mediante `GET /Home/Stock`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-135">The STOCK PRICES application has a page `Stock page` opened by the client web browser using `GET /Home/Stock`.</span></span> <span data-ttu-id="4a29d-136">La aplicación consulta la API de COTIZACIONES BURSÁTILES mediante el uso de una llamada HTTP `GET /api/stock/value`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-136">The application queries the STOCK API by using an HTTP call `GET /api/stock/value`.</span></span>

<span data-ttu-id="4a29d-137">Puede analizar la telemetría resultante mediante la ejecución de una consulta:</span><span class="sxs-lookup"><span data-stu-id="4a29d-137">You can analyze resulting telemetry running a query:</span></span>

```
(requests | union dependencies | union pageViews) 
| where operation_Id == "STYz"
| project timestamp, itemType, name, id, operation_ParentId, operation_Id
```

<span data-ttu-id="4a29d-138">En la vista de resultados, observe que todos los elementos de telemetría comparten la raíz `operation_Id`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-138">In the result view note that all telemetry items share the root `operation_Id`.</span></span> <span data-ttu-id="4a29d-139">Al realizarse la llamada ajax desde la página, el nuevo y único id. `qJSXU` se asigna a la telemetría de dependencia y el id. de pageView se usa como `operation_ParentId`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-139">When ajax call made from the page - new unique id `qJSXU` is assigned to the dependency telemetry and pageView's id is used as `operation_ParentId`.</span></span> <span data-ttu-id="4a29d-140">A su vez, la solicitud de servidor utiliza el id. de ajax como `operation_ParentId`, etc.</span><span class="sxs-lookup"><span data-stu-id="4a29d-140">In turn server request uses ajax's id as `operation_ParentId`, etc.</span></span>

| <span data-ttu-id="4a29d-141">itemType</span><span class="sxs-lookup"><span data-stu-id="4a29d-141">itemType</span></span>   | <span data-ttu-id="4a29d-142">name</span><span class="sxs-lookup"><span data-stu-id="4a29d-142">name</span></span>                      | <span data-ttu-id="4a29d-143">id</span><span class="sxs-lookup"><span data-stu-id="4a29d-143">id</span></span>           | <span data-ttu-id="4a29d-144">operation_ParentId</span><span class="sxs-lookup"><span data-stu-id="4a29d-144">operation_ParentId</span></span> | <span data-ttu-id="4a29d-145">operation_Id</span><span class="sxs-lookup"><span data-stu-id="4a29d-145">operation_Id</span></span> |
|------------|---------------------------|--------------|--------------------|--------------|
| <span data-ttu-id="4a29d-146">pageView</span><span class="sxs-lookup"><span data-stu-id="4a29d-146">pageView</span></span>   | <span data-ttu-id="4a29d-147">Stock page</span><span class="sxs-lookup"><span data-stu-id="4a29d-147">Stock page</span></span>                |              | <span data-ttu-id="4a29d-148">STYz</span><span class="sxs-lookup"><span data-stu-id="4a29d-148">STYz</span></span>               | <span data-ttu-id="4a29d-149">STYz</span><span class="sxs-lookup"><span data-stu-id="4a29d-149">STYz</span></span>         |
| <span data-ttu-id="4a29d-150">dependency</span><span class="sxs-lookup"><span data-stu-id="4a29d-150">dependency</span></span> | <span data-ttu-id="4a29d-151">GET /Home/Stock</span><span class="sxs-lookup"><span data-stu-id="4a29d-151">GET /Home/Stock</span></span>           | <span data-ttu-id="4a29d-152">qJSXU</span><span class="sxs-lookup"><span data-stu-id="4a29d-152">qJSXU</span></span>        | <span data-ttu-id="4a29d-153">STYz</span><span class="sxs-lookup"><span data-stu-id="4a29d-153">STYz</span></span>               | <span data-ttu-id="4a29d-154">STYz</span><span class="sxs-lookup"><span data-stu-id="4a29d-154">STYz</span></span>         |
| <span data-ttu-id="4a29d-155">request</span><span class="sxs-lookup"><span data-stu-id="4a29d-155">request</span></span>    | <span data-ttu-id="4a29d-156">GET Home/Stock</span><span class="sxs-lookup"><span data-stu-id="4a29d-156">GET Home/Stock</span></span>            | <span data-ttu-id="4a29d-157">KqKwlrSt9PA=</span><span class="sxs-lookup"><span data-stu-id="4a29d-157">KqKwlrSt9PA=</span></span> | <span data-ttu-id="4a29d-158">qJSXU</span><span class="sxs-lookup"><span data-stu-id="4a29d-158">qJSXU</span></span>              | <span data-ttu-id="4a29d-159">STYz</span><span class="sxs-lookup"><span data-stu-id="4a29d-159">STYz</span></span>         |
| <span data-ttu-id="4a29d-160">dependency</span><span class="sxs-lookup"><span data-stu-id="4a29d-160">dependency</span></span> | <span data-ttu-id="4a29d-161">GET /api/stock/value</span><span class="sxs-lookup"><span data-stu-id="4a29d-161">GET /api/stock/value</span></span>      | <span data-ttu-id="4a29d-162">bBrf2L7mm2g=</span><span class="sxs-lookup"><span data-stu-id="4a29d-162">bBrf2L7mm2g=</span></span> | <span data-ttu-id="4a29d-163">KqKwlrSt9PA=</span><span class="sxs-lookup"><span data-stu-id="4a29d-163">KqKwlrSt9PA=</span></span>       | <span data-ttu-id="4a29d-164">STYz</span><span class="sxs-lookup"><span data-stu-id="4a29d-164">STYz</span></span>         |

<span data-ttu-id="4a29d-165">Ahora, al realizarse la llamada `GET /api/stock/value` a un servicio externo, desea conocer la identidad de ese servidor.</span><span class="sxs-lookup"><span data-stu-id="4a29d-165">Now when the call `GET /api/stock/value` made to an external service you want to know the identity of that server.</span></span> <span data-ttu-id="4a29d-166">De este modo, puede establecer el campo `dependency.target` adecuadamente.</span><span class="sxs-lookup"><span data-stu-id="4a29d-166">So you can set `dependency.target` field appropriately.</span></span> <span data-ttu-id="4a29d-167">Si el servicio externo no admite la supervisión, `target` se establece en el nombre de host del servicio como `stock-prices-api.com`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-167">When the external service does not support monitoring - `target` is set to the host name of the service like `stock-prices-api.com`.</span></span> <span data-ttu-id="4a29d-168">Sin embargo, si ese servicio se identifica devolviendo un encabezado HTTP predefinido, `target` contiene la identidad de servicio que permite a Application Insights crear un seguimiento distribuido consultando la telemetría de ese servicio.</span><span class="sxs-lookup"><span data-stu-id="4a29d-168">However if that service identifies itself by returning a predefined HTTP header - `target` contains the service identity that allows Application Insights to build distributed trace by querying telemetry from that service.</span></span> 

## <a name="correlation-headers"></a><span data-ttu-id="4a29d-169">Encabezados de correlación</span><span class="sxs-lookup"><span data-stu-id="4a29d-169">Correlation headers</span></span>

<span data-ttu-id="4a29d-170">Estamos trabajando en una propuesta de RFC para el [protocolo HTTP de correlación](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v1.md).</span><span class="sxs-lookup"><span data-stu-id="4a29d-170">We are working on RFC proposal for the [correlation HTTP protocol](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v1.md).</span></span> <span data-ttu-id="4a29d-171">Esta propuesta define dos encabezados:</span><span class="sxs-lookup"><span data-stu-id="4a29d-171">This proposal defines two headers:</span></span>

- <span data-ttu-id="4a29d-172">`Request-Id`: lleva el id. único a nivel global de la llamada</span><span class="sxs-lookup"><span data-stu-id="4a29d-172">`Request-Id` carry the globally unique id of the call</span></span>
- <span data-ttu-id="4a29d-173">`Correlation-Context`: lleva la colección de pares nombre-valor de las propiedades de seguimiento distribuidas</span><span class="sxs-lookup"><span data-stu-id="4a29d-173">`Correlation-Context` - carry the name value pairs collection of the distributed trace properties</span></span>

<span data-ttu-id="4a29d-174">El estándar también define dos esquemas de generación `Request-Id`: sin formato y jerárquico.</span><span class="sxs-lookup"><span data-stu-id="4a29d-174">The standard also defines two schemas of `Request-Id` generation - flat and hierarchical.</span></span> <span data-ttu-id="4a29d-175">Con el esquema sin formato, hay una clave de `Id` conocida definida para la colección `Correlation-Context`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-175">With the flat schema, there is a well-known `Id` key defined for the `Correlation-Context` collection.</span></span>

<span data-ttu-id="4a29d-176">Application Insights define la [extensión](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v2.md) del protocolo HTTP de correlación.</span><span class="sxs-lookup"><span data-stu-id="4a29d-176">Application Insights defines the [extension](https://github.com/lmolkova/correlation/blob/master/http_protocol_proposal_v2.md) for the correlation HTTP protocol.</span></span> <span data-ttu-id="4a29d-177">Usa pares nombre-valor `Request-Context` para propagar la colección de propiedades utilizadas por el autor o destinatario de la llamada.</span><span class="sxs-lookup"><span data-stu-id="4a29d-177">It uses `Request-Context` name value pairs to propagate the collection of properties used by the immediate caller or callee.</span></span> <span data-ttu-id="4a29d-178">El SDK de Application Insights usa este encabezado para establecer los campos `dependency.target` y `request.source`.</span><span class="sxs-lookup"><span data-stu-id="4a29d-178">Application Insights SDK uses this header to set `dependency.target` and `request.source` fields.</span></span>

## <a name="open-tracing-and-application-insights"></a><span data-ttu-id="4a29d-179">Open Tracing y Application Insights</span><span class="sxs-lookup"><span data-stu-id="4a29d-179">Open tracing and Application Insights</span></span>

<span data-ttu-id="4a29d-180">Aspecto de los modelos de datos de [Open Tracing](http://opentracing.io/) y Application Insights</span><span class="sxs-lookup"><span data-stu-id="4a29d-180">[Open Tracing](http://opentracing.io/) and Application Insights data models looks</span></span> 

- <span data-ttu-id="4a29d-181">`request`, `pageView` se asigna a **Span** con `span.kind = server`</span><span class="sxs-lookup"><span data-stu-id="4a29d-181">`request`, `pageView` maps to **Span** with `span.kind = server`</span></span>
- <span data-ttu-id="4a29d-182">`dependency` se asigna a **Span** con `span.kind = client`</span><span class="sxs-lookup"><span data-stu-id="4a29d-182">`dependency` maps to **Span** with `span.kind = client`</span></span>
- <span data-ttu-id="4a29d-183">`id` de un elemento `request` y `dependency` se asigna a **Span.Id**</span><span class="sxs-lookup"><span data-stu-id="4a29d-183">`id` of a `request` and `dependency` maps to **Span.Id**</span></span>
- <span data-ttu-id="4a29d-184">`operation_Id` se asigna a **TraceId**</span><span class="sxs-lookup"><span data-stu-id="4a29d-184">`operation_Id` maps to **TraceId**</span></span>
- <span data-ttu-id="4a29d-185">`operation_ParentId` se asigna a **Reference** de tipo `ChileOf`</span><span class="sxs-lookup"><span data-stu-id="4a29d-185">`operation_ParentId` maps to **Reference** of type `ChileOf`</span></span>

<span data-ttu-id="4a29d-186">Consulte [modelo de datos](application-insights-data-model.md) para los tipos y el modelo de datos de Application Insights.</span><span class="sxs-lookup"><span data-stu-id="4a29d-186">See [data model](application-insights-data-model.md) for Application Insights types and data model.</span></span>

<span data-ttu-id="4a29d-187">Consulte [specification](https://github.com/opentracing/specification/blob/master/specification.md) (especificación) y [semantic_conventions](https://github.com/opentracing/specification/blob/master/semantic_conventions.md) (convenciones_semánticas) para obtener definiciones de los conceptos de Open Tracing.</span><span class="sxs-lookup"><span data-stu-id="4a29d-187">See [specification](https://github.com/opentracing/specification/blob/master/specification.md) and [semantic_conventions](https://github.com/opentracing/specification/blob/master/semantic_conventions.md) for definitions of Open Tracing concepts.</span></span>


## <a name="telemetry-correlation-in-net"></a><span data-ttu-id="4a29d-188">Correlación de telemetría en .NET</span><span class="sxs-lookup"><span data-stu-id="4a29d-188">Telemetry correlation in .NET</span></span>

<span data-ttu-id="4a29d-189">Con el tiempo, .NET ha definido varias formas de poner en correlación la telemetría y registros de diagnósticos.</span><span class="sxs-lookup"><span data-stu-id="4a29d-189">Over time .NET defined number of ways to correlate telemetry and diagnostics logs.</span></span> <span data-ttu-id="4a29d-190">Hay un elemento, `System.Diagnostics.CorrelationManager`, que permite realizar un seguimiento de [LogicalOperationStack y ActivityId](https://msdn.microsoft.com/library/system.diagnostics.correlationmanager.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a29d-190">There is `System.Diagnostics.CorrelationManager` allowing to track [LogicalOperationStack and ActivityId](https://msdn.microsoft.com/library/system.diagnostics.correlationmanager.aspx).</span></span> <span data-ttu-id="4a29d-191">`System.Diagnostics.Tracing.EventSource` y el seguimiento de eventos para Windows definen el método [SetCurrentThreadActivityId](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.setcurrentthreadactivityid.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a29d-191">`System.Diagnostics.Tracing.EventSource` and Windows ETW define the method [SetCurrentThreadActivityId](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.setcurrentthreadactivityid.aspx).</span></span> <span data-ttu-id="4a29d-192">`ILogger` usa [ámbitos de registro](https://docs.microsoft.com/aspnet/core/fundamentals/logging#log-scopes).</span><span class="sxs-lookup"><span data-stu-id="4a29d-192">`ILogger` uses [Log Scopes](https://docs.microsoft.com/aspnet/core/fundamentals/logging#log-scopes).</span></span> <span data-ttu-id="4a29d-193">WCF y HTTP conectan la propagación del contexto "actual".</span><span class="sxs-lookup"><span data-stu-id="4a29d-193">WCF and Http wire up "current" context propagation.</span></span>

<span data-ttu-id="4a29d-194">Sin embargo, esos métodos no han habilitado la compatibilidad con el seguimiento distribuido automático.</span><span class="sxs-lookup"><span data-stu-id="4a29d-194">However those methods didn't enable automatic distributed tracing support.</span></span> <span data-ttu-id="4a29d-195">`DiagnosticsSource` es una forma de admitir la correlación entre máquinas.</span><span class="sxs-lookup"><span data-stu-id="4a29d-195">`DiagnosticsSource` is a way to support automatic cross machine correlation.</span></span> <span data-ttu-id="4a29d-196">Las bibliotecas de .NET admiten Diagnostics Source (Origen de diagnóstico) y permiten la propagación entre máquinas del contexto de propagación a través del transporte como http.</span><span class="sxs-lookup"><span data-stu-id="4a29d-196">.NET libraries support Diagnostics Source and allow automatic cross machine propagation of the correlation context via the transport like http.</span></span>

<span data-ttu-id="4a29d-197">En la [guía de Activities](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) (Actividades) de Diagnostics Source (Origen de diagnóstico) se explican los conceptos básicos de Activities (Actividades) de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="4a29d-197">The [guide to Activities](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) in Diagnostics Source explains the basics of tracking Activities.</span></span> 

<span data-ttu-id="4a29d-198">ASP.NET Core 2.0 admite la extracción de encabezados HTTP e inicia la nueva Activity (Actividad).</span><span class="sxs-lookup"><span data-stu-id="4a29d-198">ASP.NET Core 2.0 supports extraction of Http Headers and starting the new Activity.</span></span> 

<span data-ttu-id="4a29d-199">La versión inicial de `System.Net.HttpClient`, `<fill in>`, admite la inserción automática de los encabezados HTTP de correlación y realiza un seguimiento de la llamada HTTP como Activity (Actividad).</span><span class="sxs-lookup"><span data-stu-id="4a29d-199">`System.Net.HttpClient` starting version `<fill in>` supports automatic injection of the correlation Http Headers and tracking the http call as an Activity.</span></span>

<span data-ttu-id="4a29d-200">Hay un nuevo módulo HTTP, [Microsoft.AspNet.TelemetryCorrelation](https://www.nuget.org/packages/Microsoft.AspNet.TelemetryCorrelation/) de ASP.NET clásico.</span><span class="sxs-lookup"><span data-stu-id="4a29d-200">There is a new Http Module [Microsoft.AspNet.TelemetryCorrelation](https://www.nuget.org/packages/Microsoft.AspNet.TelemetryCorrelation/) for the ASP.NET Classic.</span></span> <span data-ttu-id="4a29d-201">En este módulo se implementa la correlación de telemetría mediante DiagnosticsSource (Origen de diagnóstico).</span><span class="sxs-lookup"><span data-stu-id="4a29d-201">This module implements telemetry correlation using DiagnosticsSource.</span></span> <span data-ttu-id="4a29d-202">Inicia la actividad en función de los encabezados de solicitud entrantes. </span><span class="sxs-lookup"><span data-stu-id="4a29d-202">It starts activity based on incoming request headers.</span></span> <span data-ttu-id="4a29d-203">También pone en correlación la telemetría de las diversas fases del procesamiento de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="4a29d-203">It also correlates telemetry from the different stages of request processing.</span></span> <span data-ttu-id="4a29d-204">Incluso en los casos en que se ejecutan todas las fases del procesamiento de IIS en un subproceso administrado distinto.</span><span class="sxs-lookup"><span data-stu-id="4a29d-204">Even for the cases when every stage of IIS processing runs on a different manage threads.</span></span>

<span data-ttu-id="4a29d-205">La versión inicial del SDK de Application Insights, `2.4.0-beta1`, usa DiagnosticsSource (Origen de diagnóstico) y Activity (Actividad) para recolectar la telemetría y asociarla a la actividad actual.</span><span class="sxs-lookup"><span data-stu-id="4a29d-205">Application Insights SDK starting version `2.4.0-beta1` uses DiagnosticsSource and Activity to collect telemetry and associate it with the current activity.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="4a29d-206">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="4a29d-206">Next steps</span></span>

- [<span data-ttu-id="4a29d-207">Escritura de telemetría personalizada</span><span class="sxs-lookup"><span data-stu-id="4a29d-207">Write custom telemetry</span></span>](app-insights-api-custom-events-metrics.md)
- <span data-ttu-id="4a29d-208">Incorpore todos los componentes del microservicio en Application Insights.</span><span class="sxs-lookup"><span data-stu-id="4a29d-208">Onboard all components of your micro service on Application Insights.</span></span> <span data-ttu-id="4a29d-209">Consulte las [plataformas compatibles](app-insights-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="4a29d-209">Check out [supported platforms](app-insights-platforms.md).</span></span>
- <span data-ttu-id="4a29d-210">Consulte [modelo de datos](application-insights-data-model.md) para los tipos y el modelo de datos de Application Insights.</span><span class="sxs-lookup"><span data-stu-id="4a29d-210">See [data model](application-insights-data-model.md) for Application Insights types and data model.</span></span>
- <span data-ttu-id="4a29d-211">Obtenga información sobre cómo [ampliar y filtrar la telemetría](app-insights-api-filtering-sampling.md).</span><span class="sxs-lookup"><span data-stu-id="4a29d-211">Learn how to [extend and filter telemetry](app-insights-api-filtering-sampling.md).</span></span>
