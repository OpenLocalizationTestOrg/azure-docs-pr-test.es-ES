---
title: "Conexión de Excel a Hadoop con Power Query - Azure HDInsight | Microsoft Docs"
description: "Vea cómo aprovechar las ventajas de los componentes de inteligencia empresarial y usar Power Query para Excel a fin de acceder a los datos almacenados en Hadoop en HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="80c92-103">Conexión de Excel a Hadoop con Power Query</span><span class="sxs-lookup"><span data-stu-id="80c92-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="80c92-104">Una de las características clave de la solución para Big Data de Microsoft es la integración de los componentes de Microsoft Business Intelligence (BI) con los clústeres de Hadoop en Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="80c92-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="80c92-105">Un ejemplo importante es la capacidad de conectar Excel a la cuenta de Azure Storage que contiene los datos asociados a su clúster de Hadoop mediante el complemento de Microsoft Power Query para Excel.</span><span class="sxs-lookup"><span data-stu-id="80c92-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="80c92-106">En este artículo se describen las pautas para configurar y usar Power Query para consultar los datos asociados con un clúster de Hadoop administrado con HDInsight.</span><span class="sxs-lookup"><span data-stu-id="80c92-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="80c92-107">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="80c92-107">Prerequisites</span></span>
<span data-ttu-id="80c92-108">Antes de empezar este artículo, debe tener los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="80c92-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="80c92-109">**Un clúster de HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="80c92-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="80c92-110">Para configurarlo, consulte [Introducción a Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="80c92-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="80c92-111">**Una estación de trabajo** que ejecute Windows 7, Windows Server 2008 R2 o un sistema operativo posterior.</span><span class="sxs-lookup"><span data-stu-id="80c92-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="80c92-112">**Office 2016, Office Profesional Plus 2013, Office 365 ProPlus, Excel 2013 Standalone u Office Professional Plus 2010**.</span><span class="sxs-lookup"><span data-stu-id="80c92-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="80c92-113">Instalación de Power Query</span><span class="sxs-lookup"><span data-stu-id="80c92-113">Install Power Query</span></span>
<span data-ttu-id="80c92-114">Power Query puede importar datos ofrecidos o generados por un trabajo de Hadoop ejecutado en un clúster de HDInsight.</span><span class="sxs-lookup"><span data-stu-id="80c92-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="80c92-115">En Excel 2016, Power Query se ha integrado en la cinta de Datos en la sección Obtener y transformar.</span><span class="sxs-lookup"><span data-stu-id="80c92-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="80c92-116">Para versiones anteriores de Excel, descargue Microsoft Power Query para Excel desde el [Centro de descarga de Microsoft][powerquery-download] e instálelo.</span><span class="sxs-lookup"><span data-stu-id="80c92-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="80c92-117">Importación de datos de HDInsight a Excel</span><span class="sxs-lookup"><span data-stu-id="80c92-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="80c92-118">El complemento de Power Query para Excel facilita la importación de datos desde el clúster de HDInsight hasta Excel, donde se pueden usar herramientas de BI como PowerPivot y Power Map para la inspección, el análisis y la presentación de los datos.</span><span class="sxs-lookup"><span data-stu-id="80c92-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="80c92-119">**Para importar datos desde un clúster de HDInsight**</span><span class="sxs-lookup"><span data-stu-id="80c92-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="80c92-120">Abra Excel.</span><span class="sxs-lookup"><span data-stu-id="80c92-120">Open Excel.</span></span>
2. <span data-ttu-id="80c92-121">Cree un libro vacío.</span><span class="sxs-lookup"><span data-stu-id="80c92-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="80c92-122">Siga los pasos siguientes en función de la versión de Excel:</span><span class="sxs-lookup"><span data-stu-id="80c92-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="80c92-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="80c92-123">Excel 2016</span></span>

        - <span data-ttu-id="80c92-124">Haga clic en el menú **Datos**, haga clic en **Obtener datos** desde la cinta **Obtener y transformar datos**, haga clic en **Desde Azure** y, después, en **Desde Azure HDInsight (HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="80c92-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="80c92-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="80c92-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="80c92-127">Haga clic en el menú **Power Query**, en **De Azure** y, luego, en **De HDInsight de Microsoft Azure** .</span><span class="sxs-lookup"><span data-stu-id="80c92-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="80c92-129">**Nota**: Si no ve el menú **Power Query**, vaya a **Archivo** > **Opciones** > **Complementos** y seleccione **Complementos COM** en el cuadro desplegable **Administrador** situado al final de la página.</span><span class="sxs-lookup"><span data-stu-id="80c92-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="80c92-130">Elija el botón **Go...** y compruebe que la casilla del complemento de Power Query para Excel esté activada.</span><span class="sxs-lookup"><span data-stu-id="80c92-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="80c92-131">**Nota:** Power Query también permite importar datos de HDFS haciendo clic **De otros orígenes**.</span><span class="sxs-lookup"><span data-stu-id="80c92-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="80c92-132">En **Nombre de cuenta**, escriba el nombre de la cuenta de Azure Blob Storage asociada con su clúster y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="80c92-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="80c92-133">Esta puede ser una [cuenta de almacenamiento predeterminada](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) o una cuenta de almacenamiento vinculada.</span><span class="sxs-lookup"><span data-stu-id="80c92-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="80c92-134">El formato es *https://&lt;NombreDeCuentaDeAlmacenamiento>.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="80c92-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="80c92-135">En **Clave de cuenta**, escriba la clave de cuenta para la cuenta deBlob Storage y, a continuación, haga clic en **Guardar**.</span><span class="sxs-lookup"><span data-stu-id="80c92-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="80c92-136">(Solo tiene que escribir la información de la cuenta la primera vez que tenga acceso a este almacén).</span><span class="sxs-lookup"><span data-stu-id="80c92-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="80c92-137">En el panel del **navegador** situado a la izquierda del Editor de consultas, haga doble clic en el nombre del contenedor de almacenamiento de blobs.</span><span class="sxs-lookup"><span data-stu-id="80c92-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="80c92-138">De forma predeterminada, el nombre del contenedor es el mismo que el del clúster.</span><span class="sxs-lookup"><span data-stu-id="80c92-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="80c92-139">Busque **HiveSampleData.txt** en la columna **Nombre** (la ruta de acceso de la carpeta es **../hive/warehouse/hivesampletable/)**, y haga clic en **Binario** a la izquierda de HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="80c92-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="80c92-140">HiveSampleData.txt incluye todo el clúster.</span><span class="sxs-lookup"><span data-stu-id="80c92-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="80c92-141">Opcionalmente, puede utilizar su propio archivo.</span><span class="sxs-lookup"><span data-stu-id="80c92-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="80c92-143">Si quiere, puede cambiar el nombre de las columnas.</span><span class="sxs-lookup"><span data-stu-id="80c92-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="80c92-144">Cuando haya terminado, haga clic en **Aplicar y cerrar**.</span><span class="sxs-lookup"><span data-stu-id="80c92-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="80c92-145">Los datos se han cargado en el libro:</span><span class="sxs-lookup"><span data-stu-id="80c92-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="80c92-147">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="80c92-147">Next steps</span></span>
<span data-ttu-id="80c92-148">En este artículo, ha aprendido a usar Power Query para recuperar datos de HDInsight en Excel.</span><span class="sxs-lookup"><span data-stu-id="80c92-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="80c92-149">Del mismo modo, puede recuperar datos de HDInsight en Base de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="80c92-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="80c92-150">También se pueden cargar los datos en HDInsight.</span><span class="sxs-lookup"><span data-stu-id="80c92-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="80c92-151">Para obtener más información, consulte los artículos siguientes:</span><span class="sxs-lookup"><span data-stu-id="80c92-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="80c92-152">[Conexión de Excel a HDInsight con Microsoft Hive ODBC Driver][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="80c92-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="80c92-153">[Carga de datos en HDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="80c92-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
