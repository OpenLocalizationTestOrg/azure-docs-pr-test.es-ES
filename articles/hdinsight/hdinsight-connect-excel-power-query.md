---
title: aaaConnect tooHadoop de Excel con Power Query - HDInsight de Azure | Documentos de Microsoft
description: "Obtenga información acerca de cómo tootake ventaja de los componentes de business intelligence y se utiliza Power Query para Excel tooaccess datos almacenados en Hadoop en HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 1213849f1bc04e0ed206750b80766ff2268664b4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="connect-excel-toohadoop-by-using-power-query"></a><span data-ttu-id="06c75-103">Conectar Excel tooHadoop mediante Power Query</span><span class="sxs-lookup"><span data-stu-id="06c75-103">Connect Excel tooHadoop by using Power Query</span></span>
<span data-ttu-id="06c75-104">Una característica clave de la solución de grandes cantidades de datos de Microsoft hello es la integración de Hola de componentes de Microsoft business intelligence (BI) con los clústeres de Hadoop en HDInsight de Azure.</span><span class="sxs-lookup"><span data-stu-id="06c75-104">One key feature of hello Microsoft big-data solution is hello integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="06c75-105">Un ejemplo principal es Hola capacidad tooconnect Excel toohello cuenta de almacenamiento de Azure que contiene datos de hello asociadas al clúster de Hadoop mediante el uso de Microsoft Power Query de hello para el complemento de Excel.</span><span class="sxs-lookup"><span data-stu-id="06c75-105">A primary example is hello ability tooconnect Excel toohello Azure Storage account that contains hello data associated with your Hadoop cluster by using hello Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="06c75-106">Este artículo le guiará a través de cómo administran tooset seguridad y el uso de datos de Power Query tooquery asociados a un clúster de Hadoop con HDInsight.</span><span class="sxs-lookup"><span data-stu-id="06c75-106">This article walks you through how tooset up and use Power Query tooquery data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="06c75-107">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="06c75-107">Prerequisites</span></span>
<span data-ttu-id="06c75-108">Antes de comenzar este artículo, debe tener Hola siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="06c75-108">Before you begin this article, you must have hello following items:</span></span>

* <span data-ttu-id="06c75-109">**Un clúster de HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="06c75-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="06c75-110">tooconfigure uno, vea [empezar a trabajar con HDInsight de Azure][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="06c75-110">tooconfigure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="06c75-111">**Una estación de trabajo** que ejecute Windows 7, Windows Server 2008 R2 o un sistema operativo posterior.</span><span class="sxs-lookup"><span data-stu-id="06c75-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="06c75-112">**Office 2016, Office Profesional Plus 2013, Office 365 ProPlus, Excel 2013 Standalone u Office Professional Plus 2010**.</span><span class="sxs-lookup"><span data-stu-id="06c75-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="06c75-113">Instalación de Power Query</span><span class="sxs-lookup"><span data-stu-id="06c75-113">Install Power Query</span></span>
<span data-ttu-id="06c75-114">Power Query puede importar datos ofrecidos o generados por un trabajo de Hadoop ejecutado en un clúster de HDInsight.</span><span class="sxs-lookup"><span data-stu-id="06c75-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="06c75-115">En Excel 2016, Power Query se ha integrado en la cinta de opciones de datos de hello en hello Get & sección de transformación.</span><span class="sxs-lookup"><span data-stu-id="06c75-115">In Excel 2016, Power Query has been integrated into hello Data ribbon under hello Get & Transform section.</span></span> <span data-ttu-id="06c75-116">Para versiones anteriores de Excel, descargue Microsoft Power Query para Excel de hello [Microsoft Download Center] [ powerquery-download] e instalarlo.</span><span class="sxs-lookup"><span data-stu-id="06c75-116">For older Excel versions, download Microsoft Power Query for Excel from hello [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="06c75-117">Importación de datos de HDInsight a Excel</span><span class="sxs-lookup"><span data-stu-id="06c75-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="06c75-118">Hola complemento Power Query para Excel resulta fácil tooimport datos desde el clúster de HDInsight en Excel, donde pueden ser usado tooinspect, analizar y presentar datos Hola herramientas de BI como PowerPivot y asignación de energía.</span><span class="sxs-lookup"><span data-stu-id="06c75-118">hello Power Query add-in for Excel makes it easy tooimport data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used tooinspect, analyze, and present hello data.</span></span>

<span data-ttu-id="06c75-119">**tooimport datos de un clúster de HDInsight**</span><span class="sxs-lookup"><span data-stu-id="06c75-119">**tooimport data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="06c75-120">Abra Excel.</span><span class="sxs-lookup"><span data-stu-id="06c75-120">Open Excel.</span></span>
2. <span data-ttu-id="06c75-121">Cree un libro vacío.</span><span class="sxs-lookup"><span data-stu-id="06c75-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="06c75-122">Lleve a cabo Hola siguiendo los pasos que se basa en la versión de Excel de hello:</span><span class="sxs-lookup"><span data-stu-id="06c75-122">Perform hello following steps based on hello Excel version:</span></span>

    - <span data-ttu-id="06c75-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="06c75-123">Excel 2016</span></span>

        - <span data-ttu-id="06c75-124">Haga clic en hello **datos** menú, haga clic en **obtener datos** de hello **obtener y transformar datos** la cinta de opciones, haga clic en **de Azure**y, a continuación, haga clic en  **Desde Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="06c75-124">Click hello **Data** menu, click **Get Data** from hello **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="06c75-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="06c75-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="06c75-127">Haga clic en hello **Power Query** menú, haga clic en **de Azure**y, a continuación, haga clic en **desde Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="06c75-127">Click hello **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="06c75-129">**Nota:** si no ve hello **Power Query** menú, ir demasiado**archivo** > **opciones** > **Add-Ins**y seleccione **complementos COM** de hello desplegable **administrar** cuadro final Hola de página Hola.</span><span class="sxs-lookup"><span data-stu-id="06c75-129">**Note:** If you don't see hello **Power Query** menu, go too**File** > **Options** > **Add-Ins**, and select **COM Add-ins** from hello drop-down **Manage** box at hello bottom of hello page.</span></span> <span data-ttu-id="06c75-130">Seleccione hello **vaya...**  botón y compruebe que ese cuadro Hola de hello Power Query para el complemento de Excel se ha comprobado.</span><span class="sxs-lookup"><span data-stu-id="06c75-130">Select hello **Go...** button and verify that hello box for hello Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="06c75-131">**Nota:** Power Query también le permite tooimport datos desde HDFS haciendo clic en **desde otros orígenes**.</span><span class="sxs-lookup"><span data-stu-id="06c75-131">**Note:** Power Query also allows you tooimport data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="06c75-132">Para **nombre-cuenta**, escriba Hola nombre de cuenta de almacenamiento de blobs de Azure Hola asociada al clúster y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="06c75-132">For **Account Name**, enter hello name of hello Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="06c75-133">Esta cuenta puede ser hello [cuenta de almacenamiento predeterminada](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) o una cuenta de almacenamiento vinculado.</span><span class="sxs-lookup"><span data-stu-id="06c75-133">This account can be hello [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="06c75-134">formato de Hello es *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="06c75-134">hello format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="06c75-135">Para **clave de cuenta**, escriba la clave de Hola de hello cuenta de almacenamiento Blob y, a continuación, haga clic en **guardar**.</span><span class="sxs-lookup"><span data-stu-id="06c75-135">For **Account Key**, enter hello key for hello Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="06c75-136">(Debe tooenter Hola Hola de cuenta información solo primera vez que accede a este almacén.)</span><span class="sxs-lookup"><span data-stu-id="06c75-136">(You need tooenter hello account information only hello first time you access this store.)</span></span>
6. <span data-ttu-id="06c75-137">Hola **navegador** panel Hola deja de hello Editor de consultas, haga doble clic en el nombre del contenedor de almacenamiento de blobs de Hola.</span><span class="sxs-lookup"><span data-stu-id="06c75-137">In hello **Navigator** pane on hello left of hello Query Editor, double-click hello Blob storage container name.</span></span> <span data-ttu-id="06c75-138">De forma predeterminada, el nombre del contenedor de Hola Hola mismo nombre como nombre del clúster Hola.</span><span class="sxs-lookup"><span data-stu-id="06c75-138">By default, hello container name is hello same name as hello cluster name.</span></span>
7. <span data-ttu-id="06c75-139">Busque **HiveSampleData.txt** en hello **nombre** columna (ruta de acceso de carpeta de hello es **... / hive/almacenamiento/hivesampletable/**) y, a continuación, haga clic en **binario** izquierda Hola de HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="06c75-139">Locate **HiveSampleData.txt** in hello **Name** column (hello folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on hello left of HiveSampleData.txt.</span></span> <span data-ttu-id="06c75-140">HiveSampleData.txt incluye todos los clúster Hola.</span><span class="sxs-lookup"><span data-stu-id="06c75-140">HiveSampleData.txt comes with all hello cluster.</span></span> <span data-ttu-id="06c75-141">Opcionalmente, puede utilizar su propio archivo.</span><span class="sxs-lookup"><span data-stu-id="06c75-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="06c75-143">Si lo desea, puede cambiar los nombres de columna de Hola.</span><span class="sxs-lookup"><span data-stu-id="06c75-143">If you want, you can rename hello column names.</span></span> <span data-ttu-id="06c75-144">Cuando haya terminado, haga clic en **Aplicar y cerrar**.</span><span class="sxs-lookup"><span data-stu-id="06c75-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="06c75-145">datos de Hello ha sido cargado tooyour libro:</span><span class="sxs-lookup"><span data-stu-id="06c75-145">hello data has been loaded tooyour workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="06c75-147">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="06c75-147">Next steps</span></span>
<span data-ttu-id="06c75-148">En este artículo, se habrá aprendido cómo toouse datos de Power Query tooretrieve de HDInsight en Excel.</span><span class="sxs-lookup"><span data-stu-id="06c75-148">In this article, you learned how toouse Power Query tooretrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="06c75-149">Del mismo modo, puede recuperar datos de HDInsight en Base de datos SQL de Azure.</span><span class="sxs-lookup"><span data-stu-id="06c75-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="06c75-150">También es datos de posibles tooupload en HDInsight.</span><span class="sxs-lookup"><span data-stu-id="06c75-150">It is also possible tooupload data into HDInsight.</span></span> <span data-ttu-id="06c75-151">toolearn más información, vea Hola siguientes artículos:</span><span class="sxs-lookup"><span data-stu-id="06c75-151">toolearn more, see hello following articles:</span></span>

* <span data-ttu-id="06c75-152">[Conectar Excel tooHDInsight con hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="06c75-152">[Connect Excel tooHDInsight with hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="06c75-153">[Cargar datos tooHDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="06c75-153">[Upload Data tooHDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
