---
title: Unido aaaDomain arquitectura de HDInsight de Azure | Documentos de Microsoft
description: "Obtenga información acerca de cómo tooplan Unidos al dominio HDInsight."
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 1c3ecedf3739b4f8fa54160225be9c1d6e2ca6cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="ce49f-103">Planeamiento de clústeres de Hadoop unidos a un dominio de Azure en HDInsight</span><span class="sxs-lookup"><span data-stu-id="ce49f-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="ce49f-104">Hello Hadoop tradicional es un clúster de usuario único.</span><span class="sxs-lookup"><span data-stu-id="ce49f-104">hello traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="ce49f-105">Es apropiado para la mayor parte de las empresas que tienen equipos de aplicaciones pequeños que generan grandes cargas de trabajo de datos.</span><span class="sxs-lookup"><span data-stu-id="ce49f-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="ce49f-106">A medida que aumenta la popularidad de Hadoop, muchas empresas empiezan a usar un modelo en el que los equipos de TI administran clústeres y varios equipos de aplicaciones comparten los clústeres.</span><span class="sxs-lookup"><span data-stu-id="ce49f-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="ce49f-107">Por lo tanto, las funcionalidades de clústeres multiusuario que implica que se encuentran entre Hola más solicitadas funcionalidades de HDInsight de Azure.</span><span class="sxs-lookup"><span data-stu-id="ce49f-107">Thus, functionalities involving multiuser clusters are among hello most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="ce49f-108">En lugar de generar su propia autenticación multiusuario y la autorización, HDInsight se basa en el proveedor de identidades de más popular de hello--Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="ce49f-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on hello most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="ce49f-109">funcionalidad de seguridad eficaz de Hello en AD puede ser usado toomanage autorización multiusuario en HDInsight.</span><span class="sxs-lookup"><span data-stu-id="ce49f-109">hello powerful security functionality in AD can be used toomanage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="ce49f-110">Mediante la integración de HDInsight con AD, puede comunicarse con los clústeres de hello mediante las credenciales de AD.</span><span class="sxs-lookup"><span data-stu-id="ce49f-110">By integrating HDInsight with AD, you can communicate with hello clusters by using your AD credentials.</span></span> <span data-ttu-id="ce49f-111">HDInsight asigna un usuario tooa local Hadoop usuario de AD, por lo que todos los servicios que se ejecutan en HDInsight de Hola (Ambari, Hive thrift de Spark de servidor, Cazador, servidor etc.) funcionan sin problemas para usuario autenticado de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-111">HDInsight maps an AD user tooa local Hadoop user, so all hello services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for hello authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="ce49f-112">Integración de HDInsight con AD y AD en la máquina virtual de IaaS</span><span class="sxs-lookup"><span data-stu-id="ce49f-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="ce49f-113">Mediante la integración de HDInsight con Azure AD o AD en VM de Iaas, nodos de clúster de HDInsight de hello son dominio tooa Unidos a un dominio.</span><span class="sxs-lookup"><span data-stu-id="ce49f-113">By integrating HDInsight with Azure AD or AD on Iaas VM, hello HDInsight cluster nodes are domain-joined tooa domain.</span></span> <span data-ttu-id="ce49f-114">HDInsight crea a entidades de servicio para hello Hadoop servicios que se ejecutan en el clúster de Hola y las coloca en una unidad organizativa especificada (OU) en Azure AD o AD en VM de IaaS.</span><span class="sxs-lookup"><span data-stu-id="ce49f-114">HDInsight creates service principals for hello Hadoop services running on hello cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="ce49f-115">HDInsight también crea asignaciones de DNS inversas en dominio de Hola para hello direcciones IP de los nodos de Hola que están toohello Unidos a un dominio.</span><span class="sxs-lookup"><span data-stu-id="ce49f-115">HDInsight also creates reverse DNS mappings in hello domain for hello IP addresses of hello nodes that are joined toohello domain.</span></span>

<span data-ttu-id="ce49f-116">Esta configuración se puede lograr mediante el uso de varias arquitecturas.</span><span class="sxs-lookup"><span data-stu-id="ce49f-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="ce49f-117">Puede elegir entre Hola después de arquitecturas.</span><span class="sxs-lookup"><span data-stu-id="ce49f-117">You can choose from hello following architectures.</span></span>

<span data-ttu-id="ce49f-118">**HDInsight integrado con AD que se ejecuta en Azure IaaS**</span><span class="sxs-lookup"><span data-stu-id="ce49f-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="ce49f-119">Se trata de una arquitectura más sencilla de Hola para integrar HDInsight con Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ce49f-119">This is hello simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="ce49f-120">Hola controlador de dominio de AD se ejecuta en uno (o varias) máquinas virtuales (VM) en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce49f-120">hello AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="ce49f-121">Normalmente, estas máquinas virtuales se encuentran en una red virtual.</span><span class="sxs-lookup"><span data-stu-id="ce49f-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="ce49f-122">Configure otra red virtual de clúster de HDInsight Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-122">You set up another virtual network for hello HDInsight cluster.</span></span> <span data-ttu-id="ce49f-123">Para un directorio de línea de visión tooActive de HDInsight toohave, necesita toopeer estas redes virtuales mediante el uso de [emparejamiento de VNet a VNet](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="ce49f-123">For HDInsight toohave a line of sight tooActive Directory, you need toopeer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="ce49f-124">Si crea Hola Active Directory en ARM, a continuación, puede crear Hola Active Directory y HDInsight en Hola misma red virtual y no es necesario toodo emparejamiento.</span><span class="sxs-lookup"><span data-stu-id="ce49f-124">If you create hello Active Directory in ARM, then you can create hello Active Directory and HDInsight in hello same VNet and you don't need toodo peering.</span></span> 

![Topología de clúster de HDInsight de unión a dominio](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="ce49f-126">En esta arquitectura, no puede usar el almacén de Azure Data Lake con clúster de HDInsight Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-126">In this architecture, you cannot use Azure Data Lake Store with hello HDInsight cluster.</span></span>


<span data-ttu-id="ce49f-127">Requisitos previos de Active Directory:</span><span class="sxs-lookup"><span data-stu-id="ce49f-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="ce49f-128">Un [unidad organizativa](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) deben crearse, que se coloca dentro de máquinas virtuales de clúster de HDInsight de Hola y Hola entidades de servicio utilizadas por el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="ce49f-129">[Protocolo ligero de acceso a directorios](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAP) debe configurarse para comunicarse con AD.</span><span class="sxs-lookup"><span data-stu-id="ce49f-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="ce49f-130">Hola tooset de certificado que se usa seguridad LDAPS debe ser un certificado real (no un certificado autofirmado).</span><span class="sxs-lookup"><span data-stu-id="ce49f-130">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="ce49f-131">Las zonas DNS inversas deben crearse en el dominio de hello para el intervalo de direcciones IP de Hola de subred de HDInsight de hello (por ejemplo, 10.2.0.0/24 en la imagen anterior de hello).</span><span class="sxs-lookup"><span data-stu-id="ce49f-131">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="ce49f-132">Se necesita una cuenta de servicio o una cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="ce49f-132">A service account or a user account is needed.</span></span> <span data-ttu-id="ce49f-133">Utilice este clúster de HDInsight de cuenta toocreate Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-133">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="ce49f-134">Esta cuenta debe tener los siguientes permisos de hello:</span><span class="sxs-lookup"><span data-stu-id="ce49f-134">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="ce49f-135">Objetos de entidad de servicio de toocreate de permisos y objetos de equipo dentro de la unidad organizativa de Hola</span><span class="sxs-lookup"><span data-stu-id="ce49f-135">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="ce49f-136">Reglas de proxy DNS inversas de permisos toocreate</span><span class="sxs-lookup"><span data-stu-id="ce49f-136">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="ce49f-137">Dominio de Active Directory de permisos toojoin máquinas toohello</span><span class="sxs-lookup"><span data-stu-id="ce49f-137">Permissions toojoin machines toohello Active Directory domain</span></span>

<span data-ttu-id="ce49f-138">**HDInsight integrado con una instancia de Azure AD solo en la nube**</span><span class="sxs-lookup"><span data-stu-id="ce49f-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="ce49f-139">Para una instancia de Azure AD solo en la nube, configure un controlador de dominio para que HDInsight se pueda integrar con Azure AD.</span><span class="sxs-lookup"><span data-stu-id="ce49f-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="ce49f-140">Esto se logra mediante el uso de [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="ce49f-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="ce49f-141">Azure AD DS crea máquinas de controlador de dominio en la nube de Hola y proporciona las direcciones IP para ellos.</span><span class="sxs-lookup"><span data-stu-id="ce49f-141">Azure AD DS creates domain controller machines on hello cloud and provides IP addresses for them.</span></span> <span data-ttu-id="ce49f-142">Crea dos controladores de dominio para lograr alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="ce49f-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="ce49f-143">Actualmente, Azure AD DS solo existe en redes virtuales clásicas.</span><span class="sxs-lookup"><span data-stu-id="ce49f-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="ce49f-144">Solo es accesible mediante el uso de hello portal de Azure clásico.</span><span class="sxs-lookup"><span data-stu-id="ce49f-144">It is only accessible by using hello Azure classic portal.</span></span> <span data-ttu-id="ce49f-145">Hola HDInsight red virtual existe en el portal de Azure, que debe toobe Hola emparejar con la red virtual clásica de hello mediante el uso de intercambio de tráfico de red virtual a red virtual.</span><span class="sxs-lookup"><span data-stu-id="ce49f-145">hello HDInsight virtual network exists in hello Azure portal, which needs toobe peered with hello classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="ce49f-146">Emparejamiento entre una red virtual clásica y red virtual requiere que ambas redes virtuales están en un administrador de recursos de Azure Hola la misma región y en Hola misma suscripción de Azure.</span><span class="sxs-lookup"><span data-stu-id="ce49f-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in hello same region and under hello same Azure subscription.</span></span>

![Topología de clúster de HDInsight de unión a dominio](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="ce49f-148">Requisitos previos de Azure AD:</span><span class="sxs-lookup"><span data-stu-id="ce49f-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="ce49f-149">Un [unidad organizativa](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) deben crearse dentro de la que colocar máquinas virtuales del clúster de HDInsight de Hola y Hola entidades de servicio utilizadas por el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="ce49f-150">Al configurar Azure AD DS, se debe configurar [LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md).</span><span class="sxs-lookup"><span data-stu-id="ce49f-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="ce49f-151">Hola tooset de certificado que se usa seguridad LDAPS debe ser un certificado real (no un certificado autofirmado).</span><span class="sxs-lookup"><span data-stu-id="ce49f-151">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="ce49f-152">Las zonas DNS inversas deben crearse en el dominio de hello para el intervalo de direcciones IP de Hola de subred de HDInsight de hello (por ejemplo, 10.2.0.0/24 en la imagen anterior de hello).</span><span class="sxs-lookup"><span data-stu-id="ce49f-152">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="ce49f-153">[Hash de contraseña](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) deben sincronizarse desde Azure AD tooAzure AD DS.</span><span class="sxs-lookup"><span data-stu-id="ce49f-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD tooAzure AD DS.</span></span>
* <span data-ttu-id="ce49f-154">Se necesita una cuenta de servicio o una cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="ce49f-154">A service account or a user account is needed.</span></span> <span data-ttu-id="ce49f-155">Utilice este clúster de HDInsight de cuenta toocreate Hola.</span><span class="sxs-lookup"><span data-stu-id="ce49f-155">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="ce49f-156">Esta cuenta debe tener los siguientes permisos de hello:</span><span class="sxs-lookup"><span data-stu-id="ce49f-156">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="ce49f-157">Objetos de entidad de servicio de toocreate de permisos y objetos de equipo dentro de la unidad organizativa de Hola</span><span class="sxs-lookup"><span data-stu-id="ce49f-157">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="ce49f-158">Reglas de proxy DNS inversas de permisos toocreate</span><span class="sxs-lookup"><span data-stu-id="ce49f-158">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="ce49f-159">Dominio de permisos toojoin máquinas toohello Azure AD</span><span class="sxs-lookup"><span data-stu-id="ce49f-159">Permissions toojoin machines toohello Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="ce49f-160">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="ce49f-160">Next steps</span></span>
* <span data-ttu-id="ce49f-161">tooconfigure un clúster de HDInsight Unidos a un dominio, consulte [configurar clústeres de HDInsight Unidos al dominio](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="ce49f-161">tooconfigure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="ce49f-162">clústeres de HDInsight Unidos a un dominio de toomanage, consulte [administrar clústeres de HDInsight Unidos al dominio](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="ce49f-162">toomanage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="ce49f-163">directivas de Hive tooconfigure y ejecución de las consultas de Hive, consulte [Hive configurar directivas para clústeres de HDInsight Unidos al dominio](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="ce49f-163">tooconfigure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="ce49f-164">consultas de Hive toorun a través de SSH en clústeres de HDInsight Unidos a un dominio, consulte [utilizar SSH con HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="ce49f-164">toorun Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
