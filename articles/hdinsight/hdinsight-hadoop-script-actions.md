---
title: "desarrollo de la acción con HDInsight - Azure aaaScript | Documentos de Microsoft"
description: "Obtenga información acerca de cómo toocustomize Hadoop clústeres con la acción de secuencia de comandos. Acción de secuencia de comandos puede ser usado tooinstall software adicional con una configuración de Hola de clúster o toochange de Hadoop de las aplicaciones instaladas en un clúster."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 836d68a8-8b21-4d69-8b61-281a7fe67f21
ms.service: hdinsight
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/25/2017
ms.author: jgao
ROBOTS: NOINDEX
ms.openlocfilehash: 4fc3a389df8a003f7129ab00b4cd9bc7ad81a419
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="develop-script-action-scripts-for-hdinsight-windows-based-clusters"></a><span data-ttu-id="d0cae-104">Desarrollo de acciones de script para clústeres basados en Windows de HDInsight</span><span class="sxs-lookup"><span data-stu-id="d0cae-104">Develop Script Action scripts for HDInsight Windows-based clusters</span></span>
<span data-ttu-id="d0cae-105">Obtenga información acerca de cómo toowrite acción de secuencia de comandos de las secuencias de comandos para HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d0cae-105">Learn how toowrite Script Action scripts for HDInsight.</span></span> <span data-ttu-id="d0cae-106">Para obtener más información acerca del uso de acciones de script, vea [Personalización de un clúster de HDInsight mediante la acción de script](hdinsight-hadoop-customize-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-106">For information on using Script Action scripts, see [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md).</span></span> <span data-ttu-id="d0cae-107">Hola mismo artículo escrito para clústeres de HDInsight basados en Linux, encontrará [secuencias de comandos de acción de secuencia de comandos de desarrollar para HDInsight](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-107">For hello same article written for Linux-based HDInsight clusters, see [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions-linux.md).</span></span>



> [!IMPORTANT]
> <span data-ttu-id="d0cae-108">Hola pasos de este trabajo sólo de documento para clústeres de HDInsight basados en Windows.</span><span class="sxs-lookup"><span data-stu-id="d0cae-108">hello steps in this document only work for Windows-based HDInsight clusters.</span></span> <span data-ttu-id="d0cae-109">HDInsight solo está disponible en Windows en versiones inferiores a la 3.4.</span><span class="sxs-lookup"><span data-stu-id="d0cae-109">HDInsight is only available on Windows for versions lower than HDInsight 3.4.</span></span> <span data-ttu-id="d0cae-110">Linux es Hola único sistema operativo usado en HDInsight versión 3.4 o superior.</span><span class="sxs-lookup"><span data-stu-id="d0cae-110">Linux is hello only operating system used on HDInsight version 3.4 or greater.</span></span> <span data-ttu-id="d0cae-111">Consulte la información sobre la [retirada de HDInsight en Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span><span class="sxs-lookup"><span data-stu-id="d0cae-111">For more information, see [HDInsight retirement on Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span></span> <span data-ttu-id="d0cae-112">Para obtener información sobre el uso de las acciones de script con clústeres basados en Linux, consulte [Desarrollo de la acción de script con HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-112">For information on using script actions with Linux-based clusters, see [Script action development with HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span></span>
>
>



<span data-ttu-id="d0cae-113">Acción de secuencia de comandos puede ser usado tooinstall software adicional con una configuración de Hola de clúster o toochange de Hadoop de las aplicaciones instaladas en un clúster.</span><span class="sxs-lookup"><span data-stu-id="d0cae-113">Script Action can be used tooinstall additional software running on a Hadoop cluster or toochange hello configuration of applications installed on a cluster.</span></span> <span data-ttu-id="d0cae-114">Las acciones de script son scripts que se ejecutan en nodos de clúster de hello cuando se implementan clústeres de HDInsight, y se ejecutan una vez que los nodos de clúster de hello completar configuración de HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d0cae-114">Script actions are scripts that run on hello cluster nodes when HDInsight clusters are deployed, and they are executed once nodes in hello cluster complete HDInsight configuration.</span></span> <span data-ttu-id="d0cae-115">Una acción de secuencia de comandos se ejecuta con privilegios de cuenta de administrador de sistema y proporciona nodos de clúster de toohello de derechos de acceso completo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-115">A script action is executed under system admin account privileges and provides full access rights toohello cluster nodes.</span></span> <span data-ttu-id="d0cae-116">Cada clúster puede proporcionarse con una lista de toobe de acciones de script ejecutado en orden de hello en el que se especifican.</span><span class="sxs-lookup"><span data-stu-id="d0cae-116">Each cluster can be provided with a list of script actions toobe executed in hello order in which they are specified.</span></span>

> [!NOTE]
> <span data-ttu-id="d0cae-117">Si experimenta Hola mensaje de error siguiente:</span><span class="sxs-lookup"><span data-stu-id="d0cae-117">If you experience hello following error message:</span></span>
>
> <span data-ttu-id="d0cae-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage: Hola término 'Guardar-HDIFile' no se reconoce como nombre de Hola de cmdlet, función, archivo de script o programa ejecutable.</span><span class="sxs-lookup"><span data-stu-id="d0cae-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage : hello term 'Save-HDIFile' is not recognized as hello name of a cmdlet, function, script file, or operable program.</span></span> <span data-ttu-id="d0cae-119">Revisar la ortografía de hello del nombre de hello, o si incluyó una ruta de acceso, compruebe que dicha ruta de acceso de hello es correcta e inténtelo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-119">Check hello spelling of hello name, or if a path was included, verify that hello path is correct and try again.</span></span>
> <span data-ttu-id="d0cae-120">Es porque no incluyen métodos auxiliares de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-120">It is because you didn't include hello helper methods.</span></span>  <span data-ttu-id="d0cae-121">Vea [Métodos auxiliares para scripts personalizados](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span><span class="sxs-lookup"><span data-stu-id="d0cae-121">See [Helper methods for custom scripts](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span></span>
>
>

## <a name="sample-scripts"></a><span data-ttu-id="d0cae-122">Scripts de ejemplo</span><span class="sxs-lookup"><span data-stu-id="d0cae-122">Sample scripts</span></span>
<span data-ttu-id="d0cae-123">Para crear clústeres de HDInsight en el sistema operativo Windows, Hola acción de secuencia de comandos es el script de PowerShell de Azure.</span><span class="sxs-lookup"><span data-stu-id="d0cae-123">For creating HDInsight clusters on Windows operating system, hello Script Action is Azure PowerShell script.</span></span> <span data-ttu-id="d0cae-124">Hello script siguiente es un ejemplo para configurar los archivos de configuración de sitio de hello:</span><span class="sxs-lookup"><span data-stu-id="d0cae-124">hello following script is a sample for configuring hello site configuration files:</span></span>

[!INCLUDE [upgrade-powershell](../../includes/hdinsight-use-latest-powershell.md)]

    param (
        [parameter(Mandatory)][string] $ConfigFileName,
        [parameter(Mandatory)][string] $Name,
        [parameter(Mandatory)][string] $Value,
        [parameter()][string] $Description
    )

    if (!$Description) {
        $Description = ""
    }

    $hdiConfigFiles = @{
        "hive-site.xml" = "$env:HIVE_HOME\conf\hive-site.xml";
        "core-site.xml" = "$env:HADOOP_HOME\etc\hadoop\core-site.xml";
        "hdfs-site.xml" = "$env:HADOOP_HOME\etc\hadoop\hdfs-site.xml";
        "mapred-site.xml" = "$env:HADOOP_HOME\etc\hadoop\mapred-site.xml";
        "yarn-site.xml" = "$env:HADOOP_HOME\etc\hadoop\yarn-site.xml"
    }

    if (!($hdiConfigFiles[$ConfigFileName])) {
        Write-HDILog "Unable tooconfigure $ConfigFileName because it is not part of hello HDI configuration files."
        return
    }

    [xml]$configFile = Get-Content $hdiConfigFiles[$ConfigFileName]

    $existingproperty = $configFile.configuration.property | where {$_.Name -eq $Name}

    if ($existingproperty) {
        $existingproperty.Value = $Value
        $existingproperty.Description = $Description
    } else {
        $newproperty = @($configFile.configuration.property)[0].Clone()
        $newproperty.Name = $Name
        $newproperty.Value = $Value
        $newproperty.Description = $Description
        $configFile.configuration.AppendChild($newproperty)
    }

    $configFile.Save($hdiConfigFiles[$ConfigFileName])

    Write-HDILog "$configFileName has been configured."

<span data-ttu-id="d0cae-125">script de Hola toma cuatro parámetros, nombre de archivo de configuración de hello, propiedad de Hola que desee toomodify, valor de Hola que desee tooset y una descripción.</span><span class="sxs-lookup"><span data-stu-id="d0cae-125">hello script takes four parameters, hello configuration file name, hello property you want toomodify, hello value you want tooset, and a description.</span></span> <span data-ttu-id="d0cae-126">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d0cae-126">For example:</span></span>

    hive-site.xml hive.metastore.client.socket.timeout 90

<span data-ttu-id="d0cae-127">Estos parámetros se establece hello hive.metastore.client.socket.timeout valor too90 en el archivo de hive-site.xml hello.</span><span class="sxs-lookup"><span data-stu-id="d0cae-127">These parameters sets hello hive.metastore.client.socket.timeout value too90 in hello hive-site.xml file.</span></span>  <span data-ttu-id="d0cae-128">valor de Hello predeterminado es 60 segundos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-128">hello default value is 60 seconds.</span></span>

<span data-ttu-id="d0cae-129">Este script de ejemplo se puede encontrar también en [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span><span class="sxs-lookup"><span data-stu-id="d0cae-129">This sample script can also be found at [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span></span>

<span data-ttu-id="d0cae-130">HDInsight proporciona varias secuencias de comandos tooinstall de componentes adicionales en clústeres de HDInsight:</span><span class="sxs-lookup"><span data-stu-id="d0cae-130">HDInsight provides several scripts tooinstall additional components on HDInsight clusters:</span></span>

| <span data-ttu-id="d0cae-131">Nombre</span><span class="sxs-lookup"><span data-stu-id="d0cae-131">Name</span></span> | <span data-ttu-id="d0cae-132">Script</span><span class="sxs-lookup"><span data-stu-id="d0cae-132">Script</span></span> |
| --- | --- |
| <span data-ttu-id="d0cae-133">**Instalar Spark**</span><span class="sxs-lookup"><span data-stu-id="d0cae-133">**Install Spark**</span></span> |<span data-ttu-id="d0cae-134">https://hdiconfigactions.blob.core.windows.net/sparkconfigactionv03/spark-installer-v03.ps1.</span><span class="sxs-lookup"><span data-stu-id="d0cae-134">https://hdiconfigactions.blob.core.windows.net/sparkconfigactionv03/spark-installer-v03.ps1.</span></span> <span data-ttu-id="d0cae-135">Vea [Instalación y uso de Spark en clústeres de HDInsight][hdinsight-install-spark].</span><span class="sxs-lookup"><span data-stu-id="d0cae-135">See [Install and use Spark on HDInsight clusters][hdinsight-install-spark].</span></span> |
| <span data-ttu-id="d0cae-136">**Instalar R**</span><span class="sxs-lookup"><span data-stu-id="d0cae-136">**Install R**</span></span> |<span data-ttu-id="d0cae-137">https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1.</span><span class="sxs-lookup"><span data-stu-id="d0cae-137">https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1.</span></span> <span data-ttu-id="d0cae-138">Consulte [Instalación y uso de R en clústeres de HDInsight][hdinsight-r-scripts].</span><span class="sxs-lookup"><span data-stu-id="d0cae-138">See [Install and use R on HDInsight clusters][hdinsight-r-scripts].</span></span> |
| <span data-ttu-id="d0cae-139">**Instalar Solr**</span><span class="sxs-lookup"><span data-stu-id="d0cae-139">**Install Solr**</span></span> |<span data-ttu-id="d0cae-140">https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="d0cae-140">https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1.</span></span> <span data-ttu-id="d0cae-141">Vea [Instalación y uso de Solr en clústeres de HDInsight](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-141">See [Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span> |
| <span data-ttu-id="d0cae-142">- **Instalar Giraph**</span><span class="sxs-lookup"><span data-stu-id="d0cae-142">- **Install Giraph**</span></span> |<span data-ttu-id="d0cae-143">https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="d0cae-143">https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1.</span></span> <span data-ttu-id="d0cae-144">Vea [Instalación y uso de Giraph en clústeres de HDInsight](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-144">See [Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span> |

<span data-ttu-id="d0cae-145">Acción de secuencia de comandos se puede implementar de hello portal de Azure, Azure PowerShell o mediante el uso de Hola HDInsight .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="d0cae-145">Script Action can be deployed from hello Azure portal, Azure PowerShell or by using hello HDInsight .NET SDK.</span></span>  <span data-ttu-id="d0cae-146">Para obtener más información, consulte [Personalización de un clúster de HDInsight mediante la acción de script][hdinsight-cluster-customize].</span><span class="sxs-lookup"><span data-stu-id="d0cae-146">For more information, see [Customize HDInsight clusters using Script Action][hdinsight-cluster-customize].</span></span>

> [!NOTE]
> <span data-ttu-id="d0cae-147">las secuencias de comandos de ejemplo de Hola trabajar solo con la versión de clúster de HDInsight 3.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="d0cae-147">hello sample scripts work only with HDInsight cluster version 3.1 or above.</span></span> <span data-ttu-id="d0cae-148">Para obtener más información acerca de las versiones de clústeres de HDInsight, consulte las [versiones de clústeres de HDInsight](hdinsight-component-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-148">For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).</span></span>
>
>

## <a name="helper-methods-for-custom-scripts"></a><span data-ttu-id="d0cae-149">Métodos auxiliares para scripts personalizados</span><span class="sxs-lookup"><span data-stu-id="d0cae-149">Helper methods for custom scripts</span></span>
<span data-ttu-id="d0cae-150">Los métodos auxiliares de la acción de script son utilidades que puede usar al escribir scripts personalizados.</span><span class="sxs-lookup"><span data-stu-id="d0cae-150">Script Action helper methods are utilities that you can use while writing custom scripts.</span></span> <span data-ttu-id="d0cae-151">Estos métodos se definen en [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1)y puede incluirse en las secuencias de comandos mediante el siguiente ejemplo de Hola:</span><span class="sxs-lookup"><span data-stu-id="d0cae-151">These methods are defined in [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1), and can be included in your scripts using hello following sample:</span></span>

    # Download config action module from a well-known directory.
    $CONFIGACTIONURI = "https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1";
    $CONFIGACTIONMODULE = "C:\apps\dist\HDInsightUtilities.psm1";
    $webclient = New-Object System.Net.WebClient;
    $webclient.DownloadFile($CONFIGACTIONURI, $CONFIGACTIONMODULE);

    # (TIP) Import config action helper method module toomake writing config action easy.
    if (Test-Path ($CONFIGACTIONMODULE))
    {
        Import-Module $CONFIGACTIONMODULE;
    }
    else
    {
        Write-Output "Failed tooload HDInsightUtilities module, exiting ...";
        exit;
    }

<span data-ttu-id="d0cae-152">Estos son los métodos auxiliares de Hola que se proporcionan con esta secuencia de comandos:</span><span class="sxs-lookup"><span data-stu-id="d0cae-152">Here are hello helper methods that are provided by this script:</span></span>

| <span data-ttu-id="d0cae-153">Método auxiliar</span><span class="sxs-lookup"><span data-stu-id="d0cae-153">Helper method</span></span> | <span data-ttu-id="d0cae-154">Description</span><span class="sxs-lookup"><span data-stu-id="d0cae-154">Description</span></span> |
| --- | --- |
| <span data-ttu-id="d0cae-155">**Save-HDIFile**</span><span class="sxs-lookup"><span data-stu-id="d0cae-155">**Save-HDIFile**</span></span> |<span data-ttu-id="d0cae-156">Descarga un archivo de hello Especifica ubicación tooa de identificador uniforme de recursos (URI) en el disco local de Hola que está asociado con hello Azure VM nodo toohello asignado clúster.</span><span class="sxs-lookup"><span data-stu-id="d0cae-156">Download a file from hello specified Uniform Resource Identifier (URI) tooa location on hello local disk that is associated with hello Azure VM node assigned toohello cluster.</span></span> |
| <span data-ttu-id="d0cae-157">**Expand-HDIZippedFile**</span><span class="sxs-lookup"><span data-stu-id="d0cae-157">**Expand-HDIZippedFile**</span></span> |<span data-ttu-id="d0cae-158">Descomprimir un archivo comprimido.</span><span class="sxs-lookup"><span data-stu-id="d0cae-158">Unzip a zipped file.</span></span> |
| <span data-ttu-id="d0cae-159">**Invoke-HDICmdScript**</span><span class="sxs-lookup"><span data-stu-id="d0cae-159">**Invoke-HDICmdScript**</span></span> |<span data-ttu-id="d0cae-160">Ejecutar un script desde cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="d0cae-160">Run a script from cmd.exe.</span></span> |
| <span data-ttu-id="d0cae-161">**Write-HDILog**</span><span class="sxs-lookup"><span data-stu-id="d0cae-161">**Write-HDILog**</span></span> |<span data-ttu-id="d0cae-162">Escribe un resultado de script personalizado de hello utilizado para una acción de secuencia de comandos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-162">Write output from hello custom script used for a script action.</span></span> |
| <span data-ttu-id="d0cae-163">**Get-Services**</span><span class="sxs-lookup"><span data-stu-id="d0cae-163">**Get-Services**</span></span> |<span data-ttu-id="d0cae-164">Obtener una lista de servicios que se ejecutan en el equipo de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-164">Get a list of services running on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-165">**Get-Service**</span><span class="sxs-lookup"><span data-stu-id="d0cae-165">**Get-Service**</span></span> |<span data-ttu-id="d0cae-166">Con el nombre de servicio específico de hello como entrada, obtener información detallada sobre un servicio específico (el nombre del servicio, procesar el identificador, estado, etc.) en la máquina de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-166">With hello specific service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-167">**Get-HDIServices**</span><span class="sxs-lookup"><span data-stu-id="d0cae-167">**Get-HDIServices**</span></span> |<span data-ttu-id="d0cae-168">Obtener una lista de servicios de HDInsight que se ejecutan en el equipo de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-168">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-169">**Get-HDIService**</span><span class="sxs-lookup"><span data-stu-id="d0cae-169">**Get-HDIService**</span></span> |<span data-ttu-id="d0cae-170">Con hello HDInsight servicio nombre específico como entrada, obtener información detallada sobre un servicio específico (el nombre del servicio, procesar el identificador, estado, etc.) en la máquina de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-170">With hello specific HDInsight service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-171">**Get-ServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="d0cae-171">**Get-ServicesRunning**</span></span> |<span data-ttu-id="d0cae-172">Obtener una lista de servicios que se ejecutan en el equipo de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-172">Get a list of services that are running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-173">**Get-ServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="d0cae-173">**Get-ServiceRunning**</span></span> |<span data-ttu-id="d0cae-174">Compruebe si está ejecutando un servicio específico (por nombre) en el equipo de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-174">Check if a specific service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-175">**Get-HDIServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="d0cae-175">**Get-HDIServicesRunning**</span></span> |<span data-ttu-id="d0cae-176">Obtener una lista de servicios de HDInsight que se ejecutan en el equipo de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-176">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-177">**Get-HDIServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="d0cae-177">**Get-HDIServiceRunning**</span></span> |<span data-ttu-id="d0cae-178">Compruebe si está ejecutando un servicio HDInsight específico (por nombre) en el equipo de Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-178">Check if a specific HDInsight service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-179">**Get-HDIHadoopVersion**</span><span class="sxs-lookup"><span data-stu-id="d0cae-179">**Get-HDIHadoopVersion**</span></span> |<span data-ttu-id="d0cae-180">Obtener la versión de Hola de Hadoop instalado en equipo Hola donde se ejecuta el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-180">Get hello version of Hadoop installed on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="d0cae-181">**Test-IsHDIHeadNode**</span><span class="sxs-lookup"><span data-stu-id="d0cae-181">**Test-IsHDIHeadNode**</span></span> |<span data-ttu-id="d0cae-182">Comprobar si el equipo de Hola donde se ejecuta el script de Hola es un nodo principal.</span><span class="sxs-lookup"><span data-stu-id="d0cae-182">Check if hello computer where hello script executes is a head node.</span></span> |
| <span data-ttu-id="d0cae-183">**Test-IsActiveHDIHeadNode**</span><span class="sxs-lookup"><span data-stu-id="d0cae-183">**Test-IsActiveHDIHeadNode**</span></span> |<span data-ttu-id="d0cae-184">Compruebe si el equipo Hola donde se ejecuta el script de Hola es un nodo principal activo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-184">Check if hello computer where hello script executes is an active head node.</span></span> |
| <span data-ttu-id="d0cae-185">**Test-IsHDIDataNode**</span><span class="sxs-lookup"><span data-stu-id="d0cae-185">**Test-IsHDIDataNode**</span></span> |<span data-ttu-id="d0cae-186">Compruebe si el equipo Hola donde se ejecuta el script de Hola es un nodo de datos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-186">Check if hello computer where hello script executes is a data node.</span></span> |
| <span data-ttu-id="d0cae-187">**Edit-HDIConfigFile**</span><span class="sxs-lookup"><span data-stu-id="d0cae-187">**Edit-HDIConfigFile**</span></span> |<span data-ttu-id="d0cae-188">Editar archivos de configuración de hello hive-site.xml, core-site.xml, hdfs-site.xml, mapred-site.xml o yarn-site.xml.</span><span class="sxs-lookup"><span data-stu-id="d0cae-188">Edit hello config files hive-site.xml, core-site.xml, hdfs-site.xml, mapred-site.xml, or yarn-site.xml.</span></span> |

## <a name="best-practices-for-script-development"></a><span data-ttu-id="d0cae-189">Prácticas recomendadas para el desarrollo de script</span><span class="sxs-lookup"><span data-stu-id="d0cae-189">Best practices for script development</span></span>
<span data-ttu-id="d0cae-190">Al desarrollar un script personalizado para un clúster de HDInsight, hay varios tookeep prácticas recomendadas en cuenta:</span><span class="sxs-lookup"><span data-stu-id="d0cae-190">When you develop a custom script for an HDInsight cluster, there are several best practices tookeep in mind:</span></span>

* <span data-ttu-id="d0cae-191">Busque la versión de Hadoop de Hola</span><span class="sxs-lookup"><span data-stu-id="d0cae-191">Check for hello Hadoop version</span></span>

    <span data-ttu-id="d0cae-192">HDInsight sólo la versión 3.1 (Hadoop 2.4) y versiones posteriores de compatibilidad con componentes personalizados de tooinstall de acción de secuencia de comandos en un clúster.</span><span class="sxs-lookup"><span data-stu-id="d0cae-192">Only HDInsight version 3.1 (Hadoop 2.4) and above support using Script Action tooinstall custom components on a cluster.</span></span> <span data-ttu-id="d0cae-193">En el script personalizado, debe usar hello **HDIHadoopVersion Get** versión auxiliar método toocheck hello Hadoop antes de continuar con la realización de otras tareas en el script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-193">In your custom script, you must use hello **Get-HDIHadoopVersion** helper method toocheck hello Hadoop version before proceeding with performing other tasks in hello script.</span></span>
* <span data-ttu-id="d0cae-194">Proporcionar estable vincula tooscript recursos</span><span class="sxs-lookup"><span data-stu-id="d0cae-194">Provide stable links tooscript resources</span></span>

    <span data-ttu-id="d0cae-195">Los usuarios deben asegurarse de que todos los scripts de Hola y otros artefactos que se utiliza en la personalización de Hola de un clúster siguen estando disponibles a lo largo de la duración de Hola de clúster de Hola y que las versiones de Hola de estos archivos no cambian durante el saludo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-195">Users should make sure that all hello scripts and other artifacts used in hello customization of a cluster remain available throughout hello lifetime of hello cluster and that hello versions of these files do not change for hello duration.</span></span> <span data-ttu-id="d0cae-196">Estos recursos son necesarios si Hola restablecer la imagen inicial de nodos de clúster de hello es necesaria.</span><span class="sxs-lookup"><span data-stu-id="d0cae-196">These resources are required if hello reimaging of nodes in hello cluster is required.</span></span> <span data-ttu-id="d0cae-197">procedimiento recomendado de Hello es toodownload y archivar todo el contenido de una cuenta de almacenamiento que Hola controles de usuario.</span><span class="sxs-lookup"><span data-stu-id="d0cae-197">hello best practice is toodownload and archive everything in a Storage account that hello user controls.</span></span> <span data-ttu-id="d0cae-198">Puede tratarse de cuenta de almacenamiento predeterminada de Hola o cualquiera de las cuentas de almacenamiento adicionales de hello especificadas en tiempo de Hola de implementación para un clúster personalizado.</span><span class="sxs-lookup"><span data-stu-id="d0cae-198">This can be hello default Storage account or any of hello additional Storage accounts specified at hello time of deployment for a customized cluster.</span></span>
    <span data-ttu-id="d0cae-199">Hola Spark R personalizar y ejemplos de clúster proporcionado en la documentación de hello, por ejemplo, hemos realizado una copia local de los recursos de hello en esta cuenta de almacenamiento: https://hdiconfigactions.blob.core.windows.net/.</span><span class="sxs-lookup"><span data-stu-id="d0cae-199">In hello Spark and R customized cluster samples provided in hello documentation, for example, we have made a local copy of hello resources in this Storage account: https://hdiconfigactions.blob.core.windows.net/.</span></span>
* <span data-ttu-id="d0cae-200">Asegúrese de que el script de personalización de clúster de hello es idempotente</span><span class="sxs-lookup"><span data-stu-id="d0cae-200">Ensure that hello cluster customization script is idempotent</span></span>

    <span data-ttu-id="d0cae-201">Debe esperar que los nodos de Hola de un clúster de HDInsight está restableciendo imagen inicial durante la vigencia de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-201">You must expect that hello nodes of an HDInsight cluster is reimaged during hello cluster lifetime.</span></span> <span data-ttu-id="d0cae-202">script de personalización de Hello clúster se ejecuta cada vez que se está restableciendo imagen inicial de un clúster.</span><span class="sxs-lookup"><span data-stu-id="d0cae-202">hello cluster customization script is run whenever a cluster is reimaged.</span></span> <span data-ttu-id="d0cae-203">Esta secuencia de comandos debe ser idempotente toobe diseñado en sentido Hola que tras restablecer la imagen inicial, el script de Hola debe asegurarse de que ese clúster Hola se devuelve toohello que mismo Personalizar estado que se encontraba justo después de script de Hola se ejecutó para hello primera hora en que el clúster de Hola se inicialmente creado.</span><span class="sxs-lookup"><span data-stu-id="d0cae-203">This script must be designed toobe idempotent in hello sense that upon reimaging, hello script should ensure that hello cluster is returned toohello same customized state that it was in just after hello script ran for hello first time when hello cluster was initially created.</span></span> <span data-ttu-id="d0cae-204">Por ejemplo, si un script personalizado instalado una aplicación en D:\AppLocation en su primera ejecución, a continuación, en cada ejecución subsiguiente, tras restaurar, el script de Hola debe comprobar si aplicación hello existe en hello D:\AppLocation ubicación antes de continuar con otro pasos de secuencia de comandos de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-204">For example, if a custom script installed an application at D:\AppLocation on its first run, then on each subsequent run, upon reimaging, hello script should check whether hello application exists at hello D:\AppLocation location before proceeding with other steps in hello script.</span></span>
* <span data-ttu-id="d0cae-205">Instalar componentes personalizados en ubicación óptima Hola</span><span class="sxs-lookup"><span data-stu-id="d0cae-205">Install custom components in hello optimal location</span></span>

    <span data-ttu-id="d0cae-206">Cuando se restablece la imagen inicial nodos del clúster, unidad de recurso de hello C:\ y D:\ unidad del sistema pueden cambiar el formato, lo que causará Hola pérdida de datos y las aplicaciones instaladas de esas unidades.</span><span class="sxs-lookup"><span data-stu-id="d0cae-206">When cluster nodes are reimaged, hello C:\ resource drive and D:\ system drive can be reformatted, resulting in hello loss of data and applications that had been installed on those drives.</span></span> <span data-ttu-id="d0cae-207">Esto también podría ocurrir si un nodo de la máquina virtual de Azure (VM) que forma parte del clúster de hello deja de funcionar y se sustituye por un nuevo nodo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-207">This could also happen if an Azure virtual machine (VM) node that is part of hello cluster goes down and is replaced by a new node.</span></span> <span data-ttu-id="d0cae-208">Puede instalar componentes en hello unidad D:\ o en ubicación de C:\apps hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-208">You can install components on hello D:\ drive or in hello C:\apps location on hello cluster.</span></span> <span data-ttu-id="d0cae-209">Todas las demás ubicaciones en hello unidad C:\ están reservadas.</span><span class="sxs-lookup"><span data-stu-id="d0cae-209">All other locations on hello C:\ drive are reserved.</span></span> <span data-ttu-id="d0cae-210">Especifique la ubicación de Hola donde las aplicaciones o bibliotecas son toobe instalado en el script de personalización de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-210">Specify hello location where applications or libraries are toobe installed in hello cluster customization script.</span></span>
* <span data-ttu-id="d0cae-211">Asegurar la alta disponibilidad de la arquitectura de clúster de Hola</span><span class="sxs-lookup"><span data-stu-id="d0cae-211">Ensure high availability of hello cluster architecture</span></span>

    <span data-ttu-id="d0cae-212">HDInsight tiene una arquitectura activo / pasivo para lograr alta disponibilidad, en que un nodo principal está en modo activo (donde se ejecutan los servicios de HDInsight de hello) y Hola otro nodo principal está en modo de espera (en qué HDInsight no se ejecutan servicios).</span><span class="sxs-lookup"><span data-stu-id="d0cae-212">HDInsight has an active-passive architecture for high availability, in which one head node is in active mode (where hello HDInsight services are running) and hello other head node is in standby mode (in which HDInsight services are not running).</span></span> <span data-ttu-id="d0cae-213">nodos de Hello cambiar entre modos activos y pasivos si se interrumpen servicios HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d0cae-213">hello nodes switch active and passive modes if HDInsight services are interrupted.</span></span> <span data-ttu-id="d0cae-214">Si una acción de secuencia de comandos es servicios tooinstall usado en ambos nodos principales para alta disponibilidad, tenga en cuenta que esa Hola mecanismo de conmutación por error de HDInsight no es capaz de tooautomatically producirá un error de estos servicios instalados por el usuario.</span><span class="sxs-lookup"><span data-stu-id="d0cae-214">If a script action is used tooinstall services on both head nodes for high availability, note that hello HDInsight failover mechanism is not able tooautomatically fail over these user-installed services.</span></span> <span data-ttu-id="d0cae-215">Servicios instalados por el usuario por lo que en HDInsight nodos principales que son esperado toobe de alta disponibilidad deben tener su propio mecanismo de conmutación por error si se encuentra en modo activo / pasivo o estar en modo activo / activo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-215">So user-installed services on HDInsight head nodes that are expected toobe highly available must either have their own failover mechanism if in active-passive mode or be in active-active mode.</span></span>

    <span data-ttu-id="d0cae-216">Se ejecuta un comando de acción de secuencia de comandos de HDInsight en ambos nodos principales al rol de nodo principal de Hola se especifica como un valor en hello *ClusterRoleCollection* parámetro.</span><span class="sxs-lookup"><span data-stu-id="d0cae-216">An HDInsight Script Action command runs on both head nodes when hello head-node role is specified as a value in hello *ClusterRoleCollection* parameter.</span></span> <span data-ttu-id="d0cae-217">Por tanto, cuando diseñe un script personalizado, asegúrese de que el script reconoce esta configuración.</span><span class="sxs-lookup"><span data-stu-id="d0cae-217">So when you design a custom script, make sure that your script is aware of this setup.</span></span> <span data-ttu-id="d0cae-218">No debe encontrarse con problemas donde hello mismos servicios están instalados e iniciados en ambos nodos principales de Hola y terminan compiten entre sí.</span><span class="sxs-lookup"><span data-stu-id="d0cae-218">You should not run into problems where hello same services are installed and started on both of hello head nodes and they end up competing with each other.</span></span> <span data-ttu-id="d0cae-219">Además, tenga en cuenta que se pierdan datos durante el restablecimiento de imagen inicial, por lo que el software instalado mediante una acción de secuencia de comandos tiene toobe toosuch resistente eventos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-219">Also, be aware that data is lost during reimaging, so software installed via Script Action has toobe resilient toosuch events.</span></span> <span data-ttu-id="d0cae-220">Las aplicaciones deben tener toowork diseñada con datos de alta disponibilidad que se distribuyen por varios nodos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-220">Applications should be designed toowork with highly available data that is distributed across many nodes.</span></span> <span data-ttu-id="d0cae-221">Tenga en cuenta que como máximo 1/5 de nodos de hello en un clúster puede restaurarse en hello mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-221">Note that as many as 1/5 of hello nodes in a cluster can be reimaged at hello same time.</span></span>
* <span data-ttu-id="d0cae-222">Configurar el almacenamiento de blobs de Azure de hello componentes personalizados toouse</span><span class="sxs-lookup"><span data-stu-id="d0cae-222">Configure hello custom components toouse Azure Blob storage</span></span>

    <span data-ttu-id="d0cae-223">componentes personalizados de Hola que se instalación en los nodos de clúster de hello podrían tener un toouse de configuración predeterminado almacenamiento de sistema de archivos distribuido de Hadoop (HDFS).</span><span class="sxs-lookup"><span data-stu-id="d0cae-223">hello custom components that you install on hello cluster nodes might have a default configuration toouse Hadoop Distributed File System (HDFS) storage.</span></span> <span data-ttu-id="d0cae-224">Debe cambiar Hola configuración toouse almacenamiento de blobs de Azure en su lugar.</span><span class="sxs-lookup"><span data-stu-id="d0cae-224">You should change hello configuration toouse Azure Blob storage instead.</span></span> <span data-ttu-id="d0cae-225">En un restablecimiento de imagen inicial de clúster, obtiene el formato sistema de archivos HDFS hello y se perderá cualquier dato que se almacena allí.</span><span class="sxs-lookup"><span data-stu-id="d0cae-225">On a cluster reimage, hello HDFS file system gets formatted and you would lose any data that is stored there.</span></span> <span data-ttu-id="d0cae-226">El empleo de Azure Blob Storage garantiza la conservación de los datos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-226">Using Azure Blob storage instead ensures that your data is retained.</span></span>

## <a name="common-usage-patterns"></a><span data-ttu-id="d0cae-227">Patrones de uso común</span><span class="sxs-lookup"><span data-stu-id="d0cae-227">Common usage patterns</span></span>
<span data-ttu-id="d0cae-228">Esta sección proporciona instrucciones sobre cómo implementar algunos Hola patrones de uso comunes que pueden surgir al escribir sus propios scripts personalizados.</span><span class="sxs-lookup"><span data-stu-id="d0cae-228">This section provides guidance on implementing some of hello common usage patterns that you might run into while writing your own custom script.</span></span>

### <a name="configure-environment-variables"></a><span data-ttu-id="d0cae-229">Configuración de las variables de entorno</span><span class="sxs-lookup"><span data-stu-id="d0cae-229">Configure environment variables</span></span>
<span data-ttu-id="d0cae-230">A menudo en el desarrollo de la acción de secuencia de comandos, cree Hola necesita tooset variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="d0cae-230">Often in script action development, you feel hello need tooset environment variables.</span></span> <span data-ttu-id="d0cae-231">Por ejemplo, un escenario más probable es al descargar un archivo binario de un sitio externo, instalarlo en clúster de Hola y agregar ubicación de Hola de donde es variable de entorno 'PATH' tooyour instalado.</span><span class="sxs-lookup"><span data-stu-id="d0cae-231">For instance, a most likely scenario is when you download a binary from an external site, install it on hello cluster, and add hello location of where it is installed tooyour ‘PATH’ environment variable.</span></span> <span data-ttu-id="d0cae-232">Hola siguiente fragmento de código muestra cómo las variables de entorno tooset en Hola script personalizado.</span><span class="sxs-lookup"><span data-stu-id="d0cae-232">hello following snippet shows you how tooset environment variables in hello custom script.</span></span>

    Write-HDILog "Starting environment variable setting at: $(Get-Date)";
    [Environment]::SetEnvironmentVariable('MDS_RUNNER_CUSTOM_CLUSTER', 'true', 'Machine');

<span data-ttu-id="d0cae-233">Esta instrucción establece la variable de entorno de hello **MDS_RUNNER_CUSTOM_CLUSTER** toohello valor 'true' y también establece Hola ámbito de esta variable toobe todo el equipo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-233">This statement sets hello environment variable **MDS_RUNNER_CUSTOM_CLUSTER** toohello value 'true' and also sets hello scope of this variable toobe machine-wide.</span></span> <span data-ttu-id="d0cae-234">A veces es importante que las variables de entorno se establecen en el ámbito adecuado de Hola, equipo o usuario.</span><span class="sxs-lookup"><span data-stu-id="d0cae-234">At times it is important that environment variables are set at hello appropriate scope – machine or user.</span></span> <span data-ttu-id="d0cae-235">Consulte [aquí][1] para obtener más información sobre cómo establecer las variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="d0cae-235">Refer [here][1] for more information on setting environment variables.</span></span>

### <a name="access-toolocations-where-hello-custom-scripts-are-stored"></a><span data-ttu-id="d0cae-236">Toolocations de acceso donde se almacenan los scripts personalizados de Hola</span><span class="sxs-lookup"><span data-stu-id="d0cae-236">Access toolocations where hello custom scripts are stored</span></span>
<span data-ttu-id="d0cae-237">Secuencias de comandos utilizadas toocustomize un tooeither de necesidades del clúster ser en la cuenta de almacenamiento predeterminada de hello para el clúster de Hola o en un contenedor público de solo lectura en ninguna otra cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d0cae-237">Scripts used toocustomize a cluster needs tooeither be in hello default storage account for hello cluster or in a public read-only container on any other storage account.</span></span> <span data-ttu-id="d0cae-238">Si el script tiene acceso a recursos ubicados en otros lugares tienen toobe en accesible públicamente (al menos públicas de solo lectura).</span><span class="sxs-lookup"><span data-stu-id="d0cae-238">If your script accesses resources located elsewhere these need toobe in a publicly accessible (at least public read-only).</span></span> <span data-ttu-id="d0cae-239">Por ejemplo podría desea tooaccess un archivo y guárdelo con hello SaveFile HDI comando.</span><span class="sxs-lookup"><span data-stu-id="d0cae-239">For instance you might want tooaccess a file and save it using hello SaveFile-HDI command.</span></span>

    Save-HDIFile -SrcUri 'https://somestorageaccount.blob.core.windows.net/somecontainer/some-file.jar' -DestFile 'C:\apps\dist\hadoop-2.4.0.2.1.9.0-2196\share\hadoop\mapreduce\some-file.jar'

<span data-ttu-id="d0cae-240">En este ejemplo, debe asegurarse de que el contenedor de hello 'somecontainer' en la cuenta de almacenamiento 'somestorageaccount' es accesible públicamente.</span><span class="sxs-lookup"><span data-stu-id="d0cae-240">In this example, you must ensure that hello container 'somecontainer' in storage account 'somestorageaccount' is publicly accessible.</span></span> <span data-ttu-id="d0cae-241">En caso contrario, el script de Hola produce una excepción 'No se encontró' y producirá un error.</span><span class="sxs-lookup"><span data-stu-id="d0cae-241">Otherwise, hello script throws a ‘Not Found’ exception and fail.</span></span>

### <a name="pass-parameters-toohello-add-azurermhdinsightscriptaction-cmdlet"></a><span data-ttu-id="d0cae-242">Pasar parámetros toohello AzureRmHDInsightScriptAction agregar cmdlet</span><span class="sxs-lookup"><span data-stu-id="d0cae-242">Pass parameters toohello Add-AzureRmHDInsightScriptAction cmdlet</span></span>
<span data-ttu-id="d0cae-243">toopass varios parámetros toohello AzureRmHDInsightScriptAction agregar cmdlet, necesita toocontain del valor de cadena de tooformat Hola todos los parámetros de script de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-243">toopass multiple parameters toohello Add-AzureRmHDInsightScriptAction cmdlet, you need tooformat hello string value toocontain all parameters for hello script.</span></span> <span data-ttu-id="d0cae-244">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d0cae-244">For example:</span></span>

    "-CertifcateUri wasb:///abc.pfx -CertificatePassword 123456 -InstallFolderName MyFolder"

<span data-ttu-id="d0cae-245">o</span><span class="sxs-lookup"><span data-stu-id="d0cae-245">or</span></span>

    $parameters = '-Parameters "{0};{1};{2}"' -f $CertificateName,$certUriWithSasToken,$CertificatePassword


### <a name="throw-exception-for-failed-cluster-deployment"></a><span data-ttu-id="d0cae-246">Inicio de excepción para error en implementación de clúster</span><span class="sxs-lookup"><span data-stu-id="d0cae-246">Throw exception for failed cluster deployment</span></span>
<span data-ttu-id="d0cae-247">Si desea tooget con precisión una notificación del hecho de Hola de dicha personalización de clúster no se realizó correctamente según lo previsto, es importante toothrow una excepción y producirá un error de creación del clúster Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-247">If you want tooget accurately notified of hello fact that cluster customization did not succeed as expected, it is important toothrow an exception and fail hello cluster creation.</span></span> <span data-ttu-id="d0cae-248">Por ejemplo, podría desea tooprocess un archivo si existe y controlar el caso de error de Hola donde archivo hello no existe.</span><span class="sxs-lookup"><span data-stu-id="d0cae-248">For instance, you might want tooprocess a file if it exists and handle hello error case where hello file does not exist.</span></span> <span data-ttu-id="d0cae-249">Esto garantizará que el script de Hola se cierra correctamente y correctamente se conoce el estado de Hola de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-249">This would ensure that hello script exits gracefully and hello state of hello cluster is correctly known.</span></span> <span data-ttu-id="d0cae-250">Hello fragmento de código siguiente proporciona un ejemplo de cómo tooachieve esto:</span><span class="sxs-lookup"><span data-stu-id="d0cae-250">hello following snippet gives an example of how tooachieve this:</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    exit
    }

<span data-ttu-id="d0cae-251">En este fragmento de código, si no existía archivo hello, provocaría tooa estado donde script de Hola realmente se cierra correctamente después de imprimir el mensaje de error de Hola y clúster Hola alcanza el estado de ejecución suponiendo que se "correctamente" completado el proceso de personalización de clústeres.</span><span class="sxs-lookup"><span data-stu-id="d0cae-251">In this snippet, if hello file did not exist, it would lead tooa state where hello script actually exits gracefully after printing hello error message, and hello cluster reaches running state assuming it "successfully" completed cluster customization process.</span></span> <span data-ttu-id="d0cae-252">Si desea toobe con precisión una notificación del hecho de Hola de esa personalización clúster básicamente no se realizó correctamente según lo esperado debido a un archivo que falta, es más adecuado toothrow una excepción y producirá un error de paso de personalización de clústeres de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-252">If you want toobe accurately notified of hello fact that cluster customization essentially did not succeed as expected because of a missing file, it is more appropriate toothrow an exception and fail hello cluster customization step.</span></span> <span data-ttu-id="d0cae-253">tooachieve esto debe usar Hola siguiente fragmento de código de ejemplo en su lugar.</span><span class="sxs-lookup"><span data-stu-id="d0cae-253">tooachieve this you must use hello following sample code snippet instead.</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    throw
    }


## <a name="checklist-for-deploying-a-script-action"></a><span data-ttu-id="d0cae-254">Lista de comprobación para implementar una acción de script</span><span class="sxs-lookup"><span data-stu-id="d0cae-254">Checklist for deploying a script action</span></span>
<span data-ttu-id="d0cae-255">Estos son los pasos de Hola que se llevaron a cabo al preparar toodeploy estas secuencias de comandos:</span><span class="sxs-lookup"><span data-stu-id="d0cae-255">Here are hello steps we took when preparing toodeploy these scripts:</span></span>

1. <span data-ttu-id="d0cae-256">Coloque los archivos de Hola que contienen scripts personalizados de hello en un lugar que sea accesible para nodos de clúster de Hola durante la implementación.</span><span class="sxs-lookup"><span data-stu-id="d0cae-256">Put hello files that contain hello custom scripts in a place that is accessible by hello cluster nodes during deployment.</span></span> <span data-ttu-id="d0cae-257">Esto puede ser cualquiera de predeterminado de Hola o más cuentas de almacenamiento especificadas en tiempo de presentación de la implementación del clúster, o cualquier otro contenedor de almacenamiento accesibles públicamente.</span><span class="sxs-lookup"><span data-stu-id="d0cae-257">This can be any of hello default or additional Storage accounts specified at hello time of cluster deployment, or any other publicly accessible storage container.</span></span>
2. <span data-ttu-id="d0cae-258">Agregar comprobaciones en las secuencias de comandos toomake seguro de que se ejecuta de manera idempotente, para que el script de Hola se puede ejecutar varias veces en hello mismo nodo.</span><span class="sxs-lookup"><span data-stu-id="d0cae-258">Add checks into scripts toomake sure that they execute idempotently, so that hello script can be executed multiple times on hello same node.</span></span>
3. <span data-ttu-id="d0cae-259">Hola de uso **Write-Output** tooSTDOUT de tooprint de cmdlet de PowerShell de Azure, así como STDERR.</span><span class="sxs-lookup"><span data-stu-id="d0cae-259">Use hello **Write-Output** Azure PowerShell cmdlet tooprint tooSTDOUT as well as STDERR.</span></span> <span data-ttu-id="d0cae-260">No utilice **Write-Host**.</span><span class="sxs-lookup"><span data-stu-id="d0cae-260">Do not use **Write-Host**.</span></span>
4. <span data-ttu-id="d0cae-261">Usar una carpeta de archivo temporal, como $env: TEMP, tookeep Hola descargado archivo usado por las secuencias de comandos de hello y, a continuación, limpiarlas después de que se han ejecutado las secuencias de comandos.</span><span class="sxs-lookup"><span data-stu-id="d0cae-261">Use a temporary file folder, such as $env:TEMP, tookeep hello downloaded file used by hello scripts and then clean them up after scripts have executed.</span></span>
5. <span data-ttu-id="d0cae-262">Instale el software personalizado solo en D:\ o en C:\apps.</span><span class="sxs-lookup"><span data-stu-id="d0cae-262">Install custom software only at D:\ or C:\apps.</span></span> <span data-ttu-id="d0cae-263">Otras ubicaciones en la unidad C: de hello no deben usarse como están reservadas.</span><span class="sxs-lookup"><span data-stu-id="d0cae-263">Other locations on hello C: drive should not be used as they are reserved.</span></span> <span data-ttu-id="d0cae-264">Tenga en cuenta que instale los archivos en la unidad C: de hello fuera de la carpeta de hello C:\apps puede derivar en errores de instalación durante la reimages del nodo de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-264">Note that installing files on hello C: drive outside of hello C:\apps folder may result in setup failures during reimages of hello node.</span></span>
6. <span data-ttu-id="d0cae-265">En el caso de hello que se han modificado los valores de configuración de nivel de sistema operativo o archivos de configuración de servicio de Hadoop, puede que desee toorestart HDInsight servicios para que puede seleccionar cualquier configuración de nivel de sistema operativo, como las variables de entorno de hello set en scripts de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-265">In hello event that OS-level settings or Hadoop service configuration files were changed, you may want toorestart HDInsight services so that they can pick up any OS-level settings, such as hello environment variables set in hello scripts.</span></span>

## <a name="debug-custom-scripts"></a><span data-ttu-id="d0cae-266">Depuración de scripts personalizados</span><span class="sxs-lookup"><span data-stu-id="d0cae-266">Debug custom scripts</span></span>
<span data-ttu-id="d0cae-267">registros de errores de script de Hola se almacenan, junto con otros resultados, en la cuenta de almacenamiento predeterminada de Hola que especificó para el clúster de hello en su creación.</span><span class="sxs-lookup"><span data-stu-id="d0cae-267">hello script error logs are stored, along with other output, in hello default Storage account that you specified for hello cluster at its creation.</span></span> <span data-ttu-id="d0cae-268">Hello registros almacenan en una tabla con nombre de hello *u < \cluster-name-fragment >< \time-stamp > setuplog*.</span><span class="sxs-lookup"><span data-stu-id="d0cae-268">hello logs are stored in a table with hello name *u<\cluster-name-fragment><\time-stamp>setuplog*.</span></span> <span data-ttu-id="d0cae-269">Se trata de registros agregados que tienen registros de todos los nodos de hello (nodo principal y nodos de trabajador) en qué Hola script se ejecuta en el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-269">These are aggregated logs that have records from all of hello nodes (head node and worker nodes) on which hello script runs in hello cluster.</span></span>
<span data-ttu-id="d0cae-270">Una manera sencilla de registros de hello toocheck es toouse HDInsight Tools para Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d0cae-270">An easy way toocheck hello logs is toouse HDInsight Tools for Visual Studio.</span></span> <span data-ttu-id="d0cae-271">Para instalar herramientas de hello, consulte [Introducción al uso de Hadoop de Visual Studio tools para HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span><span class="sxs-lookup"><span data-stu-id="d0cae-271">For installing hello tools, see [Get started using Visual Studio Hadoop tools for HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span></span>

<span data-ttu-id="d0cae-272">**registro de hello toocheck con Visual Studio**</span><span class="sxs-lookup"><span data-stu-id="d0cae-272">**toocheck hello log using Visual Studio**</span></span>

1. <span data-ttu-id="d0cae-273">Abra Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d0cae-273">Open Visual Studio.</span></span>
2. <span data-ttu-id="d0cae-274">Haga clic en **Ver**, y, luego, haga clic en **Explorador de servidores**.</span><span class="sxs-lookup"><span data-stu-id="d0cae-274">Click **View**, and then click **Server Explorer**.</span></span>
3. <span data-ttu-id="d0cae-275">Haga clic en "Azure", haga clic en conectar demasiado**suscripciones de Microsoft Azure**y, a continuación, escriba sus credenciales.</span><span class="sxs-lookup"><span data-stu-id="d0cae-275">Right-click "Azure", click Connect too**Microsoft Azure Subscriptions**, and then enter your credentials.</span></span>
4. <span data-ttu-id="d0cae-276">Expanda **almacenamiento**, expanda y cuenta de almacenamiento de Azure de hello usada como sistema de archivos predeterminado de hello **tablas**y, a continuación, haga doble clic en el nombre de la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-276">Expand **Storage**, expand hello Azure storage account used as hello default file system, expand **Tables**, and then double-click hello table name.</span></span>

<span data-ttu-id="d0cae-277">Puede también remoto en toosee de nodos de clúster de hello STDOUT y STDERR para scripts personalizados.</span><span class="sxs-lookup"><span data-stu-id="d0cae-277">You can also remote into hello cluster nodes toosee both STDOUT and STDERR for custom scripts.</span></span> <span data-ttu-id="d0cae-278">Hello los registros en cada nodo se nodo toothat solo específico y se registran en **C:\HDInsightLogs\DeploymentAgent.log**.</span><span class="sxs-lookup"><span data-stu-id="d0cae-278">hello logs on each node are specific only toothat node and are logged into **C:\HDInsightLogs\DeploymentAgent.log**.</span></span> <span data-ttu-id="d0cae-279">Estos archivos de registro registran todas las salidas desde un script personalizado de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-279">These log files record all outputs from hello custom script.</span></span> <span data-ttu-id="d0cae-280">Un fragmento de código de registro de ejemplo para una acción de script de Spark tiene este aspecto:</span><span class="sxs-lookup"><span data-stu-id="d0cae-280">An example log snippet for a Spark script action looks like this:</span></span>

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand; Details : BEGIN: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Starting Spark installation at: 09/04/2014 21:46:02 Done with Spark installation at: 09/04/2014 21:46:38;

    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand;
    Details : END: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;


<span data-ttu-id="d0cae-281">En este registro, es obvio que Hola Spark Generar script de acción se ha ejecutado en la máquina virtual denominada HEADNODE0 hello y que se produce ninguna excepción durante la ejecución de Hola.</span><span class="sxs-lookup"><span data-stu-id="d0cae-281">In this log, it is clear that hello Spark script action has been executed on hello VM named HEADNODE0 and that no exceptions were thrown during hello execution.</span></span>

<span data-ttu-id="d0cae-282">En caso de Hola que se produce un error de ejecución, la salida de hello que lo describe también está incluida en este archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="d0cae-282">In hello event that an execution failure occurs, hello output describing it is also contained in this log file.</span></span> <span data-ttu-id="d0cae-283">información de Hello proporcionada en estos registros debe ser útil para depurar problemas de secuencia de comandos que pueden surgir.</span><span class="sxs-lookup"><span data-stu-id="d0cae-283">hello information provided in these logs should be helpful in debugging script problems that may arise.</span></span>

## <a name="see-also"></a><span data-ttu-id="d0cae-284">Otras referencias</span><span class="sxs-lookup"><span data-stu-id="d0cae-284">See also</span></span>
* <span data-ttu-id="d0cae-285">[Personalización de los clústeres de HDInsight mediante la acción de script][hdinsight-cluster-customize]</span><span class="sxs-lookup"><span data-stu-id="d0cae-285">[Customize HDInsight clusters using Script Action][hdinsight-cluster-customize]</span></span>
* <span data-ttu-id="d0cae-286">[Instalación y uso de Spark en clústeres de HDInsight][hdinsight-install-spark]</span><span class="sxs-lookup"><span data-stu-id="d0cae-286">[Install and use Spark on HDInsight clusters][hdinsight-install-spark]</span></span>
* <span data-ttu-id="d0cae-287">[Instalación y uso de R en clústeres de Hadoop de HDInsight][hdinsight-r-scripts]</span><span class="sxs-lookup"><span data-stu-id="d0cae-287">[Install and use R on HDInsight clusters][hdinsight-r-scripts]</span></span>
* <span data-ttu-id="d0cae-288">[Instalación y uso de Solr en clústeres de Hadoop de HDInsight](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-288">[Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span>
* <span data-ttu-id="d0cae-289">[Instalación y uso de Giraph en clústeres de HDInsight](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="d0cae-289">[Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span>

[hdinsight-provision]: hdinsight-provision-clusters.md
[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md
[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md
[hdinsight-r-scripts]: hdinsight-hadoop-r-scripts.md
[powershell-install-configure]: install-configure-powershell.md

<!--Reference links in article-->
[1]: https://msdn.microsoft.com/library/96xafkes(v=vs.110).aspx
