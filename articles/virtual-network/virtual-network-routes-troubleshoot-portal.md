---
title: "Solución de problemas de rutas mediante Azure Portal | Microsoft Docs"
description: "Obtenga información acerca de cómo solucionar problemas de las rutas en el modelo de implementación de Azure Resource Manager utilizando Azure Portal."
services: virtual-network
documentationcenter: na
author: AnithaAdusumilli
manager: narayan
editor: 
tags: azure-resource-manager
ms.assetid: bdd8b6dc-02fb-4057-bb23-8289caa9de89
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/23/2016
ms.author: anithaa
ms.openlocfilehash: dad415936280b4af916b8c46df46f6c51ac0bca4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-routes-using-the-azure-portal"></a><span data-ttu-id="499c0-103">Solución de problemas de rutas mediante Azure Portal</span><span class="sxs-lookup"><span data-stu-id="499c0-103">Troubleshoot routes using the Azure Portal</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="499c0-104">Portal de Azure</span><span class="sxs-lookup"><span data-stu-id="499c0-104">Azure Portal</span></span>](virtual-network-routes-troubleshoot-portal.md)
> * [<span data-ttu-id="499c0-105">PowerShell</span><span class="sxs-lookup"><span data-stu-id="499c0-105">PowerShell</span></span>](virtual-network-routes-troubleshoot-powershell.md)
>
>

<span data-ttu-id="499c0-106">Si experimenta problemas de conectividad de red tanto de entrada como de salida en Azure Virtual Machine (VM), es posible que las rutas estén afectando el flujo de tráfico de la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="499c0-106">If you are experiencing network connectivity issues to or from your Azure Virtual Machine (VM), routes may be impacting your VM traffic flows.</span></span> <span data-ttu-id="499c0-107">Este artículo proporciona información general sobre las funcionalidades de diagnóstico para las rutas para ayudarle en la solución del problema.</span><span class="sxs-lookup"><span data-stu-id="499c0-107">This article provides an overview of diagnostics capabilities for routes to help troubleshoot further.</span></span>

<span data-ttu-id="499c0-108">Las tablas de rutas están asociadas con subredes y son eficaces en todas las interfaces de red (NIC) en cada subred específica.</span><span class="sxs-lookup"><span data-stu-id="499c0-108">Route tables are associated with subnets and are effective on all network interfaces (NIC) in that subnet.</span></span> <span data-ttu-id="499c0-109">Los siguientes tipos de rutas pueden aplicarse a cada interfaz de red:</span><span class="sxs-lookup"><span data-stu-id="499c0-109">The following types of routes can be applied to each network interface:</span></span>

* <span data-ttu-id="499c0-110">**Rutas del sistema:** de forma predeterminada, cada subred creada en Azure Virtual Network (VNet) tiene tablas de rutas del sistema que permiten el tráfico de red virtual local, el tráfico local a través de las puertas de enlace VPN y el tráfico de Internet.</span><span class="sxs-lookup"><span data-stu-id="499c0-110">**System routes:** By default, every subnet created in an Azure Virtual Network (VNet) has system route tables that allow local VNet traffic, on-premises traffic via VPN gateways, and Internet traffic.</span></span> <span data-ttu-id="499c0-111">Las rutas del sistema existen también para las redes virtuales emparejadas.</span><span class="sxs-lookup"><span data-stu-id="499c0-111">System routes also exist for peered VNets.</span></span>
* <span data-ttu-id="499c0-112">**Rutas BGP:** propagadas a las interfaces de red a través de ExpressRoute o de conexiones VPN de sitio a sitio.</span><span class="sxs-lookup"><span data-stu-id="499c0-112">**BGP routes:** Propagated to network interfaces through ExpressRoute or site-to-site VPN connections.</span></span> <span data-ttu-id="499c0-113">Para más información acerca del enrutamiento BGP consulte los artículos sobre [BGP con VPN Gateway](../vpn-gateway/vpn-gateway-bgp-overview.md) e [Introducción técnica de ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="499c0-113">Learn more about BGP routing by reading the [BGP with VPN gateways](../vpn-gateway/vpn-gateway-bgp-overview.md) and [ExpressRoute overview](../expressroute/expressroute-introduction.md) articles.</span></span>
* <span data-ttu-id="499c0-114">**Rutas definidas por el usuario (UDR):** si usa dispositivos de red virtual o si hay tráfico de tunelización forzada a una red local a través de una VPN de sitio a sitio, es posible que tenga rutas definidas por el usuario (UDR) asociadas a la tabla de rutas de subred.</span><span class="sxs-lookup"><span data-stu-id="499c0-114">**User-defined routes (UDR):** If you are using network virtual appliances or are forced-tunneling traffic to an on-premises network via a site-to-site VPN, you may have user-defined routes (UDRs) associated with your subnet route table.</span></span> <span data-ttu-id="499c0-115">Si no está familiarizado con las UDR, consulte el artículo sobre [rutas definidas por el usuario](virtual-networks-udr-overview.md#user-defined-routes) .</span><span class="sxs-lookup"><span data-stu-id="499c0-115">If you're not familiar with UDRs, read the [user-defined routes](virtual-networks-udr-overview.md#user-defined-routes) article.</span></span>

<span data-ttu-id="499c0-116">Con las diversas rutas que se pueden aplicar a una interfaz de red, puede resultar difícil determinar qué rutas agregadas son eficaces.</span><span class="sxs-lookup"><span data-stu-id="499c0-116">With the various routes that can be applied to a network interface, it can be difficult to determine which aggregate routes are effective.</span></span> <span data-ttu-id="499c0-117">Para ayudarle a solucionar problemas de conectividad de red de máquina virtual, puede ver todas las rutas eficaces para una interfaz de red en el modelo de implementación de Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="499c0-117">To help troubleshoot VM network connectivity, you can view all the effective routes for a network interface in the Azure Resource Manager deployment model.</span></span>

## <a name="using-effective-routes-to-troubleshoot-vm-traffic-flow"></a><span data-ttu-id="499c0-118">Uso de rutas eficaces para solucionar problemas de flujo de tráfico de máquinas virtuales</span><span class="sxs-lookup"><span data-stu-id="499c0-118">Using Effective Routes to troubleshoot VM traffic flow</span></span>
<span data-ttu-id="499c0-119">Este artículo usa el siguiente escenario como ejemplo para ilustrar cómo solucionar problemas de las rutas eficaces para una interfaz de red:</span><span class="sxs-lookup"><span data-stu-id="499c0-119">This article uses the following scenario as an example to illustrate how to troubleshoot the effective routes for a network interface:</span></span>

<span data-ttu-id="499c0-120">Una máquina virtual (*VM1*) conectada a la red virtual (*VNet1*, prefijo: 10.9.0.0/16) no se puede conectar a una máquina virtual (VM3) en una red virtual recién emparejada (*VNet3*, prefijo 10.10.0.0/16).</span><span class="sxs-lookup"><span data-stu-id="499c0-120">A VM (*VM1*) connected to the VNet (*VNet1*, prefix: 10.9.0.0/16) fails to connect to a VM(VM3) in a newly peered VNet (*VNet3*, prefix 10.10.0.0/16).</span></span> <span data-ttu-id="499c0-121">No hay ninguna ruta UDR o BGP aplicada a la interfaz de red VM1-NIC1 conectada a la máquina virtual, se aplican solo rutas del sistema.</span><span class="sxs-lookup"><span data-stu-id="499c0-121">There are no UDRs or BGP routes applied to VM1-NIC1 network interface connected to the VM, only system routes are applied.</span></span>

<span data-ttu-id="499c0-122">En este artículo se explica cómo determinar la causa del error de conexión, utilizando la funcionalidad de rutas eficaces en el modelo de implementación de Azure Resource Management.</span><span class="sxs-lookup"><span data-stu-id="499c0-122">This article explains how to determine the cause of the connection failure, using effective routes capability in Azure Resource Management deployment model.</span></span>
<span data-ttu-id="499c0-123">Aunque este ejemplo utiliza solo rutas de sistema, los pasos siguientes pueden utilizarse para determinar errores de conexión entrante y saliente a través de cualquier tipo de puerto.</span><span class="sxs-lookup"><span data-stu-id="499c0-123">While the example uses only system routes, the same steps can be used to determine inbound and outbound connection failures over any route type.</span></span>

> [!NOTE]
> <span data-ttu-id="499c0-124">Si la máquina virtual tiene más de una NIC conectada, compruebe las rutas eficaces para cada una de las NIC con el fin de diagnosticar problemas de conectividad de red, tanto de entrada como de salida, de una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="499c0-124">If your VM has more than one NIC attached, check effective routes for each of the NICs to diagnose network connectivity issues to and from a VM.</span></span>
>
>

### <a name="view-effective-routes-for-a-virtual-machine"></a><span data-ttu-id="499c0-125">Visualización de las rutas eficaces para una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="499c0-125">View effective routes for a virtual machine</span></span>
<span data-ttu-id="499c0-126">Para ver las rutas agregadas que se aplican a una máquina virtual, complete los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="499c0-126">To see the aggregate routes that are applied to a VM, complete the following steps:</span></span>

1. <span data-ttu-id="499c0-127">Inicie sesión en Azure Portal en https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="499c0-127">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="499c0-128">Haga clic en **Más servicios** y, luego, haga clic en **Máquinas virtuales** en la lista que aparece.</span><span class="sxs-lookup"><span data-stu-id="499c0-128">Click **More services**, then click **Virtual machines** in the list that appears.</span></span>
3. <span data-ttu-id="499c0-129">En la lista seleccione una máquina virtual para solucionar problemas, después de hacerlo se abrirá una hoja de máquina virtual con opciones.</span><span class="sxs-lookup"><span data-stu-id="499c0-129">Select a VM to troubleshoot from the list that appears and a VM blade with options appears.</span></span>
4. <span data-ttu-id="499c0-130">Haga clic en **Diagnosticar y solucionar problemas** y, a continuación, seleccione un problema común.</span><span class="sxs-lookup"><span data-stu-id="499c0-130">Click **Diagnose & solve problems** and then select a common problem.</span></span> <span data-ttu-id="499c0-131">En este ejemplo está seleccionado **No puedo conectar con mi VM Windows** .</span><span class="sxs-lookup"><span data-stu-id="499c0-131">For this example, **I can’t connect to my Windows VM** is selected.</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image1.png)
5. <span data-ttu-id="499c0-132">Bajo el problema aparecen una serie de pasos, tal como se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="499c0-132">Steps appear under the problem, as shown in the following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image2.png)

    <span data-ttu-id="499c0-133">Haga clic en *effective routes* (rutas eficaces) en la lista de pasos recomendados.</span><span class="sxs-lookup"><span data-stu-id="499c0-133">Click *effective routes* in the list of recommended steps.</span></span>
6. <span data-ttu-id="499c0-134">Aparece la hoja **Effective routes** (Rutas eficaces), como se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="499c0-134">The **Effective routes** blade appears, as shown in the following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image3.png)

    <span data-ttu-id="499c0-135">Si la máquina virtual tiene solo una NIC, está seleccionada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="499c0-135">If your VM has only one NIC, it is selected by default.</span></span> <span data-ttu-id="499c0-136">Si tiene más de una NIC, seleccione la NIC para la que desea ver las rutas eficaces.</span><span class="sxs-lookup"><span data-stu-id="499c0-136">If you have more than one NIC, select the NIC for which you want to view the effective routes.</span></span>

   > [!NOTE]
   > <span data-ttu-id="499c0-137">Si la máquina virtual asociada con la NIC no está en estado de ejecución, no se mostrará ninguna ruta eficaz.</span><span class="sxs-lookup"><span data-stu-id="499c0-137">If the VM associated with the NIC is not in a running state, effective routes will not be shown.</span></span> <span data-ttu-id="499c0-138">Solo las primeras 200 rutas eficaces se muestran en el portal.</span><span class="sxs-lookup"><span data-stu-id="499c0-138">Only the first 200 effective routes are shown in the portal.</span></span> <span data-ttu-id="499c0-139">Para obtener la lista completa, haga clic en **Descargar**.</span><span class="sxs-lookup"><span data-stu-id="499c0-139">For the full list, click **Download**.</span></span> <span data-ttu-id="499c0-140">Puede filtrar aún más los resultados en el archivo .csv descargado.</span><span class="sxs-lookup"><span data-stu-id="499c0-140">You can further filter on the results from the downloaded .csv file.</span></span>
   >
   >

    <span data-ttu-id="499c0-141">Tenga en cuenta lo siguiente en el resultado:</span><span class="sxs-lookup"><span data-stu-id="499c0-141">Notice the following in the output:</span></span>

   * <span data-ttu-id="499c0-142">**Origen**: indica el tipo de ruta.</span><span class="sxs-lookup"><span data-stu-id="499c0-142">**Source**: Indicates the type of route.</span></span> <span data-ttu-id="499c0-143">Las rutas del sistema se muestran como *Predeterminado*, los UDR se muestran como *Usuario* y las rutas de puerta de enlace (estáticas o BGP) se muestran como *VPNGateway*.</span><span class="sxs-lookup"><span data-stu-id="499c0-143">System routes are shown as *Default*, UDRs are shown as *User* and gateway routes (static or BGP) are shown as *VPNGateway*.</span></span>
   * <span data-ttu-id="499c0-144">**Estado**: indica el estado de la ruta eficaz.</span><span class="sxs-lookup"><span data-stu-id="499c0-144">**State**: Indicates state of the effective route.</span></span> <span data-ttu-id="499c0-145">Los valores posibles son *Activo* o *No válido*.</span><span class="sxs-lookup"><span data-stu-id="499c0-145">Possible values are *Active* or *Invalid*.</span></span>
   * <span data-ttu-id="499c0-146">**AddressPrefixes**: especifica el prefijo de dirección de la ruta eficaz en la notación CIDR.</span><span class="sxs-lookup"><span data-stu-id="499c0-146">**AddressPrefixes**: Specifies the address prefix of the effective route in CIDR notation.</span></span>
   * <span data-ttu-id="499c0-147">**nextHopType**: indica el próximo salto de la ruta dada.</span><span class="sxs-lookup"><span data-stu-id="499c0-147">**nextHopType**: Indicates the next hop for the given route.</span></span> <span data-ttu-id="499c0-148">Los valores posibles son *VirtualAppliance*, *Internet*, *VNetLocal*, *VNetPeering* o *Null*.</span><span class="sxs-lookup"><span data-stu-id="499c0-148">Possible values are *VirtualAppliance*, *Internet*, *VNetLocal*, *VNetPeering*, or *Null*.</span></span> <span data-ttu-id="499c0-149">Un valor de *Null* para **nextHopType** en un UDR puede indicar una ruta no válida.</span><span class="sxs-lookup"><span data-stu-id="499c0-149">A value of *Null* for **nextHopType** in a UDR may indicate an invalid route.</span></span> <span data-ttu-id="499c0-150">Por ejemplo, si **nextHopType** es *VirtualAppliance* y la máquina virtual de dispositivo de red virtual no está en estado aprovisionado/en ejecución.</span><span class="sxs-lookup"><span data-stu-id="499c0-150">For example, if **nextHopType** is *VirtualAppliance* and the network virtual appliance VM is not in a provisioned/running state.</span></span> <span data-ttu-id="499c0-151">Si **nextHopType** es *VPNGateway* y no hay ninguna puerta de enlace aprovisionada/en ejecución en la red virtual específica, la ruta puede no ser válida.</span><span class="sxs-lookup"><span data-stu-id="499c0-151">If **nextHopType** is *VPNGateway* and there is no gateway provisioned/running in the given VNet, the route may become invalid.</span></span>
7. <span data-ttu-id="499c0-152">No hay ninguna ruta para la red virtual *WestUS-VNET3* (prefijo 10.10.0.0/16) desde *WestUS-VNet1* (prefijo 10.9.0.0/16) en la imagen del paso anterior.</span><span class="sxs-lookup"><span data-stu-id="499c0-152">There is no route listed to the *WestUS-VNET3* VNet (Prefix 10.10.0.0/16) from the *WestUS-VNet1* (Prefix 10.9.0.0/16) in the picture in the previous step.</span></span> <span data-ttu-id="499c0-153">En la siguiente imagen, el vínculo de emparejamiento está en estado *Desconectado* :</span><span class="sxs-lookup"><span data-stu-id="499c0-153">In the following picture, the peering link is in the *Disconnected* state:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image4.png)

    <span data-ttu-id="499c0-154">El vínculo bidireccional para el emparejamiento se interrumpe, lo que explica por qué VM1 no pudo conectarse a VM3 en la red virtual *WestUS-VNet3* .</span><span class="sxs-lookup"><span data-stu-id="499c0-154">The bi-directional link for the peering is broken, which explains why VM1 could not connect to VM3 in the *WestUS-VNet3* VNet.</span></span>
8. <span data-ttu-id="499c0-155">En la siguiente imagen se muestran las rutas después de establecer el vínculo de emparejamiento bidireccional:</span><span class="sxs-lookup"><span data-stu-id="499c0-155">The following picture shows the routes after establishing the bi-directional peering link:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image5.png)

<span data-ttu-id="499c0-156">Para informarse sobre más escenarios de solución de problemas para la evaluación de ruta y de tunelización forzada consulte la sección [Consideraciones](virtual-network-routes-troubleshoot-portal.md#considerations) de este artículo.</span><span class="sxs-lookup"><span data-stu-id="499c0-156">For more troubleshooting scenarios for forced-tunneling and route evaluation, read the [Considerations](virtual-network-routes-troubleshoot-portal.md#considerations) section of this article.</span></span>

### <a name="view-effective-routes-for-a-network-interface"></a><span data-ttu-id="499c0-157">Visualización de las rutas eficaces para una interfaz de red</span><span class="sxs-lookup"><span data-stu-id="499c0-157">View effective routes for a network interface</span></span>
<span data-ttu-id="499c0-158">Si el flujo de tráfico de red se ve afectado para una interfaz de red (NIC) determinada, puede ver una lista completa de rutas eficaces directamente en una NIC.</span><span class="sxs-lookup"><span data-stu-id="499c0-158">If network traffic flow is impacted for a particular network interface (NIC), you can view a full list of effective routes on a NIC directly.</span></span> <span data-ttu-id="499c0-159">Para ver las rutas agregadas que se aplican a una NIC, complete los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="499c0-159">To see the aggregate routes that are applied to a NIC, complete the following steps:</span></span>

1. <span data-ttu-id="499c0-160">Inicie sesión en Azure Portal en https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="499c0-160">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="499c0-161">Haga clic en **Más servicios** y, a continuación, haga clic en **Interfaces de red**.</span><span class="sxs-lookup"><span data-stu-id="499c0-161">Click **More services**, then click **Network interfaces**</span></span>
3. <span data-ttu-id="499c0-162">En la lista busque el nombre de una NIC o selecciónelo en la lista que aparece.</span><span class="sxs-lookup"><span data-stu-id="499c0-162">Search the list for the name of a NIC, or select it from the list that appears.</span></span> <span data-ttu-id="499c0-163">En este ejemplo está seleccionada **VM1 NIC1** .</span><span class="sxs-lookup"><span data-stu-id="499c0-163">In this example, **VM1-NIC1** is selected.</span></span>
4. <span data-ttu-id="499c0-164">Seleccione **Rutas eficaces** en la hoja **Interfaz de red**, como se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="499c0-164">Select **Effective routes** in the **Network interface** blade, as shown in the following picture:</span></span>

       ![](./media/virtual-network-routes-troubleshoot-portal/image6.png)

    <span data-ttu-id="499c0-165">Observe que el **Ámbito** se establece de forma predeterminada en la interfaz de red seleccionada.</span><span class="sxs-lookup"><span data-stu-id="499c0-165">The **Scope** defaults to the network interface selected.</span></span>

      ![](./media/virtual-network-routes-troubleshoot-portal/image7.png)

### <a name="view-effective-routes-for-a-route-table"></a><span data-ttu-id="499c0-166">Visualización de las rutas eficaces para una tabla de rutas</span><span class="sxs-lookup"><span data-stu-id="499c0-166">View effective routes for a route table</span></span>
<span data-ttu-id="499c0-167">Para modificar rutas definidas por el usuario (UDR) en una tabla de rutas, puede revisar el impacto de las rutas que se han agregado en una máquina virtual específica.</span><span class="sxs-lookup"><span data-stu-id="499c0-167">When modifying user-defined routes (UDRs) in a route table, you may want to review the impact of the routes being added on a particular VM.</span></span> <span data-ttu-id="499c0-168">Una tabla de rutas se puede asociar con cualquier número de subredes.</span><span class="sxs-lookup"><span data-stu-id="499c0-168">A route table can be associated with any number of subnets.</span></span> <span data-ttu-id="499c0-169">Puede ver una lista completa de las rutas eficaces para todas las NIC a las que se aplica una tabla de rutas determinada, sin tener que cambiar el contexto de la hoja de tabla de rutas determinada.</span><span class="sxs-lookup"><span data-stu-id="499c0-169">You can now view all the effective routes for all the NICs that a given route table is applied to, without having to switch context from the given route table blade.</span></span>

<span data-ttu-id="499c0-170">En este ejemplo, se ha especificado una UDR (*UDRoute*) en una tabla de rutas (*UDRouteTable*).</span><span class="sxs-lookup"><span data-stu-id="499c0-170">For this example, a UDR (*UDRoute*) is specified in a route table (*UDRouteTable*).</span></span> <span data-ttu-id="499c0-171">Esta ruta envía todo el tráfico de Internet de *Subnet1* en la red virtual *WestUS-VNet1* a través de un dispositivo de red virtual (NVA), en *Subnet2* de la misma red virtual.</span><span class="sxs-lookup"><span data-stu-id="499c0-171">This route sends all Internet traffic from *Subnet1* in the *WestUS-VNet1* VNet, through a network virtual appliance (NVA), in *Subnet2* of the same VNet.</span></span> <span data-ttu-id="499c0-172">La ruta se muestra en la imagen siguiente:</span><span class="sxs-lookup"><span data-stu-id="499c0-172">The route is shown in the following picture:</span></span>

![](./media/virtual-network-routes-troubleshoot-portal/image8.png)

<span data-ttu-id="499c0-173">Para ver las rutas agregadas que se aplican a una tabla de rutas, complete los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="499c0-173">To see the aggregate routes for a route table, complete the following steps:</span></span>

1. <span data-ttu-id="499c0-174">Inicie sesión en Azure Portal en https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="499c0-174">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="499c0-175">Haga clic en **Más servicios** y, a continuación, haga clic en **Tablas de rutas**.</span><span class="sxs-lookup"><span data-stu-id="499c0-175">Click **More services**, then click **Route tables**</span></span>
3. <span data-ttu-id="499c0-176">Busque en la lista la tabla de rutas para la que desea ver las rutas agregadas y selecciónela.</span><span class="sxs-lookup"><span data-stu-id="499c0-176">Search the list for the route table you want to see aggregate routes for and select it.</span></span> <span data-ttu-id="499c0-177">En este ejemplo, **UDRouteTable** está seleccionada.</span><span class="sxs-lookup"><span data-stu-id="499c0-177">In this example, **UDRouteTable** is selected.</span></span> <span data-ttu-id="499c0-178">Aparece una hoja de la tabla de rutas seleccionada, tal como se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="499c0-178">A blade for the selected route table appears, as shown in the following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image9.png)
4. <span data-ttu-id="499c0-179">Seleccione **Rutas eficaces** en la hoja **Tabla de rutas**.</span><span class="sxs-lookup"><span data-stu-id="499c0-179">Select **Effective Routes** in the **Route table** blade.</span></span> <span data-ttu-id="499c0-180">El **Ámbito** se establece en la tabla de rutas seleccionada.</span><span class="sxs-lookup"><span data-stu-id="499c0-180">The **Scope** is set to the route table you selected.</span></span>
5. <span data-ttu-id="499c0-181">Una tabla de rutas se puede aplicar a varias subredes.</span><span class="sxs-lookup"><span data-stu-id="499c0-181">A route table can be applied to multiple subnets.</span></span> <span data-ttu-id="499c0-182">Seleccione en la lista la **Subred** que desea revisar.</span><span class="sxs-lookup"><span data-stu-id="499c0-182">Select the **Subnet** you want to review from the list.</span></span> <span data-ttu-id="499c0-183">En este ejemplo está seleccionada **Subnet1** .</span><span class="sxs-lookup"><span data-stu-id="499c0-183">In this example, **Subnet1** is selected.</span></span>
6. <span data-ttu-id="499c0-184">Seleccione una **Interfaz de red**.</span><span class="sxs-lookup"><span data-stu-id="499c0-184">Select a **Network Interface**.</span></span> <span data-ttu-id="499c0-185">Se muestran todas las NIC conectadas a la subred seleccionada.</span><span class="sxs-lookup"><span data-stu-id="499c0-185">All NICs connected to the selected subnet are listed.</span></span> <span data-ttu-id="499c0-186">En este ejemplo está seleccionada **VM1 NIC1** .</span><span class="sxs-lookup"><span data-stu-id="499c0-186">In this example, **VM1-NIC1** is selected.</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image10.png)

   > [!NOTE]
   > <span data-ttu-id="499c0-187">Si la NIC no está asociada a una máquina virtual en ejecución, no se muestra ninguna ruta eficaz.</span><span class="sxs-lookup"><span data-stu-id="499c0-187">If the NIC is not associated with a running VM, no effective routes are shown.</span></span>
   >
   >

## <a name="considerations"></a><span data-ttu-id="499c0-188">Consideraciones</span><span class="sxs-lookup"><span data-stu-id="499c0-188">Considerations</span></span>
<span data-ttu-id="499c0-189">Algunos aspectos que tener en cuenta al revisar la lista de rutas devuelven:</span><span class="sxs-lookup"><span data-stu-id="499c0-189">A few things to keep in mind when reviewing the list of routes returned:</span></span>

* <span data-ttu-id="499c0-190">El enrutamiento se basa en coincidencia de prefijo más larga (LPM) entre las rutas UDR, BGP y del sistema.</span><span class="sxs-lookup"><span data-stu-id="499c0-190">Routing is based on Longest Prefix Match (LPM) among UDRs, BGP and system routes.</span></span> <span data-ttu-id="499c0-191">Si hay más de una ruta con la misma coincidencia LPM, se selecciona una en función de su origen en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="499c0-191">If there is more than one route with the same LPM match, then a route is selected based on its origin in the following order:</span></span>

  * <span data-ttu-id="499c0-192">Ruta definida por el usuario</span><span class="sxs-lookup"><span data-stu-id="499c0-192">User-defined route</span></span>
  * <span data-ttu-id="499c0-193">Ruta BGP</span><span class="sxs-lookup"><span data-stu-id="499c0-193">BGP route</span></span>
  * <span data-ttu-id="499c0-194">Ruta del sistema (predeterminado)</span><span class="sxs-lookup"><span data-stu-id="499c0-194">System (Default) route</span></span>

    <span data-ttu-id="499c0-195">En el caso de las rutas eficaces, solo puede ver aquellas que tienen una coincidencia LPM basada en todas las rutas disponibles.</span><span class="sxs-lookup"><span data-stu-id="499c0-195">With effective routes, you can only see effective routes that are LPM match based on all the availble routes.</span></span> <span data-ttu-id="499c0-196">Al mostrar cómo las rutas se evalúan realmente para una NIC determinada, resulta mucho más fácil solucionar problemas en rutas específicas que pueden afectar a la conectividad (tanto de entrada como de salida) de la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="499c0-196">By showing how the routes are actually evaluated for a given NIC, this makes it a lot easier to troubleshoot specific routes that may be impacting connectivity to/from your VM.</span></span>
* <span data-ttu-id="499c0-197">Si tiene UDR que están enviando tráfico a un dispositivo de red virtual (NVA), con *VirtualAppliance* como **nextHopType**, asegúrese de que el reenvío IP está habilitado en el NVA que recibe el tráfico o se perderán los paquetes.</span><span class="sxs-lookup"><span data-stu-id="499c0-197">If you have UDRs and are sending traffic to a network virtual appliance (NVA), with *VirtualAppliance* as **nextHopType**, ensure that IP forwarding is enabled on the NVA receiving the traffic or packets are dropped.</span></span>
* <span data-ttu-id="499c0-198">Si está habilitada la tunelización forzada, todo el tráfico saliente de Internet se enrutará a la red local.</span><span class="sxs-lookup"><span data-stu-id="499c0-198">If Forced tunneling is enabled, all outbound Internet traffic will be routed to on-premises.</span></span> <span data-ttu-id="499c0-199">Una conexión RDP o SSH desde Internet a su máquina virtual puede no funcionar con esta configuración, dependiendo de cómo la red local controle este tráfico.</span><span class="sxs-lookup"><span data-stu-id="499c0-199">RDP/SSH from Internet to your VM may not work with this setting, depending on how the on-premises handles this traffic.</span></span>
  <span data-ttu-id="499c0-200">Puede habilitar la tunelización forzada:</span><span class="sxs-lookup"><span data-stu-id="499c0-200">Forced-tunneling can be enabled:</span></span>
  * <span data-ttu-id="499c0-201">Si utiliza VPN de sitio a sitio, estableciendo una ruta definida por el usuario (UDR) con nextHopType como VPN Gateway</span><span class="sxs-lookup"><span data-stu-id="499c0-201">If using site-to-site VPN, by setting a user-defined route (UDR) with nextHopType as VPN Gateway</span></span>
  * <span data-ttu-id="499c0-202">Si se anuncia una ruta predeterminada a través de BGP</span><span class="sxs-lookup"><span data-stu-id="499c0-202">If a default route is advertised over BGP</span></span>
* <span data-ttu-id="499c0-203">Para que el tráfico de emparejamiento de red virtual funcione correctamente, es necesario que exista una ruta de sistema con **nextHopType** *VNetPeering* para el intervalo de prefijos de red virtual.</span><span class="sxs-lookup"><span data-stu-id="499c0-203">For VNet peering traffic to work correctly, a system route with **nextHopType** *VNetPeering* must exist for the peered VNet’s prefix range.</span></span> <span data-ttu-id="499c0-204">Si dicha una ruta no existe y el vínculo de emparejamiento de red virtual parece correcto:</span><span class="sxs-lookup"><span data-stu-id="499c0-204">If such a route doesn’t exist and the VNet peering link looks OK:</span></span>
  * <span data-ttu-id="499c0-205">Espere unos segundos y vuelva a intentar si es un vínculo de emparejamiento recién establecido.</span><span class="sxs-lookup"><span data-stu-id="499c0-205">Wait a few seconds and retry if it's a newly established peering link.</span></span> <span data-ttu-id="499c0-206">En ocasiones la propagación de las rutas a todas las interfaces de red en una subred lleva algo más de tiempo.</span><span class="sxs-lookup"><span data-stu-id="499c0-206">It occasionally takes longer to propagate routes to all the network interfaces in a subnet.</span></span>
  * <span data-ttu-id="499c0-207">Las reglas del grupo de seguridad de red (NSG) pueden estar afectando a los flujos de tráfico.</span><span class="sxs-lookup"><span data-stu-id="499c0-207">Network Security Group (NSG) rules may be impacting the traffic flows.</span></span> <span data-ttu-id="499c0-208">Para más información, consulte el artículo sobre [Solución de problemas de los grupos de seguridad de red](virtual-network-nsg-troubleshoot-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="499c0-208">For more information, see the [Troubleshoot Network Security Groups](virtual-network-nsg-troubleshoot-portal.md) article.</span></span>
