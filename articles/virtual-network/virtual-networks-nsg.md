---
title: Grupos de seguridad de red en Azure | Microsoft Docs
description: "Aprenda cómo aislar y controlar el flujo de tráfico dentro de las redes virtuales mediante el firewall distribuido de Azure y los grupos de seguridad de red."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: 20e850fc-6456-4b5f-9a3f-a8379b052bc9
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: fac6ee69b5f0377e0515ac9abeb28788cbef9b79
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/18/2017
---
# <a name="filter-network-traffic-with-network-security-groups"></a><span data-ttu-id="50af8-103">Filtrado del tráfico de red con grupos de seguridad de red</span><span class="sxs-lookup"><span data-stu-id="50af8-103">Filter network traffic with network security groups</span></span>

<span data-ttu-id="50af8-104">Un grupo de seguridad de red (NSG) contiene una lista de reglas de seguridad que permiten o deniegan el tráfico de red a recursos conectados a redes virtuales de Azure (VNet).</span><span class="sxs-lookup"><span data-stu-id="50af8-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic to resources connected to Azure Virtual Networks (VNet).</span></span> <span data-ttu-id="50af8-105">Los grupos de seguridad de red se pueden asociar a subredes, máquinas virtuales individuales (clásicas) o interfaces de red (NIC) individuales conectadas a máquinas virtuales (Resource Manager).</span><span class="sxs-lookup"><span data-stu-id="50af8-105">NSGs can be associated to subnets, individual VMs (classic), or individual network interfaces (NIC) attached to VMs (Resource Manager).</span></span> <span data-ttu-id="50af8-106">Cuando un grupo de seguridad de red está asociado a una subred, las reglas se aplican a todos los recursos conectados a la subred.</span><span class="sxs-lookup"><span data-stu-id="50af8-106">When an NSG is associated to a subnet, the rules apply to all resources connected to the subnet.</span></span> <span data-ttu-id="50af8-107">El tráfico se puede restringir aún más si se asocia también un grupo de seguridad de red a una máquina virtual o interfaz de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-107">Traffic can further be restricted by also associating an NSG to a VM or NIC.</span></span>

> [!NOTE]
> <span data-ttu-id="50af8-108">Azure tiene dos modelos de implementación diferentes para crear recursos y trabajar con ellos: [Resource Manager y el clásico](../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="50af8-109">En este artículo se trata el uso de ambos modelos, pero Microsoft recomienda que la mayoría de las nuevas implementaciones usen el modelo del Administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="50af8-109">This article covers using both models, but Microsoft recommends that most new deployments use the Resource Manager model.</span></span>

## <a name="nsg-resource"></a><span data-ttu-id="50af8-110">Recurso NSG</span><span class="sxs-lookup"><span data-stu-id="50af8-110">NSG resource</span></span>
<span data-ttu-id="50af8-111">Los grupos de seguridad de red contienen las siguientes propiedades:</span><span class="sxs-lookup"><span data-stu-id="50af8-111">NSGs contain the following properties:</span></span>

| <span data-ttu-id="50af8-112">Propiedad</span><span class="sxs-lookup"><span data-stu-id="50af8-112">Property</span></span> | <span data-ttu-id="50af8-113">Description</span><span class="sxs-lookup"><span data-stu-id="50af8-113">Description</span></span> | <span data-ttu-id="50af8-114">Restricciones</span><span class="sxs-lookup"><span data-stu-id="50af8-114">Constraints</span></span> | <span data-ttu-id="50af8-115">Consideraciones</span><span class="sxs-lookup"><span data-stu-id="50af8-115">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="50af8-116">Nombre</span><span class="sxs-lookup"><span data-stu-id="50af8-116">Name</span></span> |<span data-ttu-id="50af8-117">Nombre del grupo de seguridad de red</span><span class="sxs-lookup"><span data-stu-id="50af8-117">Name for the NSG</span></span> |<span data-ttu-id="50af8-118">Debe ser único dentro de la región.</span><span class="sxs-lookup"><span data-stu-id="50af8-118">Must be unique within the region.</span></span><br/><span data-ttu-id="50af8-119">Puede incluir letras, números, caracteres de subrayado, puntos y guiones.</span><span class="sxs-lookup"><span data-stu-id="50af8-119">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="50af8-120">Debe empezar por una letra o un número.</span><span class="sxs-lookup"><span data-stu-id="50af8-120">Must start with a letter or number.</span></span><br/><span data-ttu-id="50af8-121">Debe finalizar en una letra, un número o un carácter de subrayado.</span><span class="sxs-lookup"><span data-stu-id="50af8-121">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="50af8-122">No puede superar los 80 caracteres.</span><span class="sxs-lookup"><span data-stu-id="50af8-122">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="50af8-123">Dado que es posible que tenga que crear varios grupos de seguridad de red, asegúrese de tener una convención de nomenclatura que facilite la identificación de su función.</span><span class="sxs-lookup"><span data-stu-id="50af8-123">Since you may need to create several NSGs, make sure you have a naming convention that makes it easy to identify the function of your NSGs.</span></span> |
| <span data-ttu-id="50af8-124">Region</span><span class="sxs-lookup"><span data-stu-id="50af8-124">Region</span></span> |<span data-ttu-id="50af8-125">[Región](https://azure.microsoft.com/regions) de Azure donde se crea el grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-125">Azure [region](https://azure.microsoft.com/regions) where the NSG is created.</span></span> |<span data-ttu-id="50af8-126">Los grupos de seguridad de red solo se pueden asociar a recursos dentro de la misma región que el grupo.</span><span class="sxs-lookup"><span data-stu-id="50af8-126">NSGs can only be associated to resources within the same region as the NSG.</span></span> |<span data-ttu-id="50af8-127">Para ver sobre cuántos grupos de seguridad de red puede tener por región, lea el artículo sobre los [límites de Azure](../azure-subscription-service-limits.md#virtual-networking-limits-classic).</span><span class="sxs-lookup"><span data-stu-id="50af8-127">To learn about how many NSGs you can have per region, read the [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span></span>|
| <span data-ttu-id="50af8-128">Grupos de recursos</span><span class="sxs-lookup"><span data-stu-id="50af8-128">Resource group</span></span> |<span data-ttu-id="50af8-129">El [grupo de recursos](../azure-resource-manager/resource-group-overview.md#resource-groups) donde existe el grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-129">The [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) the NSG exists in.</span></span> |<span data-ttu-id="50af8-130">Aunque un grupo de seguridad de red existe en un grupo de recursos, puede estar asociado a recursos de cualquier grupo de recursos, siempre y cuando el recurso forme parte de la misma región de Azure que el grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-130">Although an NSG exists in a resource group, it can be associated to resources in any resource group, as long as the resource is part of the same Azure region as the NSG.</span></span> |<span data-ttu-id="50af8-131">Los grupos de recursos se usan para administrar varios recursos juntos, como una unidad de implementación.</span><span class="sxs-lookup"><span data-stu-id="50af8-131">Resource groups are used to manage multiple resources together, as a deployment unit.</span></span><br/><span data-ttu-id="50af8-132">Puede considerar la posibilidad de agrupar los grupos de seguridad de red con los recursos a los que están asociados.</span><span class="sxs-lookup"><span data-stu-id="50af8-132">You may consider grouping the NSG with resources it is associated to.</span></span> |
| <span data-ttu-id="50af8-133">Reglas</span><span class="sxs-lookup"><span data-stu-id="50af8-133">Rules</span></span> |<span data-ttu-id="50af8-134">Las reglas de entrada o de salida que definen qué tráfico se permite o deniega.</span><span class="sxs-lookup"><span data-stu-id="50af8-134">Inbound or outbound rules that define what traffic is allowed or denied.</span></span> | |<span data-ttu-id="50af8-135">Consulte la sección [Reglas de grupo de seguridad de red](#Nsg-rules) de este artículo.</span><span class="sxs-lookup"><span data-stu-id="50af8-135">See the [NSG rules](#Nsg-rules) section of this article.</span></span> |

> [!NOTE]
> <span data-ttu-id="50af8-136">No se admiten ACL basadas en el extremo y  grupos de seguridad de red en la misma instancia de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-136">Endpoint-based ACLs and network security groups are not supported on the same VM instance.</span></span> <span data-ttu-id="50af8-137">Si desea usar un grupo de seguridad de red y ya tiene un extremo del ACL, quite primero el extremo del ACL.</span><span class="sxs-lookup"><span data-stu-id="50af8-137">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="50af8-138">Para aprender a quitar una ACL, lea el artículo [Administración de listas de control de acceso de puntos de conexión con PowerShell](virtual-networks-acl-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-138">To learn how to remove an ACL, read the [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span></span>
> 

### <a name="nsg-rules"></a><span data-ttu-id="50af8-139">Reglas de grupo de seguridad de red</span><span class="sxs-lookup"><span data-stu-id="50af8-139">NSG rules</span></span>
<span data-ttu-id="50af8-140">Las reglas de grupo de seguridad de red contienen las siguientes propiedades:</span><span class="sxs-lookup"><span data-stu-id="50af8-140">NSG rules contain the following properties:</span></span>

| <span data-ttu-id="50af8-141">Propiedad</span><span class="sxs-lookup"><span data-stu-id="50af8-141">Property</span></span> | <span data-ttu-id="50af8-142">Description</span><span class="sxs-lookup"><span data-stu-id="50af8-142">Description</span></span> | <span data-ttu-id="50af8-143">Restricciones</span><span class="sxs-lookup"><span data-stu-id="50af8-143">Constraints</span></span> | <span data-ttu-id="50af8-144">Consideraciones</span><span class="sxs-lookup"><span data-stu-id="50af8-144">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="50af8-145">**Name**</span><span class="sxs-lookup"><span data-stu-id="50af8-145">**Name**</span></span> |<span data-ttu-id="50af8-146">Nombre de la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-146">Name for the rule.</span></span> |<span data-ttu-id="50af8-147">Debe ser único dentro de la región.</span><span class="sxs-lookup"><span data-stu-id="50af8-147">Must be unique within the region.</span></span><br/><span data-ttu-id="50af8-148">Puede incluir letras, números, caracteres de subrayado, puntos y guiones.</span><span class="sxs-lookup"><span data-stu-id="50af8-148">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="50af8-149">Debe empezar por una letra o un número.</span><span class="sxs-lookup"><span data-stu-id="50af8-149">Must start with a letter or number.</span></span><br/><span data-ttu-id="50af8-150">Debe finalizar en una letra, un número o un carácter de subrayado.</span><span class="sxs-lookup"><span data-stu-id="50af8-150">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="50af8-151">No puede superar los 80 caracteres.</span><span class="sxs-lookup"><span data-stu-id="50af8-151">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="50af8-152">Puede tener varias reglas dentro de un grupo de seguridad de red, de modo que asegúrese de seguir una convención de nomenclatura que le permita identificar su función.</span><span class="sxs-lookup"><span data-stu-id="50af8-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you to identify the function of your rule.</span></span> |
| <span data-ttu-id="50af8-153">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="50af8-153">**Protocol**</span></span> |<span data-ttu-id="50af8-154">Protocolo que debe coincidir con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-154">Protocol to match for the rule.</span></span> |<span data-ttu-id="50af8-155">TCP, UDP o *.</span><span class="sxs-lookup"><span data-stu-id="50af8-155">TCP, UDP, or *</span></span> |<span data-ttu-id="50af8-156">El uso de * como protocolo incluye ICMP (solo tráfico este-oeste), así como UDP y TCP, y puede reducir el número de reglas necesarias.</span><span class="sxs-lookup"><span data-stu-id="50af8-156">Using * as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce the number of rules you need.</span></span><br/><span data-ttu-id="50af8-157">Al mismo tiempo, usar * podría ser un enfoque demasiado amplio, por lo que se recomienda que solo lo use cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="50af8-157">At the same time, using * might be too broad an approach, so it's recommended that you use * only when necessary.</span></span> |
| <span data-ttu-id="50af8-158">**Intervalo de puertos de origen**</span><span class="sxs-lookup"><span data-stu-id="50af8-158">**Source port range**</span></span> |<span data-ttu-id="50af8-159">Intervalo de puertos de origen que debe coincidir con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-159">Source port range to match for the rule.</span></span> |<span data-ttu-id="50af8-160">Número de puerto único entre 1 y 65535, intervalo de puertos (ejemplo: 1-65535) o * (para todos los puertos).</span><span class="sxs-lookup"><span data-stu-id="50af8-160">Single port number from 1 to 65535, port range (example: 1-65535), or * (for all ports).</span></span> |<span data-ttu-id="50af8-161">Los puertos de origen podrían ser transitorios.</span><span class="sxs-lookup"><span data-stu-id="50af8-161">Source ports could be ephemeral.</span></span> <span data-ttu-id="50af8-162">A menos que el programa cliente use un puerto concreto, utilice * en la mayoría de los casos.</span><span class="sxs-lookup"><span data-stu-id="50af8-162">Unless your client program is using a specific port, use * in most cases.</span></span><br/><span data-ttu-id="50af8-163">Pruebe a usar intervalos de puertos tanto como sea posible para evitar tener que utilizar varias reglas.</span><span class="sxs-lookup"><span data-stu-id="50af8-163">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="50af8-164">Los distintos puertos o intervalos de puertos no se pueden agrupar mediante una coma.</span><span class="sxs-lookup"><span data-stu-id="50af8-164">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="50af8-165">**Intervalo de puertos de destino**</span><span class="sxs-lookup"><span data-stu-id="50af8-165">**Destination port range**</span></span> |<span data-ttu-id="50af8-166">Intervalo de puertos de destino que debe coincidir con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-166">Destination port range to match for the rule.</span></span> |<span data-ttu-id="50af8-167">Número de puerto único entre 1 y 65535, intervalo de puertos (ejemplo: 1-65535) o \* (para todos los puertos).</span><span class="sxs-lookup"><span data-stu-id="50af8-167">Single port number from 1 to 65535, port range (example: 1-65535), or \* (for all ports).</span></span> |<span data-ttu-id="50af8-168">Pruebe a usar intervalos de puertos tanto como sea posible para evitar tener que utilizar varias reglas.</span><span class="sxs-lookup"><span data-stu-id="50af8-168">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="50af8-169">Los distintos puertos o intervalos de puertos no se pueden agrupar mediante una coma.</span><span class="sxs-lookup"><span data-stu-id="50af8-169">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="50af8-170">**Prefijo de dirección de origen**</span><span class="sxs-lookup"><span data-stu-id="50af8-170">**Source address prefix**</span></span> |<span data-ttu-id="50af8-171">Prefijo o etiqueta de la dirección de origen que debe coincidir con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-171">Source address prefix or tag to match for the rule.</span></span> |<span data-ttu-id="50af8-172">Dirección IP única (ejemplo: 10.10.10.10), subred IP (ejemplo: 192.168.1.0/24), [etiqueta predeterminada](#default-tags) o * (para todas las direcciones).</span><span class="sxs-lookup"><span data-stu-id="50af8-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="50af8-173">Considere la posibilidad de usar intervalos, etiquetas predeterminadas y * para reducir el número de reglas.</span><span class="sxs-lookup"><span data-stu-id="50af8-173">Consider using ranges, default tags, and * to reduce the number of rules.</span></span> |
| <span data-ttu-id="50af8-174">**Prefijo de dirección de destino**</span><span class="sxs-lookup"><span data-stu-id="50af8-174">**Destination address prefix**</span></span> |<span data-ttu-id="50af8-175">Prefijo o etiqueta de la dirección de destino que debe coincidir con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-175">Destination address prefix or tag to match for the rule.</span></span> | <span data-ttu-id="50af8-176">Dirección IP única (ejemplo: 10.10.10.10), subred IP (ejemplo: 192.168.1.0/24), [etiqueta predeterminada](#default-tags) o * (para todas las direcciones).</span><span class="sxs-lookup"><span data-stu-id="50af8-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="50af8-177">Considere la posibilidad de usar intervalos, etiquetas predeterminadas y * para reducir el número de reglas.</span><span class="sxs-lookup"><span data-stu-id="50af8-177">Consider using ranges, default tags, and * to reduce the number of rules.</span></span> |
| <span data-ttu-id="50af8-178">**Dirección**</span><span class="sxs-lookup"><span data-stu-id="50af8-178">**Direction**</span></span> |<span data-ttu-id="50af8-179">Dirección del tráfico que debe coincidir con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-179">Direction of traffic to match for the rule.</span></span> |<span data-ttu-id="50af8-180">De entrada o de salida.</span><span class="sxs-lookup"><span data-stu-id="50af8-180">Inbound or outbound.</span></span> |<span data-ttu-id="50af8-181">Las reglas de entrada y de salida se procesan por separado, en función de la dirección.</span><span class="sxs-lookup"><span data-stu-id="50af8-181">Inbound and outbound rules are processed separately, based on direction.</span></span> |
| <span data-ttu-id="50af8-182">**Prioridad**</span><span class="sxs-lookup"><span data-stu-id="50af8-182">**Priority**</span></span> |<span data-ttu-id="50af8-183">Las reglas se comprueban por orden de prioridad.</span><span class="sxs-lookup"><span data-stu-id="50af8-183">Rules are checked in the order of priority.</span></span> <span data-ttu-id="50af8-184">Una vez que se aplica una regla, no se comprueba si las demás coinciden.</span><span class="sxs-lookup"><span data-stu-id="50af8-184">Once a rule applies, no more rules are tested for matching.</span></span> | <span data-ttu-id="50af8-185">Número entre 100 y 4096.</span><span class="sxs-lookup"><span data-stu-id="50af8-185">Number between 100 and 4096.</span></span> | <span data-ttu-id="50af8-186">Considere la posibilidad de crear prioridades de salto de reglas por 100 para cada regla, para dejar espacio para las que cree en el futuro.</span><span class="sxs-lookup"><span data-stu-id="50af8-186">Consider creating rules jumping priorities by 100 for each rule to leave space for new rules you might create in the future.</span></span> |
| <span data-ttu-id="50af8-187">**Access**</span><span class="sxs-lookup"><span data-stu-id="50af8-187">**Access**</span></span> |<span data-ttu-id="50af8-188">Tipo de acceso que se debe aplicar si coincide con la regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-188">Type of access to apply if the rule matches.</span></span> | <span data-ttu-id="50af8-189">Permítalo o deniéguelo.</span><span class="sxs-lookup"><span data-stu-id="50af8-189">Allow or deny.</span></span> | <span data-ttu-id="50af8-190">Tenga en cuenta que, si no se encuentra una regla de permiso para un paquete, el paquete se descarta.</span><span class="sxs-lookup"><span data-stu-id="50af8-190">Keep in mind that if an allow rule is not found for a packet, the packet is dropped.</span></span> |

<span data-ttu-id="50af8-191">Los grupos de seguridad de red contienen dos tipos de reglas: de entrada y de salida.</span><span class="sxs-lookup"><span data-stu-id="50af8-191">NSGs contain two sets of rules: Inbound and outbound.</span></span> <span data-ttu-id="50af8-192">La prioridad de una regla debe ser única dentro de cada conjunto.</span><span class="sxs-lookup"><span data-stu-id="50af8-192">The priority for a rule must be unique within each set.</span></span> 

![Procesamiento de reglas de NSG](./media/virtual-network-nsg-overview/figure3.png) 

<span data-ttu-id="50af8-194">En la imagen anterior se muestra cómo se procesan las reglas de grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-194">The previous picture shows how NSG rules are processed.</span></span>

### <a name="default-tags"></a><span data-ttu-id="50af8-195">Etiquetas predeterminadas</span><span class="sxs-lookup"><span data-stu-id="50af8-195">Default Tags</span></span>
<span data-ttu-id="50af8-196">Las etiquetas predeterminadas son identificadores proporcionados por el sistema para tratar una categoría de direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="50af8-196">Default tags are system-provided identifiers to address a category of IP addresses.</span></span> <span data-ttu-id="50af8-197">Puede usar etiquetas predeterminadas en las propiedades de **prefijo de dirección de origen** y **prefijo de dirección de destino** de cualquier regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-197">You can use default tags in the **source address prefix** and **destination address prefix** properties of any rule.</span></span> <span data-ttu-id="50af8-198">Hay tres etiquetas predeterminadas que puede utilizar:</span><span class="sxs-lookup"><span data-stu-id="50af8-198">There are three default tags you can use:</span></span>

* <span data-ttu-id="50af8-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** para el modelo clásico): esta etiqueta incluye el espacio de direcciones de red virtual (intervalos CIDR definidos en Azure), todos los espacios de direcciones locales conectados y las redes virtuales de Azure conectadas (redes locales).</span><span class="sxs-lookup"><span data-stu-id="50af8-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes the virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span></span>
* <span data-ttu-id="50af8-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** para el modelo clásico): esta etiqueta denota el equilibrador de carga de la infraestructura de Azure.</span><span class="sxs-lookup"><span data-stu-id="50af8-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span></span> <span data-ttu-id="50af8-201">La etiqueta se traducirá en una IP de centro de datos de Azure donde se originan los sondeos de mantenimiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="50af8-201">The tag translates to an Azure datacenter IP where Azure’s health probes originate.</span></span>
* <span data-ttu-id="50af8-202">**Internet** (Resource Manager) (**INTERNET** para el modelo clásico): esta etiqueta denota el espacio de direcciones IP que se encuentra fuera de la red virtual y es accesible mediante la red pública de Internet.</span><span class="sxs-lookup"><span data-stu-id="50af8-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes the IP address space that is outside the virtual network and reachable by public Internet.</span></span> <span data-ttu-id="50af8-203">El intervalo incluye además el [espacio de IP públicas propiedad de Azure](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="50af8-203">The range includes the [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>

### <a name="default-rules"></a><span data-ttu-id="50af8-204">Reglas predeterminadas</span><span class="sxs-lookup"><span data-stu-id="50af8-204">Default rules</span></span>
<span data-ttu-id="50af8-205">Todos los grupos de seguridad de red contienen un conjunto de reglas predeterminadas.</span><span class="sxs-lookup"><span data-stu-id="50af8-205">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="50af8-206">No se pueden eliminar las reglas predeterminadas, pero dado que tienen asignada la mínima prioridad, pueden reemplazarse por las reglas que cree.</span><span class="sxs-lookup"><span data-stu-id="50af8-206">The default rules cannot be deleted, but because they are assigned the lowest priority, they can be overridden by the rules that you create.</span></span> 

<span data-ttu-id="50af8-207">Las reglas predeterminadas permiten y deniegan el tráfico como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="50af8-207">The default rules allow and disallow traffic as follows:</span></span>
- <span data-ttu-id="50af8-208">**Red virtual:** el tráfico que se origina y termina en una red virtual se permite en las direcciones tanto de entrada como de salida.</span><span class="sxs-lookup"><span data-stu-id="50af8-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span></span>
- <span data-ttu-id="50af8-209">**Internet:** se permite el tráfico saliente, pero se bloquea el entrante.</span><span class="sxs-lookup"><span data-stu-id="50af8-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span></span>
- <span data-ttu-id="50af8-210">**Equilibrador de carga:** permita que el equilibrador de carga de Azure sondee el estado de las máquinas virtuales y las instancias de rol.</span><span class="sxs-lookup"><span data-stu-id="50af8-210">**Load balancer:** Allow Azure’s load balancer to probe the health of your VMs and role instances.</span></span> <span data-ttu-id="50af8-211">Si no va a usar un conjunto con equilibrio de carga, puede invalidar esta regla.</span><span class="sxs-lookup"><span data-stu-id="50af8-211">If you are not using a load balanced set you can override this rule.</span></span>

<span data-ttu-id="50af8-212">**Reglas predeterminadas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-212">**Inbound default rules**</span></span>

| <span data-ttu-id="50af8-213">Nombre</span><span class="sxs-lookup"><span data-stu-id="50af8-213">Name</span></span> | <span data-ttu-id="50af8-214">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-214">Priority</span></span> | <span data-ttu-id="50af8-215">IP de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-215">Source IP</span></span> | <span data-ttu-id="50af8-216">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-216">Source Port</span></span> | <span data-ttu-id="50af8-217">IP de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-217">Destination IP</span></span> | <span data-ttu-id="50af8-218">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-218">Destination Port</span></span> | <span data-ttu-id="50af8-219">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-219">Protocol</span></span> | <span data-ttu-id="50af8-220">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-220">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-221">AllowVNetInBound</span><span class="sxs-lookup"><span data-stu-id="50af8-221">AllowVNetInBound</span></span> |<span data-ttu-id="50af8-222">65000</span><span class="sxs-lookup"><span data-stu-id="50af8-222">65000</span></span> | <span data-ttu-id="50af8-223">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="50af8-223">VirtualNetwork</span></span> | * | <span data-ttu-id="50af8-224">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="50af8-224">VirtualNetwork</span></span> | * | * | <span data-ttu-id="50af8-225">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-225">Allow</span></span> |
| <span data-ttu-id="50af8-226">AllowAzureLoadBalancerInBound</span><span class="sxs-lookup"><span data-stu-id="50af8-226">AllowAzureLoadBalancerInBound</span></span> | <span data-ttu-id="50af8-227">65001</span><span class="sxs-lookup"><span data-stu-id="50af8-227">65001</span></span> | <span data-ttu-id="50af8-228">AzureLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="50af8-228">AzureLoadBalancer</span></span> | * | * | * | * | <span data-ttu-id="50af8-229">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-229">Allow</span></span> |
| <span data-ttu-id="50af8-230">DenyAllInBound</span><span class="sxs-lookup"><span data-stu-id="50af8-230">DenyAllInBound</span></span> |<span data-ttu-id="50af8-231">65500</span><span class="sxs-lookup"><span data-stu-id="50af8-231">65500</span></span> | * | * | * | * | * | <span data-ttu-id="50af8-232">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-232">Deny</span></span> |

<span data-ttu-id="50af8-233">**Reglas predeterminadas de salida**</span><span class="sxs-lookup"><span data-stu-id="50af8-233">**Outbound default rules**</span></span>

| <span data-ttu-id="50af8-234">Nombre</span><span class="sxs-lookup"><span data-stu-id="50af8-234">Name</span></span> | <span data-ttu-id="50af8-235">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-235">Priority</span></span> | <span data-ttu-id="50af8-236">IP de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-236">Source IP</span></span> | <span data-ttu-id="50af8-237">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-237">Source Port</span></span> | <span data-ttu-id="50af8-238">IP de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-238">Destination IP</span></span> | <span data-ttu-id="50af8-239">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-239">Destination Port</span></span> | <span data-ttu-id="50af8-240">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-240">Protocol</span></span> | <span data-ttu-id="50af8-241">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-241">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-242">AllowVnetOutBound</span><span class="sxs-lookup"><span data-stu-id="50af8-242">AllowVnetOutBound</span></span> | <span data-ttu-id="50af8-243">65000</span><span class="sxs-lookup"><span data-stu-id="50af8-243">65000</span></span> | <span data-ttu-id="50af8-244">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="50af8-244">VirtualNetwork</span></span> | * | <span data-ttu-id="50af8-245">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="50af8-245">VirtualNetwork</span></span> | * | * | <span data-ttu-id="50af8-246">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-246">Allow</span></span> |
| <span data-ttu-id="50af8-247">AllowInternetOutBound</span><span class="sxs-lookup"><span data-stu-id="50af8-247">AllowInternetOutBound</span></span> | <span data-ttu-id="50af8-248">65001</span><span class="sxs-lookup"><span data-stu-id="50af8-248">65001</span></span> | * | * | <span data-ttu-id="50af8-249">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-249">Internet</span></span> | * | * | <span data-ttu-id="50af8-250">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-250">Allow</span></span> |
| <span data-ttu-id="50af8-251">DenyAllOutBound</span><span class="sxs-lookup"><span data-stu-id="50af8-251">DenyAllOutBound</span></span> | <span data-ttu-id="50af8-252">65500</span><span class="sxs-lookup"><span data-stu-id="50af8-252">65500</span></span> | * | * | * | * | * | <span data-ttu-id="50af8-253">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-253">Deny</span></span> |

## <a name="associating-nsgs"></a><span data-ttu-id="50af8-254">Asociación de grupos de seguridad de red </span><span class="sxs-lookup"><span data-stu-id="50af8-254">Associating NSGs</span></span>
<span data-ttu-id="50af8-255">Puede asociar un grupo de seguridad de red a máquinas virtuales, interfaces de red y subredes, según el modelo de implementación que use, de la forma siguiente:</span><span class="sxs-lookup"><span data-stu-id="50af8-255">You can associate an NSG to VMs, NICs, and subnets, depending on the deployment model you are using, as follows:</span></span>

* <span data-ttu-id="50af8-256">**Máquina virtual (solo clásica):** las reglas de seguridad se aplican a todo el tráfico hacia la máquina virtual y desde ella.</span><span class="sxs-lookup"><span data-stu-id="50af8-256">**VM (classic only):** Security rules are applied to all traffic to/from the VM.</span></span> 
* <span data-ttu-id="50af8-257">**Interfaz de red (solo Resource Manager):** las reglas de seguridad se aplican a todo el tráfico hacia la interfaz de red a la que está asociado el grupo de seguridad de red y desde ella.</span><span class="sxs-lookup"><span data-stu-id="50af8-257">**NIC (Resource Manager only):** Security rules are applied to all traffic to/from the NIC the NSG is associated to.</span></span> <span data-ttu-id="50af8-258">En una máquina virtual con varias interfaces de red, puede aplicar diferentes grupos de seguridad de red (o uno mismo) a cada interfaz de red individualmente.</span><span class="sxs-lookup"><span data-stu-id="50af8-258">In a multi-NIC VM, you can apply different (or the same) NSG to each NIC individually.</span></span> 
* <span data-ttu-id="50af8-259">**Subred (Resource Manager y clásica):** las reglas de seguridad se aplican a todo el tráfico hacia cualquier recurso conectado a la red virtual y desde ella.</span><span class="sxs-lookup"><span data-stu-id="50af8-259">**Subnet (Resource Manager and classic):** Security rules are applied to any traffic to/from any resources connected to the VNet.</span></span>

<span data-ttu-id="50af8-260">Puede asociar grupos de seguridad de red diferentes a una máquina virtual (o interfaz de red, según el modelo de implementación) y a la subred a la que está conectada una interfaz de red o una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-260">You can associate different NSGs to a VM (or NIC, depending on the deployment model) and the subnet that a NIC or VM is connected to.</span></span> <span data-ttu-id="50af8-261">Las reglas de seguridad se aplican al tráfico, por prioridad, en cada grupo de seguridad de red, en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="50af8-261">Security rules are applied to the traffic, by priority, in each NSG, in the following order:</span></span>

- <span data-ttu-id="50af8-262">**Tráfico de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-262">**Inbound traffic**</span></span>

  1. <span data-ttu-id="50af8-263">**Grupo de seguridad de red aplicado a subred:** si un grupo de seguridad de red de la subred tiene una regla de coincidencia para denegar el tráfico, el paquete se descarta.</span><span class="sxs-lookup"><span data-stu-id="50af8-263">**NSG applied to subnet:** If a subnet NSG has a matching rule to deny traffic, the packet is dropped.</span></span>

  2. <span data-ttu-id="50af8-264">**Grupo de seguridad de red aplicado a interfaz de red** (Resource Manager) o máquina virtual (clásica): si un grupo de seguridad de red de la máquina virtual o la interfaz de red tiene una regla de coincidencia que deniega el tráfico, los paquetes se descartan en la máquina virtual o la interfaz de red, incluso si el grupo de seguridad de red de la subred tiene una regla de coincidencia que permita el tráfico.</span><span class="sxs-lookup"><span data-stu-id="50af8-264">**NSG applied to NIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at the VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span></span>

- <span data-ttu-id="50af8-265">**Tráfico de salida**</span><span class="sxs-lookup"><span data-stu-id="50af8-265">**Outbound traffic**</span></span>

  1. <span data-ttu-id="50af8-266">**Grupo de seguridad de red aplicado a una interfaz de red** (Resource Manager) o máquina virtual (clásica): si el grupo de seguridad de red de la máquina virtual o la interfaz de red tiene una regla de coincidencia que deniega el tráfico, los paquetes se descartan.</span><span class="sxs-lookup"><span data-stu-id="50af8-266">**NSG applied to NIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span></span>

  2. <span data-ttu-id="50af8-267">**Grupo de seguridad de red aplicado a subred**: si un grupo de seguridad de red de la subred tiene una regla de coincidencia que deniega el tráfico, los paquetes se descartan, incluso si el grupo de seguridad de red de la máquina virtual o la interfaz de red tiene una regla de coincidencia que permita el tráfico.</span><span class="sxs-lookup"><span data-stu-id="50af8-267">**NSG applied to subnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="50af8-268">Aunque solamente se puede asociar un solo grupo de seguridad de red a una subred, VM o NIC, puede asociar el mismo grupo de seguridad de red a tantos recursos como desee.</span><span class="sxs-lookup"><span data-stu-id="50af8-268">Although you can only associate a single NSG to a subnet, VM, or NIC; you can associate the same NSG to as many resources as you want.</span></span>
>

## <a name="implementation"></a><span data-ttu-id="50af8-269">Implementación</span><span class="sxs-lookup"><span data-stu-id="50af8-269">Implementation</span></span>
<span data-ttu-id="50af8-270">Puede implementar los grupos de seguridad de red en el modelo de implementación clásica o de Resource Manager con las siguientes herramientas:</span><span class="sxs-lookup"><span data-stu-id="50af8-270">You can implement NSGs in the Resource Manager or classic deployment models using the following tools:</span></span>

| <span data-ttu-id="50af8-271">Herramienta de implementación</span><span class="sxs-lookup"><span data-stu-id="50af8-271">Deployment tool</span></span> | <span data-ttu-id="50af8-272">Clásico</span><span class="sxs-lookup"><span data-stu-id="50af8-272">Classic</span></span> | <span data-ttu-id="50af8-273">Resource Manager</span><span class="sxs-lookup"><span data-stu-id="50af8-273">Resource Manager</span></span> |
| --- | --- | --- |
| <span data-ttu-id="50af8-274">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="50af8-274">Azure portal</span></span>   | <span data-ttu-id="50af8-275">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-275">Yes</span></span> | [<span data-ttu-id="50af8-276">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-276">Yes</span></span>](virtual-networks-create-nsg-arm-pportal.md) |
| <span data-ttu-id="50af8-277">PowerShell</span><span class="sxs-lookup"><span data-stu-id="50af8-277">PowerShell</span></span>     | [<span data-ttu-id="50af8-278">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-278">Yes</span></span>](virtual-networks-create-nsg-classic-ps.md) | [<span data-ttu-id="50af8-279">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-279">Yes</span></span>](virtual-networks-create-nsg-arm-ps.md) |
| <span data-ttu-id="50af8-280">CLI de Azure **V1**</span><span class="sxs-lookup"><span data-stu-id="50af8-280">Azure CLI **V1**</span></span>   | [<span data-ttu-id="50af8-281">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-281">Yes</span></span>](virtual-networks-create-nsg-classic-cli.md) | [<span data-ttu-id="50af8-282">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-282">Yes</span></span>](virtual-networks-create-nsg-cli-nodejs.md) |
| <span data-ttu-id="50af8-283">CLI de Azure **V2**</span><span class="sxs-lookup"><span data-stu-id="50af8-283">Azure CLI **V2**</span></span>   | <span data-ttu-id="50af8-284">No</span><span class="sxs-lookup"><span data-stu-id="50af8-284">No</span></span> | [<span data-ttu-id="50af8-285">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-285">Yes</span></span>](virtual-networks-create-nsg-arm-cli.md) |
| <span data-ttu-id="50af8-286">Plantilla del Administrador de recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="50af8-286">Azure Resource Manager template</span></span>   | <span data-ttu-id="50af8-287">No</span><span class="sxs-lookup"><span data-stu-id="50af8-287">No</span></span>  | [<span data-ttu-id="50af8-288">Sí</span><span class="sxs-lookup"><span data-stu-id="50af8-288">Yes</span></span>](virtual-networks-create-nsg-arm-template.md) |

## <a name="planning"></a><span data-ttu-id="50af8-289">Planificación</span><span class="sxs-lookup"><span data-stu-id="50af8-289">Planning</span></span>
<span data-ttu-id="50af8-290">Antes de implementar los grupos de seguridad de red, deberá responder a las siguientes preguntas:</span><span class="sxs-lookup"><span data-stu-id="50af8-290">Before implementing NSGs, you need to answer the following questions:</span></span>

1. <span data-ttu-id="50af8-291">¿Para qué tipos de recursos desea filtrar el tráfico entrante o saliente?</span><span class="sxs-lookup"><span data-stu-id="50af8-291">What types of resources do you want to filter traffic to or from?</span></span> <span data-ttu-id="50af8-292">Puede conectarse a recursos como interfaces de red (Resource Manager), máquinas virtuales (clásicas), Cloud Services, entornos de servicio de aplicación y conjuntos de escalado de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="50af8-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span></span> 
2. <span data-ttu-id="50af8-293">¿Estás los recursos para los que desea filtrar tráfico entrante o saliente conectados a subredes en redes virtuales existentes?</span><span class="sxs-lookup"><span data-stu-id="50af8-293">Are the resources you want to filter traffic to/from connected to subnets in existing VNets?</span></span>

<span data-ttu-id="50af8-294">Para más información sobre cómo planear la seguridad de red en Azure, lea el artículo [Servicios en la nube de Microsoft y seguridad de red](../best-practices-network-security.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-294">For more information on planning for network security in Azure, read the [Cloud services and network security](../best-practices-network-security.md) article.</span></span> 

## <a name="design-considerations"></a><span data-ttu-id="50af8-295">Consideraciones de diseño</span><span class="sxs-lookup"><span data-stu-id="50af8-295">Design considerations</span></span>
<span data-ttu-id="50af8-296">Una vez que sepa las respuestas a las preguntas de la sección [Planeación](#Planning), revise las siguientes secciones antes de definir los grupos de seguridad de red:</span><span class="sxs-lookup"><span data-stu-id="50af8-296">Once you know the answers to the questions in the [Planning](#Planning) section, review the following sections before defining your NSGs:</span></span>

### <a name="limits"></a><span data-ttu-id="50af8-297">Límites</span><span class="sxs-lookup"><span data-stu-id="50af8-297">Limits</span></span>
<span data-ttu-id="50af8-298">Existen límites para el número de grupos de seguridad de red puede tener en una suscripción y el número de reglas por grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-298">There are limits to the number of NSGs you can have in a subscription and number of rules per NSG.</span></span> <span data-ttu-id="50af8-299">Para más información sobre los límites, lea el artículo sobre los [límites de Azure](../azure-subscription-service-limits.md#networking-limits).</span><span class="sxs-lookup"><span data-stu-id="50af8-299">To learn more about the limits, read the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span></span>

### <a name="vnet-and-subnet-design"></a><span data-ttu-id="50af8-300">Diseño de red virtual y subred</span><span class="sxs-lookup"><span data-stu-id="50af8-300">VNet and subnet design</span></span>
<span data-ttu-id="50af8-301">Puesto que los grupos de seguridad de red se pueden aplicar a subredes, puede minimizar el número de ellos si agrupa los recursos por subred y aplica estos grupos a subredes.</span><span class="sxs-lookup"><span data-stu-id="50af8-301">Since NSGs can be applied to subnets, you can minimize the number of NSGs by grouping your resources by subnet, and applying NSGs to subnets.</span></span>  <span data-ttu-id="50af8-302">Si decide aplicar grupos de seguridad de red a subredes, puede encontrarse con que las redes virtuales y subredes existentes que tenga se hayan definido sin tenerlos en cuenta.</span><span class="sxs-lookup"><span data-stu-id="50af8-302">If you decide to apply NSGs to subnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span></span> <span data-ttu-id="50af8-303">Es posible que tenga que definir nuevas redes virtuales y subredes para admitir el diseño de grupos de seguridad de red e implementar nuevos recursos en sus nuevas subredes.</span><span class="sxs-lookup"><span data-stu-id="50af8-303">You may need to define new VNets and subnets to support your NSG design and deploy your new resources to your new subnets.</span></span> <span data-ttu-id="50af8-304">Luego, podría definir una estrategia de migración para mover los recursos existentes a las nuevas subredes.</span><span class="sxs-lookup"><span data-stu-id="50af8-304">You could then define a migration strategy to move existing resources to the new subnets.</span></span> 

### <a name="special-rules"></a><span data-ttu-id="50af8-305">Reglas especiales</span><span class="sxs-lookup"><span data-stu-id="50af8-305">Special rules</span></span>
<span data-ttu-id="50af8-306">Si bloquea el tráfico permitido por las reglas siguientes, la infraestructura no puede comunicarse con servicios de Azure esenciales:</span><span class="sxs-lookup"><span data-stu-id="50af8-306">If you block traffic allowed by the following rules, your infrastructure can't communicate with essential Azure services:</span></span>

* <span data-ttu-id="50af8-307">**IP virtual del nodo de host:** los servicios de infraestructura básica, como DHCP, DNS y seguimiento de estado se proporcionan a través de la dirección IP de host virtualizada 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="50af8-307">**Virtual IP of the host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through the virtualized host IP address 168.63.129.16.</span></span> <span data-ttu-id="50af8-308">Esta dirección IP pública pertenece a Microsoft y es la única dirección IP virtualizada que se usará en todas las regiones con este fin.</span><span class="sxs-lookup"><span data-stu-id="50af8-308">This public IP address belongs to Microsoft and is the only virtualized IP address used in all regions for this purpose.</span></span> <span data-ttu-id="50af8-309">Esta dirección IP se asigna a la dirección IP física del equipo del servidor (nodo de host) que hospeda la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-309">This IP address maps to the physical IP address of the server machine (host node) hosting the VM.</span></span> <span data-ttu-id="50af8-310">El nodo de host actúa como la retransmisión DHCP, la resolución recursiva de DNS y el origen de sonda del sondeo de mantenimiento del equilibrador de carga y el sondeo de mantenimiento del equipo.</span><span class="sxs-lookup"><span data-stu-id="50af8-310">The host node acts as the DHCP relay, the DNS recursive resolver, and the probe source for the load balancer health probe and the machine health probe.</span></span> <span data-ttu-id="50af8-311">La comunicación con esta dirección IP no constituye un ataque.</span><span class="sxs-lookup"><span data-stu-id="50af8-311">Communication to this IP address is not an attack.</span></span>
* <span data-ttu-id="50af8-312">**Licencias (Servicio de administración de claves):** las imágenes de Windows que se ejecutan en máquinas virtuales deben contar con licencia.</span><span class="sxs-lookup"><span data-stu-id="50af8-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span></span> <span data-ttu-id="50af8-313">Para garantizar que se usen licencias, se envía una solicitud a los servidores host del Servicio de administración de claves que administran dichas consultas.</span><span class="sxs-lookup"><span data-stu-id="50af8-313">To ensure licensing, a request is sent to the Key Management Service host servers that handle such queries.</span></span> <span data-ttu-id="50af8-314">La solicitud de salida se realiza a través del puerto 1688.</span><span class="sxs-lookup"><span data-stu-id="50af8-314">The request is made outbound through port 1688.</span></span>

### <a name="icmp-traffic"></a><span data-ttu-id="50af8-315">Tráfico ICMP</span><span class="sxs-lookup"><span data-stu-id="50af8-315">ICMP traffic</span></span>
<span data-ttu-id="50af8-316">Las reglas de los grupos de seguridad de red actuales solo permiten los protocolos *TCP* o *UDP*.</span><span class="sxs-lookup"><span data-stu-id="50af8-316">The current NSG rules only allow for protocols *TCP* or *UDP*.</span></span> <span data-ttu-id="50af8-317">No hay una etiqueta específica para *ICMP*.</span><span class="sxs-lookup"><span data-stu-id="50af8-317">There is not a specific tag for *ICMP*.</span></span> <span data-ttu-id="50af8-318">Sin embargo, se permite el tráfico ICMP dentro de una red virtual por la regla predeterminada AllowVNetInBound, que permite el tráfico entrante y saliente en cualquier puerto y protocolo dentro de la red virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-318">However, ICMP traffic is allowed within a VNet by the AllowVNetInBound default rule, that allows traffic to and from any port and protocol within the VNet.</span></span>

### <a name="subnets"></a><span data-ttu-id="50af8-319">Subredes</span><span class="sxs-lookup"><span data-stu-id="50af8-319">Subnets</span></span>
* <span data-ttu-id="50af8-320">Tenga en cuenta el número de niveles que requiere la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="50af8-320">Consider the number of tiers your workload requires.</span></span> <span data-ttu-id="50af8-321">Cada nivel se puede aislar mediante el uso de una subred, y a cada subred se le aplica un grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-321">Each tier can be isolated by using a subnet, with an NSG applied to the subnet.</span></span> 
* <span data-ttu-id="50af8-322">Si necesita implementar una subred para una puerta de enlace de VPN o un circuito ExpressRoute, **no** aplique un grupo de seguridad de red a esa subred.</span><span class="sxs-lookup"><span data-stu-id="50af8-322">If you need to implement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG to that subnet.</span></span> <span data-ttu-id="50af8-323">Si lo hace, es posible que la conectividad entre entornos locales o entre redes virtuales no funcione.</span><span class="sxs-lookup"><span data-stu-id="50af8-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span></span> 
* <span data-ttu-id="50af8-324">Si necesita implementar una aplicación virtual de red (NVA), conecte dicha aplicación a su propia subred y cree rutas definidas por el usuario (UDR) hacia la aplicación y desde ella.</span><span class="sxs-lookup"><span data-stu-id="50af8-324">If you need to implement a network virtual appliance (NVA), connect the NVA to its own subnet and create user-defined routes (UDR) to and from the NVA.</span></span> <span data-ttu-id="50af8-325">Puede implementar un grupo de seguridad de red de nivel de subred para filtrar el tráfico dentro y fuera de esta subred.</span><span class="sxs-lookup"><span data-stu-id="50af8-325">You can implement a subnet level NSG to filter traffic in and out of this subnet.</span></span> <span data-ttu-id="50af8-326">Para aprender más sobre las rutas definidas por el usuario, lea el artículo [Rutas definidas por el usuario](virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-326">To learn more about UDRs, read the [User-defined routes](virtual-networks-udr-overview.md) article.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="50af8-327">Equilibradores de carga</span><span class="sxs-lookup"><span data-stu-id="50af8-327">Load balancers</span></span>
* <span data-ttu-id="50af8-328">Tenga en cuenta las reglas de equilibrio de red y traducción de direcciones de red (NAT) para cada equilibrador de carga usado en cada una de las cargas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="50af8-328">Consider the load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span></span> <span data-ttu-id="50af8-329">Las reglas NAT se enlazan a un grupo de back-end que contiene interfaces de red (Resource Manager) o máquinas virtuales e instancias de rol de Cloud Services (clásicas).</span><span class="sxs-lookup"><span data-stu-id="50af8-329">NAT rules are bound to a back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span></span> <span data-ttu-id="50af8-330">Considere la posibilidad de crear un grupo de seguridad de red para cada grupo de back-end, de forma que solo se permita el tráfico asignado mediante las reglas implementadas en los equilibradores de carga.</span><span class="sxs-lookup"><span data-stu-id="50af8-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through the rules implemented in the load balancers.</span></span> <span data-ttu-id="50af8-331">Con la creación de un grupo de seguridad de red para cada grupo de back-end, se garantiza que el tráfico que llegue al grupo de back-end directamente (en lugar de a través del equilibrador de carga) también se filtre.</span><span class="sxs-lookup"><span data-stu-id="50af8-331">Creating an NSG for each back-end pool guarantees that traffic coming to the back-end pool directly (rather than through the load balancer), is also filtered.</span></span>
* <span data-ttu-id="50af8-332">En implementaciones clásicas, cree puntos de conexión que asignen puertos de un equilibrador de carga a puertos de las máquinas virtuales o instancias de rol.</span><span class="sxs-lookup"><span data-stu-id="50af8-332">In classic deployments, you create endpoints that map ports on a load balancer to ports on your VMs or role instances.</span></span> <span data-ttu-id="50af8-333">También puede crear su propio equilibrador de carga de acceso público individual mediante Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="50af8-333">You can also create your own individual public-facing load balancer through Resource Manager.</span></span> <span data-ttu-id="50af8-334">El puerto de destino para el tráfico entrante es el puerto real en la máquina virtual o la instancia de rol, no el expuesto por un equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="50af8-334">The destination port for incoming traffic is the actual port in the VM or role instance, not the port exposed by a load balancer.</span></span> <span data-ttu-id="50af8-335">La dirección y el puerto de origen para la conexión a la máquina virtual se encuentran en el equipo remoto en Internet, no son los que expone el equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="50af8-335">The source port and address for the connection to the VM is a port and address on the remote computer in the Internet, not the port and address exposed by the load balancer.</span></span>
* <span data-ttu-id="50af8-336">Cuando crea grupos de seguridad de red para filtrar el tráfico que llega a través de un equilibrador de carga interno (ILB), el puerto y el intervalo de direcciones de origen aplicados son del equipo de origen, no del equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="50af8-336">When you create NSGs to filter traffic coming through an internal load balancer (ILB), the source port and address range applied are  from the originating computer, not the load balancer.</span></span> <span data-ttu-id="50af8-337">El puerto y el intervalo de direcciones de destino son los del equipo de destino, no del equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="50af8-337">The destination port and address range are those of the destination computer, not the load balancer.</span></span>

### <a name="other"></a><span data-ttu-id="50af8-338">Otros</span><span class="sxs-lookup"><span data-stu-id="50af8-338">Other</span></span>
* <span data-ttu-id="50af8-339">No se admiten listas de control de acceso (ACL) ni grupos de seguridad basados en puntos de conexión en la misma instancia de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-339">Endpoint-based access control lists (ACL) and NSGs are not supported on the same VM instance.</span></span> <span data-ttu-id="50af8-340">Si desea usar un grupo de seguridad de red y ya tiene un extremo del ACL, quite primero el extremo del ACL.</span><span class="sxs-lookup"><span data-stu-id="50af8-340">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="50af8-341">Para información sobre cómo quitar una ACL de punto de conexión, consulte el artículo [Administración de listas de control de acceso de puntos de conexión](virtual-networks-acl-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-341">For information about how to remove an endpoint ACL, see the [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span></span>
* <span data-ttu-id="50af8-342">En Resource Manager, puede usar un grupo de seguridad de red asociado a una interfaz de red para máquinas virtuales con varias interfaces de red a fin de habilitar la administración (acceso remoto) para cada interfaz.</span><span class="sxs-lookup"><span data-stu-id="50af8-342">In Resource Manager, you can use an NSG associated to a NIC for VMs with multiple NICs to enable management (remote access) on a per NIC basis.</span></span> <span data-ttu-id="50af8-343">La asociación de grupos de seguridad de red únicos a cada interfaz de red permite separar los tipos de tráfico entre las interfaces de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-343">Associating unique NSGs to each NIC enables separation of traffic types across NICs.</span></span>
* <span data-ttu-id="50af8-344">De forma parecida al uso de los equilibradores de carga, al filtrar el tráfico de otras redes virtuales, debe usar el intervalo de direcciones de origen del equipo remoto, y no la puerta de enlace que conecta las redes virtuales.</span><span class="sxs-lookup"><span data-stu-id="50af8-344">Similar to the use of load balancers, when filtering traffic from other VNets, you must use the source address range of the remote computer, not the gateway connecting the VNets.</span></span>
* <span data-ttu-id="50af8-345">Muchos servicios de Azure no se pueden conectar a redes virtuales.</span><span class="sxs-lookup"><span data-stu-id="50af8-345">Many Azure services cannot be connected to VNets.</span></span> <span data-ttu-id="50af8-346">Si un recurso de Azure no está conectado a una red virtual, no se puede usar un grupo de seguridad de red para filtrar el tráfico hacia el recurso.</span><span class="sxs-lookup"><span data-stu-id="50af8-346">If an Azure resource is not connected to a VNet, you cannot use an NSG to filter traffic to the resource.</span></span>  <span data-ttu-id="50af8-347">Lea la documentación de los servicios que usa para determinar si el servicio se puede conectar o no a una red virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-347">Read the documentation for the services you use to determine whether the service can be connected to a VNet.</span></span>

## <a name="sample-deployment"></a><span data-ttu-id="50af8-348">Ejemplo de implementación</span><span class="sxs-lookup"><span data-stu-id="50af8-348">Sample deployment</span></span>
<span data-ttu-id="50af8-349">Para ilustrar la aplicación de la información de este artículo, considere un escenario habitual con una aplicación de dos niveles que se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="50af8-349">To illustrate the application of the information in this article, consider a common scenario of a two tier application shown in the following picture:</span></span>

![Grupos de seguridad de red](./media/virtual-network-nsg-overview/figure1.png)

<span data-ttu-id="50af8-351">Como se muestra en el diagrama, las máquinas virtuales *Web1* y *Web2* están conectadas a la subred *FrontEnd*, y las máquinas virtuales *DB1* y *DB2* están conectadas a la subred *BackEnd*.</span><span class="sxs-lookup"><span data-stu-id="50af8-351">As shown in the diagram, the *Web1* and *Web2* VMs are connected to the *FrontEnd* subnet, and the *DB1* and *DB2* VMs are connected to the *BackEnd* subnet.</span></span>  <span data-ttu-id="50af8-352">Ambas subredes forman parte de la red virtual *TestVNet* .</span><span class="sxs-lookup"><span data-stu-id="50af8-352">Both subnets are part of the *TestVNet* VNet.</span></span> <span data-ttu-id="50af8-353">Cada componente de la aplicación se ejecuta dentro de una máquina virtual de Azure conectada a una red virtual.</span><span class="sxs-lookup"><span data-stu-id="50af8-353">The application components each run within an Azure VM connected to a VNet.</span></span> <span data-ttu-id="50af8-354">El escenario tiene los siguientes requisitos:</span><span class="sxs-lookup"><span data-stu-id="50af8-354">The scenario has the following requirements:</span></span>

1. <span data-ttu-id="50af8-355">Separación del tráfico entre los servidores web y de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="50af8-355">Separation of traffic between the WEB and DB servers.</span></span>
2. <span data-ttu-id="50af8-356">Reglas de equilibrio de carga que reenvían tráfico desde el equilibrador de carga hacia todos los servidores web en el puerto 80.</span><span class="sxs-lookup"><span data-stu-id="50af8-356">Load balancing rules forward traffic from the load balancer to all web servers on port 80.</span></span>
3. <span data-ttu-id="50af8-357">Reglas NAT de equilibrador de carga que reenvían el tráfico entrante en el equilibrador de carga en el puerto 50001 hacia el puerto 3389 en la máquina virtual WEB1.</span><span class="sxs-lookup"><span data-stu-id="50af8-357">Load balancer NAT rules forward traffic coming into the load balancer on port 50001 to port 3389 on the WEB1 VM.</span></span>
4. <span data-ttu-id="50af8-358">Sin acceso a las máquinas virtuales front-end o back-end desde Internet, a excepción de los requisitos 2 y 3.</span><span class="sxs-lookup"><span data-stu-id="50af8-358">No access to the front-end or back-end VMs from the Internet, except requirements 2 and 3.</span></span>
5. <span data-ttu-id="50af8-359">Sin acceso saliente a Internet desde los servidores web o de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="50af8-359">No outbound Internet access from the WEB or DB servers.</span></span>
6. <span data-ttu-id="50af8-360">Se permite el acceso desde la subred FrontEnd hacia el puerto 3389 de cualquier servidor web.</span><span class="sxs-lookup"><span data-stu-id="50af8-360">Access from the FrontEnd subnet is allowed to port 3389 of any web server.</span></span>
7. <span data-ttu-id="50af8-361">Se permite el acceso desde la subred FrontEnd hacia el puerto 3389 de cualquier servidor de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="50af8-361">Access from the FrontEnd subnet is allowed to port 3389 of any DB server.</span></span>
8. <span data-ttu-id="50af8-362">Se permite el acceso desde la subred FrontEnd hacia el puerto 1433 de todos los servidores de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="50af8-362">Access from the FrontEnd subnet is allowed to port 1433 of all DB servers.</span></span>
9. <span data-ttu-id="50af8-363">Separación del tráfico de administración (puerto 3389) y el de base de datos (1433) en diferentes interfaces de red en servidores de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="50af8-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span></span>

<span data-ttu-id="50af8-364">Los requisitos del 1 al 6 (excepto el 3 y el 4) se limitan a los espacios de subred.</span><span class="sxs-lookup"><span data-stu-id="50af8-364">Requirements 1-6 (except requirements 3 and 4) are all confined to subnet spaces.</span></span> <span data-ttu-id="50af8-365">Los siguientes grupos de seguridad de red cumplen los requisitos anteriores al mismo tiempo que se reduce al mínimo el número requerido:</span><span class="sxs-lookup"><span data-stu-id="50af8-365">The following NSGs meet the previous requirements, while minimizing the number of NSGs required:</span></span>

### <a name="frontend"></a><span data-ttu-id="50af8-366">FrontEnd</span><span class="sxs-lookup"><span data-stu-id="50af8-366">FrontEnd</span></span>
<span data-ttu-id="50af8-367">**Reglas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-367">**Inbound rules**</span></span>

| <span data-ttu-id="50af8-368">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-368">Rule</span></span> | <span data-ttu-id="50af8-369">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-369">Access</span></span> | <span data-ttu-id="50af8-370">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-370">Priority</span></span> | <span data-ttu-id="50af8-371">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-371">Source address range</span></span> | <span data-ttu-id="50af8-372">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-372">Source port</span></span> | <span data-ttu-id="50af8-373">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-373">Destination address range</span></span> | <span data-ttu-id="50af8-374">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-374">Destination port</span></span> | <span data-ttu-id="50af8-375">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-375">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-376">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-376">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="50af8-377">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-377">Allow</span></span> | <span data-ttu-id="50af8-378">100</span><span class="sxs-lookup"><span data-stu-id="50af8-378">100</span></span> | <span data-ttu-id="50af8-379">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-379">Internet</span></span> | * | * | <span data-ttu-id="50af8-380">80</span><span class="sxs-lookup"><span data-stu-id="50af8-380">80</span></span> | <span data-ttu-id="50af8-381">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-381">TCP</span></span> |
| <span data-ttu-id="50af8-382">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-382">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="50af8-383">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-383">Allow</span></span> | <span data-ttu-id="50af8-384">200</span><span class="sxs-lookup"><span data-stu-id="50af8-384">200</span></span> | <span data-ttu-id="50af8-385">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-385">Internet</span></span> | * | * | <span data-ttu-id="50af8-386">3389</span><span class="sxs-lookup"><span data-stu-id="50af8-386">3389</span></span> | <span data-ttu-id="50af8-387">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-387">TCP</span></span> |
| <span data-ttu-id="50af8-388">Deny-Inbound-All</span><span class="sxs-lookup"><span data-stu-id="50af8-388">Deny-Inbound-All</span></span> | <span data-ttu-id="50af8-389">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-389">Deny</span></span> | <span data-ttu-id="50af8-390">300</span><span class="sxs-lookup"><span data-stu-id="50af8-390">300</span></span> | <span data-ttu-id="50af8-391">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-391">Internet</span></span> | * | * | * | <span data-ttu-id="50af8-392">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-392">TCP</span></span> |

<span data-ttu-id="50af8-393">**Reglas de salida**</span><span class="sxs-lookup"><span data-stu-id="50af8-393">**Outbound rules**</span></span>

| <span data-ttu-id="50af8-394">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-394">Rule</span></span> | <span data-ttu-id="50af8-395">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-395">Access</span></span> | <span data-ttu-id="50af8-396">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-396">Priority</span></span> | <span data-ttu-id="50af8-397">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-397">Source address range</span></span> | <span data-ttu-id="50af8-398">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-398">Source port</span></span> | <span data-ttu-id="50af8-399">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-399">Destination address range</span></span> | <span data-ttu-id="50af8-400">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-400">Destination port</span></span> | <span data-ttu-id="50af8-401">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-401">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-402">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="50af8-402">Deny-Internet-All</span></span> |<span data-ttu-id="50af8-403">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-403">Deny</span></span> |<span data-ttu-id="50af8-404">100</span><span class="sxs-lookup"><span data-stu-id="50af8-404">100</span></span> | * | * | <span data-ttu-id="50af8-405">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-405">Internet</span></span> | * | * |

### <a name="backend"></a><span data-ttu-id="50af8-406">BackEnd</span><span class="sxs-lookup"><span data-stu-id="50af8-406">BackEnd</span></span>
<span data-ttu-id="50af8-407">**Reglas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-407">**Inbound rules**</span></span>

| <span data-ttu-id="50af8-408">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-408">Rule</span></span> | <span data-ttu-id="50af8-409">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-409">Access</span></span> | <span data-ttu-id="50af8-410">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-410">Priority</span></span> | <span data-ttu-id="50af8-411">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-411">Source address range</span></span> | <span data-ttu-id="50af8-412">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-412">Source port</span></span> | <span data-ttu-id="50af8-413">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-413">Destination address range</span></span> | <span data-ttu-id="50af8-414">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-414">Destination port</span></span> | <span data-ttu-id="50af8-415">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-415">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-416">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="50af8-416">Deny-Internet-All</span></span> | <span data-ttu-id="50af8-417">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-417">Deny</span></span> | <span data-ttu-id="50af8-418">100</span><span class="sxs-lookup"><span data-stu-id="50af8-418">100</span></span> | <span data-ttu-id="50af8-419">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-419">Internet</span></span> | * | * | * | * |

<span data-ttu-id="50af8-420">**Reglas de salida**</span><span class="sxs-lookup"><span data-stu-id="50af8-420">**Outbound rules**</span></span>

| <span data-ttu-id="50af8-421">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-421">Rule</span></span> | <span data-ttu-id="50af8-422">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-422">Access</span></span> | <span data-ttu-id="50af8-423">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-423">Priority</span></span> | <span data-ttu-id="50af8-424">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-424">Source address range</span></span> | <span data-ttu-id="50af8-425">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-425">Source port</span></span> | <span data-ttu-id="50af8-426">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-426">Destination address range</span></span> | <span data-ttu-id="50af8-427">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-427">Destination port</span></span> | <span data-ttu-id="50af8-428">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-428">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-429">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="50af8-429">Deny-Internet-All</span></span> | <span data-ttu-id="50af8-430">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-430">Deny</span></span> | <span data-ttu-id="50af8-431">100</span><span class="sxs-lookup"><span data-stu-id="50af8-431">100</span></span> | * | * | <span data-ttu-id="50af8-432">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-432">Internet</span></span> | * | * |

<span data-ttu-id="50af8-433">Se crean los siguientes grupos de seguridad de red y se asocian a interfaces de red en las máquinas virtuales siguientes:</span><span class="sxs-lookup"><span data-stu-id="50af8-433">The following NSGs are created and associated to NICs in the following VMs:</span></span>

### <a name="web1"></a><span data-ttu-id="50af8-434">WEB1</span><span class="sxs-lookup"><span data-stu-id="50af8-434">WEB1</span></span>
<span data-ttu-id="50af8-435">**Reglas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-435">**Inbound rules**</span></span>

| <span data-ttu-id="50af8-436">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-436">Rule</span></span> | <span data-ttu-id="50af8-437">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-437">Access</span></span> | <span data-ttu-id="50af8-438">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-438">Priority</span></span> | <span data-ttu-id="50af8-439">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-439">Source address range</span></span> | <span data-ttu-id="50af8-440">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-440">Source port</span></span> | <span data-ttu-id="50af8-441">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-441">Destination address range</span></span> | <span data-ttu-id="50af8-442">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-442">Destination port</span></span> | <span data-ttu-id="50af8-443">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-443">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-444">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-444">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="50af8-445">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-445">Allow</span></span> | <span data-ttu-id="50af8-446">100</span><span class="sxs-lookup"><span data-stu-id="50af8-446">100</span></span> | <span data-ttu-id="50af8-447">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-447">Internet</span></span> | * | * | <span data-ttu-id="50af8-448">3389</span><span class="sxs-lookup"><span data-stu-id="50af8-448">3389</span></span> | <span data-ttu-id="50af8-449">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-449">TCP</span></span> |
| <span data-ttu-id="50af8-450">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-450">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="50af8-451">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-451">Allow</span></span> | <span data-ttu-id="50af8-452">200</span><span class="sxs-lookup"><span data-stu-id="50af8-452">200</span></span> | <span data-ttu-id="50af8-453">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-453">Internet</span></span> | * | * | <span data-ttu-id="50af8-454">80</span><span class="sxs-lookup"><span data-stu-id="50af8-454">80</span></span> | <span data-ttu-id="50af8-455">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-455">TCP</span></span> |

> [!NOTE]
> <span data-ttu-id="50af8-456">El intervalo de direcciones de origen para las reglas anteriores es **Internet**, no la dirección IP virtual del equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="50af8-456">The source address range for the previous rules is **Internet**, not the virtual IP address of for the load balancer.</span></span> <span data-ttu-id="50af8-457">El puerto de origen es *, no 500001.</span><span class="sxs-lookup"><span data-stu-id="50af8-457">The source port is *, not 500001.</span></span> <span data-ttu-id="50af8-458">Las reglas NAT para equilibradores de carga no son iguales que las reglas de seguridad de grupo de seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="50af8-458">NAT rules for load balancers are not the same as NSG security rules.</span></span> <span data-ttu-id="50af8-459">Estas últimas siempre se relacionan con el origen inicial y el destino final del tráfico, **no** con el equilibrador de carga entre ambos.</span><span class="sxs-lookup"><span data-stu-id="50af8-459">NSG security rules are always related to the original source and final destination of traffic, **not** the load balancer between the two.</span></span> 
> 
> 

### <a name="web2"></a><span data-ttu-id="50af8-460">WEB2</span><span class="sxs-lookup"><span data-stu-id="50af8-460">WEB2</span></span>
<span data-ttu-id="50af8-461">**Reglas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-461">**Inbound rules**</span></span>

| <span data-ttu-id="50af8-462">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-462">Rule</span></span> | <span data-ttu-id="50af8-463">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-463">Access</span></span> | <span data-ttu-id="50af8-464">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-464">Priority</span></span> | <span data-ttu-id="50af8-465">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-465">Source address range</span></span> | <span data-ttu-id="50af8-466">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-466">Source port</span></span> | <span data-ttu-id="50af8-467">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-467">Destination address range</span></span> | <span data-ttu-id="50af8-468">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-468">Destination port</span></span> | <span data-ttu-id="50af8-469">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-469">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-470">Deny-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-470">Deny-Inbound-RDP-Internet</span></span> | <span data-ttu-id="50af8-471">DENEGAR</span><span class="sxs-lookup"><span data-stu-id="50af8-471">Deny</span></span> | <span data-ttu-id="50af8-472">100</span><span class="sxs-lookup"><span data-stu-id="50af8-472">100</span></span> | <span data-ttu-id="50af8-473">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-473">Internet</span></span> | * | * | <span data-ttu-id="50af8-474">3389</span><span class="sxs-lookup"><span data-stu-id="50af8-474">3389</span></span> | <span data-ttu-id="50af8-475">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-475">TCP</span></span> |
| <span data-ttu-id="50af8-476">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-476">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="50af8-477">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-477">Allow</span></span> | <span data-ttu-id="50af8-478">200</span><span class="sxs-lookup"><span data-stu-id="50af8-478">200</span></span> | <span data-ttu-id="50af8-479">Internet</span><span class="sxs-lookup"><span data-stu-id="50af8-479">Internet</span></span> | * | * | <span data-ttu-id="50af8-480">80</span><span class="sxs-lookup"><span data-stu-id="50af8-480">80</span></span> | <span data-ttu-id="50af8-481">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-481">TCP</span></span> |

### <a name="db-servers-management-nic"></a><span data-ttu-id="50af8-482">Servidores de bases de datos (interfaz de red de administración)</span><span class="sxs-lookup"><span data-stu-id="50af8-482">DB servers (Management NIC)</span></span>
<span data-ttu-id="50af8-483">**Reglas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-483">**Inbound rules**</span></span>

| <span data-ttu-id="50af8-484">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-484">Rule</span></span> | <span data-ttu-id="50af8-485">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-485">Access</span></span> | <span data-ttu-id="50af8-486">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-486">Priority</span></span> | <span data-ttu-id="50af8-487">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-487">Source address range</span></span> | <span data-ttu-id="50af8-488">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-488">Source port</span></span> | <span data-ttu-id="50af8-489">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-489">Destination address range</span></span> | <span data-ttu-id="50af8-490">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-490">Destination port</span></span> | <span data-ttu-id="50af8-491">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-491">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-492">Allow-Inbound-RDP-Front-end</span><span class="sxs-lookup"><span data-stu-id="50af8-492">Allow-Inbound-RDP-Front-end</span></span> | <span data-ttu-id="50af8-493">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-493">Allow</span></span> | <span data-ttu-id="50af8-494">100</span><span class="sxs-lookup"><span data-stu-id="50af8-494">100</span></span> | <span data-ttu-id="50af8-495">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="50af8-495">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="50af8-496">3389</span><span class="sxs-lookup"><span data-stu-id="50af8-496">3389</span></span> | <span data-ttu-id="50af8-497">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-497">TCP</span></span> |

### <a name="db-servers-database-traffic-nic"></a><span data-ttu-id="50af8-498">Servidores de bases de datos (interfaz de red de tráfico de base de datos)</span><span class="sxs-lookup"><span data-stu-id="50af8-498">DB servers (Database traffic NIC)</span></span>
<span data-ttu-id="50af8-499">**Reglas de entrada**</span><span class="sxs-lookup"><span data-stu-id="50af8-499">**Inbound rules**</span></span>

| <span data-ttu-id="50af8-500">Regla</span><span class="sxs-lookup"><span data-stu-id="50af8-500">Rule</span></span> | <span data-ttu-id="50af8-501">Access</span><span class="sxs-lookup"><span data-stu-id="50af8-501">Access</span></span> | <span data-ttu-id="50af8-502">Prioridad</span><span class="sxs-lookup"><span data-stu-id="50af8-502">Priority</span></span> | <span data-ttu-id="50af8-503">Intervalo de direcciones de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-503">Source address range</span></span> | <span data-ttu-id="50af8-504">Puerto de origen</span><span class="sxs-lookup"><span data-stu-id="50af8-504">Source port</span></span> | <span data-ttu-id="50af8-505">Intervalo de direcciones de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-505">Destination address range</span></span> | <span data-ttu-id="50af8-506">Puerto de destino</span><span class="sxs-lookup"><span data-stu-id="50af8-506">Destination port</span></span> | <span data-ttu-id="50af8-507">Protocolo</span><span class="sxs-lookup"><span data-stu-id="50af8-507">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="50af8-508">Allow-Inbound-SQL-Front-end</span><span class="sxs-lookup"><span data-stu-id="50af8-508">Allow-Inbound-SQL-Front-end</span></span> | <span data-ttu-id="50af8-509">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="50af8-509">Allow</span></span> | <span data-ttu-id="50af8-510">100</span><span class="sxs-lookup"><span data-stu-id="50af8-510">100</span></span> | <span data-ttu-id="50af8-511">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="50af8-511">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="50af8-512">1433</span><span class="sxs-lookup"><span data-stu-id="50af8-512">1433</span></span> | <span data-ttu-id="50af8-513">TCP</span><span class="sxs-lookup"><span data-stu-id="50af8-513">TCP</span></span> |

<span data-ttu-id="50af8-514">Puesto que algunos de los grupos de seguridad de red están asociados a interfaces de red individuales, las reglas son para los recursos implementados por medio de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="50af8-514">Since some of the NSGs are associated to individual NICs, the rules are for resources deployed through Resource Manager.</span></span> <span data-ttu-id="50af8-515">Las reglas se combinan para la subred y la interfaz de red, en función de cómo estén asociadas.</span><span class="sxs-lookup"><span data-stu-id="50af8-515">Rules are combined for subnet and NIC, depending on how they are associated.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="50af8-516">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="50af8-516">Next steps</span></span>
* <span data-ttu-id="50af8-517">[Implementación de grupos de seguridad de red (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span></span>
* <span data-ttu-id="50af8-518">[Implementación de grupos de seguridad de red (clásicos)](virtual-networks-create-nsg-classic-ps.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span></span>
* <span data-ttu-id="50af8-519">[Administración de registros de grupo de seguridad de red](virtual-network-nsg-manage-log.md).</span><span class="sxs-lookup"><span data-stu-id="50af8-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span></span>
* <span data-ttu-id="50af8-520">[Solución de problemas de grupo de seguridad de red] (virtual-network-nsg-troubleshoot-portal.md)</span><span class="sxs-lookup"><span data-stu-id="50af8-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span></span>
