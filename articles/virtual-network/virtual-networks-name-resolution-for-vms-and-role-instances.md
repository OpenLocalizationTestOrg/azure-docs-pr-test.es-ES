---
title: "aaaResolution para máquinas virtuales e instancias de rol"
description: "Escenarios de resolución de nombres para IaaS de Azure, soluciones híbridas, entre servicios en la nube diferentes, Active Directory y con su propio servidor DNS  "
services: virtual-network
documentationcenter: na
author: GarethBradshawMSFT
manager: carmonm
editor: tysonn
ms.assetid: 5d73edde-979a-470a-b28c-e103fcf07e3e
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/06/2016
ms.author: telmos
ms.openlocfilehash: 0ec7903cf200c1d04d75601a5b0cefe4268f3dcf
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="name-resolution-for-vms-and-role-instances"></a><span data-ttu-id="c8888-103">Resolución de nombres para las máquinas virtuales e instancias de rol</span><span class="sxs-lookup"><span data-stu-id="c8888-103">Name Resolution for VMs and Role Instances</span></span>
<span data-ttu-id="c8888-104">Dependiendo de cómo utilice Azure toohost IaaS, PaaS y soluciones híbridas, puede que tenga tooallow Hola máquinas virtuales e instancias de rol que creas toocommunicate entre sí.</span><span class="sxs-lookup"><span data-stu-id="c8888-104">Depending on how you use Azure toohost IaaS, PaaS, and hybrid solutions, you may need tooallow hello VMs and role instances that you create toocommunicate with each other.</span></span> <span data-ttu-id="c8888-105">Aunque esta comunicación se puede realizar mediante el uso de direcciones IP, es mucho más fácil nombres toouse que pueden recordarse fácilmente y no cambian.</span><span class="sxs-lookup"><span data-stu-id="c8888-105">Although this communication can be done by using IP addresses, it is much simpler toouse names that can be easily remembered and do not change.</span></span> 

<span data-ttu-id="c8888-106">Cuando se requiere direcciones IP de toointernal de nombres de dominio de tooresolve para instancias de rol y las máquinas virtuales hospedadas en Azure, puede usar uno de estos dos métodos:</span><span class="sxs-lookup"><span data-stu-id="c8888-106">When role instances and VMs hosted in Azure need tooresolve domain names toointernal IP addresses, they can use one of two methods:</span></span>

* [<span data-ttu-id="c8888-107">Resolución de nombres de Azure</span><span class="sxs-lookup"><span data-stu-id="c8888-107">Azure-provided name resolution</span></span>](#azure-provided-name-resolution)
* <span data-ttu-id="c8888-108">[Resolución de nombres con su propio servidor DNS](#name-resolution-using-your-own-dns-server) (que puede reenviar consultas toohello servidores DNS de Azure)</span><span class="sxs-lookup"><span data-stu-id="c8888-108">[Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server) (which may forward queries toohello Azure-provided DNS servers)</span></span> 

<span data-ttu-id="c8888-109">tipo de Hola de resolución de nombres que se usa depende de cómo las máquinas virtuales y las instancias de rol necesitan toocommunicate entre sí.</span><span class="sxs-lookup"><span data-stu-id="c8888-109">hello type of name resolution you use depends on how your VMs and role instances need toocommunicate with each other.</span></span>

<span data-ttu-id="c8888-110">**Hello tabla siguiente muestra escenarios y soluciones de resolución de nombre correspondientes:**</span><span class="sxs-lookup"><span data-stu-id="c8888-110">**hello following table illustrates scenarios and corresponding name resolution solutions:**</span></span>

| <span data-ttu-id="c8888-111">**Escenario**</span><span class="sxs-lookup"><span data-stu-id="c8888-111">**Scenario**</span></span> | <span data-ttu-id="c8888-112">**Solución**</span><span class="sxs-lookup"><span data-stu-id="c8888-112">**Solution**</span></span> | <span data-ttu-id="c8888-113">**Sufijo**</span><span class="sxs-lookup"><span data-stu-id="c8888-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c8888-114">Resolución de nombres entre instancias de rol o máquinas virtuales ubicadas en hello mismo servicio o red virtual en la nube</span><span class="sxs-lookup"><span data-stu-id="c8888-114">Name resolution between role instances or VMs located in hello same cloud service or virtual network</span></span> |[<span data-ttu-id="c8888-115">Resolución de nombres de Azure</span><span class="sxs-lookup"><span data-stu-id="c8888-115">Azure-provided name resolution</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="c8888-116">Nombre de host o FQDN</span><span class="sxs-lookup"><span data-stu-id="c8888-116">hostname or FQDN</span></span> |
| <span data-ttu-id="c8888-117">Resolución de nombres entre instancias de rol o máquinas virtuales ubicadas en diferentes redes virtuales</span><span class="sxs-lookup"><span data-stu-id="c8888-117">Name resolution between role instances or VMs located in different virtual networks</span></span> |<span data-ttu-id="c8888-118">Servidores DNS administrados por el cliente que reenvían consultas entre redes virtuales para la resolución mediante Azure (proxy DNS).</span><span class="sxs-lookup"><span data-stu-id="c8888-118">Customer-managed DNS servers forwarding queries between vnets for resolution by Azure (DNS proxy).</span></span>  <span data-ttu-id="c8888-119">Consulte [Resolución de nombres mediante su propio servidor DNS](#name-resolution-using-your-own-dns-server)</span><span class="sxs-lookup"><span data-stu-id="c8888-119">see [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server)</span></span> |<span data-ttu-id="c8888-120">Solo FQDN</span><span class="sxs-lookup"><span data-stu-id="c8888-120">FQDN only</span></span> |
| <span data-ttu-id="c8888-121">Resolución de nombres de servicios y de equipos locales desde instancias de rol o máquinas virtuales en Azure</span><span class="sxs-lookup"><span data-stu-id="c8888-121">Resolution of on-premises computer and service names from role instances or VMs in Azure</span></span> |<span data-ttu-id="c8888-122">Servidores DNS administrados por el cliente (por ejemplo, controlador de dominio local, controlador de dominio de solo lectura local o un DNS secundario sincronizado usando transferencias de zona).</span><span class="sxs-lookup"><span data-stu-id="c8888-122">Customer-managed DNS servers (e.g. on-premises domain controller, local read-only domain controller or a DNS secondary synced using zone transfers).</span></span>  <span data-ttu-id="c8888-123">See [Resolución de nombres mediante su propio servidor DNS](#name-resolution-using-your-own-dns-server)</span><span class="sxs-lookup"><span data-stu-id="c8888-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server)</span></span> |<span data-ttu-id="c8888-124">Solo FQDN</span><span class="sxs-lookup"><span data-stu-id="c8888-124">FQDN only</span></span> |
| <span data-ttu-id="c8888-125">Resolución de nombres de host de Azure desde equipos locales</span><span class="sxs-lookup"><span data-stu-id="c8888-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="c8888-126">Reenviar consultas tooa administrada por el cliente DNS servidor proxy en la red virtual correspondiente de hello, servidor de proxy de hello reenvía tooAzure de consultas para la resolución.</span><span class="sxs-lookup"><span data-stu-id="c8888-126">Forward queries tooa customer-managed DNS proxy server in hello corresponding vnet, hello proxy server forwards queries tooAzure for resolution.</span></span> <span data-ttu-id="c8888-127">See [Resolución de nombres mediante su propio servidor DNS](#name-resolution-using-your-own-dns-server)</span><span class="sxs-lookup"><span data-stu-id="c8888-127">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server)</span></span> |<span data-ttu-id="c8888-128">Solo FQDN</span><span class="sxs-lookup"><span data-stu-id="c8888-128">FQDN only</span></span> |
| <span data-ttu-id="c8888-129">DNS inverso para direcciones IP internas</span><span class="sxs-lookup"><span data-stu-id="c8888-129">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="c8888-130">Resolución de nombres mediante su propio servidor DNS</span><span class="sxs-lookup"><span data-stu-id="c8888-130">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="c8888-131">N/D</span><span class="sxs-lookup"><span data-stu-id="c8888-131">n/a</span></span> |
| <span data-ttu-id="c8888-132">Resolución de nombres entre máquinas virtuales o instancias de rol ubicadas en diferentes servicios en la nube y no en una red virtual</span><span class="sxs-lookup"><span data-stu-id="c8888-132">Name resolution between VMs or role instances located in different cloud services, not in a virtual network</span></span> |<span data-ttu-id="c8888-133">No aplicable.</span><span class="sxs-lookup"><span data-stu-id="c8888-133">Not applicable.</span></span> <span data-ttu-id="c8888-134">La conectividad entre máquinas virtuales e instancias de rol de servicios en la nube diferentes no es compatible fuera de una red virtual.</span><span class="sxs-lookup"><span data-stu-id="c8888-134">Connectivity between VMs and role instances in different cloud services is not supported outside a virtual network.</span></span> |<span data-ttu-id="c8888-135">N/D</span><span class="sxs-lookup"><span data-stu-id="c8888-135">n/a</span></span> |

## <a name="azure-provided-name-resolution"></a><span data-ttu-id="c8888-136">Resolución de nombres de Azure</span><span class="sxs-lookup"><span data-stu-id="c8888-136">Azure-provided name resolution</span></span>
<span data-ttu-id="c8888-137">Junto con la resolución de nombres DNS públicos, Azure proporciona resolución de nombres interna para las máquinas virtuales e instancias de rol que residen dentro de Hola mismo servicio en la nube o de red virtual.</span><span class="sxs-lookup"><span data-stu-id="c8888-137">Along with resolution of public DNS names, Azure provides internal name resolution for VMs and role instances that reside within hello same virtual network or cloud service.</span></span>  <span data-ttu-id="c8888-138">Máquinas virtuales o instancias de un servicio de nube compartir Hola DNS mismo sufijo (por lo que Hola independiente del nombre de host es suficiente) pero en servicios en la nube diferentes redes virtuales clásicas tienen distintos sufijos DNS para que hello FQDN es necesario tooresolve nombres entre servicios en la nube diferente.</span><span class="sxs-lookup"><span data-stu-id="c8888-138">VMs/instances in a cloud service share hello same DNS suffix (so hello hostname alone is sufficient) but in classic virtual networks different cloud services have different DNS suffixes so hello FQDN is needed tooresolve names between different cloud services.</span></span>  <span data-ttu-id="c8888-139">En redes virtuales en el modelo de implementación del Administrador de recursos de hello, sufijo DNS de Hola sea coherente en la red virtual de hello (por lo que no es necesario Hola FQDN) y nombres DNS se pueden asignar tooboth NIC y las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="c8888-139">In virtual networks in hello Resource Manager deployment model, hello DNS suffix is consistent across hello virtual network (so hello FQDN is not needed) and DNS names can be assigned tooboth NICs and VMs.</span></span> <span data-ttu-id="c8888-140">Aunque la resolución de nombres que proporciona Azure no requiere ninguna configuración, no es Hola opción adecuada para todos los escenarios de implementación, tal como se muestra en la tabla de hello anterior.</span><span class="sxs-lookup"><span data-stu-id="c8888-140">Although Azure-provided name resolution does not require any configuration, it is not hello appropriate choice for all deployment scenarios, as seen on hello table above.</span></span>

> [!NOTE]
> <span data-ttu-id="c8888-141">En caso de hello de roles web y de trabajo, también puede tener acceso a direcciones IP internas de Hola de instancias de rol basadas en el número de instancia y el nombre de la función de hello mediante Hola API de REST de administración de servicios de Azure.</span><span class="sxs-lookup"><span data-stu-id="c8888-141">In hello case of web and worker roles, you can also access hello internal IP addresses of role instances based on hello role name and instance number using hello Azure Service Management REST API.</span></span> <span data-ttu-id="c8888-142">Para obtener más información, consulte la [Referencia de la API de REST de la administración de servicios](https://msdn.microsoft.com/library/azure/ee460799.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8888-142">For more information, see [Service Management REST API Reference](https://msdn.microsoft.com/library/azure/ee460799.aspx).</span></span>
> 
> 

### <a name="features-and-considerations"></a><span data-ttu-id="c8888-143">Características y consideraciones</span><span class="sxs-lookup"><span data-stu-id="c8888-143">Features and Considerations</span></span>
<span data-ttu-id="c8888-144">**Características**</span><span class="sxs-lookup"><span data-stu-id="c8888-144">**Features:**</span></span>

* <span data-ttu-id="c8888-145">Facilidad de uso: es necesario realizar ninguna configuración en orden toouse resolución de nombres que viene con Azure.</span><span class="sxs-lookup"><span data-stu-id="c8888-145">Ease of use: No configuration is required in order toouse Azure-provided name resolution.</span></span>
* <span data-ttu-id="c8888-146">servicio de resolución de nombres de viene con Azure Hello tiene una alta disponibilidad, guardando Hola necesita toocreate y administrar clústeres de sus propios servidores DNS.</span><span class="sxs-lookup"><span data-stu-id="c8888-146">hello Azure-provided name resolution service is highly available, saving you hello need toocreate and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="c8888-147">Puede utilizarse junto con su propios tooresolve de servidores DNS locales y los nombres de host de Azure.</span><span class="sxs-lookup"><span data-stu-id="c8888-147">Can be used in conjunction with your own DNS servers tooresolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="c8888-148">Resolución de nombres es siempre entre instancias de rol o máquinas virtuales dentro de hello mismo servicio en la nube sin necesidad de un FQDN.</span><span class="sxs-lookup"><span data-stu-id="c8888-148">Name resolution is provided between role instances/VMs within hello same cloud service without need for a FQDN.</span></span>
* <span data-ttu-id="c8888-149">Se proporciona resolución de nombres entre máquinas virtuales en redes virtuales que utilizan el modelo de implementación de administrador de recursos de hello, sin necesidad de hello FQDN.</span><span class="sxs-lookup"><span data-stu-id="c8888-149">Name resolution is provided between VMs in virtual networks that use hello Resource Manager deployment model, without need for hello FQDN.</span></span> <span data-ttu-id="c8888-150">Las redes virtuales en el modelo de implementación clásica de hello requieren Hola FQDN al resolver nombres de servicios en la nube diferente.</span><span class="sxs-lookup"><span data-stu-id="c8888-150">Virtual networks in hello classic deployment model require hello FQDN when resolving names in different cloud services.</span></span> 
* <span data-ttu-id="c8888-151">Puede usar los nombres de host que describan mejor las implementaciones, en lugar de trabajar con nombres generados automáticamente.</span><span class="sxs-lookup"><span data-stu-id="c8888-151">You can use hostnames that best describe your deployments, rather than working with auto-generated names.</span></span>

<span data-ttu-id="c8888-152">**Consideraciones:**</span><span class="sxs-lookup"><span data-stu-id="c8888-152">**Considerations:**</span></span>

* <span data-ttu-id="c8888-153">no se puede modificar el sufijo DNS de Azure de Hola.</span><span class="sxs-lookup"><span data-stu-id="c8888-153">hello Azure-created DNS suffix cannot be modified.</span></span>
* <span data-ttu-id="c8888-154">No se pueden registrar manualmente los registros propios.</span><span class="sxs-lookup"><span data-stu-id="c8888-154">You cannot manually register your own records.</span></span>
* <span data-ttu-id="c8888-155">No se admiten ni WINS ni NetBIOS.</span><span class="sxs-lookup"><span data-stu-id="c8888-155">WINS and NetBIOS are not supported.</span></span> <span data-ttu-id="c8888-156">(Las máquinas virtuales no se pueden ver en el Explorador de Windows).</span><span class="sxs-lookup"><span data-stu-id="c8888-156">(You cannot see your VMs in Windows Explorer.)</span></span>
* <span data-ttu-id="c8888-157">Los nombres de host deben ser compatibles con el DNS (solamente pueden usar los caracteres 0-9, a-z y “-” y no pueden comenzar ni terminar con un “-”.</span><span class="sxs-lookup"><span data-stu-id="c8888-157">Hostnames must be DNS-compatible (They must use only 0-9, a-z and '-', and cannot start or end with a '-'.</span></span> <span data-ttu-id="c8888-158">Consulte la sección 2 de RFC 3696).</span><span class="sxs-lookup"><span data-stu-id="c8888-158">See RFC 3696 section 2.)</span></span>
* <span data-ttu-id="c8888-159">El tráfico de consultas de DNS está limitado por cada máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c8888-159">DNS query traffic is throttled for each VM.</span></span> <span data-ttu-id="c8888-160">Esto no debería afectar a la mayoría de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="c8888-160">This shouldn't impact most applications.</span></span>  <span data-ttu-id="c8888-161">Si se observa una limitación de solicitudes, asegúrese de que está habilitado el almacenamiento en caché del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="c8888-161">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="c8888-162">Para obtener más información, consulte [obtener la mayoría de la resolución de nombres que viene con Azure de hello](#Getting-the-most-from-Azure-provided-name-resolution).</span><span class="sxs-lookup"><span data-stu-id="c8888-162">For more details, see [Getting hello most from Azure-provided name resolution](#Getting-the-most-from-Azure-provided-name-resolution).</span></span>
* <span data-ttu-id="c8888-163">Solo los nodos en los primeros servicios de nube 180 de Hola se registran para cada red virtual en un modelo de implementación clásica.</span><span class="sxs-lookup"><span data-stu-id="c8888-163">Only VMs in hello first 180 cloud services are registered for each virtual network in a classic deployment model.</span></span> <span data-ttu-id="c8888-164">No se aplica toovirtual redes en modelos de implementación del Administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="c8888-164">This does not apply toovirtual networks in Resource Manager deployment models.</span></span>

### <a name="getting-hello-most-from-azure-provided-name-resolution"></a><span data-ttu-id="c8888-165">Obtener la mayoría de la resolución de nombres que viene con Azure de Hola</span><span class="sxs-lookup"><span data-stu-id="c8888-165">Getting hello most from Azure-provided name resolution</span></span>
<span data-ttu-id="c8888-166">**Almacenamiento en caché del lado cliente:**</span><span class="sxs-lookup"><span data-stu-id="c8888-166">**Client-side Caching:**</span></span>

<span data-ttu-id="c8888-167">No todas las consultas DNS debe toobe enviado a través de la red de Hola.</span><span class="sxs-lookup"><span data-stu-id="c8888-167">Not every DNS query needs toobe sent across hello network.</span></span>  <span data-ttu-id="c8888-168">Almacenamiento en caché de cliente le ayuda a reducir la latencia y mejorar señales de toonetwork de resistencia al resolver las consultas DNS periódicas desde una memoria caché local.</span><span class="sxs-lookup"><span data-stu-id="c8888-168">Client-side caching helps reduce latency and improve resilience toonetwork blips by resolving recurring DNS queries from a local cache.</span></span>  <span data-ttu-id="c8888-169">Los registros DNS contienen un período de vida (TTL) que permite el registro de hello caché toostore Hola tanto como sea posible sin afectar a la actualización del registro, por lo que el almacenamiento en caché de cliente es adecuado para la mayoría de los casos.</span><span class="sxs-lookup"><span data-stu-id="c8888-169">DNS records contain a Time-To-Live (TTL) which allows hello cache toostore hello record for as long as possible without impacting record freshness, so client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="c8888-170">predeterminado de Hello cliente DNS de Windows tiene una memoria caché DNS integrada.</span><span class="sxs-lookup"><span data-stu-id="c8888-170">hello default Windows DNS Client has a DNS cache built-in.</span></span>  <span data-ttu-id="c8888-171">Algunos Linux distribuciones no incluyen el almacenamiento en caché de forma predeterminada, se recomienda que uno se agreguen tooeach VM de Linux (después de comprobar que no hay una memoria caché local ya).</span><span class="sxs-lookup"><span data-stu-id="c8888-171">Some Linux distros do not include caching by default, it is recommended that one be added tooeach Linux VM (after checking that there isn't a local cache already).</span></span>

<span data-ttu-id="c8888-172">Hay una serie de diferentes DNS almacenamiento en caché paquetes disponibles, por ejemplo, dnsmasq, presentamos Hola pasos tooinstall dnsmasq en distribuciones de hello más comunes:</span><span class="sxs-lookup"><span data-stu-id="c8888-172">There are a number of different DNS caching packages available, e.g. dnsmasq, here are hello steps tooinstall dnsmasq on hello most common distros:</span></span>

* <span data-ttu-id="c8888-173">**Ubuntu (usa resolvconf)**:</span><span class="sxs-lookup"><span data-stu-id="c8888-173">**Ubuntu (uses resolvconf)**:</span></span>
  * <span data-ttu-id="c8888-174">solo tiene que instalar paquete de hello dnsmasq ("sudo instalación apt get dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="c8888-174">just install hello dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>
* <span data-ttu-id="c8888-175">**SUSE (usa netconf)**:</span><span class="sxs-lookup"><span data-stu-id="c8888-175">**SUSE (uses netconf)**:</span></span>
  * <span data-ttu-id="c8888-176">instalar el paquete de hello dnsmasq ("sudo zypper install dnsmasq")</span><span class="sxs-lookup"><span data-stu-id="c8888-176">install hello dnsmasq package (“sudo zypper install dnsmasq”)</span></span> 
  * <span data-ttu-id="c8888-177">habilitar el servicio de hello dnsmasq ("systemctl enable dnsmasq.service")</span><span class="sxs-lookup"><span data-stu-id="c8888-177">enable hello dnsmasq service (“systemctl enable dnsmasq.service”)</span></span> 
  * <span data-ttu-id="c8888-178">iniciar servicio de hello dnsmasq ("systemctl inicio dnsmasq.service")</span><span class="sxs-lookup"><span data-stu-id="c8888-178">start hello dnsmasq service (“systemctl start dnsmasq.service”)</span></span> 
  * <span data-ttu-id="c8888-179">Editar "/ etcetera/sysconfig/red/config" y cambiar NETCONFIG_DNS_FORWARDER = "" demasiado "dnsmasq"</span><span class="sxs-lookup"><span data-stu-id="c8888-179">edit “/etc/sysconfig/network/config” and change NETCONFIG_DNS_FORWARDER="" too”dnsmasq”</span></span>
  * <span data-ttu-id="c8888-180">actualizar resolv.conf ("actualización de netconfig") tooset Hola caché como Hola a resolución DNS local</span><span class="sxs-lookup"><span data-stu-id="c8888-180">update resolv.conf ("netconfig update") tooset hello cache as hello local DNS resolver</span></span>
* <span data-ttu-id="c8888-181">**OpenLogic (usa NetworkManager)**:</span><span class="sxs-lookup"><span data-stu-id="c8888-181">**OpenLogic (uses NetworkManager)**:</span></span>
  * <span data-ttu-id="c8888-182">instalar el paquete de hello dnsmasq ("sudo yum install dnsmasq")</span><span class="sxs-lookup"><span data-stu-id="c8888-182">install hello dnsmasq package (“sudo yum install dnsmasq”)</span></span>
  * <span data-ttu-id="c8888-183">habilitar el servicio de hello dnsmasq ("systemctl enable dnsmasq.service")</span><span class="sxs-lookup"><span data-stu-id="c8888-183">enable hello dnsmasq service (“systemctl enable dnsmasq.service”)</span></span>
  * <span data-ttu-id="c8888-184">iniciar servicio de hello dnsmasq ("systemctl inicio dnsmasq.service")</span><span class="sxs-lookup"><span data-stu-id="c8888-184">start hello dnsmasq service (“systemctl start dnsmasq.service”)</span></span>
  * <span data-ttu-id="c8888-185">Agregar "anteponer servidores de nombres de dominio 127.0.0.1;" too"/etc/dhclient-eth0.conf"</span><span class="sxs-lookup"><span data-stu-id="c8888-185">add “prepend domain-name-servers 127.0.0.1;” too“/etc/dhclient-eth0.conf”</span></span>
  * <span data-ttu-id="c8888-186">Reinicie caché de Hola de tooset ("reinicio de red de servicio") del servicio de la red hello como Hola a resolución DNS local</span><span class="sxs-lookup"><span data-stu-id="c8888-186">restart hello network service (“service network restart”) tooset hello cache as hello local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="c8888-187">paquete de 'dnsmasq' Hello es solo una de hello muchas memorias caché DNS disponibles para Linux.</span><span class="sxs-lookup"><span data-stu-id="c8888-187">hello 'dnsmasq' package is only one of hello many DNS caches available for Linux.</span></span>  <span data-ttu-id="c8888-188">Antes de usarlo, compruebe su idoneidad para sus necesidades concretas y que no se instale ninguna otra memoria caché.</span><span class="sxs-lookup"><span data-stu-id="c8888-188">Before using it, please check its suitability for your particular needs and that no other cache is installed.</span></span>
> 
> 

<span data-ttu-id="c8888-189">**Reintentos de cliente:**</span><span class="sxs-lookup"><span data-stu-id="c8888-189">**Client-side Retries:**</span></span>

<span data-ttu-id="c8888-190">DNS es principalmente un protocolo UDP.</span><span class="sxs-lookup"><span data-stu-id="c8888-190">DNS is primarily a UDP protocol.</span></span>  <span data-ttu-id="c8888-191">Como Hola protocolo UDP no garantiza la entrega de mensajes, lógica de reintento se controla en el propio protocolo DNS Hola.</span><span class="sxs-lookup"><span data-stu-id="c8888-191">As hello UDP protocol doesn't guarantee message delivery, retry logic is handled in hello DNS protocol itself.</span></span>  <span data-ttu-id="c8888-192">Cada cliente DNS (sistema operativo) puede ofrecer una lógica de reintento diferentes según la preferencia de creadores de hello:</span><span class="sxs-lookup"><span data-stu-id="c8888-192">Each DNS client (operating system) can exhibit different retry logic depending on hello creators preference:</span></span>

* <span data-ttu-id="c8888-193">Los sistemas operativos Windows realizan un intento tras un segundo y después tras otros 2, 4 y otros 4 segundos.</span><span class="sxs-lookup"><span data-stu-id="c8888-193">Windows operating systems retry after 1 second and then again after another 2, 4 and another 4 seconds.</span></span> 
* <span data-ttu-id="c8888-194">Hola reintentos del programa de instalación de Linux de manera predeterminada después de 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="c8888-194">hello default Linux setup retries after 5 seconds.</span></span>  <span data-ttu-id="c8888-195">Es recomendable toochange esta tooretry 5 veces intervalos de 1 segundo.</span><span class="sxs-lookup"><span data-stu-id="c8888-195">It is recommended toochange this tooretry 5 times at 1 second intervals.</span></span>  

<span data-ttu-id="c8888-196">toocheck Hola configuración actual en una VM de Linux, 'cat /etc/resolv.conf' y buscar en línea de 'options' hello, p. ej.:</span><span class="sxs-lookup"><span data-stu-id="c8888-196">toocheck hello current settings on a Linux VM, 'cat /etc/resolv.conf' and look at hello 'options' line, e.g.:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="c8888-197">archivo de Hello resolv.conf es normalmente autogenerada y no debe editarse.</span><span class="sxs-lookup"><span data-stu-id="c8888-197">hello resolv.conf file is usually auto-generated and should not be edited.</span></span>  <span data-ttu-id="c8888-198">pasos específicos de Hola para agregar la línea hello 'opciones' varían según la distribución:</span><span class="sxs-lookup"><span data-stu-id="c8888-198">hello specific steps for adding hello 'options' line vary by distro:</span></span>

* <span data-ttu-id="c8888-199">**Ubuntu** (usa resolvconf):</span><span class="sxs-lookup"><span data-stu-id="c8888-199">**Ubuntu** (uses resolvconf):</span></span>
  * <span data-ttu-id="c8888-200">Agregar Hola opciones línea too'/etc/resolveconf/resolv.conf.d/head'</span><span class="sxs-lookup"><span data-stu-id="c8888-200">add hello options line too'/etc/resolveconf/resolv.conf.d/head'</span></span> 
  * <span data-ttu-id="c8888-201">Ejecute 'resolvconf -u' tooupdate</span><span class="sxs-lookup"><span data-stu-id="c8888-201">run 'resolvconf -u' tooupdate</span></span>
* <span data-ttu-id="c8888-202">**SUSE** (usa netconf):</span><span class="sxs-lookup"><span data-stu-id="c8888-202">**SUSE** (uses netconf):</span></span>
  * <span data-ttu-id="c8888-203">Agregue 'timeout:1 intentos: 5' toohello NETCONFIG_DNS_RESOLVER_OPTIONS = "" parámetro en '/ etcetera/sysconfig/red/config'</span><span class="sxs-lookup"><span data-stu-id="c8888-203">add 'timeout:1 attempts:5' toohello NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'</span></span> 
  * <span data-ttu-id="c8888-204">Ejecute 'netconfig update' tooupdate</span><span class="sxs-lookup"><span data-stu-id="c8888-204">run 'netconfig update' tooupdate</span></span>
* <span data-ttu-id="c8888-205">**OpenLogic** (usa NetworkManager):</span><span class="sxs-lookup"><span data-stu-id="c8888-205">**OpenLogic** (uses NetworkManager):</span></span>
  * <span data-ttu-id="c8888-206">Agregar 'eco "opciones timeout:1 intentos: 5" ' too'/etc/NetworkManager/dispatcher.d/11-dhclient'</span><span class="sxs-lookup"><span data-stu-id="c8888-206">add 'echo "options timeout:1 attempts:5"' too'/etc/NetworkManager/dispatcher.d/11-dhclient'</span></span> 
  * <span data-ttu-id="c8888-207">ejecutar tooupdate "restart de red de servicio"</span><span class="sxs-lookup"><span data-stu-id="c8888-207">run 'service network restart' tooupdate</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="c8888-208">Resolución de nombres mediante su propio servidor DNS</span><span class="sxs-lookup"><span data-stu-id="c8888-208">Name resolution using your own DNS server</span></span>
<span data-ttu-id="c8888-209">Hay una serie de situaciones que sus necesidades de resolución de nombres pueden ir más allá de características de hello proporcionadas por Azure, por ejemplo al usar dominios de Active Directory o cuando se requieren la resolución DNS entre redes virtuales (redes virtuales).</span><span class="sxs-lookup"><span data-stu-id="c8888-209">There are a number of situations where your name resolution needs may go beyond hello features provided by Azure, for example when using Active Directory domains or when you require DNS resolution between virtual networks (vnets).</span></span>  <span data-ttu-id="c8888-210">toocover estos escenarios, Azure proporciona capacidad de Hola para toouse sus propios servidores DNS.</span><span class="sxs-lookup"><span data-stu-id="c8888-210">toocover these scenarios, Azure provides hello ability for you toouse your own DNS servers.</span></span>  

<span data-ttu-id="c8888-211">Los servidores DNS en una red virtual pueden reenviar a solucionadores del tooAzure de las consultas DNS recursivas tooresolve los nombres de host dentro de esa red virtual.</span><span class="sxs-lookup"><span data-stu-id="c8888-211">DNS servers within a virtual network can forward DNS queries tooAzure's recursive resolvers tooresolve hostnames within that virtual network.</span></span>  <span data-ttu-id="c8888-212">Por ejemplo, un controlador de dominio (DC) ejecuta en Azure puede responder consultas tooDNS para sus dominios y reenviar todos los demás tooAzure de las consultas.</span><span class="sxs-lookup"><span data-stu-id="c8888-212">For example, a Domain Controller (DC) running in Azure can respond tooDNS queries for its domains and forward all other queries tooAzure.</span></span>  <span data-ttu-id="c8888-213">Esto permite que las máquinas virtuales toosee los recursos locales (a través de Hola DC) y el proporcionado por Azure nombres de host (a través de reenviador de hello).</span><span class="sxs-lookup"><span data-stu-id="c8888-213">This allows VMs toosee both your on-premises resources (via hello DC) and Azure-provided hostnames (via hello forwarder).</span></span>  <span data-ttu-id="c8888-214">Solucionadores de recursiva del acceso tooAzure se proporciona a través de la dirección IP virtual de hello 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="c8888-214">Access tooAzure's recursive resolvers is provided via hello virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="c8888-215">El reenvío de DNS también habilita la resolución DNS de red virtual entre redes y permite la tooresolve de máquinas locales los nombres de host proporcionado por Azure.</span><span class="sxs-lookup"><span data-stu-id="c8888-215">DNS forwarding also enables inter-vnet DNS resolution and allows your on-premises machines tooresolve Azure-provided hostnames.</span></span>  <span data-ttu-id="c8888-216">En orden tooresolve nombre de host de la máquina virtual, la máquina virtual del servidor DNS de hello debe residir en hello mismo virtual de red y ser tooAzure de consultas de nombre de host tooforward configurado.</span><span class="sxs-lookup"><span data-stu-id="c8888-216">In order tooresolve a VM's hostname, hello DNS server VM must reside in hello same virtual network and be configured tooforward hostname queries tooAzure.</span></span>  <span data-ttu-id="c8888-217">Como sufijo DNS de hello es diferente en cada red virtual, puede utilizar el reenvío condicional reglas toosend DNS consulta toohello corregir red virtual para la resolución.</span><span class="sxs-lookup"><span data-stu-id="c8888-217">As hello DNS suffix is different in each vnet, you can use conditional forwarding rules toosend DNS queries toohello correct vnet for resolution.</span></span>  <span data-ttu-id="c8888-218">Hola siguiente imagen muestra dos redes virtuales y una red local realizar la resolución DNS de red virtual entre redes mediante este método.</span><span class="sxs-lookup"><span data-stu-id="c8888-218">hello following image shows two vnets and an on-premises network doing inter-vnet DNS resolution using this method.</span></span>  <span data-ttu-id="c8888-219">Un reenviador DNS de ejemplo está disponible en hello [Galería de plantillas de inicio rápido de Azure](https://azure.microsoft.com/documentation/templates/301-dns-forwarder/) y [GitHub](https://github.com/Azure/azure-quickstart-templates/tree/master/301-dns-forwarder).</span><span class="sxs-lookup"><span data-stu-id="c8888-219">An example DNS forwarder is available in hello [Azure Quickstart Templates gallery](https://azure.microsoft.com/documentation/templates/301-dns-forwarder/) and [GitHub](https://github.com/Azure/azure-quickstart-templates/tree/master/301-dns-forwarder).</span></span>

![DNS entre redes virtuales](./media/virtual-networks-name-resolution-for-vms-and-role-instances/inter-vnet-dns.png)

<span data-ttu-id="c8888-221">Cuando se utiliza la resolución de nombres que viene con Azure, un sufijo DNS interno (*. internal.cloudapp.net) proporcionado tooeach VM usa DHCP.</span><span class="sxs-lookup"><span data-stu-id="c8888-221">When using Azure-provided name resolution, an Internal DNS suffix (*.internal.cloudapp.net) is provided tooeach VM using DHCP.</span></span>  <span data-ttu-id="c8888-222">Esto habilita la resolución de nombre de host como nombre de host de hello registros se encuentran en la zona de internal.cloudapp.net Hola.</span><span class="sxs-lookup"><span data-stu-id="c8888-222">This enables hostname resolution as hello hostname records are in hello internal.cloudapp.net zone.</span></span>  <span data-ttu-id="c8888-223">Cuando se utiliza su propia solución de resolución de nombre, Hola IDN sufijo no es proporciona tooVMs puesto que interfiere con otras arquitecturas DNS (por ejemplo, en escenarios unidos a un dominio).</span><span class="sxs-lookup"><span data-stu-id="c8888-223">When using your own name resolution solution, hello IDNS suffix is not supplied tooVMs because it interferes with other DNS architectures (like domain-joined scenarios).</span></span>  <span data-ttu-id="c8888-224">En su lugar, proporcionamos un marcador de posición no funcional (reddog.microsoft.com).</span><span class="sxs-lookup"><span data-stu-id="c8888-224">Instead we provide a non-functioning placeholder (reddog.microsoft.com).</span></span>  

<span data-ttu-id="c8888-225">Si es necesario, se puede determinar sufijo de DNS interno de hello mediante API de PowerShell o hello:</span><span class="sxs-lookup"><span data-stu-id="c8888-225">If needed, hello Internal DNS suffix can be determined using PowerShell or hello API:</span></span>

* <span data-ttu-id="c8888-226">Para las redes virtuales en modelos de implementación del Administrador de recursos, está disponible a través de hello sufijo hello [tarjeta de interfaz de red](https://msdn.microsoft.com/library/azure/mt163668.aspx) recurso o a través de hello [AzureRmNetworkInterface Get](https://msdn.microsoft.com/library/mt619434.aspx) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c8888-226">For virtual networks in Resource Manager deployment models, hello suffix is available via hello [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource or via hello [Get-AzureRmNetworkInterface](https://msdn.microsoft.com/library/mt619434.aspx) cmdlet.</span></span>    
* <span data-ttu-id="c8888-227">En los modelos de implementación clásica, está disponible a través de hello sufijo hello [obtener API de implementación](https://msdn.microsoft.com/library/azure/ee460804.aspx) llamar o a través de hello [Get-AzureVM-depurar](https://msdn.microsoft.com/library/azure/dn495236.aspx) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c8888-227">In classic deployment models, hello suffix is available via hello [Get Deployment API](https://msdn.microsoft.com/library/azure/ee460804.aspx) call or via hello [Get-AzureVM -Debug](https://msdn.microsoft.com/library/azure/dn495236.aspx) cmdlet.</span></span>

<span data-ttu-id="c8888-228">Si el reenvío de las consultas tooAzure no se ajusta a sus necesidades, deberá tooprovide su propia solución DNS.</span><span class="sxs-lookup"><span data-stu-id="c8888-228">If forwarding queries tooAzure doesn't suit your needs, you will need tooprovide your own DNS solution.</span></span>  <span data-ttu-id="c8888-229">La solución de DNS deberá cumplir estos requisitos:</span><span class="sxs-lookup"><span data-stu-id="c8888-229">Your DNS solution will need to:</span></span>

* <span data-ttu-id="c8888-230">Proporcionar la resolución adecuada de nombres de host, por ejemplo, mediante [DDNS](virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="c8888-230">Provide appropriate hostname resolution, e.g. via [DDNS](virtual-networks-name-resolution-ddns.md).</span></span>  <span data-ttu-id="c8888-231">Tenga en cuenta que si utiliza DDNS debe toodisable DNS borrado de registros de concesiones DHCP de Azure son muy largos y eliminación de registros obsoletos puede quitar DNS registra prematuramente.</span><span class="sxs-lookup"><span data-stu-id="c8888-231">Note, if using DDNS you may need toodisable DNS record scavenging as Azure's DHCP leases are very long and scavenging may remove DNS records prematurely.</span></span> 
* <span data-ttu-id="c8888-232">Proporcionar resolución recursiva adecuado de tooallow de resolución de nombres de dominio externos.</span><span class="sxs-lookup"><span data-stu-id="c8888-232">Provide appropriate recursive resolution tooallow resolution of external domain names.</span></span>
* <span data-ttu-id="c8888-233">Se puede tener acceso (TCP y UDP en el puerto 53) de los clientes de hello sirve y ser capaz de tooaccess Hola internet.</span><span class="sxs-lookup"><span data-stu-id="c8888-233">Be accessible (TCP and UDP on port 53) from hello clients it serves and be able tooaccess hello internet.</span></span>
* <span data-ttu-id="c8888-234">Protegerse contra el acceso de hello internet, toomitigate amenazas agentes externos.</span><span class="sxs-lookup"><span data-stu-id="c8888-234">Be secured against access from hello internet, toomitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="c8888-235">Para obtener el mejor rendimiento, cuando se usa máquinas virtuales de Azure como servidores DNS, se debe deshabilitar IPv6 y un [IP pública a nivel de instancia](virtual-networks-instance-level-public-ip.md) debe asignarse la máquina virtual del servidor DNS de tooeach.</span><span class="sxs-lookup"><span data-stu-id="c8888-235">For best performance, when using Azure VMs as DNS servers, IPv6 should be disabled and an [Instance-Level Public IP](virtual-networks-instance-level-public-ip.md) should be assigned tooeach DNS server VM.</span></span>  <span data-ttu-id="c8888-236">Si elige toouse Windows Server como el servidor DNS, [este artículo](http://blogs.technet.com/b/networking/archive/2015/08/19/name-resolution-performance-of-a-recursive-windows-dns-server-2012-r2.aspx) proporciona análisis de rendimiento adicionales y las optimizaciones.</span><span class="sxs-lookup"><span data-stu-id="c8888-236">If you choose toouse Windows Server as your DNS server, [this article](http://blogs.technet.com/b/networking/archive/2015/08/19/name-resolution-performance-of-a-recursive-windows-dns-server-2012-r2.aspx) provides additional performance analysis and optimizations.</span></span>
> 
> 

### <a name="specifying-dns-servers"></a><span data-ttu-id="c8888-237">Especificar los servidores DNS</span><span class="sxs-lookup"><span data-stu-id="c8888-237">Specifying DNS servers</span></span>
<span data-ttu-id="c8888-238">Al utilizar sus propios servidores DNS, Azure proporciona Hola capacidad toospecify varios servidores DNS por cada red virtual o por red (Administrador de recursos) de la interfaz / servicio (clásica) en la nube.</span><span class="sxs-lookup"><span data-stu-id="c8888-238">When using your own DNS servers, Azure provides hello ability toospecify multiple DNS servers per virtual network or per network interface (Resource Manager) / cloud service (classic).</span></span>  <span data-ttu-id="c8888-239">Los servidores DNS especificados para una interfaz de red o servicio de nube obtienen prioridad frente a las especificadas para la red virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="c8888-239">DNS servers specified for a cloud service/network interface get precedence over those specified for hello virtual network.</span></span>

> [!NOTE]
> <span data-ttu-id="c8888-240">Propiedades de conexión de red, como el servidor DNS de direcciones IP, no debe editarse directamente dentro de máquinas virtuales de Windows tal y como puede obtener borran durante el servicio de reparación cuando se reemplaza el adaptador de red virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="c8888-240">Network connection properties, such as DNS server IPs, should not be edited directly within Windows VMs as they may get erased during service heal when hello virtual network adaptor gets replaced.</span></span> 
> 
> 

<span data-ttu-id="c8888-241">Cuando se usa el modelo de implementación del Administrador de recursos de hello, servidores DNS pueden especificarse en hello Portal, API/plantillas ([vnet](https://msdn.microsoft.com/library/azure/mt163661.aspx), [nic](https://msdn.microsoft.com/library/azure/mt163668.aspx)) o PowerShell ([vnet](https://msdn.microsoft.com/library/mt603657.aspx), [nic](https://msdn.microsoft.com/library/mt619370.aspx)).</span><span class="sxs-lookup"><span data-stu-id="c8888-241">When using hello Resource Manager deployment model, DNS servers can be specified in hello Portal, API/Templates ([vnet](https://msdn.microsoft.com/library/azure/mt163661.aspx), [nic](https://msdn.microsoft.com/library/azure/mt163668.aspx)) or PowerShell ([vnet](https://msdn.microsoft.com/library/mt603657.aspx), [nic](https://msdn.microsoft.com/library/mt619370.aspx)).</span></span>

<span data-ttu-id="c8888-242">Cuando se usa el modelo de implementación clásica de hello, servidores DNS de red virtual de hello puede especificarse en Hola Portal o [hello *configuración de red* archivo](https://msdn.microsoft.com/library/azure/jj157100).</span><span class="sxs-lookup"><span data-stu-id="c8888-242">When using hello classic deployment model, DNS servers for hello virtual network can be specified in hello Portal or [hello *Network Configuration* file](https://msdn.microsoft.com/library/azure/jj157100).</span></span>  <span data-ttu-id="c8888-243">Servicios de nube, los servidores DNS Hola se especifican a través de [hello *configuración del servicio* archivo](https://msdn.microsoft.com/library/azure/ee758710) o en PowerShell ([New-AzureVM](https://msdn.microsoft.com/library/azure/dn495254.aspx)).</span><span class="sxs-lookup"><span data-stu-id="c8888-243">For cloud services, hello DNS servers are specified via [hello *Service Configuration* file](https://msdn.microsoft.com/library/azure/ee758710) or in PowerShell ([New-AzureVM](https://msdn.microsoft.com/library/azure/dn495254.aspx)).</span></span>

> [!NOTE]
> <span data-ttu-id="c8888-244">Si cambiar la configuración de DNS de Hola para una máquina virtual/red virtual que ya se ha implementado, necesitará toorestart cada VM afectado para hello cambios tootake efecto.</span><span class="sxs-lookup"><span data-stu-id="c8888-244">If you change hello DNS settings for a virtual network/virtual machine that is already deployed, you need toorestart each affected VM for hello changes tootake effect.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="c8888-245">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="c8888-245">Next steps</span></span>
<span data-ttu-id="c8888-246">Modelo de implementación de Resource Manager:</span><span class="sxs-lookup"><span data-stu-id="c8888-246">Resource Manager deployment model:</span></span>

* [<span data-ttu-id="c8888-247">Creación o actualización de una red virtual</span><span class="sxs-lookup"><span data-stu-id="c8888-247">Create or update a virtual network</span></span>](https://msdn.microsoft.com/library/azure/mt163661.aspx)
* [<span data-ttu-id="c8888-248">Creación o actualización de una tarjeta de interfaz de red</span><span class="sxs-lookup"><span data-stu-id="c8888-248">Create or update a network interface card</span></span>](https://msdn.microsoft.com/library/azure/mt163668.aspx)
* [<span data-ttu-id="c8888-249">New-AzureRmVirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="c8888-249">New-AzureRmVirtualNetwork</span></span>](https://msdn.microsoft.com/library/mt603657.aspx)
* [<span data-ttu-id="c8888-250">New-AzureRmNetworkInterface</span><span class="sxs-lookup"><span data-stu-id="c8888-250">New-AzureRmNetworkInterface</span></span>](https://msdn.microsoft.com/library/mt619370.aspx)

<span data-ttu-id="c8888-251">Modelo de implementación clásico:</span><span class="sxs-lookup"><span data-stu-id="c8888-251">Classic deployment model:</span></span>

* [<span data-ttu-id="c8888-252">Esquema de configuración del servicio de Azure</span><span class="sxs-lookup"><span data-stu-id="c8888-252">Azure Service Configuration Schema</span></span>](https://msdn.microsoft.com/library/azure/ee758710)
* [<span data-ttu-id="c8888-253">Esquema de configuración de Red virtual</span><span class="sxs-lookup"><span data-stu-id="c8888-253">Virtual Network Configuration Schema</span></span>](https://msdn.microsoft.com/library/azure/jj157100)
* [<span data-ttu-id="c8888-254">Configuración de una red virtual con un archivo de configuración de red</span><span class="sxs-lookup"><span data-stu-id="c8888-254">Configure a Virtual Network by Using a Network Configuration File</span></span>](virtual-networks-using-network-configuration-file.md) 

