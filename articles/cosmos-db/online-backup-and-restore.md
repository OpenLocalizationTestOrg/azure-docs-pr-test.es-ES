---
title: "aaaOnline de copia de seguridad y restauración con la base de datos de Azure Cosmos | Documentos de Microsoft"
description: "Obtenga información acerca de cómo tooperform automática de copia de seguridad y restauración en una base de datos de la base de datos de Azure Cosmos."
keywords: "copias de seguridad y restauración, copia de seguridad en línea"
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: a0b464c95681dfc7b5462b02bf04c2c43d6bc16f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="3a113-104">Copias de seguridad y restauración automáticas en línea con Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="3a113-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="3a113-105">Azure Cosmos DB crea automáticamente copias de seguridad de todos los datos a intervalos regulares.</span><span class="sxs-lookup"><span data-stu-id="3a113-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="3a113-106">se realizan copias de seguridad automáticas de Hello sin afectar al rendimiento de Hola o la disponibilidad de las operaciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3a113-106">hello automatic backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="3a113-107">Todas las copias de seguridad se almacenan por separado en otro servicio de almacenamiento y se replican globalmente para lograr resistencia frente a desastres regionales.</span><span class="sxs-lookup"><span data-stu-id="3a113-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="3a113-108">copias de seguridad automáticas de Hello están pensadas para escenarios cuando se elimina el contenedor de la base de datos de Comos y versiones posteriores requiere la recuperación de datos o una solución de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3a113-108">hello automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="3a113-109">En este artículo se inicia con un resumen rápido de redundancia de datos de Hola y la disponibilidad de base de datos de Cosmos y, a continuación, se describe las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="3a113-109">This article starts with a quick recap of hello data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="3a113-110">Resumen de la alta disponibilidad con Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="3a113-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="3a113-111">COSMOS DB está diseñado toobe [distribuidos globalmente](distribute-data-globally.md) : permite la capacidad tooscale en varias regiones de Azure junto con la directiva controlada por la API de hospedaje múltiple transparentes y conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="3a113-111">Cosmos DB is designed toobe [globally distributed](distribute-data-globally.md) – it allows you tooscale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="3a113-112">Como una oferta de sistema de base de datos [disponibilidad del 99,99% SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db), todas las escrituras de hello en DB Cosmos son discos de toolocal duradera por un quórum de las réplicas en un centro de datos local antes de confirmar toohello cliente.</span><span class="sxs-lookup"><span data-stu-id="3a113-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all hello writes in Cosmos DB are durably committed toolocal disks by a quorum of replicas within a local data center before acknowledging toohello client.</span></span> <span data-ttu-id="3a113-113">Tenga en cuenta que Hola alta disponibilidad de base de datos de Cosmos se basa en el almacenamiento local y no depende de las tecnologías de almacenamiento externo.</span><span class="sxs-lookup"><span data-stu-id="3a113-113">Note that hello high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="3a113-114">Además, si la cuenta de base de datos está asociada con más de una región de Azure, las escrituras se replicarán también en otras regiones.</span><span class="sxs-lookup"><span data-stu-id="3a113-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="3a113-115">tooscale los datos de rendimiento y acceso en las latencias de bajas, puede tener muchas leen regiones asociadas a su cuenta de base de datos como sea necesario.</span><span class="sxs-lookup"><span data-stu-id="3a113-115">tooscale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="3a113-116">En cada región de lectura, los datos de hello (Replicada) se guardan manera duradera a través de un conjunto de réplicas.</span><span class="sxs-lookup"><span data-stu-id="3a113-116">In each read region, hello (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="3a113-117">Como se muestra en hello siguiente diagrama, un único contenedor de base de datos de Cosmos es [con particiones horizontales](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="3a113-117">As illustrated in hello following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="3a113-118">Una partición de"" se indica mediante un círculo en hello siguiente diagrama, y cada partición ofrezca alta disponibilidad a través de un conjunto de réplicas.</span><span class="sxs-lookup"><span data-stu-id="3a113-118">A “partition” is denoted by a circle in hello following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="3a113-119">Se trata de distribución local de hello en una única región de Azure (indicada por el eje X de hello).</span><span class="sxs-lookup"><span data-stu-id="3a113-119">This is hello local distribution within a single Azure region (denoted by hello X axis).</span></span> <span data-ttu-id="3a113-120">Además, cada partición (con su conjunto de réplicas correspondiente), a continuación, se distribuye globalmente en varias regiones asociadas a su cuenta de base de datos (por ejemplo, en esta ilustración Hola tres regiones: este de EE., oeste de Estados Unidos y de la India Central).</span><span class="sxs-lookup"><span data-stu-id="3a113-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration hello three regions – East US, West US and Central India).</span></span> <span data-ttu-id="3a113-121">Hola "conjunto de particiones" es distribuidos globalmente entidad compuestas por varias copias de los datos en cada región (se indica con eje de Hola Y).</span><span class="sxs-lookup"><span data-stu-id="3a113-121">hello “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by hello Y axis).</span></span> <span data-ttu-id="3a113-122">Puede asignar prioridad regiones toohello asociadas con su cuenta de base de datos y base de datos de Cosmos transparente conmutarán toohello siguiente región de conmutación por error en caso de desastre.</span><span class="sxs-lookup"><span data-stu-id="3a113-122">You can assign priority toohello regions associated with your database account and Cosmos DB will transparently failover toohello next region in case of disaster.</span></span> <span data-ttu-id="3a113-123">Puede simular manualmente la disponibilidad de conmutación por error tootest Hola-to-end de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3a113-123">You can also manually simulate failover tootest hello end-to-end availability of your application.</span></span>  

<span data-ttu-id="3a113-124">Hello siguiente imagen ilustra alto grado de redundancia con DB Cosmos de Hola.</span><span class="sxs-lookup"><span data-stu-id="3a113-124">hello following image illustrates hello high degree of redundancy with Cosmos DB.</span></span>

![Alto grado de redundancia con Cosmos DB](./media/online-backup-and-restore/redundancy.png)

![Alto grado de redundancia con Cosmos DB](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="3a113-127">Copias de seguridad completas, automáticas y en línea</span><span class="sxs-lookup"><span data-stu-id="3a113-127">Full, automatic, online backups</span></span>
<span data-ttu-id="3a113-128">¡Vaya! Eliminé mi contenedor o base de datos.</span><span class="sxs-lookup"><span data-stu-id="3a113-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="3a113-129">Con la base de datos de Cosmos, no solo los datos, pero las copias de seguridad de Hola de los datos se realizan también frente a desastres tooregional altamente resistente y redundantes.</span><span class="sxs-lookup"><span data-stu-id="3a113-129">With Cosmos DB, not only your data, but hello backups of your data are also made highly redundant and resilient tooregional disasters.</span></span> <span data-ttu-id="3a113-130">Actualmente, estas copias de seguridad automatizadas se crean aproximadamente cada cuatro horas y se almacenan las dos copias de seguridad más recientes en todo momento.</span><span class="sxs-lookup"><span data-stu-id="3a113-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="3a113-131">Si accidentalmente los datos de Hola quita o daña, por favor, [póngase en contacto con soporte técnico de Azure](https://azure.microsoft.com/support/options/) 8 horas.</span><span class="sxs-lookup"><span data-stu-id="3a113-131">If hello data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="3a113-132">se realizan copias de seguridad de Hello sin afectar al rendimiento de Hola o la disponibilidad de las operaciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3a113-132">hello backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="3a113-133">COSMOS DB realiza copia de seguridad de hello en segundo plano de hello sin consumir sus aprovisionamiento RUs o afectar al rendimiento de Hola y sin afectar a la disponibilidad de saludo de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3a113-133">Cosmos DB takes hello backup in hello background without consuming your provisioned RUs or affecting hello performance and without affecting hello availability of your database.</span></span> 

<span data-ttu-id="3a113-134">A diferencia de los datos que se almacenan dentro de la base de datos de Cosmos, copias de seguridad automáticas de Hola se almacenan en el servicio de almacenamiento de blobs de Azure.</span><span class="sxs-lookup"><span data-stu-id="3a113-134">Unlike your data that is stored inside Cosmos DB, hello automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="3a113-135">carga de latencia baja y eficaz de hello tooguarantee, instantánea de saludo de la copia de seguridad es instancia de tooan cargado de almacenamiento de blobs de Azure en Hola misma región que la actual región de escritura hello de la cuenta de base de datos de base de datos de Cosmos.</span><span class="sxs-lookup"><span data-stu-id="3a113-135">tooguarantee hello low latency/efficient upload, hello snapshot of your backup is uploaded tooan instance of Azure Blob storage in hello same region as hello current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="3a113-136">Para lograr resistencia frente a desastres regionales, cada instantánea de los datos de copia de seguridad en almacenamiento de blobs de Azure nuevo se replica a través de la región de tooanother de almacenamiento con redundancia geográfica (GRS).</span><span class="sxs-lookup"><span data-stu-id="3a113-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) tooanother region.</span></span> <span data-ttu-id="3a113-137">Hello siguiente diagrama muestra que todo contenedor de base de datos de Cosmos hello (con todas las tres particiones primarias zona horaria del Pacífico occidental, en este ejemplo) se copia en una cuenta de almacenamiento de blobs de Azure remota zona horaria del Pacífico occidental y, a continuación, GRS replica tooEast nosotros.</span><span class="sxs-lookup"><span data-stu-id="3a113-137">hello following diagram shows that hello entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated tooEast US.</span></span> 

<span data-ttu-id="3a113-138">Hello siguiente imagen ilustra copias de seguridad completas periódicas de todas las entidades de base de datos de Cosmos GRS en almacenamiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="3a113-138">hello following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Copias de seguridad completas y periódicas de todas las entidades de Cosmos DB en Azure Storage de GRS](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="3a113-140">Período de retención de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="3a113-140">Backup retention period</span></span>
<span data-ttu-id="3a113-141">Como se describió anteriormente, base de datos de Azure Cosmos toma instantáneas de los datos cada cuatro horas y conserva la última dos instantáneas de Hola de cada partición durante 30 días.</span><span class="sxs-lookup"><span data-stu-id="3a113-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains hello last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="3a113-142">Siguiendo nuestras normas de cumplimiento, las instantáneas se purgan después de 90 días.</span><span class="sxs-lookup"><span data-stu-id="3a113-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="3a113-143">Si desea toomaintain sus propias instantáneas, puede utilizar la opción de tooJSON de exportación de hello en la base de datos de Azure Cosmos hello [herramienta de migración de datos](import-data.md#export-to-json-file) tooschedule copias de seguridad adicionales.</span><span class="sxs-lookup"><span data-stu-id="3a113-143">If you want toomaintain your own snapshots, you can use hello export tooJSON option in hello Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) tooschedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="3a113-144">Restauración de una base de datos desde una copia de seguridad en línea</span><span class="sxs-lookup"><span data-stu-id="3a113-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="3a113-145">Si elimina accidentalmente la base de datos o una colección, puede [una incidencia de soporte técnico](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) o [llame al soporte técnico de Azure](https://azure.microsoft.com/support/options/) toorestore datos de saludo de copia de seguridad automática Hola último.</span><span class="sxs-lookup"><span data-stu-id="3a113-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) toorestore hello data from hello last automatic backup.</span></span> <span data-ttu-id="3a113-146">Si necesita toorestore la base de datos debido a problemas de corrupción de datos, consulte [daños en los datos de control](#handling-data-corruption) según sea necesario tootake adicional pasos tooprevent Hola dañado datos de copias de seguridad de hello penetrar.</span><span class="sxs-lookup"><span data-stu-id="3a113-146">If you need toorestore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need tootake additional steps tooprevent hello corrupted data from penetrating hello backups.</span></span> <span data-ttu-id="3a113-147">Para obtener una instantánea concreta de la copia de seguridad toobe restaurar, Cosmos DB requiere que había disponibles datos de Hola durante Hola del ciclo de copia de seguridad de Hola para esa instantánea.</span><span class="sxs-lookup"><span data-stu-id="3a113-147">For a specific snapshot of your backup toobe restored, Cosmos DB requires that hello data was available for hello duration of hello backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="3a113-148">Control de los datos dañados</span><span class="sxs-lookup"><span data-stu-id="3a113-148">Handling data corruption</span></span>
<span data-ttu-id="3a113-149">Base de datos de Azure Cosmos conserva copias de dos últimas seguridad de Hola de cada partición en el sistema de Hola.</span><span class="sxs-lookup"><span data-stu-id="3a113-149">Azure Cosmos DB retains hello last two backups of every partition in hello system.</span></span> <span data-ttu-id="3a113-150">Este modelo funciona muy bien cuando un contenedor (colección de documentos, gráfico y tabla) o una base de datos se elimina accidentalmente porque una de las últimas versiones de Hola se puede restaurar.</span><span class="sxs-lookup"><span data-stu-id="3a113-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of hello last versions can be restored.</span></span> <span data-ttu-id="3a113-151">Sin embargo, en hello caso cuando cuando los usuarios pueden introducir un problema de daños en los datos, base de datos de Azure Cosmos puede ser consciente de daños en los datos hello y es posible que Hola daños pueda haber entrado en las copias de seguridad de Hola.</span><span class="sxs-lookup"><span data-stu-id="3a113-151">However, in hello case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of hello data corruption, and it is possible that hello corruption may have penetrated hello backups.</span></span> <span data-ttu-id="3a113-152">En cuanto se detectan daños, debe eliminar el contenedor Hola dañado (colección/gráfico y tabla) para que las copias de seguridad estén protegidos contra sobrescritura con datos dañados.</span><span class="sxs-lookup"><span data-stu-id="3a113-152">As soon as corruption is detected, you should delete hello corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="3a113-153">Puesto que la última copia de seguridad de hello podría ser cuatro horas de antigüedad, puede emplear el usuario hello [Cambiar fuente](change-feed.md) toocapture y almacén Hola últimas cuatro horas que vale la pena de datos antes de eliminar el contenedor de Hola.</span><span class="sxs-lookup"><span data-stu-id="3a113-153">Since hello last backup could be four hours old, hello user can employ [change feed](change-feed.md) toocapture and store hello last four hours worth of data before deleting hello container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3a113-154">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="3a113-154">Next steps</span></span>

<span data-ttu-id="3a113-155">la base de datos en varios centros de datos, vea a tooreplicate [distribuir los datos globales con la base de datos de Cosmos](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="3a113-155">tooreplicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="3a113-156">toofile póngase en contacto con soporte técnico de Azure, [una incidencia de hello portal de Azure](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="3a113-156">toofile contact Azure Support, [file a ticket from hello Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

