---
title: sugerencias de aaaPerformance - Azure Cosmos DB NoSQL | Documentos de Microsoft
description: "Obtenga información acerca de rendimiento de base de datos de base de datos de Azure Cosmos de cliente configuración opciones tooimprove"
keywords: "¿Cómo tooimprove base de datos de rendimiento"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 94ff155e-f9bc-488f-8c7a-5e7037091bb9
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/23/2017
ms.author: mimig
ms.openlocfilehash: 4f3e82ae5048e3dbc20b0fd891a2d3aa22adf3fc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tips-for-azure-cosmos-db"></a><span data-ttu-id="b1fdf-104">Sugerencias de rendimiento para Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="b1fdf-104">Performance tips for Azure Cosmos DB</span></span>
<span data-ttu-id="b1fdf-105">Azure Cosmos DB es una base de datos distribuida rápida y flexible que se escala sin problemas con una latencia y un rendimiento garantizados.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-105">Azure Cosmos DB is a fast and flexible distributed database that scales seamlessly with guaranteed latency and throughput.</span></span> <span data-ttu-id="b1fdf-106">No tiene cambios de la arquitectura principal de toomake o escribir código complejo tooscale la base de datos con la base de datos de Cosmos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-106">You do not have toomake major architecture changes or write complex code tooscale your database with Cosmos DB.</span></span> <span data-ttu-id="b1fdf-107">Escalar o reducir verticalmente es tan sencillo como realizar una única llamada de API o con el [método SDK](set-throughput.md#set-throughput-sdk).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-107">Scaling up and down is as easy as making a single API call or [SDK method call](set-throughput.md#set-throughput-sdk).</span></span> <span data-ttu-id="b1fdf-108">Sin embargo, dado que Cosmos DB se tiene acceso a través de llamadas de red no existe son las optimizaciones de lado cliente puede realizar tooachieve obtener un buen rendimiento.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-108">However, because Cosmos DB is accessed via network calls there are client-side optimizations you can make tooachieve peak performance.</span></span>

<span data-ttu-id="b1fdf-109">Así que si se está preguntando "¿Cómo puedo mejorar el rendimiento de la base de datos?",</span><span class="sxs-lookup"><span data-stu-id="b1fdf-109">So if you're asking "How can I improve my database performance?"</span></span> <span data-ttu-id="b1fdf-110">Considere la posibilidad de hello siguientes opciones:</span><span class="sxs-lookup"><span data-stu-id="b1fdf-110">consider hello following options:</span></span>

## <a name="networking"></a><span data-ttu-id="b1fdf-111">Redes</span><span class="sxs-lookup"><span data-stu-id="b1fdf-111">Networking</span></span>
<a id="direct-connection"></a>

1. <span data-ttu-id="b1fdf-112">**Directiva de conexión: uso del modo de conexión directa**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-112">**Connection policy: Use direct connection mode**</span></span>

    <span data-ttu-id="b1fdf-113">Cómo un cliente conecta tooCosmos DB tiene importantes implicaciones en el rendimiento, especialmente en cuanto a la latencia de cliente observado.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-113">How a client connects tooCosmos DB has important implications on performance, especially in terms of observed client-side latency.</span></span> <span data-ttu-id="b1fdf-114">Hay dos opciones de configuración clave para la configuración de cliente de directiva de conexión: conexión de hello *modo* hello y [conexión *protocolo*](#connection-protocol).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-114">There are two key configuration settings available for configuring client Connection Policy – hello connection *mode* and hello [connection *protocol*](#connection-protocol).</span></span>  <span data-ttu-id="b1fdf-115">Hola dos modos disponibles son:</span><span class="sxs-lookup"><span data-stu-id="b1fdf-115">hello two available modes are:</span></span>

   1. <span data-ttu-id="b1fdf-116">Modo de puerta de enlace (predeterminado)</span><span class="sxs-lookup"><span data-stu-id="b1fdf-116">Gateway Mode (default)</span></span>
   2. <span data-ttu-id="b1fdf-117">Modo directo</span><span class="sxs-lookup"><span data-stu-id="b1fdf-117">Direct Mode</span></span>

      <span data-ttu-id="b1fdf-118">Modo de puerta de enlace se admite en todas las plataformas SDK y es el predeterminado de hello configurado.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-118">Gateway Mode is supported on all SDK platforms and is hello configured default.</span></span>  <span data-ttu-id="b1fdf-119">Si la aplicación se ejecuta dentro de una red corporativa con las restricciones del firewall estricta, modo de puerta de enlace es Hola mejor opción ya que utiliza el puerto HTTPS estándar hello y un extremo único.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-119">If your application runs within a corporate network with strict firewall restrictions, Gateway Mode is hello best choice since it uses hello standard HTTPS port and a single endpoint.</span></span> <span data-ttu-id="b1fdf-120">Hola contrapartida del rendimiento, sin embargo, es que el modo de puerta de enlace implica un salto de red adicional cada vez que se lee o escritos tooCosmos DB datos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-120">hello performance tradeoff, however, is that Gateway Mode involves an additional network hop every time data is read or written tooCosmos DB.</span></span> <span data-ttu-id="b1fdf-121">Por este motivo, el modo Direct ofrece mejor rendimiento debido toofewer saltos de red.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-121">Because of this, Direct Mode offers better performance due toofewer network hops.</span></span>
<a id="use-tcp"></a>
2. <span data-ttu-id="b1fdf-122">**Directiva de conexión: usar el protocolo TCP de Hola**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-122">**Connection policy: Use hello TCP protocol**</span></span>

    <span data-ttu-id="b1fdf-123">Al usar el modo directo, hay dos opciones de protocolo disponibles:</span><span class="sxs-lookup"><span data-stu-id="b1fdf-123">When using Direct Mode, there are two protocol options available:</span></span>

   * <span data-ttu-id="b1fdf-124">TCP</span><span class="sxs-lookup"><span data-stu-id="b1fdf-124">TCP</span></span>
   * <span data-ttu-id="b1fdf-125">HTTPS</span><span class="sxs-lookup"><span data-stu-id="b1fdf-125">HTTPS</span></span>

     <span data-ttu-id="b1fdf-126">Cosmos DB ofrece un modelo de programación RESTful sencillo y abierto sobre HTTPS.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-126">Cosmos DB offers a simple and open RESTful programming model over HTTPS.</span></span> <span data-ttu-id="b1fdf-127">Además, ofrece un eficaz protocolo TCP, que también es RESTful en su modelo de comunicación y está disponible a través del SDK de cliente de .NET de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-127">Additionally, it offers an efficient TCP protocol, which is also RESTful in its communication model and is available through hello .NET client SDK.</span></span> <span data-ttu-id="b1fdf-128">Tanto HTTPS como TCP directo usan SSL para la autenticación inicial y cifrar el tráfico.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-128">Both Direct TCP and HTTPS use SSL for initial authentication and encrypting traffic.</span></span> <span data-ttu-id="b1fdf-129">Para obtener el mejor rendimiento, usar el protocolo TCP de hello cuando sea posible.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-129">For best performance, use hello TCP protocol when possible.</span></span>

     <span data-ttu-id="b1fdf-130">Al usar TCP en modo de puerta de enlace, puerto TCP 443 es hello puerto DB Cosmos y 10255 es el puerto de la API de MongoDB de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-130">When using TCP in Gateway Mode, TCP Port 443 is hello Cosmos DB port, and 10255 is hello MongoDB API port.</span></span> <span data-ttu-id="b1fdf-131">Cuando se utiliza TCP en modo directo, en puertos de puerta de enlace de suma toohello, necesita tooensure Hola puerto está abierto entre 10000 y 20000 porque Cosmos DB usa puertos TCP dinámicos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-131">When using TCP in Direct Mode, in addition toohello Gateway ports, you need tooensure hello port range between 10000 and 20000 is open because Cosmos DB uses dynamic TCP ports.</span></span> <span data-ttu-id="b1fdf-132">Si estos puertos no están abiertos e intentas toouse TCP, recibirá un error 503 Servicio no disponible.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-132">If these ports are not open and you attempt toouse TCP, you receive a 503 Service Unavailable error.</span></span>

     <span data-ttu-id="b1fdf-133">Hola modo de conectividad se configura durante la construcción de Hola de instancia de hello DocumentClient con el parámetro ConnectionPolicy Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-133">hello Connectivity Mode is configured during hello construction of hello DocumentClient instance with hello ConnectionPolicy parameter.</span></span> <span data-ttu-id="b1fdf-134">Si se utiliza el modo directo, Hola protocolo también puede establecerse en el parámetro de ConnectionPolicy Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-134">If Direct Mode is used, hello Protocol can also be set within hello ConnectionPolicy parameter.</span></span>

    ```C#
    var serviceEndpoint = new Uri("https://contoso.documents.net");
    var authKey = new "your authKey from hello Azure portal";
    DocumentClient client = new DocumentClient(serviceEndpoint, authKey,
    new ConnectionPolicy
    {
        ConnectionMode = ConnectionMode.Direct,
        ConnectionProtocol = Protocol.Tcp
    });
    ```

    <span data-ttu-id="b1fdf-135">Dado que TCP solo se admite en modo directo, si se utiliza el modo de puerta de enlace, a continuación, Hola protocolo HTTPS siempre es usa toocommunicate con puerta de enlace de Hola y Hola valor para el protocolo en hello que connectionpolicy se omite.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-135">Because TCP is only supported in Direct Mode, if Gateway Mode is used, then hello HTTPS protocol is always used toocommunicate with hello Gateway and hello Protocol value in hello ConnectionPolicy is ignored.</span></span>

    ![Ilustración de hello directiva de conexión de base de datos de Azure Cosmos](./media/performance-tips/connection-policy.png)

3. <span data-ttu-id="b1fdf-137">**Llame a la latencia de inicio de OpenAsync tooavoid en la primera solicitud**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-137">**Call OpenAsync tooavoid startup latency on first request**</span></span>

    <span data-ttu-id="b1fdf-138">De forma predeterminada, primera solicitud de hello tiene una latencia mayor porque tiene la tabla de enrutamiento de direcciones de hello toofetch.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-138">By default, hello first request has a higher latency because it has toofetch hello address routing table.</span></span> <span data-ttu-id="b1fdf-139">tooavoid esta latencia de inicio en hello solicitar en primer lugar, debe llamar a OpenAsync() una vez durante la inicialización como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-139">tooavoid this startup latency on hello first request, you should call OpenAsync() once during initialization as follows.</span></span>

        await client.OpenAsync();
   <a id="same-region"></a>
4. <span data-ttu-id="b1fdf-140">**Colocación de los clientes en la misma región de Azure para aumentar el rendimiento**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-140">**Collocate clients in same Azure region for performance**</span></span>

    <span data-ttu-id="b1fdf-141">Cuando sea posible, las aplicaciones que llaman a base de datos de Cosmos Hola misma región que el contexto Hola base de datos de base de datos de Cosmos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-141">When possible, place any applications calling Cosmos DB in hello same region as hello Cosmos DB database.</span></span> <span data-ttu-id="b1fdf-142">Para ver una comparación aproximada, llama a tooCosmos DB dentro de hello misma región se completa en 1 o 2 ms, pero latencia Hola entre Hola oeste y este costa de hello US es > 50 ms.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-142">For an approximate comparison, calls tooCosmos DB within hello same region complete within 1-2 ms, but hello latency between hello West and East coast of hello US is >50 ms.</span></span> <span data-ttu-id="b1fdf-143">Esta latencia probablemente puede variar de solicitud toorequest según la ruta de hello realizada por solicitud de hello cuando pasan del límite de hello cliente toohello centro de datos de Azure.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-143">This latency can likely vary from request toorequest depending on hello route taken by hello request as it passes from hello client toohello Azure datacenter boundary.</span></span> <span data-ttu-id="b1fdf-144">Hola menor latencia posible se consigue asegurándose de que realiza la llamada Hola aplicación se encuentra dentro de hello misma región de Azure como Hola aprovisionado el punto de conexión de base de datos de Cosmos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-144">hello lowest possible latency is achieved by ensuring hello calling application is located within hello same Azure region as hello provisioned Cosmos DB endpoint.</span></span> <span data-ttu-id="b1fdf-145">Para obtener una lista de regiones disponibles, consulte [Regiones de Azure](https://azure.microsoft.com/regions/#services).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-145">For a list of available regions, see [Azure Regions](https://azure.microsoft.com/regions/#services).</span></span>

    <span data-ttu-id="b1fdf-146">![Ilustración de hello directiva de conexión de base de datos de Azure Cosmos](./media/performance-tips/same-region.png)
   <a id="increase-threads"></a></span><span class="sxs-lookup"><span data-stu-id="b1fdf-146">![Illustration of hello Azure Cosmos DB connection policy](./media/performance-tips/same-region.png)
<a id="increase-threads"></a></span></span>
5. <span data-ttu-id="b1fdf-147">**Aumento del número de subprocesos y tareas**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-147">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="b1fdf-148">Puesto que se realizan llamadas tooAzure Cosmos DB a través de red de hello, deberá grado de hello toovary de paralelismo de las solicitudes para que pase de aplicación de cliente de hello muy poco tiempo de espera entre solicitudes.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-148">Since calls tooAzure Cosmos DB are made over hello network, you may need toovary hello degree of parallelism of your requests so that hello client application spends very little time waiting between requests.</span></span> <span data-ttu-id="b1fdf-149">Por ejemplo, si está usando. De NET [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), cree en orden de Hola de 100s de tareas de lectura o escritura tooCosmos base de datos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-149">For example, if you're using .NET's [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), create in hello order of 100s of Tasks reading or writing tooCosmos DB.</span></span>

## <a name="sdk-usage"></a><span data-ttu-id="b1fdf-150">Uso del SDK</span><span class="sxs-lookup"><span data-stu-id="b1fdf-150">SDK Usage</span></span>
1. <span data-ttu-id="b1fdf-151">**Instalar Hola SDK más reciente**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-151">**Install hello most recent SDK**</span></span>

    <span data-ttu-id="b1fdf-152">Hola Cosmos DB SDK constantemente se están tooprovide mejorada Hola obtener el mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-152">hello Cosmos DB SDKs are constantly being improved tooprovide hello best performance.</span></span> <span data-ttu-id="b1fdf-153">Vea hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) páginas toodetermine Hola SDK más reciente y revise mejoras.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-153">See hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) pages toodetermine hello most recent SDK and review improvements.</span></span>
2. <span data-ttu-id="b1fdf-154">**Usar a un cliente de base de datos de Cosmos de singleton para duración de saludo de la aplicación**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-154">**Use a singleton Cosmos DB client for hello lifetime of your application**</span></span>

    <span data-ttu-id="b1fdf-155">Tenga en cuenta que cada instancia de DocumentClient está protegida frente amenazas y realiza una administración de conexiones y un almacenamiento en caché de las direcciones de manera eficiente cuando funciona en modo directo.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-155">Note that each DocumentClient instance is thread-safe and performs efficient connection management and address caching when operating in Direct Mode.</span></span> <span data-ttu-id="b1fdf-156">administración de conexiones eficaz de tooallow y un mejor rendimiento si DocumentClient, resulta recomendable toouse una única instancia de DocumentClient por AppDomain dure Hola de aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-156">tooallow efficient connection management and better performance by DocumentClient, it is recommended toouse a single instance of DocumentClient per AppDomain for hello lifetime of hello application.</span></span>

   <a id="max-connection"></a>
3. <span data-ttu-id="b1fdf-157">**Aumento de System.Net MaxConnections por host al usar el modo de puerta de enlace**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-157">**Increase System.Net MaxConnections per host when using Gateway mode**</span></span>

    <span data-ttu-id="b1fdf-158">Las solicitudes de COSMOS DB se realizan a través de HTTPS/REST al utilizar el modo de puerta de enlace y son el límite de conexiones predeterminado toohello sometidos por nombre de host o dirección IP.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-158">Cosmos DB requests are made over HTTPS/REST when using Gateway mode, and are subjected toohello default connection limit per hostname or IP address.</span></span> <span data-ttu-id="b1fdf-159">Puede que tenga tooset Hola MaxConnections tooa alto (100-1000) para que hello biblioteca de cliente puede utilizar varias conexiones simultáneas tooCosmos base de datos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-159">You may need tooset hello MaxConnections tooa higher value (100-1000) so that hello client library can utilize multiple simultaneous connections tooCosmos DB.</span></span> <span data-ttu-id="b1fdf-160">Hola .NET SDK 1.8.0 y anteriormente, Hola el valor predeterminado de [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) es 50 y toochange Hola valor, puede establecer hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit ](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa mayor valor.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-160">In hello .NET SDK 1.8.0 and above, hello default value for [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) is 50 and toochange hello value, you can set hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa higher value.</span></span>   
4. <span data-ttu-id="b1fdf-161">**Ajuste de consultas paralelas en colecciones particionadas**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-161">**Tuning parallel queries for partitioned collections**</span></span>

     <span data-ttu-id="b1fdf-162">Versión 1.9.0 del SDK de .NET de DocumentDB y versiones posteriores de compatibilidad con las consultas en paralelo, lo que permitirá tooquery una colección con particiones en paralelo (vea [trabajar con hello SDK](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) hello relacionados y [ejemplos de código](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) para obtener más información.)</span><span class="sxs-lookup"><span data-stu-id="b1fdf-162">DocumentDB .NET SDK version 1.9.0 and above support parallel queries, which enable you tooquery a partitioned collection in parallel (see [Working with hello SDKs](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) and hello related [code samples](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) for more info).</span></span> <span data-ttu-id="b1fdf-163">Las consultas en paralelo son tooimprove diseñada la latencia de consulta y el rendimiento a través de su serie correspondiente.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-163">Parallel queries are designed tooimprove query latency and throughput over their serial counterpart.</span></span> <span data-ttu-id="b1fdf-164">Las consultas en paralelo proporcionan dos parámetros que los usuarios pueden ajustar toocustom ajustar sus requisitos, MaxDegreeOfParallelism (a): número máximo de hello toocontrol de particiones, a continuación, se puede consultar en paralelo y (b) MaxBufferedItemCount: número de hello toocontrol de resultados capturados previamente.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-164">Parallel queries provide two parameters that users can tune toocustom-fit their requirements, (a) MaxDegreeOfParallelism: toocontrol hello maximum number of partitions then can be queried in parallel, and (b) MaxBufferedItemCount: toocontrol hello number of pre-fetched results.</span></span>

    <span data-ttu-id="b1fdf-165">(a) La consulta paralela ***Tuning MaxDegreeOfParallelism\:*** realiza consultas en varias particiones en paralelo.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-165">(a) ***Tuning MaxDegreeOfParallelism\:*** Parallel query works by querying multiple partitions in parallel.</span></span> <span data-ttu-id="b1fdf-166">Sin embargo, los datos de una recopilación con particiones individual se capturan en serie con sentido toohello consulta.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-166">However, data from an individual partitioned collect is fetched serially with respect toohello query.</span></span> <span data-ttu-id="b1fdf-167">Por lo tanto, al establecer Hola MaxDegreeOfParallelism toohello número de particiones tiene la oportunidad máximo de Hola de lograr Hola mayoría de rendimiento de consulta, siempre que todas las demás condiciones de sistema permanecen igual Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-167">So, setting hello MaxDegreeOfParallelism toohello number of partitions has hello maximum chance of achieving hello most performant query, provided all other system conditions remain hello same.</span></span> <span data-ttu-id="b1fdf-168">Si no conoce el número de Hola de particiones, puede establecer número elevado de hello MaxDegreeOfParallelism tooa y sistema de hello elige mínimo hello (número de particiones, proporcionados por el usuario proporcionado) como Hola MaxDegreeOfParallelism.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-168">If you don't know hello number of partitions, you can set hello MaxDegreeOfParallelism tooa high number, and hello system chooses hello minimum (number of partitions, user provided input) as hello MaxDegreeOfParallelism.</span></span>

    <span data-ttu-id="b1fdf-169">Es importante toonote que mejor ventajas de las consultas producen hello en paralelo si los datos de Hola se distribuyen uniformemente en todas las particiones con sentido toohello consulta.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-169">It is important toonote that parallel queries produce hello best benefits if hello data is evenly distributed across all partitions with respect toohello query.</span></span> <span data-ttu-id="b1fdf-170">Si Hola particiones colección se crean particiones de tal forma que todos o a la mayoría de los datos de hello devueltos por una consulta se concentra en algunas particiones (una partición en el peor de los casos), a continuación, rendimiento Hola de consulta de Hola podría ser restringido por esas particiones.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-170">If hello partitioned collection is partitioned such a way that all or a majority of hello data returned by a query is concentrated in a few partitions (one partition in worst case), then hello performance of hello query would be bottlenecked by those partitions.</span></span>

    <span data-ttu-id="b1fdf-171">(b) ***para la optimización MaxBufferedItemCount\: *** consultas en paralelo es resultados de búsqueda toopre diseñada mientras se está procesando el lote actual de Hola de resultados por cliente hello.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-171">(b) ***Tuning MaxBufferedItemCount\:*** Parallel query is designed toopre-fetch results while hello current batch of results is being processed by hello client.</span></span> <span data-ttu-id="b1fdf-172">Hola ayuda general mejora la latencia de una consulta en la captura previa.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-172">hello pre-fetching helps in overall latency improvement of a query.</span></span> <span data-ttu-id="b1fdf-173">MaxBufferedItemCount es número de hello parámetro toolimit Hola de resultados previamente capturados.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-173">MaxBufferedItemCount is hello parameter toolimit hello number of pre-fetched results.</span></span> <span data-ttu-id="b1fdf-174">Establecer MaxBufferedItemCount toohello espera el número de resultados devueltos (o un número mayor) permite Hola consulta tooreceive máximo aprovechan la captura previa.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-174">Setting MaxBufferedItemCount toohello expected number of results returned (or a higher number) allows hello query tooreceive maximum benefit from pre-fetching.</span></span>

    <span data-ttu-id="b1fdf-175">Tenga en cuenta que funciona la búsqueda anticipada Hola misma forma independientemente de hello MaxDegreeOfParallelism, y no hay un único búfer para los datos de Hola de todas las particiones.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-175">Note that pre-fetching works hello same way irrespective of hello MaxDegreeOfParallelism, and there is a single buffer for hello data from all partitions.</span></span>  
5. <span data-ttu-id="b1fdf-176">**Activación de GC del lado servidor**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-176">**Turn on server-side GC**</span></span>

    <span data-ttu-id="b1fdf-177">Puede ayudar a reducir la frecuencia de Hola de recolección de elementos en algunos casos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-177">Reducing hello frequency of garbage collection may help in some cases.</span></span> <span data-ttu-id="b1fdf-178">En. NET, establezca [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-178">In .NET, set [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span></span>
6. <span data-ttu-id="b1fdf-179">**Implementación del retroceso según intervalos RetryAfter**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-179">**Implement backoff at RetryAfter intervals**</span></span>

    <span data-ttu-id="b1fdf-180">Durante las pruebas de rendimiento, debe aumentar la carga hasta que se limite una tasa de solicitudes pequeña.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-180">During performance testing, you should increase load until a small rate of requests get throttled.</span></span> <span data-ttu-id="b1fdf-181">Si limita, Hola aplicación cliente debe intervalo de reintento de interrupción en la limitación de hello especificado por el servidor.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-181">If throttled, hello client application should backoff on throttle for hello server-specified retry interval.</span></span> <span data-ttu-id="b1fdf-182">Respeta Hola retroceso garantiza que dedicar una cantidad mínima de espera de tiempo entre reintentos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-182">Respecting hello backoff ensures that you spend minimal amount of time waiting between retries.</span></span> <span data-ttu-id="b1fdf-183">Compatibilidad con la directiva de reintento se incluye en la versión 1.8.0 y versiones posteriores de hello DocumentDB [.NET](documentdb-sdk-dotnet.md) y [Java](documentdb-sdk-java.md), versión 1.9.0 y versiones posteriores de hello [Node.js](documentdb-sdk-node.md) y [ Python](documentdb-sdk-python.md), y todas las versiones compatibles de hello [.NET Core](documentdb-sdk-dotnet-core.md) SDK.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-183">Retry policy support is included in Version 1.8.0 and above of hello DocumentDB [.NET](documentdb-sdk-dotnet.md) and [Java](documentdb-sdk-java.md), version 1.9.0 and above of hello [Node.js](documentdb-sdk-node.md) and [Python](documentdb-sdk-python.md), and all supported versions of hello [.NET Core](documentdb-sdk-dotnet-core.md) SDKs.</span></span> <span data-ttu-id="b1fdf-184">Para más información, consulte [Superación de los límites de rendimiento reservados](request-units.md#RequestRateTooLarge) y [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-184">For more information, see [Exceeding reserved throughput limits](request-units.md#RequestRateTooLarge) and [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span></span>
7. <span data-ttu-id="b1fdf-185">**Escalado horizontal de la carga de trabajo de cliente**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-185">**Scale out your client-workload**</span></span>

    <span data-ttu-id="b1fdf-186">Si va a probar en los niveles de rendimiento alto (> 50.000 RU/s), aplicación de cliente de Hola quede cuello de botella de hello debido toohello máquina límite de uso de CPU o la red.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-186">If you are testing at high throughput levels (>50,000 RU/s), hello client application may become hello bottleneck due toohello machine capping out on CPU or Network utilization.</span></span> <span data-ttu-id="b1fdf-187">Si alcanza este punto, puede continuar cuenta de base de datos de Cosmos de Hola de toopush aún más mediante el escalado horizontal de las aplicaciones cliente en varios servidores.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-187">If you reach this point, you can continue toopush hello Cosmos DB account further by scaling out your client applications across multiple servers.</span></span>
8. <span data-ttu-id="b1fdf-188">**Almacenamiento en caché de los identificadores URI de documentos para una latencia menor en las operaciones de lectura**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-188">**Cache document URIs for lower read latency**</span></span>

    <span data-ttu-id="b1fdf-189">Documento de la memoria caché URI siempre que sea posible para obtener el mejor rendimiento de lectura Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-189">Cache document URIs whenever possible for hello best read performance.</span></span>
   <a id="tune-page-size"></a>
9. <span data-ttu-id="b1fdf-190">**Ajustar el tamaño de página de Hola para consultas o leer fuentes para mejorar el rendimiento**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-190">**Tune hello page size for queries/read feeds for better performance**</span></span>

    <span data-ttu-id="b1fdf-191">Cuando realiza una masiva lee de documentos mediante la lectura fuente funcionalidad (por ejemplo, ReadDocumentFeedAsync) o al emitir una consulta SQL de DocumentDB, se devuelven resultados de hello en un modo segmentado si el conjunto de resultados de hello es demasiado grande.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-191">When performing a bulk read of documents using read feed functionality (for example, ReadDocumentFeedAsync) or when issuing a DocumentDB SQL query, hello results are returned in a segmented fashion if hello result set is too large.</span></span> <span data-ttu-id="b1fdf-192">De forma predeterminada, se devuelven resultados en fragmentos de 1 MB o de 100 artículos, el límite que se alcance primero.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-192">By default, results are returned in chunks of 100 items or 1 MB, whichever limit is hit first.</span></span>

    <span data-ttu-id="b1fdf-193">número de hello tooreduce de red tooretrieve de viajes de ida y requiere todos los resultados aplicables, puede aumentar el tamaño de página de hello mediante too1000 de tooup de encabezado de solicitud de x-ms-max-item-count.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-193">tooreduce hello number of network round trips required tooretrieve all applicable results, you can increase hello page size using x-ms-max-item-count request header tooup too1000.</span></span> <span data-ttu-id="b1fdf-194">En casos donde es necesario toodisplay solo unos pocos resultados, por ejemplo, si la API de interfaz o aplicación de usuario se devuelve solo 10 da como resultado un tiempo, también puede reducir Hola tamaño too10 tooreduce Hola rendimiento de páginas utilizado para las lecturas y las consultas.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-194">In cases where you need toodisplay only a few results, for example, if your user interface or application API returns only 10 results a time, you can also decrease hello page size too10 tooreduce hello throughput consumed for reads and queries.</span></span>

    <span data-ttu-id="b1fdf-195">También es posible establecer el tamaño de página de hello utilizando Hola disponible Cosmos DB SDK.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-195">You may also set hello page size using hello available Cosmos DB SDKs.</span></span>  <span data-ttu-id="b1fdf-196">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="b1fdf-196">For example:</span></span>

        IQueryable<dynamic> authorResults = client.CreateDocumentQuery(documentCollection.SelfLink, "SELECT p.Author FROM Pages p WHERE p.Title = 'About Seattle'", new FeedOptions { MaxItemCount = 1000 });
10. <span data-ttu-id="b1fdf-197">**Aumento del número de subprocesos y tareas**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-197">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="b1fdf-198">Vea [aumentar el número de subprocesos/tareas](#increase-threads) Hola sección de redes.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-198">See [Increase number of threads/tasks](#increase-threads) in hello Networking section.</span></span>

11. <span data-ttu-id="b1fdf-199">**Uso del proceso de host de 64 bits**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-199">**Use 64-bit host processing**</span></span>

    <span data-ttu-id="b1fdf-200">Hola DocumentDB SDK funciona en un proceso de host de 32 bits cuando se utiliza la versión 1.11.4 del SDK de .NET de DocumentDB y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-200">hello DocumentDB SDK works in a 32-bit host process when you are using DocumentDB .NET SDK version 1.11.4 and above.</span></span> <span data-ttu-id="b1fdf-201">Sin embargo, si utiliza consultas entre particiones, se recomienda el proceso de host de 64 bits para obtener un mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-201">However, if you are using cross partition queries, 64-bit host processing is recommended for improved performance.</span></span> <span data-ttu-id="b1fdf-202">Hola siguientes tipos de aplicaciones tiene el host de 32 bits procesa como valor predeterminado de hello, en orden toochange es too64 bits, siga estos pasos en función de tipo de saludo de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="b1fdf-202">hello following types of applications have 32-bit host process as hello default, so in order toochange that too64-bit, follow these steps based on hello type of your application:</span></span>

    - <span data-ttu-id="b1fdf-203">Para las aplicaciones ejecutables, esto puede hacerse por hello desactivando **preferencia de 32 bits** opción Hola **propiedades del proyecto** ventana hello **compilar** ficha.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-203">For Executable applications, this can be done by unchecking hello **Prefer 32-bit** option in hello **Project Properties** window, on hello **Build** tab.</span></span>

    - <span data-ttu-id="b1fdf-204">Para VSTest basados en proyectos de prueba, puede hacerlo seleccionando **probar**->**una configuración de pruebas**->**predeterminado de arquitectura de procesador como X64**, de hello **Visual Studio Test** opción de menú.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-204">For VSTest based test projects, this can be done by selecting **Test**->**Test Settings**->**Default Processor Architecture as X64**, from hello **Visual Studio Test** menu option.</span></span>

    - <span data-ttu-id="b1fdf-205">Para aplicaciones Web ASP.NET implementadas localmente, esto puede hacerse mediante la comprobación de hello **versión de 64 bits del Hola uso de IIS Express para proyectos y sitios web**, en **herramientas** ->  **Opciones de**->**proyectos y soluciones**->**proyectos Web**.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-205">For locally deployed ASP.NET Web applications, this can be done by checking hello **Use hello 64-bit version of IIS Express for web sites and projects**, under **Tools**->**Options**->**Projects and Solutions**->**Web Projects**.</span></span>

    - <span data-ttu-id="b1fdf-206">Para aplicaciones Web ASP.NET implementadas en Azure, puede hacerlo eligiendo hello **plataforma de 64 bits** en hello **configuración de la aplicación** en hello portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-206">For ASP.NET Web applications deployed on Azure, this can be done by choosing hello **Platform as 64-bit** in hello **Application Settings** on hello Azure portal.</span></span>

## <a name="indexing-policy"></a><span data-ttu-id="b1fdf-207">Directiva de indexación</span><span class="sxs-lookup"><span data-stu-id="b1fdf-207">Indexing Policy</span></span>
1. <span data-ttu-id="b1fdf-208">**Uso de la indexación diferida para lograr tasas de ingesta más rápidas a horas punta**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-208">**Use lazy indexing for faster peak time ingestion rates**</span></span>

    <span data-ttu-id="b1fdf-209">Base de datos de COSMOS permite toospecify – en nivel de colección de hello: una directiva de indexación, lo que le permite toochoose si desea que los documentos de hello en un toobe de colección que se indizan automáticamente o no.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-209">Cosmos DB allows you toospecify – at hello collection level – an indexing policy, which enables you toochoose if you want hello documents in a collection toobe automatically indexed or not.</span></span>  <span data-ttu-id="b1fdf-210">Además, puede elegir entre actualizaciones de índices sincrónicas (coherentes) y asincrónicas (diferidas).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-210">In addition, you may also choose between synchronous (Consistent) and asynchronous (Lazy) index updates.</span></span> <span data-ttu-id="b1fdf-211">De forma predeterminada, el índice de Hola se actualiza sincrónicamente en cada insert, replace o delete de una colección de toohello de documento.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-211">By default, hello index is updated synchronously on each insert, replace, or delete of a document toohello collection.</span></span> <span data-ttu-id="b1fdf-212">Sincrónicamente toohonor de las consultas de modo permite Hola Hola mismo [nivel de coherencia](consistency-levels.md) que Hola documento lee sin ningún retraso índice Hola demasiado "ponerse al día".</span><span class="sxs-lookup"><span data-stu-id="b1fdf-212">Synchronously mode enables hello queries toohonor hello same [consistency level](consistency-levels.md) as that of hello document reads without any delay for hello index too“catch up".</span></span>

    <span data-ttu-id="b1fdf-213">Puede considerar la indexación diferida para escenarios en los que los datos se escriben en ráfagas y desea tooamortize Hola trabajo necesario tooindex contenido durante un período más largo de tiempo.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-213">Lazy indexing may be considered for scenarios in which data is written in bursts, and you want tooamortize hello work required tooindex content over a longer period of time.</span></span> <span data-ttu-id="b1fdf-214">La indexación diferida también le permite toouse su aprovisionado el rendimiento de forma eficaz y servir las solicitudes de escritura en momentos de máxima con una latencia mínima.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-214">Lazy indexing also allows you toouse your provisioned throughput effectively and serve write requests at peak times with minimal latency.</span></span> <span data-ttu-id="b1fdf-215">Es importante toonote, sin embargo, que, cuando está habilitada la indexación diferida, resultados de la consulta son coherentes independientemente del nivel de coherencia de hello configurada para la cuenta de base de datos de Cosmos Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-215">It is important toonote, however, that when lazy indexing is enabled, query results are eventually consistent regardless of hello consistency level configured for hello Cosmos DB account.</span></span>

    <span data-ttu-id="b1fdf-216">Por lo tanto, modo de indexación coherente (IndexingPolicy.IndexingMode se establece tooConsistent) incurre Hola mayor solicitud cargo por unidad por escritura mientras Lazy indización modo (IndexingPolicy.IndexingMode tooLazy) y no la indización (IndexingPolicy.Automatic está establecido tooFalse) tienen un coste cero indización en tiempo de Hola de escritura.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-216">Hence, Consistent indexing mode (IndexingPolicy.IndexingMode is set tooConsistent) incurs hello highest request unit charge per write, while Lazy indexing mode (IndexingPolicy.IndexingMode is set tooLazy) and no indexing (IndexingPolicy.Automatic is set tooFalse) have zero indexing cost at hello time of write.</span></span>
2. <span data-ttu-id="b1fdf-217">**Exclusión de rutas de acceso sin utilizar de la indexación para acelerar las escrituras**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-217">**Exclude unused paths from indexing for faster writes**</span></span>

    <span data-ttu-id="b1fdf-218">Directiva de indexación de COSMOS de base de datos también le permite toospecify que tooinclude de rutas de acceso de documento o excluir de la indización mediante el aprovechamiento de las rutas de indización (IndexingPolicy.IncludedPaths y IndexingPolicy.ExcludedPaths).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-218">Cosmos DB’s indexing policy also allows you toospecify which document paths tooinclude or exclude from indexing by leveraging Indexing Paths (IndexingPolicy.IncludedPaths and IndexingPolicy.ExcludedPaths).</span></span> <span data-ttu-id="b1fdf-219">uso de Hola de rutas de acceso de la indización puede ofrecer un rendimiento de escritura mejorado y almacenamiento de índice inferior en escenarios en qué Hola patrones de consulta se conocen de antemano, ya que los costos de indización directamente correlacionados toohello número de rutas de acceso únicas indizadas.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-219">hello use of indexing paths can offer improved write performance and lower index storage for scenarios in which hello query patterns are known beforehand, as indexing costs are directly correlated toohello number of unique paths indexed.</span></span>  <span data-ttu-id="b1fdf-220">Por ejemplo, hello siguiente código muestra cómo tooexclude toda una sección de hello documenta (conocido como)</span><span class="sxs-lookup"><span data-stu-id="b1fdf-220">For example, hello following code shows how tooexclude an entire section of hello documents (a.k.a.</span></span> <span data-ttu-id="b1fdf-221">un subárbol) de la indización utilizando Hola "*" comodín.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-221">a subtree) from indexing using hello "*" wildcard.</span></span>

    ```C#
    var collection = new DocumentCollection { Id = "excludedPathCollection" };
    collection.IndexingPolicy.IncludedPaths.Add(new IncludedPath { Path = "/*" });
    collection.IndexingPolicy.ExcludedPaths.Add(new ExcludedPath { Path = "/nonIndexedContent/*");
    collection = await client.CreateDocumentCollectionAsync(UriFactory.CreateDatabaseUri("db"), excluded);
    ```

    <span data-ttu-id="b1fdf-222">Para más información, consulte [Directivas de indexación de Azure Cosmos DB](indexing-policies.md).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-222">For more information, see [Azure Cosmos DB indexing policies](indexing-policies.md).</span></span>

## <a name="throughput"></a><span data-ttu-id="b1fdf-223">Rendimiento</span><span class="sxs-lookup"><span data-stu-id="b1fdf-223">Throughput</span></span>
<a id="measure-rus"></a>

1. <span data-ttu-id="b1fdf-224">**Medición y optimización del uso menor de unidades de solicitud por segundo**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-224">**Measure and tune for lower request units/second usage**</span></span>

    <span data-ttu-id="b1fdf-225">COSMOS DB ofrece un amplio conjunto de operaciones de base de datos incluidas relacionales y jerárquicas de las consultas con UDF, procedimientos almacenados y desencadenadores: todos los controles en documentos de hello dentro de una colección de base de datos.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-225">Cosmos DB offers a rich set of database operations including relational and hierarchical queries with UDFs, stored procedures, and triggers – all operating on hello documents within a database collection.</span></span> <span data-ttu-id="b1fdf-226">costo de Hello asociada a cada una de estas operaciones varía en función de hello CPU, E/S y memoria necesaria toocomplete Hola operación.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-226">hello cost associated with each of these operations varies based on hello CPU, IO, and memory required toocomplete hello operation.</span></span> <span data-ttu-id="b1fdf-227">En lugar de pensar y administrar los recursos de hardware, se pueden considerar una unidad de solicitud (RU) como una única medida de hello recursos necesarios tooperform varias operaciones de base de datos y el servicio una solicitud de aplicación.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-227">Instead of thinking about and managing hardware resources, you can think of a request unit (RU) as a single measure for hello resources required tooperform various database operations and service an application request.</span></span>

    <span data-ttu-id="b1fdf-228">[Unidades de solicitud](request-units.md) aprovisionados para cada cuenta de base de datos según el número de Hola de unidades de capacidad que adquiera.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-228">[Request units](request-units.md) are provisioned for each database account based on hello number of capacity units that you purchase.</span></span> <span data-ttu-id="b1fdf-229">El consumo de la unidad de solicitud se evalúa como frecuencia por segundo.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-229">Request unit consumption is evaluated as a rate per second.</span></span> <span data-ttu-id="b1fdf-230">Las aplicaciones que superan la unidad de solicitud de aprovisionamiento de hello velocidad se limita su cuenta hasta que la velocidad de hello cae por debajo de hello nivel reservado para la cuenta de hello.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-230">Applications that exceed hello provisioned request unit rate for their account is limited until hello rate drops below hello reserved level for hello account.</span></span> <span data-ttu-id="b1fdf-231">Si su aplicación necesita un nivel mayor de capacidad de proceso, puede adquirir unidades de capacidad adicionales.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-231">If your application requires a higher level of throughput, you can purchase additional capacity units.</span></span>

    <span data-ttu-id="b1fdf-232">complejidad de Hola de una consulta afecta a cuántas unidades de solicitud se usan para una operación.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-232">hello complexity of a query impacts how many Request Units are consumed for an operation.</span></span> <span data-ttu-id="b1fdf-233">número de Hola de predicados, naturaleza de los predicados de hello, el número de UDF y tamaño de hello del conjunto de datos de origen de hello todos influyen en el costo de Hola de operaciones de consulta.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-233">hello number of predicates, nature of hello predicates, number of UDFs, and hello size of hello source data set all influence hello cost of query operations.</span></span>

    <span data-ttu-id="b1fdf-234">sobrecarga de hello toomeasure de cualquier operación (crear, actualizar o eliminar), inspeccionar el encabezado x-ms-solicitud-cargo de hello (u Hola propiedad RequestCharge equivalente en ResourceResponse<T> o FeedResponse<T> Hola .NET SDK) toomeasure número de Hola de unidades de solicitud utilizado por estas operaciones.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-234">toomeasure hello overhead of any operation (create, update, or delete), inspect hello x-ms-request-charge header (or hello equivalent RequestCharge property in ResourceResponse<T> or FeedResponse<T> in hello .NET SDK) toomeasure hello number of request units consumed by these operations.</span></span>

    ```C#
    // Measure hello performance (request units) of writes
    ResourceResponse<Document> response = await client.CreateDocumentAsync(collectionSelfLink, myDocument);
    Console.WriteLine("Insert of document consumed {0} request units", response.RequestCharge);
    // Measure hello performance (request units) of queries
    IDocumentQuery<dynamic> queryable = client.CreateDocumentQuery(collectionSelfLink, queryString).AsDocumentQuery();
    while (queryable.HasMoreResults)
         {
              FeedResponse<dynamic> queryResponse = await queryable.ExecuteNextAsync<dynamic>();
              Console.WriteLine("Query batch consumed {0} request units", queryResponse.RequestCharge);
         }
    ```             

    <span data-ttu-id="b1fdf-235">Hello devuelve en el encabezado de carga de solicitud es una fracción de su rendimiento aprovisionado (es decir, 2000 RUs / segundo).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-235">hello request charge returned in this header is a fraction of your provisioned throughput (i.e., 2000 RUs / second).</span></span> <span data-ttu-id="b1fdf-236">Por ejemplo, si hello consulta anterior devuelve documentos de 1KB de 1000, costo de Hola de operación de hello es 1000.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-236">For example, if hello preceding query returns 1000 1KB-documents, hello cost of hello operation is 1000.</span></span> <span data-ttu-id="b1fdf-237">Por lo tanto, dentro de un segundo servidor hello respeta sólo dos de estas solicitudes antes de la limitación de las solicitudes posteriores.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-237">As such, within one second, hello server honors only two such requests before throttling subsequent requests.</span></span> <span data-ttu-id="b1fdf-238">Para obtener más información, consulte [unidades de solicitud](request-units.md) hello y [Calculadora de unidades de solicitud](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-238">For more information, see [Request units](request-units.md) and hello [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span>
<a id="429"></a>
2. <span data-ttu-id="b1fdf-239">**Administración de la limitación de velocidad y la tasa de solicitudes demasiado grande**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-239">**Handle rate limiting/request rate too large**</span></span>

    <span data-ttu-id="b1fdf-240">Cuando un cliente intenta tooexceed Hola reservado el rendimiento de una cuenta, no hay ninguna degradación del rendimiento en el servidor de Hola y ningún uso de la capacidad de rendimiento supera el nivel de hello reservado.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-240">When a client attempts tooexceed hello reserved throughput for an account, there is no performance degradation at hello server and no use of throughput capacity beyond hello reserved level.</span></span> <span data-ttu-id="b1fdf-241">servidor de Hola forma preferente finalizará solicitud Hola con RequestRateTooLarge (código de estado HTTP 429) y Hola devuelto x reintento ms después de ms de encabezado, indicando Hola período de tiempo, en milisegundos, que Hola usuario debe esperar antes de volver a intentar realizar la solicitud de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-241">hello server will preemptively end hello request with RequestRateTooLarge (HTTP status code 429) and return hello x-ms-retry-after-ms header indicating hello amount of time, in milliseconds, that hello user must wait before reattempting hello request.</span></span>

        HTTP Status 429,
        Status Line: RequestRateTooLarge
        x-ms-retry-after-ms :100

    <span data-ttu-id="b1fdf-242">implícitamente todos los SDK de Hello detecta esta respuesta, respeta encabezado Hola especificado por el servidor retry-after y vuelva a intentar la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-242">hello SDKs all implicitly catch this response, respect hello server-specified retry-after header, and retry hello request.</span></span> <span data-ttu-id="b1fdf-243">A menos que su cuenta está obteniendo acceso al mismo tiempo varios clientes, el siguiente reintento de Hola se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-243">Unless your account is being accessed concurrently by multiple clients, hello next retry will succeed.</span></span>

    <span data-ttu-id="b1fdf-244">Si tiene más de un cliente de manera acumulativa operativo constantemente por encima de la tasa de solicitud de hello, Hola número de reintentos predeterminado actualmente conjunto too9 internamente por el cliente de hello puede no ser suficiente; en este caso, el cliente de hello produce un DocumentClientException con 429 toohello aplicación de código de estado.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-244">If you have more than one client cumulatively operating consistently above hello request rate, hello default retry count currently set too9 internally by hello client may not suffice; in this case, hello client throws a DocumentClientException with status code 429 toohello application.</span></span> <span data-ttu-id="b1fdf-245">número de reintentos de Hello predeterminado puede cambiarse mediante hello RetryOptions de configuración en la instancia de ConnectionPolicy Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-245">hello default retry count can be changed by setting hello RetryOptions on hello ConnectionPolicy instance.</span></span> <span data-ttu-id="b1fdf-246">De forma predeterminada, se devuelve hello DocumentClientException con código de estado 429 después de un tiempo de espera acumulado de 30 segundos si solicitud Hola continúa toooperate por encima de la tasa de solicitud de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-246">By default, hello DocumentClientException with status code 429 is returned after a cumulative wait time of 30 seconds if hello request continues toooperate above hello request rate.</span></span> <span data-ttu-id="b1fdf-247">Esto ocurre incluso si el número de reintentos actual de hello es inferior Hola máximo de reintentos, ya sea el valor predeterminado es Hola 9 o un valor definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-247">This occurs even when hello current retry count is less than hello max retry count, be it hello default of 9 or a user-defined value.</span></span>

    <span data-ttu-id="b1fdf-248">Mientras Hola automatizada comportamiento para reintentar la ayuda a tooimprove resistencia y facilidad de uso para hello mayoría de las aplicaciones, podría realizar enfrentado al realizar pruebas comparativas de rendimiento, especialmente al medir la latencia.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-248">While hello automated retry behavior helps tooimprove resiliency and usability for hello most applications, it might come at odds when doing performance benchmarks, especially when measuring latency.</span></span>  <span data-ttu-id="b1fdf-249">latencia de Hello observados por el cliente tendrá un pico si experimento Hola aciertos Acelerador de servidor hello y hace que el cliente de hello reintento toosilently SDK.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-249">hello client-observed latency will spike if hello experiment hits hello server throttle and causes hello client SDK toosilently retry.</span></span> <span data-ttu-id="b1fdf-250">latencia de tooavoid tiene un pico en los experimentos de rendimiento, medida Hola cargo devueltos por cada operación y asegurarse de que las solicitudes están funcionando por debajo de la tasa de solicitud reservada de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-250">tooavoid latency spikes during performance experiments, measure hello charge returned by each operation and ensure that requests are operating below hello reserved request rate.</span></span> <span data-ttu-id="b1fdf-251">Para más información, consulte [Unidades de solicitud](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-251">For more information, see [Request units](request-units.md).</span></span>
3. <span data-ttu-id="b1fdf-252">**Diseño de documentos más pequeños para un mayor rendimiento**</span><span class="sxs-lookup"><span data-stu-id="b1fdf-252">**Design for smaller documents for higher throughput**</span></span>

    <span data-ttu-id="b1fdf-253">Hola cargo de solicitud (es decir, el costo de procesamiento de la solicitud) de una operación determinada es directamente correlacionados toohello tamaño de documento de Hola.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-253">hello request charge (i.e. request processing cost) of a given operation is directly correlated toohello size of hello document.</span></span> <span data-ttu-id="b1fdf-254">Las operaciones con documentos grandes cuestan más que las operaciones con documentos pequeños.</span><span class="sxs-lookup"><span data-stu-id="b1fdf-254">Operations on large documents cost more than operations for small documents.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b1fdf-255">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="b1fdf-255">Next steps</span></span>
<span data-ttu-id="b1fdf-256">Para una tooevaluate de aplicación que se usa de ejemplo DB Cosmos para escenarios de alto rendimiento en algunos equipos cliente, consulte [pruebas con la base de datos de Cosmos de escala y rendimiento](performance-testing.md).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-256">For a sample application used tooevaluate Cosmos DB for high-performance scenarios on a few client machines, see [Performance and scale testing with Cosmos DB](performance-testing.md).</span></span>

<span data-ttu-id="b1fdf-257">Además, toolearn más acerca de cómo diseñar la aplicación para la escala y alto rendimiento, consulte [particiones y ajuste de escala en la base de datos de Azure Cosmos](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="b1fdf-257">Also, toolearn more about designing your application for scale and high performance, see [Partitioning and scaling in Azure Cosmos DB](partition-data.md).</span></span>
