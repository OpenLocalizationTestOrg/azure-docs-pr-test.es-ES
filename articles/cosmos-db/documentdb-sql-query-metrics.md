---
title: "aaaSQL las métricas de consulta para la API de documentos de base de datos de Azure Cosmos | Documentos de Microsoft"
description: "Obtenga información acerca de cómo tooinstrument y depuración Hola rendimiento de las consultas SQL de las solicitudes de base de datos de Azure Cosmos."
keywords: consulta sql, consultas sql, sintaxis sql, lenguaje de consulta json, conceptos de base de datos y consultas sql, funciones de agregado
services: cosmos-db
documentationcenter: 
author: arramac
manager: jhubbard
editor: monicar
ms.assetid: b2fa8e8f-7291-45a3-9bd1-7284ed9077f8
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/15/2017
ms.author: arramac
ms.openlocfilehash: 2fee3786b7d48d254162699471943e316764b003
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="tuning-query-performance-with-azure-cosmos-db"></a><span data-ttu-id="a9581-104">Optimización del rendimiento de consultas con Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="a9581-104">Tuning query performance with Azure Cosmos DB</span></span>
<span data-ttu-id="a9581-105">Azure Cosmos DB proporciona una [API de SQL para consultar datos](documentdb-sql-query.md), sin necesidad de índices de esquema o secundarios.</span><span class="sxs-lookup"><span data-stu-id="a9581-105">Azure Cosmos DB provides a [SQL API for querying data](documentdb-sql-query.md), without requiring schema or secondary indexes.</span></span> <span data-ttu-id="a9581-106">Este artículo ofrece Hola siguiente información para desarrolladores:</span><span class="sxs-lookup"><span data-stu-id="a9581-106">This article provides hello following information for developers:</span></span>

* <span data-ttu-id="a9581-107">Detalles de alto nivel sobre cómo funciona la ejecución de consultas SQL de Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="a9581-107">High-level details on how Azure Cosmos DB's SQL query execution works</span></span>
* <span data-ttu-id="a9581-108">Detalles sobre cómo consultar encabezados de solicitud y respuesta y opciones del SDK de cliente</span><span class="sxs-lookup"><span data-stu-id="a9581-108">Details on query request and response headers, and client SDK options</span></span>
* <span data-ttu-id="a9581-109">Sugerencias y procedimientos recomendados para el rendimiento de consultas</span><span class="sxs-lookup"><span data-stu-id="a9581-109">Tips and best practices for query performance</span></span>
* <span data-ttu-id="a9581-110">Ejemplos de cómo toodebug de estadísticas de ejecución de SQL tooutilize rendimiento de las consultas</span><span class="sxs-lookup"><span data-stu-id="a9581-110">Examples of how tooutilize SQL execution statistics toodebug query performance</span></span>

## <a name="about-sql-query-execution"></a><span data-ttu-id="a9581-111">Acerca de la ejecución de consultas SQL</span><span class="sxs-lookup"><span data-stu-id="a9581-111">About SQL query execution</span></span>

<span data-ttu-id="a9581-112">En la base de datos de Azure Cosmos, almacenar datos en contenedores, lo que pueden crecer tooany [rendimiento de tamaño o la solicitud de almacenamiento](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-112">In Azure Cosmos DB, you store data in containers, which can grow tooany [storage size or request throughput](partition-data.md).</span></span> <span data-ttu-id="a9581-113">Base de datos de Azure Cosmos escala perfectamente datos a través de particiones físicas en crecimiento de los datos toohandle Hola portadas o aumentar el rendimiento aprovisionado de.</span><span class="sxs-lookup"><span data-stu-id="a9581-113">Azure Cosmos DB seamlessly scales data across physical partitions under hello covers toohandle data growth or increase in provisioned throughput.</span></span> <span data-ttu-id="a9581-114">Puede emitir contenedor de tooany de consultas SQL mediante API de REST de Hola o uno de hello admitida [SDK de DocumentDB](documentdb-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-114">You can issue SQL queries tooany container using hello REST API or one of hello supported [DocumentDB SDKs](documentdb-sdk-dotnet.md).</span></span>

<span data-ttu-id="a9581-115">Una breve introducción a la creación de particiones: se define una clave de partición como "ciudad", que determina la forma en que los datos se dividen entre particiones físicas.</span><span class="sxs-lookup"><span data-stu-id="a9581-115">A brief overview of partitioning: you define a partition key like "city", which determines how data is split across physical partitions.</span></span> <span data-ttu-id="a9581-116">Clave de una sola partición de datos que pertenecen tooa (por ejemplo, "ciudad" == "Seattle") se almacena en una partición física, pero normalmente una sola partición física tiene varias claves de partición.</span><span class="sxs-lookup"><span data-stu-id="a9581-116">Data belonging tooa single partition key (for example, "city" == "Seattle") is stored within a physical partition, but typically a single physical partition has multiple partition keys.</span></span> <span data-ttu-id="a9581-117">Cuando una partición alcanza el tamaño de almacenamiento, servicio de hello perfectamente partición Hola divide en dos nuevas particiones y divide la clave de partición de hello uniformemente a través de estas particiones.</span><span class="sxs-lookup"><span data-stu-id="a9581-117">When a partition reaches its storage size, hello service seamlessly splits hello partition into two new partitions, and divides hello partition key evenly across these partitions.</span></span> <span data-ttu-id="a9581-118">Puesto que las particiones son transitorias, hello API usar una abstracción de una "clave intervalo de partición", que denota intervalos Hola de hash de clave de partición.</span><span class="sxs-lookup"><span data-stu-id="a9581-118">Since partitions are transient, hello APIs use an abstraction of a "partition key range", which denotes hello ranges of partition key hashes.</span></span> 

<span data-ttu-id="a9581-119">Cuando se emite un tooAzure consulta Cosmos DB, Hola SDK realiza estos pasos lógicos:</span><span class="sxs-lookup"><span data-stu-id="a9581-119">When you issue a query tooAzure Cosmos DB, hello SDK performs these logical steps:</span></span>

* <span data-ttu-id="a9581-120">Analizar el plan de ejecución de consulta de hello SQL consulta toodetermine Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-120">Parse hello SQL query toodetermine hello query execution plan.</span></span> 
* <span data-ttu-id="a9581-121">Si consulta Hola incluye un filtro con la clave de partición de hello, como `SELECT * FROM c WHERE c.city = "Seattle"`, resulta tooa enrutado sola partición.</span><span class="sxs-lookup"><span data-stu-id="a9581-121">If hello query includes a filter against hello partition key, like `SELECT * FROM c WHERE c.city = "Seattle"`, it is routed tooa single partition.</span></span> <span data-ttu-id="a9581-122">Si consulta hello no tiene un filtro en la clave de partición, a continuación, se ejecuta en todas las particiones y se combinan los resultados del cliente.</span><span class="sxs-lookup"><span data-stu-id="a9581-122">If hello query does not have a filter on partition key, then it is executed in all partitions, and results are merged client side.</span></span>
* <span data-ttu-id="a9581-123">consulta de Hola se ejecuta dentro de cada partición en serie o paralelo, en función de la configuración del cliente.</span><span class="sxs-lookup"><span data-stu-id="a9581-123">hello query is executed within each partition in series or parallel, based on client configuration.</span></span> <span data-ttu-id="a9581-124">En cada partición, consulta Hola podría provocar que uno o más ciclos de ida y vuelta según la complejidad de la consulta de hello, configura el tamaño de página y aprovisionar el rendimiento de la colección de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-124">Within each partition, hello query might make one or more round trips depending on hello query complexity, configured page size, and provisioned throughput of hello collection.</span></span> <span data-ttu-id="a9581-125">Cada ejecución devuelve el número de Hola de [unidades de solicitud](request-units.md) consumido por la ejecución de la consulta y, opcionalmente, las estadísticas de ejecución de consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-125">Each execution returns hello number of [request units](request-units.md) consumed by query execution, and optionally, query execution statistics.</span></span> 
* <span data-ttu-id="a9581-126">Hola SDK realiza un resumen de los resultados de la consulta de hello en particiones.</span><span class="sxs-lookup"><span data-stu-id="a9581-126">hello SDK performs a summarization of hello query results across partitions.</span></span> <span data-ttu-id="a9581-127">Por ejemplo, si consulta Hola implica una cláusula ORDER BY en particiones, los resultados de las particiones individuales son tooreturn ordenada de mezcla resultados ordenados globalmente.</span><span class="sxs-lookup"><span data-stu-id="a9581-127">For example, if hello query involves an ORDER BY across partitions, then results from individual partitions are merge-sorted tooreturn results in globally sorted order.</span></span> <span data-ttu-id="a9581-128">Si consulta hello es una agregación como `COUNT`, recuentos de Hola de particiones individuales están tooproduce sumado Hola el número total.</span><span class="sxs-lookup"><span data-stu-id="a9581-128">If hello query is an aggregation like `COUNT`, hello counts from individual partitions are summed tooproduce hello overall count.</span></span>

<span data-ttu-id="a9581-129">SDK de Hello proporcionan distintas opciones para la ejecución de la consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-129">hello SDKs provide various options for query execution.</span></span> <span data-ttu-id="a9581-130">Por ejemplo, en .NET estas opciones están disponibles en hello `FeedOptions` clase.</span><span class="sxs-lookup"><span data-stu-id="a9581-130">For example, in .NET these options are available in hello `FeedOptions` class.</span></span> <span data-ttu-id="a9581-131">Hello tabla siguiente describen estas opciones y qué manera pueden afectar el tiempo de ejecución de consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-131">hello following table describes these options and how they impact query execution time.</span></span> 

| <span data-ttu-id="a9581-132">Opción</span><span class="sxs-lookup"><span data-stu-id="a9581-132">Option</span></span> | <span data-ttu-id="a9581-133">Descripción</span><span class="sxs-lookup"><span data-stu-id="a9581-133">Description</span></span> |
| ------ | ----------- |
| `EnableCrossPartitionQuery` | <span data-ttu-id="a9581-134">Se debe establecer tootrue para cualquier consulta que requiere toobe ejecutado a través de más de una partición.</span><span class="sxs-lookup"><span data-stu-id="a9581-134">Must be set tootrue for any query that requires toobe executed across more than one partition.</span></span> <span data-ttu-id="a9581-135">Se trata de un tooenable de marca explícita que compensaciones de rendimiento consciente de toomake durante el tiempo de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="a9581-135">This is an explicit flag tooenable you toomake conscious performance tradeoffs during development time.</span></span> |
| `EnableScanInQuery` | <span data-ttu-id="a9581-136">Se debe establecer tootrue si ha decidido no indizar, pero desea consulta de hello toorun a través de un recorrido de todos modos.</span><span class="sxs-lookup"><span data-stu-id="a9581-136">Must be set tootrue if you have opted out of indexing, but want toorun hello query via a scan anyway.</span></span> <span data-ttu-id="a9581-137">Solo es aplicable si la indización para hello solicitada está deshabilitada la ruta de acceso de filtro.</span><span class="sxs-lookup"><span data-stu-id="a9581-137">Only applicable if indexing for hello requested filter path is disabled.</span></span> | 
| `MaxItemCount` | <span data-ttu-id="a9581-138">número máximo de Hola de tooreturn elementos por servidor toohello de ida y vuelta.</span><span class="sxs-lookup"><span data-stu-id="a9581-138">hello maximum number of items tooreturn per round trip toohello server.</span></span> <span data-ttu-id="a9581-139">Al establecer demasiado-1, puede permitir que servidor hello administrar Hola número de elementos.</span><span class="sxs-lookup"><span data-stu-id="a9581-139">By setting too-1, you can let hello server manage hello number of items.</span></span> <span data-ttu-id="a9581-140">O bien, puede reducir este tooretrieve valor solo un pequeño número de elementos por de ida y vuelta.</span><span class="sxs-lookup"><span data-stu-id="a9581-140">Or, you can lower this value tooretrieve only a small number of items per round trip.</span></span> 
| `MaxBufferedItemCount` | <span data-ttu-id="a9581-141">Esto es una opción de cliente y el consumo de memoria de hello toolimit a utilizar al realizar entre particiones ORDER BY.</span><span class="sxs-lookup"><span data-stu-id="a9581-141">This is a client-side option, and used toolimit hello memory consumption when performing cross-partition ORDER BY.</span></span> <span data-ttu-id="a9581-142">Un valor más alto le ayuda a reducir la latencia de Hola de ordenación, entre particiones.</span><span class="sxs-lookup"><span data-stu-id="a9581-142">A higher value helps reduce hello latency of cross-partition sorting.</span></span> |
| `MaxDegreeOfParallelism` | <span data-ttu-id="a9581-143">Obtiene o establece el número de Hola de operaciones simultáneas que se ejecuten en paralelo de cliente durante la ejecución de consultas en paralelo en hello servicio de base de datos de documentos de Azure.</span><span class="sxs-lookup"><span data-stu-id="a9581-143">Gets or sets hello number of concurrent operations run client side during parallel query execution in hello Azure DocumentDB database service.</span></span> <span data-ttu-id="a9581-144">Un valor de propiedad positivo limita Hola valor del número de operaciones simultáneas toohello conjunto.</span><span class="sxs-lookup"><span data-stu-id="a9581-144">A positive property value limits hello number of concurrent operations toohello set value.</span></span> <span data-ttu-id="a9581-145">Si se establece a que no requiere herramientas que 0, el sistema de hello decide automáticamente número Hola de toorun de operaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="a9581-145">If it is set tooless than 0, hello system automatically decides hello number of concurrent operations toorun.</span></span> |
| `PopulateQueryMetrics` | <span data-ttu-id="a9581-146">Permite el registro detallado de estadísticas del tiempo empleado en diversas fases de la ejecución de consultas, como tiempo de compilación, hora de ciclo del índice y tiempo de carga de documentos.</span><span class="sxs-lookup"><span data-stu-id="a9581-146">Enables detailed logging of statistics of time spent in various phases of query execution like compilation time, index loop time, and document load time.</span></span> <span data-ttu-id="a9581-147">Salida de las estadísticas de consulta se puede compartir con problemas de rendimiento de consultas de toodiagnose de soporte técnico de Azure.</span><span class="sxs-lookup"><span data-stu-id="a9581-147">You can share output from query statistics with Azure Support toodiagnose query performance issues.</span></span> |
| `RequestContinuation` | <span data-ttu-id="a9581-148">Para reanudar la ejecución de consulta pasando token de continuación opaco de hello devuelto por una consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-148">You can resume query execution by passing in hello opaque continuation token returned by any query.</span></span> <span data-ttu-id="a9581-149">token de continuación Hola encapsula todo el estado necesario para la ejecución de la consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-149">hello continuation token encapsulates all state required for query execution.</span></span> |
| `ResponseContinuationTokenLimitInKb` | <span data-ttu-id="a9581-150">Puede limitar el tamaño máximo de Hola Hola de token de continuación devuelto por el servidor de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-150">You can limit hello maximum size of hello continuation token returned by hello server.</span></span> <span data-ttu-id="a9581-151">Tendrá que tooset esto si el host de la aplicación tiene límites de tamaño de encabezado de respuesta.</span><span class="sxs-lookup"><span data-stu-id="a9581-151">You might need tooset this if your application host has limits on response header size.</span></span> <span data-ttu-id="a9581-152">Establecer este valor puede aumentar Hola general duración y RUs utilizados para consultas de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-152">Setting this may increase hello overall duration and RUs consumed for hello query.</span></span>  |

<span data-ttu-id="a9581-153">Por ejemplo, consideremos una consulta de ejemplo en la clave de partición solicitado en una colección con `/city` como partición de hello clave y aprovisionada con 100 000 RU/s de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a9581-153">For example, let's take an example query on partition key requested on a collection with `/city` as hello partition key and provisioned with 100,000 RU/s of throughput.</span></span> <span data-ttu-id="a9581-154">Solicitar esta consulta con `CreateDocumentQuery<T>` en .NET como Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="a9581-154">You request this query using `CreateDocumentQuery<T>` in .NET like hello following:</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
        MaxItemCount = -1, 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();
```

<span data-ttu-id="a9581-155">Hello mostrado anteriormente, el fragmento de SDK corresponde toohello después de la solicitud de API de REST:</span><span class="sxs-lookup"><span data-stu-id="a9581-155">hello SDK snippet shown above, corresponds toohello following REST API request:</span></span>

```
POST https://arramacquerymetrics-westus.documents.azure.com/dbs/db/colls/sample/docs HTTP/1.1
x-ms-continuation: 
x-ms-documentdb-isquery: True
x-ms-max-item-count: -1
x-ms-documentdb-query-enablecrosspartition: True
x-ms-documentdb-query-parallelizecrosspartitionquery: True
x-ms-documentdb-query-iscontinuationexpected: True
x-ms-documentdb-populatequerymetrics: True
x-ms-date: Tue, 27 Jun 2017 21:52:18 GMT
authorization: type%3dmaster%26ver%3d1.0%26sig%3drp1Hi83Y8aVV5V6LzZ6xhtQVXRAMz0WNMnUuvriUv%2b4%3d
x-ms-session-token: 7:8,6:2008,5:8,4:2008,3:8,2:2008,1:8,0:8,9:8,8:4008
Cache-Control: no-cache
x-ms-consistency-level: Session
User-Agent: documentdb-dotnet-sdk/1.14.1 Host/32-bit MicrosoftWindowsNT/6.2.9200.0
x-ms-version: 2017-02-22
Accept: application/json
Content-Type: application/query+json
Host: arramacquerymetrics-westus.documents.azure.com
Content-Length: 52
Expect: 100-continue

{"query":"SELECT * FROM c WHERE c.city = 'Seattle'"}
```

<span data-ttu-id="a9581-156">Cada página de la ejecución de consulta corresponde tooa API de REST `POST` con hello `Accept: application/query+json` encabezado y consulta SQL de hello en el cuerpo de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-156">Each query execution page corresponds tooa REST API `POST` with hello `Accept: application/query+json` header, and hello SQL query in hello body.</span></span> <span data-ttu-id="a9581-157">Cada consulta convierte a uno o más redondean server toohello de viajes con hello `x-ms-continuation` muestra el símbolo (token) entre la ejecución de tooresume de cliente y servidor hello.</span><span class="sxs-lookup"><span data-stu-id="a9581-157">Each query makes one or more round trips toohello server with hello `x-ms-continuation` token echoed between hello client and server tooresume execution.</span></span> <span data-ttu-id="a9581-158">Opciones de configuración de Hello en FeedOptions se pasan toohello servidor en forma de Hola de encabezados de solicitud.</span><span class="sxs-lookup"><span data-stu-id="a9581-158">hello configuration options in FeedOptions are passed toohello server in hello form of request headers.</span></span> <span data-ttu-id="a9581-159">Por ejemplo, `MaxItemCount` corresponde demasiado`x-ms-max-item-count`.</span><span class="sxs-lookup"><span data-stu-id="a9581-159">For example, `MaxItemCount` corresponds too`x-ms-max-item-count`.</span></span> 

<span data-ttu-id="a9581-160">solicitud Hello devuelve siguiente hello (truncado para mejorar la legibilidad) respuesta:</span><span class="sxs-lookup"><span data-stu-id="a9581-160">hello request returns hello following (truncated for readability) response:</span></span>

```
HTTP/1.1 200 Ok
Cache-Control: no-store, no-cache
Pragma: no-cache
Transfer-Encoding: chunked
Content-Type: application/json
Server: Microsoft-HTTPAPI/2.0
Strict-Transport-Security: max-age=31536000
x-ms-last-state-change-utc: Tue, 27 Jun 2017 21:01:57.561 GMT
x-ms-resource-quota: documentSize=10240;documentsSize=10485760;documentsCount=-1;collectionSize=10485760;
x-ms-resource-usage: documentSize=1;documentsSize=884;documentsCount=2000;collectionSize=1408;
x-ms-item-count: 2000
x-ms-schemaversion: 1.3
x-ms-alt-content-path: dbs/db/colls/sample
x-ms-content-path: +9kEANVq0wA=
x-ms-xp-role: 1
x-ms-documentdb-query-metrics: totalExecutionTimeInMs=33.67;queryCompileTimeInMs=0.06;queryLogicalPlanBuildTimeInMs=0.02;queryPhysicalPlanBuildTimeInMs=0.10;queryOptimizationTimeInMs=0.00;VMExecutionTimeInMs=32.56;indexLookupTimeInMs=0.36;documentLoadTimeInMs=9.58;systemFunctionExecuteTimeInMs=0.00;userFunctionExecuteTimeInMs=0.00;retrievedDocumentCount=2000;retrievedDocumentSize=1125600;outputDocumentCount=2000;writeOutputTimeInMs=18.10;indexUtilizationRatio=1.00
x-ms-request-charge: 604.42
x-ms-serviceversion: version=1.14.34.4
x-ms-activity-id: 0df8b5f6-83b9-4493-abda-cce6d0f91486
x-ms-session-token: 2:2008
x-ms-gatewayversion: version=1.14.33.2
Date: Tue, 27 Jun 2017 21:59:49 GMT
```

<span data-ttu-id="a9581-161">encabezados de respuesta de la tecla de Hello procedentes de la consulta de Hola Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="a9581-161">hello key response headers returned from hello query include hello following:</span></span>

| <span data-ttu-id="a9581-162">Opción</span><span class="sxs-lookup"><span data-stu-id="a9581-162">Option</span></span> | <span data-ttu-id="a9581-163">Descripción</span><span class="sxs-lookup"><span data-stu-id="a9581-163">Description</span></span> |
| ------ | ----------- |
| `x-ms-item-count` | <span data-ttu-id="a9581-164">número de Hola de elementos devueltos en la respuesta de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-164">hello number of items returned in hello response.</span></span> <span data-ttu-id="a9581-165">Esto depende en hello proporcionado `x-ms-max-item-count`, Hola número de elementos que puede ajustarse de tamaño de carga máximo de respuesta de Hola y rendimiento aprovisionado hello, tiempo de ejecución de consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-165">This is dependent on hello supplied `x-ms-max-item-count`, hello number of items that can be fit within hello maximum response payload size, hello provisioned throughput, and query execution time.</span></span> |  
| `x-ms-continuation:` | <span data-ttu-id="a9581-166">Hola continuación token tooresume la ejecución de consulta de hello, si hay resultados adicionales disponibles.</span><span class="sxs-lookup"><span data-stu-id="a9581-166">hello continuation token tooresume execution of hello query, if additional results are available.</span></span> | 
| `x-ms-documentdb-query-metrics` | <span data-ttu-id="a9581-167">estadísticas de consulta de Hello para la ejecución de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-167">hello query statistics for hello execution.</span></span> <span data-ttu-id="a9581-168">Se trata de una cadena delimitada que contiene las estadísticas de tiempo empleado en hello distintas fases de ejecución de la consulta.</span><span class="sxs-lookup"><span data-stu-id="a9581-168">This is a delimited string containing statistics of time spent in hello various phases of query execution.</span></span> <span data-ttu-id="a9581-169">Se devuelve si `x-ms-documentdb-populatequerymetrics` se establece demasiado`True`.</span><span class="sxs-lookup"><span data-stu-id="a9581-169">Returned if `x-ms-documentdb-populatequerymetrics` is set too`True`.</span></span> | 
| `x-ms-request-charge` | <span data-ttu-id="a9581-170">Hola número de [unidades de solicitud](request-units.md) utilizados por consulta Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-170">hello number of [request units](request-units.md) consumed by hello query.</span></span> | 

<span data-ttu-id="a9581-171">Para obtener más información sobre encabezados de solicitud de API de REST de Hola y opciones, consulte [consultar recursos usando la API de REST de documentos de hello](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span><span class="sxs-lookup"><span data-stu-id="a9581-171">For details on hello REST API request headers and options, see [Querying resources using hello DocumentDB REST API](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span></span>

## <a name="best-practices-for-query-performance"></a><span data-ttu-id="a9581-172">Procedimientos recomendados para el rendimiento de consultas</span><span class="sxs-lookup"><span data-stu-id="a9581-172">Best practices for query performance</span></span>
<span data-ttu-id="a9581-173">siguiente Hola es factores más comunes de Hola que afectan al rendimiento de la consulta de base de datos de Azure Cosmos.</span><span class="sxs-lookup"><span data-stu-id="a9581-173">hello following are hello most common factors that impact Azure Cosmos DB query performance.</span></span> <span data-ttu-id="a9581-174">Cada uno de estos temas se tratará con mayor detalle en este artículo.</span><span class="sxs-lookup"><span data-stu-id="a9581-174">We dig deeper into each of these topics in this article.</span></span>

| <span data-ttu-id="a9581-175">Factor</span><span class="sxs-lookup"><span data-stu-id="a9581-175">Factor</span></span> | <span data-ttu-id="a9581-176">Sugerencia</span><span class="sxs-lookup"><span data-stu-id="a9581-176">Tip</span></span> | 
| ------ | -----| 
| <span data-ttu-id="a9581-177">Rendimiento aprovisionado</span><span class="sxs-lookup"><span data-stu-id="a9581-177">Provisioned throughput</span></span> | <span data-ttu-id="a9581-178">Medir RU por cada consulta y asegúrese de que tiene rendimiento aprovisionado de hello necesarios para las consultas.</span><span class="sxs-lookup"><span data-stu-id="a9581-178">Measure RU per query, and ensure that you have hello required provisioned throughput for your queries.</span></span> | 
| <span data-ttu-id="a9581-179">Creación de particiones y claves de partición</span><span class="sxs-lookup"><span data-stu-id="a9581-179">Partitioning and partition keys</span></span> | <span data-ttu-id="a9581-180">Dé prioridad a las consultas con el valor de clave de partición de Hola de cláusula de filtro de Hola de baja latencia.</span><span class="sxs-lookup"><span data-stu-id="a9581-180">Favor queries with hello partition key value in hello filter clause for low latency.</span></span> |
| <span data-ttu-id="a9581-181">SDK y opciones de consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-181">SDK and query options</span></span> | <span data-ttu-id="a9581-182">Siga los procedimientos recomendados del SDK, como las opciones de conectividad directa y optimización de la ejecución de consultas de cliente.</span><span class="sxs-lookup"><span data-stu-id="a9581-182">Follow SDK best practices like direct connectivity, and tune client-side query execution options.</span></span> |
| <span data-ttu-id="a9581-183">Latencia de red</span><span class="sxs-lookup"><span data-stu-id="a9581-183">Network latency</span></span> | <span data-ttu-id="a9581-184">Cuenta de red sobrecarga en la medida y usar tooread hospedaje múltiple de las API de hello más cercano de la región.</span><span class="sxs-lookup"><span data-stu-id="a9581-184">Account for network overhead in measurement, and use multi-homing APIs tooread from hello nearest region.</span></span> |
| <span data-ttu-id="a9581-185">Directiva de indexación</span><span class="sxs-lookup"><span data-stu-id="a9581-185">Indexing Policy</span></span> | <span data-ttu-id="a9581-186">Asegúrese de que tiene Hola requiere rutas de acceso/directiva de indexación de consulta de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-186">Ensure that you have hello required indexing paths/policy for hello query.</span></span> |
| <span data-ttu-id="a9581-187">Métricas de ejecución de consultas</span><span class="sxs-lookup"><span data-stu-id="a9581-187">Query execution metrics</span></span> | <span data-ttu-id="a9581-188">Analizar Hola consulta ejecución métricas tooidentify posibles de escribir de nuevo las formas de consulta y los datos.</span><span class="sxs-lookup"><span data-stu-id="a9581-188">Analyze hello query execution metrics tooidentify potential rewrites of query and data shapes.</span></span>  |

### <a name="provisioned-throughput"></a><span data-ttu-id="a9581-189">Rendimiento aprovisionado</span><span class="sxs-lookup"><span data-stu-id="a9581-189">Provisioned throughput</span></span>
<span data-ttu-id="a9581-190">En Cosmos DB, se crean contenedores de datos, cada uno con un rendimiento reservado expresado en unidades de solicitud (RU) por segundo.</span><span class="sxs-lookup"><span data-stu-id="a9581-190">In Cosmos DB, you create containers of data, each with reserved throughput expressed in request units (RU) per-second.</span></span> <span data-ttu-id="a9581-191">Una lectura de un documento de 1 KB es 1 RU y cada operación (incluidas las consultas) está normalizado tooa número fijo de RUs basándose en su complejidad.</span><span class="sxs-lookup"><span data-stu-id="a9581-191">A read of a 1-KB document is 1 RU, and every operation (including queries) is normalized tooa fixed number of RUs based on its complexity.</span></span> <span data-ttu-id="a9581-192">Por ejemplo, si tiene 1000 RU/s aprovisionadas en su contenedor y tiene una consulta como `SELECT * FROM c WHERE c.city = 'Seattle'` que consume 5 RU, puede realizar entonces (1000 RU/s)/(5 RU/consulta) = 200 consultas/s de estas por segundo.</span><span class="sxs-lookup"><span data-stu-id="a9581-192">For example, if you have 1000 RU/s provisioned for your container, and you have a query like `SELECT * FROM c WHERE c.city = 'Seattle'` that consumes 5 RUs, then you can perform (1000 RU/s) / (5 RU/query) = 200 query/s such queries per second.</span></span> 

<span data-ttu-id="a9581-193">Si envía más de 200 consultas/s, servicio de hello inicia solicitudes entrantes de limitación de velocidad por encima de 200/s.</span><span class="sxs-lookup"><span data-stu-id="a9581-193">If you submit more than 200 queries/sec, hello service starts rate-limiting incoming requests above 200/s.</span></span> <span data-ttu-id="a9581-194">Hola SDK automáticamente controlar este caso mediante la realización de un reintento de retroceso, por lo tanto, podría observar una latencia mayor para estas consultas.</span><span class="sxs-lookup"><span data-stu-id="a9581-194">hello SDKs automatically handle this case by performing a backoff/retry, therefore you might notice a higher latency for these queries.</span></span> <span data-ttu-id="a9581-195">Aumentar Hola aprovisionado rendimiento toohello requiere valor mejora la latencia de las consultas y el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a9581-195">Increasing hello provisioned throughput toohello required value improves your query latency and throughput.</span></span> 

<span data-ttu-id="a9581-196">toolearn más acerca de las unidades de solicitud, vea [unidades de solicitud](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-196">toolearn more about request units, see [Request units](request-units.md).</span></span>

### <a name="partitioning-and-partition-keys"></a><span data-ttu-id="a9581-197">Creación de particiones y claves de partición</span><span class="sxs-lookup"><span data-stu-id="a9581-197">Partitioning and partition keys</span></span>
<span data-ttu-id="a9581-198">Con la base de datos de Azure Cosmos, por lo general las consultas realizan en hello siguiendo el orden de más rápido y más eficiente tooslower/menos eficaz.</span><span class="sxs-lookup"><span data-stu-id="a9581-198">With Azure Cosmos DB, typically queries perform in hello following order from fastest/most efficient tooslower/less efficient.</span></span> 

* <span data-ttu-id="a9581-199">GET en una única clave de partición y una clave de elemento</span><span class="sxs-lookup"><span data-stu-id="a9581-199">GET on a single partition key and item key</span></span>
* <span data-ttu-id="a9581-200">Consulta con una cláusula de filtro en una única clave de partición</span><span class="sxs-lookup"><span data-stu-id="a9581-200">Query with a filter clause on a single partition key</span></span>
* <span data-ttu-id="a9581-201">Consulta sin una cláusula de filtro de igualdad o intervalo en cualquier propiedad</span><span class="sxs-lookup"><span data-stu-id="a9581-201">Query without an equality or range filter clause on any property</span></span>
* <span data-ttu-id="a9581-202">Sin filtros de consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-202">Query without filters</span></span>

<span data-ttu-id="a9581-203">Las consultas que tooconsult necesidad de todas las particiones necesidad de una latencia mayor y puede consumir RUs superior.</span><span class="sxs-lookup"><span data-stu-id="a9581-203">Queries that need tooconsult all partitions need higher latency, and can consume higher RUs.</span></span> <span data-ttu-id="a9581-204">Puesto que cada partición tiene la indexación automática en todas las propiedades, consultas de hello pueden proporcionarse eficazmente desde el índice de hello en este caso.</span><span class="sxs-lookup"><span data-stu-id="a9581-204">Since each partition has automatic indexing against all properties, hello query can be served efficiently from hello index in this case.</span></span> <span data-ttu-id="a9581-205">Puede hacer que las consultas que abarcan las particiones más rápidas con las opciones de paralelismo de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-205">You can make queries that span partitions faster by using hello parallelism options.</span></span>

<span data-ttu-id="a9581-206">toolearn más información sobre la creación de particiones y las claves de partición, vea [particiones en la base de datos de Azure Cosmos](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-206">toolearn more about partitioning and partition keys, see [Partitioning in Azure Cosmos DB](partition-data.md).</span></span>

### <a name="sdk-and-query-options"></a><span data-ttu-id="a9581-207">SDK y opciones de consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-207">SDK and query options</span></span>
<span data-ttu-id="a9581-208">Vea [sugerencias de rendimiento](performance-tips.md) y [las pruebas de rendimiento](performance-testing.md) para cómo tooget Hola mejor rendimiento de cliente de base de datos de Azure Cosmos.</span><span class="sxs-lookup"><span data-stu-id="a9581-208">See [Performance Tips](performance-tips.md) and [Performance testing](performance-testing.md) for how tooget hello best client-side performance from Azure Cosmos DB.</span></span> <span data-ttu-id="a9581-209">Esto incluye el uso de Hola SDK más reciente, configurar las configuraciones específicas de la plataforma como número predeterminado de conexiones, frecuencia de recolección de elementos y con opciones de conectividad ligera como Direct/TCP.</span><span class="sxs-lookup"><span data-stu-id="a9581-209">This includes using hello latest SDKs, configuring platform-specific configurations like default number of connections, frequency of garbage collection, and using lightweight connectivity options like Direct/TCP.</span></span> 


#### <a name="max-item-count"></a><span data-ttu-id="a9581-210">Recuento máximo de elementos</span><span class="sxs-lookup"><span data-stu-id="a9581-210">Max Item Count</span></span>
<span data-ttu-id="a9581-211">Para las consultas, Hola valo `MaxItemCount` puede tener un impacto significativo en el momento de la consulta to-end.</span><span class="sxs-lookup"><span data-stu-id="a9581-211">For queries, hello value of `MaxItemCount` can have a significant impact on end-to-end query time.</span></span> <span data-ttu-id="a9581-212">Cada acción de ida y devolverá no más de número de Hola de elementos de servidor toohello `MaxItemCount` (valor predeterminado de 100 elementos).</span><span class="sxs-lookup"><span data-stu-id="a9581-212">Each round trip toohello server will return no more than hello number of items in `MaxItemCount` (Default of 100 items).</span></span> <span data-ttu-id="a9581-213">Al establecer este valor más alto de tooa (-1 es máximos y recomendados) mejorará la duración de consulta general limitando el número de Hola de ida y vuelta entre el servidor y cliente, especialmente para las consultas con grandes conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="a9581-213">Setting this tooa higher value (-1 is maximum, and recommended) will improve your query duration overall by limiting hello number of round trips between server and client, especially for queries with large result sets.</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxItemCount = -1, 
    }).AsDocumentQuery();
```

#### <a name="max-degree-of-parallelism"></a><span data-ttu-id="a9581-214">Grado máximo de paralelismo</span><span class="sxs-lookup"><span data-stu-id="a9581-214">Max Degree of Parallelism</span></span>
<span data-ttu-id="a9581-215">Para las consultas, optimizar hello `MaxDegreeOfParallelism` tooidentify configuraciones de mejores hello para la aplicación, especialmente si lleva a cabo las consultas entre particiones (sin un filtro en el valor de clave de partición de hello).</span><span class="sxs-lookup"><span data-stu-id="a9581-215">For queries, tune hello `MaxDegreeOfParallelism` tooidentify hello best configurations for your application, especially if you perform cross-partition queries (without a filter on hello partition-key value).</span></span> <span data-ttu-id="a9581-216">`MaxDegreeOfParallelism`controla Hola número máximo de tareas en paralelo, es decir, máximo hello toobe particiones visitado en paralelo.</span><span class="sxs-lookup"><span data-stu-id="a9581-216">`MaxDegreeOfParallelism`  controls hello maximum number of parallel tasks, i.e., hello maximum of partitions toobe visited in parallel.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();
```

<span data-ttu-id="a9581-217">Supongamos que</span><span class="sxs-lookup"><span data-stu-id="a9581-217">Let’s assume that</span></span>
* <span data-ttu-id="a9581-218">D. = número máximo predeterminado de tareas en paralelo (= número total de procesador en el equipo de cliente hello)</span><span class="sxs-lookup"><span data-stu-id="a9581-218">D = Default Maximum number of parallel tasks (= total number of processor in hello client machine)</span></span>
* <span data-ttu-id="a9581-219">P = número máximo especificado por el usuario de tareas en paralelo</span><span class="sxs-lookup"><span data-stu-id="a9581-219">P = User-specified maximum number of parallel tasks</span></span>
* <span data-ttu-id="a9581-220">N = número de particiones que necesita toobe visitado para responder a una consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-220">N = Number of partitions that needs  toobe visited for answering a query</span></span>

<span data-ttu-id="a9581-221">Son las siguientes implicaciones de cómo las consultas en paralelo Hola comportaría para los distintos valores de P.</span><span class="sxs-lookup"><span data-stu-id="a9581-221">Following are implications of how hello parallel queries would behave for different values of P.</span></span>
* <span data-ttu-id="a9581-222">(P == 0) => modo serie</span><span class="sxs-lookup"><span data-stu-id="a9581-222">(P == 0) => Serial Mode</span></span>
* <span data-ttu-id="a9581-223">(P == 1) => un máximo de una tarea</span><span class="sxs-lookup"><span data-stu-id="a9581-223">(P == 1) => Maximum of one task</span></span>
* <span data-ttu-id="a9581-224">(P > 1) => mínimo de tareas en paralelo (P, N)</span><span class="sxs-lookup"><span data-stu-id="a9581-224">(P > 1) => Min (P, N) parallel tasks</span></span> 
* <span data-ttu-id="a9581-225">(P < 1) => mínimo de tareas en paralelo (N, D)</span><span class="sxs-lookup"><span data-stu-id="a9581-225">(P < 1) => Min (N, D) parallel tasks</span></span>

<span data-ttu-id="a9581-226">Para acceder a notas de versión de SDK y conocer detalles sobre las clases y los métodos implementados, consulte [SDK de DocumentDB](documentdb-sdk-dotnet.md)</span><span class="sxs-lookup"><span data-stu-id="a9581-226">For SDK release notes, and details on implemented classes and methods see [DocumentDB SDKs](documentdb-sdk-dotnet.md)</span></span>

### <a name="network-latency"></a><span data-ttu-id="a9581-227">Latencia de red</span><span class="sxs-lookup"><span data-stu-id="a9581-227">Network latency</span></span>
<span data-ttu-id="a9581-228">Vea [distribución global de base de datos de Azure Cosmos](tutorial-global-distribution-documentdb.md) acerca de cómo tooset una copia de seguridad distribución global y conectar la región más cercana de toohello.</span><span class="sxs-lookup"><span data-stu-id="a9581-228">See [Azure Cosmos DB global distribution](tutorial-global-distribution-documentdb.md) for how tooset up global distribution, and connect toohello closest region.</span></span> <span data-ttu-id="a9581-229">Latencia de red tiene un impacto significativo en el rendimiento de las consultas cuando necesite toomake varios ida y vuelta o recuperar un gran conjunto de resultados de consulta de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-229">Network latency has a significant impact on query performance when you need toomake multiple round-trips or retrieve a large result set from hello query.</span></span> 

<span data-ttu-id="a9581-230">Hello sección en métricas de ejecución de consulta explica cómo tooretrieve Hola servidor tiempo de ejecución de consultas ( `totalExecutionTimeInMs`), de modo que puede diferenciar entre el tiempo invertido en la ejecución de la consulta y el tiempo empleado en tránsito de la red.</span><span class="sxs-lookup"><span data-stu-id="a9581-230">hello section on query execution metrics explains how tooretrieve hello server execution time of queries ( `totalExecutionTimeInMs`), so that you can differentiate between time spent in query execution and time spent in network transit.</span></span>

### <a name="indexing-policy"></a><span data-ttu-id="a9581-231">Directiva de indexación</span><span class="sxs-lookup"><span data-stu-id="a9581-231">Indexing policy</span></span>
<span data-ttu-id="a9581-232">Para información sobre las rutas de indexación, las clases y los modos y cómo afectan a la ejecución de consultas, consulte [Configuración de la directiva de indexación](indexing-policies.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-232">See [Configuring indexing policy](indexing-policies.md) for indexing paths, kinds, and modes, and how they impact query execution.</span></span> <span data-ttu-id="a9581-233">De forma predeterminada, directiva de indexación de hello utiliza indización de Hash para las cadenas, que es efectivo para las consultas de igualdad, pero no para las consultas de intervalo/order por las consultas.</span><span class="sxs-lookup"><span data-stu-id="a9581-233">By default, hello indexing policy uses Hash indexing for strings, which is effective for equality queries, but not for range queries/order by queries.</span></span> <span data-ttu-id="a9581-234">Si tiene consultas por rango para las cadenas, se recomienda especificar tipo de índice de intervalo para todas las cadenas de Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-234">If you need range queries for strings, we recommend specifying hello Range index type for all strings.</span></span> 

## <a name="query-execution-metrics"></a><span data-ttu-id="a9581-235">Métricas de ejecución de consultas</span><span class="sxs-lookup"><span data-stu-id="a9581-235">Query execution metrics</span></span>
<span data-ttu-id="a9581-236">Puede obtener métricas detalladas en ejecución de la consulta pasando Hola opcional `x-ms-documentdb-populatequerymetrics` encabezado (`FeedOptions.PopulateQueryMetrics` Hola .NET SDK).</span><span class="sxs-lookup"><span data-stu-id="a9581-236">You can obtain detailed metrics on query execution by passing in hello optional `x-ms-documentdb-populatequerymetrics` header (`FeedOptions.PopulateQueryMetrics` in hello .NET SDK).</span></span> <span data-ttu-id="a9581-237">Hola de valor devuelto en `x-ms-documentdb-query-metrics` tiene Hola siguientes pares de clave-valor dirigidas a los de solución de problemas de ejecución de consulta avanzada.</span><span class="sxs-lookup"><span data-stu-id="a9581-237">hello value returned in `x-ms-documentdb-query-metrics` has hello following key-value pairs meant for advanced troubleshooting of query execution.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();

// Returns metrics by partition key range Id
IReadOnlyDictionary<string, QueryMetrics> metrics = result.QueryMetrics;

```

| <span data-ttu-id="a9581-238">Métrica</span><span class="sxs-lookup"><span data-stu-id="a9581-238">Metric</span></span> | <span data-ttu-id="a9581-239">Unidad</span><span class="sxs-lookup"><span data-stu-id="a9581-239">Unit</span></span> | <span data-ttu-id="a9581-240">Descripción</span><span class="sxs-lookup"><span data-stu-id="a9581-240">Description</span></span> | 
| ------ | -----| ----------- |
| `totalExecutionTimeInMs` | <span data-ttu-id="a9581-241">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-241">milliseconds</span></span> | <span data-ttu-id="a9581-242">Tiempo de ejecución de consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-242">Query execution time</span></span> | 
| `queryCompileTimeInMs` | <span data-ttu-id="a9581-243">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-243">milliseconds</span></span> | <span data-ttu-id="a9581-244">Tiempo de compilación de consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-244">Query compile time</span></span>  | 
| `queryLogicalPlanBuildTimeInMs` | <span data-ttu-id="a9581-245">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-245">milliseconds</span></span> | <span data-ttu-id="a9581-246">Plan de consulta lógica toobuild de tiempo</span><span class="sxs-lookup"><span data-stu-id="a9581-246">Time toobuild logical query plan</span></span> | 
| `queryPhysicalPlanBuildTimeInMs` | <span data-ttu-id="a9581-247">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-247">milliseconds</span></span> | <span data-ttu-id="a9581-248">Plan de consulta físico de toobuild de tiempo</span><span class="sxs-lookup"><span data-stu-id="a9581-248">Time toobuild physical query plan</span></span> | 
| `queryOptimizationTimeInMs` | <span data-ttu-id="a9581-249">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-249">milliseconds</span></span> | <span data-ttu-id="a9581-250">Tiempo invertido en optimizar la consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-250">Time spent in optimizing query</span></span> | 
| `VMExecutionTimeInMs` | <span data-ttu-id="a9581-251">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-251">milliseconds</span></span> | <span data-ttu-id="a9581-252">Tiempo invertido en el tiempo de ejecución de consulta</span><span class="sxs-lookup"><span data-stu-id="a9581-252">Time spent in query runtime</span></span> | 
| `indexLookupTimeInMs` | <span data-ttu-id="a9581-253">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-253">milliseconds</span></span> | <span data-ttu-id="a9581-254">Tiempo invertido en la capa física de índice</span><span class="sxs-lookup"><span data-stu-id="a9581-254">Time spent in physical index layer</span></span> | 
| `documentLoadTimeInMs` | <span data-ttu-id="a9581-255">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-255">milliseconds</span></span> | <span data-ttu-id="a9581-256">Tiempo invertido en la carga de documentos</span><span class="sxs-lookup"><span data-stu-id="a9581-256">Time spent in loading documents</span></span>  | 
| `systemFunctionExecuteTimeInMs` | <span data-ttu-id="a9581-257">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-257">milliseconds</span></span> | <span data-ttu-id="a9581-258">Tiempo total invertido en ejecutar funciones del sistema (integradas), en milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-258">Total time spent executing system (built-in) functions in milliseconds</span></span>  | 
| `userFunctionExecuteTimeInMs` | <span data-ttu-id="a9581-259">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-259">milliseconds</span></span> | <span data-ttu-id="a9581-260">Tiempo total invertido en ejecutar funciones definidas por el usuario, en milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-260">Total time spent executing user-defined functions in milliseconds</span></span> | 
| `retrievedDocumentCount` | <span data-ttu-id="a9581-261">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-261">milliseconds</span></span> | <span data-ttu-id="a9581-262">Número total de documentos recuperados</span><span class="sxs-lookup"><span data-stu-id="a9581-262">Total number of retrieved documents</span></span>  | 
| `retrievedDocumentSize` | <span data-ttu-id="a9581-263">bytes</span><span class="sxs-lookup"><span data-stu-id="a9581-263">bytes</span></span> | <span data-ttu-id="a9581-264">Tamaño total de los documentos recuperados, en bytes</span><span class="sxs-lookup"><span data-stu-id="a9581-264">Total size of retrieved documents in bytes</span></span>  | 
| `outputDocumentCount` | <span data-ttu-id="a9581-265">count</span><span class="sxs-lookup"><span data-stu-id="a9581-265">count</span></span> | <span data-ttu-id="a9581-266">Número de documentos de salida</span><span class="sxs-lookup"><span data-stu-id="a9581-266">Number of output documents</span></span> | 
| `writeOutputTimeInMs` | <span data-ttu-id="a9581-267">milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-267">milliseconds</span></span> | <span data-ttu-id="a9581-268">Tiempo de ejecución de consultas, en milisegundos</span><span class="sxs-lookup"><span data-stu-id="a9581-268">Query execution time in milliseconds</span></span> | 
| `indexUtilizationRatio` | <span data-ttu-id="a9581-269">relación (<= 1)</span><span class="sxs-lookup"><span data-stu-id="a9581-269">ratio (<=1)</span></span> | <span data-ttu-id="a9581-270">Proporción del número de documentos que coincide con el número de toohello de filtro de Hola de documentos cargados</span><span class="sxs-lookup"><span data-stu-id="a9581-270">Ratio of number of documents matched by hello filter toohello number of documents loaded</span></span>  | 

<span data-ttu-id="a9581-271">Hello cliente SDK puede internamente realizar varias operaciones tooserve Hola consulta dentro de cada partición.</span><span class="sxs-lookup"><span data-stu-id="a9581-271">hello client SDKs may internally make multiple query operations tooserve hello query within each partition.</span></span> <span data-ttu-id="a9581-272">cliente de Hello realiza más de una llamada por partición si superan los resultados totales de hello `x-ms-max-item-count`si consulta Hola supera el rendimiento aprovisionado de hello para la partición de hello, o si hello carga de consulta alcanza el tamaño máximo de Hola por página, o si hello consulta alcanza Hola sistema asignado el límite de tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="a9581-272">hello client makes more than one call per-partition if hello total results exceed `x-ms-max-item-count`, if hello query exceeds hello provisioned throughput for hello partition, or if hello query payload reaches hello maximum size per page, or if hello query reaches hello system allocated timeout limit.</span></span> <span data-ttu-id="a9581-273">Cada ejecución de consultas parcial devuelve un valor `x-ms-documentdb-query-metrics` para esa página.</span><span class="sxs-lookup"><span data-stu-id="a9581-273">Each partial query execution returns a `x-ms-documentdb-query-metrics` for that page.</span></span> 

<span data-ttu-id="a9581-274">Estas son algunas consultas de ejemplo y cómo toointerpret algunas de las métricas de hello proceden de la ejecución de la consulta:</span><span class="sxs-lookup"><span data-stu-id="a9581-274">Here are some sample queries, and how toointerpret some of hello metrics returned from query execution:</span></span> 

| <span data-ttu-id="a9581-275">Consultar</span><span class="sxs-lookup"><span data-stu-id="a9581-275">Query</span></span> | <span data-ttu-id="a9581-276">Métrica de ejemplo</span><span class="sxs-lookup"><span data-stu-id="a9581-276">Sample Metric</span></span> | <span data-ttu-id="a9581-277">Descripción</span><span class="sxs-lookup"><span data-stu-id="a9581-277">Description</span></span> | 
| ------ | -----| ----------- |
| `SELECT TOP 100 * FROM c` | `"RetrievedDocumentCount": 101` | <span data-ttu-id="a9581-278">Hola número de documentos directamente recuperados es 100 + 1 cláusula TOP de toomatch Hola.</span><span class="sxs-lookup"><span data-stu-id="a9581-278">hello number of documents retrieved is 100+1 toomatch hello TOP clause.</span></span> <span data-ttu-id="a9581-279">El tiempo de la consulta se invierte mayormente en `WriteOutputTime` y `DocumentLoadTime` dado que es un examen.</span><span class="sxs-lookup"><span data-stu-id="a9581-279">Query time is mostly spent in `WriteOutputTime` and `DocumentLoadTime` since it is a scan.</span></span> | 
| `SELECT TOP 500 * FROM c` | `"RetrievedDocumentCount": 501` | <span data-ttu-id="a9581-280">RetrievedDocumentCount es ahora mayor (500 + 1 toomatch Hola cláusula TOP).</span><span class="sxs-lookup"><span data-stu-id="a9581-280">RetrievedDocumentCount is now higher (500+1 toomatch hello TOP clause).</span></span> | 
| `SELECT * FROM c WHERE c.N = 55` | `"IndexLookupTime": "00:00:00.0009500"` | <span data-ttu-id="a9581-281">0,9 ms se invierten en IndexLookupTime en una búsqueda de claves, porque es una búsqueda de índice en `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="a9581-281">About 0.9 ms is spent in IndexLookupTime for a key lookup, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT * FROM c WHERE c.N > 55` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="a9581-282">Un poco más de tiempo (1,7 ms) se invierte en IndexLookupTime durante un examen de intervalo, porque es una búsqueda de índice en `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="a9581-282">Slightly more time (1.7 ms) spent in IndexLookupTime over a range scan, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT TOP 500 c.N FROM c` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="a9581-283">El mismo tiempo se invierte en `DocumentLoadTime` que en las consultas anteriores, pero menos `WriteOutputTime` porque solo se proyecta una propiedad.</span><span class="sxs-lookup"><span data-stu-id="a9581-283">Same time spent on `DocumentLoadTime` as previous queries, but lower `WriteOutputTime` because we're projecting only one property.</span></span> | 
| `SELECT TOP 500 udf.toPercent(c.N) FROM c` | `"UserDefinedFunctionExecutionTime": "00:00:00.2136500"` | <span data-ttu-id="a9581-284">Se dedica unos 213 ms `UserDefinedFunctionExecutionTime` ejecutar Hola UDF en cada valor de `c.N`.</span><span class="sxs-lookup"><span data-stu-id="a9581-284">About 213 ms is spent in `UserDefinedFunctionExecutionTime` executing hello UDF on each value of `c.N`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(c.Name, 'Den')` | `"IndexLookupTime": "00:00:00.0006400", "SystemFunctionExecutionTime": "00:00:00.0074100"` | <span data-ttu-id="a9581-285">Aproximadamente 0,6 ms se invierten en `IndexLookupTime` en `/Name/?`.</span><span class="sxs-lookup"><span data-stu-id="a9581-285">About 0.6 ms is spent in `IndexLookupTime` on `/Name/?`.</span></span> <span data-ttu-id="a9581-286">La mayoría de hello consulta el tiempo de ejecución (ms ~ 7) en `SystemFunctionExecutionTime`.</span><span class="sxs-lookup"><span data-stu-id="a9581-286">Most of hello query execution time (~7 ms) in `SystemFunctionExecutionTime`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(LOWER(c.Name), 'den')` | `"IndexLookupTime": "00:00:00", "RetrievedDocumentCount": 2491,  "OutputDocumentCount": 500` | <span data-ttu-id="a9581-287">La consulta se realiza como un examen porque se emplea `LOWER`, y se devuelven 500 de los 2491 documentos recuperados.</span><span class="sxs-lookup"><span data-stu-id="a9581-287">Query is performed as a scan because it uses `LOWER`, and 500 out of 2491 retrieved documents are returned.</span></span> |


## <a name="next-steps"></a><span data-ttu-id="a9581-288">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="a9581-288">Next steps</span></span>
* <span data-ttu-id="a9581-289">toolearn sobre Hola admite operadores de consulta SQL y las palabras clave, consulte [consulta SQL](documentdb-sql-query.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-289">toolearn about hello supported SQL query operators and keywords, see [SQL query](documentdb-sql-query.md).</span></span> 
* <span data-ttu-id="a9581-290">toolearn acerca de las unidades de solicitud, vea [unidades de solicitud](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="a9581-290">toolearn about request units, see [request units](request-units.md).</span></span>
* <span data-ttu-id="a9581-291">toolearn sobre la directiva de indización, consulte [directiva de indexación](indexing-policies.md)</span><span class="sxs-lookup"><span data-stu-id="a9581-291">toolearn about indexing policy, see [indexing policy](indexing-policies.md)</span></span> 


