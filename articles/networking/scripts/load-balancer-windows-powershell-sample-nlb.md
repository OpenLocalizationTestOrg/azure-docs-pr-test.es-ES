---
title: "Ejemplo de Script de PowerShell - tooVMs de tráfico de equilibrio de carga para lograr alta disponibilidad aaaAzure | Documentos de Microsoft"
description: "Ejemplo de Script de PowerShell Azure - tooVMs de tráfico de equilibrio de carga para lograr alta disponibilidad"
services: load-balancer
documentationcenter: load-balancer
author: georgewallace
manager: timlt
editor: tysonn
tags: 
ms.assetid: 
ms.service: load-balancer
ms.devlang: powershell
ms.topic: article
ms.tgt_pltfrm: 
ms.workload: infrastructure
ms.date: 05/16/2017
ms.author: gwallace
ms.openlocfilehash: 332c39e1aad071ca6f7ce420ccc1f423ef647d2d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="load-balance-traffic-toovms-for-high-availability"></a><span data-ttu-id="06ade-103">Cargar tooVMs de tráfico de equilibrio de alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="06ade-103">Load balance traffic tooVMs for high availability</span></span>

<span data-ttu-id="06ade-104">Este ejemplo de secuencia de comandos crea todo lo necesario toorun varias máquinas virtuales de Windows configurado en una alta disponibilidad y de carga equilibrada de configuración.</span><span class="sxs-lookup"><span data-stu-id="06ade-104">This script sample creates everything needed toorun several Windows virtual machines configured in a highly available and load balanced configuration.</span></span> <span data-ttu-id="06ade-105">Después de ejecutar script de Hola, tendrá tres máquinas virtuales, tooan Unidos a un conjunto de disponibilidad de Azure y es accesible a través de un equilibrador de carga de Azure.</span><span class="sxs-lookup"><span data-stu-id="06ade-105">After running hello script, you will have three virtual machines, joined tooan Azure Availability Set, and accessible through an Azure Load Balancer.</span></span>

<span data-ttu-id="06ade-106">Si es necesario, instale hello Azure PowerShell con hello instrucción se encuentra en hello [Guía de Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/)y, a continuación, ejecute `Login-AzureRmAccount` toocreate una conexión con Azure.</span><span class="sxs-lookup"><span data-stu-id="06ade-106">If needed, install hello Azure PowerShell using hello instruction found in hello [Azure PowerShell guide](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/), and then run `Login-AzureRmAccount` toocreate a connection with Azure.</span></span>

[!INCLUDE [quickstarts-free-trial-note](../../../includes/quickstarts-free-trial-note.md)]

## <a name="sample-script"></a><span data-ttu-id="06ade-107">Script de ejemplo</span><span class="sxs-lookup"><span data-stu-id="06ade-107">Sample script</span></span>

[!code-powershell[main](../../../powershell_scripts/virtual-machine/create-vm-nlb/create-vm-nlb.ps1 "Quick Create VM")]

## <a name="clean-up-deployment"></a><span data-ttu-id="06ade-108">Limpieza de la implementación</span><span class="sxs-lookup"><span data-stu-id="06ade-108">Clean up deployment</span></span> 

<span data-ttu-id="06ade-109">Ejecute hello después el grupo de recursos de comando tooremove hello, la VM y todos ellos relacionados con recursos.</span><span class="sxs-lookup"><span data-stu-id="06ade-109">Run hello following command tooremove hello resource group, VM, and all related resources.</span></span>

```powershell
Remove-AzureRmResourceGroup -Name myResourceGroup
```

## <a name="script-explanation"></a><span data-ttu-id="06ade-110">Explicación del script</span><span class="sxs-lookup"><span data-stu-id="06ade-110">Script explanation</span></span>

<span data-ttu-id="06ade-111">Este script utiliza Hola después comandos toocreate un grupo de recursos, máquina virtual, conjunto de disponibilidad, equilibrador de carga y todos los recursos relacionados.</span><span class="sxs-lookup"><span data-stu-id="06ade-111">This script uses hello following commands toocreate a resource group, virtual machine, availability set, load balancer, and all related resources.</span></span> <span data-ttu-id="06ade-112">Cada comando de documentación específica de hello tabla vínculos toocommand.</span><span class="sxs-lookup"><span data-stu-id="06ade-112">Each command in hello table links toocommand specific documentation.</span></span>

| <span data-ttu-id="06ade-113">Comando</span><span class="sxs-lookup"><span data-stu-id="06ade-113">Command</span></span> | <span data-ttu-id="06ade-114">Notas</span><span class="sxs-lookup"><span data-stu-id="06ade-114">Notes</span></span> |
|---|---|
| [<span data-ttu-id="06ade-115">New-AzureRmResourceGroup</span><span class="sxs-lookup"><span data-stu-id="06ade-115">New-AzureRmResourceGroup</span></span>](/powershell/module/azurerm.resources/new-azurermresourcegroup) | <span data-ttu-id="06ade-116">Crea un grupo de recursos en el que se almacenan todos los recursos.</span><span class="sxs-lookup"><span data-stu-id="06ade-116">Creates a resource group in which all resources are stored.</span></span> |
| [<span data-ttu-id="06ade-117">New-AzureRmVirtualNetworkSubnetConfig</span><span class="sxs-lookup"><span data-stu-id="06ade-117">New-AzureRmVirtualNetworkSubnetConfig</span></span>](/powershell/module/azurerm.network/new-azurermvirtualnetworksubnetconfig) | <span data-ttu-id="06ade-118">Crea una configuración de subred.</span><span class="sxs-lookup"><span data-stu-id="06ade-118">Creates a subnet configuration.</span></span> <span data-ttu-id="06ade-119">Esta configuración se utiliza con el proceso de creación de red virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="06ade-119">This configuration is used with hello virtual network creation process.</span></span> |
| [<span data-ttu-id="06ade-120">New-AzureRmVirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="06ade-120">New-AzureRmVirtualNetwork</span></span>](/powershell/module/azurerm.network/new-azurermvirtualnetwork) | <span data-ttu-id="06ade-121">Crea una red virtual y una subred de Azure.</span><span class="sxs-lookup"><span data-stu-id="06ade-121">Creates an Azure virtual network and subnet.</span></span> |
| [<span data-ttu-id="06ade-122">New-AzureRmPublicIpAddress</span><span class="sxs-lookup"><span data-stu-id="06ade-122">New-AzureRmPublicIpAddress</span></span>](/powershell/module/azurerm.network/new-azurermpublicipaddress)  | <span data-ttu-id="06ade-123">Crea una dirección IP pública con una dirección IP estática y un nombre DNS asociado.</span><span class="sxs-lookup"><span data-stu-id="06ade-123">Creates a public IP address with a static IP address and an associated DNS name.</span></span> |
| [<span data-ttu-id="06ade-124">New-AzureRmLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="06ade-124">New-AzureRmLoadBalancer</span></span>](/powershell/module/azurerm.network/new-azurermloadbalancer)  | <span data-ttu-id="06ade-125">Crea una instancia de Azure Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="06ade-125">Creates an Azure load balancer.</span></span> |
| [<span data-ttu-id="06ade-126">New-AzureRmLoadBalancerProbeConfig</span><span class="sxs-lookup"><span data-stu-id="06ade-126">New-AzureRmLoadBalancerProbeConfig</span></span>](/powershell/module/azurerm.network/new-azurermloadbalancerprobeconfig) | <span data-ttu-id="06ade-127">Crea un sondeo de equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="06ade-127">Creates a load balancer probe.</span></span> <span data-ttu-id="06ade-128">Un sondeo del equilibrador de carga es toomonitor usado en cada máquina virtual en el conjunto de equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="06ade-128">A load balancer probe is used toomonitor each VM in hello load balancer set.</span></span> <span data-ttu-id="06ade-129">Si ninguna máquina virtual deja de estar accesible, el tráfico no es toohello enrutado máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="06ade-129">If any VM becomes inaccessible, traffic is not routed toohello VM.</span></span> |
| [<span data-ttu-id="06ade-130">New-AzureRmLoadBalancerRuleConfig</span><span class="sxs-lookup"><span data-stu-id="06ade-130">New-AzureRmLoadBalancerRuleConfig</span></span>](/powershell/module/azurerm.network/new-azurermloadbalancerruleconfig) | <span data-ttu-id="06ade-131">Crea una regla de Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="06ade-131">Creates an load balancer rule.</span></span> <span data-ttu-id="06ade-132">En este ejemplo, se crea una regla para el puerto 80.</span><span class="sxs-lookup"><span data-stu-id="06ade-132">In this sample, a rule is created for port 80.</span></span> <span data-ttu-id="06ade-133">Como el tráfico HTTP llega al equilibrador de carga de hello, es tooport enrutado 80 una de las máquinas virtuales de hello en el conjunto de equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="06ade-133">As HTTP traffic arrives at hello load balancer, it is routed tooport 80 one of hello VMs in hello load balancer set.</span></span> |
| [<span data-ttu-id="06ade-134">New-AzureRmLoadBalancerInboundNatRuleConfig</span><span class="sxs-lookup"><span data-stu-id="06ade-134">New-AzureRmLoadBalancerInboundNatRuleConfig</span></span>](/powershell/module/azurerm.network/new-azurermloadbalancerinboundnatruleconfig) | <span data-ttu-id="06ade-135">Crea una regla de traducción de direcciones de red (NAT) de Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="06ade-135">Creates a load balancer Network Address Translation (NAT) rule.</span></span>  <span data-ttu-id="06ade-136">Las reglas NAT asignan un puerto de puerto de tooa de equilibrador de carga de hello en una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="06ade-136">NAT rules map a port of hello load balancer tooa port on a VM.</span></span> <span data-ttu-id="06ade-137">En este ejemplo, se crea una regla NAT para SSH tráfico tooeach VM en el conjunto de equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="06ade-137">In this sample, a NAT rule is created for SSH traffic tooeach VM in hello load balancer set.</span></span>  |
| [<span data-ttu-id="06ade-138">New-AzureRmNetworkSecurityGroup</span><span class="sxs-lookup"><span data-stu-id="06ade-138">New-AzureRmNetworkSecurityGroup</span></span>](/powershell/module/azurerm.network/new-azurermnetworksecuritygroup) | <span data-ttu-id="06ade-139">Crea un grupo de seguridad de red (NSG), que es un límite de seguridad entre Hola internet y hello las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="06ade-139">Creates a network security group (NSG), which is a security boundary between hello internet and hello virtual machine.</span></span> |
| [<span data-ttu-id="06ade-140">New-AzureRmNetworkSecurityRuleConfig</span><span class="sxs-lookup"><span data-stu-id="06ade-140">New-AzureRmNetworkSecurityRuleConfig</span></span>](/powershell/module/azurerm.network/new-azurermnetworksecurityruleconfig) | <span data-ttu-id="06ade-141">Crea un tooallow de regla NSG el tráfico entrante.</span><span class="sxs-lookup"><span data-stu-id="06ade-141">Creates an NSG rule tooallow inbound traffic.</span></span> <span data-ttu-id="06ade-142">En este ejemplo, el puerto 22 está abierto al tráfico SSH.</span><span class="sxs-lookup"><span data-stu-id="06ade-142">In this sample, port 22 is opened for SSH traffic.</span></span> |
| [<span data-ttu-id="06ade-143">New-AzureRmNetworkInterface</span><span class="sxs-lookup"><span data-stu-id="06ade-143">New-AzureRmNetworkInterface</span></span>](/powershell/module/azurerm.network/new-azurermnetworkinterface) | <span data-ttu-id="06ade-144">Crea una tarjeta de red virtual y lo adjunta toohello de red virtual, subred y NSG.</span><span class="sxs-lookup"><span data-stu-id="06ade-144">Creates a virtual network card and attaches it toohello virtual network, subnet, and NSG.</span></span> |
| [<span data-ttu-id="06ade-145">New-AzureRmAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="06ade-145">New-AzureRmAvailabilitySet</span></span>](/powershell/module/azurerm.compute/new-azurermavailabilityset) | <span data-ttu-id="06ade-146">Crea un conjunto de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="06ade-146">Creates an availability set.</span></span> <span data-ttu-id="06ade-147">Conjuntos de disponibilidad de garantizan la disponibilidad de las aplicaciones repartir hello las máquinas virtuales entre recursos físicos de forma que si se produce el error, no se realiza el conjunto completo de Hola.</span><span class="sxs-lookup"><span data-stu-id="06ade-147">Availability sets ensure application uptime by spreading hello virtual machines across physical resources such that if failure occurs, hello entire set is not effected.</span></span> |
| [<span data-ttu-id="06ade-148">New-AzureRmVMConfig</span><span class="sxs-lookup"><span data-stu-id="06ade-148">New-AzureRmVMConfig</span></span>](/powershell/module/azurerm.compute/new-azurermvmconfig) | <span data-ttu-id="06ade-149">Crea una configuración de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="06ade-149">Creates a VM configuration.</span></span> <span data-ttu-id="06ade-150">Esta configuración incluye diversa información, como el nombre de la máquina virtual, sistema el operativo y las credenciales administrativas.</span><span class="sxs-lookup"><span data-stu-id="06ade-150">This configuration includes information such as VM name, operating system, and administrative credentials.</span></span> <span data-ttu-id="06ade-151">configuración de Hola se utiliza durante la creación de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="06ade-151">hello configuration is used during VM creation.</span></span> |
| [<span data-ttu-id="06ade-152">New-AzureRmVM</span><span class="sxs-lookup"><span data-stu-id="06ade-152">New-AzureRmVM</span></span>](/powershell/module/azurerm.compute/new-azurermvm)  | <span data-ttu-id="06ade-153">Crea la máquina virtual de Hola y lo conecta toohello tarjeta de red, red virtual, subred y NSG.</span><span class="sxs-lookup"><span data-stu-id="06ade-153">Creates hello virtual machine and connects it toohello network card, virtual network, subnet, and NSG.</span></span> <span data-ttu-id="06ade-154">Este comando también especifica toobe de imagen de máquina virtual de hello usa y credenciales administrativas.</span><span class="sxs-lookup"><span data-stu-id="06ade-154">This command also specifies hello virtual machine image toobe used and administrative credentials.</span></span>  |
| [<span data-ttu-id="06ade-155">Remove-AzureRmResourceGroup</span><span class="sxs-lookup"><span data-stu-id="06ade-155">Remove-AzureRmResourceGroup</span></span>](/powershell/module/azurerm.resources/remove-azurermresourcegroup) | <span data-ttu-id="06ade-156">Elimina un grupo de recursos, incluidos todos los recursos anidados.</span><span class="sxs-lookup"><span data-stu-id="06ade-156">Deletes a resource group including all nested resources.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="06ade-157">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="06ade-157">Next steps</span></span>

<span data-ttu-id="06ade-158">Para obtener más información sobre hello Azure PowerShell, consulte [documentación de Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="06ade-158">For more information on hello Azure PowerShell, see [Azure PowerShell documentation](https://docs.microsoft.com/powershell/azure/overview).</span></span>

<span data-ttu-id="06ade-159">Encontrará ejemplos de script de PowerShell de red adicionales en hello [documentación de introducción a las redes Azure](../powershell-samples.md?toc=%2fazure%2fnetworking%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="06ade-159">Additional networking PowerShell script samples can be found in hello [Azure Networking Overview documentation](../powershell-samples.md?toc=%2fazure%2fnetworking%2ftoc.json).</span></span>
