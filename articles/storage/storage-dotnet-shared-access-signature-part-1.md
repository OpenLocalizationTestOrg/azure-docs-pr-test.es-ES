---
title: aaaUsing compartido (SAS) de firmas de acceso en el almacenamiento de Azure | Documentos de Microsoft
description: "Obtenga información acerca de toouse compartido acceso firmas (SAS) toodelegate acceso tooAzure recursos de almacenamiento, incluidos los blobs, colas, tablas y archivos."
services: storage
documentationcenter: 
author: mmacy
manager: timlt
editor: tysonn
ms.assetid: 46fd99d7-36b3-4283-81e3-f214b29f1152
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 04/18/2017
ms.author: marsma
ms.openlocfilehash: 53e06c78fbfdaa5fd209add719995ef2a6bc8f61
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="using-shared-access-signatures-sas"></a><span data-ttu-id="71c3b-103">Uso de firmas de acceso compartido (SAS)</span><span class="sxs-lookup"><span data-stu-id="71c3b-103">Using shared access signatures (SAS)</span></span>

<span data-ttu-id="71c3b-104">Una firma de acceso compartido (SAS) proporciona un tooobjects de acceso de manera toogrant limitado en su cuenta de almacenamiento tooother clientes, sin exponer su clave de cuenta.</span><span class="sxs-lookup"><span data-stu-id="71c3b-104">A shared access signature (SAS) provides you with a way toogrant limited access tooobjects in your storage account tooother clients, without exposing your account key.</span></span> <span data-ttu-id="71c3b-105">En este artículo, se proporcionan información general del modelo SAS de hello, revise las prácticas recomendadas SAS y ver algunos ejemplos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-105">In this article, we provide an overview of hello SAS model, review SAS best practices, and look at some examples.</span></span>

<span data-ttu-id="71c3b-106">Para obtener ejemplos de código adicional mediante SAS más allá de los que se presentan aquí, consulte [Introducción al almacenamiento de blobs de Azure en .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) así como otros ejemplos disponibles en hello [ejemplos de código de Azure](https://azure.microsoft.com/documentation/samples/?service=storage) biblioteca.</span><span class="sxs-lookup"><span data-stu-id="71c3b-106">For additional code examples using SAS beyond those presented here, see [Getting Started with Azure Blob Storage in .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) and other samples available in hello [Azure Code Samples](https://azure.microsoft.com/documentation/samples/?service=storage) library.</span></span> <span data-ttu-id="71c3b-107">Puede descargar aplicaciones de ejemplo de Hola y ejecutarlos o examinar el código de hello en GitHub.</span><span class="sxs-lookup"><span data-stu-id="71c3b-107">You can download hello sample applications and run them, or browse hello code on GitHub.</span></span>

## <a name="what-is-a-shared-access-signature"></a><span data-ttu-id="71c3b-108">¿Qué es una firma de acceso compartido?</span><span class="sxs-lookup"><span data-stu-id="71c3b-108">What is a shared access signature?</span></span>
<span data-ttu-id="71c3b-109">Una firma de acceso compartido proporciona acceso delegado tooresources en su cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="71c3b-109">A shared access signature provides delegated access tooresources in your storage account.</span></span> <span data-ttu-id="71c3b-110">Con una SAS, puede conceder a los clientes tener acceso a tooresources en la cuenta de almacenamiento sin compartir las claves de cuenta.</span><span class="sxs-lookup"><span data-stu-id="71c3b-110">With a SAS, you can grant clients access tooresources in your storage account, without sharing your account keys.</span></span> <span data-ttu-id="71c3b-111">Éste es Hola punto clave del uso de firmas de acceso compartido en las aplicaciones--una SAS es un tooshare de forma segura los recursos de almacenamiento sin poner en peligro sus claves de cuenta.</span><span class="sxs-lookup"><span data-stu-id="71c3b-111">This is hello key point of using shared access signatures in your applications--a SAS is a secure way tooshare your storage resources without compromising your account keys.</span></span>

[!INCLUDE [storage-account-key-note-include](../../includes/storage-account-key-note-include.md)]

<span data-ttu-id="71c3b-112">Una SAS ofrece un control granular sobre tipo hello de acceso que se conceda tooclients que tienen Hola SAS, incluidos:</span><span class="sxs-lookup"><span data-stu-id="71c3b-112">A SAS gives you granular control over hello type of access you grant tooclients who have hello SAS, including:</span></span>

* <span data-ttu-id="71c3b-113">intervalo de Hola durante qué hello es válida, incluidos la hora de expiración de Hola y la hora de inicio de hello SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-113">hello interval over which hello SAS is valid, including hello start time and hello expiry time.</span></span>
* <span data-ttu-id="71c3b-114">permisos de Hello concedidos por hello SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-114">hello permissions granted by hello SAS.</span></span> <span data-ttu-id="71c3b-115">Por ejemplo, una SAS para un blob puede conceder y escribir permisos toothat blob, pero no eliminar permisos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-115">For example, a SAS for a blob might grant read and write permissions toothat blob, but not delete permissions.</span></span>
* <span data-ttu-id="71c3b-116">Una dirección IP opcional o intervalo de direcciones IP desde el que va a aceptar el almacenamiento de Azure Hola SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-116">An optional IP address or range of IP addresses from which Azure Storage will accept hello SAS.</span></span> <span data-ttu-id="71c3b-117">Por ejemplo, puede especificar un intervalo de direcciones IP que pertenezcan tooyour organización.</span><span class="sxs-lookup"><span data-stu-id="71c3b-117">For example, you might specify a range of IP addresses belonging tooyour organization.</span></span>
* <span data-ttu-id="71c3b-118">Protocolo de Hello en el cual el almacenamiento de Azure aceptará Hola SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-118">hello protocol over which Azure Storage will accept hello SAS.</span></span> <span data-ttu-id="71c3b-119">Puede usar este tooclients de acceso de parámetro opcional toorestrict mediante HTTPS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-119">You can use this optional parameter toorestrict access tooclients using HTTPS.</span></span>

## <a name="when-should-you-use-a-shared-access-signature"></a><span data-ttu-id="71c3b-120">¿Cuándo debe usar una firma de acceso compartido?</span><span class="sxs-lookup"><span data-stu-id="71c3b-120">When should you use a shared access signature?</span></span>
<span data-ttu-id="71c3b-121">Puede usar una SAS cuando desee tooprovide acceso tooresources en el cliente de tooany de cuenta de almacenamiento que no posee las teclas de acceso de la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="71c3b-121">You can use a SAS when you want tooprovide access tooresources in your storage account tooany client not possessing your storage account's access keys.</span></span> <span data-ttu-id="71c3b-122">La cuenta de almacenamiento incluye una clave de acceso principal y secundaria, los cuales conceder acceso administrativo tooyour cuenta y todos los recursos dentro de él.</span><span class="sxs-lookup"><span data-stu-id="71c3b-122">Your storage account includes both a primary and secondary access key, both of which grant administrative access tooyour account, and all resources within it.</span></span> <span data-ttu-id="71c3b-123">Exposición de cualquiera de estas claves, abre la posibilidad de toohello de cuenta de uso malintencionado o por negligencia.</span><span class="sxs-lookup"><span data-stu-id="71c3b-123">Exposing either of these keys opens your account toohello possibility of malicious or negligent use.</span></span> <span data-ttu-id="71c3b-124">Firmas de acceso compartido proporcionan una alternativa segura que permite a los clientes tooread, escribir y eliminar datos en la cuenta de almacenamiento según los permisos de toohello que le ha concedido explícitamente y sin necesidad de una clave de cuenta.</span><span class="sxs-lookup"><span data-stu-id="71c3b-124">Shared access signatures provide a safe alternative that allows clients tooread, write, and delete data in your storage account according toohello permissions you've explicitly granted, and without need for an account key.</span></span>

<span data-ttu-id="71c3b-125">Un escenario común donde una SAS es útil es un servicio donde los usuarios leerán y escribir su propia cuenta de almacenamiento de datos tooyour.</span><span class="sxs-lookup"><span data-stu-id="71c3b-125">A common scenario where a SAS is useful is a service where users read and write their own data tooyour storage account.</span></span> <span data-ttu-id="71c3b-126">Existen dos patrones de diseño típicos en los escenarios en los que una cuenta de almacenamiento guarda datos de usuario:</span><span class="sxs-lookup"><span data-stu-id="71c3b-126">In a scenario where a storage account stores user data, there are two typical design patterns:</span></span>

1. <span data-ttu-id="71c3b-127">Los clientes cargan y descargan datos mediante un servicio de proxy front-end que realiza la autenticación.</span><span class="sxs-lookup"><span data-stu-id="71c3b-127">Clients upload and download data via a front-end proxy service, which performs authentication.</span></span> <span data-ttu-id="71c3b-128">Este servicio de proxy de front-end tiene la ventaja de Hola de permitir que la validación de reglas de negocios, pero con grandes cantidades de datos o transacciones de gran volumen, la creación de un servicio que se pueda escalar a petición toomatch puede resultar costoso o difícil.</span><span class="sxs-lookup"><span data-stu-id="71c3b-128">This front-end proxy service has hello advantage of allowing validation of business rules, but for large amounts of data or high-volume transactions, creating a service that can scale toomatch demand may be expensive or difficult.</span></span>

  ![Diagrama del escenario: servicio de proxy de front-end][sas-storage-fe-proxy-service]

1. <span data-ttu-id="71c3b-130">Un servicio ligero autentica el cliente de hello según sea necesario y, a continuación, genera una SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-130">A lightweight service authenticates hello client as needed and then generates a SAS.</span></span> <span data-ttu-id="71c3b-131">Una vez que el cliente de hello recibe Hola SAS, puede acceder a recursos de la cuenta de almacenamiento directamente con permisos de hello definidos Hola SAS y para el intervalo de saludo permitido por hello SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-131">Once hello client receives hello SAS, they can access storage account resources directly with hello permissions defined by hello SAS and for hello interval allowed by hello SAS.</span></span> <span data-ttu-id="71c3b-132">Hola SAS mitiga la necesidad de hello para el enrutamiento de todos los datos a través del servicio de proxy de front-end de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-132">hello SAS mitigates hello need for routing all data through hello front-end proxy service.</span></span>

  ![Diagrama del escenario: servicio de proveedor de SAS][sas-storage-provider-service]

<span data-ttu-id="71c3b-134">Muchos servicios reales pueden usar una combinación de estos dos enfoques.</span><span class="sxs-lookup"><span data-stu-id="71c3b-134">Many real-world services may use a hybrid of these two approaches.</span></span> <span data-ttu-id="71c3b-135">Por ejemplo, algunos datos se pueden procesar y validar a través de proxy de front-end de hello, mientras que otros datos se guardan o leer directamente mediante SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-135">For example, some data might be processed and validated via hello front-end proxy, while other data is saved and/or read directly using SAS.</span></span>

<span data-ttu-id="71c3b-136">Además, necesitará toouse un objeto de origen SAS tooauthenticate hello en una operación de copia en ciertos escenarios:</span><span class="sxs-lookup"><span data-stu-id="71c3b-136">Additionally, you will need toouse a SAS tooauthenticate hello source object in a copy operation in certain scenarios:</span></span>

* <span data-ttu-id="71c3b-137">Al copiar un blob de tooanother de blob que reside en una cuenta de almacenamiento diferente, debe usar un blob de origen SAS tooauthenticate Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-137">When you copy a blob tooanother blob that resides in a different storage account, you must use a SAS tooauthenticate hello source blob.</span></span> <span data-ttu-id="71c3b-138">También puede usar un blob de destino para las hello de la tooauthenticate SAS también.</span><span class="sxs-lookup"><span data-stu-id="71c3b-138">You can optionally use a SAS tooauthenticate hello destination blob as well.</span></span>
* <span data-ttu-id="71c3b-139">Al copiar un archivo de tooanother de archivo que se encuentra en una cuenta de almacenamiento diferente, debe usar un archivo de código fuente SAS tooauthenticate Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-139">When you copy a file tooanother file that resides in a different storage account, you must use a SAS tooauthenticate hello source file.</span></span> <span data-ttu-id="71c3b-140">También puede usar una SAS tooauthenticate Hola de destino también.</span><span class="sxs-lookup"><span data-stu-id="71c3b-140">You can optionally use a SAS tooauthenticate hello destination file as well.</span></span>
* <span data-ttu-id="71c3b-141">Al copiar un archivo de tooa de blob o un blob de tooa de archivo, debe usar un objeto de origen SAS tooauthenticate hello, incluso si los objetos de origen y destino de hello residen dentro de hello mismo cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="71c3b-141">When you copy a blob tooa file, or a file tooa blob, you must use a SAS tooauthenticate hello source object, even if hello source and destination objects reside within hello same storage account.</span></span>

## <a name="types-of-shared-access-signatures"></a><span data-ttu-id="71c3b-142">Tipos de firmas de acceso compartido</span><span class="sxs-lookup"><span data-stu-id="71c3b-142">Types of shared access signatures</span></span>
<span data-ttu-id="71c3b-143">Puede crear dos tipos de firmas de acceso compartido:</span><span class="sxs-lookup"><span data-stu-id="71c3b-143">You can create two types of shared access signatures:</span></span>

* <span data-ttu-id="71c3b-144">**SAS de servicio.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-144">**Service SAS.**</span></span> <span data-ttu-id="71c3b-145">delegados SAS del servicio de Hello tener acceso a recursos tooa en solo uno de los servicios de almacenamiento de hello: Hola servicio Blob, cola, tabla o archivo.</span><span class="sxs-lookup"><span data-stu-id="71c3b-145">hello service SAS delegates access tooa resource in just one of hello storage services: hello Blob, Queue, Table, or File service.</span></span> <span data-ttu-id="71c3b-146">Vea [construir una SAS de servicio](https://msdn.microsoft.com/library/dn140255.aspx) y [ejemplos de SAS del servicio](https://msdn.microsoft.com/library/dn140256.aspx) para obtener información detallada sobre cómo generar el token SAS del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-146">See [Constructing a Service SAS](https://msdn.microsoft.com/library/dn140255.aspx) and [Service SAS Examples](https://msdn.microsoft.com/library/dn140256.aspx) for in-depth information about constructing hello service SAS token.</span></span>
* <span data-ttu-id="71c3b-147">**SAS de cuenta.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-147">**Account SAS.**</span></span> <span data-ttu-id="71c3b-148">los delegados SAS de cuenta de Hello tener acceso a tooresources en uno o varios de los servicios de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-148">hello account SAS delegates access tooresources in one or more of hello storage services.</span></span> <span data-ttu-id="71c3b-149">Todas las operaciones de hello disponibles a través de un servicio de SAS de también están disponibles a través de una cuenta SA.</span><span class="sxs-lookup"><span data-stu-id="71c3b-149">All of hello operations available via a service SAS are also available via an account SAS.</span></span> <span data-ttu-id="71c3b-150">Además, con la cuenta de hello SAS, puede delegar toooperations de acceso que se aplican tooa dado servicio, como **propiedades de servicio Get/Set** y **obtener estadísticas del servicio**. También puede delegar el acceso tooread, escritura y las operaciones de eliminación en contenedores de blobs, tablas, colas y recursos compartidos de archivos que no se permiten con un servicio de SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-150">Additionally, with hello account SAS, you can delegate access toooperations that apply tooa given service, such as **Get/Set Service Properties** and **Get Service Stats**. You can also delegate access tooread, write, and delete operations on blob containers, tables, queues, and file shares that are not permitted with a service SAS.</span></span> <span data-ttu-id="71c3b-151">Vea [construir una SAS de cuenta](https://msdn.microsoft.com/library/mt584140.aspx) para obtener información detallada sobre cómo generar el token de SAS de cuenta de hello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-151">See [Constructing an Account SAS](https://msdn.microsoft.com/library/mt584140.aspx) for in-depth information about constructing hello account SAS token.</span></span>

## <a name="how-a-shared-access-signature-works"></a><span data-ttu-id="71c3b-152">Funcionamiento de una firma de acceso compartido</span><span class="sxs-lookup"><span data-stu-id="71c3b-152">How a shared access signature works</span></span>
<span data-ttu-id="71c3b-153">Una firma de acceso compartido es un URI firmado que señala tooone o más recursos de almacenamiento e incluye un símbolo (token) que contiene un conjunto especial de parámetros de consulta.</span><span class="sxs-lookup"><span data-stu-id="71c3b-153">A shared access signature is a signed URI that points tooone or more storage resources and includes a token that contains a special set of query parameters.</span></span> <span data-ttu-id="71c3b-154">símbolo (token) de Hello indica cómo se pueden tener acceso a recursos de hello cliente Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-154">hello token indicates how hello resources may be accessed by hello client.</span></span> <span data-ttu-id="71c3b-155">Uno de los parámetros de consulta de hello, Hola firma, está construido a partir de los parámetros de SAS de Hola y firmado con la clave de la cuenta de hello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-155">One of hello query parameters, hello signature, is constructed from hello SAS parameters and signed with hello account key.</span></span> <span data-ttu-id="71c3b-156">Hola de tooauthenticate de almacenamiento de Azure SAS usa esta firma.</span><span class="sxs-lookup"><span data-stu-id="71c3b-156">This signature is used by Azure Storage tooauthenticate hello SAS.</span></span>

<span data-ttu-id="71c3b-157">Este es un ejemplo de un URI de SAS, el URI del recurso de Hola que muestra y el token de SAS de hello:</span><span class="sxs-lookup"><span data-stu-id="71c3b-157">Here's an example of a SAS URI, showing hello resource URI and hello SAS token:</span></span>

![Componentes de un identificador URI de SAS][sas-storage-uri]

<span data-ttu-id="71c3b-159">token de SAS Hello es una cadena que se generan en hello *cliente* lado (vea hello [ejemplos SAS](#sas-examples) sección para obtener ejemplos de código).</span><span class="sxs-lookup"><span data-stu-id="71c3b-159">hello SAS token is a string you generate on hello *client* side (see hello [SAS examples](#sas-examples) section for code examples).</span></span> <span data-ttu-id="71c3b-160">Un token SAS que se genera con la biblioteca de cliente de almacenamiento de hello, por ejemplo, no está registrado por el almacenamiento de Azure de forma alguna.</span><span class="sxs-lookup"><span data-stu-id="71c3b-160">A SAS token you generate with hello storage client library, for example, is not tracked by Azure Storage in any way.</span></span> <span data-ttu-id="71c3b-161">Puede crear un número ilimitado de tokens de SAS en el lado del cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-161">You can create an unlimited number of SAS tokens on hello client side.</span></span>

<span data-ttu-id="71c3b-162">Cuando un cliente proporciona un almacenamiento de URI de SAS tooAzure como parte de una solicitud, servicio de hello comprueba los parámetros de SAS de Hola y tooverify de firma que es válido para la autenticación de la solicitud de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-162">When a client provides a SAS URI tooAzure Storage as part of a request, hello service checks hello SAS parameters and signature tooverify that it is valid for authenticating hello request.</span></span> <span data-ttu-id="71c3b-163">Si el servicio Hola comprueba que esa firma hello es válida, se autentica solicitud Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-163">If hello service verifies that hello signature is valid, then hello request is authenticated.</span></span> <span data-ttu-id="71c3b-164">En caso contrario, se rechazó una solicitud Hola con código de error 403 (prohibido).</span><span class="sxs-lookup"><span data-stu-id="71c3b-164">Otherwise, hello request is declined with error code 403 (Forbidden).</span></span>

## <a name="shared-access-signature-parameters"></a><span data-ttu-id="71c3b-165">Parámetros de la firma de acceso compartido</span><span class="sxs-lookup"><span data-stu-id="71c3b-165">Shared access signature parameters</span></span>
<span data-ttu-id="71c3b-166">cuenta de Hello SAS y tokens SAS del servicio incluyen algunos parámetros comunes y tener unos parámetros que son diferentes.</span><span class="sxs-lookup"><span data-stu-id="71c3b-166">hello account SAS and service SAS tokens include some common parameters, and also take a few parameters that that are different.</span></span>

### <a name="parameters-common-tooaccount-sas-and-service-sas-tokens"></a><span data-ttu-id="71c3b-167">Parámetros comunes tooaccount SAS y tokens SAS del servicio</span><span class="sxs-lookup"><span data-stu-id="71c3b-167">Parameters common tooaccount SAS and service SAS tokens</span></span>
* <span data-ttu-id="71c3b-168">**Versión de API** un parámetro opcional que especifica la solicitud de hello almacenamiento servicio versión toouse tooexecute Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-168">**Api version** An optional parameter that specifies hello storage service version toouse tooexecute hello request.</span></span>
* <span data-ttu-id="71c3b-169">**Versión del servicio** un parámetro obligatorio que especifica la solicitud de hello almacenamiento servicio versión toouse tooauthenticate Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-169">**Service version** A required parameter that specifies hello storage service version toouse tooauthenticate hello request.</span></span>
* <span data-ttu-id="71c3b-170">**Hora de inicio.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-170">**Start time.**</span></span> <span data-ttu-id="71c3b-171">Se trata de tiempo de hello en qué Hola SAS se vuelve válida.</span><span class="sxs-lookup"><span data-stu-id="71c3b-171">This is hello time at which hello SAS becomes valid.</span></span> <span data-ttu-id="71c3b-172">hora de inicio de Hola de firma de acceso compartido es opcional.</span><span class="sxs-lookup"><span data-stu-id="71c3b-172">hello start time for a shared access signature is optional.</span></span> <span data-ttu-id="71c3b-173">Si se omite una hora de inicio, Hola SAS es efectiva de inmediato.</span><span class="sxs-lookup"><span data-stu-id="71c3b-173">If a start time is omitted, hello SAS is effective immediately.</span></span> <span data-ttu-id="71c3b-174">Hello hora de inicio se debe expresar en UTC (hora Universal), con un designador de hora UTC especial ("Z"), por ejemplo `1994-11-05T13:15:30Z`.</span><span class="sxs-lookup"><span data-stu-id="71c3b-174">hello start time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z`.</span></span>
* <span data-ttu-id="71c3b-175">**Hora de expiración.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-175">**Expiry time.**</span></span> <span data-ttu-id="71c3b-176">Se trata de hello hora después del cual hello SAS ya no es válida.</span><span class="sxs-lookup"><span data-stu-id="71c3b-176">This is hello time after which hello SAS is no longer valid.</span></span> <span data-ttu-id="71c3b-177">En las prácticas recomendadas se aconseja especificar una hora de expiración para una SAS o asociarla a una directiva de acceso almacenada.</span><span class="sxs-lookup"><span data-stu-id="71c3b-177">Best practices recommend that you either specify an expiry time for a SAS, or associate it with a stored access policy.</span></span> <span data-ttu-id="71c3b-178">Hola la hora de expiración se debe expresar en UTC (hora Universal), con un designador de hora UTC especial ("Z"), por ejemplo `1994-11-05T13:15:30Z` (ver más abajo).</span><span class="sxs-lookup"><span data-stu-id="71c3b-178">hello expiry time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z` (see more below).</span></span>
* <span data-ttu-id="71c3b-179">**Permisos.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-179">**Permissions.**</span></span> <span data-ttu-id="71c3b-180">permisos de Hello especificados en hello SAS indican qué operaciones puede realizar cliente hello en un recurso de almacenamiento de hello mediante Hola SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-180">hello permissions specified on hello SAS indicate what operations hello client can perform against hello storage resource using hello SAS.</span></span> <span data-ttu-id="71c3b-181">Los permisos disponibles son diferentes para SAS de cuenta y SAS de servicio.</span><span class="sxs-lookup"><span data-stu-id="71c3b-181">Available permissions differ for an account SAS and a service SAS.</span></span>
* <span data-ttu-id="71c3b-182">**Dirección Dirección IP.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-182">**IP.**</span></span> <span data-ttu-id="71c3b-183">Un parámetro opcional que especifica una dirección IP o un intervalo de direcciones IP fuera de Azure (consulte la sección de hello [estado de configuración de sesión de enrutamiento](../expressroute/expressroute-workflows.md#routing-session-configuration-state) de Express Route) desde qué solicitudes de tooaccept.</span><span class="sxs-lookup"><span data-stu-id="71c3b-183">An optional parameter that specifies an IP address or a range of IP addresses outside of Azure (see hello section [Routing session configuration state](../expressroute/expressroute-workflows.md#routing-session-configuration-state) for Express Route) from which tooaccept requests.</span></span>
* <span data-ttu-id="71c3b-184">**Protocolo.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-184">**Protocol.**</span></span> <span data-ttu-id="71c3b-185">Un parámetro opcional que especifica el protocolo de hello permitidos para una solicitud.</span><span class="sxs-lookup"><span data-stu-id="71c3b-185">An optional parameter that specifies hello protocol permitted for a request.</span></span> <span data-ttu-id="71c3b-186">Los valores posibles son HTTP y HTTPS (`https,http`), que es valor predeterminado de Hola o HTTPS solo (`https`).</span><span class="sxs-lookup"><span data-stu-id="71c3b-186">Possible values are both HTTPS and HTTP (`https,http`), which is hello default value, or HTTPS only (`https`).</span></span> <span data-ttu-id="71c3b-187">Tenga en cuenta que HTTP solo no es un valor permitido.</span><span class="sxs-lookup"><span data-stu-id="71c3b-187">Note that HTTP only is not a permitted value.</span></span>
* <span data-ttu-id="71c3b-188">**Firma.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-188">**Signature.**</span></span> <span data-ttu-id="71c3b-189">firma de Hola se construye a partir de hello otros parámetros especificado como parte de símbolo (token) y, a continuación, se cifra.</span><span class="sxs-lookup"><span data-stu-id="71c3b-189">hello signature is constructed from hello other parameters specified as part token and then encrypted.</span></span> <span data-ttu-id="71c3b-190">Ha utilizado tooauthenticate Hola SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-190">It's used tooauthenticate hello SAS.</span></span>

### <a name="parameters-for-a-service-sas-token"></a><span data-ttu-id="71c3b-191">Parámetros para un token de SAS de servicio</span><span class="sxs-lookup"><span data-stu-id="71c3b-191">Parameters for a service SAS token</span></span>
* <span data-ttu-id="71c3b-192">**Recurso de almacenamiento.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-192">**Storage resource.**</span></span> <span data-ttu-id="71c3b-193">Los recursos de almacenamiento para los que puede delegar el acceso con una SAS de servicio incluyen:</span><span class="sxs-lookup"><span data-stu-id="71c3b-193">Storage resources for which you can delegate access with a service SAS include:</span></span>
  * <span data-ttu-id="71c3b-194">Contenedores y blobs</span><span class="sxs-lookup"><span data-stu-id="71c3b-194">Containers and blobs</span></span>
  * <span data-ttu-id="71c3b-195">Archivos y recursos compartidos de archivo</span><span class="sxs-lookup"><span data-stu-id="71c3b-195">File shares and files</span></span>
  * <span data-ttu-id="71c3b-196">Colas</span><span class="sxs-lookup"><span data-stu-id="71c3b-196">Queues</span></span>
  * <span data-ttu-id="71c3b-197">Las tablas y los intervalos de las entidades de tabla.</span><span class="sxs-lookup"><span data-stu-id="71c3b-197">Tables and ranges of table entities.</span></span>

### <a name="parameters-for-an-account-sas-token"></a><span data-ttu-id="71c3b-198">Parámetros para un token de SAS de cuenta</span><span class="sxs-lookup"><span data-stu-id="71c3b-198">Parameters for an account SAS token</span></span>
* <span data-ttu-id="71c3b-199">**Servicio o servicios.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-199">**Service or services.**</span></span> <span data-ttu-id="71c3b-200">Una cuenta de SAS puede delegar acceso tooone o varios de los servicios de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-200">An account SAS can delegate access tooone or more of hello storage services.</span></span> <span data-ttu-id="71c3b-201">Por ejemplo, puede crear una cuenta SAS que los delegados de tener acceso a servicio de Blob y archivo de toohello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-201">For example, you can create an account SAS that delegates access toohello Blob and File service.</span></span> <span data-ttu-id="71c3b-202">O bien, puede crear una SAS que los delegados de tener acceso a tooall cuatro servicios (Blob, cola, tabla y archivo).</span><span class="sxs-lookup"><span data-stu-id="71c3b-202">Or you can create a SAS that delegates access tooall four services (Blob, Queue, Table, and File).</span></span>
* <span data-ttu-id="71c3b-203">**Tipos de recursos de almacenamiento.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-203">**Storage resource types.**</span></span> <span data-ttu-id="71c3b-204">Aplica una cuenta SA tooone o más clases de recursos de almacenamiento, en lugar de un recurso concreto.</span><span class="sxs-lookup"><span data-stu-id="71c3b-204">An account SAS applies tooone or more classes of storage resources, rather than a specific resource.</span></span> <span data-ttu-id="71c3b-205">Puede crear un acceso de cuenta SAS toodelegate para:</span><span class="sxs-lookup"><span data-stu-id="71c3b-205">You can create an account SAS toodelegate access to:</span></span>
  * <span data-ttu-id="71c3b-206">API de nivel de servicio, que se llaman en un recurso de cuenta de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-206">Service-level APIs, which are called against hello storage account resource.</span></span> <span data-ttu-id="71c3b-207">Algunos ejemplos incluyen **Get/Set Service Properties**, **Get Service Stats**, and **List Containers/Queues/Tables/Shares**.</span><span class="sxs-lookup"><span data-stu-id="71c3b-207">Examples include **Get/Set Service Properties**, **Get Service Stats**, and **List Containers/Queues/Tables/Shares**.</span></span>
  * <span data-ttu-id="71c3b-208">Las API de nivel de contenedor, que se denominan con los objetos de contenedor de Hola para cada servicio: blob contenedores, colas, tablas y los recursos compartidos de archivos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-208">Container-level APIs, which are called against hello container objects for each service: blob containers, queues, tables, and file shares.</span></span> <span data-ttu-id="71c3b-209">Algunos ejemplos incluyen **Create/Delete Container**, **Create/Delete Queue**, **Create/Delete Table**, **Create/Delete Share** y **List Blobs/Files y Directories**.</span><span class="sxs-lookup"><span data-stu-id="71c3b-209">Examples include **Create/Delete Container**, **Create/Delete Queue**, **Create/Delete Table**, **Create/Delete Share**, and **List Blobs/Files and Directories**.</span></span>
  * <span data-ttu-id="71c3b-210">Las API de nivel de objeto, a las que se llaman en blobs, mensajes de colas, entidades de tablas y archivos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-210">Object-level APIs, which are called against blobs, queue messages, table entities, and files.</span></span> <span data-ttu-id="71c3b-211">Por ejemplo, **Put Blob**, **Query Entity**, **Get Messages** y **Create File**.</span><span class="sxs-lookup"><span data-stu-id="71c3b-211">For example, **Put Blob**, **Query Entity**, **Get Messages**, and **Create File**.</span></span>

## <a name="examples-of-sas-uris"></a><span data-ttu-id="71c3b-212">Ejemplos de URI de SAS</span><span class="sxs-lookup"><span data-stu-id="71c3b-212">Examples of SAS URIs</span></span>

### <a name="service-sas-uri-example"></a><span data-ttu-id="71c3b-213">Ejemplo de identificador URI de SAS de servicio</span><span class="sxs-lookup"><span data-stu-id="71c3b-213">Service SAS URI example</span></span>

<span data-ttu-id="71c3b-214">Este es un ejemplo de un servicio URI de SAS proporciona leer y escribir permisos tooa blob.</span><span class="sxs-lookup"><span data-stu-id="71c3b-214">Here is an example of a service SAS URI that provides read and write permissions tooa blob.</span></span> <span data-ttu-id="71c3b-215">tabla de Hello desglosa cada parte de hello URI toounderstand cómo contribuye toohello SAS:</span><span class="sxs-lookup"><span data-stu-id="71c3b-215">hello table breaks down each part of hello URI toounderstand how it contributes toohello SAS:</span></span>

```
https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt?sv=2015-04-05&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D
```

| <span data-ttu-id="71c3b-216">Nombre</span><span class="sxs-lookup"><span data-stu-id="71c3b-216">Name</span></span> | <span data-ttu-id="71c3b-217">Parte de SAS</span><span class="sxs-lookup"><span data-stu-id="71c3b-217">SAS portion</span></span> | <span data-ttu-id="71c3b-218">Description</span><span class="sxs-lookup"><span data-stu-id="71c3b-218">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="71c3b-219">URI de blobs</span><span class="sxs-lookup"><span data-stu-id="71c3b-219">Blob URI</span></span> |`https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt` |<span data-ttu-id="71c3b-220">dirección de Hola de blob de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-220">hello address of hello blob.</span></span> <span data-ttu-id="71c3b-221">Tenga en cuenta que se recomienda fehacientemente el uso de HTTPS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-221">Note that using HTTPS is highly recommended.</span></span> |
| <span data-ttu-id="71c3b-222">Versión de servicios de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="71c3b-222">Storage services version</span></span> |`sv=2015-04-05` |<span data-ttu-id="71c3b-223">Para servicios de almacenamiento versión 2012-02-12 y versiones posteriores, este parámetro indica Hola versión toouse.</span><span class="sxs-lookup"><span data-stu-id="71c3b-223">For storage services version 2012-02-12 and later, this parameter indicates hello version toouse.</span></span> |
| <span data-ttu-id="71c3b-224">Hora de inicio</span><span class="sxs-lookup"><span data-stu-id="71c3b-224">Start time</span></span> |`st=2015-04-29T22%3A18%3A26Z` |<span data-ttu-id="71c3b-225">Se especifica en hora UTC.</span><span class="sxs-lookup"><span data-stu-id="71c3b-225">Specified in UTC time.</span></span> <span data-ttu-id="71c3b-226">Si desea Hola SAS toobe válida inmediatamente, omita la hora de inicio Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-226">If you want hello SAS toobe valid immediately, omit hello start time.</span></span> |
| <span data-ttu-id="71c3b-227">Hora de expiración</span><span class="sxs-lookup"><span data-stu-id="71c3b-227">Expiry time</span></span> |`se=2015-04-30T02%3A23%3A26Z` |<span data-ttu-id="71c3b-228">Se especifica en hora UTC.</span><span class="sxs-lookup"><span data-stu-id="71c3b-228">Specified in UTC time.</span></span> |
| <span data-ttu-id="71c3b-229">Recurso</span><span class="sxs-lookup"><span data-stu-id="71c3b-229">Resource</span></span> |`sr=b` |<span data-ttu-id="71c3b-230">recurso de Hello es un blob.</span><span class="sxs-lookup"><span data-stu-id="71c3b-230">hello resource is a blob.</span></span> |
| <span data-ttu-id="71c3b-231">Permisos</span><span class="sxs-lookup"><span data-stu-id="71c3b-231">Permissions</span></span> |`sp=rw` |<span data-ttu-id="71c3b-232">permisos de Hello concedidos por hello SAS incluyen Read (r) y escritura (w).</span><span class="sxs-lookup"><span data-stu-id="71c3b-232">hello permissions granted by hello SAS include Read (r) and Write (w).</span></span> |
| <span data-ttu-id="71c3b-233">Intervalo de IP</span><span class="sxs-lookup"><span data-stu-id="71c3b-233">IP range</span></span> |`sip=168.1.5.60-168.1.5.70` |<span data-ttu-id="71c3b-234">Hola intervalo de direcciones IP desde el que se aceptarán una solicitud.</span><span class="sxs-lookup"><span data-stu-id="71c3b-234">hello range of IP addresses from which a request will be accepted.</span></span> |
| <span data-ttu-id="71c3b-235">Protocol</span><span class="sxs-lookup"><span data-stu-id="71c3b-235">Protocol</span></span> |`spr=https` |<span data-ttu-id="71c3b-236">Solo se permiten solicitudes con HTTPS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-236">Only requests using HTTPS are permitted.</span></span> |
| <span data-ttu-id="71c3b-237">Firma</span><span class="sxs-lookup"><span data-stu-id="71c3b-237">Signature</span></span> |`sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D` |<span data-ttu-id="71c3b-238">Usa el blob de tooauthenticate acceso toohello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-238">Used tooauthenticate access toohello blob.</span></span> <span data-ttu-id="71c3b-239">firma de Hello es un HMAC calculado sobre un valor string-to-sign y una clave con el algoritmo SHA256 de hello y, a continuación, codificado con Base64.</span><span class="sxs-lookup"><span data-stu-id="71c3b-239">hello signature is an HMAC computed over a string-to-sign and key using hello SHA256 algorithm, and then encoded using Base64 encoding.</span></span> |

### <a name="account-sas-uri-example"></a><span data-ttu-id="71c3b-240">Ejemplo de identificador URI de SAS de cuenta</span><span class="sxs-lookup"><span data-stu-id="71c3b-240">Account SAS URI example</span></span>

<span data-ttu-id="71c3b-241">Este es un ejemplo de una cuenta de SAS que usa Hola mismo parámetros comunes de token de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-241">Here is an example of an account SAS that uses hello same common parameters on hello token.</span></span> <span data-ttu-id="71c3b-242">Como estos parámetros aparecen descritos anteriormente, no los vamos a describir aquí.</span><span class="sxs-lookup"><span data-stu-id="71c3b-242">Since these parameters are described above, they are not described here.</span></span> <span data-ttu-id="71c3b-243">Hello en los parámetros que son específico tooaccount que SAS se describen en la siguiente tabla se Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-243">Only hello parameters that are specific tooaccount SAS are described in hello table below.</span></span>

```
https://myaccount.blob.core.windows.net/?restype=service&comp=properties&sv=2015-04-05&ss=bf&srt=s&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=F%6GRVAZ5Cdj2Pw4tgU7IlSTkWgn7bUkkAg8P6HESXwmf%4B
```

| <span data-ttu-id="71c3b-244">Nombre</span><span class="sxs-lookup"><span data-stu-id="71c3b-244">Name</span></span> | <span data-ttu-id="71c3b-245">Parte de SAS</span><span class="sxs-lookup"><span data-stu-id="71c3b-245">SAS portion</span></span> | <span data-ttu-id="71c3b-246">Description</span><span class="sxs-lookup"><span data-stu-id="71c3b-246">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="71c3b-247">URI de recurso</span><span class="sxs-lookup"><span data-stu-id="71c3b-247">Resource URI</span></span> |`https://myaccount.blob.core.windows.net/?restype=service&comp=properties` |<span data-ttu-id="71c3b-248">Hola extremo del servicio Blob, con parámetros para obtener propiedades del servicio (cuando se llama con GET) o establecer las propiedades del servicio (cuando se llama con conjunto).</span><span class="sxs-lookup"><span data-stu-id="71c3b-248">hello Blob service endpoint, with parameters for getting service properties (when called with GET) or setting service properties (when called with SET).</span></span> |
| <span data-ttu-id="71c3b-249">Services</span><span class="sxs-lookup"><span data-stu-id="71c3b-249">Services</span></span> |`ss=bf` |<span data-ttu-id="71c3b-250">Hola SAS aplica toohello Blob y servicios de archivos</span><span class="sxs-lookup"><span data-stu-id="71c3b-250">hello SAS applies toohello Blob and File services</span></span> |
| <span data-ttu-id="71c3b-251">Tipos de recursos</span><span class="sxs-lookup"><span data-stu-id="71c3b-251">Resource types</span></span> |`srt=s` |<span data-ttu-id="71c3b-252">Hola SAS aplica a las operaciones de nivel de tooservice.</span><span class="sxs-lookup"><span data-stu-id="71c3b-252">hello SAS applies tooservice-level operations.</span></span> |
| <span data-ttu-id="71c3b-253">Permisos</span><span class="sxs-lookup"><span data-stu-id="71c3b-253">Permissions</span></span> |`sp=rw` |<span data-ttu-id="71c3b-254">permisos de Hello conceder acceso tooread y las operaciones de escritura.</span><span class="sxs-lookup"><span data-stu-id="71c3b-254">hello permissions grant access tooread and write operations.</span></span> |

<span data-ttu-id="71c3b-255">Dado que los permisos están restringidos toohello el nivel de servicio, operaciones accesibles con esta SAS son **obtener propiedades del servicio Blob** (lectura) y **Set Blob Service Properties** (escribir).</span><span class="sxs-lookup"><span data-stu-id="71c3b-255">Given that permissions are restricted toohello service level, accessible operations with this SAS are **Get Blob Service Properties** (read) and **Set Blob Service Properties** (write).</span></span> <span data-ttu-id="71c3b-256">Sin embargo, con un URI de recurso diferente, hello mismo token SAS también pueden usar toodelegate acceso demasiado**obtener estadísticas del servicio Blob** (lectura).</span><span class="sxs-lookup"><span data-stu-id="71c3b-256">However, with a different resource URI, hello same SAS token could also be used toodelegate access too**Get Blob Service Stats** (read).</span></span>

## <a name="controlling-a-sas-with-a-stored-access-policy"></a><span data-ttu-id="71c3b-257">Control de una SAS con una directiva de acceso almacenada</span><span class="sxs-lookup"><span data-stu-id="71c3b-257">Controlling a SAS with a stored access policy</span></span>
<span data-ttu-id="71c3b-258">Una firma de acceso compartido puede presentar una de estas dos formas:</span><span class="sxs-lookup"><span data-stu-id="71c3b-258">A shared access signature can take one of two forms:</span></span>

* <span data-ttu-id="71c3b-259">**SAS ad hoc:** cuando se crea un SAS ad hoc, la hora de inicio de hello, la hora de expiración y permisos para hello SAS se especifican en Hola URI de SAS (o implícitas, en caso de hello donde se omite la hora de inicio).</span><span class="sxs-lookup"><span data-stu-id="71c3b-259">**Ad hoc SAS:** When you create an ad hoc SAS, hello start time, expiry time, and permissions for hello SAS are all specified in hello SAS URI (or implied, in hello case where start time is omitted).</span></span> <span data-ttu-id="71c3b-260">Este tipo de SAS puede crearse como SAS de cuenta o como SAS de servicio.</span><span class="sxs-lookup"><span data-stu-id="71c3b-260">This type of SAS can be created as an account SAS or a service SAS.</span></span>
* <span data-ttu-id="71c3b-261">**Asociaciones de seguridad con la directiva de acceso almacenada:** una directiva de acceso almacenada se define en un contenedor de recursos: un contenedor de blob, tabla, poner en cola, o de recurso compartido, de archivos y puede ser restricciones toomanage usado para una o varias firmas de acceso compartido.</span><span class="sxs-lookup"><span data-stu-id="71c3b-261">**SAS with stored access policy:** A stored access policy is defined on a resource container--a blob container, table, queue, or file share--and can be used toomanage constraints for one or more shared access signatures.</span></span> <span data-ttu-id="71c3b-262">Al asociar una SAS con una directiva de acceso almacenada, Hola SAS hereda las restricciones de hello: hora de inicio de hello, la hora de expiración y permisos--definidos para la directiva de acceso de hello almacenado.</span><span class="sxs-lookup"><span data-stu-id="71c3b-262">When you associate a SAS with a stored access policy, hello SAS inherits hello constraints--hello start time, expiry time, and permissions--defined for hello stored access policy.</span></span>

> [!NOTE]
> <span data-ttu-id="71c3b-263">Actualmente, una SAS de cuenta debe ser una SAS ad hoc.</span><span class="sxs-lookup"><span data-stu-id="71c3b-263">Currently, an account SAS must be an ad hoc SAS.</span></span> <span data-ttu-id="71c3b-264">Las directivas de acceso almacenadas ya no son compatibles para SAS de cuenta.</span><span class="sxs-lookup"><span data-stu-id="71c3b-264">Stored access policies are not yet supported for account SAS.</span></span>

<span data-ttu-id="71c3b-265">Hello diferencia entre Hola dos formatos es importante para un escenario clave: revocación.</span><span class="sxs-lookup"><span data-stu-id="71c3b-265">hello difference between hello two forms is important for one key scenario: revocation.</span></span> <span data-ttu-id="71c3b-266">Dado que un URI de SAS es una dirección URL, cualquier persona que obtenga Hola SAS puede utilizar, independientemente de quién lo creó originalmente.</span><span class="sxs-lookup"><span data-stu-id="71c3b-266">Because a SAS URI is a URL, anyone that obtains hello SAS can use it, regardless of who originally created it.</span></span> <span data-ttu-id="71c3b-267">Si una SAS se publica públicamente, se puede utilizar cualquier usuario de Hola a todos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-267">If a SAS is published publicly, it can be used by anyone in hello world.</span></span> <span data-ttu-id="71c3b-268">Un tooanyone de tooresources acceso SAS concede se que cuente con él hasta que se produce uno de cuatro aspectos:</span><span class="sxs-lookup"><span data-stu-id="71c3b-268">A SAS grants access tooresources tooanyone possessing it until one of four things happens:</span></span>

1. <span data-ttu-id="71c3b-269">hora de expiración de Hello especificado en hello que SAS se alcanza.</span><span class="sxs-lookup"><span data-stu-id="71c3b-269">hello expiry time specified on hello SAS is reached.</span></span>
2. <span data-ttu-id="71c3b-270">hora de expiración de Hello especificado en la directiva de acceso de hello almacenado al que hace referencia Hola que SAS se alcanza (si se hace referencia a una directiva de acceso almacenada y si especifica una hora de expiración).</span><span class="sxs-lookup"><span data-stu-id="71c3b-270">hello expiry time specified on hello stored access policy referenced by hello SAS is reached (if a stored access policy is referenced, and if it specifies an expiry time).</span></span> <span data-ttu-id="71c3b-271">Esto puede ocurrir porque transcurre el intervalo de saludo o porque se ha modificado la directiva de acceso de hello almacenado con una hora de expiración en hello anterior, que es una manera de toorevoke hello SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-271">This can occur either because hello interval elapses, or because you've modified hello stored access policy with an expiry time in hello past, which is one way toorevoke hello SAS.</span></span>
3. <span data-ttu-id="71c3b-272">Hola almacenado al que hace referencia Hola que SAS se elimina, que es hello de toorevoke de otra manera SAS de directiva de acceso.</span><span class="sxs-lookup"><span data-stu-id="71c3b-272">hello stored access policy referenced by hello SAS is deleted, which is another way toorevoke hello SAS.</span></span> <span data-ttu-id="71c3b-273">Tenga en cuenta que si exactamente, volver a directiva de acceso de hello almacenado con Hola homónimas, todas las SA existentes tokens will nuevo asociarse permisos toohello correspondiente válidos esa directiva de acceso almacenada (suponiendo que la hora de expiración hello en hello SAS no ha pasado).</span><span class="sxs-lookup"><span data-stu-id="71c3b-273">Note that if you recreate hello stored access policy with exactly hello same name, all existing SAS tokens will again be valid according toohello permissions associated with that stored access policy (assuming that hello expiry time on hello SAS has not passed).</span></span> <span data-ttu-id="71c3b-274">Si tiene previsto toorevoke Hola SAS, ser seguro toouse un nombre diferente si vuelve a crear la directiva de acceso Hola con una hora de expiración en hello futuras.</span><span class="sxs-lookup"><span data-stu-id="71c3b-274">If you are intending toorevoke hello SAS, be sure toouse a different name if you recreate hello access policy with an expiry time in hello future.</span></span>
4. <span data-ttu-id="71c3b-275">clave de la cuenta de Hello que estaba toocreate usado Hola SAS se vuelve a generar.</span><span class="sxs-lookup"><span data-stu-id="71c3b-275">hello account key that was used toocreate hello SAS is regenerated.</span></span> <span data-ttu-id="71c3b-276">Volver a generar una clave de cuenta hará que todos los componentes de aplicación mediante esa tooauthenticate toofail clave hasta que se actualizan toouse Hola ya sea otra clave de cuenta válido o la clave de cuenta recién regenerada de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-276">Regenerating an account key will cause all application components using that key toofail tooauthenticate until they're updated toouse either hello other valid account key or hello newly regenerated account key.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="71c3b-277">Un URI de firma de acceso compartido está asociado a la firma de hello cuenta clave toocreate usado Hola y Hola asociados directiva de acceso almacenada (si existe).</span><span class="sxs-lookup"><span data-stu-id="71c3b-277">A shared access signature URI is associated with hello account key used toocreate hello signature, and hello associated stored access policy (if any).</span></span> <span data-ttu-id="71c3b-278">Si no se especifica ninguna directiva de acceso almacenada, hello toorevoke de manera sólo firma de acceso compartido es toochange Hola cuenta clave.</span><span class="sxs-lookup"><span data-stu-id="71c3b-278">If no stored access policy is specified, hello only way toorevoke a shared access signature is toochange hello account key.</span></span>

## <a name="authenticating-from-a-client-application-with-a-sas"></a><span data-ttu-id="71c3b-279">Autenticación desde una aplicación cliente con una SAS</span><span class="sxs-lookup"><span data-stu-id="71c3b-279">Authenticating from a client application with a SAS</span></span>
<span data-ttu-id="71c3b-280">Un cliente que está en posesión de una SAS puede utilizar Hola SAS tooauthenticate una solicitud en una cuenta de almacenamiento para el que no poseen claves de cuenta de hello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-280">A client who is in possession of a SAS can use hello SAS tooauthenticate a request against a storage account for which they do not possess hello account keys.</span></span> <span data-ttu-id="71c3b-281">Una SAS pueden incluirse en una cadena de conexión, o utilización directa desde el método o constructor adecuado de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-281">A SAS can be included in a connection string, or used directly from hello appropriate constructor or method.</span></span>

### <a name="using-a-sas-in-a-connection-string"></a><span data-ttu-id="71c3b-282">Uso de SAS en una cadena de conexión</span><span class="sxs-lookup"><span data-stu-id="71c3b-282">Using a SAS in a connection string</span></span>
[!INCLUDE [storage-use-sas-in-connection-string-include](../../includes/storage-use-sas-in-connection-string-include.md)]

### <a name="using-a-sas-in-a-constructor-or-method"></a><span data-ttu-id="71c3b-283">Uso de una SAS en un constructor o método</span><span class="sxs-lookup"><span data-stu-id="71c3b-283">Using a SAS in a constructor or method</span></span>
<span data-ttu-id="71c3b-284">Varios constructores de biblioteca de cliente de almacenamiento de Azure y sobrecargas de método ofrecen un parámetro SAS, para que pueda autenticar un servicio de toohello de solicitud con una SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-284">Several Azure Storage client library constructors and method overloads offer a SAS parameter, so that you can authenticate a request toohello service with a SAS.</span></span>

<span data-ttu-id="71c3b-285">Por ejemplo, aquí un URI de SAS es toocreate usado un blob en bloques tooa referencia.</span><span class="sxs-lookup"><span data-stu-id="71c3b-285">For example, here a SAS URI is used toocreate a reference tooa block blob.</span></span> <span data-ttu-id="71c3b-286">Hola SAS proporciona credenciales solo Hola necesarias para la solicitud de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-286">hello SAS provides hello only credentials needed for hello request.</span></span> <span data-ttu-id="71c3b-287">referencia de blob de bloque de Hello, a continuación, se utiliza para una operación de escritura:</span><span class="sxs-lookup"><span data-stu-id="71c3b-287">hello block blob reference is then used for a write operation:</span></span>

```csharp
string sasUri = "https://storagesample.blob.core.windows.net/sample-container/" +
    "sampleBlob.txt?sv=2015-07-08&sr=b&sig=39Up9JzHkxhUIhFEjEH9594DJxe7w6cIRCg0V6lCGSo%3D" +
    "&se=2016-10-18T21%3A51%3A37Z&sp=rcw";

CloudBlockBlob blob = new CloudBlockBlob(new Uri(sasUri));

// Create operation: Upload a blob with hello specified name toohello container.
// If hello blob does not exist, it will be created. If it does exist, it will be overwritten.
try
{
    MemoryStream msWrite = new MemoryStream(Encoding.UTF8.GetBytes(blobContent));
    msWrite.Position = 0;
    using (msWrite)
    {
        await blob.UploadFromStreamAsync(msWrite);
    }

    Console.WriteLine("Create operation succeeded for SAS {0}", sasUri);
    Console.WriteLine();
}
catch (StorageException e)
{
    if (e.RequestInformation.HttpStatusCode == 403)
    {
        Console.WriteLine("Create operation failed for SAS {0}", sasUri);
        Console.WriteLine("Additional error information: " + e.Message);
        Console.WriteLine();
    }
    else
    {
        Console.WriteLine(e.Message);
        Console.ReadLine();
        throw;
    }
}

```

## <a name="best-practices-when-using-sas"></a><span data-ttu-id="71c3b-288">Procedimientos recomendados al usar SAS</span><span class="sxs-lookup"><span data-stu-id="71c3b-288">Best practices when using SAS</span></span>
<span data-ttu-id="71c3b-289">Al usar firmas de acceso compartido en las aplicaciones, necesita toobe en cuenta dos posibles riesgos:</span><span class="sxs-lookup"><span data-stu-id="71c3b-289">When you use shared access signatures in your applications, you need toobe aware of two potential risks:</span></span>

* <span data-ttu-id="71c3b-290">Si se perdió una SAS, cualquier persona que la consiga puede usarla, lo que puede poner en riesgo su cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="71c3b-290">If a SAS is leaked, it can be used by anyone who obtains it, which can potentially compromise your storage account.</span></span>
* <span data-ttu-id="71c3b-291">Si no proporciona una SAS expira tooa aplicación de cliente o aplicación hello no se puede tooretrieve una nueva SAS de su servicio, puede impedirse funcionalidad de la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-291">If a SAS provided tooa client application expires and hello application is unable tooretrieve a new SAS from your service, then hello application's functionality may be hindered.</span></span>

<span data-ttu-id="71c3b-292">Hello siguientes recomendaciones para el uso de firmas de acceso compartido pueden ayudar a mitigar estos riesgos:</span><span class="sxs-lookup"><span data-stu-id="71c3b-292">hello following recommendations for using shared access signatures can help mitigate these risks:</span></span>

1. <span data-ttu-id="71c3b-293">**Utilizar siempre HTTPS** toocreate o distribuya una SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-293">**Always use HTTPS** toocreate or distribute a SAS.</span></span> <span data-ttu-id="71c3b-294">Si se pasa a través de HTTP e interceptar una SAS, un atacante que realiza un ataque de man-in-the-middle es capaz de tooread hello SAS y, a continuación, use solo según lo previsto de hello podrían tener usuarios, podría poner en peligro los datos confidenciales o permitir de daños en los datos por hello usuario malintencionado.</span><span class="sxs-lookup"><span data-stu-id="71c3b-294">If a SAS is passed over HTTP and intercepted, an attacker performing a man-in-the-middle attack is able tooread hello SAS and then use it just as hello intended user could have, potentially compromising sensitive data or allowing for data corruption by hello malicious user.</span></span>
2. <span data-ttu-id="71c3b-295">**Haga referencia a las directivas de acceso almacenadas cuando sea posible.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-295">**Reference stored access policies where possible.**</span></span> <span data-ttu-id="71c3b-296">Almacena ofrecen a las directivas de acceso Hola permisos de toorevoke opción sin tener claves de cuenta de almacenamiento de tooregenerate Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-296">Stored access policies give you hello option toorevoke permissions without having tooregenerate hello storage account keys.</span></span> <span data-ttu-id="71c3b-297">Establecer caducidad Hola estos temas muy alejadas en hello futura (o infinito) y asegurarse de que se ha actualizado con regularidad toomove más lejos en hello futuras.</span><span class="sxs-lookup"><span data-stu-id="71c3b-297">Set hello expiration on these very far in hello future (or infinite) and make sure it's regularly updated toomove it farther into hello future.</span></span>
3. <span data-ttu-id="71c3b-298">**Use horas de expiración a corto plazo en una SAS ad-hoc.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-298">**Use near-term expiration times on an ad hoc SAS.**</span></span> <span data-ttu-id="71c3b-299">De esta manera, incluso si una SAS está en peligro, es válida solo durante un breve período.</span><span class="sxs-lookup"><span data-stu-id="71c3b-299">In this way, even if a SAS is compromised, it's valid only for a short time.</span></span> <span data-ttu-id="71c3b-300">Esta práctica es especialmente importante si no puede hacer referencia a una directiva de acceso almacenada.</span><span class="sxs-lookup"><span data-stu-id="71c3b-300">This practice is especially important if you cannot reference a stored access policy.</span></span> <span data-ttu-id="71c3b-301">Tiempos de expiración a corto plazo también limitan la cantidad de Hola de datos que se pueden escribir tooa blob mediante la limitación de hello tiempo disponible tooupload tooit.</span><span class="sxs-lookup"><span data-stu-id="71c3b-301">Near-term expiration times also limit hello amount of data that can be written tooa blob by limiting hello time available tooupload tooit.</span></span>
4. <span data-ttu-id="71c3b-302">**Tener clientes renovar automáticamente Hola SAS si es necesario.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-302">**Have clients automatically renew hello SAS if necessary.**</span></span> <span data-ttu-id="71c3b-303">Los clientes deben renovar Hola SAS bien antes de que caduque hello, en el tiempo de tooallow de orden de los reintentos si servicio Hola proporcionar Hola SAS no está disponible.</span><span class="sxs-lookup"><span data-stu-id="71c3b-303">Clients should renew hello SAS well before hello expiration, in order tooallow time for retries if hello service providing hello SAS is unavailable.</span></span> <span data-ttu-id="71c3b-304">Si su SAS está pensado toobe usado para un número reducido de inmediato, las operaciones de corta duración que espera toobe completada dentro del período de expiración de hello, esto puede ser innecesario como Hola que SAS no esperaba toobe renovado.</span><span class="sxs-lookup"><span data-stu-id="71c3b-304">If your SAS is meant toobe used for a small number of immediate, short-lived operations that are expected toobe completed within hello expiration period, then this may be unnecessary as hello SAS is not expected toobe renewed.</span></span> <span data-ttu-id="71c3b-305">Sin embargo, si tiene un cliente que habitualmente se está realizando solicitudes a través de SAS, posibilidad de Hola de expiración entra en juego.</span><span class="sxs-lookup"><span data-stu-id="71c3b-305">However, if you have client that is routinely making requests via SAS, then hello possibility of expiration comes into play.</span></span> <span data-ttu-id="71c3b-306">Hello consideraciones clave es toobalance Hola necesidad para hello SAS toobe corta duración (como se mencionó anteriormente) con hello necesidad tooensure que Hola cliente está solicitando renovación al principio suficiente (interrupción de tooavoid debido a que van a expirar toosuccessful anterior renovación de toohello SAS).</span><span class="sxs-lookup"><span data-stu-id="71c3b-306">hello key consideration is toobalance hello need for hello SAS toobe short-lived (as previously stated) with hello need tooensure that hello client is requesting renewal early enough (tooavoid disruption due toohello SAS expiring prior toosuccessful renewal).</span></span>
5. <span data-ttu-id="71c3b-307">**Tenga cuidado con la hora de inicio de la SAS.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-307">**Be careful with SAS start time.**</span></span> <span data-ttu-id="71c3b-308">Si establece la hora de inicio de Hola para una SAS demasiado**ahora**, luego debido tooclock sesgo (las diferencias en la hora actual según toodifferent máquinas), errores, se pueden observar de vez en cuando para hello primeros minutos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-308">If you set hello start time for a SAS too**now**, then due tooclock skew (differences in current time according toodifferent machines), failures may be observed intermittently for hello first few minutes.</span></span> <span data-ttu-id="71c3b-309">En general, establezca toobe de tiempo de inicio de hello al menos 15 minutos en hello anterior.</span><span class="sxs-lookup"><span data-stu-id="71c3b-309">In general, set hello start time toobe at least 15 minutes in hello past.</span></span> <span data-ttu-id="71c3b-310">O, no establezca esta opción en absoluto, lo que hará que sea válido inmediatamente en todos los casos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-310">Or, don't set it at all, which will make it valid immediately in all cases.</span></span> <span data-ttu-id="71c3b-311">Hola mismo sucede generalmente tooexpiry tiempo también--Recuerde que se puede observar una too15 minutos del reloj del sesgo en cualquier dirección en cualquier solicitud.</span><span class="sxs-lookup"><span data-stu-id="71c3b-311">hello same generally applies tooexpiry time as well--remember that you may observe up too15 minutes of clock skew in either direction on any request.</span></span> <span data-ttu-id="71c3b-312">Para los clientes que usan un resto versión anterior too2012-02-12, duración máxima de Hola para una SA que no hace referencia a una directiva de acceso almacenada es 1 hora y las directivas que se especifica a largo plazo de se producirá un error.</span><span class="sxs-lookup"><span data-stu-id="71c3b-312">For clients using a REST version prior too2012-02-12, hello maximum duration for a SAS that does not reference a stored access policy is 1 hour, and any policies specifying longer term than that will fail.</span></span>
6. <span data-ttu-id="71c3b-313">**Ser específico con hello recursos toobe tiene acceso.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-313">**Be specific with hello resource toobe accessed.**</span></span> <span data-ttu-id="71c3b-314">Una práctica recomendada de seguridad es un usuario con privilegios mínimos requeridos de hello tooprovide.</span><span class="sxs-lookup"><span data-stu-id="71c3b-314">A security best practice is tooprovide a user with hello minimum required privileges.</span></span> <span data-ttu-id="71c3b-315">Si un usuario solo necesita acceso de lectura tooa única entidad, a continuación, concederles acceso de lectura toothat única entidad y no de lectura/escritura/eliminación acceso tooall entidades.</span><span class="sxs-lookup"><span data-stu-id="71c3b-315">If a user only needs read access tooa single entity, then grant them read access toothat single entity, and not read/write/delete access tooall entities.</span></span> <span data-ttu-id="71c3b-316">Esto también ayuda a reducir los daños de hello si se pone en peligro una SAS porque Hola SAS tiene menor consumo de energía en manos de Hola de que un atacante.</span><span class="sxs-lookup"><span data-stu-id="71c3b-316">This also helps lessen hello damage if a SAS is compromised because hello SAS has less power in hello hands of an attacker.</span></span>
7. <span data-ttu-id="71c3b-317">**Comprenda que se le hará un cargo en la cuenta por cualquier uso, incluido el realizado con la SAS.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-317">**Understand that your account will be billed for any usage, including that done with SAS.**</span></span> <span data-ttu-id="71c3b-318">Si proporciona acceso de escritura tooa blob, un usuario puede elegir tooupload un blob de 200GB.</span><span class="sxs-lookup"><span data-stu-id="71c3b-318">If you provide write access tooa blob, a user may choose tooupload a 200GB blob.</span></span> <span data-ttu-id="71c3b-319">Si se le ha dado ellos también acceso de lectura, puede elegir toodownload 10 veces, incurriendo en 2 TB en salida cuesta automáticamente.</span><span class="sxs-lookup"><span data-stu-id="71c3b-319">If you've given them read access as well, they may choose toodownload it 10 times, incurring 2 TB in egress costs for you.</span></span> <span data-ttu-id="71c3b-320">Una vez más, proporcionar permisos limitados toohelp mitigar posibles acciones de Hola de usuarios malintencionados.</span><span class="sxs-lookup"><span data-stu-id="71c3b-320">Again, provide limited permissions toohelp mitigate hello potential actions of malicious users.</span></span> <span data-ttu-id="71c3b-321">Usar esta amenaza de corta duración tooreduce SAS (aunque esté atento a reloj se sesga en hora de finalización de hello).</span><span class="sxs-lookup"><span data-stu-id="71c3b-321">Use short-lived SAS tooreduce this threat (but be mindful of clock skew on hello end time).</span></span>
8. <span data-ttu-id="71c3b-322">**Valide los datos escritos mediante la SAS.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-322">**Validate data written using SAS.**</span></span> <span data-ttu-id="71c3b-323">Cuando una aplicación cliente escribe la cuenta de almacenamiento de datos tooyour, tenga en cuenta que puede haber problemas con dichos datos.</span><span class="sxs-lookup"><span data-stu-id="71c3b-323">When a client application writes data tooyour storage account, keep in mind that there can be problems with that data.</span></span> <span data-ttu-id="71c3b-324">Si la aplicación requiere que se valida o autorización antes de que se toouse listo datos, debe realizar esta validación después de que se escriben los datos de Hola y antes de que se usa la aplicación.</span><span class="sxs-lookup"><span data-stu-id="71c3b-324">If your application requires that that data be validated or authorized before it is ready toouse, you should perform this validation after hello data is written and before it is used by your application.</span></span> <span data-ttu-id="71c3b-325">Esta práctica también protege frente a dañado o malintencionados de los datos que se escriben tooyour cuenta, ya sea por un usuario que se adquirió correctamente Hola SAS o por un usuario aprovecharse de una SAS perdida.</span><span class="sxs-lookup"><span data-stu-id="71c3b-325">This practice also protects against corrupt or malicious data being written tooyour account, either by a user who properly acquired hello SAS, or by a user exploiting a leaked SAS.</span></span>
9. <span data-ttu-id="71c3b-326">**No use siempre la SAS.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-326">**Don't always use SAS.**</span></span> <span data-ttu-id="71c3b-327">A veces los riesgos de hello asociados con una operación determinada en su cuenta de almacenamiento superan a las ventajas de Hola de SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-327">Sometimes hello risks associated with a particular operation against your storage account outweigh hello benefits of SAS.</span></span> <span data-ttu-id="71c3b-328">Para estas operaciones, crear un servicio de nivel intermedio que escribe la cuenta de almacenamiento tooyour después de realizar negocios de reglas de validación, autenticación y auditoría.</span><span class="sxs-lookup"><span data-stu-id="71c3b-328">For such operations, create a middle-tier service that writes tooyour storage account after performing business rule validation, authentication, and auditing.</span></span> <span data-ttu-id="71c3b-329">Además, a veces resulta más fácil acceso toomanage de otras maneras.</span><span class="sxs-lookup"><span data-stu-id="71c3b-329">Also, sometimes it's simpler toomanage access in other ways.</span></span> <span data-ttu-id="71c3b-330">Por ejemplo, si desea que toomake todos los blobs en un contenedor de leer públicamente, puede realizar Hola contenedor público, en lugar de proporcionar un cliente de tooevery SAS para el acceso.</span><span class="sxs-lookup"><span data-stu-id="71c3b-330">For example, if you want toomake all blobs in a container publically readable, you can make hello container Public, rather than providing a SAS tooevery client for access.</span></span>
10. <span data-ttu-id="71c3b-331">**Use toomonitor de análisis de almacenamiento de la aplicación.**</span><span class="sxs-lookup"><span data-stu-id="71c3b-331">**Use Storage Analytics toomonitor your application.**</span></span> <span data-ttu-id="71c3b-332">Puede utilizar el registro y tooobserve métricas cualquier incremento en errores de autenticación debido a una interrupción de tooan en su SAS proveedor servicio o toohello involuntario eliminación de una directiva de acceso almacenada.</span><span class="sxs-lookup"><span data-stu-id="71c3b-332">You can use logging and metrics tooobserve any spike in authentication failures due tooan outage in your SAS provider service or toohello inadvertent removal of a stored access policy.</span></span> <span data-ttu-id="71c3b-333">Vea hello [Blog del equipo de almacenamiento de Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) para obtener información adicional.</span><span class="sxs-lookup"><span data-stu-id="71c3b-333">See hello [Azure Storage Team Blog](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) for additional information.</span></span>

## <a name="sas-examples"></a><span data-ttu-id="71c3b-334">Ejemplos de SAS</span><span class="sxs-lookup"><span data-stu-id="71c3b-334">SAS examples</span></span>
<span data-ttu-id="71c3b-335">A continuación figuran algunos ejemplos de ambos tipos de firmas de acceso compartido, SAS de cuenta y SAS de servicio.</span><span class="sxs-lookup"><span data-stu-id="71c3b-335">Below are some examples of both types of shared access signatures, account SAS and service SAS.</span></span>

<span data-ttu-id="71c3b-336">toorun estos ejemplos de C#, necesita hello tooreference siguientes paquetes de NuGet en el proyecto:</span><span class="sxs-lookup"><span data-stu-id="71c3b-336">toorun these C# examples, you need tooreference hello following NuGet packages in your project:</span></span>

* <span data-ttu-id="71c3b-337">[Biblioteca de cliente de almacenamiento de Azure para .NET](http://www.nuget.org/packages/WindowsAzure.Storage), versión 6.x o posterior (toouse cuenta SAS).</span><span class="sxs-lookup"><span data-stu-id="71c3b-337">[Azure Storage Client Library for .NET](http://www.nuget.org/packages/WindowsAzure.Storage), version 6.x or later (toouse account SAS).</span></span>
* [<span data-ttu-id="71c3b-338">Azure Configuration Manager</span><span class="sxs-lookup"><span data-stu-id="71c3b-338">Azure Configuration Manager</span></span>](http://www.nuget.org/packages/Microsoft.WindowsAzure.ConfigurationManager)

<span data-ttu-id="71c3b-339">Para obtener ejemplos adicionales que muestran cómo toocreate y prueba una SAS, consulte [ejemplos de código de Azure para almacenamiento](https://azure.microsoft.com/documentation/samples/?service=storage).</span><span class="sxs-lookup"><span data-stu-id="71c3b-339">For additional examples that show how toocreate and test a SAS, see [Azure Code Samples for Storage](https://azure.microsoft.com/documentation/samples/?service=storage).</span></span>

### <a name="example-create-and-use-an-account-sas"></a><span data-ttu-id="71c3b-340">Ejemplo: Crear y utilizar una SAS de cuenta</span><span class="sxs-lookup"><span data-stu-id="71c3b-340">Example: Create and use an account SAS</span></span>
<span data-ttu-id="71c3b-341">Hello ejemplo de código siguiente crea una cuenta SA que es válida para hello Blob y servicios de archivos, y proporciona Hola permisos de cliente de lectura, escritura y permisos de lista de las API de nivel de servicio tooaccess.</span><span class="sxs-lookup"><span data-stu-id="71c3b-341">hello following code example creates an account SAS that is valid for hello Blob and File services, and gives hello client permissions read, write, and list permissions tooaccess service-level APIs.</span></span> <span data-ttu-id="71c3b-342">cuenta de Hello SAS restringe hello tooHTTPS de protocolo, por lo que solicitud Hola debe realizarse con HTTPS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-342">hello account SAS restricts hello protocol tooHTTPS, so hello request must be made with HTTPS.</span></span>

```csharp
static string GetAccountSASToken()
{
    // toocreate hello account SAS, you need toouse your shared key credentials. Modify for your account.
    const string ConnectionString = "DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key";
    CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConnectionString);

    // Create a new access policy for hello account.
    SharedAccessAccountPolicy policy = new SharedAccessAccountPolicy()
        {
            Permissions = SharedAccessAccountPermissions.Read | SharedAccessAccountPermissions.Write | SharedAccessAccountPermissions.List,
            Services = SharedAccessAccountServices.Blob | SharedAccessAccountServices.File,
            ResourceTypes = SharedAccessAccountResourceTypes.Service,
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Protocols = SharedAccessProtocol.HttpsOnly
        };

    // Return hello SAS token.
    return storageAccount.GetSharedAccessSignature(policy);
}
```

<span data-ttu-id="71c3b-343">toouse Hola cuenta SAS tooaccess el API de nivel de servicio para el servicio de Blob de hello, construir un objeto de cliente de Blob utilizando Hola SAS y Hola de punto de conexión de almacenamiento de blobs para su cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="71c3b-343">toouse hello account SAS tooaccess service-level APIs for hello Blob service, construct a Blob client object using hello SAS and hello Blob storage endpoint for your storage account.</span></span>

```csharp
static void UseAccountSAS(string sasToken)
{
    // Create new storage credentials using hello SAS token.
    StorageCredentials accountSAS = new StorageCredentials(sasToken);
    // Use these credentials and hello account name toocreate a Blob service client.
    CloudStorageAccount accountWithSAS = new CloudStorageAccount(accountSAS, "account-name", endpointSuffix: null, useHttps: true);
    CloudBlobClient blobClientWithSAS = accountWithSAS.CreateCloudBlobClient();

    // Now set hello service properties for hello Blob client created with hello SAS.
    blobClientWithSAS.SetServiceProperties(new ServiceProperties()
    {
        HourMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        MinuteMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        Logging = new LoggingProperties()
        {
            LoggingOperations = LoggingOperations.All,
            RetentionDays = 14,
            Version = "1.0"
        }
    });

    // hello permissions granted by hello account SAS also permit you tooretrieve service properties.
    ServiceProperties serviceProperties = blobClientWithSAS.GetServiceProperties();
    Console.WriteLine(serviceProperties.HourMetrics.MetricsLevel);
    Console.WriteLine(serviceProperties.HourMetrics.RetentionDays);
    Console.WriteLine(serviceProperties.HourMetrics.Version);
}
```

### <a name="example-create-a-stored-access-policy"></a><span data-ttu-id="71c3b-344">Ejemplo: Crear una directiva de acceso almacenada</span><span class="sxs-lookup"><span data-stu-id="71c3b-344">Example: Create a stored access policy</span></span>
<span data-ttu-id="71c3b-345">Hello código siguiente crea una directiva de acceso almacenada en un contenedor.</span><span class="sxs-lookup"><span data-stu-id="71c3b-345">hello following code creates a stored access policy on a container.</span></span> <span data-ttu-id="71c3b-346">Puede utilizar restricciones de toospecify de directivas de acceso de Hola para un servicio SAS en el contenedor de Hola o sus blobs.</span><span class="sxs-lookup"><span data-stu-id="71c3b-346">You can use hello access policy toospecify constraints for a service SAS on hello container or its blobs.</span></span>

```csharp
private static async Task CreateSharedAccessPolicyAsync(CloudBlobContainer container, string policyName)
{
    // Create a new shared access policy and define its constraints.
    // hello access policy provides create, write, read, list, and delete permissions.
    SharedAccessBlobPolicy sharedPolicy = new SharedAccessBlobPolicy()
    {
        // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
        // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
        SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
        Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.List |
            SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create | SharedAccessBlobPermissions.Delete
    };

    // Get hello container's existing permissions.
    BlobContainerPermissions permissions = await container.GetPermissionsAsync();

    // Add hello new policy toohello container's permissions, and set hello container's permissions.
    permissions.SharedAccessPolicies.Add(policyName, sharedPolicy);
    await container.SetPermissionsAsync(permissions);
}
```

### <a name="example-create-a-service-sas-on-a-container"></a><span data-ttu-id="71c3b-347">Ejemplo: Crear una SAS de servicio en un contenedor</span><span class="sxs-lookup"><span data-stu-id="71c3b-347">Example: Create a service SAS on a container</span></span>
<span data-ttu-id="71c3b-348">Hola siguiente código crea una SAS en un contenedor.</span><span class="sxs-lookup"><span data-stu-id="71c3b-348">hello following code creates a SAS on a container.</span></span> <span data-ttu-id="71c3b-349">Si se proporciona el nombre de Hola de una directiva de acceso almacenada existente, esa directiva está asociada con hello SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-349">If hello name of an existing stored access policy is provided, that policy is associated with hello SAS.</span></span> <span data-ttu-id="71c3b-350">Si no se proporciona ninguna directiva de acceso almacenada, código de hello crea una SAS de ad hoc en el contenedor de Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-350">If no stored access policy is provided, then hello code creates an ad-hoc SAS on hello container.</span></span>

```csharp
private static string GetContainerSasUri(CloudBlobContainer container, string storedPolicyName = null)
{
    string sasContainerToken;

    // If no stored policy is specified, create a new access policy and define its constraints.
    if (storedPolicyName == null)
    {
        // Note that hello SharedAccessBlobPolicy class is used both toodefine hello parameters of an ad-hoc SAS, and
        // tooconstruct a shared access policy that is saved toohello container's shared access policies.
        SharedAccessBlobPolicy adHocPolicy = new SharedAccessBlobPolicy()
        {
            // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
            // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.List
        };

        // Generate hello shared access signature on hello container, setting hello constraints directly on hello signature.
        sasContainerToken = container.GetSharedAccessSignature(adHocPolicy, null);

        Console.WriteLine("SAS for blob container (ad hoc): {0}", sasContainerToken);
        Console.WriteLine();
    }
    else
    {
        // Generate hello shared access signature on hello container. In this case, all of hello constraints for the
        // shared access signature are specified on hello stored access policy, which is provided by name.
        // It is also possible toospecify some constraints on an ad-hoc SAS and others on hello stored access policy.
        sasContainerToken = container.GetSharedAccessSignature(null, storedPolicyName);

        Console.WriteLine("SAS for blob container (stored access policy): {0}", sasContainerToken);
        Console.WriteLine();
    }

    // Return hello URI string for hello container, including hello SAS token.
    return container.Uri + sasContainerToken;
}
```

### <a name="example-create-a-service-sas-on-a-blob"></a><span data-ttu-id="71c3b-351">Ejemplo: Crear una SAS de servicio en un blob</span><span class="sxs-lookup"><span data-stu-id="71c3b-351">Example: Create a service SAS on a blob</span></span>
<span data-ttu-id="71c3b-352">Hola siguiente código crea una SAS en un blob.</span><span class="sxs-lookup"><span data-stu-id="71c3b-352">hello following code creates a SAS on a blob.</span></span> <span data-ttu-id="71c3b-353">Si se proporciona el nombre de Hola de una directiva de acceso almacenada existente, esa directiva está asociada con hello SAS.</span><span class="sxs-lookup"><span data-stu-id="71c3b-353">If hello name of an existing stored access policy is provided, that policy is associated with hello SAS.</span></span> <span data-ttu-id="71c3b-354">Si no se proporciona ninguna directiva de acceso almacenada, código de hello crea una SAS de ad hoc en blob Hola.</span><span class="sxs-lookup"><span data-stu-id="71c3b-354">If no stored access policy is provided, then hello code creates an ad-hoc SAS on hello blob.</span></span>

```csharp
private static string GetBlobSasUri(CloudBlobContainer container, string blobName, string policyName = null)
{
    string sasBlobToken;

    // Get a reference tooa blob within hello container.
    // Note that hello blob may not exist yet, but a SAS can still be created for it.
    CloudBlockBlob blob = container.GetBlockBlobReference(blobName);

    if (policyName == null)
    {
        // Create a new access policy and define its constraints.
        // Note that hello SharedAccessBlobPolicy class is used both toodefine hello parameters of an ad-hoc SAS, and
        // tooconstruct a shared access policy that is saved toohello container's shared access policies.
        SharedAccessBlobPolicy adHocSAS = new SharedAccessBlobPolicy()
        {
            // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
            // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create
        };

        // Generate hello shared access signature on hello blob, setting hello constraints directly on hello signature.
        sasBlobToken = blob.GetSharedAccessSignature(adHocSAS);

        Console.WriteLine("SAS for blob (ad hoc): {0}", sasBlobToken);
        Console.WriteLine();
    }
    else
    {
        // Generate hello shared access signature on hello blob. In this case, all of hello constraints for the
        // shared access signature are specified on hello container's stored access policy.
        sasBlobToken = blob.GetSharedAccessSignature(null, policyName);

        Console.WriteLine("SAS for blob (stored access policy): {0}", sasBlobToken);
        Console.WriteLine();
    }

    // Return hello URI string for hello container, including hello SAS token.
    return blob.Uri + sasBlobToken;
}
```

## <a name="conclusion"></a><span data-ttu-id="71c3b-355">Conclusión</span><span class="sxs-lookup"><span data-stu-id="71c3b-355">Conclusion</span></span>
<span data-ttu-id="71c3b-356">Firmas de acceso compartido son útiles para proporcionar permisos limitados tooclients de cuenta de almacenamiento de tooyour que no se debería tener la clave de la cuenta de hello.</span><span class="sxs-lookup"><span data-stu-id="71c3b-356">Shared access signatures are useful for providing limited permissions tooyour storage account tooclients that should not have hello account key.</span></span> <span data-ttu-id="71c3b-357">Por lo tanto, son una parte fundamental del modelo de seguridad de Hola para las aplicaciones que utilizan el almacenamiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="71c3b-357">As such, they are a vital part of hello security model for any application using Azure Storage.</span></span> <span data-ttu-id="71c3b-358">Si sigue los procedimientos recomendados de hello enumerados aquí, puede usar tooprovide mayor flexibilidad en SAS de acceso tooresources en su cuenta de almacenamiento, sin poner en peligro la seguridad de saludo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="71c3b-358">If you follow hello best practices listed here, you can use SAS tooprovide greater flexibility of access tooresources in your storage account, without compromising hello security of your application.</span></span>

## <a name="next-steps"></a><span data-ttu-id="71c3b-359">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="71c3b-359">Next Steps</span></span>
* [<span data-ttu-id="71c3b-360">Administrar blobs y acceso de lectura anónimo toocontainers</span><span class="sxs-lookup"><span data-stu-id="71c3b-360">Manage anonymous read access toocontainers and blobs</span></span>](storage-manage-access-to-resources.md)
* [<span data-ttu-id="71c3b-361">Delegación de acceso con una firma de acceso compartido</span><span class="sxs-lookup"><span data-stu-id="71c3b-361">Delegating Access with a Shared Access Signature</span></span>](http://msdn.microsoft.com/library/azure/ee395415.aspx)
* [<span data-ttu-id="71c3b-362">Introducción a las firmas de acceso compartido de tabla y cola</span><span class="sxs-lookup"><span data-stu-id="71c3b-362">Introducing Table and Queue SAS</span></span>](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-table-sas-shared-access-signature-queue-sas-and-update-to-blob-sas.aspx)

[sas-storage-fe-proxy-service]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-fe-proxy-service.png
[sas-storage-provider-service]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-provider-service.png
[sas-storage-uri]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-uri.png
