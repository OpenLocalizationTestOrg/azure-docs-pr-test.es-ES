---
title: aaaManaging simultaneidad en el almacenamiento de Azure de Microsoft
description: "¿Cómo toomanage simultaneidad para Hola servicios Blob, cola, tabla y archivo"
services: storage
documentationcenter: 
author: jasontang501
manager: tadb
editor: tysonn
ms.assetid: cc6429c4-23ee-46e3-b22d-50dd68bd4680
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 05/11/2017
ms.author: jasontang501
ms.openlocfilehash: 277fbbb880906da6be67b2267ed5c8e457455bd1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="managing-concurrency-in-microsoft-azure-storage"></a><span data-ttu-id="17734-103">Administración de la simultaneidad en Almacenamiento de Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="17734-103">Managing Concurrency in Microsoft Azure Storage</span></span>
## <a name="overview"></a><span data-ttu-id="17734-104">Información general</span><span class="sxs-lookup"><span data-stu-id="17734-104">Overview</span></span>
<span data-ttu-id="17734-105">Las aplicaciones modernas basadas en Internet, normalmente tienen varios usuarios que ven y actualizan datos simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="17734-105">Modern Internet based applications usually have multiple users viewing and updating data simultaneously.</span></span> <span data-ttu-id="17734-106">Para ello, toothink a los desarrolladores de aplicaciones con cuidado sobre cómo tooprovide una predicción experimentar los usuarios finales de tootheir, especialmente para escenarios donde pueden actualizar varios usuarios Hola mismo datos.</span><span class="sxs-lookup"><span data-stu-id="17734-106">This requires application developers toothink carefully about how tooprovide a predictable experience tootheir end users, particularly for scenarios where multiple users can update hello same data.</span></span> <span data-ttu-id="17734-107">Hay tres estrategias de simultaneidad de datos principales que normalmente tendrán en cuenta los desarrolladores:</span><span class="sxs-lookup"><span data-stu-id="17734-107">There are three main data concurrency strategies developers will typically consider:</span></span>  

1. <span data-ttu-id="17734-108">Simultaneidad optimista: última una aplicación para realizar una actualización como parte de su actualización comprobará si los datos de hello ha cambiado desde la aplicación hello lee esos datos.</span><span class="sxs-lookup"><span data-stu-id="17734-108">Optimistic concurrency – An application performing an update will as part of its update verify if hello data has changed since hello application last read that data.</span></span> <span data-ttu-id="17734-109">Por ejemplo, si dos usuarios ver una página wiki realizan un toohello actualización misma página, a continuación, debe asegurarse de que esa segunda actualización hello no sobrescribe la primera actualización hello: plataforma de wiki de Hola y de ambos usuarios comprenden si su actualización fue correcta o no.</span><span class="sxs-lookup"><span data-stu-id="17734-109">For example, if two users viewing a wiki page make an update toohello same page then hello wiki platform must ensure that hello second update does not overwrite hello first update – and that both users understand whether their update was successful or not.</span></span> <span data-ttu-id="17734-110">Esta estrategia se usa con más frecuencia en aplicaciones web.</span><span class="sxs-lookup"><span data-stu-id="17734-110">This strategy is most often used in web applications.</span></span>
2. <span data-ttu-id="17734-111">Simultaneidad pesimista: una aplicación busca tooperform una actualización tomará un bloqueo en un objeto para evitar que otros usuarios actualicen datos Hola hasta que se libere el bloqueo de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-111">Pessimistic concurrency – An application looking tooperform an update will take a lock on an object preventing other users from updating hello data until hello lock is released.</span></span> <span data-ttu-id="17734-112">Por ejemplo, en un escenario de replicación de datos maestro/esclavo donde llevará a cabo actualizaciones solo master Hola master Hola normalmente contendrá un bloqueo exclusivo para un período de tiempo en hello datos tooensure ningún otro usuario puede actualizarlo.</span><span class="sxs-lookup"><span data-stu-id="17734-112">For example, in a master/slave data replication scenario where only hello master will perform updates hello master will typically hold an exclusive lock for an extended period of time on hello data tooensure no one else can update it.</span></span>
3. <span data-ttu-id="17734-113">Último escritor gana: un método que le permita cualquier tooproceed de las operaciones de actualización sin comprobar si cualquier otra aplicación ha Hola datos actualizados desde la aplicación hello primero lectura datos Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-113">Last writer wins – An approach that allows any update operations tooproceed without verifying if any other application has updated hello data since hello application first read hello data.</span></span> <span data-ttu-id="17734-114">Esta estrategia (o la falta de una estrategia formal) suele utilizarse donde los datos se dividen de forma que no hay ninguna posibilidad de que varios usuarios tendrán acceso Hola mismos datos.</span><span class="sxs-lookup"><span data-stu-id="17734-114">This strategy (or lack of a formal strategy) is usually used where data is partitioned in such a way that there is no likelihood that multiple users will access hello same data.</span></span> <span data-ttu-id="17734-115">También puede resultar útil donde se procesen transmisiones de datos de corta duración.</span><span class="sxs-lookup"><span data-stu-id="17734-115">It can also be useful where short-lived data streams are being processed.</span></span>  

<span data-ttu-id="17734-116">Este artículo proporciona información general sobre la plataforma de almacenamiento de Azure Hola simplifica el desarrollo proporcionando soporte de primera clase para las tres de estas estrategias de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="17734-116">This article provides an overview of how hello Azure Storage platform simplifies development by providing first class support for all three of these concurrency strategies.</span></span>  

## <a name="azure-storage--simplifies-cloud-development"></a><span data-ttu-id="17734-117">Almacenamiento de Azure: simplificación del desarrollo en la nube</span><span class="sxs-lookup"><span data-stu-id="17734-117">Azure Storage – Simplifies Cloud Development</span></span>
<span data-ttu-id="17734-118">Hola servicio almacenamiento de Azure es compatible con todas las tres estrategias, aunque es distintivo en su capacidad tooprovide totalmente compatible con la simultaneidad optimista y pesimista porque se trataba de tooembrace diseñado un modelo de coherencia fuerte que garantiza que, cuando Hola confirmaciones de servicio de almacenamiento datos insertar o actualizar operación toothat más todos los accesos a datos verá Hola actualización más reciente.</span><span class="sxs-lookup"><span data-stu-id="17734-118">hello Azure storage service supports all three strategies, although it is distinctive in its ability tooprovide full support for optimistic and pessimistic concurrency because it was designed tooembrace a strong consistency model which guarantees that when hello Storage service commits a data insert or update operation all further accesses toothat data will see hello latest update.</span></span> <span data-ttu-id="17734-119">Plataformas de almacenamiento que utilizan un modelo de coherencia definitiva tienen un retraso entre cuando un usuario realiza una operación de escritura y cuando Hola actualiza datos pueden verse por otros usuarios, por tanto, lo que complica el desarrollo de aplicaciones de cliente en incoherencias de tooprevent de orden de que afectan a los usuarios finales.</span><span class="sxs-lookup"><span data-stu-id="17734-119">Storage platforms that use an eventual consistency model have a lag between when a write is performed by one user and when hello updated data can be seen by other users thus complicating development of client applications in order tooprevent inconsistencies from affecting end users.</span></span>  

<span data-ttu-id="17734-120">Además tooselecting una simultaneidad correcta estrategia los desarrolladores deben también tener en cuenta cómo una plataforma de almacenamiento aísla los cambios, especialmente los toohello cambios mismo objeto a través de las transacciones.</span><span class="sxs-lookup"><span data-stu-id="17734-120">In addition tooselecting an appropriate concurrency strategy developers should also be aware of how a storage platform isolates changes – particularly changes toohello same object across transactions.</span></span> <span data-ttu-id="17734-121">Hola servicio almacenamiento de Azure usa tooallow de aislamiento de instantánea leer operaciones toohappen simultáneamente con las operaciones de escritura en una única partición.</span><span class="sxs-lookup"><span data-stu-id="17734-121">hello Azure storage service uses snapshot isolation tooallow read operations toohappen concurrently with write operations within a single partition.</span></span> <span data-ttu-id="17734-122">A diferencia de otros niveles de aislamiento, el aislamiento de instantánea garantiza que todas las lecturas verán una instantánea coherente de los datos de hello incluso mientras se producen actualizaciones – básicamente devolviendo valores último confirmada de hello mientras se procesa una transacción de actualización.</span><span class="sxs-lookup"><span data-stu-id="17734-122">Unlike other isolation levels, snapshot isolation guarantees that all reads see a consistent snapshot of hello data even while updates are occurring – essentially by returning hello last committed values while an update transaction is being processed.</span></span>  

## <a name="managing-concurrency-in-blob-storage"></a><span data-ttu-id="17734-123">Administrar la simultaneidad en almacenamiento de blobs</span><span class="sxs-lookup"><span data-stu-id="17734-123">Managing Concurrency in Blob storage</span></span>
<span data-ttu-id="17734-124">Puede optar por toouse tanto modelos de simultaneidad optimista o pesimista toomanage acceso tooblobs y contenedores en Hola servicio blob.</span><span class="sxs-lookup"><span data-stu-id="17734-124">You can opt toouse either optimistic or pessimistic concurrency models toomanage access tooblobs and containers in hello blob service.</span></span> <span data-ttu-id="17734-125">Si no especifica explícitamente una estrategia de última escribe wins es el valor predeterminado de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-125">If you do not explicitly specify a strategy last writes wins is hello default.</span></span>  

### <a name="optimistic-concurrency-for-blobs-and-containers"></a><span data-ttu-id="17734-126">Simultaneidad optimista para blobs y contenedores</span><span class="sxs-lookup"><span data-stu-id="17734-126">Optimistic concurrency for blobs and containers</span></span>
<span data-ttu-id="17734-127">Hola servicio de almacenamiento asigna un objeto de tooevery identificador almacenado.</span><span class="sxs-lookup"><span data-stu-id="17734-127">hello Storage service assigns an identifier tooevery object stored.</span></span> <span data-ttu-id="17734-128">Este identificador se actualiza cada vez que se realiza una operación de actualización en un objeto.</span><span class="sxs-lookup"><span data-stu-id="17734-128">This identifier is updated every time an update operation is performed on an object.</span></span> <span data-ttu-id="17734-129">identificador de Hola se devuelve a toohello cliente como parte de una respuesta HTTP GET con encabezado de ETag (etiqueta de entidad) de Hola que se define en el protocolo de hello HTTP.</span><span class="sxs-lookup"><span data-stu-id="17734-129">hello identifier is returned toohello client as part of an HTTP GET response using hello ETag (entity tag) header that is defined within hello HTTP protocol.</span></span> <span data-ttu-id="17734-130">Un usuario para realizar una actualización de este tipo de objeto puede enviar en Hola ETag original junto con un tooensure encabezado condicional que una actualización sólo aparecerá si se cumple una determinada condición: en este caso condición hello es un encabezado de "If-Match" que requiere Hola almacenamiento Servicio tooensure Hola valo Hola ETag especificado en la solicitud de actualización de hello es Hola mismos que almacenan en hello servicio de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="17734-130">A user performing an update on such an object can send in hello original ETag along with a conditional header tooensure that an update will only occur if a certain condition has been met – in this case hello condition is an "If-Match" header which requires hello Storage Service tooensure hello value of hello ETag specified in hello update request is hello same as that stored in hello Storage Service.</span></span>  

<span data-ttu-id="17734-131">esquema de Hola de este proceso es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="17734-131">hello outline of this process is as follows:</span></span>  

1. <span data-ttu-id="17734-132">Recuperar un blob del servicio de almacenamiento de hello, respuesta de hello incluye un valor de encabezado de ETag de HTTP que identifica la versión actual de hello del objeto de hello en el servicio de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-132">Retrieve a blob from hello storage service, hello response includes an HTTP ETag Header value that identifies hello current version of hello object in hello storage service.</span></span>
2. <span data-ttu-id="17734-133">Cuando se actualiza el blob de hello, incluir el valor de ETag de Hola que recibió en el paso 1 en hello **If-Match** condicional encabezado de solicitud de hello enviar toohello servicio.</span><span class="sxs-lookup"><span data-stu-id="17734-133">When you update hello blob, include hello ETag value you received in step 1 in hello **If-Match** conditional header of hello request you send toohello service.</span></span>
3. <span data-ttu-id="17734-134">servicio de Hello compara el valor de ETag de hello en solicitud de hello con valor de ETag actual de Hola de blob de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-134">hello service compares hello ETag value in hello request with hello current ETag value of hello blob.</span></span>
4. <span data-ttu-id="17734-135">Si valor de ETag actual de Hola de blob de hello es una versión diferente de Hola ETag en hello **If-Match** encabezado condicional en solicitud de hello, servicio de hello devuelve un cliente de toohello 412 error.</span><span class="sxs-lookup"><span data-stu-id="17734-135">If hello current ETag value of hello blob is a different version than hello ETag in hello **If-Match** conditional header in hello request, hello service returns a 412 error toohello client.</span></span> <span data-ttu-id="17734-136">Esto indica que otro proceso ha actualizado el blob de Hola desde cliente Hola recuperó de cliente de toohello.</span><span class="sxs-lookup"><span data-stu-id="17734-136">This indicates toohello client that another process has updated hello blob since hello client retrieved it.</span></span>
5. <span data-ttu-id="17734-137">Si Hola actual ETag es el valor del blob de Hola Hola misma versión que Hola ETag en hello **If-Match** realiza condicional encabezado de solicitud de hello, servicio de Hola Hola solicitó la operación y las actualizaciones de Hola el valor ETag actual de blob de Hola tooshow que ha creado una nueva versión.</span><span class="sxs-lookup"><span data-stu-id="17734-137">If hello current ETag value of hello blob is hello same version as hello ETag in hello **If-Match** conditional header in hello request, hello service performs hello requested operation and updates hello current ETag value of hello blob tooshow that it has created a new version.</span></span>  

<span data-ttu-id="17734-138">Hello siguiente fragmento de C# (mediante la biblioteca de cliente de almacenamiento 4.2.0 Hola) muestra un ejemplo sencillo de cómo tooconstruct una **AccessCondition If-Match** según Hola valor ETag que se obtiene acceso desde propiedades Hola de un blob que estaba previamente recuperados o insertado.</span><span class="sxs-lookup"><span data-stu-id="17734-138">hello following C# snippet (using hello Client Storage Library 4.2.0) shows a simple example of how tooconstruct an **If-Match AccessCondition** based on hello ETag value that is accessed from hello properties of a blob that was previously either retrieved or inserted.</span></span> <span data-ttu-id="17734-139">A continuación, utiliza hello **AccessCondition** objeto cuando se actualiza el blob de hello: Hola **AccessCondition** objeto agrega hello **If-Match** solicitud toohello de encabezado.</span><span class="sxs-lookup"><span data-stu-id="17734-139">It then uses hello **AccessCondition** object when it updating hello blob: hello **AccessCondition** object adds hello **If-Match** header toohello request.</span></span> <span data-ttu-id="17734-140">Si otro proceso ha actualizado el blob de hello, servicio de blob de hello devuelve un mensaje de estado 412 de HTTP (error de condición previa).</span><span class="sxs-lookup"><span data-stu-id="17734-140">If another process has updated hello blob, hello blob service returns an HTTP 412 (Precondition Failed) status message.</span></span> <span data-ttu-id="17734-141">Puede descargar aquí completo ejemplo hello: [administración de simultaneidad con el almacenamiento de Azure](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span><span class="sxs-lookup"><span data-stu-id="17734-141">You can download hello full sample here: [Managing Concurrency using Azure Storage](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span></span>  

```csharp
// Retrieve hello ETag from hello newly created blob
// Etag is already populated as UploadText should cause a PUT Blob call
// toostorage blob service which returns hello etag in response.
string orignalETag = blockBlob.Properties.ETag;

// This code simulates an update by a third party.
string helloText = "Blob updated by a third party.";

// No etag, provided so orignal blob is overwritten (thus generating a new etag)
blockBlob.UploadText(helloText);
Console.WriteLine("Blob updated. Updated ETag = {0}",
blockBlob.Properties.ETag);

// Now try tooupdate hello blob using hello orignal ETag provided when hello blob was created
try
{
    Console.WriteLine("Trying tooupdate blob using orignal etag toogenerate if-match access condition");
    blockBlob.UploadText(helloText,accessCondition:
    AccessCondition.GenerateIfMatchCondition(orignalETag));
}
catch (StorageException ex)
{
    if (ex.RequestInformation.HttpStatusCode == (int)HttpStatusCode.PreconditionFailed)
    {
        Console.WriteLine("Precondition failure as expected. Blob's orignal etag no longer matches");
        // TODO: client can decide on how it wants toohandle hello 3rd party updated content.
    }
    else
        throw;
}  
```

<span data-ttu-id="17734-142">Hola servicio de almacenamiento también incluye compatibilidad para encabezados condicionales adicionales como **If-Modified-Since**, **If-Unmodified-Since** y **If-None-Match** como combinaciones de los mismos.</span><span class="sxs-lookup"><span data-stu-id="17734-142">hello Storage Service also includes support for additional conditional headers such as **If-Modified-Since**, **If-Unmodified-Since** and **If-None-Match** as well as combinations thereof.</span></span> <span data-ttu-id="17734-143">Para obtener más información, consulte [Especificar encabezados condicionales para las operaciones del servicio BLOB](http://msdn.microsoft.com/library/azure/dd179371.aspx) en MSDN.</span><span class="sxs-lookup"><span data-stu-id="17734-143">For more information see [Specifying Conditional Headers for Blob Service Operations](http://msdn.microsoft.com/library/azure/dd179371.aspx) on MSDN.</span></span>  

<span data-ttu-id="17734-144">Hello tabla siguiente resumen las operaciones de contenedor de Hola que aceptan como encabezados condicionales **If-Match** en solicitud de Hola y que devuelven un valor de ETag en la respuesta de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-144">hello following table summarizes hello container operations that accept conditional headers such as **If-Match** in hello request and that return an ETag value in hello response.</span></span>  

| <span data-ttu-id="17734-145">Operación</span><span class="sxs-lookup"><span data-stu-id="17734-145">Operation</span></span> | <span data-ttu-id="17734-146">Devuelve el valor ETag del contenedor</span><span class="sxs-lookup"><span data-stu-id="17734-146">Returns Container ETag value</span></span> | <span data-ttu-id="17734-147">Acepta encabezados condicionales</span><span class="sxs-lookup"><span data-stu-id="17734-147">Accepts conditional headers</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="17734-148">Create Container</span><span class="sxs-lookup"><span data-stu-id="17734-148">Create Container</span></span> |<span data-ttu-id="17734-149">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-149">Yes</span></span> |<span data-ttu-id="17734-150">No</span><span class="sxs-lookup"><span data-stu-id="17734-150">No</span></span> |
| <span data-ttu-id="17734-151">Get Container Properties</span><span class="sxs-lookup"><span data-stu-id="17734-151">Get Container Properties</span></span> |<span data-ttu-id="17734-152">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-152">Yes</span></span> |<span data-ttu-id="17734-153">No</span><span class="sxs-lookup"><span data-stu-id="17734-153">No</span></span> |
| <span data-ttu-id="17734-154">Get Container Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-154">Get Container Metadata</span></span> |<span data-ttu-id="17734-155">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-155">Yes</span></span> |<span data-ttu-id="17734-156">No</span><span class="sxs-lookup"><span data-stu-id="17734-156">No</span></span> |
| <span data-ttu-id="17734-157">Set Container Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-157">Set Container Metadata</span></span> |<span data-ttu-id="17734-158">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-158">Yes</span></span> |<span data-ttu-id="17734-159">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-159">Yes</span></span> |
| <span data-ttu-id="17734-160">Get Container ACL</span><span class="sxs-lookup"><span data-stu-id="17734-160">Get Container ACL</span></span> |<span data-ttu-id="17734-161">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-161">Yes</span></span> |<span data-ttu-id="17734-162">No</span><span class="sxs-lookup"><span data-stu-id="17734-162">No</span></span> |
| <span data-ttu-id="17734-163">Set Container ACL</span><span class="sxs-lookup"><span data-stu-id="17734-163">Set Container ACL</span></span> |<span data-ttu-id="17734-164">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-164">Yes</span></span> |<span data-ttu-id="17734-165">Sí (*)</span><span class="sxs-lookup"><span data-stu-id="17734-165">Yes (*)</span></span> |
| <span data-ttu-id="17734-166">Delete Container</span><span class="sxs-lookup"><span data-stu-id="17734-166">Delete Container</span></span> |<span data-ttu-id="17734-167">No</span><span class="sxs-lookup"><span data-stu-id="17734-167">No</span></span> |<span data-ttu-id="17734-168">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-168">Yes</span></span> |
| <span data-ttu-id="17734-169">Lease Container</span><span class="sxs-lookup"><span data-stu-id="17734-169">Lease Container</span></span> |<span data-ttu-id="17734-170">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-170">Yes</span></span> |<span data-ttu-id="17734-171">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-171">Yes</span></span> |
| <span data-ttu-id="17734-172">List Blobs</span><span class="sxs-lookup"><span data-stu-id="17734-172">List Blobs</span></span> |<span data-ttu-id="17734-173">No</span><span class="sxs-lookup"><span data-stu-id="17734-173">No</span></span> |<span data-ttu-id="17734-174">No</span><span class="sxs-lookup"><span data-stu-id="17734-174">No</span></span> |

<span data-ttu-id="17734-175">permisos de hello (*) definidos por SetContainerACL se almacenan en caché y las actualizaciones toothese permisos tarden 30 segundos toopropagate durante el periodo del que las actualizaciones no están garantiza toobe coherente.</span><span class="sxs-lookup"><span data-stu-id="17734-175">(*) hello permissions defined by SetContainerACL are cached and updates toothese permissions take 30 seconds toopropagate during which period updates are not guaranteed toobe consistent.</span></span>  

<span data-ttu-id="17734-176">Hello tabla siguiente resumen las operaciones de blob de Hola que aceptan como encabezados condicionales **If-Match** en solicitud de Hola y que devuelven un valor de ETag en la respuesta de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-176">hello following table summarizes hello blob operations that accept conditional headers such as **If-Match** in hello request and that return an ETag value in hello response.</span></span>

| <span data-ttu-id="17734-177">Operación</span><span class="sxs-lookup"><span data-stu-id="17734-177">Operation</span></span> | <span data-ttu-id="17734-178">Devuelve el valor ETag</span><span class="sxs-lookup"><span data-stu-id="17734-178">Returns ETag value</span></span> | <span data-ttu-id="17734-179">Acepta encabezados condicionales</span><span class="sxs-lookup"><span data-stu-id="17734-179">Accepts conditional headers</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="17734-180">Put Blob</span><span class="sxs-lookup"><span data-stu-id="17734-180">Put Blob</span></span> |<span data-ttu-id="17734-181">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-181">Yes</span></span> |<span data-ttu-id="17734-182">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-182">Yes</span></span> |
| <span data-ttu-id="17734-183">Get Blob</span><span class="sxs-lookup"><span data-stu-id="17734-183">Get Blob</span></span> |<span data-ttu-id="17734-184">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-184">Yes</span></span> |<span data-ttu-id="17734-185">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-185">Yes</span></span> |
| <span data-ttu-id="17734-186">Get Blob Properties</span><span class="sxs-lookup"><span data-stu-id="17734-186">Get Blob Properties</span></span> |<span data-ttu-id="17734-187">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-187">Yes</span></span> |<span data-ttu-id="17734-188">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-188">Yes</span></span> |
| <span data-ttu-id="17734-189">Set Blob Properties</span><span class="sxs-lookup"><span data-stu-id="17734-189">Set Blob Properties</span></span> |<span data-ttu-id="17734-190">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-190">Yes</span></span> |<span data-ttu-id="17734-191">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-191">Yes</span></span> |
| <span data-ttu-id="17734-192">Get Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-192">Get Blob Metadata</span></span> |<span data-ttu-id="17734-193">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-193">Yes</span></span> |<span data-ttu-id="17734-194">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-194">Yes</span></span> |
| <span data-ttu-id="17734-195">Set Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-195">Set Blob Metadata</span></span> |<span data-ttu-id="17734-196">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-196">Yes</span></span> |<span data-ttu-id="17734-197">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-197">Yes</span></span> |
| <span data-ttu-id="17734-198">Lease Blob (*)</span><span class="sxs-lookup"><span data-stu-id="17734-198">Lease Blob (*)</span></span> |<span data-ttu-id="17734-199">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-199">Yes</span></span> |<span data-ttu-id="17734-200">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-200">Yes</span></span> |
| <span data-ttu-id="17734-201">Instantánea de blob</span><span class="sxs-lookup"><span data-stu-id="17734-201">Snapshot Blob</span></span> |<span data-ttu-id="17734-202">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-202">Yes</span></span> |<span data-ttu-id="17734-203">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-203">Yes</span></span> |
| <span data-ttu-id="17734-204">Copia de blobs</span><span class="sxs-lookup"><span data-stu-id="17734-204">Copy Blob</span></span> |<span data-ttu-id="17734-205">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-205">Yes</span></span> |<span data-ttu-id="17734-206">Sí (para blob de origen y destino)</span><span class="sxs-lookup"><span data-stu-id="17734-206">Yes (for source and destination blob)</span></span> |
| <span data-ttu-id="17734-207">Abort Copy Blob</span><span class="sxs-lookup"><span data-stu-id="17734-207">Abort Copy Blob</span></span> |<span data-ttu-id="17734-208">No</span><span class="sxs-lookup"><span data-stu-id="17734-208">No</span></span> |<span data-ttu-id="17734-209">No</span><span class="sxs-lookup"><span data-stu-id="17734-209">No</span></span> |
| <span data-ttu-id="17734-210">Delete Blob</span><span class="sxs-lookup"><span data-stu-id="17734-210">Delete Blob</span></span> |<span data-ttu-id="17734-211">No</span><span class="sxs-lookup"><span data-stu-id="17734-211">No</span></span> |<span data-ttu-id="17734-212">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-212">Yes</span></span> |
| <span data-ttu-id="17734-213">Put Block</span><span class="sxs-lookup"><span data-stu-id="17734-213">Put Block</span></span> |<span data-ttu-id="17734-214">No</span><span class="sxs-lookup"><span data-stu-id="17734-214">No</span></span> |<span data-ttu-id="17734-215">No</span><span class="sxs-lookup"><span data-stu-id="17734-215">No</span></span> |
| <span data-ttu-id="17734-216">Put Block List</span><span class="sxs-lookup"><span data-stu-id="17734-216">Put Block List</span></span> |<span data-ttu-id="17734-217">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-217">Yes</span></span> |<span data-ttu-id="17734-218">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-218">Yes</span></span> |
| <span data-ttu-id="17734-219">Get Block List</span><span class="sxs-lookup"><span data-stu-id="17734-219">Get Block List</span></span> |<span data-ttu-id="17734-220">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-220">Yes</span></span> |<span data-ttu-id="17734-221">No</span><span class="sxs-lookup"><span data-stu-id="17734-221">No</span></span> |
| <span data-ttu-id="17734-222">Put Page</span><span class="sxs-lookup"><span data-stu-id="17734-222">Put Page</span></span> |<span data-ttu-id="17734-223">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-223">Yes</span></span> |<span data-ttu-id="17734-224">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-224">Yes</span></span> |
| <span data-ttu-id="17734-225">Get Page Ranges</span><span class="sxs-lookup"><span data-stu-id="17734-225">Get Page Ranges</span></span> |<span data-ttu-id="17734-226">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-226">Yes</span></span> |<span data-ttu-id="17734-227">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-227">Yes</span></span> |

<span data-ttu-id="17734-228">(*) Blob de concesión no cambia Hola ETag en un blob.</span><span class="sxs-lookup"><span data-stu-id="17734-228">(*) Lease Blob does not change hello ETag on a blob.</span></span>  

### <a name="pessimistic-concurrency-for-blobs"></a><span data-ttu-id="17734-229">Simultaneidad pesimista para blobs</span><span class="sxs-lookup"><span data-stu-id="17734-229">Pessimistic concurrency for blobs</span></span>
<span data-ttu-id="17734-230">toolock un blob para uso exclusivo, puede adquirir un [concesión](http://msdn.microsoft.com/library/azure/ee691972.aspx) en él.</span><span class="sxs-lookup"><span data-stu-id="17734-230">toolock a blob for exclusive use, you can acquire a [lease](http://msdn.microsoft.com/library/azure/ee691972.aspx) on it.</span></span> <span data-ttu-id="17734-231">Al adquirir una concesión, se especifica durante cuánto tiempo necesita Hola concesión: puede ser de entre 15 segundos de too60 o infinito qué cantidades tooan un bloqueo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="17734-231">When you acquire a lease, you specify for how long you need hello lease: this can be for between 15 too60 seconds or infinite which amounts tooan exclusive lock.</span></span> <span data-ttu-id="17734-232">Puede renovar una tooextend de concesión finito y puede liberar cualquier concesión cuando haya terminado con él.</span><span class="sxs-lookup"><span data-stu-id="17734-232">You can renew a finite lease tooextend it, and you can release any lease when you are finished with it.</span></span> <span data-ttu-id="17734-233">servicio de blob de Hello libera automáticamente concesiones finitos cuando expiran.</span><span class="sxs-lookup"><span data-stu-id="17734-233">hello blob service automatically releases finite leases when they expire.</span></span>  

<span data-ttu-id="17734-234">Concesiones de habilitar la sincronización diferentes estrategias toobe admitido, incluidos exclusivo de escritura / comparten lectura, exclusivo de escritura / exclusivo de lectura y compartido de escritura / lectura exclusivo.</span><span class="sxs-lookup"><span data-stu-id="17734-234">Leases enable different synchronization strategies toobe supported, including exclusive write / shared read, exclusive write / exclusive read and shared write / exclusive read.</span></span> <span data-ttu-id="17734-235">Cuando existe una concesión de servicio de almacenamiento de Hola exige exclusivo de escritura (put, defina y las operaciones de eliminación) sin embargo garantizar la exclusividad de las operaciones de lectura requiere Hola developer tooensure que todas las aplicaciones cliente usar un identificador de concesión y que solo un cliente a la vez tiene un identificador de concesión válido.</span><span class="sxs-lookup"><span data-stu-id="17734-235">Where a lease exists hello storage service enforces exclusive writes (put, set and delete operations) however ensuring exclusivity for read operations requires hello developer tooensure that all client applications use a lease ID and that only one client at a time has a valid lease ID.</span></span> <span data-ttu-id="17734-236">Las operaciones de lectura que no incluyen un identificador de concesión, dan lugar a lecturas compartidas.</span><span class="sxs-lookup"><span data-stu-id="17734-236">Read operations that do not include a lease ID result in shared reads.</span></span>  

<span data-ttu-id="17734-237">Hello fragmento de C# siguiente muestra un ejemplo de adquirir una concesión exclusiva durante 30 segundos en un blob, actualizar el contenido de Hola de blob de hello y, a continuación, liberar la concesión de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-237">hello following C# snippet shows an example of acquiring an exclusive lease for 30 seconds on a blob, updating hello content of hello blob, and then releasing hello lease.</span></span> <span data-ttu-id="17734-238">Si ya hay una concesión válido en el blob de hello cuando intente tooacquire una nueva concesión, el servicio de blob de hello devuelve un resultado de estado de "HTTP (409) conflicto".</span><span class="sxs-lookup"><span data-stu-id="17734-238">If there is already a valid lease on hello blob when you try tooacquire a new lease, hello blob service returns an "HTTP (409) Conflict" status result.</span></span> <span data-ttu-id="17734-239">fragmento de código de Hello a continuación usa un **AccessCondition** tooencapsulate Hola concesión información del objeto al realizar un blob de hello tooupdate de solicitud de servicio de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-239">hello snippet below uses an **AccessCondition** object tooencapsulate hello lease information when it makes a request tooupdate hello blob in hello storage service.</span></span>  <span data-ttu-id="17734-240">Puede descargar aquí completo ejemplo hello: [administración de simultaneidad con el almacenamiento de Azure](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span><span class="sxs-lookup"><span data-stu-id="17734-240">You can download hello full sample here: [Managing Concurrency using Azure Storage](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span></span>

```csharp
// Acquire lease for 15 seconds
string lease = blockBlob.AcquireLease(TimeSpan.FromSeconds(15), null);
Console.WriteLine("Blob lease acquired. Lease = {0}", lease);

// Update blob using lease. This operation will succeed
const string helloText = "Blob updated";
var accessCondition = AccessCondition.GenerateLeaseCondition(lease);
blockBlob.UploadText(helloText, accessCondition: accessCondition);
Console.WriteLine("Blob updated using an exclusive lease");

//Simulate third party update tooblob without lease
try
{
    // Below operation will fail as no valid lease provided
    Console.WriteLine("Trying tooupdate blob without valid lease");
    blockBlob.UploadText("Update without lease, will fail");
}
catch (StorageException ex)
{
    if (ex.RequestInformation.HttpStatusCode == (int)HttpStatusCode.PreconditionFailed)
        Console.WriteLine("Precondition failure as expected. Blob's lease does not match");
    else
        throw;
}  
```

<span data-ttu-id="17734-241">Si trata de una operación de escritura en un blob en concesión sin pasar un identificador de concesión de hello, se produce un error en la solicitud de Hola con un error 412.</span><span class="sxs-lookup"><span data-stu-id="17734-241">If you attempt a write operation on a leased blob without passing hello lease ID, hello request fails with a 412 error.</span></span> <span data-ttu-id="17734-242">Tenga en cuenta que si hello concesión expira antes de llamar a hello **UploadText** método pero seguir pasando identificador de concesión de hello, Hola solicitud también produce un error con un **412** error.</span><span class="sxs-lookup"><span data-stu-id="17734-242">Note that if hello lease expires before calling hello **UploadText** method but you still pass hello lease ID, hello request also fails with a **412** error.</span></span> <span data-ttu-id="17734-243">Para obtener más información acerca de cómo administrar los tiempos de expiración de concesión e identificadores de concesión, vea hello [Lease Blob](http://msdn.microsoft.com/library/azure/ee691972.aspx) documentación de REST.</span><span class="sxs-lookup"><span data-stu-id="17734-243">For more information about managing lease expiry times and lease ids, see hello [Lease Blob](http://msdn.microsoft.com/library/azure/ee691972.aspx) REST documentation.</span></span>  

<span data-ttu-id="17734-244">Hello siguientes operaciones de blob pueden usar simultaneidad pesimista de concesiones toomanage:</span><span class="sxs-lookup"><span data-stu-id="17734-244">hello following blob operations can use leases toomanage pessimistic concurrency:</span></span>  

* <span data-ttu-id="17734-245">Put Blob</span><span class="sxs-lookup"><span data-stu-id="17734-245">Put Blob</span></span>
* <span data-ttu-id="17734-246">Get Blob</span><span class="sxs-lookup"><span data-stu-id="17734-246">Get Blob</span></span>
* <span data-ttu-id="17734-247">Get Blob Properties</span><span class="sxs-lookup"><span data-stu-id="17734-247">Get Blob Properties</span></span>
* <span data-ttu-id="17734-248">Set Blob Properties</span><span class="sxs-lookup"><span data-stu-id="17734-248">Set Blob Properties</span></span>
* <span data-ttu-id="17734-249">Get Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-249">Get Blob Metadata</span></span>
* <span data-ttu-id="17734-250">Set Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-250">Set Blob Metadata</span></span>
* <span data-ttu-id="17734-251">Delete Blob</span><span class="sxs-lookup"><span data-stu-id="17734-251">Delete Blob</span></span>
* <span data-ttu-id="17734-252">Put Block</span><span class="sxs-lookup"><span data-stu-id="17734-252">Put Block</span></span>
* <span data-ttu-id="17734-253">Put Block List</span><span class="sxs-lookup"><span data-stu-id="17734-253">Put Block List</span></span>
* <span data-ttu-id="17734-254">Get Block List</span><span class="sxs-lookup"><span data-stu-id="17734-254">Get Block List</span></span>
* <span data-ttu-id="17734-255">Put Page</span><span class="sxs-lookup"><span data-stu-id="17734-255">Put Page</span></span>
* <span data-ttu-id="17734-256">Get Page Ranges</span><span class="sxs-lookup"><span data-stu-id="17734-256">Get Page Ranges</span></span>
* <span data-ttu-id="17734-257">Snapshot Blob (identificador de concesión opcional si existe una concesión)</span><span class="sxs-lookup"><span data-stu-id="17734-257">Snapshot Blob - lease ID optional if a lease exists</span></span>
* <span data-ttu-id="17734-258">Identificador de concesión de Blob de copia; necesarios si existe una concesión de blob de destino de Hola</span><span class="sxs-lookup"><span data-stu-id="17734-258">Copy Blob - lease ID required if a lease exists on hello destination blob</span></span>
* <span data-ttu-id="17734-259">Abort Copy Blob - identificador de concesión necesario si existe una concesión infinita en blob de destino de Hola</span><span class="sxs-lookup"><span data-stu-id="17734-259">Abort Copy Blob - lease ID required if an infinite lease exists on hello destination blob</span></span>
* <span data-ttu-id="17734-260">Lease Blob</span><span class="sxs-lookup"><span data-stu-id="17734-260">Lease Blob</span></span>  

### <a name="pessimistic-concurrency-for-containers"></a><span data-ttu-id="17734-261">Simultaneidad pesimista para contenedores</span><span class="sxs-lookup"><span data-stu-id="17734-261">Pessimistic concurrency for containers</span></span>
<span data-ttu-id="17734-262">Concesiones en contenedores habilitar Hola admite la misma toobe de estrategias de sincronización como en blobs (exclusivo de escritura / compartido lectura, exclusivo de escritura / exclusivo de lectura y compartido de escritura / lectura exclusivo) sin embargo a diferencia de los blobs de servicio de almacenamiento de hello solo exige exclusividad en las operaciones de eliminación.</span><span class="sxs-lookup"><span data-stu-id="17734-262">Leases on containers enable hello same synchronization strategies toobe supported as on blobs (exclusive write / shared read, exclusive write / exclusive read and shared write / exclusive read) however unlike blobs hello storage service only enforces exclusivity on delete operations.</span></span> <span data-ttu-id="17734-263">toodelete un contenedor con una concesión activa, un cliente debe incluir el identificador de concesión activa de hello en solicitud de eliminación de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-263">toodelete a container with an active lease, a client must include hello active lease ID with hello delete request.</span></span> <span data-ttu-id="17734-264">Todas las demás operaciones de contenedor correctamente en un contenedor de concesión sin necesidad de incluir el identificador de concesión de hello en cuyo caso se comparten las operaciones.</span><span class="sxs-lookup"><span data-stu-id="17734-264">All other container operations succeed on a leased container without including hello lease ID in which case they are shared operations.</span></span> <span data-ttu-id="17734-265">Si la exclusividad de la actualización (poner o establecer) o las operaciones de lectura son obligatorias, entonces los desarrolladores deben garantizar que todos los clientes usan un identificador de concesión y que solamente un cliente tiene un identificador de concesión válido en cada momento.</span><span class="sxs-lookup"><span data-stu-id="17734-265">If exclusivity of update (put or set) or read operations is required then developers should ensure all clients use a lease ID and that only one client at a time has a valid lease ID.</span></span>  

<span data-ttu-id="17734-266">Hello siguientes operaciones de contenedor pueden usar simultaneidad pesimista de concesiones toomanage:</span><span class="sxs-lookup"><span data-stu-id="17734-266">hello following container operations can use leases toomanage pessimistic concurrency:</span></span>  

* <span data-ttu-id="17734-267">Delete Container</span><span class="sxs-lookup"><span data-stu-id="17734-267">Delete Container</span></span>
* <span data-ttu-id="17734-268">Get Container Properties</span><span class="sxs-lookup"><span data-stu-id="17734-268">Get Container Properties</span></span>
* <span data-ttu-id="17734-269">Get Container Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-269">Get Container Metadata</span></span>
* <span data-ttu-id="17734-270">Set Container Metadata</span><span class="sxs-lookup"><span data-stu-id="17734-270">Set Container Metadata</span></span>
* <span data-ttu-id="17734-271">Get Container ACL</span><span class="sxs-lookup"><span data-stu-id="17734-271">Get Container ACL</span></span>
* <span data-ttu-id="17734-272">Set Container ACL</span><span class="sxs-lookup"><span data-stu-id="17734-272">Set Container ACL</span></span>
* <span data-ttu-id="17734-273">Lease Container</span><span class="sxs-lookup"><span data-stu-id="17734-273">Lease Container</span></span>  

<span data-ttu-id="17734-274">Para obtener más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="17734-274">For more information see:</span></span>  

* [<span data-ttu-id="17734-275">Especificar encabezados condicionales para las operaciones del servicio BLOB</span><span class="sxs-lookup"><span data-stu-id="17734-275">Specifying Conditional Headers for Blob Service Operations</span></span>](http://msdn.microsoft.com/library/azure/dd179371.aspx)
* [<span data-ttu-id="17734-276">Lease Container</span><span class="sxs-lookup"><span data-stu-id="17734-276">Lease Container</span></span>](http://msdn.microsoft.com/library/azure/jj159103.aspx)
* [<span data-ttu-id="17734-277">Concesiones de blob </span><span class="sxs-lookup"><span data-stu-id="17734-277">Lease Blob </span></span>](http://msdn.microsoft.com/library/azure/ee691972.aspx)

## <a name="managing-concurrency-in-hello-table-service"></a><span data-ttu-id="17734-278">Administrar la simultaneidad en hello servicio tabla</span><span class="sxs-lookup"><span data-stu-id="17734-278">Managing Concurrency in hello Table Service</span></span>
<span data-ttu-id="17734-279">servicio de la tabla de Hello usa optimista de simultaneidad se comprueba como comportamiento predeterminado de hello cuando se trabaja con entidades, a diferencia del servicio de blob de hello en el que debe elegir explícitamente tooperform comprobaciones de simultaneidad optimista.</span><span class="sxs-lookup"><span data-stu-id="17734-279">hello table service uses optimistic concurrency checks as hello default behavior when you are working with entities, unlike hello blob service where you must explicitly choose tooperform optimistic concurrency checks.</span></span> <span data-ttu-id="17734-280">Hola otra diferencia entre los servicios de tabla y blob de hello es que sólo se puede administrar comportamiento de simultaneidad de Hola de entidades, mientras que con el servicio de blobs de hello puede administrar la simultaneidad de Hola de contenedores y blobs.</span><span class="sxs-lookup"><span data-stu-id="17734-280">hello other difference between hello table and blob services is that you can only manage hello concurrency behavior of entities whereas with hello blob service you can manage hello concurrency of both containers and blobs.</span></span>  

<span data-ttu-id="17734-281">simultaneidad optimista toouse y toocheck si otro proceso modifica una entidad porque se recuperan del servicio de almacenamiento de tabla de Hola, puede usar el valor de ETag Hola que recibirá cuando el servicio de la tabla de hello devuelve una entidad.</span><span class="sxs-lookup"><span data-stu-id="17734-281">toouse optimistic concurrency and toocheck if another process modified an entity since you retrieved it from hello table storage service, you can use hello ETag value you receive when hello table service returns an entity.</span></span> <span data-ttu-id="17734-282">esquema de Hola de este proceso es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="17734-282">hello outline of this process is as follows:</span></span>  

1. <span data-ttu-id="17734-283">Recuperar una entidad de servicio de almacenamiento de tabla de hello, respuesta de hello incluye un valor de ETag que identifica el identificador del actual Hola asociada a esa entidad en el servicio de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-283">Retrieve an entity from hello table storage service, hello response includes an ETag value that identifies hello current identifier associated with that entity in hello storage service.</span></span>
2. <span data-ttu-id="17734-284">Cuando se actualiza la entidad de hello, incluir el valor de ETag de Hola que recibió en el paso 1 en hello obligatorio **If-Match** encabezado de solicitud de hello enviar toohello servicio.</span><span class="sxs-lookup"><span data-stu-id="17734-284">When you update hello entity, include hello ETag value you received in step 1 in hello mandatory **If-Match** header of hello request you send toohello service.</span></span>
3. <span data-ttu-id="17734-285">servicio de Hello compara el valor de ETag de hello en solicitud de hello con valor de ETag actual de Hola de entidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-285">hello service compares hello ETag value in hello request with hello current ETag value of hello entity.</span></span>
4. <span data-ttu-id="17734-286">Si valor de ETag actual de Hola de entidad de hello es diferente al Hola ETag en hello obligatorio **If-Match** encabezado de solicitud de hello, servicio de hello devuelve un cliente de toohello 412 error.</span><span class="sxs-lookup"><span data-stu-id="17734-286">If hello current ETag value of hello entity is different than hello ETag in hello mandatory **If-Match** header in hello request, hello service returns a 412 error toohello client.</span></span> <span data-ttu-id="17734-287">Esto indica que otro proceso ha actualizado entidad Hola desde cliente hello había recuperado de cliente de toohello.</span><span class="sxs-lookup"><span data-stu-id="17734-287">This indicates toohello client that another process has updated hello entity since hello client retrieved it.</span></span>
5. <span data-ttu-id="17734-288">Si es Hola Hola el valor ETag actual de entidad de hello igual Hola ETag en hello obligatorio **If-Match** encabezado de solicitud de Hola o hello **If-Match** encabezado contiene el carácter comodín de hello (*), servicio de Hola lleva a cabo Hola solicitó la operación y las actualizaciones de Hola el valor ETag actual de hello tooshow de entidad que se ha actualizado.</span><span class="sxs-lookup"><span data-stu-id="17734-288">If hello current ETag value of hello entity is hello same as hello ETag in hello mandatory **If-Match** header in hello request or hello **If-Match** header contains hello wildcard character (*), hello service performs hello requested operation and updates hello current ETag value of hello entity tooshow that it has been updated.</span></span>  

<span data-ttu-id="17734-289">Tenga en cuenta que, a diferencia del servicio de blob de hello, servicio de la tabla de hello requiere Hola cliente tooinclude una **If-Match** encabezado en las solicitudes de actualización.</span><span class="sxs-lookup"><span data-stu-id="17734-289">Note that unlike hello blob service, hello table service requires hello client tooinclude an **If-Match** header in update requests.</span></span> <span data-ttu-id="17734-290">Sin embargo, es posible tooforce un incondicional actualizar (último escritor gana estrategia) y omitir las comprobaciones de simultaneidad si el cliente de hello establece hello **If-Match** carácter de comodín toohello encabezado (*) en la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="17734-290">However, it is possible tooforce an unconditional update (last writer wins strategy) and bypass concurrency checks if hello client sets hello **If-Match** header toohello wildcard character (*) in hello request.</span></span>  

<span data-ttu-id="17734-291">Hola siguiente fragmento de código C# muestra una entidad cliente que ya se creó anteriormente o se recupera con su dirección de correo electrónico que se actualiza.</span><span class="sxs-lookup"><span data-stu-id="17734-291">hello following C# snippet shows a customer entity that was previously either created or retrieved having their email address updated.</span></span> <span data-ttu-id="17734-292">Insertar Hello inicial o recuperar operación almacena el valor de ETag de hello en el objeto de cliente de Hola y como ejemplo de Hola utiliza hello misma instancia del objeto cuando se ejecuta Hola operación de reemplazo, envía automáticamente Hola ETag valor toohello back-servicio de tabla, Habilitar Hola servicio toocheck las infracciones de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="17734-292">hello initial insert or retrieve operation stores hello ETag value in hello customer object, and because hello sample uses hello same object instance when it executes hello replace operation, it automatically sends hello ETag value back toohello table service, enabling hello service toocheck for concurrency violations.</span></span> <span data-ttu-id="17734-293">Si otro proceso ha actualizado la entidad de hello en el almacenamiento de tabla, servicio de hello devuelve un mensaje de estado 412 de HTTP (error de condición previa).</span><span class="sxs-lookup"><span data-stu-id="17734-293">If another process has updated hello entity in table storage, hello service returns an HTTP 412 (Precondition Failed) status message.</span></span>  <span data-ttu-id="17734-294">Puede descargar aquí completo ejemplo hello: [administración de simultaneidad con el almacenamiento de Azure](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span><span class="sxs-lookup"><span data-stu-id="17734-294">You can download hello full sample here: [Managing Concurrency using Azure Storage](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span></span>

```csharp
try
{
    customer.Email = "updatedEmail@contoso.org";
    TableOperation replaceCustomer = TableOperation.Replace(customer);
    customerTable.Execute(replaceCustomer);
    Console.WriteLine("Replace operation succeeded.");
}
catch (StorageException ex)
{
    if (ex.RequestInformation.HttpStatusCode == 412)
        Console.WriteLine("Optimistic concurrency violation – entity has changed since it was retrieved.");
    else
        throw;
}  
```

<span data-ttu-id="17734-295">tooexplicitly deshabilitar la comprobación de simultaneidad de hello, debe establecer hello **ETag** propiedad de hello **empleado** objeto demasiado "*" antes de ejecutar la operación de reemplazo Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-295">tooexplicitly disable hello concurrency check, you should set hello **ETag** property of hello **employee** object too"*" before you execute hello replace operation.</span></span>  

```csharp
customer.ETag = "*";  
```

<span data-ttu-id="17734-296">Hello tabla siguiente resume cómo las operaciones de entidad de tabla de hello utilizan valores ETag:</span><span class="sxs-lookup"><span data-stu-id="17734-296">hello following table summarizes how hello table entity operations use ETag values:</span></span>

| <span data-ttu-id="17734-297">Operación</span><span class="sxs-lookup"><span data-stu-id="17734-297">Operation</span></span> | <span data-ttu-id="17734-298">Devuelve el valor ETag</span><span class="sxs-lookup"><span data-stu-id="17734-298">Returns ETag value</span></span> | <span data-ttu-id="17734-299">Requiere encabezado de solicitud If-Match</span><span class="sxs-lookup"><span data-stu-id="17734-299">Requires If-Match request header</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="17734-300">Query Entities</span><span class="sxs-lookup"><span data-stu-id="17734-300">Query Entities</span></span> |<span data-ttu-id="17734-301">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-301">Yes</span></span> |<span data-ttu-id="17734-302">No</span><span class="sxs-lookup"><span data-stu-id="17734-302">No</span></span> |
| <span data-ttu-id="17734-303">Insert Entity</span><span class="sxs-lookup"><span data-stu-id="17734-303">Insert Entity</span></span> |<span data-ttu-id="17734-304">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-304">Yes</span></span> |<span data-ttu-id="17734-305">No</span><span class="sxs-lookup"><span data-stu-id="17734-305">No</span></span> |
| <span data-ttu-id="17734-306">Update Entity</span><span class="sxs-lookup"><span data-stu-id="17734-306">Update Entity</span></span> |<span data-ttu-id="17734-307">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-307">Yes</span></span> |<span data-ttu-id="17734-308">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-308">Yes</span></span> |
| <span data-ttu-id="17734-309">Merge Entity</span><span class="sxs-lookup"><span data-stu-id="17734-309">Merge Entity</span></span> |<span data-ttu-id="17734-310">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-310">Yes</span></span> |<span data-ttu-id="17734-311">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-311">Yes</span></span> |
| <span data-ttu-id="17734-312">Delete Entity</span><span class="sxs-lookup"><span data-stu-id="17734-312">Delete Entity</span></span> |<span data-ttu-id="17734-313">No</span><span class="sxs-lookup"><span data-stu-id="17734-313">No</span></span> |<span data-ttu-id="17734-314">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-314">Yes</span></span> |
| <span data-ttu-id="17734-315">Insert or Replace Entity</span><span class="sxs-lookup"><span data-stu-id="17734-315">Insert or Replace Entity</span></span> |<span data-ttu-id="17734-316">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-316">Yes</span></span> |<span data-ttu-id="17734-317">No</span><span class="sxs-lookup"><span data-stu-id="17734-317">No</span></span> |
| <span data-ttu-id="17734-318">Insert or Merge Entity</span><span class="sxs-lookup"><span data-stu-id="17734-318">Insert or Merge Entity</span></span> |<span data-ttu-id="17734-319">Sí</span><span class="sxs-lookup"><span data-stu-id="17734-319">Yes</span></span> |<span data-ttu-id="17734-320">No</span><span class="sxs-lookup"><span data-stu-id="17734-320">No</span></span> |

<span data-ttu-id="17734-321">Tenga en cuenta que hello **insertar o reemplazar entidades** y **insertar o combinar entidades** Microsoft operations ¿ *no* porque no envían un toohello del valor de ETag, se realiza ninguna comprobación de simultaneidad servicio de la tabla.</span><span class="sxs-lookup"><span data-stu-id="17734-321">Note that hello **Insert or Replace Entity** and **Insert or Merge Entity** operations do *not* perform any concurrency checks because they do not send an ETag value toohello table service.</span></span>  

<span data-ttu-id="17734-322">En general, los desarrolladores que usan tablas deben basarse en simultaneidad optimista cuando desarrollan aplicaciones escalables.</span><span class="sxs-lookup"><span data-stu-id="17734-322">In general developers using tables should rely on optimistic concurrency when developing scalable applications.</span></span> <span data-ttu-id="17734-323">Si se necesita el bloqueo pesimista, los desarrolladores de un enfoque pueden realizar cuando el acceso a tablas es tooassign un blob designado para cada tabla e inténtelo tootake una concesión en hello blob antes de operar en la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-323">If pessimistic locking is needed, one approach developers can take when accessing Tables is tooassign a designated blob for each table and try tootake a lease on hello blob before operating on hello table.</span></span> <span data-ttu-id="17734-324">Este método requiere Hola aplicación tooensure todo acceso a datos rutas de acceso obtener toooperating anteriores de concesión de hello en la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="17734-324">This approach does require hello application tooensure all data access paths obtain hello lease prior toooperating on hello table.</span></span> <span data-ttu-id="17734-325">También debe tener en cuenta que tiempo de concesión mínimo de hello es 15 segundos, que requiere una consideración cuidadosa de escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="17734-325">You should also note that hello minimum lease time is 15 seconds which requires careful consideration for scalability.</span></span>  

<span data-ttu-id="17734-326">Para obtener más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="17734-326">For more information see:</span></span>  

* [<span data-ttu-id="17734-327">Operaciones en entidades</span><span class="sxs-lookup"><span data-stu-id="17734-327">Operations on Entities</span></span>](http://msdn.microsoft.com/library/azure/dd179375.aspx)  

## <a name="managing-concurrency-in-hello-queue-service"></a><span data-ttu-id="17734-328">Administrar la simultaneidad en hello servicio cola</span><span class="sxs-lookup"><span data-stu-id="17734-328">Managing Concurrency in hello Queue Service</span></span>
<span data-ttu-id="17734-329">Un escenario en que simultaneidad es un problema en el servicio de puesta en cola de hello es donde varios clientes recupere mensajes de una cola.</span><span class="sxs-lookup"><span data-stu-id="17734-329">One scenario in which concurrency is a concern in hello queueing service is where multiple clients are retrieving messages from a queue.</span></span> <span data-ttu-id="17734-330">Cuando se recupera un mensaje de cola de hello, respuesta de hello incluye mensajes de bienvenida y un valor de confirmación de recepción, que es el mensaje de bienvenida de toodelete necesarios.</span><span class="sxs-lookup"><span data-stu-id="17734-330">When a message is retrieved from hello queue, hello response includes hello message and a pop receipt value, which is required toodelete hello message.</span></span> <span data-ttu-id="17734-331">mensaje de bienvenida no se elimina automáticamente de cola de hello, pero después de que se ha recuperado, no es visible tooother clientes para intervalo de tiempo de hello especificado por el parámetro de hello visibilitytimeout.</span><span class="sxs-lookup"><span data-stu-id="17734-331">hello message is not automatically deleted from hello queue, but after it has been retrieved, it is not visible tooother clients for hello time interval specified by hello visibilitytimeout parameter.</span></span> <span data-ttu-id="17734-332">cliente de Hola que recupera mensajes de bienvenida es mensajes de bienvenida del toodelete esperado después de haberla procesado y antes de hello hora especificada por hello elemento TimeNextVisible de hello respuesta, que se calcula en función de valor de Hola de hello visibilitytimeout parámetro.</span><span class="sxs-lookup"><span data-stu-id="17734-332">hello client that retrieves hello message is expected toodelete hello message after it has been processed, and before hello time specified by hello TimeNextVisible element of hello response, which is calculated based on hello value of hello visibilitytimeout parameter.</span></span> <span data-ttu-id="17734-333">valor de Hola de visibilitytimeout se agrega tiempo toohello en qué Hola mensaje es recupera toodetermine valor hello TimeNextVisible.</span><span class="sxs-lookup"><span data-stu-id="17734-333">hello value of visibilitytimeout is added toohello time at which hello message is retrieved toodetermine hello value of TimeNextVisible.</span></span>  

<span data-ttu-id="17734-334">servicio de cola de Hello no dispone de compatibilidad para la simultaneidad optimista o pesimista y para este deben asegurarse clientes motivo procesar mensajes recuperados de una cola de mensajes se procesan de manera idempotente.</span><span class="sxs-lookup"><span data-stu-id="17734-334">hello queue service does not have support for either optimistic or pessimistic concurrency and for this reason clients processing messages retrieved from a queue should ensure messages are processed in an idempotent manner.</span></span> <span data-ttu-id="17734-335">Una estrategia El último que escribe gana se usa para actualizar operaciones como SetQueueServiceProperties, SetQueueMetaData, SetQueueACL y UpdateMessage.</span><span class="sxs-lookup"><span data-stu-id="17734-335">A last writer wins strategy is used for update operations such as SetQueueServiceProperties, SetQueueMetaData, SetQueueACL and UpdateMessage.</span></span>  

<span data-ttu-id="17734-336">Para obtener más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="17734-336">For more information see:</span></span>  

* [<span data-ttu-id="17734-337">API de REST del servicio Cola</span><span class="sxs-lookup"><span data-stu-id="17734-337">Queue Service REST API</span></span>](http://msdn.microsoft.com/library/azure/dd179363.aspx)
* [<span data-ttu-id="17734-338">Get Messages</span><span class="sxs-lookup"><span data-stu-id="17734-338">Get Messages</span></span>](http://msdn.microsoft.com/library/azure/dd179474.aspx)  

## <a name="managing-concurrency-in-hello-file-service"></a><span data-ttu-id="17734-339">Administrar la simultaneidad en hello servicio de archivos</span><span class="sxs-lookup"><span data-stu-id="17734-339">Managing Concurrency in hello File Service</span></span>
<span data-ttu-id="17734-340">puede tener acceso al servicio de archivo de Hello mediante dos extremos de otro protocolo: SMB y REST.</span><span class="sxs-lookup"><span data-stu-id="17734-340">hello file service can be accessed using two different protocol endpoints – SMB and REST.</span></span> <span data-ttu-id="17734-341">Hola servicio REST no dispone de compatibilidad de bloqueo optimista o el bloqueo pesimista y todas las actualizaciones seguirá una estrategia de wins último escritor.</span><span class="sxs-lookup"><span data-stu-id="17734-341">hello REST service does not have support for either optimistic locking or pessimistic locking and all updates will follow a last writer wins strategy.</span></span> <span data-ttu-id="17734-342">Los clientes SMB que montan recursos compartidos de archivos pueden aprovechar archivo bloqueo mecanismos toomanage acceso tooshared archivos del sistema, incluyendo Hola capacidad tooperform el bloqueo pesimista.</span><span class="sxs-lookup"><span data-stu-id="17734-342">SMB clients that mount file shares can leverage file system locking mechanisms toomanage access tooshared files – including hello ability tooperform pessimistic locking.</span></span> <span data-ttu-id="17734-343">Cuando un cliente SMB abre un archivo, especifica acceso de archivo de Hola y el recurso compartido de modo.</span><span class="sxs-lookup"><span data-stu-id="17734-343">When an SMB client opens a file, it specifies both hello file access and share mode.</span></span> <span data-ttu-id="17734-344">Establecer una opción de acceso de archivo de "Escritura" o "Lectura/escritura" junto con un modo de uso compartido de archivo de "None" dará como resultado en el archivo hello está bloqueado por un cliente SMB hasta que se cierre el archivo hello.</span><span class="sxs-lookup"><span data-stu-id="17734-344">Setting a File Access option of "Write" or "Read/Write" along with a File Share mode of "None" will result in hello file being locked by an SMB client until hello file is closed.</span></span> <span data-ttu-id="17734-345">Si se intenta la operación REST en un archivo donde un cliente SMB tiene bloqueado el archivo de Hola Hola servicio REST devolverá el código de estado 409 (conflicto) con código de error SharingViolation.</span><span class="sxs-lookup"><span data-stu-id="17734-345">If REST operation is attempted on a file where an SMB client has hello file locked hello REST service will return status code 409 (Conflict) with error code SharingViolation.</span></span>  

<span data-ttu-id="17734-346">Cuando un cliente SMB abre un archivo para eliminarlo, marca archivo hello como pendiente de eliminación hasta que todos los otros clientes SMB se cierran los identificadores abiertos en ese archivo.</span><span class="sxs-lookup"><span data-stu-id="17734-346">When an SMB client opens a file for delete, it marks hello file as pending delete until all other SMB client open handles on that file are closed.</span></span> <span data-ttu-id="17734-347">Mientras un archivo se marca como eliminación pendiente, cualquier operación REST en ese archivo devolverá el código de estado 409 (Conflicto) con el código de error SMBDeletePending.</span><span class="sxs-lookup"><span data-stu-id="17734-347">While a file is marked as pending delete, any REST operation on that file will return status code 409 (Conflict) with error code SMBDeletePending.</span></span> <span data-ttu-id="17734-348">No se devuelve el código de estado 404 (no encontrado) ya que es posible que Hola Hola de tooremove de cliente SMB archivo Hola de eliminación marca tooclosing previa está pendiente.</span><span class="sxs-lookup"><span data-stu-id="17734-348">Status code 404 (Not Found) is not returned since it is possible for hello SMB client tooremove hello pending deletion flag prior tooclosing hello file.</span></span> <span data-ttu-id="17734-349">En otras palabras, solo se espera que el código de estado 404 (no encontrado) cuando se ha quitado el archivo hello.</span><span class="sxs-lookup"><span data-stu-id="17734-349">In other words, status code 404 (Not Found) is only expected when hello file has been removed.</span></span> <span data-ttu-id="17734-350">Tenga en cuenta que mientras un archivo está en estado pendiente de eliminación por SMB, no se incluirá en hello que enumerar archivos de resultados. Tenga en cuenta que las operaciones de REST eliminar archivo y directorio eliminar de REST de Hola se confirman de forma automática y no dan lugar a pendientes Eliminar estado.</span><span class="sxs-lookup"><span data-stu-id="17734-350">Note that while a file is in a SMB pending delete state, it will not be included in hello List Files results.Also note that hello REST Delete File and REST Delete Directory operations are committed atomically and do not result in pending delete state.</span></span>  

<span data-ttu-id="17734-351">Para obtener más información, consulte:</span><span class="sxs-lookup"><span data-stu-id="17734-351">For more information see:</span></span>  

* [<span data-ttu-id="17734-352">Administración de bloqueos de archivo</span><span class="sxs-lookup"><span data-stu-id="17734-352">Managing File Locks</span></span>](http://msdn.microsoft.com/library/azure/dn194265.aspx)  

## <a name="summary-and-next-steps"></a><span data-ttu-id="17734-353">Resumen y pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="17734-353">Summary and Next Steps</span></span>
<span data-ttu-id="17734-354">Hello ha sido el servicio de almacenamiento de Microsoft Azure diseñado necesidades de hello toomeet de aplicaciones en línea más complejas de hello sin obligar a los desarrolladores toocompromise o nueva consideración de diseño clave suposiciones como simultaneidad y coherencia de datos que se vuelven a tootake Para conceder.</span><span class="sxs-lookup"><span data-stu-id="17734-354">hello Microsoft Azure Storage service has been designed toomeet hello needs of hello most complex online applications without forcing developers toocompromise or rethink key design assumptions such as concurrency and data consistency that they have come tootake for granted.</span></span>  

<span data-ttu-id="17734-355">Para hello completar la aplicación de ejemplo que se hace referencia en este blog:</span><span class="sxs-lookup"><span data-stu-id="17734-355">For hello complete sample application referenced in this blog:</span></span>  

* [<span data-ttu-id="17734-356">Administración de simultaneidad con Almacenamiento de Azure: aplicación de ejemplo</span><span class="sxs-lookup"><span data-stu-id="17734-356">Managing Concurrency using Azure Storage - Sample Application</span></span>](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114)  

<span data-ttu-id="17734-357">Para obtener más información acerca de Almacenamiento de Azure, consulte:</span><span class="sxs-lookup"><span data-stu-id="17734-357">For more information on Azure Storage see:</span></span>  

* [<span data-ttu-id="17734-358">Página principal de Almacenamiento de Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="17734-358">Microsoft Azure Storage Home Page</span></span>](https://azure.microsoft.com/services/storage/)
* [<span data-ttu-id="17734-359">Introducción tooAzure almacenamiento</span><span class="sxs-lookup"><span data-stu-id="17734-359">Introduction tooAzure Storage</span></span>](storage-introduction.md)
* <span data-ttu-id="17734-360">Introducción al almacenamiento para [Blob](storage-dotnet-how-to-use-blobs.md), [Table](storage-dotnet-how-to-use-tables.md), [Queues](storage-dotnet-how-to-use-queues.md) y [Files](storage-dotnet-how-to-use-files.md)</span><span class="sxs-lookup"><span data-stu-id="17734-360">Storage Getting Started for [Blob](storage-dotnet-how-to-use-blobs.md), [Table](storage-dotnet-how-to-use-tables.md),  [Queues](storage-dotnet-how-to-use-queues.md), and [Files](storage-dotnet-how-to-use-files.md)</span></span>
* <span data-ttu-id="17734-361">Arquitectura de almacenamiento – [Almacenamiento de Azure: un servicio de almacenamiento en la nube altamente disponible con coherencia fuerte](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx)</span><span class="sxs-lookup"><span data-stu-id="17734-361">Storage Architecture – [Azure Storage : A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx)</span></span>

