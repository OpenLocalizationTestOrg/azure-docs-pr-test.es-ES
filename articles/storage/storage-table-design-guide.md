---
title: "Guía de diseño de tabla de almacenamiento aaaAzure | Documentos de Microsoft"
description: "Diseño de tablas escalables y eficientes en Azure Table Storage"
services: storage
documentationcenter: na
author: jasonnewyork
manager: tadb
editor: tysonn
ms.assetid: 8e228b0c-2998-4462-8101-9f16517393ca
ms.service: storage
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage
ms.date: 02/28/2017
ms.author: jahogg
ms.openlocfilehash: bbac5e83fe994c1ba1408dd43367fbcfca6a2148
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-table-design-guide-designing-scalable-and-performant-tables"></a><span data-ttu-id="9c7da-103">Guía de diseño de tablas de Azure Storage: diseño de tablas escalables y eficientes</span><span class="sxs-lookup"><span data-stu-id="9c7da-103">Azure Storage Table Design Guide: Designing Scalable and Performant Tables</span></span>
[!INCLUDE [storage-table-cosmos-db-tip-include](../../includes/storage-table-cosmos-db-tip-include.md)]

<span data-ttu-id="9c7da-104">toodesign escalable y tablas de rendimiento debe tener en cuenta una serie de factores como el rendimiento, escalabilidad y costo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-104">toodesign scalable and performant tables you must consider a number of factors such as performance, scalability, and cost.</span></span> <span data-ttu-id="9c7da-105">Si previamente ha diseñado esquemas para bases de datos relacionales, estas consideraciones será tooyou familiar, pero aunque hay algunas similitudes entre el modelo de almacenamiento del servicio de tabla de Azure de Hola y modelos relacionales, también hay muchos importante diferencias.</span><span class="sxs-lookup"><span data-stu-id="9c7da-105">If you have previously designed schemas for relational databases, these considerations will be familiar tooyou, but while there are some similarities between hello Azure Table service storage model and relational models, there are also many important differences.</span></span> <span data-ttu-id="9c7da-106">Normalmente, estas diferencias provocan toovery distintos diseños que puede ser contraproducente o incorrecto toosomeone familiarizado con bases de datos relacionales, pero que realizar idea clara si está diseñando para un almacén de clave/valor de NoSQL como Hola servicio tabla de Azure.</span><span class="sxs-lookup"><span data-stu-id="9c7da-106">These differences typically lead toovery different designs that may look counter-intuitive or wrong toosomeone familiar with relational databases, but which do make good sense if you are designing for a NoSQL key/value store such as hello Azure Table service.</span></span> <span data-ttu-id="9c7da-107">Muchas de sus diferencias de diseño reflejarán Hola ausencia de servicio de la tabla de hello toosupport diseñado aplicaciones de escala de nube que pueden contener miles de millones de entidades (filas en la terminología de base de datos relacional) de datos o conjuntos de datos que debe admitir muy alto volúmenes de transacciones: por lo tanto, necesita toothink diferente sobre cómo almacenar los datos y comprender el funcionamiento de hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-107">Many of your design differences will reflect hello fact that hello Table service is designed toosupport cloud-scale applications that can contain billions of entities (rows in relational database terminology) of data or for datasets that must support very high transaction volumes: therefore, you need toothink differently about how you store your data and understand how hello Table service works.</span></span> <span data-ttu-id="9c7da-108">Un almacén de datos NoSQL bien diseñado puede habilitar su tooscale solución mucho más allá (y a un costo menor) a una solución que usa una base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="9c7da-108">A well designed NoSQL data store can enable your solution tooscale much further (and at a lower cost) than a solution that uses a relational database.</span></span> <span data-ttu-id="9c7da-109">Esta guía le ayuda con estos temas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-109">This guide helps you with these topics.</span></span>  

## <a name="about-hello-azure-table-service"></a><span data-ttu-id="9c7da-110">Acerca de hello servicio tabla de Azure</span><span class="sxs-lookup"><span data-stu-id="9c7da-110">About hello Azure Table service</span></span>
<span data-ttu-id="9c7da-111">Esta sección resalta algunas de hello características clave de servicio de la tabla de Hola que son especialmente relevante toodesigning de rendimiento y escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-111">This section highlights some of hello key features of hello Table service that are especially relevant toodesigning for performance and scalability.</span></span> <span data-ttu-id="9c7da-112">Si está tooAzure nuevo almacenamiento y Hola servicio tabla, primero lea [Introducción tooMicrosoft almacenamiento de Azure](storage-introduction.md) y [Introducción al almacenamiento de tabla de Azure mediante .NET](storage-dotnet-how-to-use-tables.md) antes de leer el resto de Hola de este artículo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-112">If you are new tooAzure Storage and hello Table service, first read [Introduction tooMicrosoft Azure Storage](storage-introduction.md) and [Get started with Azure Table Storage using .NET](storage-dotnet-how-to-use-tables.md) before reading hello remainder of this article.</span></span> <span data-ttu-id="9c7da-113">Aunque el objetivo de Hola de esta guía se encuentra en hello servicio tabla, se incluyen algunos discusión de hello cola de Azure y servicios de Blob y cómo puede usar junto con hello servicio de tabla en una solución.</span><span class="sxs-lookup"><span data-stu-id="9c7da-113">Although hello focus of this guide is on hello Table service, it will include some discussion of hello Azure Queue and Blob services, and how you might use them along with hello Table service in a solution.</span></span>  

<span data-ttu-id="9c7da-114">¿Qué es el servicio de la tabla de hello?</span><span class="sxs-lookup"><span data-stu-id="9c7da-114">What is hello Table service?</span></span> <span data-ttu-id="9c7da-115">Como cabría esperar en nombre de hello, Hola servicio tabla utiliza un datos de toostore formato tabular.</span><span class="sxs-lookup"><span data-stu-id="9c7da-115">As you might expect from hello name, hello Table service uses a tabular format toostore data.</span></span> <span data-ttu-id="9c7da-116">En la terminología estándar de hello, cada fila de tabla de hello representa una entidad y almacén de columnas de Hola Hola distintas propiedades de esa entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-116">In hello standard terminology, each row of hello table represents an entity, and hello columns store hello various properties of that entity.</span></span> <span data-ttu-id="9c7da-117">Cada entidad tiene un par de claves toouniquely identificarlo y una columna de marca de tiempo que Hola servicio tabla usa tootrack cuando se actualizó por última vez la entidad de hello (Esto ocurre automáticamente y no se puede sobrescribir manualmente Hola marca de tiempo con un valor arbitrario).</span><span class="sxs-lookup"><span data-stu-id="9c7da-117">Every entity has a pair of keys toouniquely identify it, and a timestamp column that hello Table service uses tootrack when hello entity was last updated (this happens automatically and you cannot manually overwrite hello timestamp with an arbitrary value).</span></span> <span data-ttu-id="9c7da-118">Hola servicio tabla utiliza esta simultaneidad optimista de toomanage de marca de hora de última modificación (LMT).</span><span class="sxs-lookup"><span data-stu-id="9c7da-118">hello Table service uses this last-modified timestamp (LMT) toomanage optimistic concurrency.</span></span>  

> [!NOTE]
> <span data-ttu-id="9c7da-119">operaciones de API de REST del servicio de tabla de Hello también devuelven un **ETag** valor que se derive de marca de hora de última modificación de hello (LMT).</span><span class="sxs-lookup"><span data-stu-id="9c7da-119">hello Table service REST API operations also return an **ETag** value that it derives from hello last-modified timestamp (LMT).</span></span> <span data-ttu-id="9c7da-120">En este documento se usará Hola términos ETag y LMT indistintamente porque hacen referencia toohello mismos datos subyacentes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-120">In this document we will use hello terms ETag and LMT interchangeably because they refer toohello same underlying data.</span></span>  
> 
> 

<span data-ttu-id="9c7da-121">Hello en el ejemplo siguiente se muestra un toostore de diseño de tabla simple entidades employee y department.</span><span class="sxs-lookup"><span data-stu-id="9c7da-121">hello following example shows a simple table design toostore employee and department entities.</span></span> <span data-ttu-id="9c7da-122">Muchos de los ejemplos de hello que se muestra más adelante en esta guía se basan en este diseño simple.</span><span class="sxs-lookup"><span data-stu-id="9c7da-122">Many of hello examples shown later in this guide are based on this simple design.</span></span>  

<table>
<tr>
<th><span data-ttu-id="9c7da-123">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-123">PartitionKey</span></span></th>
<th><span data-ttu-id="9c7da-124">RowKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-124">RowKey</span></span></th>
<th><span data-ttu-id="9c7da-125">Timestamp</span><span class="sxs-lookup"><span data-stu-id="9c7da-125">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-126">Marketing</span><span class="sxs-lookup"><span data-stu-id="9c7da-126">Marketing</span></span></td>
<td><span data-ttu-id="9c7da-127">00001</span><span class="sxs-lookup"><span data-stu-id="9c7da-127">00001</span></span></td>
<td><span data-ttu-id="9c7da-128">2014-08-22T00:50:32Z</span><span class="sxs-lookup"><span data-stu-id="9c7da-128">2014-08-22T00:50:32Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-129">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-129">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-130">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-130">LastName</span></span></th>
<th><span data-ttu-id="9c7da-131">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-131">Age</span></span></th>
<th><span data-ttu-id="9c7da-132">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-132">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-133">Don</span><span class="sxs-lookup"><span data-stu-id="9c7da-133">Don</span></span></td>
<td><span data-ttu-id="9c7da-134">Hall</span><span class="sxs-lookup"><span data-stu-id="9c7da-134">Hall</span></span></td>
<td><span data-ttu-id="9c7da-135">34</span><span class="sxs-lookup"><span data-stu-id="9c7da-135">34</span></span></td>
<td>donh@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="9c7da-136">Marketing</span><span class="sxs-lookup"><span data-stu-id="9c7da-136">Marketing</span></span></td>
<td><span data-ttu-id="9c7da-137">00002</span><span class="sxs-lookup"><span data-stu-id="9c7da-137">00002</span></span></td>
<td><span data-ttu-id="9c7da-138">2014-08-22T00:50:34Z</span><span class="sxs-lookup"><span data-stu-id="9c7da-138">2014-08-22T00:50:34Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-139">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-139">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-140">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-140">LastName</span></span></th>
<th><span data-ttu-id="9c7da-141">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-141">Age</span></span></th>
<th><span data-ttu-id="9c7da-142">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-142">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-143">Jun</span><span class="sxs-lookup"><span data-stu-id="9c7da-143">Jun</span></span></td>
<td><span data-ttu-id="9c7da-144">Cao</span><span class="sxs-lookup"><span data-stu-id="9c7da-144">Cao</span></span></td>
<td><span data-ttu-id="9c7da-145">47</span><span class="sxs-lookup"><span data-stu-id="9c7da-145">47</span></span></td>
<td>junc@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="9c7da-146">Marketing</span><span class="sxs-lookup"><span data-stu-id="9c7da-146">Marketing</span></span></td>
<td><span data-ttu-id="9c7da-147">Departamento</span><span class="sxs-lookup"><span data-stu-id="9c7da-147">Department</span></span></td>
<td><span data-ttu-id="9c7da-148">2014-08-22T00:50:30Z</span><span class="sxs-lookup"><span data-stu-id="9c7da-148">2014-08-22T00:50:30Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-149">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="9c7da-149">DepartmentName</span></span></th>
<th><span data-ttu-id="9c7da-150">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="9c7da-150">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="9c7da-151">Marketing</span></span></td>
<td><span data-ttu-id="9c7da-152">153</span><span class="sxs-lookup"><span data-stu-id="9c7da-152">153</span></span></td>
</tr>
</table>
</td>
</tr>
<tr>
<td><span data-ttu-id="9c7da-153">Ventas</span><span class="sxs-lookup"><span data-stu-id="9c7da-153">Sales</span></span></td>
<td><span data-ttu-id="9c7da-154">00010</span><span class="sxs-lookup"><span data-stu-id="9c7da-154">00010</span></span></td>
<td><span data-ttu-id="9c7da-155">2014-08-22T00:50:44Z</span><span class="sxs-lookup"><span data-stu-id="9c7da-155">2014-08-22T00:50:44Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-156">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-156">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-157">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-157">LastName</span></span></th>
<th><span data-ttu-id="9c7da-158">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-158">Age</span></span></th>
<th><span data-ttu-id="9c7da-159">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-159">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-160">Ken</span><span class="sxs-lookup"><span data-stu-id="9c7da-160">Ken</span></span></td>
<td><span data-ttu-id="9c7da-161">Kwok</span><span class="sxs-lookup"><span data-stu-id="9c7da-161">Kwok</span></span></td>
<td><span data-ttu-id="9c7da-162">23</span><span class="sxs-lookup"><span data-stu-id="9c7da-162">23</span></span></td>
<td>kenk@contoso.com</td>
</tr>
</table>
</td>
</tr>
</table>


<span data-ttu-id="9c7da-163">Hasta ahora, parece muy similar tabla tooa en una base de datos relacional con diferencias clave Hola está Hola columnas obligatorias y hello capacidad toostore varios tipos de entidad en hello misma tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-163">So far, this looks very similar tooa table in a relational database with hello key differences being hello mandatory columns, and hello ability toostore multiple entity types in hello same table.</span></span> <span data-ttu-id="9c7da-164">Además, cada uno de Hola propiedades definidas por el usuario como **FirstName** o **Age** tiene un tipo de datos, como entero o cadena, simplemente como una columna en una base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="9c7da-164">In addition, each of hello user-defined properties such as **FirstName** or **Age** has a data type, such as integer or string, just like a column in a relational database.</span></span> <span data-ttu-id="9c7da-165">Aunque a diferencia de una base de datos relacional, naturaleza sin esquema de Hola de hello significa de servicio de tabla que no necesita tener una propiedad Hola mismo tipo de datos de cada entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-165">Although unlike in a relational database, hello schema-less nature of hello Table service means that a property need not have hello same data type on each entity.</span></span> <span data-ttu-id="9c7da-166">toostore tipos de datos complejos en una sola propiedad, debe usar un formato serializado como JSON o XML.</span><span class="sxs-lookup"><span data-stu-id="9c7da-166">toostore complex data types in a single property, you must use a serialized format such as JSON or XML.</span></span> <span data-ttu-id="9c7da-167">Para obtener más información acerca de los tipos de datos de servicio como las de tabla de hello, intervalos de fechas admitido, las reglas de nomenclatura y las restricciones de tamaño, vea [Hola de entender el modelo de datos del servicio de tabla](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-167">For more information about hello table service such as supported data types, supported date ranges, naming rules, and size constraints, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>

<span data-ttu-id="9c7da-168">Como verá, la elección de **PartitionKey** y **RowKey** es el diseño de tabla toogood fundamentales.</span><span class="sxs-lookup"><span data-stu-id="9c7da-168">As you will see, your choice of **PartitionKey** and **RowKey** is fundamental toogood table design.</span></span> <span data-ttu-id="9c7da-169">Todas las entidades almacenadas en una tabla deben tener una combinación única de **PartitionKey** y **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-169">Every entity stored in a table must have a unique combination of **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="9c7da-170">Al igual que con las claves en una tabla de base de datos relacional, Hola **PartitionKey** y **RowKey** valores están indizada toocreate un índice agrupado que permite búsquedas rápidas; sin embargo, Hola servicio tabla no crea ninguno índices secundarios, por lo que se trata de hello solo dos propiedades (para algunos de los patrones de Hola que se describe más adelante, muestran cómo puede solucionar esta limitación aparente) indizan.</span><span class="sxs-lookup"><span data-stu-id="9c7da-170">As with keys in a relational database table, hello **PartitionKey** and **RowKey** values are indexed toocreate a clustered index that enables fast look-ups; however, hello Table service does not create any secondary indexes so these are hello only two indexed properties (some of hello patterns described later show how you can work around this apparent limitation).</span></span>  

<span data-ttu-id="9c7da-171">Una tabla está formada por una o varias particiones, como verá, muchas de hello decisiones de diseño que realice torno eligiendo un adecuado **PartitionKey** y **RowKey** toooptimize la solución.</span><span class="sxs-lookup"><span data-stu-id="9c7da-171">A table is made up of one or more partitions, and as you will see, many of hello design decisions you make will be around choosing a suitable **PartitionKey** and **RowKey** toooptimize your solution.</span></span> <span data-ttu-id="9c7da-172">Una solución puede constar de solo una única tabla que contenga todas las entidades que se organizan en particiones, pero normalmente las soluciones tendrán varias tablas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-172">A solution could consist of just a single table that contains all your entities organized into partitions, but typically a solution will have multiple tables.</span></span> <span data-ttu-id="9c7da-173">Ayudarle a tablas toologically organizar las entidades, ayudará a administrar toohello el acceso a datos mediante acceso a las listas de control y puede quitar una tabla completa con una sola operación de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-173">Tables help you toologically organize your entities, help you manage access toohello data using access control lists, and you can drop an entire table using a single storage operation.</span></span>  

### <a name="table-partitions"></a><span data-ttu-id="9c7da-174">Particiones de tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-174">Table partitions</span></span>
<span data-ttu-id="9c7da-175">nombre de la cuenta de Hello, nombre de tabla y **PartitionKey** juntos identifican la partición de hello en el servicio de almacenamiento de Hola donde el servicio de la tabla de Hola almacena entidad Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-175">hello account name, table name and **PartitionKey** together identify hello partition within hello storage service where hello table service stores hello entity.</span></span> <span data-ttu-id="9c7da-176">Además de ser parte del esquema para las entidades de direccionamiento de hello, las particiones definen un ámbito para las transacciones (vea [transacciones de grupo de la entidad](#entity-group-transactions) a continuación) y formulario Hola de cómo el servicio de tabla de hello escala.</span><span class="sxs-lookup"><span data-stu-id="9c7da-176">As well as being part of hello addressing scheme for entities, partitions define a scope for transactions (see [Entity Group Transactions](#entity-group-transactions) below), and form hello basis of how hello table service scales.</span></span> <span data-ttu-id="9c7da-177">Para obtener más información sobre las particiones, vea [Objetivos de rendimiento y escalabilidad de Azure Storage](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="9c7da-177">For more information on partitions see [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md).</span></span>  

<span data-ttu-id="9c7da-178">Hola servicio tabla, un nodo individual de servicios de uno o varios completar las particiones y Hola escalas de servicio mediante Equilibrio de carga de forma dinámica particiones entre nodos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-178">In hello Table service, an individual node services one or more complete partitions and hello service scales by dynamically load-balancing partitions across nodes.</span></span> <span data-ttu-id="9c7da-179">Si un nodo está bajo carga, servicio de la tabla de hello puede *dividir* intervalo Hola de particiones da servicio ese nodo en nodos diferentes; cuando desaparezca el tráfico, puede servicio hello *mezcla* partición Hola comprendido entre nodos silenciosos en un único nodo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-179">If a node is under load, hello table service can *split* hello range of partitions serviced by that node onto different nodes; when traffic subsides, hello service can *merge* hello partition ranges from quiet nodes back onto a single node.</span></span>  

<span data-ttu-id="9c7da-180">Para obtener más información acerca de Hola servicio tabla Detalles internos de hello y, en particular cómo servicio hello: administra las particiones, vea papel hello [almacenamiento de Microsoft Azure: A altamente disponible en la nube servicio de almacenamiento seguro coherencia](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-180">For more information about hello internal details of hello Table service, and in particular how hello service manages partitions, see hello paper [Microsoft Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span></span>  

### <a name="entity-group-transactions"></a><span data-ttu-id="9c7da-181">Transacciones de grupo de entidad</span><span class="sxs-lookup"><span data-stu-id="9c7da-181">Entity Group Transactions</span></span>
<span data-ttu-id="9c7da-182">Hola servicio tabla, las transacciones de grupo de entidad (EGTs) son el mecanismo de solo integrados de Hola para llevar a cabo actualizaciones atómicas en varias entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-182">In hello Table service, Entity Group Transactions (EGTs) are hello only built-in mechanism for performing atomic updates across multiple entities.</span></span> <span data-ttu-id="9c7da-183">EGTs también son que se hace referencia tooas *procesar por lotes las transacciones* en algunos documentos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-183">EGTs are also referred tooas *batch transactions* in some documentation.</span></span> <span data-ttu-id="9c7da-184">EGTs sólo pueden funcionar en entidades almacenadas en hello misma partición (Hola de recurso compartido misma clave de partición en una tabla determinada), por lo que siempre que necesite comportamiento transaccional atómica a través de varias entidades necesita tooensure que esas entidades se encuentran en hello misma partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-184">EGTs can only operate on entities stored in hello same partition (share hello same partition key in a given table), so anytime you need atomic transactional behavior across multiple entities you need tooensure that those entities are in hello same partition.</span></span> <span data-ttu-id="9c7da-185">Por lo general, suele ser una razón para conservar varios tipos de entidad en hello misma tabla (y crear particiones) y no utilizar varias tablas para los tipos de entidad diferente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-185">This is often a reason for keeping multiple entity types in hello same table (and partition) and not using multiple tables for different entity types.</span></span> <span data-ttu-id="9c7da-186">Una sola EGT puede operar en 100 entidades como máximo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-186">A single EGT can operate on at most 100 entities.</span></span>  <span data-ttu-id="9c7da-187">Si envía varios EGTs simultáneas para procesarlo es importante tooensure esas EGTs no funcionar en entidades que son comunes entre EGTs tal y como se puede retrasar el procesamiento en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="9c7da-187">If you submit multiple concurrent EGTs for processing it is important tooensure  those EGTs do not operate on entities that are common across EGTs as otherwise processing can be delayed.</span></span>

<span data-ttu-id="9c7da-188">EGTs también presentan una solución de compromiso potencial para tooevaluate en el diseño: uso más particiones aumentará la escalabilidad de saludo de la aplicación porque Azure tiene más oportunidades para equilibrar las solicitudes en todos los nodos, pero esto podría limitar Hola capacidad de las transacciones atómicas tooperform de aplicación y mantener la coherencia segura para los datos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-188">EGTs also introduce a potential trade-off for you tooevaluate in your design: using more partitions will increase hello scalability of your application because Azure has more opportunities for load balancing requests across nodes, but this might limit hello ability of your application tooperform atomic transactions and maintain strong consistency for your data.</span></span> <span data-ttu-id="9c7da-189">Además, hay objetivos de escalabilidad específico en el nivel de Hola de una partición que puede limitar el rendimiento de Hola de las transacciones que se pueden esperar de un solo nodo: para obtener más información acerca de los destinos de escalabilidad de Hola para cuentas de almacenamiento de Azure y tabla de Hola servicio, vea [objetivos de rendimiento y escalabilidad de almacenamiento de Azure](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="9c7da-189">Furthermore, there are specific scalability targets at hello level of a partition that might limit hello throughput of transactions you can expect for a single node: for more information about hello scalability targets for Azure storage accounts and hello table service, see [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md).</span></span> <span data-ttu-id="9c7da-190">En secciones posteriores de esta guía trata sobre diversas estrategias que le ayudarán a administración ventajas e inconvenientes como éste y comente la mejor toochoose su clave de partición basado en requisitos específicos de saludo de la aplicación de cliente de diseño.</span><span class="sxs-lookup"><span data-stu-id="9c7da-190">Later sections of this guide discuss various design strategies that help you manage trade-offs such as this one, and discuss how best toochoose your partition key based on hello specific requirements of your client application.</span></span>  

### <a name="capacity-considerations"></a><span data-ttu-id="9c7da-191">Consideraciones de capacidad</span><span class="sxs-lookup"><span data-stu-id="9c7da-191">Capacity considerations</span></span>
<span data-ttu-id="9c7da-192">Hello tabla siguiente incluyen algunos toobe de valores de clave de hello en cuenta al diseñar una solución de servicio de tabla:</span><span class="sxs-lookup"><span data-stu-id="9c7da-192">hello following table includes some of hello key values toobe aware of when you are designing a Table service solution:</span></span>  

| <span data-ttu-id="9c7da-193">Capacidad total de una cuenta de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="9c7da-193">Total capacity of an Azure storage account</span></span> | <span data-ttu-id="9c7da-194">500 TB</span><span class="sxs-lookup"><span data-stu-id="9c7da-194">500 TB</span></span> |
| --- | --- |
| <span data-ttu-id="9c7da-195">Número de tablas en una cuenta de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="9c7da-195">Number of tables in an Azure storage account</span></span> |<span data-ttu-id="9c7da-196">Limitado solo por la capacidad de Hola de cuenta de almacenamiento de Hola</span><span class="sxs-lookup"><span data-stu-id="9c7da-196">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="9c7da-197">Número de particiones en una tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-197">Number of partitions in a table</span></span> |<span data-ttu-id="9c7da-198">Limitado solo por la capacidad de Hola de cuenta de almacenamiento de Hola</span><span class="sxs-lookup"><span data-stu-id="9c7da-198">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="9c7da-199">Número de entidades de una partición</span><span class="sxs-lookup"><span data-stu-id="9c7da-199">Number of entities in a partition</span></span> |<span data-ttu-id="9c7da-200">Limitado solo por la capacidad de Hola de cuenta de almacenamiento de Hola</span><span class="sxs-lookup"><span data-stu-id="9c7da-200">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="9c7da-201">Tamaño de una entidad individual</span><span class="sxs-lookup"><span data-stu-id="9c7da-201">Size of an individual entity</span></span> |<span data-ttu-id="9c7da-202">Una copia de seguridad too1 MB con un máximo de 255 propiedades (incluidos hello **PartitionKey**, **RowKey**, y **Timestamp**)</span><span class="sxs-lookup"><span data-stu-id="9c7da-202">Up too1 MB with a maximum of 255 properties (including hello **PartitionKey**, **RowKey**, and **Timestamp**)</span></span> |
| <span data-ttu-id="9c7da-203">Tamaño de hello **PartitionKey**</span><span class="sxs-lookup"><span data-stu-id="9c7da-203">Size of hello **PartitionKey**</span></span> |<span data-ttu-id="9c7da-204">Una cadena de seguridad too1 KB de tamaño</span><span class="sxs-lookup"><span data-stu-id="9c7da-204">A string up too1 KB in size</span></span> |
| <span data-ttu-id="9c7da-205">Tamaño de hello **RowKey**</span><span class="sxs-lookup"><span data-stu-id="9c7da-205">Size of hello **RowKey**</span></span> |<span data-ttu-id="9c7da-206">Una cadena de seguridad too1 KB de tamaño</span><span class="sxs-lookup"><span data-stu-id="9c7da-206">A string up too1 KB in size</span></span> |
| <span data-ttu-id="9c7da-207">Tamaño de una transacción de un grupo de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-207">Size of an Entity Group Transaction</span></span> |<span data-ttu-id="9c7da-208">Una transacción puede incluir como máximo 100 entidades y carga de hello debe ser inferior a 4 MB de tamaño.</span><span class="sxs-lookup"><span data-stu-id="9c7da-208">A transaction can include at most 100 entities and hello payload must be less than 4 MB in size.</span></span> <span data-ttu-id="9c7da-209">Un EGT solo puede actualizar una entidad una vez.</span><span class="sxs-lookup"><span data-stu-id="9c7da-209">An EGT can only update an entity once.</span></span> |

<span data-ttu-id="9c7da-210">Para obtener más información, consulte [Hola de entender el modelo de datos del servicio de tabla](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-210">For more information, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>  

### <a name="cost-considerations"></a><span data-ttu-id="9c7da-211">Consideraciones sobre el coste</span><span class="sxs-lookup"><span data-stu-id="9c7da-211">Cost considerations</span></span>
<span data-ttu-id="9c7da-212">Almacenamiento de tabla es relativamente económico, pero debe incluir las estimaciones de costos para ambos cantidad de capacidad de Hola y el uso de transacciones como parte de la evaluación de cualquier solución que utilice el servicio de la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-212">Table storage is relatively inexpensive, but you should include cost estimates for both capacity usage and hello quantity of transactions as part of your evaluation of any solution that uses hello Table service.</span></span> <span data-ttu-id="9c7da-213">Sin embargo, en muchos escenarios de almacenamiento de datos duplicados o sin normalizar en hello tooimprove de orden rendimiento o la escalabilidad de la solución es un enfoque válido tootake.</span><span class="sxs-lookup"><span data-stu-id="9c7da-213">However, in many scenarios storing denormalized or duplicate data in order tooimprove hello performance or scalability of your solution is a valid approach tootake.</span></span> <span data-ttu-id="9c7da-214">Para obtener más información sobre los precios, consulte [Precios de Azure Storage](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="9c7da-214">For more information about pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>  

## <a name="guidelines-for-table-design"></a><span data-ttu-id="9c7da-215">Directrices para el diseño de tablas</span><span class="sxs-lookup"><span data-stu-id="9c7da-215">Guidelines for table design</span></span>
<span data-ttu-id="9c7da-216">Estas listas resumen algunas de las instrucciones de clave de hello que debe tener en cuenta al diseñar las tablas y, en esta guía se tratarlas en más detalle más adelante en.</span><span class="sxs-lookup"><span data-stu-id="9c7da-216">These lists summarize some of hello key guidelines you should keep in mind when you are designing your tables, and this guide will address them all in more detail later in.</span></span> <span data-ttu-id="9c7da-217">Estas instrucciones son muy diferentes de directrices de Hola para ello se usaría normalmente para el diseño de la base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="9c7da-217">These guidelines are very different from hello guidelines you would typically follow for relational database design.</span></span>  

<span data-ttu-id="9c7da-218">Diseñar la toobe de solución de servicio de tabla *leer* eficaz:</span><span class="sxs-lookup"><span data-stu-id="9c7da-218">Designing your Table service solution toobe *read* efficient:</span></span>

* <span data-ttu-id="9c7da-219">***Diseño para realizar consultas en aplicaciones con muchas lecturas.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-219">***Design for querying in read-heavy applications.***</span></span> <span data-ttu-id="9c7da-220">Al diseñar las tablas, tenga en cuenta las consultas de hello (especialmente Hola latencia de las minúsculas) que va a ejecutar antes de pensar en cómo se actualizarán las entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-220">When you are designing your tables, think about hello queries (especially hello latency sensitive ones) that you will execute before you think about how you will update your entities.</span></span> <span data-ttu-id="9c7da-221">Normalmente esto produce una solución eficiente y de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-221">This typically results in an efficient and performant solution.</span></span>  
* <span data-ttu-id="9c7da-222">***Especificar tanto PartitionKey como RowKey en sus consultas.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-222">***Specify both PartitionKey and RowKey in your queries.***</span></span> <span data-ttu-id="9c7da-223">*Seleccione las consultas* , como se trata de consultas del servicio de tabla más eficaces de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-223">*Point queries* such as these are hello most efficient table service queries.</span></span>  
* <span data-ttu-id="9c7da-224">***Tenga en cuenta la posibilidad de almacenar copias duplicadas de las entidades.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-224">***Consider storing duplicate copies of entities.***</span></span> <span data-ttu-id="9c7da-225">Almacenamiento de tabla es barato por lo que puede almacenar Hola misma entidad varias veces (con claves diferentes) tooenable consultas más eficaces.</span><span class="sxs-lookup"><span data-stu-id="9c7da-225">Table storage is cheap so consider storing hello same entity multiple times (with different keys) tooenable more efficient queries.</span></span>  
* <span data-ttu-id="9c7da-226">***Considere la posibilidad de desnormalizar sus datos.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-226">***Consider denormalizing your data.***</span></span> <span data-ttu-id="9c7da-227">El almacenamiento en tablas es barato, por tanto, piense en desnormalizar sus datos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-227">Table storage is cheap so consider denormalizing your data.</span></span> <span data-ttu-id="9c7da-228">Por ejemplo, almacenar entidades de resumen para que las consultas de datos agregados sólo necesitan tooaccess una sola entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-228">For example, store summary entities so that queries for aggregate data only need tooaccess a single entity.</span></span>  
* <span data-ttu-id="9c7da-229">***Use valores de clave compuestos.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-229">***Use compound key values.***</span></span> <span data-ttu-id="9c7da-230">Hello solo claves tiene son **PartitionKey** y **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-230">hello only keys you have are **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="9c7da-231">Por ejemplo, utilice tooentities de rutas de acceso de valores de clave compuesta tooenable acceso con claves alternativas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-231">For example, use compound key values tooenable alternate keyed access paths tooentities.</span></span>  
* <span data-ttu-id="9c7da-232">***Use la proyección de consultas.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-232">***Use query projection.***</span></span> <span data-ttu-id="9c7da-233">Puede reducir la cantidad de Hola de datos que transfieren por red hello mediante el uso de consultas que seleccionan solo los campos de hello que necesarios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-233">You can reduce hello amount of data that you transfer over hello network by using queries that select just hello fields you need.</span></span>  

<span data-ttu-id="9c7da-234">Diseñar la toobe de solución de servicio de tabla *escribir* eficaz:</span><span class="sxs-lookup"><span data-stu-id="9c7da-234">Designing your Table service solution toobe *write* efficient:</span></span>  

* <span data-ttu-id="9c7da-235">***No cree particiones activas.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-235">***Do not create hot partitions.***</span></span> <span data-ttu-id="9c7da-236">Elija las solicitudes de teclas que le permiten toospread en varias particiones en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-236">Choose keys that enable you toospread your requests across multiple partitions at any point of time.</span></span>  
* <span data-ttu-id="9c7da-237">***Evite picos de tráfico.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-237">***Avoid spikes in traffic.***</span></span> <span data-ttu-id="9c7da-238">Suavizar el tráfico de Hola durante un período razonable de tiempo y evitar picos de tráfico.</span><span class="sxs-lookup"><span data-stu-id="9c7da-238">Smooth hello traffic over a reasonable period of time and avoid spikes in traffic.</span></span>
* <span data-ttu-id="9c7da-239">***No es preciso crear necesariamente una tabla independiente para cada tipo de entidad.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-239">***Don't necessarily create a separate table for each type of entity.***</span></span> <span data-ttu-id="9c7da-240">Cuando necesite transacciones atómicas en tipos de entidad, puede almacenar estos varios tipos de entidad en hello igual de partición en hello misma tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-240">When you require atomic transactions across entity types, you can store these multiple entity types in hello same partition in hello same table.</span></span>
* <span data-ttu-id="9c7da-241">***Tenga en cuenta que debe lograr el rendimiento máximo Hola.***</span><span class="sxs-lookup"><span data-stu-id="9c7da-241">***Consider hello maximum throughput you must achieve.***</span></span> <span data-ttu-id="9c7da-242">Debe tener en cuenta los objetivos de escalabilidad de Hola de hello servicio tabla y asegurarse de que su diseño no hará que tooexceed ellos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-242">You must be aware of hello scalability targets for hello Table service and ensure that your design will not cause you tooexceed them.</span></span>  

<span data-ttu-id="9c7da-243">A medida que lea esta guía, verá ejemplos en los que se ponen en práctica todos estos principios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-243">As you read this guide, you will see examples that put all of these principles into practice.</span></span>  

## <a name="design-for-querying"></a><span data-ttu-id="9c7da-244">Diseño de consulta</span><span class="sxs-lookup"><span data-stu-id="9c7da-244">Design for querying</span></span>
<span data-ttu-id="9c7da-245">Soluciones de servicio de tabla pueden ser lectura intensiva, escritura intensiva o una combinación de hello dos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-245">Table service solutions may be read intensive, write intensive, or a mix of hello two.</span></span> <span data-ttu-id="9c7da-246">En esta sección se centra en hello toobear de cosas en cuenta al diseñar su toosupport de servicio de tabla las operaciones de lectura de forma eficaz.</span><span class="sxs-lookup"><span data-stu-id="9c7da-246">This section focuses on hello things toobear in mind when you are designing your Table service toosupport read operations efficiently.</span></span> <span data-ttu-id="9c7da-247">Normalmente, un diseño que admite operaciones de lectura eficazmente también es eficaz para las operaciones de escritura.</span><span class="sxs-lookup"><span data-stu-id="9c7da-247">Typically, a design that supports read operations efficiently is also efficient for write operations.</span></span> <span data-ttu-id="9c7da-248">Sin embargo, hay consideraciones adicionales toobear en cuenta al diseñar toosupport escribir operaciones, descritas en la siguiente sección hello, [diseño para la modificación de datos](#design-for-data-modification).</span><span class="sxs-lookup"><span data-stu-id="9c7da-248">However, there are additional considerations toobear in mind when designing toosupport write operations, discussed in hello next section, [Design for data modification](#design-for-data-modification).</span></span>

<span data-ttu-id="9c7da-249">Un buen punto de partida para diseñar su tooenable de solución de servicio de tabla tooread datos eficazmente están tooask "las consultas que será necesario tooexecute tooretrieve Hola datos de mi aplicación que necesita de hello servicio tabla?"</span><span class="sxs-lookup"><span data-stu-id="9c7da-249">A good starting point for designing your Table service solution tooenable you tooread data efficiently is tooask "What queries will my application need tooexecute tooretrieve hello data it needs from hello Table service?"</span></span>  

> [!NOTE]
> <span data-ttu-id="9c7da-250">Con hello servicio tabla, es importante tooget Hola correcto de diseño por adelantado porque es difícil y costosa toochange que más adelante.</span><span class="sxs-lookup"><span data-stu-id="9c7da-250">With hello Table service, it's important tooget hello design correct up front because it's difficult and expensive toochange it later.</span></span> <span data-ttu-id="9c7da-251">Por ejemplo, en una base de datos relacional a menudo resulta tooaddress posibles problemas de rendimiento mediante la adición de índices de base de datos existente de tooan: no es una opción con hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-251">For example, in a relational database it's often possible tooaddress performance issues simply by adding indexes tooan existing database: this is not an option with hello Table service.</span></span>  
> 
> 

<span data-ttu-id="9c7da-252">En esta sección se centra en los problemas clave de Hola que debe tratar al diseñar las tablas para las consultas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-252">This section focuses on hello key issues you must address when you design your tables for querying.</span></span> <span data-ttu-id="9c7da-253">Hola los temas tratados en esta sección incluyen:</span><span class="sxs-lookup"><span data-stu-id="9c7da-253">hello topics covered in this section include:</span></span>

* [<span data-ttu-id="9c7da-254">Cómo afecta al rendimiento de las consultas su elección de PartitionKey y RowKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-254">How your choice of PartitionKey and RowKey impacts query performance</span></span>](#how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance)
* [<span data-ttu-id="9c7da-255">Elegir un PartitionKey apropiado</span><span class="sxs-lookup"><span data-stu-id="9c7da-255">Choosing an appropriate PartitionKey</span></span>](#choosing-an-appropriate-partitionkey)
* [<span data-ttu-id="9c7da-256">Optimizar las consultas para hello servicio tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-256">Optimizing queries for hello Table service</span></span>](#optimizing-queries-for-the-table-service)
* [<span data-ttu-id="9c7da-257">Ordenar datos en hello servicio tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-257">Sorting data in hello Table service</span></span>](#sorting-data-in-the-table-service)

### <a name="how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance"></a><span data-ttu-id="9c7da-258">Cómo afecta al rendimiento de las consultas su elección de PartitionKey y RowKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-258">How your choice of PartitionKey and RowKey impacts query performance</span></span>
<span data-ttu-id="9c7da-259">Hello en los ejemplos siguientes se suponen servicio de la tabla de hello es almacenar entidades employee con hello siguiendo estructura (la mayoría de los ejemplos de hello omite hello **Timestamp** propiedad por motivos de claridad):</span><span class="sxs-lookup"><span data-stu-id="9c7da-259">hello following examples assume hello table service is storing employee entities with hello following structure (most of hello examples omit hello **Timestamp** property for clarity):</span></span>  

| <span data-ttu-id="9c7da-260">*Nombre de la columna*</span><span class="sxs-lookup"><span data-stu-id="9c7da-260">*Column name*</span></span> | <span data-ttu-id="9c7da-261">*Tipo de datos*</span><span class="sxs-lookup"><span data-stu-id="9c7da-261">*Data type*</span></span> |
| --- | --- |
| <span data-ttu-id="9c7da-262">**PartitionKey** (nombre de departamento)</span><span class="sxs-lookup"><span data-stu-id="9c7da-262">**PartitionKey** (Department Name)</span></span> |<span data-ttu-id="9c7da-263">String</span><span class="sxs-lookup"><span data-stu-id="9c7da-263">String</span></span> |
| <span data-ttu-id="9c7da-264">**RowKey** (Identificación de empleado)</span><span class="sxs-lookup"><span data-stu-id="9c7da-264">**RowKey** (Employee Id)</span></span> |<span data-ttu-id="9c7da-265">String</span><span class="sxs-lookup"><span data-stu-id="9c7da-265">String</span></span> |
| <span data-ttu-id="9c7da-266">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="9c7da-266">**FirstName**</span></span> |<span data-ttu-id="9c7da-267">String</span><span class="sxs-lookup"><span data-stu-id="9c7da-267">String</span></span> |
| <span data-ttu-id="9c7da-268">**Apellidos**</span><span class="sxs-lookup"><span data-stu-id="9c7da-268">**LastName**</span></span> |<span data-ttu-id="9c7da-269">String</span><span class="sxs-lookup"><span data-stu-id="9c7da-269">String</span></span> |
| <span data-ttu-id="9c7da-270">**Edad**</span><span class="sxs-lookup"><span data-stu-id="9c7da-270">**Age**</span></span> |<span data-ttu-id="9c7da-271">Entero</span><span class="sxs-lookup"><span data-stu-id="9c7da-271">Integer</span></span> |
| <span data-ttu-id="9c7da-272">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="9c7da-272">**EmailAddress**</span></span> |<span data-ttu-id="9c7da-273">String</span><span class="sxs-lookup"><span data-stu-id="9c7da-273">String</span></span> |

<span data-ttu-id="9c7da-274">Hola sección anterior [Introducción al servicio tabla de Azure](#overview) se describen algunas características clave Hola de hello servicio tabla de Azure que tienen una influencia directa en el diseño de la consulta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-274">hello earlier section [Azure Table service overview](#overview) describes some of hello key features of hello Azure Table service that have a direct influence on designing for query.</span></span> <span data-ttu-id="9c7da-275">Estos dan como resultado de hello siguiendo las directrices generales para diseñar las consultas del servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-275">These result in hello following general guidelines for designing Table service queries.</span></span> <span data-ttu-id="9c7da-276">Tenga en cuenta que es sintaxis de filtro de hello usada en ejemplos de hello siguientes desde el servicio de tabla de hello API de REST, para más información, vea [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-276">Note that hello filter syntax used in hello examples below is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

* <span data-ttu-id="9c7da-277">A ***punto consulta*** es toouse de búsqueda más eficaz de Hola y se recomienda toobe utilizada para realizar búsquedas de gran volumen o búsquedas que requieren menor latencia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-277">A ***Point Query*** is hello most efficient lookup toouse and is recommended toobe used for high-volume lookups or lookups requiring lowest latency.</span></span> <span data-ttu-id="9c7da-278">Este tipo de consulta puede utilizan de manera muy eficaz Hola índices toolocate una entidad individual mediante la especificación de ambos Hola **PartitionKey** y **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-278">Such a query can use hello indexes toolocate an individual entity very efficiently by specifying both hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-279">Por ejemplo: $filter=(PartitionKey eq 'Sales') y (RowKey eq '2')</span><span class="sxs-lookup"><span data-stu-id="9c7da-279">For example: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span></span>  
* <span data-ttu-id="9c7da-280">En segundo lugar mejor es un ***consulta por rango*** que usa hello **PartitionKey** y filtros en un intervalo de **RowKey** valores tooreturn más de una entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-280">Second best is a ***Range Query*** that uses hello **PartitionKey** and filters on a range of **RowKey** values tooreturn more than one entity.</span></span> <span data-ttu-id="9c7da-281">Hola **PartitionKey** valor identifica una partición específica y hello **RowKey** valores identifican un subconjunto de las entidades de hello en esa partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-281">hello **PartitionKey** value identifies a specific partition, and hello **RowKey** values identify a subset of hello entities in that partition.</span></span> <span data-ttu-id="9c7da-282">Por ejemplo: $filter=PartitionKey eq 'Sales”, RowKey ge 'S' y RowKey lt 'T'</span><span class="sxs-lookup"><span data-stu-id="9c7da-282">For example: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span></span>  
* <span data-ttu-id="9c7da-283">Tercer lo mejor es un ***partición examinar*** que usa hello **PartitionKey** y filtros en otra propiedad de no son de clave y que pueden devolver más de una entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-283">Third best is a ***Partition Scan*** that uses hello **PartitionKey** and filters on another non-key property and that may return more than one entity.</span></span> <span data-ttu-id="9c7da-284">Hola **PartitionKey** valor identifica una partición específica, y seleccione un subconjunto de las entidades de hello en esa partición de valores de propiedad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-284">hello **PartitionKey** value identifies a specific partition, and hello property values select for a subset of hello entities in that partition.</span></span> <span data-ttu-id="9c7da-285">Por ejemplo: $filter=PartitionKey eq 'Sales' y LastName eq 'Smith'</span><span class="sxs-lookup"><span data-stu-id="9c7da-285">For example: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span></span>  
* <span data-ttu-id="9c7da-286">A ***Table Scan*** no incluye hello **PartitionKey** y es muy eficaz ya que busca en todas las particiones de Hola que componen la tabla a su vez para todas las entidades coincidentes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-286">A ***Table Scan*** does not include hello **PartitionKey** and is very inefficient because it searches all of hello partitions that make up your table in turn for any matching entities.</span></span> <span data-ttu-id="9c7da-287">Llevará a cabo un recorrido de tabla, independientemente de si su filtro usa hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-287">It will perform a table scan regardless of whether or not your filter uses hello **RowKey**.</span></span> <span data-ttu-id="9c7da-288">Por ejemplo: $filter=LastName eq 'Jones'</span><span class="sxs-lookup"><span data-stu-id="9c7da-288">For example: $filter=LastName eq 'Jones'</span></span>  
* <span data-ttu-id="9c7da-289">Las consultas que devuelven varias entidades las devuelven ordenadas en orden **PartitionKey** y **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-289">Queries that return multiple entities return them sorted in **PartitionKey** and **RowKey** order.</span></span> <span data-ttu-id="9c7da-290">tooavoid de entidades de hello ordenar de nuevo en el cliente de hello, elija un **RowKey** que define el criterio de ordenación de hello más comunes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-290">tooavoid resorting hello entities in hello client, choose a **RowKey** that defines hello most common sort order.</span></span>  

<span data-ttu-id="9c7da-291">Tenga en cuenta que cuando se utiliza un "**o**" toospecify un filtro basado en **RowKey** valores da como resultado un examen de la partición y no se trata como una consulta por rango.</span><span class="sxs-lookup"><span data-stu-id="9c7da-291">Note that using an "**or**" toospecify a filter based on **RowKey** values results in a partition scan and is not treated as a range query.</span></span> <span data-ttu-id="9c7da-292">Por lo tanto, debe evitar las consultas que usan filtros como: $filter=PartitionKey eq 'Sales' y (RowKey eq '121' o RowKey eq '322')</span><span class="sxs-lookup"><span data-stu-id="9c7da-292">Therefore, you should avoid queries that use filters such as: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span></span>  

<span data-ttu-id="9c7da-293">Para obtener ejemplos de código de cliente que usan consultas eficaces de hello biblioteca cliente de almacenamiento tooexecute, consulte:</span><span class="sxs-lookup"><span data-stu-id="9c7da-293">For examples of client-side code that use hello Storage Client Library tooexecute efficient queries, see:</span></span>  

* [<span data-ttu-id="9c7da-294">Ejecutar una consulta de punto mediante Hola biblioteca cliente de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="9c7da-294">Executing a point query using hello Storage Client Library</span></span>](#executing-a-point-query-using-the-storage-client-library)
* [<span data-ttu-id="9c7da-295">Recuperar varias entidades con LINQ</span><span class="sxs-lookup"><span data-stu-id="9c7da-295">Retrieving multiple entities using LINQ</span></span>](#retrieving-multiple-entities-using-linq)
* [<span data-ttu-id="9c7da-296">Proyección de servidor</span><span class="sxs-lookup"><span data-stu-id="9c7da-296">Server-side projection</span></span>](#server-side-projection)  

<span data-ttu-id="9c7da-297">Para obtener ejemplos de código de cliente que puede controlar varios entidad tipos almacenan en hello misma tabla, vea:</span><span class="sxs-lookup"><span data-stu-id="9c7da-297">For examples of client-side code that can handle multiple entity types stored in hello same table, see:</span></span>  

* [<span data-ttu-id="9c7da-298">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-298">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="choosing-an-appropriate-partitionkey"></a><span data-ttu-id="9c7da-299">Elegir un PartitionKey apropiado</span><span class="sxs-lookup"><span data-stu-id="9c7da-299">Choosing an appropriate PartitionKey</span></span>
<span data-ttu-id="9c7da-300">La elección de **PartitionKey** debe equilibrar Hola necesidad tooenables Hola utilizar EGTs (tooensure coherencia) contra Hola requisito toodistribute las entidades en varias particiones (tooensure una solución escalable).</span><span class="sxs-lookup"><span data-stu-id="9c7da-300">Your choice of **PartitionKey** should balance hello need tooenables hello use of EGTs (tooensure consistency) against hello requirement toodistribute your entities across multiple partitions (tooensure a scalable solution).</span></span>  

<span data-ttu-id="9c7da-301">En un extremo, podría almacenar todas las entidades en una sola partición, pero esto puede limitar la escalabilidad de saludo de la solución y evitaría que servicio de la tabla de Hola se pueda tooload-equilibrar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-301">At one extreme, you could store all your entities in a single partition, but this may limit hello scalability of your solution and would prevent hello table service from being able tooload-balance requests.</span></span> <span data-ttu-id="9c7da-302">En hello otro extremo, puede almacenar una entidad por partición, lo que sería muy escalable y lo que permite tooload equilibrar las solicitudes del servicio de tabla hello, pero que impiden que se usan transacciones de grupo de entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-302">At hello other extreme, you could store one entity per partition, which would be highly scalable and which enables hello table service tooload-balance requests, but which would prevent you from using entity group transactions.</span></span>  

<span data-ttu-id="9c7da-303">Ideal **PartitionKey** es aquel que le permite conseguir consultas eficaces toouse y que tiene suficientes tooensure de particiones, la solución es escalable.</span><span class="sxs-lookup"><span data-stu-id="9c7da-303">An ideal **PartitionKey** is one that enables you toouse efficient queries and that has sufficient partitions tooensure your solution is scalable.</span></span> <span data-ttu-id="9c7da-304">Normalmente, encontrará que las entidades tendrán una propiedad adecuada que distribuye las entidades entre particiones suficientes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-304">Typically, you will find that your entities will have a suitable property that distributes your entities across sufficient partitions.</span></span>

> [!NOTE]
> <span data-ttu-id="9c7da-305">Por ejemplo, en un sistema que almacena información acerca de los usuarios o empleados, el identificador del usuario puede ser un buen PartitionKey.</span><span class="sxs-lookup"><span data-stu-id="9c7da-305">For example, in a system that stores information about users or employees, UserID may be a good PartitionKey.</span></span> <span data-ttu-id="9c7da-306">Puede tener varias entidades que utilizan un determinado identificador de usuario como clave de partición de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-306">You may have several entities that use a given UserID as hello partition key.</span></span> <span data-ttu-id="9c7da-307">Cada entidad que almacena los datos de un usuario se agrupa en una sola partición y, de esta manera estas entidades están accesibles a través de las transacciones de grupo de entidad, y continúan siendo altamente escalables.</span><span class="sxs-lookup"><span data-stu-id="9c7da-307">Each entity that stores data about a user is grouped into a single partition, and so these entities are accessible via entity group transactions, while still being highly scalable.</span></span>
> 
> 

<span data-ttu-id="9c7da-308">Existen consideraciones adicionales en su elección de **PartitionKey** que relacionan toohow se insertar, actualizar y eliminar entidades: consulte la sección de hello [diseño para la modificación de datos](#design-for-data-modification) a continuación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-308">There are additional considerations in your choice of **PartitionKey** that relate toohow you will insert, update, and delete entities: see hello section [Design for data modification](#design-for-data-modification) below.</span></span>  

### <a name="optimizing-queries-for-hello-table-service"></a><span data-ttu-id="9c7da-309">Optimizar las consultas para hello servicio tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-309">Optimizing queries for hello Table service</span></span>
<span data-ttu-id="9c7da-310">Hola servicio tabla indizará automáticamente las entidades con hello **PartitionKey** y **RowKey** valores en un índice clúster único, por lo tanto, Hola motivo que las consultas de punto se Hola toouse más eficaz .</span><span class="sxs-lookup"><span data-stu-id="9c7da-310">hello Table service automatically indexes your entities using hello **PartitionKey** and **RowKey** values in a single clustered index, hence hello reason that point queries are hello most efficient toouse.</span></span> <span data-ttu-id="9c7da-311">Sin embargo, no hay ningún índice distinto en el índice agrupado de hello en hello **PartitionKey** y **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-311">However, there are no indexes other than that on hello clustered index on hello **PartitionKey** and **RowKey**.</span></span>

<span data-ttu-id="9c7da-312">Muchos diseños deben cumplir con búsqueda de tooenable requisitos de entidades basándose en varios criterios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-312">Many designs must meet requirements tooenable lookup of entities based on multiple criteria.</span></span> <span data-ttu-id="9c7da-313">Por ejemplo, localizar las entidades employee en función de correo electrónico, Id. de empleado o apellido.</span><span class="sxs-lookup"><span data-stu-id="9c7da-313">For example, locating employee entities based on email, employee id, or last name.</span></span> <span data-ttu-id="9c7da-314">Hola siguientes patrones en la sección de hello [patrones de diseño de tabla](#table-design-patterns) tratar estos tipos de requisito y se describen las formas de trabajar con los hechos de Hola que el servicio de la tabla de Hola no proporciona índices secundarios:</span><span class="sxs-lookup"><span data-stu-id="9c7da-314">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address these types of requirement and describe ways of working around hello fact that hello Table service does not provide secondary indexes:</span></span>  

* <span data-ttu-id="9c7da-315">[Patrón de índice secundario intra-partition](#intra-partition-secondary-index-pattern) -almacenar varias copias de cada entidad con diferentes **RowKey** valores (Hola misma partición) tooenable rápidos y eficaces búsquedas y ordenación alternativa se ordena mediante el uso de diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-315">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="9c7da-316">[Patrón de índice secundario de partición entre](#inter-partition-secondary-index-pattern) : almacenar varias copias de cada entidad con distintos valores de RowKey en particiones independientes o en tablas independientes tooenable rápida y búsquedas eficaces y ordenación alternativo se ordena mediante el uso de diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-316">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="9c7da-317">[Patrón de entidades de índice](#index-entities-pattern) -mantener el índice entidades tooenable búsquedas eficaces que devuelven listas de entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-317">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

### <a name="sorting-data-in-hello-table-service"></a><span data-ttu-id="9c7da-318">Ordenar datos en hello servicio tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-318">Sorting data in hello Table service</span></span>
<span data-ttu-id="9c7da-319">Hola servicio tabla devuelve las entidades que se ordenan en orden ascendente según **PartitionKey** y, a continuación, por **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-319">hello Table service returns entities sorted in ascending order based on **PartitionKey** and then by **RowKey**.</span></span> <span data-ttu-id="9c7da-320">Estas claves son valores de cadena y tooensure que los valores numéricos se ordenan correctamente, debe convertirlos tooa fijada de longitud y ellos rellenar con ceros.</span><span class="sxs-lookup"><span data-stu-id="9c7da-320">These keys are string values and tooensure that numeric values sort correctly, you should convert them tooa fixed length and pad them with zeroes.</span></span> <span data-ttu-id="9c7da-321">Por ejemplo, si hello valor de identificador de empleado use como hello **RowKey** es un valor entero, se debe convertir el Id. de empleado **123** demasiado**00000123**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-321">For example, if hello employee id value you use as hello **RowKey** is an integer value, you should convert employee id **123** too**00000123**.</span></span>  

<span data-ttu-id="9c7da-322">Muchas aplicaciones tienen requisitos toouse datos ordenan en un orden diferente: por ejemplo, ordenar los empleados por su nombre, o mediante la combinación de fecha.</span><span class="sxs-lookup"><span data-stu-id="9c7da-322">Many applications have requirements toouse data sorted in different orders: for example, sorting employees by name, or by joining date.</span></span> <span data-ttu-id="9c7da-323">Hola siguientes patrones en la sección de hello [patrones de diseño de tabla](#table-design-patterns) cómo tooalternate criterios de ordenación para las entidades de direcciones:</span><span class="sxs-lookup"><span data-stu-id="9c7da-323">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address how tooalternate sort orders for your entities:</span></span>  

* <span data-ttu-id="9c7da-324">[Patrón de índice secundario intra-partition](#intra-partition-secondary-index-pattern) -almacenar varias copias de cada entidad con distintos valores de RowKey (Hola misma partición) tooenable rápidos y eficaces búsquedas y ordenación alternativa ordena utilizando diferentes valores de RowKey.</span><span class="sxs-lookup"><span data-stu-id="9c7da-324">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>  
* <span data-ttu-id="9c7da-325">[Patrón de índice secundario de partición entre](#inter-partition-secondary-index-pattern) : almacenar varias copias de cada entidad con distintos valores de RowKey en particiones independientes en tablas independientes tooenable rápida y búsquedas eficaces y ordenación alternativo se ordena mediante el uso de diferentes RowKey valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-325">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions in separate tables tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>
* <span data-ttu-id="9c7da-326">[Patrón de final del registro](#log-tail-pattern) -recuperar hello  *n*  entidades agregan más recientemente tooa partición mediante el uso de un **RowKey** valor que ordena en fecha inversa y orden cronológico.</span><span class="sxs-lookup"><span data-stu-id="9c7da-326">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="design-for-data-modification"></a><span data-ttu-id="9c7da-327">Diseño para la modificación de datos</span><span class="sxs-lookup"><span data-stu-id="9c7da-327">Design for data modification</span></span>
<span data-ttu-id="9c7da-328">En esta sección se centra en las consideraciones de diseño de Hola para optimizar las inserciones, actualizaciones y eliminaciones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-328">This section focuses on hello design considerations for optimizing inserts, updates, and deletes.</span></span> <span data-ttu-id="9c7da-329">En algunos casos, será necesario ventajas y desventajas de tooevaluate Hola entre los diseños que optimizar para realizar una consulta en diseños de optimizar la modificación de datos tal como se hace en diseños de bases de datos relacionales (aunque Hola de técnicas de Hola para administrar el diseño ventajas e inconvenientes son diferentes en una base de datos relacional).</span><span class="sxs-lookup"><span data-stu-id="9c7da-329">In some cases, you will need tooevaluate hello trade-off between designs that optimize for querying against designs that optimize for data modification just as you do in designs for relational databases (although hello techniques for managing hello design trade-offs are different in a relational database).</span></span> <span data-ttu-id="9c7da-330">Hola sección [patrones de diseño de tabla](#table-design-patterns) se describen algunos modelos de diseño detallado de hello servicio tabla y destaca algunas de estas ventajas e inconvenientes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-330">hello section [Table Design Patterns](#table-design-patterns) describes some detailed design patterns for hello Table service and highlights some these trade-offs.</span></span> <span data-ttu-id="9c7da-331">En la práctica, encontrará que muchos diseños optimizados para consultar entidades también funcionan bien para la modificación de entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-331">In practice, you will find that many designs optimized for querying entities also work well for modifying entities.</span></span>  

### <a name="optimizing-hello-performance-of-insert-update-and-delete-operations"></a><span data-ttu-id="9c7da-332">Optimizar el rendimiento de Hola de insertar, actualizar y eliminar operaciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-332">Optimizing hello performance of insert, update, and delete operations</span></span>
<span data-ttu-id="9c7da-333">tooupdate o eliminar una entidad, debe ser capaz de tooidentify mediante hello **PartitionKey** y **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-333">tooupdate or delete an entity, you must be able tooidentify it by using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-334">En este sentido, la elección de **PartitionKey** y **RowKey** modificar entidades debe seguir similar criterios tooyour elección toosupport seleccione consultas ya que desea que las entidades de tooidentify como más eficaz posible.</span><span class="sxs-lookup"><span data-stu-id="9c7da-334">In this respect, your choice of **PartitionKey** and **RowKey** for modifying entities should follow similar criteria tooyour choice toosupport point queries because you want tooidentify entities as efficiently as possible.</span></span> <span data-ttu-id="9c7da-335">No desea toouse una toolocate de examen ineficaz de partición o tabla de una entidad en Hola de orden toodiscover **PartitionKey** y **RowKey** valores necesita tooupdate o eliminarlo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-335">You do not want toouse an inefficient partition or table scan toolocate an entity in order toodiscover hello **PartitionKey** and **RowKey** values you need tooupdate or delete it.</span></span>  

<span data-ttu-id="9c7da-336">Hola siguientes patrones en la sección de hello [patrones de diseño de tabla](#table-design-patterns) dirección de optimizar el rendimiento de Hola o la inserción, actualización y las operaciones de eliminación:</span><span class="sxs-lookup"><span data-stu-id="9c7da-336">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address optimizing hello performance or your insert, update, and delete operations:</span></span>  

* <span data-ttu-id="9c7da-337">[Eliminación del modelo de gran volumen](#high-volume-delete-pattern) -habilitar la eliminación de Hola de un gran volumen de entidades mediante el almacenamiento de todas las entidades de Hola para su eliminación simultánea en su propia tabla independiente; debe eliminar entidades de hello mediante la eliminación de la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-337">[High volume delete pattern](#high-volume-delete-pattern) - Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  
* <span data-ttu-id="9c7da-338">[Modelo de serie de datos](#data-series-pattern) -series de datos completa de almacén en un número de entidad única toominimize Hola de solicitudes que realice.</span><span class="sxs-lookup"><span data-stu-id="9c7da-338">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  
* <span data-ttu-id="9c7da-339">[Patrón de entidades amplia](#wide-entities-pattern) -usar varias entidades lógicas toostore de entidades físicas con más de 252 propiedades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-339">[Wide entities pattern](#wide-entities-pattern) - Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  
* <span data-ttu-id="9c7da-340">[Patrón de entidades de gran tamaño](#large-entities-pattern) -valores de propiedad grande de toostore de almacenamiento de blob de uso.</span><span class="sxs-lookup"><span data-stu-id="9c7da-340">[Large entities pattern](#large-entities-pattern) - Use blob storage toostore large property values.</span></span>  

### <a name="ensuring-consistency-in-your-stored-entities"></a><span data-ttu-id="9c7da-341">Garantizar la coherencia en las entidades almacenadas</span><span class="sxs-lookup"><span data-stu-id="9c7da-341">Ensuring consistency in your stored entities</span></span>
<span data-ttu-id="9c7da-342">Hola otro factor clave que influye en la elección de las claves para optimizar las modificaciones de datos es cómo tooensure coherencia mediante el uso de transacciones atómicas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-342">hello other key factor that influences your choice of keys for optimizing data modifications is how tooensure consistency by using atomic transactions.</span></span> <span data-ttu-id="9c7da-343">Solo puede usar un toooperate EGT en entidades almacenadas en hello misma partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-343">You can only use an EGT toooperate on entities stored in hello same partition.</span></span>  

<span data-ttu-id="9c7da-344">Hola siguientes patrones en la sección de hello [patrones de diseño de tabla](#table-design-patterns) administrar la coherencia de dirección:</span><span class="sxs-lookup"><span data-stu-id="9c7da-344">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address managing consistency:</span></span>  

* <span data-ttu-id="9c7da-345">[Patrón de índice secundario intra-partition](#intra-partition-secondary-index-pattern) -almacenar varias copias de cada entidad con diferentes **RowKey** valores (Hola misma partición) tooenable rápidos y eficaces búsquedas y ordenación alternativa se ordena mediante el uso de diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-345">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="9c7da-346">[Patrón de índice secundario de partición entre](#inter-partition-secondary-index-pattern) : almacenar varias copias de cada entidad con distintos valores de RowKey en particiones independientes o en tablas independientes tooenable rápida y búsquedas eficaces y ordenación alternativo se ordena mediante el uso de diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-346">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="9c7da-347">[Patrón final coherente de transacciones](#eventually-consistent-transactions-pattern) : habilitar el comportamiento final coherente a través de límites de partición o los límites del sistema de almacenamiento mediante el uso de las colas de Azure.</span><span class="sxs-lookup"><span data-stu-id="9c7da-347">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) - Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>
* <span data-ttu-id="9c7da-348">[Patrón de entidades de índice](#index-entities-pattern) -mantener el índice entidades tooenable búsquedas eficaces que devuelven listas de entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-348">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  
* <span data-ttu-id="9c7da-349">[Patrón de desnormalización](#denormalization-pattern) -combinar los datos relacionados con juntos en una sola entidad tooenable tooretrieve todos los datos que necesita con una consulta de punto único de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-349">[Denormalization pattern](#denormalization-pattern) - Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  
* <span data-ttu-id="9c7da-350">[Modelo de serie de datos](#data-series-pattern) -series de datos completa de almacén en un número de entidad única toominimize Hola de solicitudes que realice.</span><span class="sxs-lookup"><span data-stu-id="9c7da-350">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

<span data-ttu-id="9c7da-351">Para obtener información acerca de las transacciones de grupo de entidad, vea la sección de hello [transacciones de grupo de la entidad](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="9c7da-351">For information about entity group transactions, see hello section [Entity Group Transactions](#entity-group-transactions).</span></span>  

### <a name="ensuring-your-design-for-efficient-modifications-facilitates-efficient-queries"></a><span data-ttu-id="9c7da-352">Garantizar su diseño para efectuar modificaciones eficientes facilita la realización de consultas eficaces</span><span class="sxs-lookup"><span data-stu-id="9c7da-352">Ensuring your design for efficient modifications facilitates efficient queries</span></span>
<span data-ttu-id="9c7da-353">En muchos casos, un diseño para los resultados de consultas eficaz en modificaciones eficaz, pero siempre debe evaluar si se trata de caso de hello para su escenario concreto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-353">In many cases, a design for efficient querying results in efficient modifications, but you should always evaluate whether this is hello case for your specific scenario.</span></span> <span data-ttu-id="9c7da-354">Algunos de los patrones de hello en la sección de hello [patrones de diseño de tabla](#table-design-patterns) explícitamente evaluar ventajas y desventajas de consultar y modificar las entidades, y debe tener siempre en número de Hola de cuenta de cada tipo de operación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-354">Some of hello patterns in hello section [Table Design Patterns](#table-design-patterns) explicitly evaluate trade-offs between querying and modifying entities, and you should always take into account hello number of each type of operation.</span></span>  

<span data-ttu-id="9c7da-355">Hola siguientes patrones en la sección de hello [patrones de diseño de tabla](#table-design-patterns) ventajas y desventajas de diseño para conseguir consultas eficaces y diseño para la modificación de datos eficaz de direcciones:</span><span class="sxs-lookup"><span data-stu-id="9c7da-355">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address trade-offs between designing for efficient queries and designing for efficient data modification:</span></span>  

* <span data-ttu-id="9c7da-356">[Patrón de clave compuesta](#compound-key-pattern) -uso compuesta **RowKey** valores tooenable un toolookup de cliente relacionadas con datos con una consulta de punto único.</span><span class="sxs-lookup"><span data-stu-id="9c7da-356">[Compound key pattern](#compound-key-pattern) - Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  
* <span data-ttu-id="9c7da-357">[Patrón de final del registro](#log-tail-pattern) -recuperar hello  *n*  entidades agregan más recientemente tooa partición mediante el uso de un **RowKey** valor que ordena en fecha inversa y orden cronológico.</span><span class="sxs-lookup"><span data-stu-id="9c7da-357">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="encrypting-table-data"></a><span data-ttu-id="9c7da-358">Cifrado de datos de tablas</span><span class="sxs-lookup"><span data-stu-id="9c7da-358">Encrypting Table Data</span></span>
<span data-ttu-id="9c7da-359">Biblioteca de cliente de almacenamiento de Azure .NET admite el cifrado de propiedades de la entidad de cadena para la inserción de Hola y reemplace operaciones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-359">hello .NET Azure Storage Client Library supports encryption of string entity properties for insert and replace operations.</span></span> <span data-ttu-id="9c7da-360">cadenas de Hello cifrado se almacenan en el servicio de hello como propiedades binarias y se convierten toostrings atrás tras la descodificación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-360">hello encrypted strings are stored on hello service as binary properties, and they are converted back toostrings after decryption.</span></span>    

<span data-ttu-id="9c7da-361">Para las tablas, además toohello directiva de cifrado, los usuarios deben especificar Hola propiedades toobe cifrado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-361">For tables, in addition toohello encryption policy, users must specify hello properties toobe encrypted.</span></span> <span data-ttu-id="9c7da-362">Para ello, pueden especificar un atributo EncryptProperty (para las entidades POCO que se derivan de TableEntity) o una resolución de cifrado en las opciones de solicitud.</span><span class="sxs-lookup"><span data-stu-id="9c7da-362">This can be done by either specifying an [EncryptProperty] attribute (for POCO entities that derive from TableEntity) or an encryption resolver in request options.</span></span> <span data-ttu-id="9c7da-363">Una resolución de cifrado es un delegado que toma una clave de partición, una clave de fila y un nombre de propiedad y devuelve un valor booleano que indica si se debe cifrar dicha propiedad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-363">An encryption resolver is a delegate that takes a partition key, row key, and property name and returns a Boolean that indicates whether that property should be encrypted.</span></span> <span data-ttu-id="9c7da-364">Durante el cifrado, biblioteca de cliente de hello utilizará esta toodecide información si se debe cifrar una propiedad al escribir el cable toohello.</span><span class="sxs-lookup"><span data-stu-id="9c7da-364">During encryption, hello client library will use this information toodecide whether a property should be encrypted while writing toohello wire.</span></span> <span data-ttu-id="9c7da-365">delegado de Hello también proporciona posibilidad de Hola de lógica de alrededor de cómo se cifran las propiedades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-365">hello delegate also provides for hello possibility of logic around how properties are encrypted.</span></span> <span data-ttu-id="9c7da-366">(Por ejemplo, si el valor es X, hay que cifrar la propiedad A; en caso contrario, hay que cifrar las propiedades A y B). Tenga en cuenta que TI es tooprovide no es necesario que esta información al leer o consultar entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-366">(For example, if X, then encrypt property A; otherwise encrypt properties A and B.) Note that it is not necessary tooprovide this information while reading or querying entities.</span></span>

<span data-ttu-id="9c7da-367">Tenga en cuenta que actualmente no se admite la combinación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-367">Note that merge is not currently supported.</span></span> <span data-ttu-id="9c7da-368">Puesto que un subconjunto de propiedades se puede haber cifrado previamente mediante una clave diferente, simplemente combinar nuevas propiedades de Hola y actualizar metadatos de hello producirá pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-368">Since a subset of properties may have been encrypted previously using a different key, simply merging hello new properties and updating hello metadata will result in data loss.</span></span> <span data-ttu-id="9c7da-369">Combinar cualquiera requiere servicio adicional de realizar llamadas entidad preexistente de hello tooread del servicio de hello, o mediante una clave nueva por cada propiedad, los cuales no son adecuados por motivos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-369">Merging either requires making extra service calls tooread hello pre-existing entity from hello service, or using a new key per property, both of which are not suitable for performance reasons.</span></span>     

<span data-ttu-id="9c7da-370">Para información acerca del cifrado de datos de tablas, consulte [Cifrado del lado cliente y Azure Key Vault para Microsoft Azure Storage](storage-client-side-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="9c7da-370">For information about encrypting table data, see [Client-Side Encryption and Azure Key Vault for Microsoft Azure Storage](storage-client-side-encryption.md).</span></span>  

## <a name="modelling-relationships"></a><span data-ttu-id="9c7da-371">Relaciones de modelos</span><span class="sxs-lookup"><span data-stu-id="9c7da-371">Modelling relationships</span></span>
<span data-ttu-id="9c7da-372">Creación de modelos de dominio es un paso clave en el diseño de hello sistemas complejos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-372">Building domain models is a key step in hello design of complex systems.</span></span> <span data-ttu-id="9c7da-373">Por lo general, usa Hola modelización proceso tooidentify entidades y relaciones de hello entre ellos como una manera toounderstand Hola dominio de negocio e informar al diseño de saludo del sistema.</span><span class="sxs-lookup"><span data-stu-id="9c7da-373">Typically, you use hello modelling process tooidentify entities and hello relationships between them as a way toounderstand hello business domain and inform hello design of your system.</span></span> <span data-ttu-id="9c7da-374">En esta sección se centra en cómo puede traducir algunos de los tipos de relación común Hola que se encuentra en toodesigns de modelos de dominio para hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-374">This section focuses on how you can translate some of hello common relationship types found in domain models toodesigns for hello Table service.</span></span> <span data-ttu-id="9c7da-375">proceso de Hola de asignación de un lógica tooa de modelo de datos físico NoSQL según modelo de datos es muy diferente del que se utiliza cuando se diseña una base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="9c7da-375">hello process of mapping from a logical data-model tooa physical NoSQL based data-model is very different from that used when designing a relational database.</span></span> <span data-ttu-id="9c7da-376">Diseño de bases de datos relacionales normalmente se da por supuesto un proceso de normalización de datos con optimización para minimizar la redundancia y una capacidad de consulta declarativa que resúmenes Hola la implementación del funcionamiento de la base de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-376">Relational databases design typically assumes a data normalization process optimized for minimizing redundancy – and a declarative querying capability that abstracts how hello implementation of how hello database works.</span></span>  

### <a name="one-to-many-relationships"></a><span data-ttu-id="9c7da-377">Relaciones uno a varios</span><span class="sxs-lookup"><span data-stu-id="9c7da-377">One-to-many relationships</span></span>
<span data-ttu-id="9c7da-378">Las relaciones uno a varios entre los objetos de dominio de negocio se producen con mucha frecuencia: por ejemplo, cuando un departamento tiene muchos empleados.</span><span class="sxs-lookup"><span data-stu-id="9c7da-378">One-to-many relationships between business domain objects occur very frequently: for example, one department has many employees.</span></span> <span data-ttu-id="9c7da-379">Hay varias relaciones de uno a varios de formas tooimplement en hello servicio tabla cada con ventajas y desventajas que pueden ser relevantes toohello escenario en particular.</span><span class="sxs-lookup"><span data-stu-id="9c7da-379">There are several ways tooimplement one-to-many relationships in hello Table service each with pros and cons that may be relevant toohello particular scenario.</span></span>  

<span data-ttu-id="9c7da-380">Considere el ejemplo de Hola de una gran empresa multinacional con decenas de miles de departamentos y entidades employee donde cada departamento tiene muchos empleados y cada empleado como asociada a un departamento específico.</span><span class="sxs-lookup"><span data-stu-id="9c7da-380">Consider hello example of a large multi-national corporation with tens of thousands of departments and employee entities where every department has many employees and each employee as associated with one specific department.</span></span> <span data-ttu-id="9c7da-381">Un enfoque es toostore independiente departamento y entidades de empleado como los siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c7da-381">One approach is toostore separate department and employee entities such as these:</span></span>  

![][1]

<span data-ttu-id="9c7da-382">Este ejemplo muestra una relación de uno a varios implícita entre tipos de hello basada en hello **PartitionKey** valor.</span><span class="sxs-lookup"><span data-stu-id="9c7da-382">This example shows an implicit one-to-many relationship between hello types based on hello **PartitionKey** value.</span></span> <span data-ttu-id="9c7da-383">Cada departamento puede tener muchos empleados.</span><span class="sxs-lookup"><span data-stu-id="9c7da-383">Each department can have many employees.</span></span>  

<span data-ttu-id="9c7da-384">En este ejemplo también muestra una entidad de departamento y sus entidades relacionadas empleado en Hola misma partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-384">This example also shows a department entity and its related employee entities in hello same partition.</span></span> <span data-ttu-id="9c7da-385">Puede elegir toouse distintas particiones, tablas o incluso las cuentas de almacenamiento Hola diferentes tipos de entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-385">You could choose toouse different partitions, tables, or even storage accounts for hello different entity types.</span></span>  

<span data-ttu-id="9c7da-386">Un enfoque alternativo es toodenormalize las entidades de empleado único almacén y de datos con datos sin normalizar departamento como se muestra en el siguiente ejemplo de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-386">An alternative approach is toodenormalize your data and store only employee entities with denormalized department data as shown in hello following example.</span></span> <span data-ttu-id="9c7da-387">En este escenario en particular, este enfoque sin normalizar no puede Hola recomendada si tiene un requisito toobe toochange capaz de Hola obtener información detallada de un administrador del departamento porque toodo esta operación, necesita tooupdate todos los empleados en el departamento de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-387">In this particular scenario, this denormalized approach may not be hello best if you have a requirement toobe able toochange hello details of a department manager because toodo this you need tooupdate every employee in hello department.</span></span>  

![][2]

<span data-ttu-id="9c7da-388">Para obtener más información, vea hello [patrón de desnormalización](#denormalization-pattern) más adelante en esta guía.</span><span class="sxs-lookup"><span data-stu-id="9c7da-388">For more information, see hello [Denormalization pattern](#denormalization-pattern) later in this guide.</span></span>  

<span data-ttu-id="9c7da-389">Hello siguiente tabla resume Hola ventajas y desventajas de cada uno de los enfoques de hello descritos anteriormente para almacenar los empleados y las entidades de departamento que tienen una relación uno a varios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-389">hello following table summarizes hello pros and cons of each of hello approaches outlined above for storing employee and department entities that have a one-to-many relationship.</span></span> <span data-ttu-id="9c7da-390">También debería considerar la frecuencia con que espera tooperform varias operaciones: puede ser aceptable toohave un diseño que incluye una operación costosa si esa operación solo se produce con poca frecuencia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-390">You should also consider how often you expect tooperform various operations: it may be acceptable toohave a design that includes an expensive operation if that operation only happens infrequently.</span></span>  

<table>
<tr>
<th><span data-ttu-id="9c7da-391">Enfoque</span><span class="sxs-lookup"><span data-stu-id="9c7da-391">Approach</span></span></th>
<th><span data-ttu-id="9c7da-392">Ventajas</span><span class="sxs-lookup"><span data-stu-id="9c7da-392">Pros</span></span></th>
<th><span data-ttu-id="9c7da-393">Desventajas</span><span class="sxs-lookup"><span data-stu-id="9c7da-393">Cons</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-394">Tipos de entidad independientes, la misma partición, la misma tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-394">Separate entity types, same partition, same table</span></span></td>
<td>
<ul>
<li><span data-ttu-id="9c7da-395">Puede actualizar una entidad de departamento con una sola operación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-395">You can update a department entity with a single operation.</span></span></li>
<li><span data-ttu-id="9c7da-396">Puede usar una coherencia de toomaintain EGT si tiene un requisito toomodify una entidad department cada vez que se actualizaciones, inserciones y eliminaciones una entidad empleado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-396">You can use an EGT toomaintain consistency if you have a requirement toomodify a department entity whenever you update/insert/delete an employee entity.</span></span> <span data-ttu-id="9c7da-397">Por ejemplo, si mantiene un recuento de empleado del departamento para cada departamento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-397">For example if you maintain a departmental employee count for each department.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="9c7da-398">Puede necesitar tooretrieve un empleado y una entidad de departamento para algunas actividades de cliente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-398">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="9c7da-399">Almacenamiento llevan a cabo operaciones en hello misma partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-399">Storage operations happen in hello same partition.</span></span> <span data-ttu-id="9c7da-400">Con volúmenes de transacciones elevados, esto puede producir un punto de conflicto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-400">At high transaction volumes, this may result in a hotspot.</span></span></li>
<li><span data-ttu-id="9c7da-401">No se puede mover un empleado tooa nuevo departamento con un EGT.</span><span class="sxs-lookup"><span data-stu-id="9c7da-401">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="9c7da-402">Tipos de entidad independientes, particiones o tablas distintas o cuentas de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="9c7da-402">Separate entity types, different partitions or tables or storage accounts</span></span></td>
<td>
<ul>
<li><span data-ttu-id="9c7da-403">Puede actualizar una entidad de departamento o de empleado con una sola operación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-403">You can update a department entity or employee entity with a single operation.</span></span></li>
<li><span data-ttu-id="9c7da-404">En los volúmenes de transacciones alta, esto puede ayudar a spread Hola carga entre varias particiones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-404">At high transaction volumes, this may help spread hello load across more partitions.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="9c7da-405">Puede necesitar tooretrieve un empleado y una entidad de departamento para algunas actividades de cliente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-405">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="9c7da-406">No se puede utilizar EGTs toomaintain coherencia cuando se actualizaciones, inserciones y eliminaciones un empleado y un departamento de la actualización.</span><span class="sxs-lookup"><span data-stu-id="9c7da-406">You cannot use EGTs toomaintain consistency when you update/insert/delete an employee and update a department.</span></span> <span data-ttu-id="9c7da-407">Por ejemplo, actualizando un recuento de empleados en una entidad de departamento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-407">For example, updating an employee count in a department entity.</span></span></li>
<li><span data-ttu-id="9c7da-408">No se puede mover un empleado tooa nuevo departamento con un EGT.</span><span class="sxs-lookup"><span data-stu-id="9c7da-408">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="9c7da-409">Desnormalizar en un único tipo de entidad</span><span class="sxs-lookup"><span data-stu-id="9c7da-409">Denormalize into single entity type</span></span></td>
<td>
<ul>
<li><span data-ttu-id="9c7da-410">Puede recuperar toda la información de Hola que necesita con una única solicitud.</span><span class="sxs-lookup"><span data-stu-id="9c7da-410">You can retrieve all hello information you need with a single request.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="9c7da-411">Puede ser costoso toomaintain coherencia si necesita información de departamento tooupdate (Esto requeriría tooupdate todos los empleados de Hola de un departamento).</span><span class="sxs-lookup"><span data-stu-id="9c7da-411">It may be expensive toomaintain consistency if you need tooupdate department information (this would require you tooupdate all hello employees in a department).</span></span></li>
</ul>
</td>
</tr>
</table>

<span data-ttu-id="9c7da-412">Cómo elegir entre estas opciones y que los profesionales de TI de Hola e inconvenientes son más significativos, depende de los escenarios de aplicación específica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-412">How you choose between these options, and which of hello pros and cons are most significant, depends on your specific application scenarios.</span></span> <span data-ttu-id="9c7da-413">Por ejemplo, ¿con qué frecuencia modificar entidades de departamento; es necesario todas las consultas de empleado Hola departamento una información suplementaria; ¿grado de aproximación son límites de escalabilidad de toohello en las particiones o la cuenta de almacenamiento?</span><span class="sxs-lookup"><span data-stu-id="9c7da-413">For example, how often do you modify department entities; do all your employee queries need hello additional departmental information; how close are you toohello scalability limits on your partitions or your storage account?</span></span>  

### <a name="one-to-one-relationships"></a><span data-ttu-id="9c7da-414">Relaciones uno a uno</span><span class="sxs-lookup"><span data-stu-id="9c7da-414">One-to-one relationships</span></span>
<span data-ttu-id="9c7da-415">Es posible que los modelos de dominio incluyan relaciones uno a uno entre las entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-415">Domain models may include one-to-one relationships between entities.</span></span> <span data-ttu-id="9c7da-416">Si necesita tooimplement una relación uno a uno en hello servicio tabla, también debe elegir cómo toolink Hola dos entidades relacionadas cuando necesite tooretrieve ambos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-416">If you need tooimplement a one-to-one relationship in hello Table service, you must also choose how toolink hello two related entities when you need tooretrieve them both.</span></span> <span data-ttu-id="9c7da-417">Este vínculo puede ser implícita, en función de una convención de valores de clave de Hola o explícita mediante el almacenamiento de un vínculo en forma de Hola de **PartitionKey** y **RowKey** valores de cada entidad tooits entidades relacionan.</span><span class="sxs-lookup"><span data-stu-id="9c7da-417">This link can be either implicit, based on a convention in hello key values, or explicit by storing a link in hello form of **PartitionKey** and **RowKey** values in each entity tooits related entity.</span></span> <span data-ttu-id="9c7da-418">Para obtener información sobre si debe almacenar hello las entidades relacionadas en Hola la misma partición, vea la sección de hello [uno a varios relaciones](#one-to-many-relationships).</span><span class="sxs-lookup"><span data-stu-id="9c7da-418">For a discussion of whether you should store hello related entities in hello same partition, see hello section [One-to-many relationships](#one-to-many-relationships).</span></span>  

<span data-ttu-id="9c7da-419">Tenga en cuenta que también existen consideraciones de implementación que puedan provocar relaciones uno a uno tooimplement en servicio de la tabla de hello:</span><span class="sxs-lookup"><span data-stu-id="9c7da-419">Note that there are also implementation considerations that might lead you tooimplement one-to-one relationships in hello Table service:</span></span>  

* <span data-ttu-id="9c7da-420">Administración de entidades de gran tamaño (para obtener más información, consulte [Patrón de entidades de gran tamaño](#large-entities-pattern)).</span><span class="sxs-lookup"><span data-stu-id="9c7da-420">Handling large entities (for more information, see [Large Entities Pattern](#large-entities-pattern)).</span></span>  
* <span data-ttu-id="9c7da-421">Implementación de controles de acceso (para más información, consulte [Control de acceso con firmas de acceso compartido](#controlling-access-with-shared-access-signatures)).</span><span class="sxs-lookup"><span data-stu-id="9c7da-421">Implementing access controls (for more information, see [Controlling access with Shared Access Signatures](#controlling-access-with-shared-access-signatures)).</span></span>  

### <a name="join-in-hello-client"></a><span data-ttu-id="9c7da-422">Combinación en el cliente de Hola</span><span class="sxs-lookup"><span data-stu-id="9c7da-422">Join in hello client</span></span>
<span data-ttu-id="9c7da-423">Aunque existen relaciones de formas toomodel Hola servicio tabla, no debe olvidar que Hola dos razones principales para utilizar el servicio de la tabla de hello son escalabilidad y rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-423">Although there are ways toomodel relationships in hello Table service, you should not forget that hello two prime reasons for using hello Table service are scalability and performance.</span></span> <span data-ttu-id="9c7da-424">Si encuentra que se modelización muchas relaciones que poner en peligro Hola rendimiento y escalabilidad de la solución, debe pregúntese lo siguiente: si es necesario toobuild todas Hola relaciones de datos al diseño de la tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-424">If you find you are modelling many relationships that compromise hello performance and scalability of your solution, you should ask yourself if it is necessary toobuild all hello data relationships into your table design.</span></span> <span data-ttu-id="9c7da-425">Puede toosimplify capaz de diseño de Hola y mejorar la escalabilidad de Hola y rendimiento de la solución si permite que la aplicación cliente realizar las operaciones de combinación necesarios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-425">You may be able toosimplify hello design and improve hello scalability and performance of your solution if you let your client application perform any necessary joins.</span></span>  

<span data-ttu-id="9c7da-426">Por ejemplo, si tiene tablas pequeñas que contienen datos que no cambian con frecuencia, puede recuperar estos datos una vez y almacenarla en la caché de cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-426">For example, if you have small tables that contain data that does not change very often, then you can retrieve this data once and cache it on hello client.</span></span> <span data-ttu-id="9c7da-427">Esto puede evitar los repetidos idas y vueltas tooretrieve Hola los mismos datos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-427">This can avoid repeated roundtrips tooretrieve hello same data.</span></span> <span data-ttu-id="9c7da-428">En los ejemplos de hello que hemos examinado en esta guía, hello conjunto de departamentos en una organización pequeña es probable toobe pequeño y cambie con poca frecuencia lo que un buen candidato para datos de la aplicación cliente puede descargar una vez y la memoria caché como datos de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="9c7da-428">In hello examples we have looked at in this guide, hello set of departments in a small organization is likely toobe small and change infrequently making it a good candidate for data that client application can download once and cache as look up data.</span></span>  

### <a name="inheritance-relationships"></a><span data-ttu-id="9c7da-429">Relaciones de herencia</span><span class="sxs-lookup"><span data-stu-id="9c7da-429">Inheritance relationships</span></span>
<span data-ttu-id="9c7da-430">Si la aplicación cliente usa un conjunto de clases que forman parte de una herencia relación toorepresent las entidades empresariales, puede conservar fácilmente las entidades en hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-430">If your client application uses a set of classes that form part of an inheritance relationship toorepresent business entities, you can easily persist those entities in hello Table service.</span></span> <span data-ttu-id="9c7da-431">Por ejemplo, podría tener Hola siguiendo el conjunto de clases definidas en la aplicación cliente donde **persona** es una clase abstracta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-431">For example, you might have hello following set of classes defined in your client application where **Person** is an abstract class.</span></span>

![][3]

<span data-ttu-id="9c7da-432">Puede conservar las instancias de dos clases concretas Hola Hola servicio tabla utilizando una sola tabla de persona con entidades en ese aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="9c7da-432">You can persist instances of hello two concrete classes in hello Table service using a single Person table using entities in that look like this:</span></span>  

![][4]

<span data-ttu-id="9c7da-433">Para obtener más información sobre cómo trabajar con varios tipos de entidad en la misma tabla en el código de cliente de hello, vea la sección de hello [trabajar con tipos de entidades heterogéneas](#working-with-heterogeneous-entity-types) más adelante en esta guía.</span><span class="sxs-lookup"><span data-stu-id="9c7da-433">For more information about working with multiple entity types in hello same table in client code, see hello section [Working with heterogeneous entity types](#working-with-heterogeneous-entity-types) later in this guide.</span></span> <span data-ttu-id="9c7da-434">Esto proporciona ejemplos de cómo toorecognize Hola tipo de entidad en el código de cliente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-434">This provides examples of how toorecognize hello entity type in client code.</span></span>  

## <a name="table-design-patterns"></a><span data-ttu-id="9c7da-435">Patrones de diseño de tabla</span><span class="sxs-lookup"><span data-stu-id="9c7da-435">Table Design Patterns</span></span>
<span data-ttu-id="9c7da-436">En las secciones anteriores, ha visto algunas explicaciones detalladas acerca de cómo toooptimize la tabla de diseño para ambos al recuperar datos de la entidad mediante consultas y para insertar, actualizar y eliminar datos de la entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-436">In previous sections, you have seen some detailed discussions about how toooptimize your table design for both retrieving entity data using queries and for inserting, updating, and deleting entity data.</span></span> <span data-ttu-id="9c7da-437">En esta sección se describen algunos modelos adecuados para usarse con soluciones de Table service.</span><span class="sxs-lookup"><span data-stu-id="9c7da-437">This section describes some patterns appropriate for use with Table service solutions.</span></span> <span data-ttu-id="9c7da-438">Además, verá cómo puede prácticamente solucionar algunos problemas de Hola y ventajas e inconvenientes generados anteriormente en esta guía.</span><span class="sxs-lookup"><span data-stu-id="9c7da-438">In addition, you will see how you can practically address some of hello issues and trade-offs raised previously in this guide.</span></span> <span data-ttu-id="9c7da-439">Hello diagrama siguiente resume Hola relaciones entre los distintos patrones de hello:</span><span class="sxs-lookup"><span data-stu-id="9c7da-439">hello following diagram summarizes hello relationships between hello different patterns:</span></span>  

![][5]

<span data-ttu-id="9c7da-440">mapa de patrón de Hello anteriormente resalta algunas relaciones entre patrones (azules) y antipatrones (naranja) que se documentan en esta guía.</span><span class="sxs-lookup"><span data-stu-id="9c7da-440">hello pattern map above highlights some relationships between patterns (blue) and anti-patterns (orange) that are documented in this guide.</span></span> <span data-ttu-id="9c7da-441">Por supuesto, existen muchos otros patrones que merece la pena tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-441">There are of course many other patterns that are worth considering.</span></span> <span data-ttu-id="9c7da-442">Por ejemplo, uno de los escenarios clave de hello para el servicio tabla es hello toouse [materializar el patrón de vista](https://msdn.microsoft.com/library/azure/dn589782.aspx) de hello [segregación de responsabilidad de consulta de comandos (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) patrón.</span><span class="sxs-lookup"><span data-stu-id="9c7da-442">For example, one of hello key scenarios for Table Service is toouse hello [Materialized View Pattern](https://msdn.microsoft.com/library/azure/dn589782.aspx) from hello [Command Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) pattern.</span></span>  

### <a name="intra-partition-secondary-index-pattern"></a><span data-ttu-id="9c7da-443">Patrón de índice secundario dentro de la partición</span><span class="sxs-lookup"><span data-stu-id="9c7da-443">Intra-partition secondary index pattern</span></span>
<span data-ttu-id="9c7da-444">Almacenar varias copias de cada entidad con diferentes **RowKey** valores (Hola misma partición) tooenable rápidos y eficaces búsquedas y ordenación alternativa se ordena mediante diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-444">Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span> <span data-ttu-id="9c7da-445">La coherencia de las actualizaciones entre copias se puede mantener mediante EGT.</span><span class="sxs-lookup"><span data-stu-id="9c7da-445">Updates between copies can be kept consistent using EGT's.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-446">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-446">Context and problem</span></span>
<span data-ttu-id="9c7da-447">Hola servicio tabla indizará automáticamente entidades mediante hello **PartitionKey** y **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-447">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-448">Esto permite a un tooretrieve de aplicación de cliente en una entidad eficazmente con estos valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-448">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="9c7da-449">Por ejemplo, mediante la estructura de tabla de Hola se muestra a continuación, una aplicación cliente puede utilizar un tooretrieve de consulta de punto de una entidad de empleados individuales utilizando el nombre del departamento de Hola y el Id. de empleado de hello (hello **PartitionKey** y  **RowKey** valores).</span><span class="sxs-lookup"><span data-stu-id="9c7da-449">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="9c7da-450">Un cliente también puede recuperar las entidades ordenadas por identificador de empleado dentro de cada departamento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-450">A client can also retrieve entities sorted by employee id within each department.</span></span>

![][6]

<span data-ttu-id="9c7da-451">Si también desea toobe capaz toofind una entidad de empleado según Hola valor de otra propiedad, como la dirección de correo electrónico, debe usar un toofind de examen de partición menos eficaz una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-451">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="9c7da-452">Esto es porque el servicio de la tabla de hello no proporciona índices secundarios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-452">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="9c7da-453">Además, no hay ninguna opción toorequest una lista de empleados ordenados en un orden diferente del **RowKey** orden.</span><span class="sxs-lookup"><span data-stu-id="9c7da-453">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-454">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-454">Solution</span></span>
<span data-ttu-id="9c7da-455">toowork alrededor de falta de Hola de índices secundarios, puede almacenar varias copias de cada entidad con cada copia con otro **RowKey** valor.</span><span class="sxs-lookup"><span data-stu-id="9c7da-455">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using a different **RowKey** value.</span></span> <span data-ttu-id="9c7da-456">Si almacena una entidad con estructuras de Hola que se muestra a continuación, puede recuperar eficazmente entidades de empleado basándose en el identificador de empleado o de dirección de correo electrónico. Hola valores de prefijo para hello **RowKey**, "empid_" y "email_" permiten tooquery en un único empleado o un intervalo de empleados mediante el uso de un intervalo de direcciones de correo electrónico o Id. de empleados.</span><span class="sxs-lookup"><span data-stu-id="9c7da-456">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **RowKey**, "empid_" and "email_" enable you tooquery for a single employee or a range of employees by using a range of email addresses or employee ids.</span></span>  

![][7]

<span data-ttu-id="9c7da-457">Hola siguiendo dos criterios de filtro (uno Buscar por Id. de empleado y una búsqueda por dirección de correo electrónico) ambos especifica consultas de punto:</span><span class="sxs-lookup"><span data-stu-id="9c7da-457">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="9c7da-458">$filter=(PartitionKey eq 'Sales') y (RowKey eq 'empid_000223')</span><span class="sxs-lookup"><span data-stu-id="9c7da-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span></span>  
* <span data-ttu-id="9c7da-459">$filter=(PartitionKey eq 'Sales') y (RowKey eq 'email_jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="9c7da-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span></span>  

<span data-ttu-id="9c7da-460">Si se consulta para un intervalo de entidades de empleado, puede especificar un intervalo ordenado en orden de Id. de empleado o un intervalo que se ordenan en orden de la dirección de correo electrónico mediante una consulta para entidades con prefijo adecuado de Hola Hola **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-460">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="9c7da-461">usan de todos los empleados de Hola Hola departamento de ventas con un identificador de empleado en hello intervalo 000100 too000199 toofind: $filter = (PartitionKey eq 'Ventas') y (RowKey ge 'empid_000100') y (RowKey le 'empid_000199')</span><span class="sxs-lookup"><span data-stu-id="9c7da-461">toofind all hello employees in hello Sales department with an employee id in hello range 000100 too000199 use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000100') and (RowKey le 'empid_000199')</span></span>  
* <span data-ttu-id="9c7da-462">toofind todos Hola empleados Hola departamento de ventas con una dirección de correo electrónico a partir de hello letra 'a' uso: $filter = (PartitionKey eq 'Ventas') y (RowKey ge 'email_a') y (RowKey lt 'email_b')</span><span class="sxs-lookup"><span data-stu-id="9c7da-462">toofind all hello employees in hello Sales department with an email address starting with hello letter 'a' use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'email_a') and (RowKey lt 'email_b')</span></span>  
  
  <span data-ttu-id="9c7da-463">Observe que la sintaxis de filtro de hello usada en ejemplos de hello anteriores es de servicio de tabla de hello API de REST, para más información, vea [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-463">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-464">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-464">Issues and considerations</span></span>
<span data-ttu-id="9c7da-465">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-465">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-466">Almacenamiento de tabla es relativamente barato toouse para que hello costo sobrecarga de almacenamiento de datos duplicados no debe ser un gran problema.</span><span class="sxs-lookup"><span data-stu-id="9c7da-466">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="9c7da-467">Sin embargo, debe siempre se evalúan costo Hola del diseño según sus requisitos de almacenamiento previstas y solo agregar entidades duplicadas toosupport Hola consultas que se ejecutará la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-467">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="9c7da-468">Como entidades de índice secundario de Hola se almacenan en hello igual de partición como entidades de hello original, debes asegurarte de que no superen los objetivos de escalabilidad de Hola para una partición individual.</span><span class="sxs-lookup"><span data-stu-id="9c7da-468">Because hello secondary index entities are stored in hello same partition as hello original entities, you should ensure that you do not exceed hello scalability targets for an individual partition.</span></span>  
* <span data-ttu-id="9c7da-469">Puede mantener las entidades duplicadas sean coherentes entre sí utilizando las dos copias de hello del tooupdate de EGTs de entidad de Hola de forma atómica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-469">You can keep your duplicate entities consistent with each other by using EGTs tooupdate hello two copies of hello entity atomically.</span></span> <span data-ttu-id="9c7da-470">Esto implica que debe almacenar todas las copias de una entidad en hello misma partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-470">This implies that you should store all copies of an entity in hello same partition.</span></span> <span data-ttu-id="9c7da-471">Para obtener más información, vea la sección de hello [usando transacciones de grupo de la entidad](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="9c7da-471">For more information, see hello section [Using Entity Group Transactions](#entity-group-transactions).</span></span>  
* <span data-ttu-id="9c7da-472">Hola valor utilizado para hello **RowKey** debe ser único para cada entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-472">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="9c7da-473">Considere la posibilidad de usar valores de clave compuestos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-473">Consider using compound key values.</span></span>  
* <span data-ttu-id="9c7da-474">Relleno de valores numéricos en hello **RowKey** (por ejemplo, Id. de empleado de hello 000223) permite corregir para ordenar y filtrar según superior e inferior.</span><span class="sxs-lookup"><span data-stu-id="9c7da-474">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="9c7da-475">No es necesariamente necesario tooduplicate todas las propiedades de saludo de la entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-475">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="9c7da-476">Por ejemplo, si hello las consultas que enviar por correo electrónico en entidades de búsqueda hello mediante Hola dirección en hello **RowKey** nunca tendrá la edad del empleado de hello, estas entidades pudieron tener Hola siguiendo estructura:</span><span class="sxs-lookup"><span data-stu-id="9c7da-476">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>

![][8]

* <span data-ttu-id="9c7da-477">Es mejor normalmente toostore los datos duplicados y asegurarse de que puede recuperar todos los datos de Hola que necesita con una sola consulta, que toouse una consulta toolocate requiere datos de una entidad y otro hello toolookup.</span><span class="sxs-lookup"><span data-stu-id="9c7da-477">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query, than toouse one query toolocate an entity and another toolookup hello required data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-478">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-478">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-479">Use este patrón cuando la aplicación cliente necesita entidades tooretrieve mediante una variedad de claves diferentes, cuando el cliente necesita tooretrieve entidades en distintos criterios de ordenación, y donde se puede identificar cada entidad con una variedad de valores únicos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-479">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="9c7da-480">Sin embargo, debe asegurarse de que no superan los límites de escalabilidad de partición de hello al realizar búsquedas de entidad usando Hola diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-480">However, you should be sure that you do not exceed hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-481">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-481">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-482">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-482">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-483">Patrón de índice secundario entre particiones</span><span class="sxs-lookup"><span data-stu-id="9c7da-483">Inter-partition secondary index pattern</span></span>](#inter-partition-secondary-index-pattern)
* [<span data-ttu-id="9c7da-484">Patrón de clave compuesta</span><span class="sxs-lookup"><span data-stu-id="9c7da-484">Compound key pattern</span></span>](#compound-key-pattern)
* [<span data-ttu-id="9c7da-485">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-485">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="9c7da-486">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-486">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="inter-partition-secondary-index-pattern"></a><span data-ttu-id="9c7da-487">Patrón de índice secundario entre particiones</span><span class="sxs-lookup"><span data-stu-id="9c7da-487">Inter-partition secondary index pattern</span></span>
<span data-ttu-id="9c7da-488">Almacenar varias copias de cada entidad con diferentes **RowKey** valores en particiones independientes o en tablas independientes tooenable rápidos y eficaces las búsquedas y ordenación alternativos mediante diferentes **RowKey**valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-488">Store multiple copies of each entity using different **RowKey** values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-489">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-489">Context and problem</span></span>
<span data-ttu-id="9c7da-490">Hola servicio tabla indizará automáticamente entidades mediante hello **PartitionKey** y **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-490">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-491">Esto permite a un tooretrieve de aplicación de cliente en una entidad eficazmente con estos valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-491">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="9c7da-492">Por ejemplo, mediante la estructura de tabla de Hola se muestra a continuación, una aplicación cliente puede utilizar un tooretrieve de consulta de punto de una entidad de empleados individuales utilizando el nombre del departamento de Hola y el Id. de empleado de hello (hello **PartitionKey** y  **RowKey** valores).</span><span class="sxs-lookup"><span data-stu-id="9c7da-492">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="9c7da-493">Un cliente también puede recuperar las entidades ordenadas por identificador de empleado dentro de cada departamento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-493">A client can also retrieve entities sorted by employee id within each department.</span></span>  

![][9]

<span data-ttu-id="9c7da-494">Si también desea toobe capaz toofind una entidad de empleado según Hola valor de otra propiedad, como la dirección de correo electrónico, debe usar un toofind de examen de partición menos eficaz una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-494">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="9c7da-495">Esto es porque el servicio de la tabla de hello no proporciona índices secundarios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-495">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="9c7da-496">Además, no hay ninguna opción toorequest una lista de empleados ordenados en un orden diferente del **RowKey** orden.</span><span class="sxs-lookup"><span data-stu-id="9c7da-496">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

<span data-ttu-id="9c7da-497">Se anticipan un volumen elevado de transacciones en estas entidades y desea riesgo de hello toominimize de hello limitación del cliente de servicio de tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-497">You are anticipating a very high volume of transactions against these entities and want toominimize hello risk of hello Table service throttling your client.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-498">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-498">Solution</span></span>
<span data-ttu-id="9c7da-499">toowork alrededor de falta de Hola de índices secundarios, puede almacenar varias copias de cada entidad con cada copia con diferentes **PartitionKey** y **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-499">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using different **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-500">Si almacena una entidad con estructuras de Hola que se muestra a continuación, puede recuperar eficazmente entidades de empleado basándose en el identificador de empleado o de dirección de correo electrónico. Hola valores de prefijo para hello **PartitionKey**, "empid_" y "email_" permiten tooidentify que índice al que desea toouse para una consulta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-500">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **PartitionKey**, "empid_" and "email_" enable you tooidentify which index you want toouse for a query.</span></span>  

![][10]

<span data-ttu-id="9c7da-501">Hola siguiendo dos criterios de filtro (uno Buscar por Id. de empleado y una búsqueda por dirección de correo electrónico) ambos especifica consultas de punto:</span><span class="sxs-lookup"><span data-stu-id="9c7da-501">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="9c7da-502">$filter=(PartitionKey eq 'empid_Sales') y (RowKey eq '000223')</span><span class="sxs-lookup"><span data-stu-id="9c7da-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span></span>
* <span data-ttu-id="9c7da-503">$filter=(PartitionKey eq 'email_Sales') y (RowKey eq 'jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="9c7da-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span></span>  

<span data-ttu-id="9c7da-504">Si se consulta para un intervalo de entidades de empleado, puede especificar un intervalo ordenado en orden de Id. de empleado o un intervalo que se ordenan en orden de la dirección de correo electrónico mediante una consulta para entidades con prefijo adecuado de Hola Hola **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-504">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="9c7da-505">Hola a toofind Hola a todos los empleados en el departamento de ventas con un identificador de empleado en el intervalo de hello **000100** demasiado**000199** ordenados en uso de orden de Id. de empleado: $filter = (PartitionKey eq ' empid_Sales') y (ge RowKey ' 000100') y (RowKey le '000199')</span><span class="sxs-lookup"><span data-stu-id="9c7da-505">toofind all hello employees in hello Sales department with an employee id in hello range **000100** too**000199** sorted in employee id order use: $filter=(PartitionKey eq 'empid_Sales') and (RowKey ge '000100') and (RowKey le '000199')</span></span>  
* <span data-ttu-id="9c7da-506">toofind uso de orden de dirección de correo electrónico todos los empleados de Hola Hola departamento de ventas con una dirección de correo electrónico que empieza con 'a' ordenada en: $filter = (PartitionKey eq ' email_Sales') y (ge RowKey 'a') y (RowKey lt 'b')</span><span class="sxs-lookup"><span data-stu-id="9c7da-506">toofind all hello employees in hello Sales department with an email address that starts with 'a' sorted in email address order use: $filter=(PartitionKey eq 'email_Sales') and (RowKey ge 'a') and (RowKey lt 'b')</span></span>  

<span data-ttu-id="9c7da-507">Observe que la sintaxis de filtro de hello usada en ejemplos de hello anteriores es de servicio de tabla de hello API de REST, para más información, vea [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-507">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-508">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-508">Issues and considerations</span></span>
<span data-ttu-id="9c7da-509">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-509">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-510">Puede mantener las entidades duplicadas finalmente sean coherentes entre sí mediante el uso de hello [patrón coherente transacciones](#eventually-consistent-transactions-pattern) entidades de toomaintain Hola índice principal y secundaria.</span><span class="sxs-lookup"><span data-stu-id="9c7da-510">You can keep your duplicate entities eventually consistent with each other by using hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain hello primary and secondary index entities.</span></span>  
* <span data-ttu-id="9c7da-511">Almacenamiento de tabla es relativamente barato toouse para que hello costo sobrecarga de almacenamiento de datos duplicados no debe ser un gran problema.</span><span class="sxs-lookup"><span data-stu-id="9c7da-511">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="9c7da-512">Sin embargo, debe siempre se evalúan costo Hola del diseño según sus requisitos de almacenamiento previstas y solo agregar entidades duplicadas toosupport Hola consultas que se ejecutará la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-512">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="9c7da-513">Hola valor utilizado para hello **RowKey** debe ser único para cada entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-513">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="9c7da-514">Considere la posibilidad de usar valores de clave compuestos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-514">Consider using compound key values.</span></span>  
* <span data-ttu-id="9c7da-515">Relleno de valores numéricos en hello **RowKey** (por ejemplo, Id. de empleado de hello 000223) permite corregir para ordenar y filtrar según superior e inferior.</span><span class="sxs-lookup"><span data-stu-id="9c7da-515">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="9c7da-516">No es necesariamente necesario tooduplicate todas las propiedades de saludo de la entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-516">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="9c7da-517">Por ejemplo, si hello las consultas que enviar por correo electrónico en entidades de búsqueda hello mediante Hola dirección en hello **RowKey** nunca tendrá la edad del empleado de hello, estas entidades pudieron tener Hola siguiendo estructura:</span><span class="sxs-lookup"><span data-stu-id="9c7da-517">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>
  
  ![][11]
* <span data-ttu-id="9c7da-518">Es normalmente mejores datos duplicados toostore y asegúrese de que se pueden recuperar todos los datos de Hola que necesita con una única consulta de toouse una consulta toolocate una entidad con Hola índice secundario y otro toolookup Hola datos necesarios en el índice principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-518">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query than toouse one query toolocate an entity using hello secondary index and another toolookup hello required data in hello primary index.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-519">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-519">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-520">Use este patrón cuando la aplicación cliente necesita entidades tooretrieve mediante una variedad de claves diferentes, cuando el cliente necesita tooretrieve entidades en distintos criterios de ordenación, y donde se puede identificar cada entidad con una variedad de valores únicos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-520">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="9c7da-521">Utilice este patrón cuando desee tooavoid exceder el límite de escalabilidad de partición de hello al realizar búsquedas de entidad usando Hola diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-521">Use this pattern when you want tooavoid exceeding hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-522">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-522">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-523">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-523">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-524">Patrón final coherente de transacciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-524">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="9c7da-525">Patrón de índice secundario dentro de la partición</span><span class="sxs-lookup"><span data-stu-id="9c7da-525">Intra-partition secondary index pattern</span></span>](#intra-partition-secondary-index-pattern)  
* [<span data-ttu-id="9c7da-526">Patrón de clave compuesta</span><span class="sxs-lookup"><span data-stu-id="9c7da-526">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="9c7da-527">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-527">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="9c7da-528">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-528">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="eventually-consistent-transactions-pattern"></a><span data-ttu-id="9c7da-529">Patrón final coherente de transacciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-529">Eventually consistent transactions pattern</span></span>
<span data-ttu-id="9c7da-530">Habilitar el comportamiento final coherente a través de límites de partición o los límites del sistema de almacenamiento mediante el uso de las colas de Azure.</span><span class="sxs-lookup"><span data-stu-id="9c7da-530">Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-531">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-531">Context and problem</span></span>
<span data-ttu-id="9c7da-532">EGTs Habilitar transacciones atómicas en varias entidades que comparten Hola misma clave de partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-532">EGTs enable atomic transactions across multiple entities that share hello same partition key.</span></span> <span data-ttu-id="9c7da-533">Por motivos de escalabilidad y rendimiento, podría decidir toostore entidades que tienen requisitos de coherencia en particiones independientes o en un sistema de almacenamiento independiente: en este escenario, no puede usar EGTs toomaintain coherencia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-533">For performance and scalability reasons, you might decide toostore entities that have consistency requirements in separate partitions or in a separate storage system: in such a scenario, you cannot use EGTs toomaintain consistency.</span></span> <span data-ttu-id="9c7da-534">Por ejemplo, podría tener una coherencia definitiva de requisito toomaintain entre:</span><span class="sxs-lookup"><span data-stu-id="9c7da-534">For example, you might have a requirement toomaintain eventual consistency between:</span></span>  

* <span data-ttu-id="9c7da-535">Entidades almacenadas en dos particiones diferentes en la misma tabla, en tablas diferentes, en diferentes cuentas de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-535">Entities stored in two different partitions in hello same table, in different tables, in in different storage accounts.</span></span>  
* <span data-ttu-id="9c7da-536">Una entidad que se almacenan en hello servicio tabla y un blob almacenado en hello servicio Blob.</span><span class="sxs-lookup"><span data-stu-id="9c7da-536">An entity stored in hello Table service and a blob stored in hello Blob service.</span></span>  
* <span data-ttu-id="9c7da-537">Una entidad que se almacenan en el servicio de la tabla de Hola y un archivo en un sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-537">An entity stored in hello Table service and a file in a file system.</span></span>  
* <span data-ttu-id="9c7da-538">Una entidad almacenar en hello servicio tabla aún indizarse utilizando el servicio de búsqueda de Azure Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-538">An entity store in hello Table service yet indexed using hello Azure Search service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-539">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-539">Solution</span></span>
<span data-ttu-id="9c7da-540">Mediante el uso de las colas de Azure, puede implementar una solución que ofrece coherencia final entre dos o más particiones o sistemas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-540">By using Azure queues, you can implement a solution that delivers eventual consistency across two or more partitions or storage systems.</span></span>
<span data-ttu-id="9c7da-541">tooillustrate este enfoque, suponga que tiene un requisito toobe tooarchive pueda antiguo empleado las entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-541">tooillustrate this approach, assume you have a requirement toobe able tooarchive old employee entities.</span></span> <span data-ttu-id="9c7da-542">Las entidades de empleado antiguas rara vez se consultan y deben excluirse de las actividades relacionadas con los empleados actuales.</span><span class="sxs-lookup"><span data-stu-id="9c7da-542">Old employee entities are rarely queried and should be excluded from any activities that deal with current employees.</span></span> <span data-ttu-id="9c7da-543">tooimplement este requisito almacenar empleados activos en hello **actual** tabla y antiguos empleados en hello **archivo** tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-543">tooimplement this requirement you store active employees in hello **Current** table and old employees in hello **Archive** table.</span></span> <span data-ttu-id="9c7da-544">Archivar un empleado requiere toodelete entidad Hola Hola **actual** de tabla y agregue Hola entidad toohello **archivo** tabla, pero no se puede usar un tooperform EGT estas dos operaciones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-544">Archiving an employee requires you toodelete hello entity from hello **Current** table and add hello entity toohello **Archive** table, but you cannot use an EGT tooperform these two operations.</span></span> <span data-ttu-id="9c7da-545">riesgo de hello tooavoid que un error provoca una entidad tooappear de tablas de ambos o ninguno, operación de almacenamiento de hello debe ser coherente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-545">tooavoid hello risk that a failure causes an entity tooappear in both or neither tables, hello archive operation must be eventually consistent.</span></span> <span data-ttu-id="9c7da-546">Hello diagrama de secuencia siguiente describe los pasos de hello en esta operación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-546">hello following sequence diagram outlines hello steps in this operation.</span></span> <span data-ttu-id="9c7da-547">Para las rutas de acceso de excepción en el texto que siga Hola se proporcionan más detalles.</span><span class="sxs-lookup"><span data-stu-id="9c7da-547">More detail is provided for exception paths in hello text following.</span></span>  

![][12]

<span data-ttu-id="9c7da-548">Un cliente inicia la operación de almacenamiento de hello colocando un mensaje en una cola de Azure, en este empleado de ejemplo tooarchive #456.</span><span class="sxs-lookup"><span data-stu-id="9c7da-548">A client initiates hello archive operation by placing a message on an Azure queue, in this example tooarchive employee #456.</span></span> <span data-ttu-id="9c7da-549">Un rol de trabajo sondea la cola de hello si hay mensajes nuevos; Cuando encuentra uno, lee el mensaje de bienvenida y deja una copia oculta en la cola de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-549">A worker role polls hello queue for new messages; when it finds one, it reads hello message and leaves a hidden copy on hello queue.</span></span> <span data-ttu-id="9c7da-550">rol de trabajo de Hola a continuación recupera una copia de entidad de Hola de hello **actual** de tabla, se inserta una copia en hello **archivo** tabla y, a continuación, elimina Hola original de Hola **actual**tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-550">hello worker role next fetches a copy of hello entity from hello **Current** table, inserts a copy in hello **Archive** table, and then deletes hello original from hello **Current** table.</span></span> <span data-ttu-id="9c7da-551">Por último, si no hubiera ningún error de los pasos anteriores de hello, rol de trabajo de hello elimina mensajes de bienvenida del oculto de cola de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-551">Finally, if there were no errors from hello previous steps, hello worker role deletes hello hidden message from hello queue.</span></span>  

<span data-ttu-id="9c7da-552">En este ejemplo, el paso 4 inserta empleado Hola Hola **archivo** tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-552">In this example, step 4 inserts hello employee into hello **Archive** table.</span></span> <span data-ttu-id="9c7da-553">Podría agregar tooa blob de empleado de Hola Hola servicio Blob o un archivo en un sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-553">It could add hello employee tooa blob in hello Blob service or a file in a file system.</span></span>  

#### <a name="recovering-from-failures"></a><span data-ttu-id="9c7da-554">Recuperación de errores</span><span class="sxs-lookup"><span data-stu-id="9c7da-554">Recovering from failures</span></span>
<span data-ttu-id="9c7da-555">Es importante que las operaciones en los pasos de Hola **4** y **5** debe ser *idempotente* en caso de rol de trabajo de hello necesita operación de almacenamiento de toorestart Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-555">It is important that hello operations in steps **4** and **5** must be *idempotent* in case hello worker role needs toorestart hello archive operation.</span></span> <span data-ttu-id="9c7da-556">Si está utilizando el servicio de tabla de hello, para el paso **4** debe usar una operación "Insertar o reemplazar"; para el paso **5** debe usar un "eliminar si existe" operación en la biblioteca de cliente de Hola que usa.</span><span class="sxs-lookup"><span data-stu-id="9c7da-556">If you are using hello Table service, for step **4** you should use an "insert or replace" operation; for step **5** you should use a "delete if exists" operation in hello client library you are using.</span></span> <span data-ttu-id="9c7da-557">Si está utilizando otro sistema de almacenamiento, debe utilizar una operación idempotente adecuada.</span><span class="sxs-lookup"><span data-stu-id="9c7da-557">If you are using another storage system, you must use an appropriate idempotent operation.</span></span>  

<span data-ttu-id="9c7da-558">Si el rol de trabajo de hello nunca completa el paso **6**, a continuación, después vuelve a aparecer un mensaje de saludo de tiempo de espera en cola Hola prepararla para hello trabajo rol tootry tooreprocess.</span><span class="sxs-lookup"><span data-stu-id="9c7da-558">If hello worker role never completes step **6**, then after a timeout hello message reappears on hello queue ready for hello worker role tootry tooreprocess it.</span></span> <span data-ttu-id="9c7da-559">rol de trabajo de Hello puede comprobar cuántas veces se ha leído un mensaje en cola de hello y, si es necesario, marca es un mensaje "dudoso" con fines de investigación enviando tooa separa la cola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-559">hello worker role can check how many times a message on hello queue has been read and, if necessary, flag it is a "poison" message for investigation by sending it tooa separate queue.</span></span> <span data-ttu-id="9c7da-560">Para obtener más información acerca de la lectura de cola de mensajes y la comprobación Hola recuento de eliminación de cola, vea [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-560">For more information about reading queue messages and checking hello dequeue count, see [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span></span>  

<span data-ttu-id="9c7da-561">Algunos errores de los servicios de tabla y cola de hello son errores transitorios y la aplicación cliente debe incluir toohandle de lógica de reintento adecuado ellos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-561">Some errors from hello Table and Queue services are transient errors, and your client application should include suitable retry logic toohandle them.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-562">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-562">Issues and considerations</span></span>
<span data-ttu-id="9c7da-563">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-563">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-564">Esta solución no permite el aislamiento de las transacciones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-564">This solution does not provide for transaction isolation.</span></span> <span data-ttu-id="9c7da-565">Por ejemplo, un cliente podría leer hello **actual** y **archivo** tablas al rol de trabajo de hello estuvo entre pasos **4** y **5**así como un vista incoherente de los datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-565">For example, a client could read hello **Current** and **Archive** tables when hello worker role was between steps **4** and **5**, and see an inconsistent view of hello data.</span></span> <span data-ttu-id="9c7da-566">Tenga en cuenta que los datos de hello será coherentes al final.</span><span class="sxs-lookup"><span data-stu-id="9c7da-566">Note that hello data will be consistent eventually.</span></span>  
* <span data-ttu-id="9c7da-567">Asegúrese de que los pasos 4 y 5 son idempotentes en coherencia definitiva de orden tooensure.</span><span class="sxs-lookup"><span data-stu-id="9c7da-567">You must be sure that steps 4 and 5 are idempotent in order tooensure eventual consistency.</span></span>  
* <span data-ttu-id="9c7da-568">Puede escalar la solución de hello mediante el uso de varias colas e instancias de rol de trabajo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-568">You can scale hello solution by using multiple queues and worker role instances.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-569">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-569">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-570">Utilice este patrón cuando desee tooguarantee coherencia definitiva entre las entidades que existen en las distintas particiones o tablas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-570">Use this pattern when you want tooguarantee eventual consistency between entities that exist in different partitions or tables.</span></span> <span data-ttu-id="9c7da-571">Puede extender esta coherencia definitiva tooensure de patrón para las operaciones en el servicio de tabla de Hola y servicio de Blob de Hola y otros orígenes de datos de almacenamiento que no sea de Azure como sistema de archivos de base de datos o hello.</span><span class="sxs-lookup"><span data-stu-id="9c7da-571">You can extend this pattern tooensure eventual consistency for operations across hello Table service and hello Blob service and other non-Azure Storage data sources such as database or hello file system.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-572">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-572">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-573">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-573">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-574">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-574">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="9c7da-575">Combinar o reemplazar</span><span class="sxs-lookup"><span data-stu-id="9c7da-575">Merge or replace</span></span>](#merge-or-replace)  

> [!NOTE]
> <span data-ttu-id="9c7da-576">Si el aislamiento de transacciones es importante tooyour solución, considere la posibilidad de volver a diseñar la tooenable de tablas le toouse EGTs.</span><span class="sxs-lookup"><span data-stu-id="9c7da-576">If transaction isolation is important tooyour solution, you should consider redesigning your tables tooenable you toouse EGTs.</span></span>  
> 
> 

### <a name="index-entities-pattern"></a><span data-ttu-id="9c7da-577">Patrón de entidades de índice</span><span class="sxs-lookup"><span data-stu-id="9c7da-577">Index Entities Pattern</span></span>
<span data-ttu-id="9c7da-578">Mantener el índice entidades tooenable búsquedas eficaces que devuelven listas de entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-578">Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-579">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-579">Context and problem</span></span>
<span data-ttu-id="9c7da-580">Hola servicio tabla indizará automáticamente entidades mediante hello **PartitionKey** y **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-580">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-581">Esto permite un tooretrieve de aplicación cliente una entidad de forma eficaz con una consulta de punto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-581">This enables a client application tooretrieve an entity efficiently using a point query.</span></span> <span data-ttu-id="9c7da-582">Por ejemplo, mediante la estructura de tabla de Hola se muestra a continuación, una aplicación cliente puede eficazmente recuperar una entidad empleado individual mediante el nombre del departamento de Hola y el Id. de empleado de hello (hello **PartitionKey** y **RowKey** ).</span><span class="sxs-lookup"><span data-stu-id="9c7da-582">For example, using hello table structure shown below, a client application can efficiently retrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey**).</span></span>  

![][13]

<span data-ttu-id="9c7da-583">Si también desea toobe tooretrieve capaz de obtener una lista de entidades de empleado según Hola valor de otra propiedad no es único, como su apellido, debe usar una partición menos eficiente examinar toofind coincidencias, en lugar de utilizar un índice toolook ellos una copia de seguridad directamente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-583">If you also want toobe able tooretrieve a list of employee entities based on hello value of another non-unique property, such as their last name, you must use a less efficient partition scan toofind matches rather than using an index toolook them up directly.</span></span> <span data-ttu-id="9c7da-584">Esto es porque el servicio de la tabla de hello no proporciona índices secundarios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-584">This is because hello table service does not provide secondary indexes.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-585">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-585">Solution</span></span>
<span data-ttu-id="9c7da-586">búsqueda de tooenable por apellido con estructura de la entidad de hello mostrado anteriormente, debe mantener listas de identificadores de empleado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-586">tooenable lookup by last name with hello entity structure shown above, you must maintain lists of employee ids.</span></span> <span data-ttu-id="9c7da-587">Si desea que las entidades de tooretrieve Hola empleado con un apellido determinado, como Jones, debe encontrar primero lista Hola de identificadores de empleado para los empleados con Jones como su apellido y, a continuación, recuperar las entidades del empleado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-587">If you want tooretrieve hello employee entities with a particular last name, such as Jones, you must first locate hello list of employee ids for employees with Jones as their last name, and then retrieve those employee entities.</span></span> <span data-ttu-id="9c7da-588">Hay tres opciones principales para almacenar listas de Hola de Id. de empleados:</span><span class="sxs-lookup"><span data-stu-id="9c7da-588">There are three main options for storing hello lists of employee ids:</span></span>  

* <span data-ttu-id="9c7da-589">Utilice Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="9c7da-589">Use blob storage.</span></span>  
* <span data-ttu-id="9c7da-590">Crear entidades de índice en hello igual de partición como entidades de empleado de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-590">Create index entities in hello same partition as hello employee entities.</span></span>  
* <span data-ttu-id="9c7da-591">Cree entidades de índice en una tabla o una partición independiente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-591">Create index entities in a separate partition or table.</span></span>  

<span data-ttu-id="9c7da-592"><u>Opción n.º 1: Usar el almacenamiento de blobs</u></span><span class="sxs-lookup"><span data-stu-id="9c7da-592"><u>Option #1: Use blob storage</u></span></span>  

<span data-ttu-id="9c7da-593">Para la primera opción hello, crear un blob para cada nombre único de la última y, en cada almacén de blobs una lista de hello **PartitionKey** (departamento) y **RowKey** valores (Id. de empleado) para los empleados que tienen que última nombre.</span><span class="sxs-lookup"><span data-stu-id="9c7da-593">For hello first option, you create a blob for every unique last name, and in each blob store a list of hello **PartitionKey** (department) and **RowKey** (employee id) values for employees that have that last name.</span></span> <span data-ttu-id="9c7da-594">Cuando agrega o elimina a un empleado debe asegurarse de que el contenido de Hola del blob relevantes de Hola es coherente con las entidades de empleado de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-594">When you add or delete an employee you should ensure that hello content of hello relevant blob is eventually consistent with hello employee entities.</span></span>  

<span data-ttu-id="9c7da-595"><u>Opción #2:</u> crear entidades de índice en Hola misma partición</span><span class="sxs-lookup"><span data-stu-id="9c7da-595"><u>Option #2:</u> Create index entities in hello same partition</span></span>  

<span data-ttu-id="9c7da-596">Para la segunda opción hello, utilice entidades de índice que almacenan Hola datos siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c7da-596">For hello second option, use index entities that store hello following data:</span></span>  

![][14]

<span data-ttu-id="9c7da-597">Hola **EmployeeIDs** propiedad contiene una lista de identificadores de empleado para los empleados con apellidos de hello almacenados en hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-597">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="9c7da-598">Hello pasos siguientes describen proceso Hola que deben seguir al agregar un nuevo empleado si usas la segunda opción de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-598">hello following steps outline hello process you should follow when you are adding a new employee if you are using hello second option.</span></span> <span data-ttu-id="9c7da-599">En este ejemplo, vamos a agregar a un empleado cuyo Id. de 000152 y un apellido Jones Hola departamento de ventas:</span><span class="sxs-lookup"><span data-stu-id="9c7da-599">In this example, we are adding an employee with Id 000152 and a last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="9c7da-600">Recuperar Hola índice entidad con un **PartitionKey** valor hello y "Ventas" **RowKey** valor "Jones".</span><span class="sxs-lookup"><span data-stu-id="9c7da-600">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span> <span data-ttu-id="9c7da-601">Guardar Hola ETag de este toouse de entidad en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="9c7da-601">Save hello ETag of this entity toouse in step 2.</span></span>  
2. <span data-ttu-id="9c7da-602">Crear una transacción de grupo de entidad (es decir, una operación por lotes) que inserta la nueva entidad de empleado hello (**PartitionKey** valor "Ventas" y **RowKey** valor "000152"), y las actualizaciones de Hola entidad índice ( **PartitionKey** valor "Ventas" y **RowKey** valor "Jones") mediante la adición de hello nueva employee id toohello lista en el campo de EmployeeIDs Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-602">Create an entity group transaction (that is, a batch operation) that inserts hello new employee entity (**PartitionKey** value "Sales" and **RowKey** value "000152"), and updates hello index entity (**PartitionKey** value "Sales" and **RowKey** value "Jones") by adding hello new employee id toohello list in hello EmployeeIDs field.</span></span> <span data-ttu-id="9c7da-603">Para obtener información sobre EGT, consulte la sección [Transacciones de grupo de entidad (EGT)](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="9c7da-603">For more information about entity group transactions, see [Entity Group Transactions](#entity-group-transactions).</span></span>  
3. <span data-ttu-id="9c7da-604">Si se produce un error en la transacción de grupo de entidades de hello debido a un error de simultaneidad optimista (otra persona se acaba de modificar entidad del índice de hello), a continuación, necesitará toostart sobre en el paso 1 nuevo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-604">If hello entity group transaction fails because of an optimistic concurrency error (someone else has just modified hello index entity), then you need toostart over at step 1 again.</span></span>  

<span data-ttu-id="9c7da-605">Puede usar un toodeleting enfoque similar un empleado si usas la segunda opción de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-605">You can use a similar approach toodeleting an employee if you are using hello second option.</span></span> <span data-ttu-id="9c7da-606">Cambiar el apellido de un empleado es ligeramente más complejo, ya que necesitará tooexecute una transacción de grupo de entidades que actualiza tres entidades: Hola entidad employee, la entidad de índice de Hola para apellido anterior hello y la entidad de índice de Hola para apellido nuevo Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-606">Changing an employee's last name is slightly more complex because you will need tooexecute an entity group transaction that updates three entities: hello employee entity, hello index entity for hello old last name, and hello index entity for hello new last name.</span></span> <span data-ttu-id="9c7da-607">Se debe recuperar cada entidad antes de realizar cambios en el orden de valores de ETag de hello tooretrieve que, a continuación, puede usar tooperform Hola actualizaciones mediante el uso de simultaneidad optimista.</span><span class="sxs-lookup"><span data-stu-id="9c7da-607">You must retrieve each entity before making any changes in order tooretrieve hello ETag values that you can then use tooperform hello updates using optimistic concurrency.</span></span>  

<span data-ttu-id="9c7da-608">Hello pasos siguientes describen proceso Hola que deben seguir cuando necesite toolook todos los empleados de hello con un apellido determinado de un departamento si usas la segunda opción de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-608">hello following steps outline hello process you should follow when you need toolook up all hello employees with a given last name in a department if you are using hello second option.</span></span> <span data-ttu-id="9c7da-609">En este ejemplo, estamos buscando todos los empleados de hello con apellido Jones Hola departamento de ventas:</span><span class="sxs-lookup"><span data-stu-id="9c7da-609">In this example, we are looking up all hello employees with last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="9c7da-610">Recuperar Hola índice entidad con un **PartitionKey** valor hello y "Ventas" **RowKey** valor "Jones".</span><span class="sxs-lookup"><span data-stu-id="9c7da-610">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span>  
2. <span data-ttu-id="9c7da-611">Analizar la lista de Hola de identificadores de campo de EmployeeIDs Hola de empleado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-611">Parse hello list of employee Ids in hello EmployeeIDs field.</span></span>  
3. <span data-ttu-id="9c7da-612">Si necesita información adicional sobre cada uno de estos empleados (por ejemplo, sus direcciones de correo electrónico), recuperar cada una de las entidades de empleado de hello mediante **PartitionKey** valor "Ventas" y **RowKey** los valores de lista de Hola de empleados que obtuvo en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="9c7da-612">If you need additional information about each of these employees (such as their email addresses), retrieve each of hello employee entities using **PartitionKey** value "Sales" and **RowKey** values from hello list of employees you obtained in step 2.</span></span>  

<span data-ttu-id="9c7da-613"><u>Opción n.º 3:</u> crear entidades de índice en una tabla o partición independientes</span><span class="sxs-lookup"><span data-stu-id="9c7da-613"><u>Option #3:</u> Create index entities in a separate partition or table</span></span>  

<span data-ttu-id="9c7da-614">Para la tercera opción hello, utilice entidades de índice que almacenan Hola datos siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c7da-614">For hello third option, use index entities that store hello following data:</span></span>  

![][15]

<span data-ttu-id="9c7da-615">Hola **EmployeeIDs** propiedad contiene una lista de identificadores de empleado para los empleados con apellidos de hello almacenados en hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-615">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="9c7da-616">Con la tercera opción hello, no puede usar EGTs toomaintain coherencia porque entidades de índice de Hola se encuentran en una partición independiente de las entidades de empleado de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-616">With hello third option, you cannot use EGTs toomaintain consistency because hello index entities are in a separate partition from hello employee entities.</span></span> <span data-ttu-id="9c7da-617">Debe asegurarse de que las entidades de índice de hello son coherentes con las entidades de employee Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-617">You should ensure that hello index entities are eventually consistent with hello employee entities.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-618">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-618">Issues and considerations</span></span>
<span data-ttu-id="9c7da-619">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-619">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-620">Esta solución requiere entidades de búsqueda de coincidencias de tooretrieve de al menos dos consultas: una tooquery Hola índice tooobtain Hola lista de entidades de **RowKey** valores y, a continuación, consulta tooretrieve cada entidad en la lista de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-620">This solution requires at least two queries tooretrieve matching entities: one tooquery hello index entities tooobtain hello list of **RowKey** values, and then queries tooretrieve each entity in hello list.</span></span>  
* <span data-ttu-id="9c7da-621">Dado que una entidad individual tiene un tamaño máximo de 1 MB, opción #2 y opción #3 en soluciones de hello asumir esa lista Hola de identificadores de empleado para cualquier apellido determinado nunca es mayor que 1 MB.</span><span class="sxs-lookup"><span data-stu-id="9c7da-621">Given that an individual entity has a maximum size of 1 MB, option #2 and option #3 in hello solution assume that hello list of employee ids for any given last name is never greater than 1 MB.</span></span> <span data-ttu-id="9c7da-622">Si lista Hola de Id. de empleados es probable toobe mayor que 1 MB de tamaño, utilice la opción #1 y almacenar datos de índice de hello en almacenamiento de blobs.</span><span class="sxs-lookup"><span data-stu-id="9c7da-622">If hello list of employee ids is likely toobe greater than 1 MB in size, use option #1 and store hello index data in blob storage.</span></span>  
* <span data-ttu-id="9c7da-623">Si utiliza la opción #2 (mediante EGTs toohandle agregando y eliminando a los empleados y cambiando el apellido de un empleado), debe evaluar si el volumen de Hola de transacciones aproximan a los límites de escalabilidad de hello en una partición determinada.</span><span class="sxs-lookup"><span data-stu-id="9c7da-623">If you use option #2 (using EGTs toohandle adding and deleting employees, and changing an employee's last name) you must evaluate if hello volume of transactions will approach hello scalability limits in a given partition.</span></span> <span data-ttu-id="9c7da-624">Si éste es el caso de hello, debería considerar una solución coherente (opción #1 o #3) que utiliza colas toohandle Hola actualización las solicitudes y permite toostore las entidades de índice en una partición independiente de las entidades de empleado de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-624">If this is hello case, you should consider an eventually consistent solution (option #1 or option #3) that uses queues toohandle hello update requests and enables you toostore your index entities in a separate partition from hello employee entities.</span></span>  
* <span data-ttu-id="9c7da-625">Opción #2 en esta solución se da por supuesto que desea toolook por apellido dentro de un departamento: por ejemplo, desea tooretrieve una lista de empleados que tienen un apellido Jones Hola departamento de ventas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-625">Option #2 in this solution assumes that you want toolook up by last name within a department: for example, you want tooretrieve a list of employees with a last name Jones in hello Sales department.</span></span> <span data-ttu-id="9c7da-626">Si desea que toobe toolook capaz de seguridad de todos los empleados de hello cuyo apellido Jones en toda organización de hello, use la opción #1 u opción #3.</span><span class="sxs-lookup"><span data-stu-id="9c7da-626">If you want toobe able toolook up all hello employees with a last name Jones across hello whole organization, use either option #1 or option #3.</span></span>
* <span data-ttu-id="9c7da-627">Puede implementar una solución basada en cola que ofrece la coherencia definitiva (vea hello [patrón coherente transacciones](#eventually-consistent-transactions-pattern) para obtener más detalles).</span><span class="sxs-lookup"><span data-stu-id="9c7da-627">You can implement a queue-based solution that delivers eventual consistency (see hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) for more details).</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-628">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-628">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-629">Utilice este patrón cuando desee toolookup un conjunto de entidades que comparten un valor de propiedad común, como todos los empleados con apellidos Hola Jones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-629">Use this pattern when you want toolookup a set of entities that all share a common property value, such as all employees with hello last name Jones.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-630">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-630">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-631">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-631">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-632">Patrón de clave compuesta</span><span class="sxs-lookup"><span data-stu-id="9c7da-632">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="9c7da-633">Patrón final coherente de transacciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-633">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="9c7da-634">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-634">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="9c7da-635">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-635">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="denormalization-pattern"></a><span data-ttu-id="9c7da-636">Patrón de desnormalización</span><span class="sxs-lookup"><span data-stu-id="9c7da-636">Denormalization pattern</span></span>
<span data-ttu-id="9c7da-637">Combinar datos relacionados entre sí en una sola entidad tooenable tooretrieve todos los datos que necesita con una consulta de punto único de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-637">Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-638">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-638">Context and problem</span></span>
<span data-ttu-id="9c7da-639">En una base de datos relacional, normalmente se normalizan desduplicación de datos tooremove resultante en las consultas que recuperan datos de varias tablas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-639">In a relational database, you typically normalize data tooremove duplication resulting in queries that retrieve data from multiple tables.</span></span> <span data-ttu-id="9c7da-640">Si normalizar los datos en tablas de Azure, debe realizar varias acciones de ida y vuelta de hello cliente toohello server tooretrieve los datos relacionados.</span><span class="sxs-lookup"><span data-stu-id="9c7da-640">If you normalize your data in Azure tables, you must make multiple round trips from hello client toohello server tooretrieve your related data.</span></span> <span data-ttu-id="9c7da-641">Por ejemplo, con estructura de tabla de Hola se muestra a continuación necesitan dos redondear detalles de hello tooretrieve de viajes de un departamento: entidad de departamento de hello uno toofetch que incluye el identificador del Administrador de hello y, a continuación, otra solicitud toofetch Hola de detalles del Administrador de un empleado entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-641">For example, with hello table structure shown below you need two round trips tooretrieve hello details for a department: one toofetch hello department entity that includes hello manager's id, and then another request toofetch hello manager's details in an employee entity.</span></span>  

![][16]

#### <a name="solution"></a><span data-ttu-id="9c7da-642">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-642">Solution</span></span>
<span data-ttu-id="9c7da-643">En lugar de almacenar datos de hello en dos entidades independientes, reducir la normalización de datos de Hola y conservar una copia de los detalles del Administrador de hello en entidad department de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-643">Instead of storing hello data in two separate entities, denormalize hello data and keep a copy of hello manager's details in hello department entity.</span></span> <span data-ttu-id="9c7da-644">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="9c7da-644">For example:</span></span>  

![][17]

<span data-ttu-id="9c7da-645">Con las entidades de departamento almacenadas con estas propiedades, ahora puede recuperar todos los detalles de Hola que necesite acerca de un departamento mediante una consulta de punto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-645">With department entities stored with these properties, you can now retrieve all hello details you need about a department using a point query.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-646">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-646">Issues and considerations</span></span>
<span data-ttu-id="9c7da-647">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-647">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-648">Hay algunos costes de sobrecarga asociados al almacenamiento de datos dos veces.</span><span class="sxs-lookup"><span data-stu-id="9c7da-648">There is some cost overhead associated with storing some data twice.</span></span> <span data-ttu-id="9c7da-649">ventajas de rendimiento (resultantes de los servicios de almacenamiento de menos solicitudes toohello) normalmente Hello compensan aumento marginal de hello en los costos de almacenamiento (y parcialmente se compensa este costo por una reducción del número de Hola de transacciones requieren detalles de hello toofetch de un departamento).</span><span class="sxs-lookup"><span data-stu-id="9c7da-649">hello performance benefit (resulting from fewer requests toohello storage service) typically outweighs hello marginal increase in storage costs (and this cost is partially offset by a reduction in hello number of transactions you require toofetch hello details of a department).</span></span>  
* <span data-ttu-id="9c7da-650">Debe mantener la coherencia de Hola de entidades de dos de Hola que almacenan información acerca de los administradores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-650">You must maintain hello consistency of hello two entities that store information about managers.</span></span> <span data-ttu-id="9c7da-651">Puede controlar el problema de coherencia de hello mediante EGTs tooupdate varias entidades en una única transacción atómica: en este caso, se almacenan entidad department de Hola y entidad de empleado de hello para el administrador del departamento de Hola Hola misma partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-651">You can handle hello consistency issue by using EGTs tooupdate multiple entities in a single atomic transaction: in this case, hello department entity, and hello employee entity for hello department manager are stored in hello same partition.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-652">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-652">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-653">Utilice este patrón cuando sea necesario con frecuencia toolook información relacionada.</span><span class="sxs-lookup"><span data-stu-id="9c7da-653">Use this pattern when you frequently need toolook up related information.</span></span> <span data-ttu-id="9c7da-654">Este patrón reduce la cantidad de Hola de las consultas que el cliente debe realizar datos de hello tooretrieve requiere.</span><span class="sxs-lookup"><span data-stu-id="9c7da-654">This pattern reduces hello number of queries your client must make tooretrieve hello data it requires.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-655">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-655">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-656">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-656">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-657">Patrón de clave compuesta</span><span class="sxs-lookup"><span data-stu-id="9c7da-657">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="9c7da-658">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-658">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="9c7da-659">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-659">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="compound-key-pattern"></a><span data-ttu-id="9c7da-660">Patrón de clave compuesta</span><span class="sxs-lookup"><span data-stu-id="9c7da-660">Compound key pattern</span></span>
<span data-ttu-id="9c7da-661">Use compuesta **RowKey** valores tooenable un toolookup de cliente relacionadas con datos con una consulta de punto único.</span><span class="sxs-lookup"><span data-stu-id="9c7da-661">Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-662">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-662">Context and problem</span></span>
<span data-ttu-id="9c7da-663">En una base de datos relacional, resulta bastante natural toouse combinaciones en las consultas tooreturn relacionadas con elementos de cliente de toohello de datos en una única consulta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-663">In a relational database, it is quite natural toouse joins in queries tooreturn related pieces of data toohello client in a single query.</span></span> <span data-ttu-id="9c7da-664">Por ejemplo, podría usar toolook de Id. de empleado de hello una lista de entidades relacionadas que contienen el rendimiento y revisar los datos para ese empleado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-664">For example, you might use hello employee id toolook up a list of related entities that contain performance and review data for that employee.</span></span>  

<span data-ttu-id="9c7da-665">Supongamos que está almacenando las entidades employee en servicio de la tabla de hello utilizando Hola siguiendo la estructura:</span><span class="sxs-lookup"><span data-stu-id="9c7da-665">Assume you are storing employee entities in hello Table service using hello following structure:</span></span>  

![][18]

<span data-ttu-id="9c7da-666">También necesita toostore datos históricos relacionados con tooreviews y rendimiento para cada empleado de hello año ha funcionado para su organización y necesita toobe pueda tooaccess esta información por año.</span><span class="sxs-lookup"><span data-stu-id="9c7da-666">You also need toostore historical data relating tooreviews and performance for each year hello employee has worked for your organization and you need toobe able tooaccess this information by year.</span></span> <span data-ttu-id="9c7da-667">Una opción es toocreate otra tabla que almacena las entidades con hello siguiente estructura:</span><span class="sxs-lookup"><span data-stu-id="9c7da-667">One option is toocreate another table that stores entities with hello following structure:</span></span>  

![][19]

<span data-ttu-id="9c7da-668">Tenga en cuenta que con este enfoque, puede decidir tooduplicate cierta información (por ejemplo, nombre y apellidos) en hello nueva entidad tooenable tooretrieve los datos con una sola solicitud.</span><span class="sxs-lookup"><span data-stu-id="9c7da-668">Notice that with this approach you may decide tooduplicate some information (such as first name and last name) in hello new entity tooenable you tooretrieve your data with a single request.</span></span> <span data-ttu-id="9c7da-669">Sin embargo, no se puede mantener la coherencia segura porque no puede usar un dos entidades EGT tooupdate Hola de forma atómica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-669">However, you cannot maintain strong consistency because you cannot use an EGT tooupdate hello two entities atomically.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-670">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-670">Solution</span></span>
<span data-ttu-id="9c7da-671">Almacenar un nuevo tipo de entidad en la tabla original con entidades Hola siguiente estructura:</span><span class="sxs-lookup"><span data-stu-id="9c7da-671">Store a new entity type in your original table using entities with hello following structure:</span></span>  

![][20]

<span data-ttu-id="9c7da-672">Tenga en cuenta cómo Hola **RowKey** es ahora una clave compuesta formada por Id. de empleado de Hola y Hola año con datos de la revisión de Hola que le permite tooretrieve Hola rendimiento del empleado y revisar los datos con una única solicitud para una sola entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-672">Notice how hello **RowKey** is now a compound key made up of hello employee id and hello year of hello review data that enables you tooretrieve hello employee's performance and review data with a single request for a single entity.</span></span>  

<span data-ttu-id="9c7da-673">Hola de ejemplo siguiente describe cómo se pueden recuperar todos los datos de revisión de Hola para un empleado concreto (por ejemplo, employee 000123 Hola departamento de ventas):</span><span class="sxs-lookup"><span data-stu-id="9c7da-673">hello following example outlines how you can retrieve all hello review data for a particular employee (such as employee 000123 in hello Sales department):</span></span>  

<span data-ttu-id="9c7da-674">$filter=(PartitionKey eq 'Ventas') y (RowKey ge 'empid_000123') y (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span><span class="sxs-lookup"><span data-stu-id="9c7da-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-675">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-675">Issues and considerations</span></span>
<span data-ttu-id="9c7da-676">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-676">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-677">Debe usar un carácter de separador adecuado que hace más fácil tooparse hello **RowKey** valor: por ejemplo, **000123_2012**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-677">You should use a suitable separator character that makes it easy tooparse hello **RowKey** value: for example, **000123_2012**.</span></span>  
* <span data-ttu-id="9c7da-678">También almacena esta entidad en hello igual de partición como otras entidades que contienen datos relacionados para hello mismo empleado, lo que significa que puede usar EGTs toomaintain homogeneidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-678">You are also storing this entity in hello same partition as other entities that contain related data for hello same employee, which means you can use EGTs toomaintain strong consistency.</span></span>
* <span data-ttu-id="9c7da-679">Considere la posibilidad de la frecuencia con consultará Hola datos toodetermine si este patrón es adecuado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-679">You should consider how frequently you will query hello data toodetermine whether this pattern is appropriate.</span></span>  <span data-ttu-id="9c7da-680">Por ejemplo, si se tiene acceso a Hola revisión datos con poca frecuencia y Hola principal datos de los empleados a menudo que debe mantener como entidades independientes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-680">For example, if you will access hello review data infrequently and hello main employee data often you should keep them as separate entities.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-681">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-681">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-682">Utilice este patrón cuando necesite toostore uno o más entidades relacionadas que se consulta con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-682">Use this pattern when you need toostore one or more related entities that you query frequently.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-683">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-683">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-684">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-684">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-685">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-685">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="9c7da-686">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-686">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  
* [<span data-ttu-id="9c7da-687">Patrón final coherente de transacciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-687">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  

### <a name="log-tail-pattern"></a><span data-ttu-id="9c7da-688">Patrón final del registro</span><span class="sxs-lookup"><span data-stu-id="9c7da-688">Log tail pattern</span></span>
<span data-ttu-id="9c7da-689">Recuperar hello  *n*  entidades agregan más recientemente tooa partición mediante el uso de un **RowKey** valor que ordena en fecha inversa y orden cronológico.</span><span class="sxs-lookup"><span data-stu-id="9c7da-689">Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-690">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-690">Context and problem</span></span>
<span data-ttu-id="9c7da-691">Un requisito común es ser capaz de tooretrieve entidades de Hola creado más recientemente, por ejemplo Hola diez más reciente gastos notificaciones enviadas por un empleado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-691">A common requirement is be able tooretrieve hello most recently created entities, for example hello ten most recent expense claims submitted by an employee.</span></span> <span data-ttu-id="9c7da-692">Consulta de tabla de compatibilidad con un **$top** hello tooreturn de operación de consulta primero  *n*  entidades de un conjunto de: no hay ninguna consulta equivalente operación tooreturn Hola últimos n entidades en un conjunto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-692">Table queries support a **$top** query operation tooreturn hello first *n* entities from a set: there is no equivalent query operation tooreturn hello last n entities in a set.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-693">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-693">Solution</span></span>
<span data-ttu-id="9c7da-694">Almacén Hola entidades mediante un **RowKey** que naturalmente ordena en orden inverso fecha/hora orden mediante el uso de para entrada más reciente de hello siempre es hello primera de ellas en la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-694">Store hello entities using a **RowKey** that naturally sorts in reverse date/time order by using so hello most recent entry is always hello first one in hello table.</span></span>  

<span data-ttu-id="9c7da-695">Por ejemplo, toobe puede tooretrieve Hola diez notificaciones más recientes de gastos enviados por un empleado, puede usar un valor de graduación inversa derivan Hola de fecha y hora actuales.</span><span class="sxs-lookup"><span data-stu-id="9c7da-695">For example, toobe able tooretrieve hello ten most recent expense claims submitted by an employee, you can use a reverse tick value derived from hello current date/time.</span></span> <span data-ttu-id="9c7da-696">Hello siguiente ejemplo de código de C# muestra una manera de toocreate un valor de "invertido tics" adecuado para un **RowKey** que ordena de hello más reciente toohello más antigua:</span><span class="sxs-lookup"><span data-stu-id="9c7da-696">hello following C# code sample shows one way toocreate a suitable "inverted ticks" value for a **RowKey** that sorts from hello most recent toohello oldest:</span></span>  

`string invertedTicks = string.Format("{0:D19}", DateTime.MaxValue.Ticks - DateTime.UtcNow.Ticks);`  

<span data-ttu-id="9c7da-697">Puede obtener nuevo valor de tiempo de fecha toohello mediante el siguiente código de hello:</span><span class="sxs-lookup"><span data-stu-id="9c7da-697">You can get back toohello date time value using hello following code:</span></span>  

`DateTime dt = new DateTime(DateTime.MaxValue.Ticks - Int64.Parse(invertedTicks));`  

<span data-ttu-id="9c7da-698">consulta de tabla de Hello tiene el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="9c7da-698">hello table query looks like this:</span></span>  

`https://myaccount.table.core.windows.net/EmployeeExpense(PartitionKey='empid')?$top=10`  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-699">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-699">Issues and considerations</span></span>
<span data-ttu-id="9c7da-700">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-700">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-701">Debe rellenar valor de graduación inversa de hello con ceros iniciales valor de cadena de hello tooensure ordena según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-701">You must pad hello reverse tick value with leading zeroes tooensure hello string value sorts as expected.</span></span>  
* <span data-ttu-id="9c7da-702">Debe ser consciente de los objetivos de escalabilidad de hello en el nivel de Hola de una partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-702">You must be aware of hello scalability targets at hello level of a partition.</span></span> <span data-ttu-id="9c7da-703">Tenga cuidado de no crear particiones en la zona activa.</span><span class="sxs-lookup"><span data-stu-id="9c7da-703">Be careful not create hot spot partitions.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-704">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-704">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-705">Utilice este patrón cuando necesite tooaccess entidades en orden inverso de fecha y hora o cuando necesite tooaccess hello más recientemente agregado entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-705">Use this pattern when you need tooaccess entities in reverse date/time order or when you need tooaccess hello most recently added entities.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-706">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-706">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-707">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-707">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-708">Anteponer/anexar antipatrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-708">Prepend / append anti-pattern</span></span>](#prepend-append-anti-pattern)  
* [<span data-ttu-id="9c7da-709">Recuperación de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-709">Retrieving entities</span></span>](#retrieving-entities)  

### <a name="high-volume-delete-pattern"></a><span data-ttu-id="9c7da-710">Patrón de eliminación de gran volumen</span><span class="sxs-lookup"><span data-stu-id="9c7da-710">High volume delete pattern</span></span>
<span data-ttu-id="9c7da-711">Permitir la eliminación de Hola de un gran volumen de entidades mediante el almacenamiento de todas las entidades de Hola para su eliminación simultánea en su propia tabla independiente; eliminar entidades de hello mediante la eliminación de la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-711">Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-712">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-712">Context and problem</span></span>
<span data-ttu-id="9c7da-713">Muchas aplicaciones eliminan datos antiguos que ya no necesita la aplicación de cliente de toobe tooa disponibles o esa aplicación Hola archivado tooanother medio de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-713">Many applications delete old data which no longer needs toobe available tooa client application, or that hello application has archived tooanother storage medium.</span></span> <span data-ttu-id="9c7da-714">Normalmente se identifican estos datos en una fecha: por ejemplo, tendrá registros toodelete requisito de todas las solicitudes de inicio de sesión que tienen más de 60 días de antigüedad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-714">You typically identify such data by a date: for example, you have a requirement toodelete records of all login requests that are more than 60 days old.</span></span>  

<span data-ttu-id="9c7da-715">Un diseño posible es toouse Hola fecha y hora en de solicitud de inicio de sesión de Hola Hola **RowKey**:</span><span class="sxs-lookup"><span data-stu-id="9c7da-715">One possible design is toouse hello date and time of hello login request in hello **RowKey**:</span></span>  

![][21]

<span data-ttu-id="9c7da-716">Este enfoque evita zonas activas de partición porque la aplicación hello puede insertar y eliminar entidades de inicio de sesión para cada usuario en una partición independiente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-716">This approach avoids partition hotspots because hello application can insert and delete login entities for each user in a separate partition.</span></span> <span data-ttu-id="9c7da-717">Sin embargo, este enfoque puede resultar costoso mucho tiempo si tiene un gran número de entidades porque primero debe tooperform un recorrido de tabla en orden tooidentify todos los toodelete de entidades de hello y, a continuación, debe eliminar cada entidad antiguo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-717">However, this approach may be costly and time consuming if you have a large number of entities because first you need tooperform a table scan in order tooidentify all hello entities toodelete, and then you must delete each old entity.</span></span> <span data-ttu-id="9c7da-718">Tenga en cuenta que puede reducir Hola número de viajes de ida y toohello toodelete servidor necesario Hola entidades antiguo por lotes varias solicitudes de eliminación en EGTs.</span><span class="sxs-lookup"><span data-stu-id="9c7da-718">Note that you can reduce hello number of round trips toohello server required toodelete hello old entities by batching multiple delete requests into EGTs.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-719">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-719">Solution</span></span>
<span data-ttu-id="9c7da-720">Utilice una tabla independiente para cada día de intentos de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="9c7da-720">Use a separate table for each day of login attempts.</span></span> <span data-ttu-id="9c7da-721">Puede usar el diseño de la entidad de Hola por encima de los puntos de conexión tooavoid cuando se insertan entidades, y eliminar entidades anteriores ahora es simplemente una pregunta de la eliminación de una tabla cada día (una operación de almacenamiento único) en lugar de buscar y eliminar cientos y miles de entidades de inicio de sesión individual cada día.</span><span class="sxs-lookup"><span data-stu-id="9c7da-721">You can use hello entity design above tooavoid hotspots when you are inserting entities, and deleting old entities is now simply a question of deleting one table every day (a single storage operation) instead of finding and deleting hundreds and thousands of individual login entities every day.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-722">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-722">Issues and considerations</span></span>
<span data-ttu-id="9c7da-723">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-723">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-724">¿Admite el diseño de otras formas de la aplicación va a utilizar datos de hello como búsqueda de entidades específicas, vincular con otros datos, o generar información de agregado?</span><span class="sxs-lookup"><span data-stu-id="9c7da-724">Does your design support other ways your application will use hello data such as looking up specific entities, linking with other data, or generating aggregate information?</span></span>  
* <span data-ttu-id="9c7da-725">¿Evita el diseño problemas cuando se insertan nuevas entidades?</span><span class="sxs-lookup"><span data-stu-id="9c7da-725">Does your design avoid hot spots when you are inserting new entities?</span></span>  
* <span data-ttu-id="9c7da-726">Esperar un retraso si desea tooreuse Hola mismo nombre de la tabla después de eliminarlo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-726">Expect a delay if you want tooreuse hello same table name after deleting it.</span></span> <span data-ttu-id="9c7da-727">Es mejor tooalways utilizar nombres de tabla única.</span><span class="sxs-lookup"><span data-stu-id="9c7da-727">It's better tooalways use unique table names.</span></span>  
* <span data-ttu-id="9c7da-728">Esperar algunos limitación cuando realice primero una nueva tabla mientras Hola servicio tabla aprende los patrones de acceso de Hola y distribuye las particiones de hello entre nodos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-728">Expect some throttling when you first use a new table while hello Table service learns hello access patterns and distributes hello partitions across nodes.</span></span> <span data-ttu-id="9c7da-729">Considere la posibilidad de la frecuencia con necesita toocreate nuevas tablas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-729">You should consider how frequently you need toocreate new tables.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-730">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-730">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-731">Utilice este patrón cuando tenga un gran volumen de entidades que se deben eliminar en hello mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-731">Use this pattern when you have a high volume of entities that you must delete at hello same time.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-732">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-732">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-733">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-733">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-734">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-734">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="9c7da-735">Modificación de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-735">Modifying entities</span></span>](#modifying-entities)  

### <a name="data-series-pattern"></a><span data-ttu-id="9c7da-736">Patrón de serie de datos</span><span class="sxs-lookup"><span data-stu-id="9c7da-736">Data series pattern</span></span>
<span data-ttu-id="9c7da-737">Serie completa de los datos de almacén única entidad toominimize Hola de varias solicitudes que realice.</span><span class="sxs-lookup"><span data-stu-id="9c7da-737">Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-738">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-738">Context and problem</span></span>
<span data-ttu-id="9c7da-739">Un escenario común es para una aplicación toostore una serie de datos que normalmente se necesita tooretrieve a la vez.</span><span class="sxs-lookup"><span data-stu-id="9c7da-739">A common scenario is for an application toostore a series of data that it typically needs tooretrieve all at once.</span></span> <span data-ttu-id="9c7da-740">Por ejemplo, la aplicación podría grabar cuántos mensajes de mensajería instantánea cada empleado envía cada hora y, a continuación, use este tooplot información cuántos mensajes enviado a través de cada usuario Hola 24 horas anteriores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-740">For example, your application might record how many IM messages each employee sends every hour, and then use this information tooplot how many messages each user sent over hello preceding 24 hours.</span></span> <span data-ttu-id="9c7da-741">Un diseño puede ser toostore 24 entidades para cada empleado:</span><span class="sxs-lookup"><span data-stu-id="9c7da-741">One design might be toostore 24 entities for each employee:</span></span>  

![][22]

<span data-ttu-id="9c7da-742">Con este diseño, fácilmente puede buscar y actualizar Hola entidad tooupdate para cada empleado de cada vez que la aplicación hello necesita el valor de número de mensajes de Hola tooupdate.</span><span class="sxs-lookup"><span data-stu-id="9c7da-742">With this design, you can easily locate and update hello entity tooupdate for each employee whenever hello application needs tooupdate hello message count value.</span></span> <span data-ttu-id="9c7da-743">Sin embargo, tooretrieve Hola información tooplot un gráfico de actividad de hello para hello 24 horas anteriores, debe recuperar 24 entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-743">However, tooretrieve hello information tooplot a chart of hello activity for hello preceding 24 hours, you must retrieve 24 entities.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-744">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-744">Solution</span></span>
<span data-ttu-id="9c7da-745">Usar hello sigue diseño con un número de mensajes de Hola de toostore de propiedades independientes para cada hora:</span><span class="sxs-lookup"><span data-stu-id="9c7da-745">Use hello following design with a separate property toostore hello message count for each hour:</span></span>  

![][23]

<span data-ttu-id="9c7da-746">Con este diseño, puede usar un número de mensajes de Hola de mezcla operación tooupdate para un empleado de una hora concreta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-746">With this design, you can use a merge operation tooupdate hello message count for an employee for a specific hour.</span></span> <span data-ttu-id="9c7da-747">Ahora, puede recuperar toda la información de hello necesita gráfico de hello tooplot mediante una solicitud para una sola entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-747">Now, you can retrieve all hello information you need tooplot hello chart using a request for a single entity.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-748">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-748">Issues and considerations</span></span>
<span data-ttu-id="9c7da-749">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-749">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-750">Si la serie de datos completa no cabe en una única entidad (una entidad puede tener propiedades too252), use un almacén de datos alternativo, como un blob.</span><span class="sxs-lookup"><span data-stu-id="9c7da-750">If your complete data series does not fit into a single entity (an entity can have up too252 properties), use an alternative data store such as a blob.</span></span>  
* <span data-ttu-id="9c7da-751">Si tiene varios clientes simultáneamente, la actualización de una entidad, deberá hello toouse **ETag** tooimplement de simultaneidad optimista.</span><span class="sxs-lookup"><span data-stu-id="9c7da-751">If you have multiple clients updating an entity simultaneously, you will need toouse hello **ETag** tooimplement optimistic concurrency.</span></span> <span data-ttu-id="9c7da-752">Si tiene muchos clientes, puede experimentar un alto nivel de contención.</span><span class="sxs-lookup"><span data-stu-id="9c7da-752">If you have many clients, you may experience high contention.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-753">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-753">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-754">Utilice este patrón cuando necesite tooupdate y recuperar una serie de datos asociada a una entidad individual.</span><span class="sxs-lookup"><span data-stu-id="9c7da-754">Use this pattern when you need tooupdate and retrieve a data series associated with an individual entity.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-755">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-755">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-756">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-756">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-757">Patrón de entidades de gran tamaño</span><span class="sxs-lookup"><span data-stu-id="9c7da-757">Large entities pattern</span></span>](#large-entities-pattern)  
* [<span data-ttu-id="9c7da-758">Combinar o reemplazar</span><span class="sxs-lookup"><span data-stu-id="9c7da-758">Merge or replace</span></span>](#merge-or-replace)  
* <span data-ttu-id="9c7da-759">[Patrón de transacciones coherente](#eventually-consistent-transactions-pattern) (si está almacenando series de datos de hello en un blob)</span><span class="sxs-lookup"><span data-stu-id="9c7da-759">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) (if you are storing hello data series in a blob)</span></span>  

### <a name="wide-entities-pattern"></a><span data-ttu-id="9c7da-760">Patrón de entidades amplio</span><span class="sxs-lookup"><span data-stu-id="9c7da-760">Wide entities pattern</span></span>
<span data-ttu-id="9c7da-761">Usar varias entidades lógicas toostore de entidades físicas con más de 252 propiedades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-761">Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-762">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-762">Context and problem</span></span>
<span data-ttu-id="9c7da-763">Una entidad individual puede tener no más de 252 propiedades (excepto las propiedades del sistema obligatorio de hello) y no puede almacenar más de 1 MB de datos en total.</span><span class="sxs-lookup"><span data-stu-id="9c7da-763">An individual entity can have no more than 252 properties (excluding hello mandatory system properties) and cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="9c7da-764">En una base de datos relacional, normalmente, obtendría los límites de tamaño de Hola de una fila de ida y vuelta al agregar una nueva tabla e imponer una relación de 1 a 1 entre ellos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-764">In a relational database, you would typically get round any limits on hello size of a row by adding a new table and enforcing a 1-to-1 relationship between them.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-765">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-765">Solution</span></span>
<span data-ttu-id="9c7da-766">Con el servicio de la tabla de Hola, puede almacenar varias entidades toorepresent un objeto único de grandes empresas con más de 252 propiedades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-766">Using hello Table service, you can store multiple entities toorepresent a single large business object with more than 252 properties.</span></span> <span data-ttu-id="9c7da-767">Por ejemplo, si desea que toostore un recuento del número de Hola de mensajes de mensajería instantánea enviados por cada empleado para hello últimos 365 días, podría utilizar Hola después de diseño que utiliza dos entidades con distintos esquemas:</span><span class="sxs-lookup"><span data-stu-id="9c7da-767">For example, if you want toostore a count of hello number of IM messages sent by each employee for hello last 365 days, you could use hello following design that uses two entities with different schemas:</span></span>  

![][24]

<span data-ttu-id="9c7da-768">Si necesita toomake un cambio que es necesario actualizar ambos tookeep entidades ellos sincronizadas entre sí puede utilizar un EGT.</span><span class="sxs-lookup"><span data-stu-id="9c7da-768">If you need toomake a change that requires updating both entities tookeep them synchronized with each other you can use an EGT.</span></span> <span data-ttu-id="9c7da-769">En caso contrario, puede usar un número de mensajes de Hola de combinación única operación tooupdate para un día determinado.</span><span class="sxs-lookup"><span data-stu-id="9c7da-769">Otherwise, you can use a single merge operation tooupdate hello message count for a specific day.</span></span> <span data-ttu-id="9c7da-770">tooretrieve Hola a todos los datos para un empleado individual que se debe recuperar ambas entidades, lo que puede realizar con dos solicitudes eficaz que se usan un **PartitionKey** y un **RowKey** valor.</span><span class="sxs-lookup"><span data-stu-id="9c7da-770">tooretrieve all hello data for an individual employee you must retrieve both entities, which you can do with two efficient requests that use both a **PartitionKey** and a **RowKey** value.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-771">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-771">Issues and considerations</span></span>
<span data-ttu-id="9c7da-772">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-772">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-773">Recuperar una entidad lógica completa implica al menos dos de las transacciones de almacenamiento: entidad física de un tooretrieve.</span><span class="sxs-lookup"><span data-stu-id="9c7da-773">Retrieving a complete logical entity involves at least two storage transactions: one tooretrieve each physical entity.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-774">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-774">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-775">Utilice este patrón cuando necesidad toostore entidades cuyo tamaño o número de propiedades superan el límite de Hola de una entidad individual en hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-775">Use this pattern when  need toostore entities whose size or number of properties exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-776">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-776">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-777">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-777">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-778">Transacciones de grupos de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-778">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="9c7da-779">Combinar o reemplazar</span><span class="sxs-lookup"><span data-stu-id="9c7da-779">Merge or replace</span></span>](#merge-or-replace)

### <a name="large-entities-pattern"></a><span data-ttu-id="9c7da-780">Patrón de entidades de gran tamaño</span><span class="sxs-lookup"><span data-stu-id="9c7da-780">Large entities pattern</span></span>
<span data-ttu-id="9c7da-781">Usar valores de propiedad grande de toostore de almacenamiento de blobs.</span><span class="sxs-lookup"><span data-stu-id="9c7da-781">Use blob storage toostore large property values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-782">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-782">Context and problem</span></span>
<span data-ttu-id="9c7da-783">Una entidad individual no puede almacenar más de 1 MB de datos en total.</span><span class="sxs-lookup"><span data-stu-id="9c7da-783">An individual entity cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="9c7da-784">Si una o varias de las propiedades del almacén de valores que hacen el tamaño total de hello de la entidad tooexceed este valor, no se puede almacenar toda la entidad Hola Hola servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-784">If one or several of your properties store values that cause hello total size of your entity tooexceed this value, you cannot store hello entire entity in hello Table service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="9c7da-785">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-785">Solution</span></span>
<span data-ttu-id="9c7da-786">Si la entidad supera 1 MB de tamaño porque una o varias propiedades contienen una gran cantidad de datos, puede almacenar datos en hello servicio Blob y, a continuación, almacenar direcciones Hola de blob de hello en una propiedad de entidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-786">If your entity exceeds 1 MB in size because one or more properties contain a large amount of data, you can store data in hello Blob service and then store hello address of hello blob in a property in hello entity.</span></span> <span data-ttu-id="9c7da-787">Por ejemplo, puede almacenar fotos Hola de un empleado en el almacenamiento de blobs y almacenar una foto de toohello vínculo Hola **fotográfica** propiedad de la entidad de empleados:</span><span class="sxs-lookup"><span data-stu-id="9c7da-787">For example, you can store hello photo of an employee in blob storage and store a link toohello photo in hello **Photo** property of your employee entity:</span></span>  

![][25]

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-788">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-788">Issues and considerations</span></span>
<span data-ttu-id="9c7da-789">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-789">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-790">toomaintain coherencia definitiva entre entidad Hola Hola servicio tabla y datos de Hola Hola servicio Blob, use hello [patrón coherente transacciones](#eventually-consistent-transactions-pattern) toomaintain las entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-790">toomaintain eventual consistency between hello entity in hello Table service and hello data in hello Blob service, use hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain your entities.</span></span>
* <span data-ttu-id="9c7da-791">Recuperar una entidad completa implica al menos dos de las transacciones de almacenamiento: una entidad de hello tooretrieve y uno tooretrieve Hola de blobs de datos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-791">Retrieving a complete entity involves at least two storage transactions: one tooretrieve hello entity and one tooretrieve hello blob data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-792">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-792">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-793">Utilice este patrón cuando sea necesario entidades toostore cuyo tamaño supera el límite de Hola de una entidad individual en el servicio de la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-793">Use this pattern when you need toostore entities whose size exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-794">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-794">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-795">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-795">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-796">Patrón final coherente de transacciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-796">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="9c7da-797">Patrón de entidades amplio</span><span class="sxs-lookup"><span data-stu-id="9c7da-797">Wide entities pattern</span></span>](#wide-entities-pattern)

<a name="prepend-append-anti-pattern"></a>

### <a name="prependappend-anti-pattern"></a><span data-ttu-id="9c7da-798">Antipatrón de anteponer/anexar</span><span class="sxs-lookup"><span data-stu-id="9c7da-798">Prepend/append anti-pattern</span></span>
<span data-ttu-id="9c7da-799">Aumentar la escalabilidad cuando tenga un gran volumen de inserciones extendiendo Hola inserciones en varias particiones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-799">Increase scalability when you have a high volume of inserts by spreading hello inserts across multiple partitions.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-800">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-800">Context and problem</span></span>
<span data-ttu-id="9c7da-801">Antepone o anexar entidades de entidades tooyour almacena normalmente da lugar a aplicación hello agregar nueva toohello entidades primero o último partición de una secuencia de particiones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-801">Prepending or appending entities tooyour stored entities typically results in hello application adding new entities toohello first or last partition of a sequence of partitions.</span></span> <span data-ttu-id="9c7da-802">En este caso, todos de inserciones de hello en un momento dado se tienen lugar en la misma partición, crear una zona activa que impide que el servicio de la tabla de hello equilibrio de carga se inserta en varios nodos de Hola y lo que podría provocar la escalabilidad de la aplicación toohit Hola destinos de partición.</span><span class="sxs-lookup"><span data-stu-id="9c7da-802">In this case, all of hello inserts at any given time are taking place in hello same partition, creating a hotspot that prevents hello table service from load balancing inserts across multiple nodes, and possibly causing your application toohit hello scalability targets for partition.</span></span> <span data-ttu-id="9c7da-803">Por ejemplo, si tiene una aplicación que tienen acceso recursos y la red de los registros de los empleados, a continuación, podría dar lugar a una estructura de entidad tal y como se muestra a continuación Hola partición de la hora actual se convierta en una zona activa si volumen Hola de transacciones alcanza el objetivo de escalabilidad de Hola para una partición individual:</span><span class="sxs-lookup"><span data-stu-id="9c7da-803">For example, if you have an application that logs network and resource access by employees, then an entity structure as shown below could result in hello current hour's partition becoming a hotspot if hello volume of transactions reaches hello scalability target for an individual partition:</span></span>  

![][26]

#### <a name="solution"></a><span data-ttu-id="9c7da-804">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-804">Solution</span></span>
<span data-ttu-id="9c7da-805">Hello estructura de una entidad alternativa siguiente evita una zona activa en cualquier partición determinada como aplicación Hola registra los eventos:</span><span class="sxs-lookup"><span data-stu-id="9c7da-805">hello following alternative entity structure avoids a hotspot on any particular partition as hello application logs events:</span></span>  

![][27]

<span data-ttu-id="9c7da-806">Tenga en cuenta con este ejemplo cómo ambos Hola **PartitionKey** y **RowKey** son claves compuestas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-806">Notice with this example how both hello **PartitionKey** and **RowKey** are compound keys.</span></span> <span data-ttu-id="9c7da-807">Hola **PartitionKey** usa el departamento de Hola y el registro de hello de toodistribute de Id. de empleado en varias particiones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-807">hello **PartitionKey** uses both hello department and employee id toodistribute hello logging across multiple partitions.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-808">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-808">Issues and considerations</span></span>
<span data-ttu-id="9c7da-809">Considere la posibilidad de hello siguientes puntos cuando decida cómo tooimplement este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-809">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="9c7da-810">¿Hace que la aplicación cliente hace Hola clave estructura alternativa que evita la creación de particiones activas en inserciones eficazmente las consultas de Hola de soporte técnico?</span><span class="sxs-lookup"><span data-stu-id="9c7da-810">Does hello alternative key structure that avoids creating hot partitions on inserts efficiently support hello queries your client application makes?</span></span>  
* <span data-ttu-id="9c7da-811">¿Significa el volumen previsto de las transacciones que son probable tooreach objetivos de escalabilidad de Hola para una partición individual y limitarán por servicio de almacenamiento de Hola?</span><span class="sxs-lookup"><span data-stu-id="9c7da-811">Does your anticipated volume of transactions mean that you are likely tooreach hello scalability targets for an individual partition and be throttled by hello storage service?</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="9c7da-812">Cuando toouse este patrón</span><span class="sxs-lookup"><span data-stu-id="9c7da-812">When toouse this pattern</span></span>
<span data-ttu-id="9c7da-813">Evite la antipatrón anteponer/anexar de hello cuando el volumen de transacciones es probable que tooresult en limitación por servicio de almacenamiento de hello cuando tiene acceso a una partición activa.</span><span class="sxs-lookup"><span data-stu-id="9c7da-813">Avoid hello prepend/append anti-pattern when your volume of transactions is likely tooresult in throttling by hello storage service when you access a hot partition.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="9c7da-814">Orientación y patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="9c7da-814">Related patterns and guidance</span></span>
<span data-ttu-id="9c7da-815">Hello patrones y las directrices siguientes también pueden ser importantes al implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="9c7da-815">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="9c7da-816">Patrón de clave compuesta</span><span class="sxs-lookup"><span data-stu-id="9c7da-816">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="9c7da-817">Patrón de cola de registro</span><span class="sxs-lookup"><span data-stu-id="9c7da-817">Log tail pattern</span></span>](#log-tail-pattern)  
* [<span data-ttu-id="9c7da-818">Modificación de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-818">Modifying entities</span></span>](#modifying-entities)  

### <a name="log-data-anti-pattern"></a><span data-ttu-id="9c7da-819">Antipatrón de datos de registro</span><span class="sxs-lookup"><span data-stu-id="9c7da-819">Log data anti-pattern</span></span>
<span data-ttu-id="9c7da-820">Normalmente, debe utilizar Hola servicio Blob en lugar de hello datos de registro de toostore de servicio de tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-820">Typically, you should use hello Blob service instead of hello Table service toostore log data.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="9c7da-821">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="9c7da-821">Context and problem</span></span>
<span data-ttu-id="9c7da-822">Caso de uso común para los datos de registro están tooretrieve una selección de entradas del registro para un intervalo de fecha y hora específicas: por ejemplo, desea toofind todos Hola mensajes de error y críticos que registra la aplicación entre 15:04 y 15:06 en una fecha concreta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-822">A common use case for log data is tooretrieve a selection of log entries for a specific date/time range: for example, you want toofind all hello error and critical messages that your application logged between 15:04 and 15:06 on a specific date.</span></span> <span data-ttu-id="9c7da-823">No desea toouse Hola fecha y hora de partición Hola registro mensaje toodetermine Hola guardar entidades de registro a: que resultados en una partición activa porque en cualquier momento, todas las entidades de registro de hello compartirán Hola mismo **PartitionKey** valor (vea la sección de hello [antipatrón Prepend/anexar](#prepend-append-anti-pattern)).</span><span class="sxs-lookup"><span data-stu-id="9c7da-823">You do not want toouse hello date and time of hello log message toodetermine hello partition you save log entities to: that results in a hot partition because at any given time, all hello log entities will share hello same **PartitionKey** value (see hello section [Prepend/append anti-pattern](#prepend-append-anti-pattern)).</span></span> <span data-ttu-id="9c7da-824">Por ejemplo, hello después de esquema de la entidad para un mensaje de registro se produce en una partición activa porque aplicación hello escribe todos los mensajes de registro toohello partición para hello actual fecha y hora:</span><span class="sxs-lookup"><span data-stu-id="9c7da-824">For example, hello following entity schema for a log message results in a hot partition because hello application writes all log messages toohello partition for hello current date and hour:</span></span>  

![][28]

<span data-ttu-id="9c7da-825">En este ejemplo, Hola **RowKey** incluye Hola fecha y hora de tooensure de mensaje de registro de hello que los mensajes de registro se almacenan en orden de fecha y hora e incluye un identificador de mensaje en caso de varios mensajes de registro compartan Hola igual de fecha y hora.</span><span class="sxs-lookup"><span data-stu-id="9c7da-825">In this example, hello **RowKey** includes hello date and time of hello log message tooensure that log messages are stored sorted in date/time order, and includes a message id in case multiple log messages share hello same date and time.</span></span>  

<span data-ttu-id="9c7da-826">Otro enfoque es toouse una **PartitionKey** que garantiza que la aplicación hello escribe mensajes a través de un intervalo de particiones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-826">Another approach is toouse a **PartitionKey** that ensures that hello application writes messages across a range of partitions.</span></span> <span data-ttu-id="9c7da-827">Por ejemplo, si origen Hola de mensaje de registro de hello proporciona un toodistribute de manera mensajes entre ellas, podría utilizar Hola siguiendo los esquemas de la entidad:</span><span class="sxs-lookup"><span data-stu-id="9c7da-827">For example, if hello source of hello log message provides a way toodistribute messages across many partitions, you could use hello following entity schema:</span></span>  

![][29]

<span data-ttu-id="9c7da-828">Sin embargo, problema de hello con este esquema es que tooretrieve todos Hola mensajes de registro para un intervalo de tiempo específico debe buscar cada partición de tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-828">However, hello problem with this schema is that tooretrieve all hello log messages for a specific time span you must search every partition in hello table.</span></span>

#### <a name="solution"></a><span data-ttu-id="9c7da-829">Solución</span><span class="sxs-lookup"><span data-stu-id="9c7da-829">Solution</span></span>
<span data-ttu-id="9c7da-830">problema de hello resaltado de sección anterior de Hola de intentar toouse Hola entradas del registro de toostore de servicio de tabla y sugiere dos, satisfactorios, diseños.</span><span class="sxs-lookup"><span data-stu-id="9c7da-830">hello previous section highlighted hello problem of trying toouse hello Table service toostore log entries and suggested two, unsatisfactory, designs.</span></span> <span data-ttu-id="9c7da-831">Partición activa de una solución que ha provocado tooa con el riesgo de Hola de un mal rendimiento escribir mensajes de registro; Hello otra solución había ocasionado bajo rendimiento de consultas debido a Hola requisito tooscan cada partición en los mensajes de registro de hello tabla tooretrieve para un intervalo de tiempo específico.</span><span class="sxs-lookup"><span data-stu-id="9c7da-831">One solution led tooa hot partition with hello risk of poor performance writing log messages; hello other solution resulted in poor query performance because of hello requirement tooscan every partition in hello table tooretrieve log messages for a specific time span.</span></span> <span data-ttu-id="9c7da-832">Almacenamiento de blobs ofrece una mejor solución para este tipo de escenario y se trata cómo Azure análisis de almacenamiento almacena Hola registro los datos recopila.</span><span class="sxs-lookup"><span data-stu-id="9c7da-832">Blob storage offers a better solution for this type of scenario and this is how Azure Storage Analytics stores hello log data it collects.</span></span>  

<span data-ttu-id="9c7da-833">En esta sección se describe cómo el análisis de almacenamiento almacena los datos de registro en el almacenamiento de blobs para ilustrar estos datos de toostoring de enfoque que se suele consultan por intervalo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-833">This section outlines how Storage Analytics stores log data in blob storage as an illustration of this approach toostoring data that you typically query by range.</span></span>  

<span data-ttu-id="9c7da-834">Storage Analytics almacena los mensajes de registro en un formato delimitado en varios blobs.</span><span class="sxs-lookup"><span data-stu-id="9c7da-834">Storage Analytics stores log messages in a delimited format in multiple blobs.</span></span> <span data-ttu-id="9c7da-835">el formato delimitado Hola facilita para un cliente datos de aplicación tooparse hello en el mensaje del registro de hello.</span><span class="sxs-lookup"><span data-stu-id="9c7da-835">hello delimited format makes it easy for a client application tooparse hello data in hello log message.</span></span>  

<span data-ttu-id="9c7da-836">Análisis de almacenamiento usa una convención de nomenclatura para los blobs que le permite toolocate Hola blob (o blobs) que contienen mensajes de registro de hello para el que está buscando.</span><span class="sxs-lookup"><span data-stu-id="9c7da-836">Storage Analytics uses a naming convention for blobs that enables you toolocate hello blob (or blobs) that contain hello log messages for which you are searching.</span></span> <span data-ttu-id="9c7da-837">Por ejemplo, un blob denominado "queue/2014/07/31/1800/000001.log" contiene mensajes de registro relacionados con el servicio de cola de toohello de la hora de Hola a partir de 18:00 del 31 de julio de 2014.</span><span class="sxs-lookup"><span data-stu-id="9c7da-837">For example, a blob named "queue/2014/07/31/1800/000001.log" contains log messages that relate toohello queue service for hello hour starting at 18:00 on 31 July 2014.</span></span> <span data-ttu-id="9c7da-838">Hola "000001" indica que se trata primer archivo de registro de Hola durante este período.</span><span class="sxs-lookup"><span data-stu-id="9c7da-838">hello "000001" indicates that this is hello first log file for this period.</span></span> <span data-ttu-id="9c7da-839">Análisis de almacenamiento también registra las marcas de tiempo de Hola de hello primero y último registro mensajes almacenados en el archivo hello como parte de metadatos del blob de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-839">Storage Analytics also records hello timestamps of hello first and last log messages stored in hello file as part of hello blob's metadata.</span></span> <span data-ttu-id="9c7da-840">Hola API para habilita el almacenamiento blob buscar blobs en un contenedor en función de un prefijo de nombre: toolocate todos los blobs de Hola que contienen cola registrar los datos de la hora de Hola a partir de 18:00, puede usar Hola prefijo "cola/2014/07/31/1800."</span><span class="sxs-lookup"><span data-stu-id="9c7da-840">hello API for blob storage enables you locate blobs in a container based on a name prefix: toolocate all hello blobs that contain queue log data for hello hour starting at 18:00, you can use hello prefix "queue/2014/07/31/1800."</span></span>  

<span data-ttu-id="9c7da-841">Análisis de almacenamiento almacena internamente en búfer de mensajes de registro y, a continuación, actualiza periódicamente blob adecuado de Hola o crea uno nuevo con el lote más reciente de Hola de entradas de registro.</span><span class="sxs-lookup"><span data-stu-id="9c7da-841">Storage Analytics buffers log messages internally and then periodically updates hello appropriate blob or creates a new one with hello latest batch of log entries.</span></span> <span data-ttu-id="9c7da-842">Esto reduce el número de Hola de escrituras que debe realizar toohello servicio de blob.</span><span class="sxs-lookup"><span data-stu-id="9c7da-842">This reduces hello number of writes it must perform toohello blob service.</span></span>  

<span data-ttu-id="9c7da-843">Si está implementando una solución similar en su propia aplicación, debe tener en cuenta cómo toomanage Hola equilibrio entre la confiabilidad (escribir cada almacenamiento de tooblob de entrada de registro en este caso) y el costo y la escalabilidad (en búfer las actualizaciones en la aplicación y escribirlos tooblob almacenamiento por lotes).</span><span class="sxs-lookup"><span data-stu-id="9c7da-843">If you are implementing a similar solution in your own application, you must consider how toomanage hello trade-off between reliability (writing every log entry tooblob storage as it happens) and cost and scalability (buffering updates in your application and writing them tooblob storage in batches).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="9c7da-844">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="9c7da-844">Issues and considerations</span></span>
<span data-ttu-id="9c7da-845">Considere la posibilidad de hello siguiendo los puntos de la hora de decidir cómo toostore registrar los datos:</span><span class="sxs-lookup"><span data-stu-id="9c7da-845">Consider hello following points when deciding how toostore log data:</span></span>  

* <span data-ttu-id="9c7da-846">Si crea un diseño de tabla que evite posibles particiones activas, observará que no tiene acceso a los datos del registro de forma eficaz.</span><span class="sxs-lookup"><span data-stu-id="9c7da-846">If you create a table design that avoids potential hot partitions, you may find that you cannot access your log data efficiently.</span></span>  
* <span data-ttu-id="9c7da-847">tooprocess registrar los datos, un cliente necesita a menudo tooload muchos registros.</span><span class="sxs-lookup"><span data-stu-id="9c7da-847">tooprocess log data, a client often needs tooload many records.</span></span>  
* <span data-ttu-id="9c7da-848">Aunque a menudo se estructuran de datos del registro, Blob Storage puede ser una solución mejor.</span><span class="sxs-lookup"><span data-stu-id="9c7da-848">Although log data is often structured, blob storage may be a better solution.</span></span>  

### <a name="implementation-considerations"></a><span data-ttu-id="9c7da-849">Consideraciones de implementación</span><span class="sxs-lookup"><span data-stu-id="9c7da-849">Implementation considerations</span></span>
<span data-ttu-id="9c7da-850">En esta sección se describe algunas de hello toobear de consideraciones en cuenta al implementar patrones de Hola se describen en las secciones anteriores Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-850">This section discusses some of hello considerations toobear in mind when you implement hello patterns described in hello previous sections.</span></span> <span data-ttu-id="9c7da-851">La mayor parte de esta sección se utilizan ejemplos escritos en C# que usan Hola biblioteca de cliente de almacenamiento (versión 4.3.0 en tiempo de Hola de escritura).</span><span class="sxs-lookup"><span data-stu-id="9c7da-851">Most of this section uses examples written in C# that use hello Storage Client Library (version 4.3.0 at hello time of writing).</span></span>  

### <a name="retrieving-entities"></a><span data-ttu-id="9c7da-852">Recuperación de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-852">Retrieving entities</span></span>
<span data-ttu-id="9c7da-853">Como se describe en la sección de hello [diseño para consultar](#design-for-querying), hello más eficiente de las consultas es una consulta de punto.</span><span class="sxs-lookup"><span data-stu-id="9c7da-853">As discussed in hello section [Design for querying](#design-for-querying), hello most efficient query is a point query.</span></span> <span data-ttu-id="9c7da-854">Sin embargo, en algunos casos deberá tooretrieve varias entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-854">However, in some scenarios you may need tooretrieve multiple entities.</span></span> <span data-ttu-id="9c7da-855">Esta sección describen algunas entidades de tooretrieving enfoques comunes mediante Hola biblioteca cliente de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-855">This section describes some common approaches tooretrieving entities using hello Storage Client Library.</span></span>  

#### <a name="executing-a-point-query-using-hello-storage-client-library"></a><span data-ttu-id="9c7da-856">Ejecutar una consulta de punto mediante Hola biblioteca cliente de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="9c7da-856">Executing a point query using hello Storage Client Library</span></span>
<span data-ttu-id="9c7da-857">tooexecute de manera más fácil de Hello una consulta de punto es hello de toouse **recuperar** tabla operación tal y como se muestra en hello siguiente fragmento de código de C# que recupera una entidad con un **PartitionKey** de valor "ventas" y un  **RowKey** del valor "212":</span><span class="sxs-lookup"><span data-stu-id="9c7da-857">hello easiest way tooexecute a point query is toouse hello **Retrieve** table operation as shown in hello following C# code snippet that retrieves an entity with a **PartitionKey** of value "Sales" and a **RowKey** of value "212":</span></span>  

```csharp
TableOperation retrieveOperation = TableOperation.Retrieve<EmployeeEntity>("Sales", "212");
var retrieveResult = employeeTable.Execute(retrieveOperation);
if (retrieveResult.Result != null)
{
    EmployeeEntity employee = (EmployeeEntity)retrieveResult.Result;
    ...
}  
```

<span data-ttu-id="9c7da-858">Observe cómo este ejemplo espera que la entidad de hello recupera toobe de tipo **EmployeeEntity**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-858">Notice how this example expects hello entity it retrieves toobe of type **EmployeeEntity**.</span></span>  

#### <a name="retrieving-multiple-entities-using-linq"></a><span data-ttu-id="9c7da-859">Recuperar varias entidades con LINQ</span><span class="sxs-lookup"><span data-stu-id="9c7da-859">Retrieving multiple entities using LINQ</span></span>
<span data-ttu-id="9c7da-860">Puede recuperar varias entidades mediante LINQ con la biblioteca de clientes de Storage y especificar una consulta con una cláusula **where** .</span><span class="sxs-lookup"><span data-stu-id="9c7da-860">You can retrieve multiple entities by using LINQ with Storage Client Library and specifying a query with a **where** clause.</span></span> <span data-ttu-id="9c7da-861">tooavoid un recorrido de tabla, debe incluir siempre hello **PartitionKey** valor Hola donde cláusula y si es posible Hola **RowKey** valor recorridos de tabla y de la partición de tooavoid.</span><span class="sxs-lookup"><span data-stu-id="9c7da-861">tooavoid a table scan, you should always include hello **PartitionKey** value in hello where clause, and if possible hello **RowKey** value tooavoid table and partition scans.</span></span> <span data-ttu-id="9c7da-862">Hello servicio tabla admite un conjunto limitado de toouse de (mayor que, mayor o igual que, menor que, menor que o igual, igual y no es igual a) de los operadores de comparación en Hola donde cláusula.</span><span class="sxs-lookup"><span data-stu-id="9c7da-862">hello table service supports a limited set of comparison operators (greater than, greater than or equal, less than, less than or equal, equal, and not equal) toouse in hello where clause.</span></span> <span data-ttu-id="9c7da-863">Hello siguiente fragmento de código de C# busca todos los empleados de hello cuyo último nombre empieza por "B" (suponiendo que esa hello **RowKey** almacenes Hola apellido) en el departamento de ventas de hello (suponiendo que hello **PartitionKey** almacena el nombre del departamento de hello):</span><span class="sxs-lookup"><span data-stu-id="9c7da-863">hello following C# code snippet finds all hello employees whose last name starts with "B" (assuming that hello **RowKey** stores hello last name) in hello sales department (assuming hello **PartitionKey** stores hello department name):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = employeeTable.CreateQuery<EmployeeEntity>();
var query = (from employee in employeeQuery
            where employee.PartitionKey == "Sales" &&
            employee.RowKey.CompareTo("B") >= 0 &&
            employee.RowKey.CompareTo("C") < 0
            select employee).AsTableQuery();
var employees = query.Execute();  
```

<span data-ttu-id="9c7da-864">Tenga en cuenta cómo consulta Hola especifica tanto un **RowKey** y un **PartitionKey** tooensure un mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-864">Notice how hello query specifies both a **RowKey** and a **PartitionKey** tooensure better performance.</span></span>  

<span data-ttu-id="9c7da-865">Hello ejemplo de código siguiente muestra una funcionalidad equivalente mediante la API fluida de hello (para obtener más información acerca de la API fluidas en general, vea [prácticas recomendadas para diseñar una API fluida](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span><span class="sxs-lookup"><span data-stu-id="9c7da-865">hello following code sample shows equivalent functionality using hello fluent API (for more information about fluent APIs in general, see [Best Practices for Designing a Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = new TableQuery<EmployeeEntity>().Where(
    TableQuery.CombineFilters(
    TableQuery.CombineFilters(
        TableQuery.GenerateFilterCondition(
    "PartitionKey", QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.GenerateFilterCondition(
    "RowKey", QueryComparisons.GreaterThanOrEqual, "B")
),
TableOperators.And,
TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.LessThan, "C")
    )
);
var employees = employeeTable.ExecuteQuery(employeeQuery);  
```

> [!NOTE]
> <span data-ttu-id="9c7da-866">ejemplo Hello anida varios **CombineFilters** tooinclude métodos Hola tres condiciones de filtro.</span><span class="sxs-lookup"><span data-stu-id="9c7da-866">hello sample nests multiple **CombineFilters** methods tooinclude hello three filter conditions.</span></span>  
> 
> 

#### <a name="retrieving-large-numbers-of-entities-from-a-query"></a><span data-ttu-id="9c7da-867">Recuperar una gran cantidad de entidades de una consulta</span><span class="sxs-lookup"><span data-stu-id="9c7da-867">Retrieving large numbers of entities from a query</span></span>
<span data-ttu-id="9c7da-868">Una consulta óptima devuelve una entidad individual basada en un valor **PartitionKey** y un valor **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-868">An optimal query returns an individual entity based on a **PartitionKey** value and a **RowKey** value.</span></span> <span data-ttu-id="9c7da-869">Sin embargo, en algunos casos, habrá un requisito tooreturn muchas entidades de hello misma partición o incluso del número de particiones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-869">However, in some scenarios you may have a requirement tooreturn many entities from hello same partition or even from many partitions.</span></span>  

<span data-ttu-id="9c7da-870">Siempre por completo debe probar el rendimiento de saludo de la aplicación en tales escenarios.</span><span class="sxs-lookup"><span data-stu-id="9c7da-870">You should always fully test hello performance of your application in such scenarios.</span></span>  

<span data-ttu-id="9c7da-871">Una consulta en el servicio de la tabla de hello puede devolver un máximo de 1.000 entidades al mismo tiempo y se puede ejecutar durante un máximo de cinco segundos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-871">A query against hello table service may return a maximum of 1,000 entities at one time and may execute for a maximum of five seconds.</span></span> <span data-ttu-id="9c7da-872">Si el conjunto de resultados hello contiene más de 1.000 entidades, si no se completó la consulta de hello en cinco segundos, o si consulta Hola cruza el límite de la partición de hello, Hola servicio tabla devuelve un tooenable de token de continuación Hola Hola de toorequest de aplicación de cliente siguiente conjunto de entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-872">If hello result set contains more than 1,000 entities, if hello query did not complete within five seconds, or if hello query crosses hello partition boundary, hello Table service returns a continuation token tooenable hello client application toorequest hello next set of entities.</span></span> <span data-ttu-id="9c7da-873">Para más información sobre el funcionamiento de los tokens de continuación, consulte [Tiempo de espera de consulta y paginación](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span><span class="sxs-lookup"><span data-stu-id="9c7da-873">For more information about how continuation tokens work, see [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span></span>  

<span data-ttu-id="9c7da-874">Si usas Hola biblioteca cliente de almacenamiento, puede controlar automáticamente tokens de continuación para usted que devuelva las entidades de hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-874">If you are using hello Storage Client Library, it can automatically handle continuation tokens for you as it returns entities from hello Table service.</span></span> <span data-ttu-id="9c7da-875">Hello C# ejemplo de código siguiente utiliza Hola biblioteca cliente de almacenamiento automáticamente controla los tokens de continuación si el servicio de la tabla de hello devuelve en una respuesta:</span><span class="sxs-lookup"><span data-stu-id="9c7da-875">hello following C# code sample using hello Storage Client Library automatically handles continuation tokens if hello table service returns them in a response:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

var employees = employeeTable.ExecuteQuery(employeeQuery);
foreach (var emp in employees)
{
        ...
}  
```

<span data-ttu-id="9c7da-876">Hola siguiente código de C# administra tokens de continuación explícitamente:</span><span class="sxs-lookup"><span data-stu-id="9c7da-876">hello following C# code handles continuation tokens explicitly:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

TableContinuationToken continuationToken = null;

do
{
        var employees = employeeTable.ExecuteQuerySegmented(
        employeeQuery, continuationToken);
    foreach (var emp in employees)
    {
    ...
    }
    continuationToken = employees.ContinuationToken;
} while (continuationToken != null);  
```

<span data-ttu-id="9c7da-877">Mediante el uso de tokens de continuación explícitamente, puede controlar cuando la aplicación recupera el siguiente segmento de Hola de datos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-877">By using continuation tokens explicitly, you can control when your application retrieves hello next segment of data.</span></span> <span data-ttu-id="9c7da-878">Por ejemplo, si la aplicación cliente permite a los usuarios toopage a través de las entidades de hello almacenadas en una tabla, un usuario puede decidir no toopage a través de todas las entidades de hello recuperados por consulta de hello, por lo que la aplicación sólo utilizaría un hello tooretrieve token de continuación a continuación segmento de usuario de hello había finalizado paginación a través de todas las entidades de hello en el segmento actual Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-878">For example, if your client application enables users toopage through hello entities stored in a table, a user may decide not toopage through all hello entities retrieved by hello query so your application would only use a continuation token tooretrieve hello next segment when hello user had finished paging through all hello entities in hello current segment.</span></span> <span data-ttu-id="9c7da-879">Este enfoque tiene varias ventajas:</span><span class="sxs-lookup"><span data-stu-id="9c7da-879">This approach has several benefits:</span></span>  

* <span data-ttu-id="9c7da-880">Le permite toolimit cantidad de Hola de tooretrieve de datos de hello servicio tabla y que se mueve sobre red Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-880">It enables you toolimit hello amount of data tooretrieve from hello Table service and that you move over hello network.</span></span>  
* <span data-ttu-id="9c7da-881">Permite tooperform E/S asincrónica en. NET.</span><span class="sxs-lookup"><span data-stu-id="9c7da-881">It enables you tooperform asynchronous IO in .NET.</span></span>  
* <span data-ttu-id="9c7da-882">Permite el almacenamiento de información de tooserialize Hola continuación toopersistent token para que pueda continuar en caso de hello de bloqueo de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="9c7da-882">It enables you tooserialize hello continuation token toopersistent storage so you can continue in hello event of an application crash.</span></span>  

> [!NOTE]
> <span data-ttu-id="9c7da-883">Normalmente, un token de continuación devuelve un segmento que contiene 1.000 entidades, aunque pueden ser menos.</span><span class="sxs-lookup"><span data-stu-id="9c7da-883">A continuation token typically returns a segment containing 1,000 entities, although it may be fewer.</span></span> <span data-ttu-id="9c7da-884">Este también es el caso de hello si limita Hola número de entradas que se devuelve de una consulta mediante **tomar** tooreturn Hola primer n entidades que coinciden con los criterios de búsqueda: servicio de la tabla de hello puede devolver un segmento que contiene menos de n entidades a lo largo de con un tooenable de token de continuación tooretrieve Hola entidades restantes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-884">This is also hello case if you limit hello number of entries a query returns by using **Take** tooreturn hello first n entities that match your lookup criteria: hello table service may return a segment containing fewer than n entities along with a continuation token tooenable you tooretrieve hello remaining entities.</span></span>  
> 
> 

<span data-ttu-id="9c7da-885">Hello código C# siguiente muestra cómo toomodify número de Hola de entidades devuelve dentro de un segmento:</span><span class="sxs-lookup"><span data-stu-id="9c7da-885">hello following C# code shows how toomodify hello number of entities returned inside a segment:</span></span>  

```csharp
employeeQuery.TakeCount = 50;  
```

#### <a name="server-side-projection"></a><span data-ttu-id="9c7da-886">Proyección de servidor</span><span class="sxs-lookup"><span data-stu-id="9c7da-886">Server-side projection</span></span>
<span data-ttu-id="9c7da-887">Una sola entidad puede tener propiedades too255 y debe too1 MB de tamaño.</span><span class="sxs-lookup"><span data-stu-id="9c7da-887">A single entity can have up too255 properties and be up too1 MB in size.</span></span> <span data-ttu-id="9c7da-888">Al consultar la tabla de Hola y recuperar entidades, no es necesario todas las propiedades de Hola y puede evitar la transferencia de datos innecesariamente (toohelp reducir la latencia y el costo).</span><span class="sxs-lookup"><span data-stu-id="9c7da-888">When you query hello table and retrieve entities, you may not need all hello properties and can avoid transferring data unnecessarily (toohelp reduce latency and cost).</span></span> <span data-ttu-id="9c7da-889">Puede usar propiedades de servidor proyección tootransfer Hola solo que necesita.</span><span class="sxs-lookup"><span data-stu-id="9c7da-889">You can use server-side projection tootransfer just hello properties you need.</span></span> <span data-ttu-id="9c7da-890">Hello en el ejemplo siguiente se es recupera solo Hola **correo electrónico** propiedad (junto con **PartitionKey**, **RowKey**, **marca de tiempo**y  **ETag**) desde las entidades de hello seleccionadas por consulta Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-890">hello following example is retrieves just hello **Email** property (along with **PartitionKey**, **RowKey**, **Timestamp**, and **ETag**) from hello entities selected by hello query.</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
List<string> columns = new List<string>() { "Email" };
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter).Select(columns);

var entities = employeeTable.ExecuteQuery(employeeQuery);
foreach (var e in entities)
{
        Console.WriteLine("RowKey: {0}, EmployeeEmail: {1}", e.RowKey, e.Email);
}  
```

<span data-ttu-id="9c7da-891">Tenga en cuenta cómo Hola **RowKey** valor está disponible, aunque no se incluyó en lista de Hola de tooretrieve de propiedades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-891">Notice how hello **RowKey** value is available even though it was not included in hello list of properties tooretrieve.</span></span>  

### <a name="modifying-entities"></a><span data-ttu-id="9c7da-892">Modificación de entidades</span><span class="sxs-lookup"><span data-stu-id="9c7da-892">Modifying entities</span></span>
<span data-ttu-id="9c7da-893">Hola biblioteca cliente de almacenamiento permite toomodify las entidades se almacenan en el servicio de la tabla de hello mediante inserción, eliminación y actualización de entidades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-893">hello Storage Client Library enables you toomodify your entities stored in hello table service by inserting, deleting, and updating entities.</span></span> <span data-ttu-id="9c7da-894">Puede usar EGTs toobatch varias operaciones de inserción, actualización y eliminación número de hello tooreduce juntos de ida y vuelta necesarios y mejora el rendimiento de hello de la solución.</span><span class="sxs-lookup"><span data-stu-id="9c7da-894">You can use EGTs toobatch multiple insert, update, and delete operations together tooreduce hello number of round trips required and improve hello performance of your solution.</span></span>  

<span data-ttu-id="9c7da-895">Tenga en cuenta que las excepciones producidas cuando Hola biblioteca cliente de almacenamiento se ejecuta un EGT normalmente incluyen el índice de Hola de entidad de Hola que causó Hola lote toofail.</span><span class="sxs-lookup"><span data-stu-id="9c7da-895">Note that exceptions thrown when hello Storage Client Library executes an EGT typically include hello index of hello entity that caused hello batch toofail.</span></span> <span data-ttu-id="9c7da-896">Esto resulta útil cuando se depura código que usa EGT.</span><span class="sxs-lookup"><span data-stu-id="9c7da-896">This is helpful when you are debugging code that uses EGTs.</span></span>  

<span data-ttu-id="9c7da-897">También debe considerar cómo afecta su diseño a la forma en que la aplicación cliente trata las operaciones de simultaneidad y actualización.</span><span class="sxs-lookup"><span data-stu-id="9c7da-897">You should also consider how your design affects how your client application handles concurrency and update operations.</span></span>  

#### <a name="managing-concurrency"></a><span data-ttu-id="9c7da-898">Administrar la simultaneidad</span><span class="sxs-lookup"><span data-stu-id="9c7da-898">Managing concurrency</span></span>
<span data-ttu-id="9c7da-899">De forma predeterminada, el servicio de tabla de hello implementa optimista de simultaneidad realiza comprobaciones en nivel de Hola de entidades individuales para **insertar**, **mezcla**, y **eliminar** operaciones, Aunque es posible para un hello tooforce de cliente de servicio toobypass las tablas estas comprobaciones.</span><span class="sxs-lookup"><span data-stu-id="9c7da-899">By default, hello table service implements optimistic concurrency checks at hello level of individual entities for **Insert**, **Merge**, and **Delete** operations, although it is possible for a client tooforce hello table service toobypass these checks.</span></span> <span data-ttu-id="9c7da-900">Para obtener más información acerca de cómo el servicio de la tabla de hello administra simultaneidad, vea [administrar la simultaneidad en el almacenamiento de Azure de Microsoft](storage-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="9c7da-900">For more information about how hello table service manages concurrency, see  [Managing Concurrency in Microsoft Azure Storage](storage-concurrency.md).</span></span>  

#### <a name="merge-or-replace"></a><span data-ttu-id="9c7da-901">Combinar o reemplazar</span><span class="sxs-lookup"><span data-stu-id="9c7da-901">Merge or replace</span></span>
<span data-ttu-id="9c7da-902">Hola **reemplazar** método de hello **TableOperation** clase siempre reemplaza la entidad completa de Hola Hola servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-902">hello **Replace** method of hello **TableOperation** class always replaces hello complete entity in hello Table service.</span></span> <span data-ttu-id="9c7da-903">Si no incluye una propiedad en la solicitud de hello cuando existe esa propiedad de entidad de hello almacenado, solicitud de hello quita que la propiedad de hello almacena entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-903">If you do not include a property in hello request when that property exists in hello stored entity, hello request removes that property from hello stored entity.</span></span> <span data-ttu-id="9c7da-904">A menos que desee tooremove una propiedad explícitamente desde una entidad almacenada, debe incluir todas las propiedades de solicitud de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-904">Unless you want tooremove a property explicitly from a stored entity, you must include every property in hello request.</span></span>  

<span data-ttu-id="9c7da-905">Puede usar hello **mezcla** método de hello **TableOperation** cantidad de hello tooreduce de clase de datos que se envíe toohello servicio de tabla cuando desee tooupdate una entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-905">You can use hello **Merge** method of hello **TableOperation** class tooreduce hello amount of data that you send toohello Table service when you want tooupdate an entity.</span></span> <span data-ttu-id="9c7da-906">Hola **mezcla** método reemplaza cualquier propiedad de entidad de hello almacenado con valores de propiedad de entidad de hello incluido en la solicitud de hello, pero deja intacta cualquier propiedad de hello almacena entidad que no se incluyen en la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-906">hello **Merge** method replaces any properties in hello stored entity with property values from hello entity included in hello request, but leaves intact any properties in hello stored entity that are not included in hello request.</span></span> <span data-ttu-id="9c7da-907">Esto es útil si tiene entidades de gran tamaño y solo necesita tooupdate un pequeño número de propiedades en una solicitud.</span><span class="sxs-lookup"><span data-stu-id="9c7da-907">This is useful if you have large entities and only need tooupdate a small number of properties in a request.</span></span>  

> [!NOTE]
> <span data-ttu-id="9c7da-908">Hola **reemplazar** y **mezcla** métodos producirá un error si la entidad de hello no existe.</span><span class="sxs-lookup"><span data-stu-id="9c7da-908">hello **Replace** and **Merge** methods fail if hello entity does not exist.</span></span> <span data-ttu-id="9c7da-909">Como alternativa, puede usar hello **InsertOrReplace** y **InsertOrMerge** métodos que crean una nueva entidad si no existe.</span><span class="sxs-lookup"><span data-stu-id="9c7da-909">As an alternative, you can use hello **InsertOrReplace** and **InsertOrMerge** methods that create a new entity if it doesn't exist.</span></span>  
> 
> 

### <a name="working-with-heterogeneous-entity-types"></a><span data-ttu-id="9c7da-910">Trabajar con tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-910">Working with heterogeneous entity types</span></span>
<span data-ttu-id="9c7da-911">Hola servicio tabla es una *sin esquema* almacén de tablas que significa que una sola tabla puede almacenar entidades de varios tipos que proporciona gran flexibilidad en el diseño.</span><span class="sxs-lookup"><span data-stu-id="9c7da-911">hello Table service is a *schema-less* table store that means that a single table can store entities of multiple types providing great flexibility in your design.</span></span> <span data-ttu-id="9c7da-912">Hello en el ejemplo siguiente se muestra una tabla que almacena empleado y entidades de departamento:</span><span class="sxs-lookup"><span data-stu-id="9c7da-912">hello following example illustrates a table storing both employee and department entities:</span></span>  

<table>
<tr>
<th><span data-ttu-id="9c7da-913">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-913">PartitionKey</span></span></th>
<th><span data-ttu-id="9c7da-914">RowKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-914">RowKey</span></span></th>
<th><span data-ttu-id="9c7da-915">Timestamp</span><span class="sxs-lookup"><span data-stu-id="9c7da-915">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-916">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-916">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-917">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-917">LastName</span></span></th>
<th><span data-ttu-id="9c7da-918">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-918">Age</span></span></th>
<th><span data-ttu-id="9c7da-919">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-919">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-920">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-920">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-921">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-921">LastName</span></span></th>
<th><span data-ttu-id="9c7da-922">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-922">Age</span></span></th>
<th><span data-ttu-id="9c7da-923">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-923">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-924">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="9c7da-924">DepartmentName</span></span></th>
<th><span data-ttu-id="9c7da-925">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="9c7da-925">EmployeeCount</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-926">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-926">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-927">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-927">LastName</span></span></th>
<th><span data-ttu-id="9c7da-928">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-928">Age</span></span></th>
<th><span data-ttu-id="9c7da-929">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-929">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="9c7da-930">Tenga en cuenta que cada entidad aún debe tener valores **PartitionKey**, **RowKey** y **Timestamp**, pero puede tener cualquier conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="9c7da-930">Note that each entity must still have **PartitionKey**, **RowKey**, and **Timestamp** values, but may have any set of properties.</span></span> <span data-ttu-id="9c7da-931">Además, no hay nada tooindicate Hola tipo de una entidad a menos que elija toostore esa información en algún lugar.</span><span class="sxs-lookup"><span data-stu-id="9c7da-931">Furthermore, there is nothing tooindicate hello type of an entity unless you choose toostore that information somewhere.</span></span> <span data-ttu-id="9c7da-932">Hay dos opciones para identificar el tipo de entidad de hello:</span><span class="sxs-lookup"><span data-stu-id="9c7da-932">There are two options for identifying hello entity type:</span></span>  

* <span data-ttu-id="9c7da-933">Anteponer toohello de tipo de entidad de hello **RowKey** (o posiblemente Hola **PartitionKey**).</span><span class="sxs-lookup"><span data-stu-id="9c7da-933">Prepend hello entity type toohello **RowKey** (or possibly hello **PartitionKey**).</span></span> <span data-ttu-id="9c7da-934">Por ejemplo, **EMPLOYEE_000123** o **DEPARTMENT_SALES** como valores **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="9c7da-934">For example, **EMPLOYEE_000123** or **DEPARTMENT_SALES** as **RowKey** values.</span></span>  
* <span data-ttu-id="9c7da-935">Utilice un tipo de entidad de propiedad independiente toorecord Hola tal y como se muestra en la siguiente tabla se Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-935">Use a separate property toorecord hello entity type as shown in hello table below.</span></span>  

<table>
<tr>
<th><span data-ttu-id="9c7da-936">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-936">PartitionKey</span></span></th>
<th><span data-ttu-id="9c7da-937">RowKey</span><span class="sxs-lookup"><span data-stu-id="9c7da-937">RowKey</span></span></th>
<th><span data-ttu-id="9c7da-938">Timestamp</span><span class="sxs-lookup"><span data-stu-id="9c7da-938">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-939">EntityType</span><span class="sxs-lookup"><span data-stu-id="9c7da-939">EntityType</span></span></th>
<th><span data-ttu-id="9c7da-940">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-940">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-941">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-941">LastName</span></span></th>
<th><span data-ttu-id="9c7da-942">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-942">Age</span></span></th>
<th><span data-ttu-id="9c7da-943">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-943">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-944">Employee</span><span class="sxs-lookup"><span data-stu-id="9c7da-944">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-945">EntityType</span><span class="sxs-lookup"><span data-stu-id="9c7da-945">EntityType</span></span></th>
<th><span data-ttu-id="9c7da-946">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-946">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-947">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-947">LastName</span></span></th>
<th><span data-ttu-id="9c7da-948">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-948">Age</span></span></th>
<th><span data-ttu-id="9c7da-949">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-949">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-950">Employee</span><span class="sxs-lookup"><span data-stu-id="9c7da-950">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-951">EntityType</span><span class="sxs-lookup"><span data-stu-id="9c7da-951">EntityType</span></span></th>
<th><span data-ttu-id="9c7da-952">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="9c7da-952">DepartmentName</span></span></th>
<th><span data-ttu-id="9c7da-953">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="9c7da-953">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-954">department</span><span class="sxs-lookup"><span data-stu-id="9c7da-954">Department</span></span></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="9c7da-955">EntityType</span><span class="sxs-lookup"><span data-stu-id="9c7da-955">EntityType</span></span></th>
<th><span data-ttu-id="9c7da-956">Nombre</span><span class="sxs-lookup"><span data-stu-id="9c7da-956">FirstName</span></span></th>
<th><span data-ttu-id="9c7da-957">Apellidos</span><span class="sxs-lookup"><span data-stu-id="9c7da-957">LastName</span></span></th>
<th><span data-ttu-id="9c7da-958">Edad</span><span class="sxs-lookup"><span data-stu-id="9c7da-958">Age</span></span></th>
<th><span data-ttu-id="9c7da-959">Email</span><span class="sxs-lookup"><span data-stu-id="9c7da-959">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="9c7da-960">Employee</span><span class="sxs-lookup"><span data-stu-id="9c7da-960">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="9c7da-961">primera opción Hello, anteponiéndole toohello de tipo de entidad de hello **RowKey**, es útil si hay una posibilidad de que dos entidades de tipos diferentes podrían tener Hola mismo valor de clave.</span><span class="sxs-lookup"><span data-stu-id="9c7da-961">hello first option, prepending hello entity type toohello **RowKey**, is useful if there is a possibility that two entities of different types might have hello same key value.</span></span> <span data-ttu-id="9c7da-962">También agrupa las entidades del programa Hola a mismo tipo juntos en la partición de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-962">It also groups entities of hello same type together in hello partition.</span></span>  

<span data-ttu-id="9c7da-963">Hello técnicas descritas en esta sección son especialmente relevante toohello discusión [las relaciones de herencia](#inheritance-relationships) anteriormente en esta guía en la sección de hello [modelización relaciones](#modelling-relationships).</span><span class="sxs-lookup"><span data-stu-id="9c7da-963">hello techniques discussed in this section are especially relevant toohello discussion [Inheritance relationships](#inheritance-relationships) earlier in this guide in hello section [Modelling relationships](#modelling-relationships).</span></span>  

> [!NOTE]
> <span data-ttu-id="9c7da-964">Considere la posibilidad de incluir un número de versión en hello entidad tipo valor tooenable aplicaciones tooevolve POCO objetos de cliente y trabajar con versiones diferentes.</span><span class="sxs-lookup"><span data-stu-id="9c7da-964">You should consider including a version number in hello entity type value tooenable client applications tooevolve POCO objects and work with different versions.</span></span>  
> 
> 

<span data-ttu-id="9c7da-965">Hello restantes de esta sección describen algunas de las características de Hola Hola biblioteca cliente de almacenamiento que facilitan el trabajo con varios tipos de entidad en hello mismo tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-965">hello remainder of this section describes some of hello features in hello Storage Client Library that facilitate working with multiple entity types in hello same table.</span></span>  

#### <a name="retrieving-heterogeneous-entity-types"></a><span data-ttu-id="9c7da-966">Recuperar tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-966">Retrieving heterogeneous entity types</span></span>
<span data-ttu-id="9c7da-967">Si usas Hola biblioteca cliente de almacenamiento, tiene tres opciones para trabajar con varios tipos de entidad.</span><span class="sxs-lookup"><span data-stu-id="9c7da-967">If you are using hello Storage Client Library, you have three options for working with multiple entity types.</span></span>  

<span data-ttu-id="9c7da-968">Si sabe Hola tipo de entidad de hello almacenado con un valor concreto **RowKey** y **PartitionKey** valores, a continuación, puede especificar tipo de entidad de hello al recuperar entidad Hola tal y como se muestra en los ejemplos de hello dos anteriores que recuperan entidades de tipo **EmployeeEntity**: [ejecutar una consulta de punto mediante Hola biblioteca cliente de almacenamiento](#executing-a-point-query-using-the-storage-client-library) y [recuperar varias entidades usando LINQ](#retrieving-multiple-entities-using-linq).</span><span class="sxs-lookup"><span data-stu-id="9c7da-968">If you know hello type of hello entity stored with a specific **RowKey** and **PartitionKey** values, then you can specify hello entity type when you retrieve hello entity as shown in hello previous two examples that retrieve entities of type **EmployeeEntity**: [Executing a point query using hello Storage Client Library](#executing-a-point-query-using-the-storage-client-library) and [Retrieving multiple entities using LINQ](#retrieving-multiple-entities-using-linq).</span></span>  

<span data-ttu-id="9c7da-969">Hola segunda opción es hello toouse **DynamicTableEntity** tipo (una bolsa de propiedades) en lugar de un tipo concreto de entidad POCO (esta opción también puede mejorar el rendimiento porque no hay ninguna necesidad de tooserialize y deserializar entidad Hola demasiado. Tipos de red).</span><span class="sxs-lookup"><span data-stu-id="9c7da-969">hello second option is toouse hello **DynamicTableEntity** type (a property bag) instead of a concrete POCO entity type (this option may also improve performance because there is no need tooserialize and deserialize hello entity too.NET types).</span></span> <span data-ttu-id="9c7da-970">Hola siguiente código de C# potencialmente recupera varias entidades de distintos tipos de tabla de hello, pero devuelve todas las entidades como **DynamicTableEntity** instancias.</span><span class="sxs-lookup"><span data-stu-id="9c7da-970">hello following C# code potentially retrieves multiple entities of different types from hello table, but returns all entities as **DynamicTableEntity** instances.</span></span> <span data-ttu-id="9c7da-971">A continuación, utiliza hello **EntityType** tipo de propiedad toodetermine Hola de cada entidad:</span><span class="sxs-lookup"><span data-stu-id="9c7da-971">It then uses hello **EntityType** property toodetermine hello type of each entity:</span></span>  

```csharp
string filter = TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("PartitionKey",
    QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("RowKey",
                    QueryComparisons.GreaterThanOrEqual, "B"),
        TableOperators.And,
        TableQuery.GenerateFilterCondition("RowKey",
        QueryComparisons.LessThan, "F")
    )
);
TableQuery<DynamicTableEntity> entityQuery =
    new TableQuery<DynamicTableEntity>().Where(filter);
var employees = employeeTable.ExecuteQuery(entityQuery);

IEnumerable<DynamicTableEntity> entities = employeeTable.ExecuteQuery(entityQuery);
foreach (var e in entities)
{
EntityProperty entityTypeProperty;
if (e.Properties.TryGetValue("EntityType", out entityTypeProperty))
{
    if (entityTypeProperty.StringValue == "Employee")
    {
        // Use entityTypeProperty, RowKey, PartitionKey, Etag, and Timestamp
        }
    }
}  
```

<span data-ttu-id="9c7da-972">Tenga en cuenta que tooretrieve otras propiedades que se debe utilizar hello **TryGetValue** método en hello **propiedades** propiedad de hello **DynamicTableEntity** clase.</span><span class="sxs-lookup"><span data-stu-id="9c7da-972">Note that tooretrieve other properties you must use hello **TryGetValue** method on hello **Properties** property of hello **DynamicTableEntity** class.</span></span>  

<span data-ttu-id="9c7da-973">Una tercera opción es toocombine con hello **DynamicTableEntity** tipo y un **EntityResolver** instancia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-973">A third option is toocombine using hello **DynamicTableEntity** type and an **EntityResolver** instance.</span></span> <span data-ttu-id="9c7da-974">Esto le permite tooresolve toomultiple POCO tipos Hola misma consulta.</span><span class="sxs-lookup"><span data-stu-id="9c7da-974">This enables you tooresolve toomultiple POCO types in hello same query.</span></span> <span data-ttu-id="9c7da-975">En este ejemplo, Hola **EntityResolver** delegado está usando hello **EntityType** toodistinguish de propiedad entre los tipos de hello dos de entidad que Hola consulta devuelve.</span><span class="sxs-lookup"><span data-stu-id="9c7da-975">In this example, hello **EntityResolver** delegate is using hello **EntityType** property toodistinguish between hello two types of entity that hello query returns.</span></span> <span data-ttu-id="9c7da-976">Hola **resolver** método usa hello **resolución** delegar tooresolve **DynamicTableEntity** instancias demasiado**TableEntity** instancias.</span><span class="sxs-lookup"><span data-stu-id="9c7da-976">hello **Resolve** method uses hello **resolver** delegate tooresolve **DynamicTableEntity** instances too**TableEntity** instances.</span></span>  

```csharp
EntityResolver<TableEntity> resolver = (pk, rk, ts, props, etag) =>
{

        TableEntity resolvedEntity = null;
        if (props["EntityType"].StringValue == "Department")
        {
        resolvedEntity = new DepartmentEntity();
        }
        else if (props["EntityType"].StringValue == "Employee")
        {
        resolvedEntity = new EmployeeEntity();
        }
        else throw new ArgumentException("Unrecognized entity", "props");

        resolvedEntity.PartitionKey = pk;
        resolvedEntity.RowKey = rk;
        resolvedEntity.Timestamp = ts;
        resolvedEntity.ETag = etag;
        resolvedEntity.ReadEntity(props, null);
        return resolvedEntity;
};

string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<DynamicTableEntity> entityQuery =
        new TableQuery<DynamicTableEntity>().Where(filter);

var entities = employeeTable.ExecuteQuery(entityQuery, resolver);
foreach (var e in entities)
{
        if (e is DepartmentEntity)
        {
    ...
        }
        if (e is EmployeeEntity)
        {
    ...
        }
}  
```

#### <a name="modifying-heterogeneous-entity-types"></a><span data-ttu-id="9c7da-977">Modificar tipos de entidad heterogéneos</span><span class="sxs-lookup"><span data-stu-id="9c7da-977">Modifying heterogeneous entity types</span></span>
<span data-ttu-id="9c7da-978">No es necesario tooknow tipo de Hola de una entidad toodelete y conozca tipo hello de una entidad al insertarlo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-978">You do not need tooknow hello type of an entity toodelete it, and you always know hello type of an entity when you insert it.</span></span> <span data-ttu-id="9c7da-979">Sin embargo, puede usar **DynamicTableEntity** escriba tooupdate una entidad sin conocer su tipo y sin utilizar una clase de entidad POCO.</span><span class="sxs-lookup"><span data-stu-id="9c7da-979">However, you can use **DynamicTableEntity** type tooupdate an entity without knowing its type and without using a POCO entity class.</span></span> <span data-ttu-id="9c7da-980">Hello ejemplo de código siguiente recupera una entidad única y comprueba hello **EmployeeCount** propiedad existe antes de actualizarlo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-980">hello following code sample retrieves a single entity, and checks hello **EmployeeCount** property exists before updating it.</span></span>  

```csharp
TableResult result =
        employeeTable.Execute(TableOperation.Retrieve(partitionKey, rowKey));
DynamicTableEntity department = (DynamicTableEntity)result.Result;

EntityProperty countProperty;

if (!department.Properties.TryGetValue("EmployeeCount", out countProperty))
{
        throw new
        InvalidOperationException("Invalid entity, EmployeeCount property not found.");
}
countProperty.Int32Value += 1;
employeeTable.Execute(TableOperation.Merge(department));  
```

### <a name="controlling-access-with-shared-access-signatures"></a><span data-ttu-id="9c7da-981">Control de acceso con firmas de acceso compartido</span><span class="sxs-lookup"><span data-stu-id="9c7da-981">Controlling access with Shared Access Signatures</span></span>
<span data-ttu-id="9c7da-982">Puede usar toomodify de las aplicaciones de cliente de firma de acceso compartido (SAS) tokens tooenable (y consultar) las entidades de tabla directamente sin Hola necesidad tooauthenticate directamente con el servicio de la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-982">You can use Shared Access Signature (SAS) tokens tooenable client applications toomodify (and query) table entities directly without hello need tooauthenticate directly with hello table service.</span></span> <span data-ttu-id="9c7da-983">Normalmente, hay tres ventajas principales toousing SAS en la aplicación:</span><span class="sxs-lookup"><span data-stu-id="9c7da-983">Typically, there are three main benefits toousing SAS in your application:</span></span>  

* <span data-ttu-id="9c7da-984">No es necesario toodistribute su almacenamiento cuenta tooan clave insegura plataforma (por ejemplo, un dispositivo móvil) en orden tooallow tooaccess de ese dispositivo y modificar las entidades de hello servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-984">You do not need toodistribute your storage account key tooan insecure platform (such as a mobile device) in order tooallow that device tooaccess and modify entities in hello Table service.</span></span>  
* <span data-ttu-id="9c7da-985">Puede descargar algunas de las tareas de hello ese sitio web y roles de trabajo realizar para administrar los dispositivos de tooclient de entidades, como los equipos y dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="9c7da-985">You can offload some of hello work that web and worker roles perform in managing your entities tooclient devices such as end-user computers and mobile devices.</span></span>  
* <span data-ttu-id="9c7da-986">Puede asignar un restringida y conjunto de cliente de tooa de permisos (por ejemplo, para permitir el acceso de solo lectura toospecific recursos) limitado de tiempo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-986">You can assign a constrained and time limited set of permissions tooa client (such as allowing read-only access toospecific resources).</span></span>  

<span data-ttu-id="9c7da-987">Para obtener más información acerca del uso de tokens de SAS con hello servicio tabla, vea [utilizando firmas de acceso compartido (SAS)](storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="9c7da-987">For more information about using SAS tokens with hello Table service, see [Using Shared Access Signatures (SAS)](storage-dotnet-shared-access-signature-part-1.md).</span></span>  

<span data-ttu-id="9c7da-988">Sin embargo, todavía debe generar tokens SAS de Hola que conceda a un cliente las entidades de toohello de aplicación de servicio de la tabla de Hola: debería hacerlo en un entorno que se protegen acceso tooyour claves de cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="9c7da-988">However, you must still generate hello SAS tokens that grant a client application toohello entities in hello table service: you should do this in an environment that has secure access tooyour storage account keys.</span></span> <span data-ttu-id="9c7da-989">Normalmente, se utiliza un Hola de toogenerate de rol web o de trabajo SAS tokens y entregarlos toohello las aplicaciones de cliente que necesitan tener acceso a entidades de tooyour.</span><span class="sxs-lookup"><span data-stu-id="9c7da-989">Typically, you use a web or worker role toogenerate hello SAS tokens and deliver them toohello client applications that need access tooyour entities.</span></span> <span data-ttu-id="9c7da-990">Dado que todavía hay una sobrecarga implicada en la generación y entrega tooclients de tokens SAS, debe considerar la mejor manera de tooreduce esta sobrecarga, especialmente en escenarios de alto volumen.</span><span class="sxs-lookup"><span data-stu-id="9c7da-990">Because there is still an overhead involved in generating and delivering SAS tokens tooclients, you should consider how best tooreduce this overhead, especially in high-volume scenarios.</span></span>  

<span data-ttu-id="9c7da-991">Es posible toogenerate un token SAS que concede acceso tooa subconjunto de entidades de hello en una tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-991">It is possible toogenerate a SAS token that grants access tooa subset of hello entities in a table.</span></span> <span data-ttu-id="9c7da-992">De forma predeterminada, se crea un token SAS para una tabla completa, pero también es posible toospecify ese tooeither de acceso de hello SAS token conceder un intervalo de **PartitionKey** valores o un intervalo de **PartitionKey** y  **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="9c7da-992">By default, you create a SAS token for an entire table, but it is also possible toospecify that hello SAS token grant access tooeither a range of **PartitionKey** values, or a range of **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="9c7da-993">Puede elegir a toogenerate tokens SAS para usuarios individuales del sistema de forma que el token de SAS de cada usuario solo les permite el acceso tootheir propio entidades Hola servicio tabla.</span><span class="sxs-lookup"><span data-stu-id="9c7da-993">You might choose toogenerate SAS tokens for individual users of your system such that each user's SAS token only allows them access tootheir own entities in hello table service.</span></span>  

### <a name="asynchronous-and-parallel-operations"></a><span data-ttu-id="9c7da-994">Operaciones asincrónicas y paralelas</span><span class="sxs-lookup"><span data-stu-id="9c7da-994">Asynchronous and parallel operations</span></span>
<span data-ttu-id="9c7da-995">En caso de que reparta las solicitudes entre varias particiones, puede mejorar el rendimiento y la capacidad de respuesta del cliente mediante consultas asincrónicas o paralelas.</span><span class="sxs-lookup"><span data-stu-id="9c7da-995">Provided you are spreading your requests across multiple partitions, you can improve throughput and client responsiveness by using asynchronous or parallel queries.</span></span>
<span data-ttu-id="9c7da-996">Por ejemplo, podría tener dos o más instancias de rol de trabajo con acceso a las tablas en paralelo.</span><span class="sxs-lookup"><span data-stu-id="9c7da-996">For example, you might have two or more worker role instances accessing your tables in parallel.</span></span> <span data-ttu-id="9c7da-997">Se puede tener roles de trabajo individuales responsables determinados conjuntos de particiones, o simplemente tiene varias instancias de rol de trabajo, cada tooaccess capaz de todas las particiones en una tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="9c7da-997">You could have individual worker roles responsible for particular sets of partitions, or simply have multiple worker role instances, each able tooaccess all hello partitions in a table.</span></span>  

<span data-ttu-id="9c7da-998">Dentro de una instancia de cliente, puede mejorar el rendimiento mediante la ejecución de operaciones de almacenamiento de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-998">Within a client instance, you can improve throughput by executing storage operations asynchronously.</span></span> <span data-ttu-id="9c7da-999">Hola biblioteca cliente de almacenamiento permite modificaciones y consultas asincrónicas de toowrite fácil.</span><span class="sxs-lookup"><span data-stu-id="9c7da-999">hello Storage Client Library makes it easy toowrite asynchronous queries and modifications.</span></span> <span data-ttu-id="9c7da-1000">Por ejemplo, puede comenzar con el método sincrónico de Hola que recupera todas las entidades de hello en una partición como se muestra en hello siguiente código de C#:</span><span class="sxs-lookup"><span data-stu-id="9c7da-1000">For example, you might start with hello synchronous method that retrieves all hello entities in a partition as shown in hello following C# code:</span></span>  

```csharp
private static void ManyEntitiesQuery(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

        TableContinuationToken continuationToken = null;

        do
        {
        var employees = employeeTable.ExecuteQuerySegmented(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
    {
        ...
    }
        continuationToken = employees.ContinuationToken;
        } while (continuationToken != null);
}  
```

<span data-ttu-id="9c7da-1001">Puede modificar fácilmente este código para que esa consulta Hola se ejecuta de forma asincrónica como sigue:</span><span class="sxs-lookup"><span data-stu-id="9c7da-1001">You can easily modify this code so that hello query runs asynchronously as follows:</span></span>  

```csharp
private static async Task ManyEntitiesQueryAsync(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);
        TableContinuationToken continuationToken = null;

        do
        {
        var employees = await employeeTable.ExecuteQuerySegmentedAsync(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
        {
            ...
        }
        continuationToken = employees.ContinuationToken;
            } while (continuationToken != null);
}  
```

<span data-ttu-id="9c7da-1002">En este ejemplo asincrónica, puede ver la siguiente Hola cambia de la versión sincrónica de hello:</span><span class="sxs-lookup"><span data-stu-id="9c7da-1002">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="9c7da-1003">firma del método Hello ahora incluye hello **async** modificador y devuelve un **tarea** instancia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1003">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="9c7da-1004">En lugar de Hola que realiza la llamada **ExecuteSegmented** resultados del método tooretrieve, Hola método ahora llamadas Hola **ExecuteSegmentedAsync** Hola de método y se utiliza **await** modificador tooretrieve resultados de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1004">Instead of calling hello **ExecuteSegmented** method tooretrieve results, hello method now calls hello **ExecuteSegmentedAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="9c7da-1005">aplicación de cliente de Hello puede llamar a este método varias veces (con valores diferentes para hello **departamento** parámetro), y cada consulta se ejecutará en un subproceso independiente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1005">hello client application can call this method multiple times (with different values for hello **department** parameter), and each query will run on a separate thread.</span></span>  

<span data-ttu-id="9c7da-1006">Tenga en cuenta que no hay ninguna versión asincrónica de hello **Execute** método Hola **TableQuery** clase porque hello **IEnumerable** interfaz no admite asincrónica enumeración.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1006">Note that there is no asynchronous version of hello **Execute** method in hello **TableQuery** class because hello **IEnumerable** interface does not support asynchronous enumeration.</span></span>  

<span data-ttu-id="9c7da-1007">También puede insertar, actualizar y eliminar entidades de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1007">You can also insert, update, and delete entities asynchronously.</span></span> <span data-ttu-id="9c7da-1008">Hola el ejemplo de C# siguiente muestra un método sencillo y sincrónico tooinsert o reemplaza una entidad empleado:</span><span class="sxs-lookup"><span data-stu-id="9c7da-1008">hello following C# example shows a simple, synchronous method tooinsert or replace an employee entity:</span></span>  

```csharp
private static void SimpleEmployeeUpsert(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = employeeTable
        .Execute(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="9c7da-1009">Puede modificar fácilmente este código para que la actualización de Hola se ejecuta de forma asincrónica como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="9c7da-1009">You can easily modify this code so that hello update runs asynchronously as follows:</span></span>  

```csharp
private static async Task SimpleEmployeeUpsertAsync(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = await employeeTable
        .ExecuteAsync(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="9c7da-1010">En este ejemplo asincrónica, puede ver la siguiente Hola cambia de la versión sincrónica de hello:</span><span class="sxs-lookup"><span data-stu-id="9c7da-1010">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="9c7da-1011">firma del método Hello ahora incluye hello **async** modificador y devuelve un **tarea** instancia.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1011">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="9c7da-1012">En lugar de Hola que realiza la llamada **Execute** entidad de método tooupdate hello, Hola método ahora llamadas Hola **ExecuteAsync** Hola de método y se utiliza **await** tooretrieve de modificador Si se produce de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1012">Instead of calling hello **Execute** method tooupdate hello entity, hello method now calls hello **ExecuteAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="9c7da-1013">aplicación de cliente de Hello puede llamar a varios métodos asincrónicos como este, y cada invocación del método se ejecutará en un subproceso independiente.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1013">hello client application can call multiple asynchronous methods like this one, and each method invocation will run on a separate thread.</span></span>  

### <a name="credits"></a><span data-ttu-id="9c7da-1014">Créditos</span><span class="sxs-lookup"><span data-stu-id="9c7da-1014">Credits</span></span>
<span data-ttu-id="9c7da-1015">Nos gustaría hello toothank después de los miembros de equipo de Azure para sus contribuciones hello: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Shah Vinay y Serdar Ozler, así como Tom Hollander de DX de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1015">We would like toothank hello following members of hello Azure team for their contributions: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah and Serdar Ozler as well as  Tom Hollander from Microsoft DX.</span></span> 

<span data-ttu-id="9c7da-1016">También nos gustaría hello toothank sigue MVP de Microsoft para sus valiosos comentarios durante los ciclos de revisión: Igor Papirov y Edward Bakker.</span><span class="sxs-lookup"><span data-stu-id="9c7da-1016">We would also like toothank hello following Microsoft MVP's for their valuable feedback during review cycles: Igor Papirov and Edward Bakker.</span></span>

[1]: ./media/storage-table-design-guide/storage-table-design-IMAGE01.png
[2]: ./media/storage-table-design-guide/storage-table-design-IMAGE02.png
[3]: ./media/storage-table-design-guide/storage-table-design-IMAGE03.png
[4]: ./media/storage-table-design-guide/storage-table-design-IMAGE04.png
[5]: ./media/storage-table-design-guide/storage-table-design-IMAGE05.png
[6]: ./media/storage-table-design-guide/storage-table-design-IMAGE06.png
[7]: ./media/storage-table-design-guide/storage-table-design-IMAGE07.png
[8]: ./media/storage-table-design-guide/storage-table-design-IMAGE08.png
[9]: ./media/storage-table-design-guide/storage-table-design-IMAGE09.png
[10]: ./media/storage-table-design-guide/storage-table-design-IMAGE10.png
[11]: ./media/storage-table-design-guide/storage-table-design-IMAGE11.png
[12]: ./media/storage-table-design-guide/storage-table-design-IMAGE12.png
[13]: ./media/storage-table-design-guide/storage-table-design-IMAGE13.png
[14]: ./media/storage-table-design-guide/storage-table-design-IMAGE14.png
[15]: ./media/storage-table-design-guide/storage-table-design-IMAGE15.png
[16]: ./media/storage-table-design-guide/storage-table-design-IMAGE16.png
[17]: ./media/storage-table-design-guide/storage-table-design-IMAGE17.png
[18]: ./media/storage-table-design-guide/storage-table-design-IMAGE18.png
[19]: ./media/storage-table-design-guide/storage-table-design-IMAGE19.png
[20]: ./media/storage-table-design-guide/storage-table-design-IMAGE20.png
[21]: ./media/storage-table-design-guide/storage-table-design-IMAGE21.png
[22]: ./media/storage-table-design-guide/storage-table-design-IMAGE22.png
[23]: ./media/storage-table-design-guide/storage-table-design-IMAGE23.png
[24]: ./media/storage-table-design-guide/storage-table-design-IMAGE24.png
[25]: ./media/storage-table-design-guide/storage-table-design-IMAGE25.png
[26]: ./media/storage-table-design-guide/storage-table-design-IMAGE26.png
[27]: ./media/storage-table-design-guide/storage-table-design-IMAGE27.png
[28]: ./media/storage-table-design-guide/storage-table-design-IMAGE28.png
[29]: ./media/storage-table-design-guide/storage-table-design-IMAGE29.png

