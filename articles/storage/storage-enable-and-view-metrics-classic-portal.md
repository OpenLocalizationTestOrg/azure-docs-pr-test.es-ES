---
title: "Habilitar las métricas de almacenamiento en el Azure Portal | Microsoft Docs"
description: "Cómo habilitar las métricas de almacenamiento para los servicios BLOB, Cola, Tabla y Archivo"
services: storage
documentationcenter: 
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 2fb5b229-f099-4334-92be-4e0e7dd257d7
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/03/2017
ms.author: robinsh
ms.openlocfilehash: 4d6065597a41372ea6d320ab318b0c71d6a48b2a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="enabling-storage-metrics-and-viewing-metrics-data"></a><span data-ttu-id="39cf1-103">Habilitar las Métricas de almacenamiento y las Métricas de visualización</span><span class="sxs-lookup"><span data-stu-id="39cf1-103">Enabling Storage metrics and viewing metrics data</span></span>
[!INCLUDE [storage-selector-portal-enable-and-view-metrics](../../includes/storage-selector-portal-enable-and-view-metrics.md)]

## <a name="overview"></a><span data-ttu-id="39cf1-104">Información general</span><span class="sxs-lookup"><span data-stu-id="39cf1-104">Overview</span></span>
<span data-ttu-id="39cf1-105">Las métricas de almacenamiento se habilitan de forma predeterminada al crear una nueva cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-105">Storage Metrics is enabled by default when you create a new storage account.</span></span> <span data-ttu-id="39cf1-106">Puede configurar la supervisión mediante el [Portal de Azure clásico](https://manage.windowsazure.com), Windows PowerShell o mediante programación a través de una API de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-106">You can configure monitoring using either the [Azure Classic Portal](https://manage.windowsazure.com), Windows PowerShell, or programmatically through a storage API.</span></span>

<span data-ttu-id="39cf1-107">Al habilitar las Métricas de almacenamiento, debe elegir un período de retención de datos: este período determina el tiempo que el servicio de almacenamiento mantiene las métricas y cobra por el espacio necesario para almacenarlas.</span><span class="sxs-lookup"><span data-stu-id="39cf1-107">When you enable Storage Metrics, you must choose a retention period for the data: this period determines for how long the storage service keeps the metrics and charges you for the space required to store them.</span></span> <span data-ttu-id="39cf1-108">Generalmente, usará un período de retención más corto para la métrica por minuto que para la métrica por hora debido al considerable espacio adicional requerido para la métrica por minuto.</span><span class="sxs-lookup"><span data-stu-id="39cf1-108">Typically, you should use a shorter retention period for minute metrics than hourly metrics because of the significant extra space required for minute metrics.</span></span> <span data-ttu-id="39cf1-109">Debe elegir un período de retención durante el cual tenga suficiente tiempo para analizar los datos y descargar todas las métricas que quiera mantener para los informes o el análisis sin conexión.</span><span class="sxs-lookup"><span data-stu-id="39cf1-109">You should choose a retention period such that you have sufficient time to analyze the data and download any metrics you wish to keep for off-line analysis or reporting purposes.</span></span> <span data-ttu-id="39cf1-110">Recuerde que también se le facturará por la descarga de los datos de métricas desde su cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-110">Remember that you will also be billed for downloading metrics data from your storage account.</span></span>

## <a name="how-to-enable-storage-metrics-using-the-azure-classic-portal"></a><span data-ttu-id="39cf1-111">Cómo habilitar las Métricas de almacenamiento mediante el Portal de Azure clásico</span><span class="sxs-lookup"><span data-stu-id="39cf1-111">How to enable Storage metrics using the Azure Classic Portal</span></span>
<span data-ttu-id="39cf1-112">En el [Portal de Azure clásico](https://manage.windowsazure.com), puede usar la página Configurar de una cuenta de almacenamiento para así controlar las Métricas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-112">In the [Azure Classic Portal](https://manage.windowsazure.com), you use the Configure page for a storage account to control Storage Metrics.</span></span> <span data-ttu-id="39cf1-113">Para supervisarlas, puede establecer un nivel y un período de retención cuantificado en días para cada blob, tabla y cola.</span><span class="sxs-lookup"><span data-stu-id="39cf1-113">For monitoring, you can set a level and a retention period in days for each of blobs, tables, and queues.</span></span> <span data-ttu-id="39cf1-114">En cada caso, el nivel es uno de los siguientes:</span><span class="sxs-lookup"><span data-stu-id="39cf1-114">In each case, the level is one of the following:</span></span>

* <span data-ttu-id="39cf1-115">Desactivada: significa que no se recopilan métricas.</span><span class="sxs-lookup"><span data-stu-id="39cf1-115">Off — No metrics are collected.</span></span>
* <span data-ttu-id="39cf1-116">Mínima: las Métricas de almacenamiento recopilan un conjunto de métricas básicas como entrada/salida, disponibilidad, latencia y porcentajes de éxito, que se agregan para los servicios BLOB, tabla y cola.</span><span class="sxs-lookup"><span data-stu-id="39cf1-116">Minimal — Storage Metrics collects a basic set of metrics such as ingress/egress, availability, latency, and success percentages, which are aggregated for the Blob, Table, and Queue services.</span></span>
* <span data-ttu-id="39cf1-117">Detallada: las Métricas de almacenamiento recopilan un conjunto completo de métricas que incluye las mismas métricas para cada operación de API de almacenamiento, además de las métricas de nivel de servicio.</span><span class="sxs-lookup"><span data-stu-id="39cf1-117">Verbose — Storage Metrics collects a full set of metrics that includes the same metrics for each storage API operation, in addition to the service-level metrics.</span></span> <span data-ttu-id="39cf1-118">Las métricas detalladas facilitan el análisis preciso de los problemas que se producen durante las operaciones de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="39cf1-118">Verbose metrics enable closer analysis of issues that occur during application operations.</span></span>

<span data-ttu-id="39cf1-119">Tenga en cuenta que el Portal de Azure clásico no permite actualmente configurar métricas por minuto en su cuenta de almacenamiento; debe habilitar las métricas por minuto con PowerShell o mediante programación.</span><span class="sxs-lookup"><span data-stu-id="39cf1-119">Note that the Azure Classic Portal does not currently enable you to configure minute metrics in your storage account; you must enable minute metrics using PowerShell or programmatically.</span></span>

## <a name="how-to-enable-storage-metrics-using-powershell"></a><span data-ttu-id="39cf1-120">Cómo habilitar las Métricas de almacenamiento con PowerShell</span><span class="sxs-lookup"><span data-stu-id="39cf1-120">How to enable Storage metrics using PowerShell</span></span>
<span data-ttu-id="39cf1-121">Puede usar PowerShell en el equipo local para configurar las Métricas de almacenamiento en su cuenta de almacenamiento con el cmdlet Get-AzureStorageServiceMetricsProperty de Azure PowerShell para recuperar la configuración actual y el cmdlet Set-AzureStorageServiceMetricsProperty para cambiar la configuración actual.</span><span class="sxs-lookup"><span data-stu-id="39cf1-121">You can use PowerShell on your local machine to configure Storage Metrics in your storage account by using the Azure PowerShell cmdlet Get-AzureStorageServiceMetricsProperty to retrieve the current settings, and the cmdlet Set-AzureStorageServiceMetricsProperty to change the current settings.</span></span>

<span data-ttu-id="39cf1-122">Los cmdlets que controlan las Métricas de almacenamiento usan los siguientes parámetros:</span><span class="sxs-lookup"><span data-stu-id="39cf1-122">The cmdlets that control Storage Metrics use the following parameters:</span></span>

* <span data-ttu-id="39cf1-123">Los valores posibles de MetricsType son Hour y Minute.</span><span class="sxs-lookup"><span data-stu-id="39cf1-123">MetricsType possible values are Hour and Minute.</span></span>
* <span data-ttu-id="39cf1-124">Los valores posibles de ServiceType son Blob, Queue y Table.</span><span class="sxs-lookup"><span data-stu-id="39cf1-124">ServiceType possible values are Blob, Queue, and Table.</span></span>
* <span data-ttu-id="39cf1-125">Los valores posibles de MetricsLevel son None (equivalente a Desactivado en el Portal de Azure clásico), Service (equivalente a Mínimo en el Portal de Azure clásico) y ServiceAndApi (equivalente a Detallado en el Portal de Azure clásico).</span><span class="sxs-lookup"><span data-stu-id="39cf1-125">MetricsLevel possible values are None (equivalent to Off in the Azure Classic Portal), Service (equivalent to Minimal in the Azure Classic Portal), and ServiceAndApi (equivalent to Verbose in the Azure Classic Portal).</span></span>

<span data-ttu-id="39cf1-126">Por ejemplo, el siguiente comando activa las métricas por minuto para el servicio BLOB en su cuenta de almacenamiento predeterminada con el período de retención establecido en cinco días:</span><span class="sxs-lookup"><span data-stu-id="39cf1-126">For example, the following command switches on minute metrics for the blob service in your default storage account with the retention period set to five days:</span></span>

```powershell
Set-AzureStorageServiceMetricsProperty -MetricsType Minute -ServiceType Blob -MetricsLevel ServiceAndApi  -RetentionDays 5
```
<span data-ttu-id="39cf1-127">El comando siguiente recupera el nivel de métricas por hora actual y los días de retención para el servicio BLOB en su cuenta de almacenamiento predeterminada:</span><span class="sxs-lookup"><span data-stu-id="39cf1-127">The following command retrieves the current hourly metrics level and retention days for the blob service in your default storage account:</span></span>

```powershell
Get-AzureStorageServiceMetricsProperty -MetricsType Hour -ServiceType Blob
```
<span data-ttu-id="39cf1-128">Para obtener información sobre cómo configurar los cmdlets de Azure PowerShell para que funcionen con su suscripción de Azure y cómo seleccionar la cuenta de almacenamiento predeterminada que quiere usar, vea: [Cómo instalar y configurar Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="39cf1-128">For information about how to configure the Azure PowerShell cmdlets to work with your Azure subscription and how to select the default storage account to use, see: [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>

## <a name="how-to-enable-storage-metrics-programmatically"></a><span data-ttu-id="39cf1-129">Cómo habilitar las Métricas de almacenamiento mediante programación</span><span class="sxs-lookup"><span data-stu-id="39cf1-129">How to enable Storage metrics programmatically</span></span>
<span data-ttu-id="39cf1-130">El siguiente fragmento de C# muestra cómo habilitar el registro y las métricas para el servicio BLOB mediante la biblioteca del cliente de almacenamiento de .NET:</span><span class="sxs-lookup"><span data-stu-id="39cf1-130">The following C# snippet shows how to enable metrics and logging for the Blob service using the storage client library for .NET:</span></span>

```csharp
//Parse the connection string for the storage account.
const string ConnectionString = "DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key";
CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConnectionString);

// Create service client for credentialed access to the Blob service.
CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();

// Enable Storage Analytics logging and set retention policy to 10 days. 
ServiceProperties properties = new ServiceProperties();
properties.Logging.LoggingOperations = LoggingOperations.All;
properties.Logging.RetentionDays = 10;
properties.Logging.Version = "1.0";

// Configure service properties for metrics. Both metrics and logging must be set at the same time.
properties.HourMetrics.MetricsLevel = MetricsLevel.ServiceAndApi;
properties.HourMetrics.RetentionDays = 10;
properties.HourMetrics.Version = "1.0";

properties.MinuteMetrics.MetricsLevel = MetricsLevel.ServiceAndApi;
properties.MinuteMetrics.RetentionDays = 10;
properties.MinuteMetrics.Version = "1.0";

// Set the default service version to be used for anonymous requests.
properties.DefaultServiceVersion = "2015-04-05";

// Set the service properties.
blobClient.SetServiceProperties(properties);
```

## <a name="viewing-storage-metrics"></a><span data-ttu-id="39cf1-131">Mostrar Métricas de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="39cf1-131">Viewing Storage metrics</span></span>
<span data-ttu-id="39cf1-132">Cuando haya configurado las Métricas de almacenamiento para supervisar su cuenta de almacenamiento, registra las métricas en un conjunto de tablas conocidas en su cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-132">When you have configured Storage Metrics to monitor your storage account, it records the metrics in a set of well-known tables in your storage account.</span></span> <span data-ttu-id="39cf1-133">Puede usar la página Supervisar de su cuenta de almacenamiento en el Portal de Azure clásico para ver las métricas por hora a medida que están disponibles en un gráfico.</span><span class="sxs-lookup"><span data-stu-id="39cf1-133">You can use the Monitor page for your storage account in the Azure Classic Portal to view the hourly metrics as they become available on a chart.</span></span> <span data-ttu-id="39cf1-134">En esta página del Portal de Azure clásico, puede:</span><span class="sxs-lookup"><span data-stu-id="39cf1-134">On this page in the Azure Classic Portal, you can:</span></span>

* <span data-ttu-id="39cf1-135">Seleccionar qué métricas quiere trazar en el gráfico (la variedad de métricas disponibles dependerá de si ha elegido la supervisión detallada o mínima para el servicio en la página Configurar).</span><span class="sxs-lookup"><span data-stu-id="39cf1-135">Select which metrics to plot on the chart (the choice of available metrics will depend on whether you chose verbose or minimal monitoring for the service on the Configure page).</span></span>
* <span data-ttu-id="39cf1-136">Seleccionar el intervalo de tiempo para las métricas mostradas en el gráfico.</span><span class="sxs-lookup"><span data-stu-id="39cf1-136">Select the time range for the metrics displayed on the chart.</span></span>
* <span data-ttu-id="39cf1-137">Elegir el uso de una escala absoluta o relativa para trazar las métricas.</span><span class="sxs-lookup"><span data-stu-id="39cf1-137">Choose to use an absolute or relative scale to plot the metrics.</span></span>
* <span data-ttu-id="39cf1-138">Configurar alertas por correo electrónico que le notifiquen cuándo una métrica específica alcanza un valor determinado.</span><span class="sxs-lookup"><span data-stu-id="39cf1-138">Configure email alerts to notify you when a specific metric reaches a certain value.</span></span>

<span data-ttu-id="39cf1-139">Si quiere descargar las métricas para su almacenamiento de larga duración o para analizarlas localmente, deberá usar una herramienta o escribir código para leer las tablas.</span><span class="sxs-lookup"><span data-stu-id="39cf1-139">If you want to download the metrics for long-term storage or to analyze them locally, you will need to use a tool or write some code to read the tables.</span></span> <span data-ttu-id="39cf1-140">Debe descargar las métricas por minuto para el análisis.</span><span class="sxs-lookup"><span data-stu-id="39cf1-140">You must download the minute metrics for analysis.</span></span> <span data-ttu-id="39cf1-141">Las tablas no aparecen si lista todas las tablas en su cuenta de almacenamiento, pero puede acceder a ellas directamente por su nombre.</span><span class="sxs-lookup"><span data-stu-id="39cf1-141">The tables do not appear if you list all the tables in your storage account, but you can access them directly by name.</span></span> <span data-ttu-id="39cf1-142">Muchas herramientas de exploración de almacenamiento de terceros tienen en cuenta estas tablas y permiten que las vea directamente (vea la publicación en el blog [Información general sobre los exploradores del almacenamiento de Microsoft Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) para ver una lista de herramientas disponibles).</span><span class="sxs-lookup"><span data-stu-id="39cf1-142">Many third-party storage-browsing tools are aware of these tables and enable you to view them directly (see the blog post [Microsoft Azure Storage Explorers](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) for a list of available tools).</span></span>

### <a name="hourly-metrics"></a><span data-ttu-id="39cf1-143">Métricas por hora</span><span class="sxs-lookup"><span data-stu-id="39cf1-143">Hourly metrics</span></span>
* <span data-ttu-id="39cf1-144">$MetricsHourPrimaryTransactionsBlob</span><span class="sxs-lookup"><span data-stu-id="39cf1-144">$MetricsHourPrimaryTransactionsBlob</span></span>
* <span data-ttu-id="39cf1-145">$MetricsHourPrimaryTransactionsTable</span><span class="sxs-lookup"><span data-stu-id="39cf1-145">$MetricsHourPrimaryTransactionsTable</span></span>
* <span data-ttu-id="39cf1-146">$MetricsHourPrimaryTransactionsQueue</span><span class="sxs-lookup"><span data-stu-id="39cf1-146">$MetricsHourPrimaryTransactionsQueue</span></span>

### <a name="minute-metrics"></a><span data-ttu-id="39cf1-147">Métricas por minuto</span><span class="sxs-lookup"><span data-stu-id="39cf1-147">Minute metrics</span></span>
* <span data-ttu-id="39cf1-148">$MetricsMinutePrimaryTransactionsBlob</span><span class="sxs-lookup"><span data-stu-id="39cf1-148">$MetricsMinutePrimaryTransactionsBlob</span></span>
* <span data-ttu-id="39cf1-149">$MetricsMinutePrimaryTransactionsTable</span><span class="sxs-lookup"><span data-stu-id="39cf1-149">$MetricsMinutePrimaryTransactionsTable</span></span>
* <span data-ttu-id="39cf1-150">$MetricsMinutePrimaryTransactionsQueue</span><span class="sxs-lookup"><span data-stu-id="39cf1-150">$MetricsMinutePrimaryTransactionsQueue</span></span>

### <a name="capacity"></a><span data-ttu-id="39cf1-151">Capacity</span><span class="sxs-lookup"><span data-stu-id="39cf1-151">Capacity</span></span>
* <span data-ttu-id="39cf1-152">$MetricsCapacityBlob</span><span class="sxs-lookup"><span data-stu-id="39cf1-152">$MetricsCapacityBlob</span></span>

<span data-ttu-id="39cf1-153">Puede encontrar detalles completos de los esquemas para estas tablas en [Esquema de las tablas de métricas del análisis de almacenamiento](https://msdn.microsoft.com/library/azure/hh343264.aspx).</span><span class="sxs-lookup"><span data-stu-id="39cf1-153">You can find full details of the schemas for these tables at [Storage Analytics Metrics Table Schema](https://msdn.microsoft.com/library/azure/hh343264.aspx).</span></span> <span data-ttu-id="39cf1-154">Las filas de ejemplo que tiene a continuación muestran solo un subconjunto de columnas disponibles, pero ilustran algunas características importantes acerca de la manera en que las Métricas de almacenamiento guardan estas métricas:</span><span class="sxs-lookup"><span data-stu-id="39cf1-154">The sample rows below show only a subset of the columns available, but illustrate some important features of the way Storage Metrics saves these metrics:</span></span>

| <span data-ttu-id="39cf1-155">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="39cf1-155">PartitionKey</span></span> | <span data-ttu-id="39cf1-156">RowKey</span><span class="sxs-lookup"><span data-stu-id="39cf1-156">RowKey</span></span> | <span data-ttu-id="39cf1-157">Timestamp</span><span class="sxs-lookup"><span data-stu-id="39cf1-157">Timestamp</span></span> | <span data-ttu-id="39cf1-158">TotalRequests</span><span class="sxs-lookup"><span data-stu-id="39cf1-158">TotalRequests</span></span> | <span data-ttu-id="39cf1-159">TotalBillableRequests</span><span class="sxs-lookup"><span data-stu-id="39cf1-159">TotalBillableRequests</span></span> | <span data-ttu-id="39cf1-160">TotalIngress</span><span class="sxs-lookup"><span data-stu-id="39cf1-160">TotalIngress</span></span> | <span data-ttu-id="39cf1-161">TotalEgress</span><span class="sxs-lookup"><span data-stu-id="39cf1-161">TotalEgress</span></span> | <span data-ttu-id="39cf1-162">Disponibilidad</span><span class="sxs-lookup"><span data-stu-id="39cf1-162">Availability</span></span> | <span data-ttu-id="39cf1-163">AverageE2ELatency</span><span class="sxs-lookup"><span data-stu-id="39cf1-163">AverageE2ELatency</span></span> | <span data-ttu-id="39cf1-164">AverageServerLatency</span><span class="sxs-lookup"><span data-stu-id="39cf1-164">AverageServerLatency</span></span> | <span data-ttu-id="39cf1-165">PercentSuccess</span><span class="sxs-lookup"><span data-stu-id="39cf1-165">PercentSuccess</span></span> |
| --- |:---:| ---:| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="39cf1-166">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="39cf1-166">20140522T1100</span></span> |<span data-ttu-id="39cf1-167">user;All</span><span class="sxs-lookup"><span data-stu-id="39cf1-167">user;All</span></span> |<span data-ttu-id="39cf1-168">2014-05-22T11:01:16.7650250Z</span><span class="sxs-lookup"><span data-stu-id="39cf1-168">2014-05-22T11:01:16.7650250Z</span></span> |<span data-ttu-id="39cf1-169">7</span><span class="sxs-lookup"><span data-stu-id="39cf1-169">7</span></span> |<span data-ttu-id="39cf1-170">7</span><span class="sxs-lookup"><span data-stu-id="39cf1-170">7</span></span> |<span data-ttu-id="39cf1-171">4003</span><span class="sxs-lookup"><span data-stu-id="39cf1-171">4003</span></span> |<span data-ttu-id="39cf1-172">46801</span><span class="sxs-lookup"><span data-stu-id="39cf1-172">46801</span></span> |<span data-ttu-id="39cf1-173">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-173">100</span></span> |<span data-ttu-id="39cf1-174">104.4286</span><span class="sxs-lookup"><span data-stu-id="39cf1-174">104.4286</span></span> |<span data-ttu-id="39cf1-175">6.857143</span><span class="sxs-lookup"><span data-stu-id="39cf1-175">6.857143</span></span> |<span data-ttu-id="39cf1-176">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-176">100</span></span> |
| <span data-ttu-id="39cf1-177">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="39cf1-177">20140522T1100</span></span> |<span data-ttu-id="39cf1-178">user;QueryEntities</span><span class="sxs-lookup"><span data-stu-id="39cf1-178">user;QueryEntities</span></span> |<span data-ttu-id="39cf1-179">2014-05-22T11:01:16.7640250Z</span><span class="sxs-lookup"><span data-stu-id="39cf1-179">2014-05-22T11:01:16.7640250Z</span></span> |<span data-ttu-id="39cf1-180">5</span><span class="sxs-lookup"><span data-stu-id="39cf1-180">5</span></span> |<span data-ttu-id="39cf1-181">5</span><span class="sxs-lookup"><span data-stu-id="39cf1-181">5</span></span> |<span data-ttu-id="39cf1-182">2694</span><span class="sxs-lookup"><span data-stu-id="39cf1-182">2694</span></span> |<span data-ttu-id="39cf1-183">45951</span><span class="sxs-lookup"><span data-stu-id="39cf1-183">45951</span></span> |<span data-ttu-id="39cf1-184">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-184">100</span></span> |<span data-ttu-id="39cf1-185">143.8</span><span class="sxs-lookup"><span data-stu-id="39cf1-185">143.8</span></span> |<span data-ttu-id="39cf1-186">7.8</span><span class="sxs-lookup"><span data-stu-id="39cf1-186">7.8</span></span> |<span data-ttu-id="39cf1-187">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-187">100</span></span> |
| <span data-ttu-id="39cf1-188">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="39cf1-188">20140522T1100</span></span> |<span data-ttu-id="39cf1-189">user;QueryEntity</span><span class="sxs-lookup"><span data-stu-id="39cf1-189">user;QueryEntity</span></span> |<span data-ttu-id="39cf1-190">2014-05-22T11:01:16.7650250Z</span><span class="sxs-lookup"><span data-stu-id="39cf1-190">2014-05-22T11:01:16.7650250Z</span></span> |<span data-ttu-id="39cf1-191">1</span><span class="sxs-lookup"><span data-stu-id="39cf1-191">1</span></span> |<span data-ttu-id="39cf1-192">1</span><span class="sxs-lookup"><span data-stu-id="39cf1-192">1</span></span> |<span data-ttu-id="39cf1-193">538</span><span class="sxs-lookup"><span data-stu-id="39cf1-193">538</span></span> |<span data-ttu-id="39cf1-194">633</span><span class="sxs-lookup"><span data-stu-id="39cf1-194">633</span></span> |<span data-ttu-id="39cf1-195">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-195">100</span></span> |<span data-ttu-id="39cf1-196">3</span><span class="sxs-lookup"><span data-stu-id="39cf1-196">3</span></span> |<span data-ttu-id="39cf1-197">3</span><span class="sxs-lookup"><span data-stu-id="39cf1-197">3</span></span> |<span data-ttu-id="39cf1-198">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-198">100</span></span> |
| <span data-ttu-id="39cf1-199">20140522T1100</span><span class="sxs-lookup"><span data-stu-id="39cf1-199">20140522T1100</span></span> |<span data-ttu-id="39cf1-200">user;UpdateEntity</span><span class="sxs-lookup"><span data-stu-id="39cf1-200">user;UpdateEntity</span></span> |<span data-ttu-id="39cf1-201">2014-05-22T11:01:16.7650250Z</span><span class="sxs-lookup"><span data-stu-id="39cf1-201">2014-05-22T11:01:16.7650250Z</span></span> |<span data-ttu-id="39cf1-202">1</span><span class="sxs-lookup"><span data-stu-id="39cf1-202">1</span></span> |<span data-ttu-id="39cf1-203">1</span><span class="sxs-lookup"><span data-stu-id="39cf1-203">1</span></span> |<span data-ttu-id="39cf1-204">771</span><span class="sxs-lookup"><span data-stu-id="39cf1-204">771</span></span> |<span data-ttu-id="39cf1-205">217</span><span class="sxs-lookup"><span data-stu-id="39cf1-205">217</span></span> |<span data-ttu-id="39cf1-206">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-206">100</span></span> |<span data-ttu-id="39cf1-207">9</span><span class="sxs-lookup"><span data-stu-id="39cf1-207">9</span></span> |<span data-ttu-id="39cf1-208">6</span><span class="sxs-lookup"><span data-stu-id="39cf1-208">6</span></span> |<span data-ttu-id="39cf1-209">100</span><span class="sxs-lookup"><span data-stu-id="39cf1-209">100</span></span> |

<span data-ttu-id="39cf1-210">En este ejemplo de datos de métricas por minuto, la clave de partición usa el tiempo en la resolución de minutos.</span><span class="sxs-lookup"><span data-stu-id="39cf1-210">In this example minute metrics data, the partition key uses the time at minute resolution.</span></span> <span data-ttu-id="39cf1-211">La clave de fila identifica el tipo de información que se almacena en la fila y se compone de dos fragmentos de información, el tipo de acceso y el tipo de solicitud:</span><span class="sxs-lookup"><span data-stu-id="39cf1-211">The row key identifies the type of information that is stored in the row and this is composed of two pieces of information, the access type, and the request type:</span></span>

* <span data-ttu-id="39cf1-212">El tipo de acceso es user o system, donde user hace referencia a todas las solicitudes de usuario al servicio de almacenamiento y system hace referencia a las solicitudes realizadas por el Análisis de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-212">The access type is either user or system, where user refers to all user requests to the storage service, and system refers to requests made by Storage Analytics.</span></span>
* <span data-ttu-id="39cf1-213">El tipo de solicitud es all en cuyo caso es una línea de resumen, o identifica una API específica como QueryEntity o UpdateEntity.</span><span class="sxs-lookup"><span data-stu-id="39cf1-213">The request type is either all in which case it is a summary line, or it identifies the specific API such as QueryEntity or UpdateEntity.</span></span>

<span data-ttu-id="39cf1-214">Los datos de ejemplo anteriores muestran todos los registros para un único minuto (que empieza el a las 11:00 AM), por lo que el número de solicitudes QueryEntities más el número de solicitudes QueryEntity más el número de solicitudes UpdateEntity suman siete, que es el total que se muestra en la fila user:All.</span><span class="sxs-lookup"><span data-stu-id="39cf1-214">The sample data above shows all the records for a single minute (starting at 11:00AM), so the number of QueryEntities requests plus the number of QueryEntity requests plus the number of UpdateEntity requests add up to seven, which is the total shown on the user:All row.</span></span> <span data-ttu-id="39cf1-215">De forma similar, puede derivar la latencia promedio de un extremo a otro 104,4286 en la fila user:All con el cálculo ((143,8 * 5) + 3 + 9)/7.</span><span class="sxs-lookup"><span data-stu-id="39cf1-215">Similarly, you can derive the average end-to-end latency 104.4286 on the user:All row by calculating ((143.8 * 5) + 3 + 9)/7.</span></span>

<span data-ttu-id="39cf1-216">Debe considerar la posibilidad de configurar alertas en la página “Supervisar” del Portal de Azure clásico, para que las Métricas de almacenamiento puedan notificarle automáticamente cualquier cambio importante en el comportamiento de sus servicios de almacenamiento. Si usa una herramienta de exploración de almacenamiento para descargar estos datos de métricas en un formato delimitado, puede usar Microsoft Excel para analizar los datos.</span><span class="sxs-lookup"><span data-stu-id="39cf1-216">You should consider setting up alerts in the Azure Classic Portal on the Monitor page so that Storage Metrics can automatically notify you of any important changes in the behavior of your storage services.If you use a storage explorer tool to download this metrics data in a delimited format, you can use Microsoft Excel to analyze the data.</span></span> <span data-ttu-id="39cf1-217">Consulte la publicación sobre los [Exploradores de Microsoft Azure Storage](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) que encontrará en el blog para conseguir una lista de herramientas de exploradores de almacenamiento disponibles.</span><span class="sxs-lookup"><span data-stu-id="39cf1-217">See the blog post [Microsoft Azure Storage Explorers](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/03/11/windows-azure-storage-explorers-2014.aspx) for a list of available storage explorer tools.</span></span>

## <a name="accessing-metrics-data-programmatically"></a><span data-ttu-id="39cf1-218">Acceso a los datos de métricas mediante programación</span><span class="sxs-lookup"><span data-stu-id="39cf1-218">Accessing metrics data programmatically</span></span>
<span data-ttu-id="39cf1-219">El listado siguiente muestra código C# de ejemplo que accede a las métricas por minuto para un intervalo de minutos y muestra los resultados en una ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="39cf1-219">The following listing shows sample C# code that accesses the minute metrics for a range of minutes and displays the results in a console Window.</span></span> <span data-ttu-id="39cf1-220">Usa Azure Storage Library versión 4 que incluye la clase CloudAnalyticsClient que simplifica el acceso a las tablas de métricas en almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="39cf1-220">It uses the Azure Storage Library version 4 that includes the CloudAnalyticsClient class that simplifies accessing the metrics tables in storage.</span></span>

```csharp
private static void PrintMinuteMetrics(CloudAnalyticsClient analyticsClient, DateTimeOffset startDateTime, DateTimeOffset endDateTime)
{
    // Convert the dates to the format used in the PartitionKey
    var start = startDateTime.ToUniversalTime().ToString("yyyyMMdd'T'HHmm");
    var end = endDateTime.ToUniversalTime().ToString("yyyyMMdd'T'HHmm");

    var services = Enum.GetValues(typeof(StorageService));
    foreach (StorageService service in services)
    {
        Console.WriteLine("Minute Metrics for Service {0} from {1} to {2} UTC", service, start, end);
        var metricsQuery = analyticsClient.CreateMinuteMetricsQuery(service, StorageLocation.Primary);
        var t = analyticsClient.GetMinuteMetricsTable(service);
        var opContext = new OperationContext();
        var query =
          from entity in metricsQuery
          // Note, you can't filter using the entity properties Time, AccessType, or TransactionType
          // because they are calculated fields in the MetricsEntity class.
          // The PartitionKey identifies the DataTime of the metrics.
          where entity.PartitionKey.CompareTo(start) >= 0 && entity.PartitionKey.CompareTo(end) <= 0 
        select entity;

        // Filter on "user" transactions after fetching the metrics from Table Storage.
        // (StartsWith is not supported using LINQ with Azure table storage)
        var results = query.ToList().Where(m => m.RowKey.StartsWith("user"));
        var resultString = results.Aggregate(new StringBuilder(), (builder, metrics) => builder.AppendLine(MetricsString(metrics, opContext))).ToString();
        Console.WriteLine(resultString);
    }
}

private static string MetricsString(MetricsEntity entity, OperationContext opContext)
{
    var entityProperties = entity.WriteEntity(opContext);
    var entityString =
    string.Format("Time: {0}, ", entity.Time) +
    string.Format("AccessType: {0}, ", entity.AccessType) +
    string.Format("TransactionType: {0}, ", entity.TransactionType) +
    string.Join(",", entityProperties.Select(e => new KeyValuePair<string, string>(e.Key.ToString(), e.Value.PropertyAsObject.ToString())));
    return entityString;
}
```

## <a name="what-charges-do-you-incur-when-you-enable-storage-metrics"></a><span data-ttu-id="39cf1-221">¿Qué se le facturará cuando habilite las métricas de almacenamiento?</span><span class="sxs-lookup"><span data-stu-id="39cf1-221">What charges do you incur when you enable storage metrics?</span></span>
<span data-ttu-id="39cf1-222">Las solicitudes por escrito para crear entidades de tabla para métricas se cobran con las tarifas estándar aplicables a todas las operaciones de Almacenamiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="39cf1-222">Write requests to create table entities for metrics are charged at the standard rates applicable to all Azure Storage operations.</span></span>

<span data-ttu-id="39cf1-223">La lectura y eliminación de solicitudes por un cliente para datos de métricas también se facturan con las tarifas estándar.</span><span class="sxs-lookup"><span data-stu-id="39cf1-223">Read and delete requests by a client to metrics data are also billable at standard rates.</span></span> <span data-ttu-id="39cf1-224">Si ha configurado una directiva de retención de datos, no se le cobrará cuando Almacenamiento de Azure elimine datos de métricas antiguos.</span><span class="sxs-lookup"><span data-stu-id="39cf1-224">If you have configured a data retention policy, you are not charged when Azure Storage deletes old metrics data.</span></span> <span data-ttu-id="39cf1-225">Sin embargo, si elimina datos de análisis, se cobrará a su cuenta las operaciones de eliminación.</span><span class="sxs-lookup"><span data-stu-id="39cf1-225">However, if you delete analytics data, your account is charged for the delete operations.</span></span>

<span data-ttu-id="39cf1-226">La capacidad de las tablas de métricas también es facturable: puede usar las opciones siguientes para calcular la cantidad de capacidad usada para almacenar datos de métricas:</span><span class="sxs-lookup"><span data-stu-id="39cf1-226">The capacity used by the metrics tables is also billable: you can use the following to estimate the amount of capacity used for storing metrics data:</span></span>

* <span data-ttu-id="39cf1-227">Si cada hora un servicio utiliza todas las API en todos los servicios, se almacenan aproximadamente 148 KB de datos cada hora en las tablas de transacciones de métricas si se ha habilitado tanto el resumen de nivel servicio como de nivel de API.</span><span class="sxs-lookup"><span data-stu-id="39cf1-227">If each hour a service utilizes every API in every service, then approximately 148KB of data is stored every hour in the metrics transaction tables if you have enabled both service and API level summary.</span></span>
* <span data-ttu-id="39cf1-228">Si cada hora un servicio utiliza todas las API en todos los servicios, se almacenan aproximadamente 12 KB de datos cada hora en las tablas de transacciones de métricas si ha habilitado solo el resumen de nivel de servicio.</span><span class="sxs-lookup"><span data-stu-id="39cf1-228">If each hour a service utilizes every API in every service, then approximately 12KB of data is stored every hour in the metrics transaction tables if you have enabled just service level summary.</span></span>
* <span data-ttu-id="39cf1-229">Se agregan dos filas cada día a la tabla de capacidad para blobs (siempre que el usuario haya optado por los registros): esto implica que todos los días el tamaño de la tabla aumenta en unos 300 bytes, aproximadamente.</span><span class="sxs-lookup"><span data-stu-id="39cf1-229">The capacity table for blobs has two rows added each day (provided user has opted in for logs): this implies that every day the size of this table increases by up to approximately 300 bytes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="39cf1-230">Pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="39cf1-230">Next steps:</span></span>
[<span data-ttu-id="39cf1-231">Habilitar el registro del Análisis de almacenamiento y acceder a los datos del mismo</span><span class="sxs-lookup"><span data-stu-id="39cf1-231">Enabling Storage Analytics Logging and Accessing Log Data</span></span>](https://msdn.microsoft.com/library/dn782840.aspx)
