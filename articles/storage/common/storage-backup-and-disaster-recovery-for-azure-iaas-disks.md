---
title: "aaaBackup y recuperación ante desastres para los discos de Azure IaaS | Documentos de Microsoft"
description: "En este artículo, explicaremos cómo tooplan copia de seguridad y recuperación ante desastres (DR) de las máquinas virtuales de IaaS (VM) y discos de Azure. En este documento se tratan los discos administrados y no administrados."
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 49b0e7732d6df9407e1e44d9af2500c99a85b37e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="e0469-104">Copia de seguridad y recuperación ante desastres para discos IaaS de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="e0469-105">En este artículo, explicaremos cómo tooplan copia de seguridad y recuperación ante desastres (DR) de las máquinas virtuales de IaaS (VM) y discos de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="e0469-106">En este documento se tratan los discos administrados y los no administrados.</span><span class="sxs-lookup"><span data-stu-id="e0469-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="e0469-107">En primer lugar hablaremos sobre Hola errores integrada capacidades de tolerancia en hello plataforma Windows Azure que ayudan a protegerse contra errores locales.</span><span class="sxs-lookup"><span data-stu-id="e0469-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="e0469-108">A continuación, trataremos los escenarios de desastres de hello completamente cubiertos por las capacidades integradas de hello, que es el tema principal de hello mencionado en este documento.</span><span class="sxs-lookup"><span data-stu-id="e0469-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="e0469-109">También se muestran varios ejemplos de escenarios de carga de trabajo a los que se pueden aplicar distintas consideraciones sobre copia de seguridad y recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="e0469-110">Luego se revisan las posibles soluciones para la recuperación ante desastres de discos IaaS.</span><span class="sxs-lookup"><span data-stu-id="e0469-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="e0469-111">Introducción</span><span class="sxs-lookup"><span data-stu-id="e0469-111">Introduction</span></span>

<span data-ttu-id="e0469-112">Hola plataforma Windows Azure usa distintos métodos para obtener redundancia y toohelp de tolerancia a errores proteger a clientes frente a errores de hardware localizados que se pueden producir.</span><span class="sxs-lookup"><span data-stu-id="e0469-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="e0469-113">Errores locales pueden incluir problemas con un equipo de servidor de almacenamiento de Azure que almacena los errores de un SSD o HDD o parte de los datos de hello para el disco virtual en ese servidor.</span><span class="sxs-lookup"><span data-stu-id="e0469-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="e0469-114">Tales errores del componente de hardware aislados pueden producirse durante las operaciones normales y plataforma de hello es toobe diseñada toothese resistente errores.</span><span class="sxs-lookup"><span data-stu-id="e0469-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="e0469-115">Los desastres de gran envergadura pueden producir errores o inaccesibilidad de un gran número de servidores de almacenamiento o de un centro de datos completo.</span><span class="sxs-lookup"><span data-stu-id="e0469-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="e0469-116">Mientras las máquinas virtuales y discos normalmente están protegidos de errores localizados, pasos adicionales son necesario tooprotect la carga de trabajo de errores catastróficos toda la región (por ejemplo, un desastre importante) que pueden afectar a la máquina virtual y los discos.</span><span class="sxs-lookup"><span data-stu-id="e0469-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="e0469-117">Además toohello posibilidad de errores de plataforma, pueden producirse problemas con la aplicación de cliente de Hola o sus datos.</span><span class="sxs-lookup"><span data-stu-id="e0469-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="e0469-118">Por ejemplo, una nueva versión de la aplicación puede accidentalmente cambiar una separación de datos toohello.</span><span class="sxs-lookup"><span data-stu-id="e0469-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="e0469-119">En ese caso, puede que desee toorevert aplicación de Hola y Hola datos tooa versión anterior que lo contiene Hola último estado bueno conocido.</span><span class="sxs-lookup"><span data-stu-id="e0469-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="e0469-120">Para ello, es necesario haber realizado copias de seguridad periódicas.</span><span class="sxs-lookup"><span data-stu-id="e0469-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="e0469-121">Recuperación ante desastres regionales, deben realizar backup su región diferente de IaaS VM discos tooa.</span><span class="sxs-lookup"><span data-stu-id="e0469-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="e0469-122">Antes de examinar las opciones de copia de seguridad y recuperación ante desastres, repasemos algunos métodos disponibles para controlar errores localizados.</span><span class="sxs-lookup"><span data-stu-id="e0469-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="e0469-123">Resistencia de IaaS de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="e0469-124">*Resistencia* hace referencia toohello tolerancia a errores normales que se producen en los componentes de hardware.</span><span class="sxs-lookup"><span data-stu-id="e0469-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="e0469-125">Resistencia es Hola capacidad toorecover de errores y continuar toofunction.</span><span class="sxs-lookup"><span data-stu-id="e0469-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="e0469-126">No es acerca de cómo evitar los errores, pero responde toofailures de forma que se evita perder el tiempo de inactividad o datos.</span><span class="sxs-lookup"><span data-stu-id="e0469-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="e0469-127">objetivo de Hola de resistencia es tooreturn hello tooa totalmente operativa estado de la aplicación después de un error.</span><span class="sxs-lookup"><span data-stu-id="e0469-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="e0469-128">Máquinas virtuales y discos de Azure están diseñadas toobe toocommon resistente los errores de hardware.</span><span class="sxs-lookup"><span data-stu-id="e0469-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="e0469-129">Echemos un vistazo a la plataforma de IaaS de Azure de hello proporciona esta resistencia.</span><span class="sxs-lookup"><span data-stu-id="e0469-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="e0469-130">Una máquina virtual está compuesta principalmente de dos partes: (1) un proceso servidor y discos persistentes (2) Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="e0469-131">Ambos afectan a la tolerancia a errores Hola de una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="e0469-132">Si el servidor de host de proceso de Azure de Hola que aloja la máquina virtual experimenta un error de hardware (que es poco frecuente), Azure es tooautomatically diseñada restauración Hola VM en otro servidor.</span><span class="sxs-lookup"><span data-stu-id="e0469-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="e0469-133">Si esto ocurre, experimentarán un reinicio y Hola VM será una copia de seguridad más tarde.</span><span class="sxs-lookup"><span data-stu-id="e0469-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="e0469-134">Azure detecta automáticamente estos errores de hardware y los ejecuta recuperaciones toohelp garantizan cliente hello VM estará disponible tan pronto como sea posible.</span><span class="sxs-lookup"><span data-stu-id="e0469-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="e0469-135">Relacionada con los discos de IaaS, la durabilidad de los datos es fundamental para la plataforma de almacenamiento persistente de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="e0469-136">Los clientes de Azure tienen aplicaciones empresariales importantes que se ejecutan en IaaS y dependen de la persistencia de Hola de los datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="e0469-137">Azure diseña la protección de estos discos IaaS con tres copias redundantes de datos almacenados localmente, lo que ofrece gran durabilidad contra errores locales.</span><span class="sxs-lookup"><span data-stu-id="e0469-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="e0469-138">Si se produce un error en uno de los componentes de hardware de Hola que contiene el disco, la máquina virtual no se ve afectada porque hay dos copias adicionales toosupport disco solicitudes.</span><span class="sxs-lookup"><span data-stu-id="e0469-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="e0469-139">Funciona bien incluso si hay errores de dos componentes de hardware diferente que admiten un disco en hello mismo tiempo (lo que sería muy poco frecuente).</span><span class="sxs-lookup"><span data-stu-id="e0469-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="e0469-140">Asegúrese de toohelp siempre se mantienen tres réplicas, servicio de almacenamiento de Azure Hola genera automáticamente una nueva copia de datos en segundo plano de hello si uno de tres copias de hello deja de estar disponible.</span><span class="sxs-lookup"><span data-stu-id="e0469-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="e0469-141">Por lo tanto, no debe ser necesario toouse RAID con discos de Azure para tolerancia a errores.</span><span class="sxs-lookup"><span data-stu-id="e0469-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="e0469-142">RAID 0 simple configuración debería ser suficiente para la creación de bandas discos Hola si es necesario toocreate mayores volúmenes.</span><span class="sxs-lookup"><span data-stu-id="e0469-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="e0469-143">Gracias a esta arquitectura, **Azure ha ofrecido de manera constante durabilidad de nivel empresarial para discos IaaS, con una [tasa de error anualizada del 0 %](https://en.wikipedia.org/wiki/Annualized_failure_rate)**.</span><span class="sxs-lookup"><span data-stu-id="e0469-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="e0469-144">Errores de hardware localizados en Hola de proceso de host o en almacenamiento de hello plataforma a veces puede producir en indisponibilidad temporal para la máquina virtual que está cubierto por Hola Hola [SLA de Azure](https://azure.microsoft.com/support/legal/sla/virtual-machines/) para la disponibilidad de la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="e0469-145">Azure ofrece también un Acuerdo de Nivel de Servicio líder del sector para instancias únicas de máquina virtual que usan discos de Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="e0469-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="e0469-146">cargas de trabajo de aplicación de toosafeguard de tiempo de inactividad debido toohello indisponibilidad temporal de un disco o una máquina virtual, los clientes pueden aprovechar [conjuntos de disponibilidad](../../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="e0469-147">Dos o más máquinas virtuales en un conjunto de disponibilidad proporciona redundancia de la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="e0469-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="e0469-148">Azure luego crea estas máquinas virtuales y discos en dominios de error independientes con distintos componentes de alimentación, red y servidor.</span><span class="sxs-lookup"><span data-stu-id="e0469-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="e0469-149">Por lo tanto, los errores de hardware localizados normalmente no afectan a varias máquinas virtuales en hello establecido en hello mismo tiempo, proporcionar alta disponibilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e0469-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="e0469-150">Se considera que una disponibilidad de toouse recomendable establece cuando se necesita una alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="e0469-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="e0469-151">Para obtener más información, consulte aspectos de recuperación ante desastres de hello descritos a continuación.</span><span class="sxs-lookup"><span data-stu-id="e0469-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="e0469-152">Copia de seguridad y recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="e0469-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="e0469-153">Recuperación ante desastres (DR) es Hola capacidad toorecover de incidentes importantes pero poco frecuentes: errores no transitorios y de gran escala, como la interrupción del servicio que afecta a toda una región.</span><span class="sxs-lookup"><span data-stu-id="e0469-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="e0469-154">La recuperación ante desastres incluye la copia de seguridad y el archivado de datos, y puede incluir la intervención manual, como la restauración manual de una base de datos a partir de la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="e0469-155">Hello protección integrada de la plataforma de Azure frente a errores localizadas puede no proteger completamente Hola máquinas virtuales/discos en caso de hello de casos de desastres importantes que pueden provocar interrupciones a gran escala.</span><span class="sxs-lookup"><span data-stu-id="e0469-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="e0469-156">Esto incluye eventos catastróficos tales como que un centro de datos se vea afectado por un huracán, terremoto, incendio o errores de unidades de hardware a gran escala.</span><span class="sxs-lookup"><span data-stu-id="e0469-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="e0469-157">Además, se pueden producir errores debido a problemas de tooapplication o de datos.</span><span class="sxs-lookup"><span data-stu-id="e0469-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="e0469-158">toohelp proteger las cargas de trabajo de IaaS de interrupciones, debe planear para la recuperación de tooenable de redundancia y copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="e0469-159">Recuperación ante desastres, debe planear la redundancia y la copia de seguridad en una ubicación geográfica distinta fuera de sitio primario de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="e0469-160">Esto ayuda a garantizar la copia de seguridad no se ve afectada por hello mismo evento que originalmente afectados Hola máquinas virtuales o discos.</span><span class="sxs-lookup"><span data-stu-id="e0469-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="e0469-161">Para más información, vea [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications) (Recuperación ante desastres para aplicaciones generadas en Azure).</span><span class="sxs-lookup"><span data-stu-id="e0469-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="e0469-162">Las consideraciones de recuperación ante desastres pueden incluir Hola siguientes aspectos:</span><span class="sxs-lookup"><span data-stu-id="e0469-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="e0469-163">Alta disponibilidad (HA) es la capacidad de Hola de hello aplicación toocontinue ejecutando en un estado correcto, sin tiempo de inactividad considerable.</span><span class="sxs-lookup"><span data-stu-id="e0469-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="e0469-164">Por "estado correcto," se entiende la aplicación hello tiene capacidad de respuesta, y los usuarios pueden conectar toohello aplicación e interactuar con él.</span><span class="sxs-lookup"><span data-stu-id="e0469-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="e0469-165">Ciertas aplicaciones de misión crítica y las bases de datos pueden ser necesario toobe disponible siempre, incluso si existen errores en la plataforma de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="e0469-166">Estas cargas de trabajo, puede que necesite tooplan redundancia para la aplicación hello, así como datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="e0469-167">Durabilidad de los datos: En algunos casos, consideración principal hello es garantizar que se conservan los datos de hello en caso de hello de un desastre.</span><span class="sxs-lookup"><span data-stu-id="e0469-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="e0469-168">Por consiguiente, puede que tenga que realizar una copia de seguridad de los datos en otro sitio.</span><span class="sxs-lookup"><span data-stu-id="e0469-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="e0469-169">Estas cargas de trabajo, no es necesario una redundancia completa para la aplicación hello, pero una copia de seguridad periódica de los discos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="e0469-170">Escenarios de copia de seguridad y recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="e0469-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="e0469-171">Veamos algunos ejemplos típicos de los escenarios de carga de trabajo de aplicaciones y consideraciones de Hola para planear la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="e0469-172">Escenario 1: Soluciones de bases de datos principales</span><span class="sxs-lookup"><span data-stu-id="e0469-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="e0469-173">Considere la posibilidad de usar un servidor de base de datos de producción, como SQL Server u Oracle, que pueda admitir alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="e0469-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="e0469-174">Los usuarios y las aplicaciones de producción críticas dependen de esta base de datos.</span><span class="sxs-lookup"><span data-stu-id="e0469-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="e0469-175">plan de recuperación ante desastres de Hola para este sistema necesite hello toosupport según los requisitos:</span><span class="sxs-lookup"><span data-stu-id="e0469-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="e0469-176">Los datos deben estar protegidos y ser recuperables.</span><span class="sxs-lookup"><span data-stu-id="e0469-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="e0469-177">El servidor debe estar disponible para su uso.</span><span class="sxs-lookup"><span data-stu-id="e0469-177">Server must be available for use.</span></span>

<span data-ttu-id="e0469-178">Esto puede requerir el mantenimiento de una réplica de base de datos de hello en una región distinta como una copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="e0469-179">Dependiendo de los requisitos de Hola para disponibilidad del servidor y la recuperación de datos, solución de hello puede abarcar desde un activo / activo o activo / pasivo réplica sitio tooperiodic sin conexión las copias de seguridad de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="e0469-180">Las bases de datos relacionales, como SQL Server y Oracle, ofrecen varias opciones de replicación.</span><span class="sxs-lookup"><span data-stu-id="e0469-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="e0469-181">Con SQL Server, se pueden usar [grupos de disponibilidad Always On de SQL Server](https://msdn.microsoft.com/library/hh510230.aspx) para alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="e0469-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="e0469-182">Las bases de datos NoSQL, como MongoDB, también admiten [réplicas](https://docs.mongodb.com/manual/replication/) para conseguir redundancia.</span><span class="sxs-lookup"><span data-stu-id="e0469-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="e0469-183">se pueden utilizar réplicas de Hola para lograr alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="e0469-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="e0469-184">Escenario 2: Un clúster de máquinas virtuales redundantes</span><span class="sxs-lookup"><span data-stu-id="e0469-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="e0469-185">Considere la posibilidad de una carga de trabajo controlada por un clúster de máquinas virtuales que proporcionan redundancia y equilibrio de carga.</span><span class="sxs-lookup"><span data-stu-id="e0469-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="e0469-186">Un ejemplo sería un clúster Cassandra implementado en una región.</span><span class="sxs-lookup"><span data-stu-id="e0469-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="e0469-187">Este tipo de arquitectura ya proporciona un alto nivel de redundancia en esa región.</span><span class="sxs-lookup"><span data-stu-id="e0469-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="e0469-188">Sin embargo, carga de trabajo de hello tooprotect tras un error de nivel regional, debería considerar propagándose clúster hello en dos regiones o realizar región tooanother de copias de seguridad periódicas.</span><span class="sxs-lookup"><span data-stu-id="e0469-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="e0469-189">Escenario 3: Carga de trabajo de la aplicación IaaS</span><span class="sxs-lookup"><span data-stu-id="e0469-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="e0469-190">Podría tratarse de una carga de trabajo de producción típica que se ejecuta en una máquina virtual de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="e0469-191">Por ejemplo, podría ser un servidor web o servidor de archivos que contiene el contenido de Hola y otros recursos de un sitio.</span><span class="sxs-lookup"><span data-stu-id="e0469-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="e0469-192">También podría ser una aplicación de negocio personalizadas ejecutando en una máquina virtual que almacena sus datos, los recursos y estado de la aplicación en discos de máquina virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="e0469-193">En este caso, es importante toomake seguro que realizar copias de seguridad de forma regular.</span><span class="sxs-lookup"><span data-stu-id="e0469-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="e0469-194">Frecuencia de copia de seguridad debe basarse en la naturaleza de Hola de carga de trabajo de máquina virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="e0469-195">Por ejemplo, si la aplicación hello ejecuta cada día y modifica los datos, a continuación, Hola realizó copia de seguridad debe ser cada hora.</span><span class="sxs-lookup"><span data-stu-id="e0469-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="e0469-196">Otro ejemplo es un servidor de informes que extrae datos de otros orígenes y genera informes agregados.</span><span class="sxs-lookup"><span data-stu-id="e0469-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="e0469-197">Pérdida de esta máquina virtual o discos dará lugar a pérdida de toohello de informes de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="e0469-198">Sin embargo, es posible hello toorerun posible informar de proceso y la salida de hello regenerar.</span><span class="sxs-lookup"><span data-stu-id="e0469-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="e0469-199">En ese caso, realmente no tiene una pérdida de datos, incluso si el servidor de informes de Hola se visita con un desastre, por lo que podría tener un nivel más alto de tolerancia de pérdida de parte de los datos de hello en hello servidor de informes.</span><span class="sxs-lookup"><span data-stu-id="e0469-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="e0469-200">En ese caso, las copias de seguridad menos frecuentes es un costo de opción tooreduce Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="e0469-201">Escenario 4: Problemas de datos de la aplicación IaaS</span><span class="sxs-lookup"><span data-stu-id="e0469-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="e0469-202">Tiene una aplicación que calcula, mantiene y sirve de datos comerciales críticos, como información sobre los precios.</span><span class="sxs-lookup"><span data-stu-id="e0469-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="e0469-203">Una nueva versión de la aplicación tenía un error de software que incorrectamente calcula el precio de Hola y Hola existente comercio datos atendidos por plataforma de hello erróneos.</span><span class="sxs-lookup"><span data-stu-id="e0469-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="e0469-204">En este caso, sería Hola hacer a continuación a toorevert toohello versión anterior de la aplicación hello y datos de hello primero.</span><span class="sxs-lookup"><span data-stu-id="e0469-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="e0469-205">tooenable, realice copias de seguridad periódicas del sistema.</span><span class="sxs-lookup"><span data-stu-id="e0469-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="e0469-206">Solución de recuperación ante desastres: servicio Azure Backup</span><span class="sxs-lookup"><span data-stu-id="e0469-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="e0469-207">El [servicio Azure Backup](https://azure.microsoft.com/services/backup/) puede usarse para copia de seguridad y recuperación ante desastres y funciona tanto con [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) como con [discos no administrados](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="e0469-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) as well as [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span></span> <span data-ttu-id="e0469-208">Puede crear un trabajo de copia de seguridad con copias de seguridad basadas en tiempo, fácil restauración de la máquina virtual y directivas de retención de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="e0469-209">Si usa [discos de almacenamiento Premium](storage-premium-storage.md), [discos administrados](../../virtual-machines/windows/managed-disks-overview.md), u otros tipos de disco con hello [almacenamiento localmente redundante (LRS)](storage-redundancy.md#locally-redundant-storage) opción, es especialmente importante tooleverage copias de seguridad periódicas de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="e0469-210">Copia de seguridad de Azure almacena los datos de hello en el almacén de servicios de recuperación para la retención a largo plazo.</span><span class="sxs-lookup"><span data-stu-id="e0469-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="e0469-211">Elija hello [almacenamiento con redundancia geográfica (GRS)](storage-redundancy.md#geo-redundant-storage) opción de almacén de servicios de recuperación de copia de seguridad de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="e0469-212">Eso garantizará que las copias de seguridad son replicados tooa una región distinta de Azure para proteger contra desastres regionales.</span><span class="sxs-lookup"><span data-stu-id="e0469-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="e0469-213">Para [discos no administrado](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), puede usar tipo de almacenamiento LRS Hola para discos de IaaS, pero asegúrese de que está habilitada la copia de seguridad de Azure con hello opción GRS de hello almacén de servicios de recuperación.</span><span class="sxs-lookup"><span data-stu-id="e0469-213">For [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="e0469-214">**Si usas hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) opción para los discos no administrado, sigue siendo necesario instantáneas coherentes con la copia de seguridad y recuperación ante desastres.**</span><span class="sxs-lookup"><span data-stu-id="e0469-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="e0469-215">Se debe usar el [servicio Azure Backup ](https://azure.microsoft.com/services/backup/) o [instantáneas coherentes](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="e0469-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="e0469-216">Hola aquí te mostramos un resumen de las soluciones de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="e0469-217">Escenario</span><span class="sxs-lookup"><span data-stu-id="e0469-217">Scenario</span></span> | <span data-ttu-id="e0469-218">Replicación automática</span><span class="sxs-lookup"><span data-stu-id="e0469-218">Automatic Replication</span></span> | <span data-ttu-id="e0469-219">Solución de recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="e0469-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e0469-220">*Discos de Premium Storage*</span><span class="sxs-lookup"><span data-stu-id="e0469-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="e0469-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e0469-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="e0469-222">Copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="e0469-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="e0469-223">*Managed Disks*</span></span> | <span data-ttu-id="e0469-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e0469-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="e0469-225">Copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="e0469-226">*Discos LRS no administrados*</span><span class="sxs-lookup"><span data-stu-id="e0469-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="e0469-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e0469-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="e0469-228">Copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="e0469-229">*Discos GRS no administrados*</span><span class="sxs-lookup"><span data-stu-id="e0469-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="e0469-230">Entre regiones ([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e0469-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="e0469-231">Copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="e0469-232">Instantáneas coherentes</span><span class="sxs-lookup"><span data-stu-id="e0469-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="e0469-233">*Discos RA-GRS no administrados*</span><span class="sxs-lookup"><span data-stu-id="e0469-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="e0469-234">Entre regiones ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e0469-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="e0469-235">Copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="e0469-236">Instantáneas coherentes</span><span class="sxs-lookup"><span data-stu-id="e0469-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="e0469-237">Alta disponibilidad por puede satisfacen mejor mediante el uso de Hola de discos administrado en un conjunto de disponibilidad junto con la copia de seguridad de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="e0469-238">Si usa discos no administrados, todavía puede usar Azure Backup con recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="e0469-239">Si es que no se puede toouse copia de seguridad de Azure, a continuación, tomar [las instantáneas coherentes con](#alternative-solution-consistent-snapshots) tal y como se describe en una sección posterior es una solución alternativa para la copia de seguridad y recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="e0469-240">Las opciones de alta disponibilidad, copia de seguridad y recuperación ante desastres en los niveles de aplicación o de infraestructura se pueden representar como sigue:</span><span class="sxs-lookup"><span data-stu-id="e0469-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="e0469-241">*Level*</span><span class="sxs-lookup"><span data-stu-id="e0469-241">*Level*</span></span> | <span data-ttu-id="e0469-242">Alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="e0469-242">High Availability</span></span>   | <span data-ttu-id="e0469-243">Copia de seguridad y recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="e0469-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e0469-244">*Aplicación*</span><span class="sxs-lookup"><span data-stu-id="e0469-244">*Application*</span></span> | <span data-ttu-id="e0469-245">Always On de SQL</span><span class="sxs-lookup"><span data-stu-id="e0469-245">SQL Always On</span></span> | <span data-ttu-id="e0469-246">Copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-246">Azure Backup</span></span> |
| <span data-ttu-id="e0469-247">*Infraestructura*</span><span class="sxs-lookup"><span data-stu-id="e0469-247">*Infrastructure*</span></span>  | <span data-ttu-id="e0469-248">Conjunto de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="e0469-248">Availability Set</span></span>  | <span data-ttu-id="e0469-249">GRS con instantáneas coherentes</span><span class="sxs-lookup"><span data-stu-id="e0469-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="e0469-250">Uso de hello servicio de copia de seguridad de Azure</span><span class="sxs-lookup"><span data-stu-id="e0469-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="e0469-251">[Copia de seguridad de Azure](../../backup/backup-azure-vms-introduction.md) hacer una copia de las máquinas virtuales que ejecutan Windows o Linux toohello almacén de servicios de recuperación de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="e0469-252">Copias de seguridad y restaurar los datos críticos para la empresa se ve complicado por hecho de Hola que deben hacer copia los datos empresariales críticos mientras las aplicaciones de Hola que generan Hola ejecutan datos.</span><span class="sxs-lookup"><span data-stu-id="e0469-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="e0469-253">tooaddress, copia de seguridad de Azure proporciona copias de seguridad coherentes con la aplicación para las cargas de trabajo de Microsoft mediante hello tooensure de servicio de instantáneas de volumen (VSS) que se escriben correctamente datos toostorage.</span><span class="sxs-lookup"><span data-stu-id="e0469-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="e0469-254">Para máquinas virtuales de Linux, solo las copias de seguridad coherentes para el archivo son posibles, como Linux no tiene funcionalidad equivalente tooVSS.</span><span class="sxs-lookup"><span data-stu-id="e0469-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png)   

<span data-ttu-id="e0469-255">Si copia de seguridad de Azure inicia un trabajo de copia de seguridad en tiempo de hello programado, desencadena extensión de copia de seguridad de hello instalada en hello VM tootake una instantánea en un momento.</span><span class="sxs-lookup"><span data-stu-id="e0469-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="e0469-256">Se toma una instantánea en coordinación con VSS tooget una instantánea coherente de los discos de hello en la máquina virtual de hello sin necesidad de tooshut lo hacia abajo.</span><span class="sxs-lookup"><span data-stu-id="e0469-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="e0469-257">extensión de copia de seguridad de Hola Hola VM vacía todas las escrituras antes de realizar instantáneas coherentes de Hola de todos los discos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="e0469-258">Después de tomar instantáneas de hello, datos de Hola se transfieren por el almacén de copia de seguridad de toohello de copia de seguridad de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="e0469-259">toomake Hola copia de seguridad proceso más eficaz, servicio de hello identifica y transfiere únicamente los bloques de datos que han cambiado desde la última copia de seguridad de Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="e0469-260">toorestore, puede ver copias de seguridad disponibles de Hola a través de la copia de seguridad de Azure y, a continuación, iniciar una restauración.</span><span class="sxs-lookup"><span data-stu-id="e0469-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="e0469-261">Puede crear y restaurar copias de seguridad de Azure a través de hello [portal de Azure](https://portal.azure.com/), [con PowerShell](../../backup/backup-azure-vms-automation.md ), o mediante hello [CLI de Azure](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="e0469-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="e0469-262">Para más información, vea Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="e0469-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="e0469-263">Pasos tooEnable copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="e0469-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="e0469-264">Hello es seguir estos pasos tooenable normalmente se usan las copias de seguridad de las máquinas virtuales con hello [Portal de Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="e0469-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="e0469-265">Habrá algunas variaciones según el escenario exacto.</span><span class="sxs-lookup"><span data-stu-id="e0469-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="e0469-266">Consulte toohello [copia de seguridad de Azure](../../backup/backup-azure-vms-introduction.md) documentación para obtener detalles completos.</span><span class="sxs-lookup"><span data-stu-id="e0469-266">Refer toohello [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="e0469-267">Azure Backup también [admite máquinas virtuales con Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="e0469-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="e0469-268">Crear un almacén de servicios de recuperación para una máquina virtual mediante Hola pasos:</span><span class="sxs-lookup"><span data-stu-id="e0469-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="e0469-269">a.</span><span class="sxs-lookup"><span data-stu-id="e0469-269">a.</span></span>  <span data-ttu-id="e0469-270">Con hello [portal de Azure](https://portal.azure.com/), examinar todos los recursos y busque "Almacenes de servicios de recuperación".</span><span class="sxs-lookup"><span data-stu-id="e0469-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="e0469-271">b.</span><span class="sxs-lookup"><span data-stu-id="e0469-271">b.</span></span>  <span data-ttu-id="e0469-272">En hello servicios de recuperación de almacenes de credenciales de menú, haga clic en Agregar y siga los pasos de hello toocreate un nuevo almacén en hello misma región que Hola máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="e0469-273">Por ejemplo, si la máquina virtual está en la región del oeste de Estados Unidos, seleccionar West US para el almacén de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="e0469-274">Comprobar la replicación de almacenamiento de Hola para hello recién creado el almacén.</span><span class="sxs-lookup"><span data-stu-id="e0469-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="e0469-275">toodo este, almacén de Hola de acceso de hello servicios de recuperación almacenes hoja y vaya toohello configuración de copia de seguridad o configuración.</span><span class="sxs-lookup"><span data-stu-id="e0469-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="e0469-276">Asegúrese de hello opción GRS está activada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e0469-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="e0469-277">Esto garantizará que el almacén es automáticamente replicada tooa centro de datos secundario.</span><span class="sxs-lookup"><span data-stu-id="e0469-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="e0469-278">Por ejemplo, el almacén de la zona horaria del Pacífico occidental será automáticamente replicada tooEast Estados Unidos.</span><span class="sxs-lookup"><span data-stu-id="e0469-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="e0469-279">Configurar la directiva de copia de seguridad de Hola y seleccione Hola VM de hello misma interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="e0469-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="e0469-280">Asegúrese de hello seguro que Backup Agent está instalado en hello máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="e0469-281">Si la máquina virtual se creó mediante una imagen de la Galería de Azure, agente de copia de seguridad de hello ya está instalado.</span><span class="sxs-lookup"><span data-stu-id="e0469-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="e0469-282">En caso contrario (es decir, si está utilizando una imagen personalizada), use instrucciones demasiado[Hola instalar agente de máquina virtual en la máquina virtual de hello](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="e0469-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="e0469-283">Asegúrese de que ese Hola VM permite conectividad de red para hello toofunction de servicio de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="e0469-284">Siga estas instrucciones para la [conectividad de red](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="e0469-284">Follow these instructions for [Network connectivity](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="e0469-285">Cuando haya realizado Hola por encima de los pasos, copia de seguridad de Hola se ejecutará a intervalos regulares según se especifica en la directiva de copia de seguridad de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="e0469-286">Si es necesario, puede desencadenar la primera copia de seguridad Hola manualmente desde el panel de almacén de hello en hello portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="e0469-287">Para la automatización de Azure Backup mediante secuencias de comandos, consulte demasiado[cmdlets de PowerShell para copia de seguridad de máquina virtual](../../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="e0469-288">Pasos para la recuperación</span><span class="sxs-lookup"><span data-stu-id="e0469-288">Steps for Recovery</span></span>

<span data-ttu-id="e0469-289">Si necesita toorepair o volver a generar una máquina virtual, puede restaurar Hola VM desde cualquiera de los puntos de recuperación de copia de seguridad de hello en el almacén de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="e0469-290">Hay un par de opciones diferentes para realizar la recuperación de hello:</span><span class="sxs-lookup"><span data-stu-id="e0469-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="e0469-291">Puede crear otra máquina virtual como una representación de un momento dado de la máquina virtual de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="e0469-292">Puede restaurar Hola discos y, a continuación, usar plantilla Hola para toocustomize VM de Hola y Hola de regeneración restaura máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="e0469-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="e0469-293">Consulte las instrucciones demasiado[máquinas virtuales de Azure de uso toorestore portal](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="e0469-293">See instructions too[Use Azure portal toorestore virtual machines](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="e0469-294">documento de Hello también explica pasos específicos de Hola para restaurar una copia de seguridad las máquinas virtuales toohello emparejados data center usando el almacén de copia de seguridad con redundancia geográfica en caso de hello de un desastre en el centro de datos principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="e0469-295">En ese caso, copia de seguridad de Azure usa el servicio de proceso de saludo de la máquina virtual de hello región secundaria toocreate Hola restaurado.</span><span class="sxs-lookup"><span data-stu-id="e0469-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="e0469-296">También puede usar PowerShell para [restaurar una máquina virtual](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) o para [crear una máquina virtual a partir de discos restaurados](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="e0469-296">You can also use PowerShell for [restoring a VM](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="e0469-297">Solución alternativa: Instantáneas coherentes con la</span><span class="sxs-lookup"><span data-stu-id="e0469-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="e0469-298">Si es que no se puede toouse Hola servicio de copia de seguridad de Azure, puede implementar su propio mecanismo de copia de seguridad con las instantáneas.</span><span class="sxs-lookup"><span data-stu-id="e0469-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="e0469-299">Es complicado toocreate las instantáneas coherentes para todos los discos usados por una máquina virtual y, a continuación, replicar esos región tooanother de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="e0469-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="e0469-300">Por esta razón, Azure considera Hola aprovecha el servicio de copia de seguridad de una opción mejor que la compilación de una solución personalizada.</span><span class="sxs-lookup"><span data-stu-id="e0469-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="e0469-301">Si utiliza almacenamiento de RA, GRS y RA-GRS para los discos, las instantáneas son automáticamente replicada tooa centro de datos secundario.</span><span class="sxs-lookup"><span data-stu-id="e0469-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="e0469-302">Si utiliza almacenamiento LRS para los discos, se necesita datos de hello tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="e0469-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="e0469-303">Para más información, vea [Copias de seguridad de discos de máquinas virtuales de Azure no administrados con instantáneas incrementales](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

<span data-ttu-id="e0469-304">Una instantánea es una representación de un objeto en un momento dado.</span><span class="sxs-lookup"><span data-stu-id="e0469-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="e0469-305">Le cobrará una instantánea de facturación para el tamaño de incremental de Hola de hello datos contiene.</span><span class="sxs-lookup"><span data-stu-id="e0469-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="e0469-306">Para más información, vea [Creación de una instantánea de un blob](../blobs/storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-306">For more information, see [Create a blob snapshot](../blobs/storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="e0469-307">La creación de instantáneas al Hola VM está ejecutando</span><span class="sxs-lookup"><span data-stu-id="e0469-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="e0469-308">Mientras que puede tomar una instantánea en cualquier momento, si hello máquina virtual se está ejecutando, todavía hay datos que se transmite toohello discos y las instantáneas de hello pueden contener operaciones parciales que estaban en tránsito.</span><span class="sxs-lookup"><span data-stu-id="e0469-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="e0469-309">Además, si hay varios discos, las instantáneas de Hola de discos diferentes pueden haberse producido en momentos diferentes, lo que significa que no pueden ser coordinadas estas instantáneas.</span><span class="sxs-lookup"><span data-stu-id="e0469-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="e0469-310">Esto es especialmente problemático para los volúmenes seccionados cuyos archivos pueden resultar dañados si se realizan cambios durante la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="e0469-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="e0469-311">tooavoid esta situación, el proceso de copia de seguridad de hello debe implementar Hola siguiendo los pasos:</span><span class="sxs-lookup"><span data-stu-id="e0469-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="e0469-312">Inmovilizar todos los discos de Hola</span><span class="sxs-lookup"><span data-stu-id="e0469-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="e0469-313">Vaciar Hola todas las escrituras pendientes</span><span class="sxs-lookup"><span data-stu-id="e0469-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="e0469-314">A continuación, [crear una instantánea de blob](../blobs/storage-blob-snapshots.md) para todos los discos de Hola</span><span class="sxs-lookup"><span data-stu-id="e0469-314">Then, [create a blob snapshot](../blobs/storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="e0469-315">Algunas aplicaciones de Windows como SQL Server proporcionan un mecanismo de copia de seguridad coordinado a través de copias de seguridad VSS toocreate coherentes con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e0469-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="e0469-316">En Linux, puede usar una herramienta como fsfreeze para coordinar los discos de hello, que le proporcionará las copias de seguridad coherentes para el archivo, pero las instantáneas no coherentes con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e0469-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="e0469-317">Este proceso es complicado, por lo que debe plantarse el uso de [Azure Backup](../../backup/backup-azure-vms-introduction.md) o una solución de copia de seguridad de terceros que ya lo implementan.</span><span class="sxs-lookup"><span data-stu-id="e0469-317">This process is complicated, so and you should consider using [Azure Backup](../../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="e0469-318">Hola anteriormente proceso dará como resultado de una colección de instantáneas coordinadas de todos los discos de máquina virtual de hello, que representa una vista en un momento específica de hello VM.</span><span class="sxs-lookup"><span data-stu-id="e0469-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="e0469-319">Se trata de un punto de restauración de copia de seguridad Hola máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="e0469-320">Puede repetir el proceso de hello en copias de seguridad periódicas de los intervalos programados toocreate.</span><span class="sxs-lookup"><span data-stu-id="e0469-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="e0469-321">Vea a continuación para conocer los pasos hello[región de tooanother de las copias de seguridad de copia hello](#copy-the-snapshots-to-another-region) para recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="e0469-322">La creación de instantáneas al Hola VM está sin conexión</span><span class="sxs-lookup"><span data-stu-id="e0469-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="e0469-323">Otra opción toocreate copias de seguridad coherentes se está cerrando hello VM y blob de tomar instantáneas de cada disco.</span><span class="sxs-lookup"><span data-stu-id="e0469-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="e0469-324">Esto resulta más sencillo que coordinar instantáneas de una máquina virtual en ejecución, pero requiere algunos minutos de inactividad.</span><span class="sxs-lookup"><span data-stu-id="e0469-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="e0469-325">Para este proceso, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="e0469-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="e0469-326">Apagar VM Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="e0469-327">Cree una instantánea de cada blob de VHD, que solo tarda unos segundos.</span><span class="sxs-lookup"><span data-stu-id="e0469-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="e0469-328">toocreate una instantánea, puede usar [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [API de Rest de almacenamiento de Azure](https://msdn.microsoft.com/library/azure/ee691971.aspx), [CLI de Azure](https://docs.microsoft.com/azure/xplat-cli-install), o una de las bibliotecas de cliente de almacenamiento de Azure de hello como [ biblioteca de cliente de almacenamiento de Hola para .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="e0469-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="e0469-329">Iniciar máquina virtual, que finaliza el tiempo de inactividad de Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="e0469-330">Por lo general todo proceso de Hola se completa dentro de unos minutos.</span><span class="sxs-lookup"><span data-stu-id="e0469-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="e0469-331">Este proceso produce una colección de las instantáneas coherentes para todos los discos de hello, que proporciona un punto de restauración de copia de seguridad para hello VM.</span><span class="sxs-lookup"><span data-stu-id="e0469-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="e0469-332">Vea a continuación para región de hello pasos toocopy Hola instantáneas tooanother para recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="e0469-333">Copia Hola instantáneas tooanother región</span><span class="sxs-lookup"><span data-stu-id="e0469-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="e0469-334">Creación de instantáneas de Hola por sí sola puede no ser suficiente para la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="e0469-335">También debe replicar la región de tooanother de las copias de seguridad de instantánea de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="e0469-336">Si usas GRS o RA-GRS para los discos, las instantáneas de hello son región secundaria toohello replicada automáticamente.</span><span class="sxs-lookup"><span data-stu-id="e0469-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="e0469-337">Puede haber unos minutos de retardo antes de la réplica de hello y, si el centro de datos principal de hello deja de funcionar antes de concluir la replicación de instantáneas de hello, no será capaz de tooaccess instantáneas de Hola desde el centro de datos secundaria de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="e0469-338">probabilidad de Hola de esto es pequeña.</span><span class="sxs-lookup"><span data-stu-id="e0469-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="e0469-339">Solo tiene discos de hello en una cuenta GRS o RA-GRS no protege Hola VM de desastres.</span><span class="sxs-lookup"><span data-stu-id="e0469-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="e0469-340">También debe crear instantáneas coordinadas o usar Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="e0469-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="e0469-341">Se trata de toorecover requiere un estado coherente de tooa de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="e0469-342">Si usas LRS, debe copiar la cuenta de almacenamiento distinta de hello instantáneas tooa inmediatamente después de crear una instantánea de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="e0469-343">destino de la copia de Hello podría ser una cuenta de almacenamiento LRS en una región distinta, lo que copia Hola está en una región remota.</span><span class="sxs-lookup"><span data-stu-id="e0469-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="e0469-344">También puede copiar la cuenta de almacenamiento de hello instantánea tooan RA-GRS Hola misma región.</span><span class="sxs-lookup"><span data-stu-id="e0469-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="e0469-345">En este caso, instantánea Hola será región secundaria de forma diferida replicada toohello remoto.</span><span class="sxs-lookup"><span data-stu-id="e0469-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="e0469-346">La copia de seguridad está protegido ante desastres en el sitio primario de hello una vez completada copiar hello y la replicación.</span><span class="sxs-lookup"><span data-stu-id="e0469-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="e0469-347">toocopy sus instantáneas incrementales para recuperación ante desastres de manera eficaz, revisión las instrucciones de Hola de [copia de seguridad Azure discos de máquina virtual no administrados con instantáneas incrementales](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png)   

### <a name="recovery-from-snapshots"></a><span data-ttu-id="e0469-348">Recuperación de instantáneas</span><span class="sxs-lookup"><span data-stu-id="e0469-348">Recovery from Snapshots</span></span>

<span data-ttu-id="e0469-349">tooretrieve una instantánea, cópielo toomake un nuevo blob.</span><span class="sxs-lookup"><span data-stu-id="e0469-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="e0469-350">Si va a copiar instantáneas Hola de cuenta principal de hello, puede copiar Hola instantánea sobre toohello base blob de instantánea de hello, por lo tanto reversión Hola disco toohello instantánea; Esto se conoce como promoción de instantánea de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="e0469-351">Si va a copiar la copia de seguridad de instantánea de Hola desde una cuenta secundaria (en caso de hello de RA-GRS), debe copiar tooa de cuenta principal.</span><span class="sxs-lookup"><span data-stu-id="e0469-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="e0469-352">Puede copiar una instantánea [con PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) o mediante la utilidad de AzCopy Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="e0469-353">Para obtener más información, consulte [transferir datos con la utilidad de línea de comandos de AzCopy hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="e0469-354">En caso de hello de máquinas virtuales con varios discos, debe copiar todas las instantáneas de Hola que forman parte de hello coordinado por el mismo punto de restauración.</span><span class="sxs-lookup"><span data-stu-id="e0469-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="e0469-355">Cuando copia blobs de disco duro virtual de hello instantáneas toowritable, puede usar Hola blobs toorecreate la máquina virtual con la plantilla de Hola para hello máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="e0469-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="e0469-356">Otras opciones</span><span class="sxs-lookup"><span data-stu-id="e0469-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="e0469-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="e0469-357">SQL Server</span></span>

<span data-ttu-id="e0469-358">SQL Server en una máquina virtual tiene su propio toobackup capacidades integradas su tooAzure de base de datos de SQL Server almacenamiento de blobs o un recurso compartido de archivos.</span><span class="sxs-lookup"><span data-stu-id="e0469-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="e0469-359">Si la cuenta de almacenamiento de hello es GRS o RA-GRS, puede tener acceso a las copias de seguridad en el centro de datos secundario de la cuenta de almacenamiento de hello en caso de hello de un desastre, con hello las mismas restricciones según lo descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e0469-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="e0469-360">Para más información, consulte [Copias de seguridad y restauración para SQL Server en máquinas virtuales de Azure](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="e0469-361">Toobackup de adición y la restauración, [SQL Server grupos de disponibilidad AlwaysOn](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) pueden mantener las réplicas secundarias de las bases de datos toogreatly reducen el tiempo de recuperación ante desastres de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="e0469-362">Otras consideraciones</span><span class="sxs-lookup"><span data-stu-id="e0469-362">Other considerations</span></span>

<span data-ttu-id="e0469-363">Este artículo ha explicado cómo toobackup o tome instantáneas de las máquinas virtuales y su recuperación ante desastres de toosupport de discos y cómo toouse esos toorecover.</span><span class="sxs-lookup"><span data-stu-id="e0469-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="e0469-364">Con el modelo de Azure Resource Manager hello, muchas personas usan plantillas toocreate sus máquinas virtuales y otras infraestructuras en Azure.</span><span class="sxs-lookup"><span data-stu-id="e0469-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="e0469-365">Puede usar un toocreate plantilla una máquina virtual que tiene Hola misma configuración cada vez.</span><span class="sxs-lookup"><span data-stu-id="e0469-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="e0469-366">Si utiliza imágenes personalizadas para crear las máquinas virtuales, también debe asegurarse las imágenes están protegidas mediante un toostore de cuenta de RA-GRS ellos.</span><span class="sxs-lookup"><span data-stu-id="e0469-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="e0469-367">Por lo tanto, el proceso de copia de seguridad puede ser una combinación de estas dos acciones:</span><span class="sxs-lookup"><span data-stu-id="e0469-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="e0469-368">Datos de copia de seguridad hello (discos)</span><span class="sxs-lookup"><span data-stu-id="e0469-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="e0469-369">Configuración de copia de seguridad hello (plantillas, imágenes personalizadas)</span><span class="sxs-lookup"><span data-stu-id="e0469-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="e0469-370">Dependiendo de la opción de copia de seguridad de Hola que elija, puede tener copias de seguridad de toohandle Hola de datos de Hola y la configuración de Hola o servicio de copia de seguridad de hello puede controlan todo esto por usted.</span><span class="sxs-lookup"><span data-stu-id="e0469-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="e0469-371">Apéndice: comprender el impacto de Hola de LRS, GRS y RA-GRS</span><span class="sxs-lookup"><span data-stu-id="e0469-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="e0469-372">En el caso de las cuentas de almacenamiento de Azure, hay tres tipos de redundancia de datos que se debe considerar con respecto a la recuperación ante desastres: localmente redundante (LRS), con redundancia geográfica (GRS) o con redundancia geográfica y acceso de lectura (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="e0469-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="e0469-373">Localmente almacenamiento redundante (LRS) mantiene tres copias de datos de Hola Hola mismo centro de datos.</span><span class="sxs-lookup"><span data-stu-id="e0469-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="e0469-374">Al escribir datos de hello, se actualizan todas las copias de tres antes de que se realizará correctamente toohello autor de la llamada, por lo que son idénticos.</span><span class="sxs-lookup"><span data-stu-id="e0469-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="e0469-375">El disco está protegido contra errores locales, ya que es muy poco probable que se vean afectadas todas las copias de tres en hello mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="e0469-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="e0469-376">En caso de hello de LRS, no hay ninguna redundancia geográfica, por lo que el disco de hello no está protegida contra errores catastróficos que pueden afectar a una unidad de almacenamiento o centro de datos completo.</span><span class="sxs-lookup"><span data-stu-id="e0469-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="e0469-377">Con GRS y RA-GRS, tres copias de los datos se conservan en la región principal de hello (seleccionada por el usuario) y, más de tres copias de los datos se conservan en una región secundaria correspondiente (establecida de Azure).</span><span class="sxs-lookup"><span data-stu-id="e0469-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="e0469-378">Por ejemplo, si almacena datos de zona horaria del Pacífico occidental, datos de hello será replicada tooEast Estados Unidos.</span><span class="sxs-lookup"><span data-stu-id="e0469-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="e0469-379">Esto se hace de forma asincrónica y no hay un pequeño retraso entre actualizaciones toohello principal y secundaria.</span><span class="sxs-lookup"><span data-stu-id="e0469-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="e0469-380">Réplicas de discos de hello en el sitio secundario de hello son coherentes en una base por disco (con un retardo de hello), pero las réplicas de varios discos activas pueden no estar sincronizadas **entre sí**.</span><span class="sxs-lookup"><span data-stu-id="e0469-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="e0469-381">se necesitan toohave réplicas coherente en varios discos, las instantáneas coherentes.</span><span class="sxs-lookup"><span data-stu-id="e0469-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="e0469-382">Hola principal diferencia entre GRS y RA-GRS es que con RA-GRS, puede leer copia secundaria de Hola en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="e0469-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="e0469-383">Si hay un problema que representa los datos de hello en la región principal de hello inaccesible, Hola, equipo de Azure hará que cada acceso toorestore de esfuerzo.</span><span class="sxs-lookup"><span data-stu-id="e0469-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="e0469-384">Mientras Hola principal está inactivo, si tienen RA-GRS habilitada, puede tener acceso a datos de hello en el centro de datos secundaria de Hola.</span><span class="sxs-lookup"><span data-stu-id="e0469-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="e0469-385">Por lo tanto, si tiene previsto tooread de réplica de hello mientras Hola principal es inaccesible, deben considerarse RA-GRS.</span><span class="sxs-lookup"><span data-stu-id="e0469-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="e0469-386">Si resulta toobe una interrupción importante, Hola, equipo de Azure puede desencadenar una conmutación geográfica y cambiar Hola principal DNS entradas toopoint toosecondary almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="e0469-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="e0469-387">En este momento, si tiene cualquier GRS o RA-GRS habilitada, puede tener acceso a datos de hello en región de Hola que usa toobe Hola secundaria.</span><span class="sxs-lookup"><span data-stu-id="e0469-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="e0469-388">En otras palabras, si la cuenta de almacenamiento es GRS y hay un problema, puede tener acceso a almacenamiento secundario Hola solo si se produce una conmutación geográfica.</span><span class="sxs-lookup"><span data-stu-id="e0469-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="e0469-389">Para obtener más información, consulte [qué toodo si se produce una interrupción de almacenamiento de Azure](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="e0469-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="e0469-390">Tenga en cuenta que Microsoft controla si se produce una conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="e0469-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="e0469-391">La conmutación por error no se controla por cuenta de almacenamiento, por lo tanto no son los clientes individuales quienes deciden su uso.</span><span class="sxs-lookup"><span data-stu-id="e0469-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="e0469-392">tooimplement recuperación ante desastres para las cuentas de almacenamiento específico o discos de máquina virtual, debe usar técnicas de Hola que se ha descrito anteriormente en este artículo.</span><span class="sxs-lookup"><span data-stu-id="e0469-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>
