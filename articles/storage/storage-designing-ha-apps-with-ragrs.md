---
title: "aaaDesigning aplicaciones altamente disponibles con almacenamiento con redundancia geográfica de Azure con acceso de lectura (RA-GRS) | Documentos de Microsoft"
description: "¿Cómo tooarchitect de almacenamiento de Azure RA-GRS toouse una aplicación de alta disponibilidad flexible suficiente interrupciones toohandle."
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: e4a9fe7ef33eecd894408b3c1ef59920a248d1bd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-applications-using-ra-grs"></a><span data-ttu-id="4c1c1-103">Diseño de aplicaciones de alta disponibilidad mediante RA-GRS</span><span class="sxs-lookup"><span data-stu-id="4c1c1-103">Designing Highly Available Applications using RA-GRS</span></span>

<span data-ttu-id="4c1c1-104">Una característica común de las infraestructuras en la nube es que proporcionan una plataforma de alta disponibilidad para hospedar aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-104">A common feature of cloud-based infrastructures is that they provide a highly available platform for hosting applications.</span></span> <span data-ttu-id="4c1c1-105">Deben tener en cuenta a los desarrolladores de aplicaciones basadas en nube cuidadosamente cómo tooleverage esta plataforma toodeliver aplicaciones de alta disponibilidad tootheir a los usuarios.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-105">Developers of cloud-based applications must consider carefully how tooleverage this platform toodeliver highly available applications tootheir users.</span></span> <span data-ttu-id="4c1c1-106">En este artículo se centra específicamente en cómo los desarrolladores pueden usar hello Azure almacenamiento acceso de lectura almacenamiento con redundancia geográfica (RA-GRS) toomake sus aplicaciones están disponibles.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-106">This article focuses specifically on how developers can use hello Azure Storage Read Access Geo Redundant Storage (RA-GRS) toomake their applications more available.</span></span>

<span data-ttu-id="4c1c1-107">Existen cuatro opciones de redundancia: LRS (almacenamiento con redundancia local), ZRS (almacenamiento con redundancia de zona), GRS (almacenamiento con redundancia geográfica) y RA-GRS (almacenamiento con redundancia geográfica con acceso de lectura).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-107">There are four choices for redundancy – LRS (Locally Redundant Storage), ZRS (Zone Redundant Storage), GRS (Geo-Redundant Storage), and RA-GRS (Read Access Geo-Redundant Storage).</span></span> <span data-ttu-id="4c1c1-108">Vamos a toodiscuss GRS y RA-GRS en este artículo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-108">We are going toodiscuss GRS and RA-GRS in this article.</span></span> <span data-ttu-id="4c1c1-109">Con la GRS, tres copias de los datos se mantienen en la región principal de hello seleccionado al configurar la cuenta de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-109">With GRS, three copies of your data are kept in hello primary region you selected when setting up hello storage account.</span></span> <span data-ttu-id="4c1c1-110">Se mantienen tres copias adicionales de forma asincrónica en una región secundaria especificada por Azure.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-110">Three additional copies are maintained asynchronously in a secondary region specified by Azure.</span></span> <span data-ttu-id="4c1c1-111">RA-GRS es Hola lo mismo que GRS salvo que tienen copia secundaria de toohello de acceso de lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-111">RA-GRS is hello same thing as GRS except that you have read access toohello secondary copy.</span></span> <span data-ttu-id="4c1c1-112">Para obtener más información acerca de las opciones de redundancia de almacenamiento de Azure diferentes hello, consulte [replicación de almacenamiento de Azure](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-112">For more information about hello different Azure Storage redundancy options, see [Azure Storage replication](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span></span> <span data-ttu-id="4c1c1-113">artículo de replicación de Hello también muestra hello emparejamientos de las regiones principal y secundaria de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-113">hello replication article also shows hello pairings of hello primary and secondary regions.</span></span>

<span data-ttu-id="4c1c1-114">Hay fragmentos de código incluidos en este artículo y un ejemplo completo de vínculo tooa final Hola que puede descargar y ejecutar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-114">There are code snippets included in this article, and a link tooa complete sample at hello end that you can download and run.</span></span>

## <a name="key-features-of-ra-grs"></a><span data-ttu-id="4c1c1-115">Características fundamentales de RA-GRS</span><span class="sxs-lookup"><span data-stu-id="4c1c1-115">Key features of RA-GRS</span></span>

<span data-ttu-id="4c1c1-116">Antes de hablar acerca de cómo toouse almacenamiento RA-GRS, tratemos sobre sus propiedades y su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-116">Before we talk about how toouse RA-GRS storage, let's talk about its properties and behavior.</span></span>

* <span data-ttu-id="4c1c1-117">Almacenamiento de Azure mantiene una copia de solo lectura de datos de Hola que almacena en su región primaria en una región secundaria; tal y como se mencionó anteriormente, el servicio de almacenamiento de Hola determina la ubicación de Hola de región secundaria Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-117">Azure Storage maintains a read-only copy of hello data you store in your primary region in a secondary region; as noted above, hello storage service determines hello location of hello secondary region.</span></span>

* <span data-ttu-id="4c1c1-118">copia de solo lectura de Hello es [coherente](https://en.wikipedia.org/wiki/Eventual_consistency) con datos de hello en la región principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-118">hello read-only copy is [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency) with hello data in hello primary region.</span></span>

* <span data-ttu-id="4c1c1-119">Para blobs, tablas y colas, puede consultar la región secundaria de Hola para un *hora de última sincronización* valor que indica cuándo se produjo la última replicación de Hola de región secundaria de hello toohello principal.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-119">For blobs, tables, and queues, you can query hello secondary region for a *Last Sync Time* value that tells you when hello last replication from hello primary toohello secondary region occurred.</span></span> <span data-ttu-id="4c1c1-120">(esto no se admite para Azure File Storage, que no tiene redundancia RA-GRS en este momento).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-120">(This is not supported for Azure File storage, which doesn't have RA-GRS redundancy at this time.)</span></span>

* <span data-ttu-id="4c1c1-121">Puede usar Hola biblioteca cliente de almacenamiento toointeract con datos de Hola en cualquier región de hello principal o secundaria.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-121">You can use hello Storage Client Library toointeract with hello data in either hello primary or secondary region.</span></span> <span data-ttu-id="4c1c1-122">También puede redirigir solicitudes de lectura automáticamente región secundaria toohello si se agota el tiempo de espera de una región principal de toohello de solicitud de lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-122">You can also redirect read requests automatically toohello secondary region if a read request toohello primary region times out.</span></span>

* <span data-ttu-id="4c1c1-123">Si hay un problema grave que afectan a la accesibilidad de Hola de datos de hello en la región principal de hello, Hola, equipo de Azure puede desencadenar una conmutación geográfica, momento en que las entradas DNS de Hola que señala la región principal toohello serán región secundaria de toopoint modificadas toohello.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-123">If there is a major issue affecting hello accessibility of hello data in hello primary region, hello Azure team may trigger a geo-failover, at which point hello DNS entries pointing toohello primary region will be changed toopoint toohello secondary region.</span></span>

* <span data-ttu-id="4c1c1-124">Si se produce una conmutación geográfica, Azure se seleccionar una nueva ubicación secundaria y replicar la ubicación de los datos toothat Hola y luego elija hello tooit de las entradas DNS secundaria.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-124">If a geo-failover occurs, Azure will select a new secondary location and replicate hello data toothat location, then point hello secondary DNS entries tooit.</span></span> <span data-ttu-id="4c1c1-125">extremo secundario Hola dejará de estar disponible hasta que la cuenta de almacenamiento de hello ha terminado de replicar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-125">hello secondary endpoint will be unavailable until hello storage account has finished replicating.</span></span> <span data-ttu-id="4c1c1-126">Para obtener más información, vea [qué toodo si se produce una interrupción de almacenamiento de Azure](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-126">For more information, please see [What toodo if an Azure Storage outage occurs](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span></span>

## <a name="application-design-considerations-when-using-ra-grs"></a><span data-ttu-id="4c1c1-127">Consideraciones sobre el diseño de aplicaciones cuando se usa RA-GRS</span><span class="sxs-lookup"><span data-stu-id="4c1c1-127">Application design considerations when using RA-GRS</span></span>

<span data-ttu-id="4c1c1-128">Hola principal finalidad de este artículo es tooshow, cómo toodesign una aplicación que va a continuar toofunction (aunque en una capacidad limitada) incluso en caso de hello de un desastre importante en datos principales de hello center.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-128">hello main purpose of this article is tooshow you how toodesign an application that will continue toofunction (albeit in a limited capacity) even in hello event of a major disaster at hello primary data center.</span></span> <span data-ttu-id="4c1c1-129">Para ello, haciendo que su transitorio toohandle de aplicación o problemas de ejecución prolongada cambiando tooread de región secundaria Hola mientras hay un problema, y volver al área principal de hello esté disponible de nuevo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-129">You do this by having your application toohandle transient or long-running issues by switching tooread from hello secondary region while there is a problem, and switching back when hello primary region is available again.</span></span>

### <a name="using-eventually-consistent-data"></a><span data-ttu-id="4c1c1-130">Uso de datos con coherencia final</span><span class="sxs-lookup"><span data-stu-id="4c1c1-130">Using eventually consistent data</span></span>

<span data-ttu-id="4c1c1-131">Esta solución propuesta supone que es correcto tooreturn ¿cuál podría ser la aplicación que realiza la llamada de toohello datos obsoletos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-131">This proposed solution assumes that it is okay tooreturn what could be stale data toohello calling application.</span></span> <span data-ttu-id="4c1c1-132">Porque los datos secundarios de hello son coherentes, es posible que se escribieron datos de hello toohello principal pero Hola actualización toohello secundaria no había finalizado replicar cuando región principal Hola pasara a ser inaccesible.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-132">Because hello secondary data is eventually consistent, it is possible that hello data was written toohello primary but hello update toohello secondary had not finished replicating when hello primary region became inaccessible.</span></span>

<span data-ttu-id="4c1c1-133">Por ejemplo, el cliente puede enviar una actualización que es correcta y, a continuación, podría Bajar Hola principal antes de hello actualización propagado toohello secundaria.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-133">For example, your customer could submit an update that is successful, and then hello primary could go down before hello update is propagated toohello secondary.</span></span> <span data-ttu-id="4c1c1-134">En este caso, si el cliente hello después pide datos tooread hello, recibe datos obsoletos de hello en lugar de datos de hello actualizado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-134">In this case, if hello customer then asks tooread hello data back, he receives hello stale data instead of hello updated data.</span></span> <span data-ttu-id="4c1c1-135">Debe decidir si es aceptable y si es así, cómo se un mensaje del cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-135">You must decide if this is acceptable, and if so, how you will message hello customer.</span></span> <span data-ttu-id="4c1c1-136">Podrá ver cómo toocheck Hola última hora de sincronización de datos secundaria de hello más adelante en este artículo toosee si Hola secundario está actualizado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-136">You'll see how toocheck hello Last Sync Time on hello secondary data later in this article toosee if hello secondary is up-to-date.</span></span>

### <a name="handling-services-separately-or-all-together"></a><span data-ttu-id="4c1c1-137">Control de servicios por separado o conjuntamente</span><span class="sxs-lookup"><span data-stu-id="4c1c1-137">Handling services separately or all together</span></span>

<span data-ttu-id="4c1c1-138">Aunque no probable, es posible para un servicio toobecome no está disponible mientras hello otros servicios siguen siendo totalmente funcionales.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-138">While not likely, it is possible for one service toobecome unavailable while hello other services are still fully functional.</span></span> <span data-ttu-id="4c1c1-139">También pueden identificador hello reintentos y el modo de solo lectura para cada servicio por separado (blobs, colas, tablas), o puede controlar reintentos forma genérica para todos los servicios de almacenamiento de hello juntos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-139">You can handle hello retries and read-only mode for each service separately (blobs, queues, tables), or you can handle retries generically for all hello storage services together.</span></span>

<span data-ttu-id="4c1c1-140">Por ejemplo, si usa las colas y blobs en la aplicación, puede decidir tooput en errores de código independiente toohandle puede intentar de nuevo para cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-140">For example, if you use queues and blobs in your application, you may decide tooput in separate code toohandle retryable errors for each of these.</span></span> <span data-ttu-id="4c1c1-141">A continuación, si obtendrá un reintento de servicio de blob de hello, pero el servicio de cola de hello sigue funcionando, solo una parte de la aplicación que controla blobs Hola se verá afectada.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-141">Then if you get a retry from hello blob service, but hello queue service is still working, only hello part of your application that handles blobs will be impacted.</span></span> <span data-ttu-id="4c1c1-142">Si decide toohandle servicio de almacenamiento de todos los reintentos genéricamente y un servicio de blob de toohello llamada devuelve un error irreproducible, a continuación, se verá afectados el servicio de blob de solicitudes tooboth Hola y el servicio de cola de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-142">If you decide toohandle all storage service retries generically and a call toohello blob service returns a retryable error, then requests tooboth hello blob service and hello queue service will be impacted.</span></span>

<span data-ttu-id="4c1c1-143">En última instancia, esto depende en complejidad hello de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-143">Ultimately, this depends on hello complexity of your application.</span></span> <span data-ttu-id="4c1c1-144">Puede decidir no errores de hello toohandle por servicio, sino tooredirect las solicitudes para todos los región secundaria de almacenamiento servicios toohello de lectura y ejecutar aplicación hello en modo de solo lectura cuando se detecte un problema con cualquier servicio de almacenamiento en la región principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-144">You may decide not toohandle hello failures by service, but instead tooredirect read requests for all storage services toohello secondary region and run hello application in read-only mode when you detect a problem with any storage service in hello primary region.</span></span>

### <a name="other-considerations"></a><span data-ttu-id="4c1c1-145">Otras consideraciones</span><span class="sxs-lookup"><span data-stu-id="4c1c1-145">Other considerations</span></span>

<span data-ttu-id="4c1c1-146">Estos son Hola otras consideraciones, veremos en el resto de Hola de este artículo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-146">These are hello other considerations we will discuss in hello rest of this article.</span></span>

*   <span data-ttu-id="4c1c1-147">Controlar los reintentos de solicitudes de lectura mediante el patrón de disyuntor de Hola</span><span class="sxs-lookup"><span data-stu-id="4c1c1-147">Handling retries of read requests using hello Circuit Breaker pattern</span></span>

*   <span data-ttu-id="4c1c1-148">Hello última hora de sincronización y los datos finalmente coherentes</span><span class="sxs-lookup"><span data-stu-id="4c1c1-148">Eventually-consistent data and hello Last Sync Time</span></span>

*   <span data-ttu-id="4c1c1-149">Prueba</span><span class="sxs-lookup"><span data-stu-id="4c1c1-149">Testing</span></span>

## <a name="running-your-application-in-read-only-mode"></a><span data-ttu-id="4c1c1-150">Ejecución de la aplicación en modo de solo lectura</span><span class="sxs-lookup"><span data-stu-id="4c1c1-150">Running your application in read-only mode</span></span>

<span data-ttu-id="4c1c1-151">toouse almacenamiento RA-GRS, debe ser capaz de toohandle ambos no se pudo las solicitudes de lectura y actualización de solicitudes con error (con actualización en este caso lo que significa que las inserciones, actualizaciones y eliminaciones).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-151">toouse RA-GRS storage, you must be able toohandle both failed read requests and failed update requests (with update in this case meaning inserts, updates, and deletions).</span></span> <span data-ttu-id="4c1c1-152">Si leer hello se produce un error del centro de datos principal, las solicitudes pueden ser redirigido toohello centro de datos secundario, pero no de solicitudes de actualización porque Hola secundaria es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-152">If hello primary data center fails, read requests can be redirected toohello secondary data center, but update requests cannot because hello secondary is read only.</span></span> <span data-ttu-id="4c1c1-153">Por esta razón, necesita algunos toorun manera su aplicación en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-153">For this reason, you need some way toorun your application in read-only mode.</span></span>

<span data-ttu-id="4c1c1-154">Por ejemplo, puede establecer una marca que se va a comprobar antes de enviar cualquier servicio de almacenamiento de toohello de las solicitudes de actualización.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-154">For example, you can set a flag that will be checked before submitting any update requests toohello storage service.</span></span> <span data-ttu-id="4c1c1-155">Cuando una de las solicitudes de actualización de hello llega a través de, puede omitirlo y devolver a un cliente de toohello respuesta adecuada.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-155">When one of hello update requests comes through, you can skip it and return an appropriate response toohello customer.</span></span> <span data-ttu-id="4c1c1-156">Incluso puede desea toodisable cierto completamente características hasta que se solucione el problema de Hola y notificar a los usuarios que esas características no están disponibles temporalmente.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-156">You may even want toodisable certain features altogether until hello problem is resolved and notify users that those features are temporarily unavailable.</span></span>

<span data-ttu-id="4c1c1-157">Si decide toohandle errores para cada servicio por separado, también necesitará toohandle Hola capacidad toorun la aplicación en modo de solo lectura por servicio.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-157">If you decide toohandle errors for each service separately, you will also need toohandle hello ability toorun your application in read-only mode by service.</span></span> <span data-ttu-id="4c1c1-158">Podría tener marcas de solo lectura para cada servicio que se pueden habilitar y deshabilitado y el identificador hello marcador adecuado en lugares adecuados de hello en el código.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-158">You could have read-only flags for each service that can be enabled and disabled and handle hello appropriate flag in hello appropriate places in your code.</span></span>

<span data-ttu-id="4c1c1-159">Que se va a toorun capaz de la aplicación en modo de solo lectura tiene otra ventaja de lado: ofrece una funcionalidad limitada de hello capacidad tooensure durante una actualización de la aplicación principal.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-159">Being able toorun your application in read-only mode has another side benefit – it gives you hello ability tooensure limited functionality during a major application upgrade.</span></span> <span data-ttu-id="4c1c1-160">Puede desencadenar la toorun de aplicación en solo lectura modo y punto toohello centro de datos secundario, asegurándose de que nadie tiene acceso a datos de hello en la región principal de hello mientras está realizando las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-160">You can trigger your application toorun in read-only mode and point toohello secondary data center, ensuring nobody is accessing hello data in hello primary region while you're making upgrades.</span></span>

## <a name="handling-updates-when-running-in-read-only-mode"></a><span data-ttu-id="4c1c1-161">Control de las actualizaciones durante la ejecución en modo de solo lectura</span><span class="sxs-lookup"><span data-stu-id="4c1c1-161">Handling updates when running in read-only mode</span></span>

<span data-ttu-id="4c1c1-162">Hay muchas maneras de solicitudes de actualización de toohandle cuando se ejecuta en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-162">There are many ways toohandle update requests when running in read-only mode.</span></span> <span data-ttu-id="4c1c1-163">No se va a tratar esto de forma exhaustiva, pero, por lo general, hay un par de patrones que tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-163">We won't cover this comprehensively, but generally, there are a couple of patterns that you consider.</span></span>

1.  <span data-ttu-id="4c1c1-164">Puede responder tooyour usuario y dígales que actualmente no aceptan actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-164">You can respond tooyour user and tell them you are not currently accepting updates.</span></span> <span data-ttu-id="4c1c1-165">Por ejemplo, un sistema de administración de contactos podría habilitar información de contacto de clientes tooaccess pero no realizar actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-165">For example, a contact management system could enable customers tooaccess contact information but not make updates.</span></span>

2.  <span data-ttu-id="4c1c1-166">Puede poner las actualizaciones en cola en otra región.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-166">You can enqueue your updates in another region.</span></span> <span data-ttu-id="4c1c1-167">En este caso, podría escribir la cola de tooa de las solicitudes de actualización pendiente en una región distinta y, a continuación, se tiene un tooprocess de manera esas solicitudes después de centro de datos principal de hello pone de nuevo en línea.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-167">In this case, you would write your pending update requests tooa queue in a different region, and then have a way tooprocess those requests after hello primary data center comes online again.</span></span> <span data-ttu-id="4c1c1-168">En este escenario, se debe comunicar al cliente de Hola que solicitó la actualización Hola se pone en cola para su procesamiento posterior.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-168">In this scenario, you should let hello customer know that hello update requested is queued for later processing.</span></span>

3.  <span data-ttu-id="4c1c1-169">Puede escribir las actualizaciones de cuenta de almacenamiento de tooa en otra región.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-169">You can write your updates tooa storage account in another region.</span></span> <span data-ttu-id="4c1c1-170">A continuación, al centro de datos principal de hello vuelve a estar conectado, puede tener un toomerge de manera esas actualizaciones de datos principal de hello, dependiendo de la estructura de Hola de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-170">Then when hello primary data center comes back online, you can have a way toomerge those updates into hello primary data, depending on hello structure of hello data.</span></span> <span data-ttu-id="4c1c1-171">Por ejemplo, si va a crear archivos independientes con una marca de fecha y hora en nombre de hello, puede copiar esos región principal de back-toohello de archivos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-171">For example, if you are creating separate files with a date/time stamp in hello name, you can copy those files back toohello primary region.</span></span> <span data-ttu-id="4c1c1-172">Esto funciona para algunas cargas de trabajo como los datos de registro e IoT.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-172">This works for some workloads such as logging and iOT data.</span></span>

## <a name="handling-retries"></a><span data-ttu-id="4c1c1-173">Control de los reintentos</span><span class="sxs-lookup"><span data-stu-id="4c1c1-173">Handling retries</span></span>

<span data-ttu-id="4c1c1-174">¿Cómo saber qué errores se pueden reintentar?</span><span class="sxs-lookup"><span data-stu-id="4c1c1-174">How do you know which errors are retryable?</span></span> <span data-ttu-id="4c1c1-175">Esto viene determinado por la biblioteca de cliente de almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-175">This is determined by hello storage client library.</span></span> <span data-ttu-id="4c1c1-176">Por ejemplo, un error 404 (recurso no encontrado) no es recuperable porque reintentando no es probable tooresult en correcto.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-176">For example, a 404 error (resource not found) is not retryable because retrying it is not likely tooresult in success.</span></span> <span data-ttu-id="4c1c1-177">En hello otra parte, un error 500 es recuperable porque es un error del servidor, y puede ser simplemente un problema transitorio.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-177">On hello other hand, a 500 error is retryable because it is a server error, and it may simply be a transient issue.</span></span> <span data-ttu-id="4c1c1-178">Para obtener más detalles, visite hello [abrir código fuente de hello ExponentialRetry clase](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) en la biblioteca de cliente de almacenamiento de .NET de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-178">For more details, check out hello [open source code for hello ExponentialRetry class](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in hello .NET storage client library.</span></span> <span data-ttu-id="4c1c1-179">(Busque Hola método ShouldRetry).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-179">(Look for hello ShouldRetry method.)</span></span>

### <a name="read-requests"></a><span data-ttu-id="4c1c1-180">Solicitudes de lectura</span><span class="sxs-lookup"><span data-stu-id="4c1c1-180">Read requests</span></span>

<span data-ttu-id="4c1c1-181">Las solicitudes de lectura pueden ser redirigido toosecondary almacenamiento si hay un problema con el almacenamiento principal.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-181">Read requests can be redirected toosecondary storage if there is a problem with primary storage.</span></span> <span data-ttu-id="4c1c1-182">Como se indicó anteriormente en [finalmente utilizando los datos coherentes](#using-eventually-consistent-data), debe ser aceptable para su aplicación toopotentially lea datos obsoletos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-182">As noted above in [Using Eventually Consistent Data](#using-eventually-consistent-data), it must be acceptable for your application toopotentially read stale data.</span></span> <span data-ttu-id="4c1c1-183">Si usas tooaccess datos RA-GRS de la biblioteca de cliente del almacenamiento hello, puede especificar el comportamiento de reintento de Hola de una solicitud de lectura estableciendo un valor para hello **LocationMode** tooone de propiedad de siguientes hello:</span><span class="sxs-lookup"><span data-stu-id="4c1c1-183">If you are using hello storage client library tooaccess RA-GRS data, you can specify hello retry behavior of a read request by setting a value for hello **LocationMode** property tooone of hello following:</span></span>

*   <span data-ttu-id="4c1c1-184">**Principal solo** (Hola predeterminado)</span><span class="sxs-lookup"><span data-stu-id="4c1c1-184">**PrimaryOnly** (hello default)</span></span>

*   <span data-ttu-id="4c1c1-185">**PrimaryThenSecondary**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-185">**PrimaryThenSecondary**</span></span>

*   <span data-ttu-id="4c1c1-186">**SecondaryOnly**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-186">**SecondaryOnly**</span></span>

*   <span data-ttu-id="4c1c1-187">**SecondaryThenPrimary**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-187">**SecondaryThenPrimary**</span></span>

<span data-ttu-id="4c1c1-188">Al establecer hello **LocationMode** demasiado**PrimaryThenSecondary**, si Hola inicial lectura extremo primario de solicitud toohello se produce un error recuperable, cliente de hello automáticamente realiza otra lectura solicitud de extremo secundario toohello.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-188">When you set hello **LocationMode** too**PrimaryThenSecondary**, if hello initial read request toohello primary endpoint fails with a retryable error, hello client automatically makes another read request toohello secondary endpoint.</span></span> <span data-ttu-id="4c1c1-189">Si el error de hello es un tiempo de espera del servidor, cliente hello tendrá toowait para tooexpire de tiempo de espera de hello antes de recibir un error irreproducible del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-189">If hello error is a server timeout, then hello client will have toowait for hello timeout tooexpire before it receives a retryable error from hello service.</span></span>

<span data-ttu-id="4c1c1-190">Existen básicamente dos escenarios tooconsider cuando decida cómo error irreproducible de toorespond tooa:</span><span class="sxs-lookup"><span data-stu-id="4c1c1-190">There are basically two scenarios tooconsider when you are deciding how toorespond tooa retryable error:</span></span>

*   <span data-ttu-id="4c1c1-191">Se trata de un problema de aislamiento y extremo principal de las solicitudes posteriores toohello no devolverá un error irreproducible.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-191">This is an isolated problem and subsequent requests toohello primary endpoint will not return a retryable error.</span></span> <span data-ttu-id="4c1c1-192">Un ejemplo de cuándo puede ocurrir esto es un error de red transitorio.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-192">An example of where this might happen is when there is a transient network error.</span></span>

    <span data-ttu-id="4c1c1-193">En este escenario, no hay ninguna reducción significativa del rendimiento en tener **LocationMode** establecido demasiado**PrimaryThenSecondary** como solo se produce con poca frecuencia.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-193">In this scenario, there is no significant performance penalty in having **LocationMode** set too**PrimaryThenSecondary** as this only happens infrequently.</span></span>

*   <span data-ttu-id="4c1c1-194">Se trata de un problema con al menos uno de los servicios de almacenamiento de hello en la región principal de Hola y todos los servicios de toothat las solicitudes posteriores en la región principal de hello son errores puede reintentar de tooreturn probable durante un período de tiempo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-194">This is a problem with at least one of hello storage services in hello primary region and all subsequent requests toothat service in hello primary region are likely tooreturn retryable errors for a period of time.</span></span> <span data-ttu-id="4c1c1-195">Un ejemplo de esto es si la región principal de hello es completamente inaccesible.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-195">An example of this is if hello primary region is completely inaccessible.</span></span>

    <span data-ttu-id="4c1c1-196">En este escenario, hay una reducción del rendimiento porque todas las solicitudes de lectura se pruebe extremo principal de hello en primer lugar, espere a que tooexpire de tiempo de espera de Hola y cambiar extremo secundario toohello.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-196">In this scenario, there is a performance penalty because all your read requests will try hello primary endpoint first, wait for hello timeout tooexpire, then switch toohello secondary endpoint.</span></span>

<span data-ttu-id="4c1c1-197">Para estos escenarios, debe identificar que hay un problema en curso con el extremo principal de Hola y enviar todas las solicitudes de lectura directamente Hola toohello extremo secundario estableciendo **LocationMode** propiedad demasiado **SecondaryOnly**.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-197">For these scenarios, you should identify that there is an ongoing issue with hello primary endpoint and send all read requests directly toohello secondary endpoint by setting hello **LocationMode** property too**SecondaryOnly**.</span></span> <span data-ttu-id="4c1c1-198">En este momento, también debe cambiar hello toorun de aplicación en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-198">At this time, you should also change hello application toorun in read-only mode.</span></span> <span data-ttu-id="4c1c1-199">Este enfoque se denomina hello [patrón de disyuntor](https://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-199">This approach is known as hello [Circuit Breaker Pattern](https://msdn.microsoft.com/library/dn589784.aspx).</span></span>

### <a name="update-requests"></a><span data-ttu-id="4c1c1-200">Solicitudes de actualización</span><span class="sxs-lookup"><span data-stu-id="4c1c1-200">Update requests</span></span>

<span data-ttu-id="4c1c1-201">patrón de disyuntor de Hello también puede ser solicitudes de tooupdate aplicado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-201">hello Circuit Breaker pattern can also be applied tooupdate requests.</span></span> <span data-ttu-id="4c1c1-202">Sin embargo, las solicitudes de actualización no pueden ser redirigido toosecondary almacenamiento, que es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-202">However, update requests cannot be redirected toosecondary storage, which is read-only.</span></span> <span data-ttu-id="4c1c1-203">Para estas solicitudes, debe dejar hello **LocationMode** propiedad establecida demasiado**principal solo** (Hola de forma predeterminada).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-203">For these requests, you should leave hello **LocationMode** property set too**PrimaryOnly** (hello default).</span></span> <span data-ttu-id="4c1c1-204">toohandle estos errores, puede aplicar un solicita toothese métrica: como 10 errores en una fila y cuando se cumpla el umbral, cambie la aplicación hello en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-204">toohandle these errors, you can apply a metric toothese requests – such as 10 failures in a row – and when your threshold is met, switch hello application into read-only mode.</span></span> <span data-ttu-id="4c1c1-205">Puede usar Hola los mismos métodos para devolver el modo de tooupdate como los descritos a continuación en la siguiente sección sobre el patrón de disyuntor de Hola de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-205">You can use hello same methods for returning tooupdate mode as those described below in hello next section about hello Circuit Breaker pattern.</span></span>

## <a name="circuit-breaker-pattern"></a><span data-ttu-id="4c1c1-206">Patrón de disyuntor</span><span class="sxs-lookup"><span data-stu-id="4c1c1-206">Circuit Breaker pattern</span></span>

<span data-ttu-id="4c1c1-207">Utilizar el patrón de disyuntor de hello en la aplicación puede impedir que volver a intentar una operación que es probable que toofail repetidamente.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-207">Using hello Circuit Breaker pattern in your application can prevent it from retrying an operation that is likely toofail repeatedly.</span></span> <span data-ttu-id="4c1c1-208">Permite Hola aplicación toocontinue toorun en lugar de ocupando tiempo mientras se vuelve a intentar la operación de hello exponencialmente.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-208">It allows hello application toocontinue toorun rather than taking up time while hello operation is retried exponentially.</span></span> <span data-ttu-id="4c1c1-209">También detecta cuando se ha corregido el error de hello, en el que aplicación hello en tiempo puede intentar de nuevo la operación de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-209">It also detects when hello fault has been fixed, at which time hello application can try hello operation again.</span></span>

### <a name="how-tooimplement-hello-circuit-breaker-pattern"></a><span data-ttu-id="4c1c1-210">¿Cómo tooimplement Hola patrón de disyuntor</span><span class="sxs-lookup"><span data-stu-id="4c1c1-210">How tooimplement hello circuit breaker pattern</span></span>

<span data-ttu-id="4c1c1-211">tooidentify que hay un problema en curso con un punto de conexión principal, puede supervisar la frecuencia con el cliente de hello detecta errores puede intentar de nuevo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-211">tooidentify that there is an ongoing problem with a primary endpoint, you can monitor how frequently hello client encounters retryable errors.</span></span> <span data-ttu-id="4c1c1-212">Puesto que cada caso es diferente, tendrá que toodecide de umbral de hello desee toouse por extremo secundario de hello decisión tooswitch toohello y ejecutar la aplicación hello en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-212">Because each case is different, you have toodecide on hello threshold you want toouse for hello decision tooswitch toohello secondary endpoint and run hello application in read-only mode.</span></span> <span data-ttu-id="4c1c1-213">Por ejemplo, podría decidir conmutador de hello tooperform si hay 10 errores en una fila con ningún correctas.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-213">For example, you could decide tooperform hello switch if there are 10 failures in a row with no successes.</span></span> <span data-ttu-id="4c1c1-214">Otro ejemplo es tooswitch si se producen errores de 90% de las solicitudes de hello en un periodo de 2 minutos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-214">Another example is tooswitch if 90% of hello requests in a 2-minute period fail.</span></span>

<span data-ttu-id="4c1c1-215">Para el primer escenario hello, simplemente puede mantener un recuento de errores de hello y, si se produce un estado correcto antes de llegar a Hola Hola máximo, establezca recuento atrás toozero.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-215">For hello first scenario, you can simply keep a count of hello failures, and if there is a success before reaching hello maximum, set hello count back toozero.</span></span> <span data-ttu-id="4c1c1-216">Para el segundo escenario hello, una manera de tooimplement es toouse Hola objeto MemoryCache (en. NET).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-216">For hello second scenario, one way tooimplement it is toouse hello MemoryCache object (in .NET).</span></span> <span data-ttu-id="4c1c1-217">Para cada solicitud, agregar una caché de toohello CacheItem, establecer el valor de hello toosuccess (1) o producirá un error (0) y establecer minutos too2 Hola expiración desde ahora (o lo que la restricción de tiempo).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-217">For each request, add a CacheItem toohello cache, set hello value toosuccess (1) or fail (0), and set hello expiration time too2 minutes from now (or whatever your time constraint is).</span></span> <span data-ttu-id="4c1c1-218">Cuando se alcanza la fecha de expiración de la entrada, se quita automáticamente la entrada de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-218">When an entry's expiration time is reached, hello entry is automatically removed.</span></span> <span data-ttu-id="4c1c1-219">Esto le dará un intervalo gradual de 2 minutos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-219">This will give you a rolling 2-minute window.</span></span> <span data-ttu-id="4c1c1-220">Cada vez que realice un servicio de almacenamiento de toohello de solicitud, realice primero una consulta Linq en hello MemoryCache objeto toocalculate Hola porcentaje de operaciones correctas suma los valores de hello y dividiendo por recuento de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-220">Each time you make a request toohello storage service, you first use a Linq query across hello MemoryCache object toocalculate hello percent success by summing hello values and dividing by hello count.</span></span> <span data-ttu-id="4c1c1-221">Al éxito de porcentaje de hello cae por debajo de algún umbral (por ejemplo, 10%), establezca hello **LocationMode** propiedad para las solicitudes de lectura demasiado**SecondaryOnly** y cambiar la aplicación hello en modo de solo lectura antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-221">When hello percent success drops below some threshold (such as 10%), set hello **LocationMode** property for read requests too**SecondaryOnly** and switch hello application into read-only mode before continuing.</span></span>

<span data-ttu-id="4c1c1-222">umbral de Hola de errores utiliza toodetermine al conmutador de hello toomake puede variar con respecto tooservice de servicio en la aplicación, por lo que debe considerar hacerlos parámetros configurables.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-222">hello threshold of errors used toodetermine when toomake hello switch may vary from service tooservice in your application, so you should consider making them configurable parameters.</span></span> <span data-ttu-id="4c1c1-223">Esto también es donde decide toohandle puede reintentar errores de cada servicio por separado o como una de ellas, según lo descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-223">This is also where you decide toohandle retryable errors from each service separately or as one, as discussed previously.</span></span>

<span data-ttu-id="4c1c1-224">Otra consideración es cómo toohandle varias instancias de una aplicación y qué toodo para detectar errores puede reintentar en cada instancia.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-224">Another consideration is how toohandle multiple instances of an application, and what toodo when you detect retryable errors in each instance.</span></span> <span data-ttu-id="4c1c1-225">Por ejemplo, puede tener 20 máquinas virtuales que se ejecutan con hello cargado de la misma aplicación.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-225">For example, you may have 20 VMs running with hello same application loaded.</span></span> <span data-ttu-id="4c1c1-226">¿Va a controlar cada instancia por separado?</span><span class="sxs-lookup"><span data-stu-id="4c1c1-226">Do you handle each instance separately?</span></span> <span data-ttu-id="4c1c1-227">Si una instancia empieza a tener problemas, ¿desea toolimit Hola respuesta toojust que una instancia, o desea tootry toohave todas las instancias responden en hello mismo vista cuando una instancia tiene un problema?</span><span class="sxs-lookup"><span data-stu-id="4c1c1-227">If one instance starts having problems, do you want toolimit hello response toojust that one instance, or do you want tootry toohave all instances respond in hello same way when one instance has a problem?</span></span> <span data-ttu-id="4c1c1-228">Control de instancias de Hola por separado es mucho más sencillo que intentar respuesta de hello toocoordinate por encima de ellos, pero forma de hacerlo depende de la arquitectura de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-228">Handling hello instances separately is much simpler than trying toocoordinate hello response across them, but how you do this depends on your application's architecture.</span></span>

### <a name="options-for-monitoring-hello-error-frequency"></a><span data-ttu-id="4c1c1-229">Opciones para supervisar la frecuencia de error de Hola</span><span class="sxs-lookup"><span data-stu-id="4c1c1-229">Options for monitoring hello error frequency</span></span>

<span data-ttu-id="4c1c1-230">Tiene tres opciones principales para supervisar la frecuencia de Hola de reintentos en la región principal de hello en orden toodetermine cuando tooswitch por región secundaria toohello y cambio Hola toorun de aplicación en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-230">You have three main options for monitoring hello frequency of retries in hello primary region in order toodetermine when tooswitch over toohello secondary region and change hello application toorun in read-only mode.</span></span>

*   <span data-ttu-id="4c1c1-231">Agregue un controlador para hello [ **reintentando** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) evento en hello [ **OperationContext** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) objeto pasar las solicitudes de almacenamiento de tooyour: se trata de Hola método se muestra en este artículo y se usa en hello que acompaña a ejemplo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-231">Add a handler for hello [**Retrying**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) event on hello [**OperationContext**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object you pass tooyour storage requests – this is hello method displayed in this article and used in hello accompanying sample.</span></span> <span data-ttu-id="4c1c1-232">Estos eventos se activan cada vez que el cliente hello intenta enviar una solicitud, lo que le tootrack con qué frecuencia cliente hello encuentra errores puede reintentar en un punto de conexión principal.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-232">These events fire whenever hello client retries a request, enabling you tootrack how often hello client encounters retryable errors on a primary endpoint.</span></span>

    ```csharp 
    operationContext.Retrying += (sender, arguments) =>
    {
        // Retrying in hello primary region
        if (arguments.Request.Host == primaryhostname)
            ...
    };
    ```

*   <span data-ttu-id="4c1c1-233">Hola [ **Evaluate** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) método en una directiva de reintentos personalizado, puede ejecutar código personalizado siempre que realiza un reintento.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-233">In hello [**Evaluate**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) method in a custom retry policy, you can run custom code whenever a retry takes place.</span></span> <span data-ttu-id="4c1c1-234">En suma toorecording cuando un reintento ocurre, esto también proporciona Hola oportunidad toomodify su comportamiento para reintentar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-234">In addition toorecording when a retry happens, this also gives you hello opportunity toomodify your retry behavior.</span></span>

    ```csharp 
    public RetryInfo Evaluate(RetryContext retryContext,
    OperationContext operationContext)
    {
        var statusCode = retryContext.LastRequestResult.HttpStatusCode;
        if (retryContext.CurrentRetryCount >= this.maximumAttempts
        || ((statusCode &gt;= 300 && statusCode &lt; 500 && statusCode != 408)
        || statusCode == 501 // Not Implemented
        || statusCode == 505 // Version Not Supported
            ))
        {
        // Do not retry
            return null;
        }

        // Monitor retries in hello primary location
        ...

        // Determine RetryInterval and TargetLocation
        RetryInfo info =
            CreateRetryInfo(retryContext.CurrentRetryCount);

        return info;
    }
    ```

*   <span data-ttu-id="4c1c1-235">Hola tercer enfoque es un componente de supervisión personalizado en la aplicación que hace ping continuamente en el punto de conexión de almacenamiento principal con ficticia tooimplement leer las solicitudes (por ejemplo, para leer un blob pequeño) toodetermine su estado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-235">hello third approach is tooimplement a custom monitoring component in your application that continually pings your primary storage endpoint with dummy read requests (such as reading a small blob) toodetermine its health.</span></span> <span data-ttu-id="4c1c1-236">Esto consumiría recursos, pero no en cantidades notables.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-236">This would take up some resources, but not a significant amount.</span></span> <span data-ttu-id="4c1c1-237">Cuando se detecta un problema que alcanza el umbral, a continuación, podría ejecutar conmutador Hola demasiado**SecondaryOnly** y modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-237">When a problem is discovered that reaches your threshold, you would then perform hello switch too**SecondaryOnly** and read-only mode.</span></span>

<span data-ttu-id="4c1c1-238">En algún momento, le interesará extremo principal de tooswitch toousing atrás hello y permitir actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-238">At some point, you will want tooswitch back toousing hello primary endpoint and allowing updates.</span></span> <span data-ttu-id="4c1c1-239">Si usa uno de los dos primeros métodos de hello mencionados anteriormente, puede simplemente cambiar punto de conexión principal toohello back- y habilitar el modo de actualización después de haber realizado un período de tiempo seleccionado arbitrariamente o un número de operaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-239">If using one of hello first two methods listed above, you could simply switch back toohello primary endpoint and enable update mode after an arbitrarily selected amount of time or number of operations has been performed.</span></span> <span data-ttu-id="4c1c1-240">A continuación, puede dejar que vaya a través de la lógica de reintento de Hola de nuevo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-240">You can then let it go through hello retry logic again.</span></span> <span data-ttu-id="4c1c1-241">Si se ha corregido el problema de hello, continuará extremo principal de toouse hello y permitir las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-241">If hello problem has been fixed, it will continue toouse hello primary endpoint and allow updates.</span></span> <span data-ttu-id="4c1c1-242">Si hay un problema, una vez más se cambiarán extremo secundario toohello atrás y modo de solo lectura después de un error de criterios de Hola que haya establecido.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-242">If there is still a problem, it will once more switch back toohello secondary endpoint and read-only mode after failing hello criteria you've set.</span></span>

<span data-ttu-id="4c1c1-243">Para el tercer escenario hello, al hacer ping punto de conexión de almacenamiento principal de hello vuelve correctamente, puede desencadenar nuevo conmutador de hello demasiado**principal solo** y continuar permitir actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-243">For hello third scenario, when pinging hello primary storage endpoint becomes successful again, you can trigger hello switch back too**PrimaryOnly** and continue allowing updates.</span></span>

## <a name="handling-eventually-consistent-data"></a><span data-ttu-id="4c1c1-244">Control de datos con coherencia final</span><span class="sxs-lookup"><span data-stu-id="4c1c1-244">Handling eventually consistent data</span></span>

<span data-ttu-id="4c1c1-245">RA-GRS funciona mediante la replicación de las transacciones de la región secundaria de hello toohello principal.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-245">RA-GRS works by replicating transactions from hello primary toohello secondary region.</span></span> <span data-ttu-id="4c1c1-246">Este proceso de replicación garantiza que se datos hello en la región secundaria hello *coherente*.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-246">This replication process guarantees that hello data in hello secondary region is *eventually consistent*.</span></span> <span data-ttu-id="4c1c1-247">Esto significa que todas las transacciones de hello en la región principal de hello finalmente aparecerán en la región secundaria de hello, pero que puede haber un retraso antes de que aparezcan y que no hay ninguna garantía de las transacciones de hello llegan en la región secundaria de Hola Hola mismo orden que en el que se aplicaron originalmente en la región principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-247">This means that all hello transactions in hello primary region will eventually appear in hello secondary region, but that there may be a lag before they appear, and that there is no guarantee hello transactions arrive in hello secondary region in hello same order as that in which they were originally applied in hello primary region.</span></span> <span data-ttu-id="4c1c1-248">Si las transacciones llegan en la región secundaria de hello desordenados, se *puede* tenga en cuenta los datos en hello región secundaria toobe en un estado incoherente hasta que el servicio de hello pone al mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-248">If your transactions arrive in hello secondary region out of order, you *may* consider your data in hello secondary region toobe in an inconsistent state until hello service catches up.</span></span>

<span data-ttu-id="4c1c1-249">Hello tabla siguiente muestra un ejemplo de qué puede ocurrir al actualizar detalles de Hola de un empleado toomake ella un miembro de hello *administradores* rol.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-249">hello following table shows an example of what might happen when you update hello details of an employee toomake her a member of hello *administrators* role.</span></span> <span data-ttu-id="4c1c1-250">Para simplificar hello en este ejemplo, esto requiere actualizar hello **empleado** entidad y actualizar una **rol de administrador** entidad con un recuento del número total de Hola de administradores.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-250">For hello sake of this example, this requires you update hello **employee** entity and update an **administrator role** entity with a count of hello total number of administrators.</span></span> <span data-ttu-id="4c1c1-251">Tenga en cuenta cómo se aplican las actualizaciones de hello fuera de servicio en la región secundaria Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-251">Notice how hello updates are applied out of order in hello secondary region.</span></span>

| <span data-ttu-id="4c1c1-252">**Hora**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-252">**Time**</span></span> | <span data-ttu-id="4c1c1-253">**Transacción**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-253">**Transaction**</span></span>                                            | <span data-ttu-id="4c1c1-254">**Replicación**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-254">**Replication**</span></span>                       | <span data-ttu-id="4c1c1-255">**Hora de última sincronización**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-255">**Last Sync Time**</span></span> | <span data-ttu-id="4c1c1-256">**Resultado**</span><span class="sxs-lookup"><span data-stu-id="4c1c1-256">**Result**</span></span> |
|----------|------------------------------------------------------------|---------------------------------------|--------------------|------------| 
| <span data-ttu-id="4c1c1-257">T0</span><span class="sxs-lookup"><span data-stu-id="4c1c1-257">T0</span></span>       | <span data-ttu-id="4c1c1-258">Transacción A:</span><span class="sxs-lookup"><span data-stu-id="4c1c1-258">Transaction A:</span></span> <br> <span data-ttu-id="4c1c1-259">Insertar entidad</span><span class="sxs-lookup"><span data-stu-id="4c1c1-259">Insert employee</span></span> <br> <span data-ttu-id="4c1c1-260">empleado en región primaria</span><span class="sxs-lookup"><span data-stu-id="4c1c1-260">entity in primary</span></span> |                                   |                    | <span data-ttu-id="4c1c1-261">La transacción A inserta tooprimary,</span><span class="sxs-lookup"><span data-stu-id="4c1c1-261">Transaction A inserted tooprimary,</span></span><br> <span data-ttu-id="4c1c1-262">aún sin replicar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-262">not replicated yet.</span></span> |
| <span data-ttu-id="4c1c1-263">T1</span><span class="sxs-lookup"><span data-stu-id="4c1c1-263">T1</span></span>       |                                                            | <span data-ttu-id="4c1c1-264">Transacción A</span><span class="sxs-lookup"><span data-stu-id="4c1c1-264">Transaction A</span></span> <br> <span data-ttu-id="4c1c1-265">replicada en</span><span class="sxs-lookup"><span data-stu-id="4c1c1-265">replicated to</span></span><br> <span data-ttu-id="4c1c1-266">región secundaria</span><span class="sxs-lookup"><span data-stu-id="4c1c1-266">secondary</span></span> | <span data-ttu-id="4c1c1-267">T1</span><span class="sxs-lookup"><span data-stu-id="4c1c1-267">T1</span></span> | <span data-ttu-id="4c1c1-268">La transacción A replica toosecondary.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-268">Transaction A replicated toosecondary.</span></span> <br><span data-ttu-id="4c1c1-269">Hora de última sincronización actualizada.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-269">Last Sync Time updated.</span></span>    |
| <span data-ttu-id="4c1c1-270">T2</span><span class="sxs-lookup"><span data-stu-id="4c1c1-270">T2</span></span>       | <span data-ttu-id="4c1c1-271">Transacción B:</span><span class="sxs-lookup"><span data-stu-id="4c1c1-271">Transaction B:</span></span><br><span data-ttu-id="4c1c1-272">Actualizar</span><span class="sxs-lookup"><span data-stu-id="4c1c1-272">Update</span></span><br> <span data-ttu-id="4c1c1-273">entidad empleado</span><span class="sxs-lookup"><span data-stu-id="4c1c1-273">employee entity</span></span><br> <span data-ttu-id="4c1c1-274">en región primaria</span><span class="sxs-lookup"><span data-stu-id="4c1c1-274">in primary</span></span>  |                                | <span data-ttu-id="4c1c1-275">T1</span><span class="sxs-lookup"><span data-stu-id="4c1c1-275">T1</span></span>                 | <span data-ttu-id="4c1c1-276">Transacción B escrito tooprimary,</span><span class="sxs-lookup"><span data-stu-id="4c1c1-276">Transaction B written tooprimary,</span></span><br> <span data-ttu-id="4c1c1-277">aún sin replicar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-277">not replicated yet.</span></span>  |
| <span data-ttu-id="4c1c1-278">T3</span><span class="sxs-lookup"><span data-stu-id="4c1c1-278">T3</span></span>       | <span data-ttu-id="4c1c1-279">Transacción C:</span><span class="sxs-lookup"><span data-stu-id="4c1c1-279">Transaction C:</span></span><br> <span data-ttu-id="4c1c1-280">Actualizar</span><span class="sxs-lookup"><span data-stu-id="4c1c1-280">Update</span></span> <br><span data-ttu-id="4c1c1-281">administrator</span><span class="sxs-lookup"><span data-stu-id="4c1c1-281">administrator</span></span><br><span data-ttu-id="4c1c1-282">entidad rol administrador en región</span><span class="sxs-lookup"><span data-stu-id="4c1c1-282">role entity in</span></span><br><span data-ttu-id="4c1c1-283">primary</span><span class="sxs-lookup"><span data-stu-id="4c1c1-283">primary</span></span> |                    | <span data-ttu-id="4c1c1-284">T1</span><span class="sxs-lookup"><span data-stu-id="4c1c1-284">T1</span></span>                 | <span data-ttu-id="4c1c1-285">Transacción C escrito tooprimary,</span><span class="sxs-lookup"><span data-stu-id="4c1c1-285">Transaction C written tooprimary,</span></span><br> <span data-ttu-id="4c1c1-286">aún sin replicar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-286">not replicated yet.</span></span>  |
| <span data-ttu-id="4c1c1-287">*T4*</span><span class="sxs-lookup"><span data-stu-id="4c1c1-287">*T4*</span></span>     |                                                       | <span data-ttu-id="4c1c1-288">Transacción C</span><span class="sxs-lookup"><span data-stu-id="4c1c1-288">Transaction C</span></span> <br><span data-ttu-id="4c1c1-289">replicada en</span><span class="sxs-lookup"><span data-stu-id="4c1c1-289">replicated to</span></span><br> <span data-ttu-id="4c1c1-290">región secundaria</span><span class="sxs-lookup"><span data-stu-id="4c1c1-290">secondary</span></span> | <span data-ttu-id="4c1c1-291">T1</span><span class="sxs-lookup"><span data-stu-id="4c1c1-291">T1</span></span>         | <span data-ttu-id="4c1c1-292">Transacción C replica toosecondary.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-292">Transaction C replicated toosecondary.</span></span><br><span data-ttu-id="4c1c1-293">LastSyncTime no actualizado porque</span><span class="sxs-lookup"><span data-stu-id="4c1c1-293">LastSyncTime not updated because</span></span> <br><span data-ttu-id="4c1c1-294">la transacción B está aún sin replicar.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-294">transaction B has not been replicated yet.</span></span>|
| <span data-ttu-id="4c1c1-295">*T5*</span><span class="sxs-lookup"><span data-stu-id="4c1c1-295">*T5*</span></span>     | <span data-ttu-id="4c1c1-296">Leer entidades</span><span class="sxs-lookup"><span data-stu-id="4c1c1-296">Read entities</span></span> <br><span data-ttu-id="4c1c1-297">desde región secundaria</span><span class="sxs-lookup"><span data-stu-id="4c1c1-297">from secondary</span></span>                           |                                  | <span data-ttu-id="4c1c1-298">T1</span><span class="sxs-lookup"><span data-stu-id="4c1c1-298">T1</span></span>                 | <span data-ttu-id="4c1c1-299">Obtener valor obsoleto de Hola de empleado</span><span class="sxs-lookup"><span data-stu-id="4c1c1-299">You get hello stale value for employee</span></span> <br> <span data-ttu-id="4c1c1-300">empleado porque la transacción B aún</span><span class="sxs-lookup"><span data-stu-id="4c1c1-300">entity because transaction B hasn't</span></span> <br> <span data-ttu-id="4c1c1-301">no se ha replicado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-301">replicated yet.</span></span> <span data-ttu-id="4c1c1-302">Obtener el nuevo valor de Hola para</span><span class="sxs-lookup"><span data-stu-id="4c1c1-302">You get hello new value for</span></span><br> <span data-ttu-id="4c1c1-303">entidad rol de administrador porque C</span><span class="sxs-lookup"><span data-stu-id="4c1c1-303">administrator role entity because C has</span></span><br> <span data-ttu-id="4c1c1-304">se ha replicado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-304">replicated.</span></span> <span data-ttu-id="4c1c1-305">La hora de la última sincronización aún no se ha</span><span class="sxs-lookup"><span data-stu-id="4c1c1-305">Last Sync Time still hasn't</span></span><br> <span data-ttu-id="4c1c1-306">actualizado porque la transacción B</span><span class="sxs-lookup"><span data-stu-id="4c1c1-306">been updated because transaction B</span></span><br> <span data-ttu-id="4c1c1-307">no se ha replicado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-307">hasn't replicated.</span></span> <span data-ttu-id="4c1c1-308">Puede ver que la</span><span class="sxs-lookup"><span data-stu-id="4c1c1-308">You can tell the</span></span><br><span data-ttu-id="4c1c1-309">entidad rol de administrador es incoherente</span><span class="sxs-lookup"><span data-stu-id="4c1c1-309">administrator role entity is inconsistent</span></span> <br><span data-ttu-id="4c1c1-310">porque Hola entidad fecha y hora es posterior a</span><span class="sxs-lookup"><span data-stu-id="4c1c1-310">because hello entity date/time is after</span></span> <br><span data-ttu-id="4c1c1-311">Hola hora de última sincronización.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-311">hello Last Sync Time.</span></span> |
| <span data-ttu-id="4c1c1-312">*T6*</span><span class="sxs-lookup"><span data-stu-id="4c1c1-312">*T6*</span></span>     |                                                      | <span data-ttu-id="4c1c1-313">Transacción B</span><span class="sxs-lookup"><span data-stu-id="4c1c1-313">Transaction B</span></span><br> <span data-ttu-id="4c1c1-314">replicada en</span><span class="sxs-lookup"><span data-stu-id="4c1c1-314">replicated to</span></span><br> <span data-ttu-id="4c1c1-315">región secundaria</span><span class="sxs-lookup"><span data-stu-id="4c1c1-315">secondary</span></span> | <span data-ttu-id="4c1c1-316">T6</span><span class="sxs-lookup"><span data-stu-id="4c1c1-316">T6</span></span>                 | <span data-ttu-id="4c1c1-317">*T6*: todas las transacciones hasta la C</span><span class="sxs-lookup"><span data-stu-id="4c1c1-317">*T6* – All transactions through C have</span></span> <br><span data-ttu-id="4c1c1-318">se han replicado, Hora de última sincronización</span><span class="sxs-lookup"><span data-stu-id="4c1c1-318">been replicated, Last Sync Time</span></span><br> <span data-ttu-id="4c1c1-319">se ha actualizado.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-319">is updated.</span></span> |

<span data-ttu-id="4c1c1-320">En este ejemplo, suponga Hola cliente conmutadores tooreading de región secundaria de Hola a T5.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-320">In this example, assume hello client switches tooreading from hello secondary region at T5.</span></span> <span data-ttu-id="4c1c1-321">Puede leer correctamente hello **rol de administrador** entidad en este momento, pero la entidad de hello contiene un valor para el número de Hola de los administradores que no es coherente con el número de Hola de **empleado** entidades que se marcan como administradores en la región secundaria de hello en este momento.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-321">It can successfully read hello **administrator role** entity at this time, but hello entity contains a value for hello count of administrators that is not consistent with hello number of **employee** entities that are marked as administrators in hello secondary region at this time.</span></span> <span data-ttu-id="4c1c1-322">El cliente podría mostrar simplemente este valor, con el riesgo de Hola que es información incoherente.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-322">Your client could simply display this value, with hello risk that it is inconsistent information.</span></span> <span data-ttu-id="4c1c1-323">O bien, el cliente de hello podría intentar toodetermine ese hello **rol de administrador** está en un estado potencialmente incoherente porque Hola actualizaciones han tenido lugar fuera de servicio y, a continuación, informar al usuario de Hola de este hecho.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-323">Alternatively, hello client could attempt toodetermine that hello **administrator role** is in a potentially inconsistent state because hello updates have happened out of order, and then inform hello user of this fact.</span></span>

<span data-ttu-id="4c1c1-324">toorecognize que tiene datos potencialmente incoherentes, cliente hello puede utilizar el valor de Hola de hello *hora de última sincronización* que puede obtener en cualquier momento al consultar un servicio de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-324">toorecognize that it has potentially inconsistent data, hello client can use hello value of hello *Last Sync Time* that you can get at any time by querying a storage service.</span></span> <span data-ttu-id="4c1c1-325">Esto indica tiempo hello cuando datos hello en la región secundaria Hola por últimos coherente y al servicio Hola aplicado todos Hola transacciones toothat anterior punto en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-325">This tells you hello time when hello data in hello secondary region was last consistent and when hello service had applied all hello transactions prior toothat point in time.</span></span> <span data-ttu-id="4c1c1-326">En el ejemplo de Hola mostrado anteriormente, una vez que el servicio de hello inserta hello **empleado** entidad región secundaria de hello, Hola hora de última sincronización se establece demasiado*T1*.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-326">In hello example shown above, after hello service inserts hello **employee** entity in hello secondary region, hello last sync time is set too*T1*.</span></span> <span data-ttu-id="4c1c1-327">Permanece en *T1* hasta que actualiza el servicio de Hola Hola **empleado** entidad en la región secundaria de Hola y se establece demasiado*T6*.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-327">It remains at *T1* until hello service updates hello **employee** entity in hello secondary region when it is set too*T6*.</span></span> <span data-ttu-id="4c1c1-328">Si el cliente de hello recupera Hola última hora de sincronización cuando lee la entidad de hello en *T5*, puede comparar con marca de tiempo de hello en la entidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-328">If hello client retrieves hello last sync time when it reads hello entity at *T5*, it can compare it with hello timestamp on hello entity.</span></span> <span data-ttu-id="4c1c1-329">Si es posterior a Hola Hola marca de tiempo en la entidad de Hola tiempo, de la última sincronización, a continuación, hello entidad se encuentra en un estado incoherente potencialmente y puede requerir sea cual sea la acción adecuada de hello para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-329">If hello timestamp on hello entity is later than hello last sync time, then hello entity is in a potentially inconsistent state, and you can take whatever is hello appropriate action for your application.</span></span> <span data-ttu-id="4c1c1-330">Uso de este campo requiere que sepa cuándo se completó toohello de actualización de última de hello principal.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-330">Using this field requires that you know when hello last update toohello primary was completed.</span></span>

## <a name="testing"></a><span data-ttu-id="4c1c1-331">Prueba</span><span class="sxs-lookup"><span data-stu-id="4c1c1-331">Testing</span></span>

<span data-ttu-id="4c1c1-332">Es importante tootest que la aplicación se comporta según lo esperado cuando encuentra errores puede intentar de nuevo.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-332">It's important tootest that your application behaves as expected when it encounters retryable errors.</span></span> <span data-ttu-id="4c1c1-333">Por ejemplo, debe tootest que Hola toohello de conmutadores de aplicación secundario y en modo de solo lectura cuando se detecta un problema y vuelve cuando región principal Hola vuelva a estar disponible.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-333">For example, you need tootest that hello application switches toohello secondary and into read-only mode when it detects a problem, and switches back when hello primary region becomes available again.</span></span> <span data-ttu-id="4c1c1-334">toodo, necesita una manera toosimulate puede reintentar los errores y controlar con qué frecuencia se producen.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-334">toodo this, you need a way toosimulate retryable errors and control how often they occur.</span></span>

<span data-ttu-id="4c1c1-335">Puede usar [Fiddler](http://www.telerik.com/fiddler) toointercept y modificar las respuestas HTTP en una secuencia de comandos.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-335">You can use [Fiddler](http://www.telerik.com/fiddler) toointercept and modify HTTP responses in a script.</span></span> <span data-ttu-id="4c1c1-336">Esta secuencia de comandos puede identificar las respuestas que proceden de su punto de conexión principal y cambiar tooone de código de estado HTTP de Hola que Hola que biblioteca cliente de almacenamiento se reconoce como un error irreproducible.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-336">This script can identify responses that come from your primary endpoint and change hello HTTP status code tooone that hello Storage Client Library recognizes as a retryable error.</span></span> <span data-ttu-id="4c1c1-337">Este fragmento de código muestra un ejemplo sencillo de una secuencia de comandos de Fiddler que intercepta las solicitudes de tooread de respuestas contra Hola **employeedata** tabla tooreturn un estado 502:</span><span class="sxs-lookup"><span data-stu-id="4c1c1-337">This code snippet shows a simple example of a Fiddler script that intercepts responses tooread requests against hello **employeedata** table tooreturn a 502 status:</span></span>

```java
static function OnBeforeResponse(oSession: Session) {
    ...
    if ((oSession.hostname == "\[yourstorageaccount\].table.core.windows.net")
      && (oSession.PathAndQuery.StartsWith("/employeedata?$filter"))) {
        oSession.responseCode = 502;
    }
}
```

<span data-ttu-id="4c1c1-338">También puede extender este ejemplo toointercept una gama más amplia de solicitudes y cambiar sólo hello **responseCode** en algunos de ellos toobetter simular un escenario real.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-338">You could extend this example toointercept a wider range of requests and only change hello **responseCode** on some of them toobetter simulate a real-world scenario.</span></span> <span data-ttu-id="4c1c1-339">Para obtener más información acerca de cómo personalizar las secuencias de comandos de Fiddler, consulte [modificar una solicitud o respuesta](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) Hola documentación de Fiddler.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-339">For more information about customizing Fiddler scripts, see [Modifying a Request or Response](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in hello Fiddler documentation.</span></span>

<span data-ttu-id="4c1c1-340">Si ha realizado los umbrales de Hola para cambiar el modo de solo tooread de aplicación configurable, resultará más fácil de comportamiento de hello tootest con volúmenes de transacciones no es de producción.</span><span class="sxs-lookup"><span data-stu-id="4c1c1-340">If you have made hello thresholds for switching your application tooread-only mode configurable, it will be easier tootest hello behavior with non-production transaction volumes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="4c1c1-341">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="4c1c1-341">Next Steps</span></span>

* <span data-ttu-id="4c1c1-342">Para obtener más información acerca de acceso de lectura la redundancia geográfica, incluidos otro ejemplo de cómo está configurado Hola LastSyncTime, visite [opciones de redundancia de almacenamiento de Windows Azure y almacenamiento con redundancia geográfica acceso de lectura](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-342">For more information about Read Access Geo-Redundancy, including another example of how hello LastSyncTime is set, please see [Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

* <span data-ttu-id="4c1c1-343">Para obtener un ejemplo completo que muestra cómo toomake Hola conmutador y hacia atrás entre los extremos de principal y secundaria de hello, vea [ejemplos de Azure: mediante Hola patrón de disyuntor con almacenamiento de RA-GRS](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span><span class="sxs-lookup"><span data-stu-id="4c1c1-343">For a complete sample showing how toomake hello switch back and forth between hello Primary and Secondary endpoints, please see [Azure Samples – Using hello Circuit Breaker Pattern with RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span></span>
