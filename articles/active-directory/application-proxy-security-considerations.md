---
title: "Consideraciones de aaaSecurity para el Proxy de aplicación de Azure AD | Documentos de Microsoft"
description: "Se tratan las consideraciones de seguridad al utilizar el Proxy de aplicación de Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: ebd14b9d1fc8f4629c5916e5a910595727d935d5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="security-considerations-for-accessing-apps-remotely-with-azure-ad-application-proxy"></a><span data-ttu-id="d2e71-103">Consideraciones de seguridad al obtener acceso a aplicaciones de forma remota con el Proxy de aplicación de Azure AD</span><span class="sxs-lookup"><span data-stu-id="d2e71-103">Security considerations for accessing apps remotely with Azure AD Application Proxy</span></span>

<span data-ttu-id="d2e71-104">En este artículo se explica el modo en que el proxy de aplicación de Azure Active Directory proporciona un servicio seguro para la publicación y el acceso a las aplicaciones de forma remota.</span><span class="sxs-lookup"><span data-stu-id="d2e71-104">This article explains how Azure Active Directory Application Proxy provides a secure service for publishing and accessing your applications remotely.</span></span>

<span data-ttu-id="d2e71-105">Hola siguiente diagrama muestra cómo Azure AD permite a las aplicaciones locales de tooyour de acceso remoto seguro.</span><span class="sxs-lookup"><span data-stu-id="d2e71-105">hello following diagram shows how Azure AD enables secure remote access tooyour on-premises applications.</span></span>

 ![Diagrama de acceso remoto seguro a través del Proxy de aplicación de Azure AD](./media/application-proxy-security-considerations/secure-remote-access.png)

## <a name="security-benefits"></a><span data-ttu-id="d2e71-107">Ventajas de seguridad</span><span class="sxs-lookup"><span data-stu-id="d2e71-107">Security benefits</span></span>

<span data-ttu-id="d2e71-108">El Proxy de aplicación de Azure AD ofrece Hola siguiendo las ventajas de seguridad:</span><span class="sxs-lookup"><span data-stu-id="d2e71-108">Azure AD Application Proxy offers hello following security benefits:</span></span>

### <a name="authenticated-access"></a><span data-ttu-id="d2e71-109">Acceso autenticado</span><span class="sxs-lookup"><span data-stu-id="d2e71-109">Authenticated access</span></span> 

<span data-ttu-id="d2e71-110">Si elige toouse Azure Active Directory autenticación previa, solo las conexiones autenticadas pueden acceder a la red.</span><span class="sxs-lookup"><span data-stu-id="d2e71-110">If you choose toouse Azure Active Directory preauthentication, then only authenticated connections can access your network.</span></span>

<span data-ttu-id="d2e71-111">El Proxy de aplicación de Azure AD se basa en hello Azure AD token servicio seguridad (STS) para toda la autenticación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-111">Azure AD Application Proxy relies on hello Azure AD security token service (STS) for all authentication.</span></span>  <span data-ttu-id="d2e71-112">Autenticación previa, por su propia naturaleza, bloquea un número significativo de ataques anónimos, porque solo identidades autenticadas pueden tener acceso a la aplicación de back-end de hello.</span><span class="sxs-lookup"><span data-stu-id="d2e71-112">Preauthentication, by its very nature, blocks a significant number of anonymous attacks, because only authenticated identities can access hello back-end application.</span></span>

<span data-ttu-id="d2e71-113">Si elige el acceso directo como método de autenticación previa, no disfruta de esta ventaja.</span><span class="sxs-lookup"><span data-stu-id="d2e71-113">If you choose Passthrough as your preauthentication method, you don't get this benefit.</span></span> 

### <a name="conditional-access"></a><span data-ttu-id="d2e71-114">Acceso condicional</span><span class="sxs-lookup"><span data-stu-id="d2e71-114">Conditional access</span></span>

<span data-ttu-id="d2e71-115">Aplicar controles de directiva más completos antes de que las conexiones se establecen tooyour red.</span><span class="sxs-lookup"><span data-stu-id="d2e71-115">Apply richer policy controls before connections tooyour network are established.</span></span>

<span data-ttu-id="d2e71-116">Con [acceso condicional](active-directory-conditional-access-azuread-connected-apps.md), puede definir restricciones en el tráfico que permitían tooaccess las aplicaciones de back-end.</span><span class="sxs-lookup"><span data-stu-id="d2e71-116">With [conditional access](active-directory-conditional-access-azuread-connected-apps.md), you can define restrictions on what traffic is allowed tooaccess your back-end applications.</span></span> <span data-ttu-id="d2e71-117">Puede crear directivas que restrinjan los inicios de sesión en función de la ubicación, el nivel de autenticación y el perfil de riesgo del usuario.</span><span class="sxs-lookup"><span data-stu-id="d2e71-117">You can create policies that restrict sign-ins based on location, strength of authentication, and user risk profile.</span></span>

<span data-ttu-id="d2e71-118">También puede utilizar directivas de acceso condicional tooconfigure la autenticación multifactor, agregar otra capa de autenticaciones de usuario de seguridad tooyour.</span><span class="sxs-lookup"><span data-stu-id="d2e71-118">You can also use conditional access tooconfigure Multi-Factor Authentication policies, adding another layer of security tooyour user authentications.</span></span> 

### <a name="traffic-termination"></a><span data-ttu-id="d2e71-119">Terminación del tráfico</span><span class="sxs-lookup"><span data-stu-id="d2e71-119">Traffic termination</span></span>

<span data-ttu-id="d2e71-120">Todo el tráfico se termina en la nube de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-120">All traffic is terminated in hello cloud.</span></span>

<span data-ttu-id="d2e71-121">Dado que el Proxy de aplicación de Azure AD es un servidor proxy inverso, todas las aplicaciones de servidor tooback de tráfico se termina en el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-121">Because Azure AD Application Proxy is a reverse-proxy, all traffic tooback-end applications is terminated at hello service.</span></span> <span data-ttu-id="d2e71-122">Hello puede obtener restablece sesión solo con el servidor de back-end de hello, lo que significa que los servidores back-end no están expuestos tráfico toodirect HTTP.</span><span class="sxs-lookup"><span data-stu-id="d2e71-122">hello session can get reestablished only with hello back-end server, which means that your back-end servers are not exposed toodirect HTTP traffic.</span></span> <span data-ttu-id="d2e71-123">Esta configuración implica que está mejor protegido frente a ataques dirigidos.</span><span class="sxs-lookup"><span data-stu-id="d2e71-123">This configuration means that you are better protected from targeted attacks.</span></span>

### <a name="all-access-is-outbound"></a><span data-ttu-id="d2e71-124">Todo el acceso es de salida.</span><span class="sxs-lookup"><span data-stu-id="d2e71-124">All access is outbound</span></span> 

<span data-ttu-id="d2e71-125">Red corporativa de tooopen las conexiones entrantes toohello no es necesario.</span><span class="sxs-lookup"><span data-stu-id="d2e71-125">You don't need tooopen inbound connections toohello corporate network.</span></span>

<span data-ttu-id="d2e71-126">Conectores de Proxy de aplicación sólo utilizan servicio de Proxy de aplicación de Azure AD toohello las conexiones salientes, lo que significa que no hay tooopen puertos del firewall para las conexiones entrantes.</span><span class="sxs-lookup"><span data-stu-id="d2e71-126">Application Proxy connectors only use outbound connections toohello Azure AD Application Proxy service, which means that there is no need tooopen firewall ports for incoming connections.</span></span> <span data-ttu-id="d2e71-127">Servidores proxy tradicional requiere una red perimetral (también conocido como *DMZ*, *zona desmilitarizada*, o *subred filtrada*) y permite el acceso toounauthenticated conexiones en el perímetro de la red de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-127">Traditional proxies required a perimeter network (also known as *DMZ*, *demilitarized zone*, or *screened subnet*) and allowed access toounauthenticated connections at hello network edge.</span></span> <span data-ttu-id="d2e71-128">Este escenario se requiere muchos inversión adicional en la aplicación web tráfico tooanalyze de productos de firewall y ofrece suma protecciones toohello entorno.</span><span class="sxs-lookup"><span data-stu-id="d2e71-128">This scenario required many additional investments in web application firewall products tooanalyze traffic and offer addition protections toohello environment.</span></span> <span data-ttu-id="d2e71-129">Con Proxy de aplicación no se necesita una red perimetral, ya que todas las conexiones son de salida y tienen lugar a través de un canal seguro.</span><span class="sxs-lookup"><span data-stu-id="d2e71-129">With Application Proxy, you don't need a perimeter network because all connections are outbound and take place over a secure channel.</span></span>

<span data-ttu-id="d2e71-130">Para más información sobre los conectores, consulte [Descripción de los conectores del Proxy de aplicación de Azure AD](application-proxy-understand-connectors.md).</span><span class="sxs-lookup"><span data-stu-id="d2e71-130">For more information about connectors, see [Understand Azure AD Application Proxy connectors](application-proxy-understand-connectors.md).</span></span>

### <a name="cloud-scale-analytics-and-machine-learning"></a><span data-ttu-id="d2e71-131">Análisis de escala en la nube y aprendizaje automático</span><span class="sxs-lookup"><span data-stu-id="d2e71-131">Cloud-scale analytics and machine learning</span></span> 

<span data-ttu-id="d2e71-132">Obtenga una protección de seguridad avanzada.</span><span class="sxs-lookup"><span data-stu-id="d2e71-132">Get cutting-edge security protection.</span></span>

<span data-ttu-id="d2e71-133">Dado que forma parte de Azure Active Directory, puede aprovechar el Proxy de aplicación [Azure AD Identity Protection](active-directory-identityprotection.md), con intelligence controladas por el aprendizaje de máquina y los datos de Microsoft Security Response Center hello y unidad de crímenes digitales.</span><span class="sxs-lookup"><span data-stu-id="d2e71-133">Because it's part of Azure Active Directory, Application Proxy can leverage [Azure AD Identity Protection](active-directory-identityprotection.md), with machine learning-driven intelligence and data from hello Microsoft Security Response Center and Digital Crimes Unit.</span></span> <span data-ttu-id="d2e71-134">Juntos identificamos de manera proactiva las cuentas en peligro y ofrecemos protección en tiempo real frente a inicios de sesión de alto riesgo. Tomamos en consideración diversos factores, como el acceso desde dispositivos infectados y a través de redes anónimas, y desde ubicaciones atípicas y poco probables.</span><span class="sxs-lookup"><span data-stu-id="d2e71-134">Together we proactively identify compromised accounts and offer real-time protection from high-risk sign-ins. We take into account numerous factors, such as access from infected devices, through anonymizing networks, and from atypical and unlikely locations.</span></span>

<span data-ttu-id="d2e71-135">Muchos de estos informes y eventos ya están disponibles a través de una API para la integración con los sistemas de información de seguridad y administración de eventos (SIEM).</span><span class="sxs-lookup"><span data-stu-id="d2e71-135">Many of these reports and events are already available through an API for integration with your security information and event management (SIEM) systems.</span></span>

### <a name="remote-access-as-a-service"></a><span data-ttu-id="d2e71-136">Acceso remoto en forma de servicio</span><span class="sxs-lookup"><span data-stu-id="d2e71-136">Remote access as a service</span></span>

<span data-ttu-id="d2e71-137">No es necesario tooworry sobre cómo mantener y servidores locales de la aplicación de revisiones.</span><span class="sxs-lookup"><span data-stu-id="d2e71-137">You don’t have tooworry about maintaining and patching on-premises servers.</span></span>

<span data-ttu-id="d2e71-138">El software al que no se aplican revisiones sigue siendo objeto de un gran número de ataques.</span><span class="sxs-lookup"><span data-stu-id="d2e71-138">Unpatched software still accounts for a large number of attacks.</span></span> <span data-ttu-id="d2e71-139">El Proxy de aplicación de Azure AD es un servicio de escala de Internet que es propietario de Microsoft, por lo que siempre obtendrá las actualizaciones y revisiones de seguridad más recientes de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-139">Azure AD Application Proxy is an Internet-scale service that Microsoft owns, so you always get hello latest security patches and upgrades.</span></span>

<span data-ttu-id="d2e71-140">seguridad de hello tooimprove de aplicaciones publicadas por el Proxy de aplicación de Azure AD, se bloquea robots de rastreador (crawler) web de indización y el archivado de sus aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d2e71-140">tooimprove hello security of applications published by Azure AD Application Proxy, we block web crawler robots from indexing and archiving your applications.</span></span> <span data-ttu-id="d2e71-141">Cada vez que un robot de agente de búsqueda intenta recuperar la configuración del robot de una aplicación publicada, el Proxy de aplicación responde con un archivo robots.txt que incluye `User-agent: * Disallow: /`.</span><span class="sxs-lookup"><span data-stu-id="d2e71-141">Each time a web crawler robot tries to retrieve the robot's settings for a published app, Application Proxy replies with a robots.txt file that includes `User-agent: * Disallow: /`.</span></span>

## <a name="under-hello-hood"></a><span data-ttu-id="d2e71-142">Bajo el paraguas de Hola</span><span class="sxs-lookup"><span data-stu-id="d2e71-142">Under hello hood</span></span>

<span data-ttu-id="d2e71-143">El Proxy de aplicación de Azure AD consta de dos partes:</span><span class="sxs-lookup"><span data-stu-id="d2e71-143">Azure AD Application Proxy consists of two parts:</span></span>

* <span data-ttu-id="d2e71-144">Hola servicio en la nube: este servicio se ejecuta en Azure y es donde se realizan las conexiones de cliente o usuario externo Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-144">hello cloud-based service: This service runs in Azure, and is where hello external client/user connections are made.</span></span>
* <span data-ttu-id="d2e71-145">[Hola conector local](application-proxy-understand-connectors.md): un componente local, el conector de hello escucha las solicitudes de servicio de Proxy de aplicación hello Azure AD y administra aplicaciones internas de las conexiones toohello.</span><span class="sxs-lookup"><span data-stu-id="d2e71-145">[hello on-premises connector](application-proxy-understand-connectors.md): An on-premises component, hello connector listens for requests from hello Azure AD Application Proxy service and handles connections toohello internal applications.</span></span> 

<span data-ttu-id="d2e71-146">Se establece un flujo entre el conector de Hola y el servicio de Proxy de aplicación Hola cuando:</span><span class="sxs-lookup"><span data-stu-id="d2e71-146">A flow between hello connector and hello Application Proxy service is established when:</span></span>

* <span data-ttu-id="d2e71-147">en primer lugar se configura el conector de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-147">hello connector is first set up.</span></span>
* <span data-ttu-id="d2e71-148">Conector de Hello extrae información de configuración de servicio de Proxy de aplicación Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-148">hello connector pulls configuration information from hello Application Proxy service.</span></span>
* <span data-ttu-id="d2e71-149">Un usuario tiene acceso a una aplicación publicada.</span><span class="sxs-lookup"><span data-stu-id="d2e71-149">A user accesses a published application.</span></span>

>[!NOTE]
><span data-ttu-id="d2e71-150">Todas las comunicaciones se producen a través de SSL, y siempre se originan en hello conector toohello servicio Proxy de aplicación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-150">All communications occur over SSL, and they always originate at hello connector toohello Application Proxy service.</span></span> <span data-ttu-id="d2e71-151">servicio de Hello sólo es de salida.</span><span class="sxs-lookup"><span data-stu-id="d2e71-151">hello service is outbound only.</span></span>

<span data-ttu-id="d2e71-152">Conector de Hello usa un toohello tooauthenticate de certificado de cliente servicio de Proxy de aplicación para casi todas las llamadas.</span><span class="sxs-lookup"><span data-stu-id="d2e71-152">hello connector uses a client certificate tooauthenticate toohello Application Proxy service for nearly all calls.</span></span> <span data-ttu-id="d2e71-153">Hello solo excepción toothis proceso es paso de la instalación inicial de hello, donde se establece el certificado de cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-153">hello only exception toothis process is hello initial setup step, where hello client certificate is established.</span></span>

### <a name="installing-hello-connector"></a><span data-ttu-id="d2e71-154">Instalar el conector de Hola</span><span class="sxs-lookup"><span data-stu-id="d2e71-154">Installing hello connector</span></span>

<span data-ttu-id="d2e71-155">Cuando primero se instala el conector de hello, Hola después de eventos de flujo tienen lugar:</span><span class="sxs-lookup"><span data-stu-id="d2e71-155">When hello connector is first set up, hello following flow events take place:</span></span>

1. <span data-ttu-id="d2e71-156">servicio de toohello de registro de Hello conector ocurre como parte de hello instalación del conector de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-156">hello connector registration toohello service happens as part of hello installation of hello connector.</span></span> <span data-ttu-id="d2e71-157">Los usuarios es tooenter solicitada sus credenciales de administrador de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d2e71-157">Users are prompted tooenter their Azure AD admin credentials.</span></span> <span data-ttu-id="d2e71-158">El token obtenido desde esta autenticación, a continuación, se presenta el servicio de Proxy de aplicación de Azure AD toohello.</span><span class="sxs-lookup"><span data-stu-id="d2e71-158">The token acquired from this authentication is then presented toohello Azure AD Application Proxy service.</span></span>
2. <span data-ttu-id="d2e71-159">Hola servicio Proxy de aplicación se evalúa como token Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-159">hello Application Proxy service evaluates hello token.</span></span> <span data-ttu-id="d2e71-160">Garantiza que el usuario Hola sea un administrador de la compañía dentro de inquilino de Hola Hola token haya sido emitido para.</span><span class="sxs-lookup"><span data-stu-id="d2e71-160">It ensures that hello user is a company administrator within hello tenant that hello token was issued for.</span></span> <span data-ttu-id="d2e71-161">Si el usuario de hello no es un administrador, se finaliza el proceso de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-161">If hello user is not an administrator, hello process is terminated.</span></span>
3. <span data-ttu-id="d2e71-162">Conector de Hello genera una solicitud de certificado de cliente y lo pasa, junto con hello toohello de token, el servicio de Proxy de aplicación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-162">hello connector generates a client certificate request and passes it, along with hello token, toohello Application Proxy service.</span></span> <span data-ttu-id="d2e71-163">servicio de Hola a su vez comprueba el token de Hola y firma la solicitud de certificado de cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-163">hello service in turn verifies hello token and signs hello client certificate request.</span></span>
4. <span data-ttu-id="d2e71-164">Conector de Hello usa certificados de cliente de hello para la comunicación posterior con hello servicio Proxy de aplicación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-164">hello connector uses hello client certificate for future communication with hello Application Proxy service.</span></span>
5. <span data-ttu-id="d2e71-165">Conector de Hello lleva a cabo una extracción de datos de configuración de sistema de saludo inicial del servicio de hello usando su certificado de cliente y estará listo tootake solicitudes.</span><span class="sxs-lookup"><span data-stu-id="d2e71-165">hello connector performs an initial pull of hello system configuration data from hello service using its client certificate, and it is now ready tootake requests.</span></span>

### <a name="updating-hello-configuration-settings"></a><span data-ttu-id="d2e71-166">Actualizar valores de configuración de Hola</span><span class="sxs-lookup"><span data-stu-id="d2e71-166">Updating hello configuration settings</span></span>

<span data-ttu-id="d2e71-167">Cada vez que Hola servicio Proxy de aplicación actualiza la configuración de hello, Hola después de eventos de flujo tienen lugar:</span><span class="sxs-lookup"><span data-stu-id="d2e71-167">Whenever hello Application Proxy service updates hello configuration settings, hello following flow events take place:</span></span>

1. <span data-ttu-id="d2e71-168">Conector de Hello conecta toohello extremo de configuración dentro de hello servicio Proxy de aplicación mediante su certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="d2e71-168">hello connector connects toohello configuration endpoint within hello Application Proxy service by using its client certificate.</span></span>
2. <span data-ttu-id="d2e71-169">Una vez que se validó el certificado de cliente de hello, Hola servicio Proxy de aplicación devuelve toohello conector de datos de configuración (por ejemplo, grupo de conectores de Hola que Hola conector debe formar parte de).</span><span class="sxs-lookup"><span data-stu-id="d2e71-169">After hello client certificate has been validated, hello Application Proxy service returns configuration data toohello connector (for example, hello connector group that hello connector should be part of).</span></span>
3. <span data-ttu-id="d2e71-170">Si el certificado actual de hello es más de 180 días de antigüedad, conector Hola genera una nueva solicitud de certificado, que actualiza eficazmente certificado de cliente de hello cada 180 días.</span><span class="sxs-lookup"><span data-stu-id="d2e71-170">If hello current certificate is more than 180 days old, hello connector generates a new certificate request, which effectively updates hello client certificate every 180 days.</span></span>

### <a name="accessing-published-applications"></a><span data-ttu-id="d2e71-171">Acceso a aplicaciones publicadas</span><span class="sxs-lookup"><span data-stu-id="d2e71-171">Accessing published applications</span></span>

<span data-ttu-id="d2e71-172">Cuando los usuarios tienen acceso a una aplicación publicada, hello siguientes eventos tienen lugar entre el servicio de Proxy de aplicación Hola y el conector del Proxy de aplicación de hello:</span><span class="sxs-lookup"><span data-stu-id="d2e71-172">When users access a published application, hello following events take place between hello Application Proxy service and hello Application Proxy connector:</span></span>

1. [<span data-ttu-id="d2e71-173">servicio de Hello autentica al usuario Hola aplicación hello</span><span class="sxs-lookup"><span data-stu-id="d2e71-173">hello service authenticates hello user for hello app</span></span>](#the-service-checks-the-configuration-settings-for-the-app)
2. [<span data-ttu-id="d2e71-174">servicio de Hello realiza una solicitud en cola del conector Hola</span><span class="sxs-lookup"><span data-stu-id="d2e71-174">hello service places a request in hello connector queue</span></span>](#The-service-places-a-request-in-the-connector-queue)
3. [<span data-ttu-id="d2e71-175">Un conector procesa la solicitud de Hola de cola de Hola</span><span class="sxs-lookup"><span data-stu-id="d2e71-175">A connector processes hello request from hello queue</span></span>](#the-connector-receives-the-request-from-the-queue)
4. [<span data-ttu-id="d2e71-176">Conector de Hello esperará una respuesta</span><span class="sxs-lookup"><span data-stu-id="d2e71-176">hello connector waits for a response</span></span>](#the-connector-waits-for-a-response)
5. [<span data-ttu-id="d2e71-177">Hola secuencias datos toohello usuario</span><span class="sxs-lookup"><span data-stu-id="d2e71-177">hello service streams data toohello user</span></span>](#the-service-streams-data-to-the-user)

<span data-ttu-id="d2e71-178">sigan leyendo toolearn más información acerca de lo que tiene lugar en cada uno de estos pasos.</span><span class="sxs-lookup"><span data-stu-id="d2e71-178">toolearn more about what takes place in each of these steps, keep reading.</span></span>


#### <a name="1-hello-service-authenticates-hello-user-for-hello-app"></a><span data-ttu-id="d2e71-179">1. servicio de Hola autentica el usuario de hello para la aplicación hello</span><span class="sxs-lookup"><span data-stu-id="d2e71-179">1. hello service authenticates hello user for hello app</span></span>

<span data-ttu-id="d2e71-180">Si configuró Hola aplicación toouse acceso directo como su método de autenticación previa, se omiten los pasos de hello en esta sección.</span><span class="sxs-lookup"><span data-stu-id="d2e71-180">If you configured hello app toouse Passthrough as its preauthentication method, hello steps in this section are skipped.</span></span>

<span data-ttu-id="d2e71-181">Si configuró Hola aplicación toopreauthenticate con Azure AD, los usuarios son redirigido toohello tooauthenticate de STS de Azure AD y hello pasos siguientes tienen lugar:</span><span class="sxs-lookup"><span data-stu-id="d2e71-181">If you configured hello app toopreauthenticate with Azure AD, users are redirected toohello Azure AD STS tooauthenticate, and hello following steps take place:</span></span>

1. <span data-ttu-id="d2e71-182">Proxy de aplicación comprueba los requisitos de la directiva de acceso condicional para aplicaciones específicas de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-182">Application Proxy checks for any conditional access policy requirements for hello specific application.</span></span> <span data-ttu-id="d2e71-183">Este paso garantiza que se ha asignado a ese usuario de hello toohello aplicación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-183">This step ensures that hello user has been assigned toohello application.</span></span> <span data-ttu-id="d2e71-184">Si se requiere la verificación en dos pasos, secuencia de autenticación de hello pide a usuario Hola un segundo método de autenticación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-184">If two-step verification is required, hello authentication sequence prompts hello user for a second authentication method.</span></span>

2. <span data-ttu-id="d2e71-185">Una vez que han pasado todas las comprobaciones, Hola STS en Azure AD emite un token firmado para la aplicación hello y redirecciones Hola usuario espera toohello servicio Proxy de aplicación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-185">After all checks have passed, hello Azure AD STS issues a signed token for hello application and redirects hello user back toohello Application Proxy service.</span></span>

3. <span data-ttu-id="d2e71-186">Proxy de aplicación comprueba que ese token Hola se emitió la aplicación de hello toocorrect.</span><span class="sxs-lookup"><span data-stu-id="d2e71-186">Application Proxy verifies that hello token was issued toocorrect hello application.</span></span> <span data-ttu-id="d2e71-187">También realiza comprobaciones de otros, como asegurarse de esa Hola token se firmó con Azure AD y que esté aún dentro de ventana válido de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-187">It performs other checks also, such as ensuring that hello token was signed by Azure AD, and that it is still within hello valid window.</span></span>

4. <span data-ttu-id="d2e71-188">Proxy de aplicación establece una tooindicate de cookie de autenticación cifrada que se ha producido la aplicación de toohello de autenticación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-188">Application Proxy sets an encrypted authentication cookie tooindicate that authentication toohello application has occurred.</span></span> <span data-ttu-id="d2e71-189">Hello cookie incluye una marca de tiempo de expiración que se basa en el token de Hola de Azure AD y otros datos, tales como nombre de usuario de Hola Hola autenticación se basa en.</span><span class="sxs-lookup"><span data-stu-id="d2e71-189">hello cookie includes an expiration timestamp that's based on hello token from Azure AD and other data, such as hello user name that hello authentication is based on.</span></span> <span data-ttu-id="d2e71-190">Hola cookie se cifra con una clave privada que se conoce solo toohello servicio Proxy de aplicación.</span><span class="sxs-lookup"><span data-stu-id="d2e71-190">hello cookie is encrypted with a private key known only toohello Application Proxy service.</span></span>

5. <span data-ttu-id="d2e71-191">Aplicación Proxy redirecciones Hola usuario espera toohello la dirección URL solicitada originalmente.</span><span class="sxs-lookup"><span data-stu-id="d2e71-191">Application Proxy redirects hello user back toohello originally requested URL.</span></span>

<span data-ttu-id="d2e71-192">Si se produce un error en cualquier parte de los pasos de autenticación previa de hello, se deniega la solicitud del usuario de Hola y usuario Hola se muestra un mensaje que indica el origen de Hola de problema de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-192">If any part of hello preauthentication steps fails, hello user’s request is denied, and hello user is shown a message indicating hello source of hello problem.</span></span>


#### <a name="2-hello-service-places-a-request-in-hello-connector-queue"></a><span data-ttu-id="d2e71-193">2. servicio de Hola realiza una solicitud en cola del conector Hola</span><span class="sxs-lookup"><span data-stu-id="d2e71-193">2. hello service places a request in hello connector queue</span></span>

<span data-ttu-id="d2e71-194">Conectores de mantener un servicio Proxy de aplicación de toohello Abrir conexión saliente.</span><span class="sxs-lookup"><span data-stu-id="d2e71-194">Connectors keep an outbound connection open toohello Application Proxy service.</span></span> <span data-ttu-id="d2e71-195">Cuando llega una solicitud, servicio de hello pone en cola solicitud hello en una de las conexiones abiertas de Hola para hello conector toopick seguridad.</span><span class="sxs-lookup"><span data-stu-id="d2e71-195">When a request comes in, hello service queues up hello request on one of hello open connections for hello connector toopick up.</span></span>

<span data-ttu-id="d2e71-196">solicitud de Hello incluye elementos de la aplicación hello, como los encabezados de solicitud de hello, datos de la cookie de hello cifrado, Hola usuario realizando la solicitud de Hola y Hola identificador de solicitud</span><span class="sxs-lookup"><span data-stu-id="d2e71-196">hello request includes items from hello application, such as hello request headers, data from hello encrypted cookie, hello user making hello request, and hello request ID.</span></span> <span data-ttu-id="d2e71-197">Aunque los datos de cookie cifrada Hola se envían con solicitud de hello, propia cookie de autenticación hello no lo es.</span><span class="sxs-lookup"><span data-stu-id="d2e71-197">Although data from hello encrypted cookie is sent with hello request, hello authentication cookie itself is not.</span></span>

#### <a name="3-hello-connector-processes-hello-request-from-hello-queue"></a><span data-ttu-id="d2e71-198">3. conector de Hola procesa la solicitud de Hola de cola de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-198">3. hello connector processes hello request from hello queue.</span></span> 

<span data-ttu-id="d2e71-199">En función de la solicitud de hello, Proxy de aplicación realiza una de hello siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="d2e71-199">Based on hello request, Application Proxy performs one of hello following actions:</span></span>

* <span data-ttu-id="d2e71-200">Si la solicitud de hello es una operación sencilla (por ejemplo, no hay ningún dato dentro del cuerpo de hello con un RESTful *obtener* solicitud), el conector de hello, un recurso interno del destino de conexión toohello y, a continuación, espera una respuesta.</span><span class="sxs-lookup"><span data-stu-id="d2e71-200">If hello request is a simple operation (for example, there is no data within hello body as is with a RESTful *GET* request), hello connector makes a connection toohello target internal resource and then waits for a response.</span></span>

* <span data-ttu-id="d2e71-201">Si solicitud hello tiene datos asociados a él en el cuerpo de hello (por ejemplo, un RESTful *POST* operación), conector Hola hace una conexión de salida mediante la instancia de Proxy de aplicación de toohello del certificado de cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="d2e71-201">If hello request has data associated with it in hello body (for example, a RESTful *POST* operation), hello connector makes an outbound connection by using hello client certificate toohello Application Proxy instance.</span></span> <span data-ttu-id="d2e71-202">Hace que estos datos de conexión toorequest hello y abrir un recurso interno de toohello de conexión.</span><span class="sxs-lookup"><span data-stu-id="d2e71-202">It makes this connection toorequest hello data and open a connection toohello internal resource.</span></span> <span data-ttu-id="d2e71-203">Después de recibir la solicitud de Hola de conector de hello, servicio de Proxy de aplicación Hola comienza a aceptar el contenido de usuario de Hola y reenvía el conector de toohello de datos.</span><span class="sxs-lookup"><span data-stu-id="d2e71-203">After it receives hello request from hello connector, hello Application Proxy service begins accepting content from hello user and forwards data toohello connector.</span></span> <span data-ttu-id="d2e71-204">Conector de Hello, reenvía a su vez, recursos internos de hello datos toohello.</span><span class="sxs-lookup"><span data-stu-id="d2e71-204">hello connector, in turn, forwards hello data toohello internal resource.</span></span>

#### <a name="4-hello-connector-waits-for-a-response"></a><span data-ttu-id="d2e71-205">4. conector de Hola esperará una respuesta.</span><span class="sxs-lookup"><span data-stu-id="d2e71-205">4. hello connector waits for a response.</span></span>

<span data-ttu-id="d2e71-206">Una vez que la solicitud de Hola y transmisión de toohello todo el contenido final es completando, conector Hola esperará una respuesta.</span><span class="sxs-lookup"><span data-stu-id="d2e71-206">After hello request and transmission of all content toohello back end is complete, hello connector waits for a response.</span></span>

<span data-ttu-id="d2e71-207">Después de recibir una respuesta, conector Hola hace que un servicio de Proxy de aplicación de conexión de salida toohello, tooreturn Hola detalles del encabezado y empezar a transmitir datos de valor devuelto de saludo.</span><span class="sxs-lookup"><span data-stu-id="d2e71-207">After it receives a response, hello connector makes an outbound connection toohello Application Proxy service, tooreturn hello header details and begin streaming hello return data.</span></span>

#### <a name="5-hello-service-streams-data-toohello-user"></a><span data-ttu-id="d2e71-208">5. Hola servicio secuencias datos toohello el usuario.</span><span class="sxs-lookup"><span data-stu-id="d2e71-208">5. hello service streams data toohello user.</span></span> 

<span data-ttu-id="d2e71-209">Algún procesamiento de la aplicación hello puede producirse aquí.</span><span class="sxs-lookup"><span data-stu-id="d2e71-209">Some processing of hello application may occur here.</span></span> <span data-ttu-id="d2e71-210">Si configuró las direcciones URL o encabezados de tootranslate de Proxy de aplicación en la aplicación, que el procesamiento se produce según sea necesario durante este paso.</span><span class="sxs-lookup"><span data-stu-id="d2e71-210">If you configured Application Proxy tootranslate headers or URLs in your application, that processing happens as needed during this step.</span></span>


## <a name="next-steps"></a><span data-ttu-id="d2e71-211">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="d2e71-211">Next steps</span></span>

[<span data-ttu-id="d2e71-212">Consideraciones sobre la topología de red al usar el Proxy de aplicación de Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d2e71-212">Network topology considerations when using Azure AD Application Proxy</span></span>](application-proxy-network-topology-considerations.md)

[<span data-ttu-id="d2e71-213">Descripción de los conectores del Proxy de aplicación de Azure AD</span><span class="sxs-lookup"><span data-stu-id="d2e71-213">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
