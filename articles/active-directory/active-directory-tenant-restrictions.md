---
title: "Administración del acceso a aplicaciones en la nube mediante la restricción de inquilinos - Azure | Microsoft Docs"
description: "Uso de Restricciones de inquilino para administrar los usuarios que pueden acceder a las aplicaciones según su inquilino de Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
editor: yossib
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: kgremban
ms.openlocfilehash: 7288f8fa173f8018570cd17aa7274f56a4eead41
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="use-tenant-restrictions-to-manage-access-to-saas-cloud-applications"></a><span data-ttu-id="cbd77-103">Uso de Restricciones de inquilino para administrar el acceso a aplicaciones en la nube SaaS</span><span class="sxs-lookup"><span data-stu-id="cbd77-103">Use Tenant Restrictions to manage access to SaaS cloud applications</span></span>

<span data-ttu-id="cbd77-104">Las organizaciones grandes que hacen hincapié en la seguridad desean moverse a servicios en la nube como Office 365 pero deben saber que sus usuarios solo podrán acceder a recursos aprobados.</span><span class="sxs-lookup"><span data-stu-id="cbd77-104">Large organizations that emphasize security want to move to cloud services like Office 365, but need to know that their users only can access approved resources.</span></span> <span data-ttu-id="cbd77-105">Tradicionalmente, las empresas restringen los nombres de dominio o las direcciones IP cuando desean administrar el acceso.</span><span class="sxs-lookup"><span data-stu-id="cbd77-105">Traditionally, companies restrict domain names or IP addresses when they want to manage access.</span></span> <span data-ttu-id="cbd77-106">Este enfoque no sirve en un mundo donde las aplicaciones SaaS se hospedan en una nube pública, ejecutándose en nombres de dominio compartidos como outlook.office.com y login.microsoftonline.com.</span><span class="sxs-lookup"><span data-stu-id="cbd77-106">This approach fails in a world where SaaS apps are hosted in a public cloud, running on shared domain names like outlook.office.com and login.microsoftonline.com.</span></span> <span data-ttu-id="cbd77-107">El bloqueo de estas direcciones evitaría por completo que los usuarios accedieran a Outlook en la web, en lugar de simplemente limitarlos a identidades y recursos aprobados.</span><span class="sxs-lookup"><span data-stu-id="cbd77-107">Blocking these addresses would keep users from accessing Outlook on the web entirely, instead of merely restricting them to approved identities and resources.</span></span>

<span data-ttu-id="cbd77-108">La solución de Azure Active Directory para este desafío es una característica denominada Restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-108">Azure Active Directory's solution to this challenge is a feature called Tenant Restrictions.</span></span> <span data-ttu-id="cbd77-109">Restricciones de inquilino permite a las organizaciones controlar el acceso a aplicaciones en la nube SaaS según el inquilino de Azure AD que usan las aplicaciones para el inicio de sesión único.</span><span class="sxs-lookup"><span data-stu-id="cbd77-109">Tenant Restrictions enables organizations to control access to SaaS cloud applications, based on the Azure AD tenant the applications use for single sign-on.</span></span> <span data-ttu-id="cbd77-110">Por ejemplo, puede que le interese permitir el acceso a aplicaciones de Office 365 de su organización y, al mismo tiempo, impedir el acceso a instancias de otras organizaciones de estas mismas aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="cbd77-110">For example, you may want to allow access to your organization’s Office 365 applications, while preventing access to other organizations’ instances of these same applications.</span></span>  

<span data-ttu-id="cbd77-111">Restricciones de inquilino ofrece a las organizaciones la posibilidad de especificar la lista de inquilinos a los que sus usuarios pueden acceder.</span><span class="sxs-lookup"><span data-stu-id="cbd77-111">Tenant Restrictions gives organizations the ability to specify the list of tenants that their users are permitted to access.</span></span> <span data-ttu-id="cbd77-112">Después, Azure AD solo concede el acceso a estos inquilinos con permiso.</span><span class="sxs-lookup"><span data-stu-id="cbd77-112">Azure AD then only grants access to these permitted tenants.</span></span>

<span data-ttu-id="cbd77-113">Este artículo se centra en Restricciones de inquilino para Office 365, pero la característica debe funcionar con cualquier aplicación en la nube SaaS que use protocolos de autenticación moderna con Azure AD para inicio de sesión único.</span><span class="sxs-lookup"><span data-stu-id="cbd77-113">This article focuses on Tenant Restrictions for Office 365, but the feature should work with any SaaS cloud app that uses modern authentication protocols with Azure AD for single sign-on.</span></span> <span data-ttu-id="cbd77-114">Si usa aplicaciones SaaS con un inquilino de Azure AD diferente al inquilino que usa Office 365, asegúrese de que todos los inquilinos necesarios tienen permiso.</span><span class="sxs-lookup"><span data-stu-id="cbd77-114">If you use SaaS apps with a different Azure AD tenant from the tenant used by Office 365, make sure that all required tenants are permitted.</span></span> <span data-ttu-id="cbd77-115">Para más información sobre aplicaciones en la nube SaaS, consulte [Active Directory Marketplace](https://azure.microsoft.com/en-us/marketplace/active-directory/).</span><span class="sxs-lookup"><span data-stu-id="cbd77-115">For more information about SaaS cloud apps, see the [Active Directory Marketplace](https://azure.microsoft.com/en-us/marketplace/active-directory/).</span></span>

## <a name="how-it-works"></a><span data-ttu-id="cbd77-116">Cómo funciona</span><span class="sxs-lookup"><span data-stu-id="cbd77-116">How it works</span></span>

<span data-ttu-id="cbd77-117">La solución general consta de los siguientes componentes:</span><span class="sxs-lookup"><span data-stu-id="cbd77-117">The overall solution comprises the following components:</span></span> 

1. <span data-ttu-id="cbd77-118">**Azure AD**: si `Restrict-Access-To-Tenants: <permitted tenant list>` está presente, Azure AD solo emite tokens de seguridad para los inquilinos permitidos.</span><span class="sxs-lookup"><span data-stu-id="cbd77-118">**Azure AD** – If the `Restrict-Access-To-Tenants: <permitted tenant list>` is present, Azure AD only issues security tokens for the permitted tenants.</span></span> 

2. <span data-ttu-id="cbd77-119">**Infraestructura de servidor proxy local**: un dispositivo proxy con funcionalidades de inspección SSL, configurado para insertar el encabezado que contiene la lista de inquilinos permitidos en el tráfico destinado a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="cbd77-119">**On-premises proxy server infrastructure** – a proxy device capable of SSL inspection, configured to insert the header containing the list of permitted tenants into traffic destined for Azure AD.</span></span> 

3. <span data-ttu-id="cbd77-120">**Software de cliente**: para admitir Restricciones de inquilino, el software de cliente debe solicitar tokens directamente de Azure AD, de forma que la infraestructura del proxy pueda interceptar el tráfico.</span><span class="sxs-lookup"><span data-stu-id="cbd77-120">**Client software** – to support Tenant Restrictions, client software must request tokens directly from Azure AD, so that traffic can be intercepted by the proxy infrastructure.</span></span> <span data-ttu-id="cbd77-121">Actualmente, cuando se utiliza autenticación moderna (como OAuth 2.0), tanto las aplicaciones de Office 365 basadas en explorador como los clientes de Office admiten Restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-121">Tenant Restrictions is currently supported by browser-based Office 365 applications and by Office clients when modern authentication (like OAuth 2.0) is used.</span></span> 

4. <span data-ttu-id="cbd77-122">**Autenticación moderna**: los servicios en la nube deben usar la autenticación moderna para utilizar Restricciones de inquilino y bloquear el acceso a todos los inquilinos no permitidos.</span><span class="sxs-lookup"><span data-stu-id="cbd77-122">**Modern Authentication** – cloud services must use modern authentication to use Tenant Restrictions and block access to all non-permitted tenants.</span></span> <span data-ttu-id="cbd77-123">Los servicios en la nube de Office 365 deben configurarse para usar protocolos de autenticación moderna de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="cbd77-123">Office 365 cloud services must be configured to use modern authentication protocols by default.</span></span> <span data-ttu-id="cbd77-124">Para ver la información más reciente sobre la compatibilidad con Office 365 para la autenticación moderna, lea [Updated Office 365 modern authentication](https://blogs.office.com/2015/11/19/updated-office-365-modern-authentication-public-preview/) (Autenticación moderna actualizada de Office 365).</span><span class="sxs-lookup"><span data-stu-id="cbd77-124">For the latest information on Office 365 support for modern authentication, read [Updated Office 365 modern authentication](https://blogs.office.com/2015/11/19/updated-office-365-modern-authentication-public-preview/).</span></span>

<span data-ttu-id="cbd77-125">En el siguiente diagrama se ilustra el flujo de tráfico de alto nivel.</span><span class="sxs-lookup"><span data-stu-id="cbd77-125">The following diagram illustrates the high-level traffic flow.</span></span> <span data-ttu-id="cbd77-126">La inspección SSL solo es necesaria en tráfico hacia Azure AD, no hacia los servicios en la nube de Office 365.</span><span class="sxs-lookup"><span data-stu-id="cbd77-126">SSL inspection is only required on traffic to Azure AD, not to the Office 365 cloud services.</span></span> <span data-ttu-id="cbd77-127">Esta distinción es importante porque el volumen de tráfico para autenticación hacia Azure AD es normalmente mucho menor que el volumen de tráfico hacia aplicaciones SaaS como Exchange Online y SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="cbd77-127">This distinction is important because the traffic volume for authentication to Azure AD is typically much lower than traffic volume to SaaS applications like Exchange Online and SharePoint Online.</span></span>

![Flujo de tráfico de Restricciones de inquilino: diagrama](./media/active-directory-tenant-restrictions/traffic-flow.png)

## <a name="set-up-tenant-restrictions"></a><span data-ttu-id="cbd77-129">Configuración de Restricciones de inquilino</span><span class="sxs-lookup"><span data-stu-id="cbd77-129">Set up Tenant Restrictions</span></span>

<span data-ttu-id="cbd77-130">Se deben realizar dos pasos para empezar a trabajar con Restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-130">There are two steps to get started with Tenant Restrictions.</span></span> <span data-ttu-id="cbd77-131">El primer paso es asegurarse de que los clientes pueden conectarse a las direcciones correctas.</span><span class="sxs-lookup"><span data-stu-id="cbd77-131">The first step is to make sure that your clients can connect to the right addresses.</span></span> <span data-ttu-id="cbd77-132">El segundo consiste en configurar la infraestructura del proxy.</span><span class="sxs-lookup"><span data-stu-id="cbd77-132">The second is to configure your proxy infrastructure.</span></span>

### <a name="urls-and-ip-addresses"></a><span data-ttu-id="cbd77-133">Direcciones URL e IP reservadas</span><span class="sxs-lookup"><span data-stu-id="cbd77-133">URLs and IP addresses</span></span>

<span data-ttu-id="cbd77-134">Para usar Restricciones de inquilino, los clientes deben ser capaces de conectarse a las siguientes direcciones URL de Azure AD para autenticarse: login.microsoftonline.com, login.microsoft.com y login.windows.net.</span><span class="sxs-lookup"><span data-stu-id="cbd77-134">To use Tenant Restrictions, your clients must be able to connect to the following Azure AD URLs to authenticate: login.microsoftonline.com, login.microsoft.com, and login.windows.net.</span></span> <span data-ttu-id="cbd77-135">Además, para acceder a Office 365, los clientes también deben ser capaces de conectarse a las direcciones URL o FQDN y a las direcciones IP definidas en [URL de Office 365 e intervalos de direcciones IP](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span><span class="sxs-lookup"><span data-stu-id="cbd77-135">Additionally, to access Office 365, your clients must also be able to connect to the FQDNs/URLs and IP addresses defined in [Office 365 URLs and IP address ranges](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span></span> 

### <a name="proxy-configuration-and-requirements"></a><span data-ttu-id="cbd77-136">Requisitos y configuración de proxy</span><span class="sxs-lookup"><span data-stu-id="cbd77-136">Proxy configuration and requirements</span></span>

<span data-ttu-id="cbd77-137">Se necesita la configuración siguiente para habilitar Restricciones de inquilino a través de la infraestructura del proxy.</span><span class="sxs-lookup"><span data-stu-id="cbd77-137">The following configuration is required to enable Tenant Restrictions through your proxy infrastructure.</span></span> <span data-ttu-id="cbd77-138">Esta guía es genérica, por lo que debe remitirse a la documentación del proveedor del proxy para conocer los pasos de implementación específicos.</span><span class="sxs-lookup"><span data-stu-id="cbd77-138">This guidance is generic, so you should refer to your proxy vendor’s documentation for specific implementation steps.</span></span>

#### <a name="prerequisites"></a><span data-ttu-id="cbd77-139">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="cbd77-139">Prerequisites</span></span>

- <span data-ttu-id="cbd77-140">El proxy debe ser capaz de realizar la intercepción de SSL y la inserción de encabezados HTTP, así como filtrar destinos mediante direcciones URL o FQDN.</span><span class="sxs-lookup"><span data-stu-id="cbd77-140">The proxy must be able to perform SSL interception, HTTP header insertion, and filter destinations using FQDNs/URLs.</span></span> 

- <span data-ttu-id="cbd77-141">Los clientes deben confiar en la cadena de certificados que presenta el proxy para las comunicaciones SSL.</span><span class="sxs-lookup"><span data-stu-id="cbd77-141">Clients must trust the certificate chain presented by the proxy for SSL communications.</span></span> <span data-ttu-id="cbd77-142">Por ejemplo, si se usan certificados de una PKI interna, el certificado de la entidad de certificación raíz emisora interna debe ser de confianza.</span><span class="sxs-lookup"><span data-stu-id="cbd77-142">For example, if certificates from an internal PKI are used, the internal issuing root certificate authority certificate must be trusted.</span></span>

- <span data-ttu-id="cbd77-143">Esta característica se incluye en las suscripciones de Office 365, pero si desea usar Restricciones de inquilino para controlar el acceso a otras aplicaciones SaaS, necesitará licencias de Azure AD Premium 1.</span><span class="sxs-lookup"><span data-stu-id="cbd77-143">This feature is included in Office 365 subscriptions, but if you want to use Tenant Restrictions to control access to other SaaS apps then Azure AD Premium 1 licenses are required.</span></span>

#### <a name="configuration"></a><span data-ttu-id="cbd77-144">Configuración</span><span class="sxs-lookup"><span data-stu-id="cbd77-144">Configuration</span></span>

<span data-ttu-id="cbd77-145">Para cada solicitud entrante para login.microsoftonline.com, login.microsoft.com y login.windows.net, inserte dos encabezados HTTP: *Restrict-Access-To-Tenants* y *Restrict-Access-Context*.</span><span class="sxs-lookup"><span data-stu-id="cbd77-145">For each incoming request to login.microsoftonline.com, login.microsoft.com, and login.windows.net, insert two HTTP headers: *Restrict-Access-To-Tenants* and *Restrict-Access-Context*.</span></span>

<span data-ttu-id="cbd77-146">Los encabezados deben incluir los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="cbd77-146">The headers should include the following elements:</span></span> 
- <span data-ttu-id="cbd77-147">Para *Restrict-Access-To-Tenants*, un valor de \<permitted tenant list\>, que es una lista separada por comas de los inquilinos a los que desea que los usuarios puedan acceder.</span><span class="sxs-lookup"><span data-stu-id="cbd77-147">For *Restrict-Access-To-Tenants*, a value of \<permitted tenant list\>, which is a comma-separated list of tenants you want to allow users to access.</span></span> <span data-ttu-id="cbd77-148">Se puede utilizar cualquier dominio que esté registrado con un inquilino para identificar al inquilino en esta lista.</span><span class="sxs-lookup"><span data-stu-id="cbd77-148">Any domain that is registered with a tenant can be used to identify the tenant in this list.</span></span> <span data-ttu-id="cbd77-149">Por ejemplo, para permitir el acceso a los inquilinos Contoso y Fabrikam, el par nombre-valor puede ser algo así como `Restrict-Access-To-Tenants: contoso.onmicrosoft.com,fabrikam.onmicrosoft.com`</span><span class="sxs-lookup"><span data-stu-id="cbd77-149">For example, to permit access to both Contoso and Fabrikam tenants, the name/value pair looks like:  `Restrict-Access-To-Tenants: contoso.onmicrosoft.com,fabrikam.onmicrosoft.com`</span></span> 
- <span data-ttu-id="cbd77-150">Para *Restrict-Access-Context*, un valor de un identificador de directorio único que declare qué inquilino está estableciendo Restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-150">For *Restrict-Access-Context*, a value of a single directory ID, declaring which tenant is setting the Tenant Restrictions.</span></span> <span data-ttu-id="cbd77-151">Por ejemplo, para declarar Contoso como el inquilino que establece la directiva de Restricciones de inquilino, el par nombre-valor puede ser algo así como `Restrict-Access-Context: 456ff232-35l2-5h23-b3b3-3236w0826f3d`</span><span class="sxs-lookup"><span data-stu-id="cbd77-151">For example, to declare Contoso as the tenant that set the Tenant Restrictions policy, the name/value pair looks like: `Restrict-Access-Context: 456ff232-35l2-5h23-b3b3-3236w0826f3d`</span></span>  

> [!TIP]
> <span data-ttu-id="cbd77-152">Puede encontrar el identificador de directorio en [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="cbd77-152">You can find your directory ID in the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="cbd77-153">Inicie sesión como administrador, seleccione **Azure Active Directory** y luego seleccione **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="cbd77-153">Sign in as an administrator, select **Azure Active Directory**, then select **Properties**.</span></span>

<span data-ttu-id="cbd77-154">Para evitar que los usuarios inserten su propio encabezado HTTP con inquilinos no aprobados, el proxy debe reemplazar el encabezado Restrict-Access-To-Tenants si ya está presente en la solicitud entrante.</span><span class="sxs-lookup"><span data-stu-id="cbd77-154">To prevent users from inserting their own HTTP header with non-approved tenants, the proxy needs to replace the Restrict-Access-To-Tenants header if it is already present in the incoming request.</span></span> 

<span data-ttu-id="cbd77-155">Se debe exigir a los clientes que usen el proxy para todas las solicitudes para login.microsoftonline.com, login.microsoft.com y login.windows.net.</span><span class="sxs-lookup"><span data-stu-id="cbd77-155">Clients must be forced to use the proxy for all requests to login.microsoftonline.com, login.microsoft.com, and login.windows.net.</span></span> <span data-ttu-id="cbd77-156">Por ejemplo, si los archivos PAC se emplean para indicar a los clientes que usen el proxy, los usuarios finales no deben poder editar o deshabilitar los archivos PAC.</span><span class="sxs-lookup"><span data-stu-id="cbd77-156">For example, if PAC files are used to direct clients to use the proxy, end users should not be able to edit or disable the PAC files.</span></span>

## <a name="the-user-experience"></a><span data-ttu-id="cbd77-157">La experiencia del usuario final</span><span class="sxs-lookup"><span data-stu-id="cbd77-157">The user experience</span></span>

<span data-ttu-id="cbd77-158">En esta sección se muestra la experiencia de los usuarios finales y los administradores.</span><span class="sxs-lookup"><span data-stu-id="cbd77-158">This section shows the experience for both end users and admins.</span></span>

### <a name="end-user-experience"></a><span data-ttu-id="cbd77-159">Experiencia del usuario final</span><span class="sxs-lookup"><span data-stu-id="cbd77-159">End-user experience</span></span>

<span data-ttu-id="cbd77-160">Un usuario de ejemplo se encuentra en la red de Contoso, pero está intentando acceder a la instancia de Fabrikam de una aplicación SaaS compartida como Outlook en línea.</span><span class="sxs-lookup"><span data-stu-id="cbd77-160">An example user is on the Contoso network, but is trying to access the Fabrikam instance of a shared SaaS application like Outlook online.</span></span> <span data-ttu-id="cbd77-161">Si Contoso es un inquilino no permitido para esa instancia, el usuario ve la página siguiente:</span><span class="sxs-lookup"><span data-stu-id="cbd77-161">If Contoso is a non-permitted tenant for that instance, the user sees the following page:</span></span>

![Página de acceso denegado para usuarios en inquilinos no permitidos](./media/active-directory-tenant-restrictions/end-user-denied.png)

### <a name="admin-experience"></a><span data-ttu-id="cbd77-163">Experiencia del administrador</span><span class="sxs-lookup"><span data-stu-id="cbd77-163">Admin experience</span></span>

<span data-ttu-id="cbd77-164">Mientras la configuración de Restricciones de inquilino se realice en la infraestructura del proxy corporativo, los administradores podrán acceder a los informes de Restricciones de inquilino directamente en Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="cbd77-164">While configuration of Tenant Restrictions is done on the corporate proxy infrastructure, admins can access the Tenant Restrictions reports in the Azure portal directly.</span></span> <span data-ttu-id="cbd77-165">Para ver los informes, vaya a la página de introducción de Azure Active Directory y mire en "Otras funcionalidades".</span><span class="sxs-lookup"><span data-stu-id="cbd77-165">To view the reports, go to the Azure Active Directory Overview page, then look under ‘Other capabilities’.</span></span>

<span data-ttu-id="cbd77-166">El administrador del inquilino especificado como el inquilino Restricted-Access-Context puede usar este informe para ver todos los inicios de sesión bloqueados debido a la directiva de Restricciones de inquilino, incluida la identidad que se utiliza y el identificador de directorio de destino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-166">The admin for the tenant specified as the Restricted-Access-Context tenant can use this report to see all sign-ins blocked because of the Tenant Restrictions policy, including the identity used and the target directory ID.</span></span>

![Uso de Azure Portal para ver los intentos de inicio de sesión restringidos](./media/active-directory-tenant-restrictions/portal-report.png)

<span data-ttu-id="cbd77-168">Al igual que otros informes en Azure Portal, puede usar filtros para especificar el ámbito del informe.</span><span class="sxs-lookup"><span data-stu-id="cbd77-168">Like other reports in the Azure portal, you can use filters to specify the scope of your report.</span></span> <span data-ttu-id="cbd77-169">Puede filtrar por un usuario, una aplicación, un cliente o un intervalo de tiempo específico.</span><span class="sxs-lookup"><span data-stu-id="cbd77-169">You can filter on a specific user, application, client, or time interval.</span></span>

## <a name="office-365-support"></a><span data-ttu-id="cbd77-170">Compatibilidad con Office 365</span><span class="sxs-lookup"><span data-stu-id="cbd77-170">Office 365 support</span></span>

<span data-ttu-id="cbd77-171">Las aplicaciones de Office 365 deben cumplir dos criterios para que sean totalmente compatibles con Restricciones de inquilino:</span><span class="sxs-lookup"><span data-stu-id="cbd77-171">Office 365 applications must meet two criteria to fully support Tenant Restrictions:</span></span>

1. <span data-ttu-id="cbd77-172">El cliente utilizado admite la autenticación moderna</span><span class="sxs-lookup"><span data-stu-id="cbd77-172">The client used supports modern authentication</span></span>
2. <span data-ttu-id="cbd77-173">La autenticación moderna está habilitada como el protocolo de autenticación predeterminado para el servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="cbd77-173">Modern authentication is enabled as the default authentication protocol for the cloud service.</span></span>

<span data-ttu-id="cbd77-174">Consulte [Updated Office 365 modern authentication](https://blogs.office.com/2015/11/19/updated-office-365-modern-authentication-public-preview/) (Autenticación moderna actualizada de Office 365) para ver la información más reciente sobre qué clientes de Office admiten actualmente la autenticación moderna.</span><span class="sxs-lookup"><span data-stu-id="cbd77-174">Refer to [Updated Office 365 modern authentication](https://blogs.office.com/2015/11/19/updated-office-365-modern-authentication-public-preview/) for the latest information on which Office clients currently support modern authentication.</span></span> <span data-ttu-id="cbd77-175">Esa página también incluye vínculos a instrucciones para habilitar la autenticación moderna en inquilinos específicos de Exchange Online y Skype Empresarial Online.</span><span class="sxs-lookup"><span data-stu-id="cbd77-175">That page also includes links to instructions for enabling modern authentication on specific Exchange Online and Skype for Business Online tenants.</span></span> <span data-ttu-id="cbd77-176">La autenticación moderna ya está habilitada de forma predeterminada en SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="cbd77-176">Modern authentication is already enabled by default in SharePoint Online.</span></span>

<span data-ttu-id="cbd77-177">Actualmente, las aplicaciones de Office 365 basadas en explorador (portal de Office, Yammer, sitios de SharePoint, Outlook en la web, etc.) son compatibles con Restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-177">Tenant Restrictions is currently supported by Office 365 browser-based applications (the Office Portal, Yammer, SharePoint sites, Outlook on the Web, etc.).</span></span> <span data-ttu-id="cbd77-178">Para clientes gruesos (Outlook, Skype Empresarial, Word, Excel, PowerPoint, etc.), Restricciones de inquilinos solo se puede aplicar cuando se usa autenticación moderna.</span><span class="sxs-lookup"><span data-stu-id="cbd77-178">For thick clients (Outlook, Skype for Business, Word, Excel, PowerPoint, etc.) Tenant Restrictions can only be enforced when modern authentication is used.</span></span>  

<span data-ttu-id="cbd77-179">Los clientes de Outlook y Skype Empresarial que admiten autenticación moderna pueden seguir usando protocolos heredados en inquilinos donde la autenticación moderna no está habilitada, evitando eficazmente Restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-179">Outlook and Skype for Business clients that support modern authentication are still able to use legacy protocols against tenants where modern authentication is not enabled, effectively bypassing Tenant Restrictions.</span></span> <span data-ttu-id="cbd77-180">Para Outlook en Windows, los clientes pueden optar por implementar restricciones que impidan a los usuarios finales agregar cuentas de correo no aprobadas a sus perfiles.</span><span class="sxs-lookup"><span data-stu-id="cbd77-180">For Outlook on Windows, customers may choose to implement restrictions preventing end users from adding non-approved mail accounts to their profiles.</span></span> <span data-ttu-id="cbd77-181">Por ejemplo, vea el establecimiento de directiva de grupo [Prevent adding non-default Exchange accounts](http://gpsearch.azurewebsites.net/default.aspx?ref=1) (Impedir la incorporación de cuentas de Exchange no predeterminadas).</span><span class="sxs-lookup"><span data-stu-id="cbd77-181">For example, see the [Prevent adding non-default Exchange accounts](http://gpsearch.azurewebsites.net/default.aspx?ref=1) group policy setting.</span></span> <span data-ttu-id="cbd77-182">Para Outlook en plataformas distintas de Windows y para Skype Empresarial en todas las plataformas, actualmente no está disponible la compatibilidad total para restricciones de inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-182">For Outlook on non-Windows platforms, and for Skype for Business on all platforms, full support for Tenant Restrictions is not currently available.</span></span>

## <a name="testing"></a><span data-ttu-id="cbd77-183">Prueba</span><span class="sxs-lookup"><span data-stu-id="cbd77-183">Testing</span></span>

<span data-ttu-id="cbd77-184">Si desea probar la característica Restricciones de inquilino antes de implementarla para toda la organización, tiene dos opciones: un enfoque basado en host mediante una herramienta como Fiddler o un lanzamiento por fases de configuración de proxy.</span><span class="sxs-lookup"><span data-stu-id="cbd77-184">If you want to try out Tenant Restrictions before implementing it for your whole organization, there are two options: a host-based approach using a tool like Fiddler, or a staged rollout of proxy settings.</span></span>

### <a name="fiddler-for-a-host-based-approach"></a><span data-ttu-id="cbd77-185">Fiddler para un enfoque basado en host</span><span class="sxs-lookup"><span data-stu-id="cbd77-185">Fiddler for a host-based approach</span></span>

<span data-ttu-id="cbd77-186">Fiddler es un proxy de depuración web gratis que puede usarse para capturar y modificar el tráfico HTTP/HTTPS, incluida la inserción de encabezados HTTP.</span><span class="sxs-lookup"><span data-stu-id="cbd77-186">Fiddler is a free web debugging proxy that can be used to capture and modify HTTP/HTTPS traffic, including inserting HTTP headers.</span></span> <span data-ttu-id="cbd77-187">Para configurar Fiddler para probar Restricciones de inquilino, realice los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="cbd77-187">To configure Fiddler to test Tenant Restrictions, perform the following steps:</span></span>

1.  <span data-ttu-id="cbd77-188">[Descargue e instale Fiddler](http://www.telerik.com/fiddler).</span><span class="sxs-lookup"><span data-stu-id="cbd77-188">[Download and install Fiddler](http://www.telerik.com/fiddler).</span></span>
2.  <span data-ttu-id="cbd77-189">Configure Fiddler para descifrar el tráfico HTTPS siguiendo las indicaciones de la [documentación de la ayuda de Fiddler](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS).</span><span class="sxs-lookup"><span data-stu-id="cbd77-189">Configure Fiddler to decrypt HTTPS traffic, per [Fiddler’s help documentation](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS).</span></span>
3.  <span data-ttu-id="cbd77-190">Configure Fiddler para insertar los encabezados *Restrict-Access-To-Tenants* y *Restrict-Access-Context* utilizando reglas personalizadas:</span><span class="sxs-lookup"><span data-stu-id="cbd77-190">Configure Fiddler to insert the *Restrict-Access-To-Tenants* and *Restrict-Access-Context* headers using custom rules:</span></span>
  1. <span data-ttu-id="cbd77-191">En la herramienta Fiddler Web Debugger, seleccione el menú **Reglas** y luego **Personalizar reglas...**</span><span class="sxs-lookup"><span data-stu-id="cbd77-191">In the Fiddler Web Debugger tool, select the **Rules** menu and select **Customize Rules…**</span></span> <span data-ttu-id="cbd77-192">para abrir el archivo CustomRules.</span><span class="sxs-lookup"><span data-stu-id="cbd77-192">to open the CustomRules file.</span></span>
  2. <span data-ttu-id="cbd77-193">Agregue las siguientes líneas al principio de la función *OnBeforeRequest*.</span><span class="sxs-lookup"><span data-stu-id="cbd77-193">Add the following lines at the beginning of the *OnBeforeRequest* function.</span></span> <span data-ttu-id="cbd77-194">Reemplace \<tenant domain\> por un dominio registrado con el inquilino, por ejemplo, contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="cbd77-194">Replace \<tenant domain\> with a domain registered with your tenant, for example, contoso.onmicrosoft.com.</span></span> <span data-ttu-id="cbd77-195">Reemplace \<directory ID\> por el identificador GUID de Azure AD del inquilino.</span><span class="sxs-lookup"><span data-stu-id="cbd77-195">Replace \<directory ID\> with your tenant's Azure AD GUID identifier.</span></span>

  ```
  if (oSession.HostnameIs("login.microsoftonline.com") || oSession.HostnameIs("login.microsoft.com") || oSession.HostnameIs("login.windows.net")){      oSession.oRequest["Restrict-Access-To-Tenants"] = "<tenant domain>";      oSession.oRequest["Restrict-Access-Context"] = "<directory ID>";}
  ```

  <span data-ttu-id="cbd77-196">Si necesita permitir varios inquilinos, use una coma para separar los nombres de los mismos.</span><span class="sxs-lookup"><span data-stu-id="cbd77-196">If you need to allow multiple tenants, use a comma to separate the tenant names.</span></span> <span data-ttu-id="cbd77-197">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="cbd77-197">For example:</span></span>

  ```
  oSession.oRequest["Restrict-Access-To-Tenants"] = "contoso.onmicrosoft.com,fabrikam.onmicrosoft.com";
  ```

4. <span data-ttu-id="cbd77-198">Guarde y cierre el archivo CustomRules.</span><span class="sxs-lookup"><span data-stu-id="cbd77-198">Save and close the CustomRules file.</span></span>

<span data-ttu-id="cbd77-199">Después de configurar Fiddler, podrá capturar el tráfico yendo al menú **File** (Archivo) y seleccionando **Capture Traffic** (Capturar tráfico).</span><span class="sxs-lookup"><span data-stu-id="cbd77-199">After you configure Fiddler, you can capture traffic by going to the **File** menu and selecting **Capture Traffic**.</span></span>

### <a name="staged-rollout-of-proxy-settings"></a><span data-ttu-id="cbd77-200">Lanzamiento por fases de configuración de proxy</span><span class="sxs-lookup"><span data-stu-id="cbd77-200">Staged rollout of proxy settings</span></span>

<span data-ttu-id="cbd77-201">Dependiendo de las funcionalidades de la infraestructura del proxy, es posible que pueda llevar a cabo el lanzamiento de la configuración a los usuarios.</span><span class="sxs-lookup"><span data-stu-id="cbd77-201">Depending on the capabilities of your proxy infrastructure, you may be able to stage the rollout of settings to your users.</span></span> <span data-ttu-id="cbd77-202">Aquí tiene un par de opciones de alto nivel a tener en cuenta:</span><span class="sxs-lookup"><span data-stu-id="cbd77-202">Here are a couple high-level options for consideration:</span></span>

1.  <span data-ttu-id="cbd77-203">Usar archivos PAC para dirigir a los usuarios de prueba a una infraestructura del proxy de prueba, mientras que los usuarios convencionales siguen usando la infraestructura del proxy de producción.</span><span class="sxs-lookup"><span data-stu-id="cbd77-203">Use PAC files to point test users to a test proxy infrastructure, while normal users continue to use the production proxy infrastructure.</span></span>
2.  <span data-ttu-id="cbd77-204">Algunos servidores proxy pueden admitir distintas configuraciones mediante grupos.</span><span class="sxs-lookup"><span data-stu-id="cbd77-204">Some proxy servers may support different configurations using groups.</span></span>

<span data-ttu-id="cbd77-205">Consulte la documentación del servidor proxy para obtener detalles específicos.</span><span class="sxs-lookup"><span data-stu-id="cbd77-205">Refer to your proxy server documentation for specific details.</span></span>

## <a name="next-steps"></a><span data-ttu-id="cbd77-206">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="cbd77-206">Next steps</span></span>

- <span data-ttu-id="cbd77-207">Lea [Updated Office 365 modern authentication](https://blogs.office.com/2015/11/19/updated-office-365-modern-authentication-public-preview/) (Autenticación moderna actualizada de Office 365)</span><span class="sxs-lookup"><span data-stu-id="cbd77-207">Read about [Updated Office 365 modern authentication](https://blogs.office.com/2015/11/19/updated-office-365-modern-authentication-public-preview/)</span></span>

- <span data-ttu-id="cbd77-208">Revise [URL de Office 365 e intervalos de direcciones IP](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2)</span><span class="sxs-lookup"><span data-stu-id="cbd77-208">Review the [Office 365 URLs and IP address ranges](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2)</span></span>
