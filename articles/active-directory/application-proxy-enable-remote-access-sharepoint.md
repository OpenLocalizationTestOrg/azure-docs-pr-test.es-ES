---
title: "aaaEnable tooSharePoint de acceso remoto con el Proxy de aplicación de Azure AD | Documentos de Microsoft"
description: "Abarca conceptos básicos de hello acerca de cómo toointegrate un servidor de SharePoint local con el Proxy de aplicación de Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/21/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: 6ab413462fcaf387e150449df9c97505c4108bcf
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="enable-remote-access-toosharepoint-with-azure-ad-application-proxy"></a><span data-ttu-id="e5a03-103">Habilitar acceso remoto tooSharePoint con el Proxy de aplicación de Azure AD</span><span class="sxs-lookup"><span data-stu-id="e5a03-103">Enable remote access tooSharePoint with Azure AD Application Proxy</span></span>

<span data-ttu-id="e5a03-104">Este artículo se describe cómo toointegrate un servidor de SharePoint local con el Proxy de aplicación de Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="e5a03-104">This article discusses how toointegrate an on-premises SharePoint server with Azure Active Directory (Azure AD) Application Proxy.</span></span>

<span data-ttu-id="e5a03-105">tooenable tooSharePoint de acceso remoto con el Proxy de aplicación de Azure AD, vea las secciones de hello en este artículo paso a paso.</span><span class="sxs-lookup"><span data-stu-id="e5a03-105">tooenable remote access tooSharePoint with Azure AD Application Proxy, follow hello sections in this article step by step.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="e5a03-106">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="e5a03-106">Prerequisites</span></span>

<span data-ttu-id="e5a03-107">En este artículo se da por supuesto que ya tiene SharePoint 2013 o una versión más reciente instalada en su entorno.</span><span class="sxs-lookup"><span data-stu-id="e5a03-107">This article assumes that you already have SharePoint 2013 or newer in your environment.</span></span> <span data-ttu-id="e5a03-108">Además, considere la posibilidad de hello siguiendo los requisitos previos:</span><span class="sxs-lookup"><span data-stu-id="e5a03-108">In addition, consider hello following prerequisites:</span></span>

* <span data-ttu-id="e5a03-109">SharePoint incluye compatibilidad nativa con Kerberos.</span><span class="sxs-lookup"><span data-stu-id="e5a03-109">SharePoint includes native Kerberos support.</span></span> <span data-ttu-id="e5a03-110">Por lo tanto, los usuarios que obtienen acceso a los sitios internos remotamente a través de Proxy de aplicación de Azure AD pueden asumir toohave experiencia de un inicio de sesión único (SSO).</span><span class="sxs-lookup"><span data-stu-id="e5a03-110">Therefore, users who are accessing internal sites remotely through Azure AD Application Proxy can assume toohave a single sign-on (SSO) experience.</span></span>

* <span data-ttu-id="e5a03-111">Debe toomake unos servidor de SharePoint de tooyour de cambios de configuración.</span><span class="sxs-lookup"><span data-stu-id="e5a03-111">You need toomake a few configuration changes tooyour SharePoint server.</span></span> <span data-ttu-id="e5a03-112">Se recomienda usar un entorno de ensayo.</span><span class="sxs-lookup"><span data-stu-id="e5a03-112">We recommend using a staging environment.</span></span> <span data-ttu-id="e5a03-113">De esta manera, pueda tomar tooyour actualizaciones en primer lugar, el servidor de ensayo y, a continuación, facilitar un ciclo de prueba antes de pasar a producción.</span><span class="sxs-lookup"><span data-stu-id="e5a03-113">This way, you can make updates tooyour staging server first, and then facilitate a testing cycle before going into production.</span></span>

* <span data-ttu-id="e5a03-114">Se supone que ya configuró SSL para SharePoint, porque se requiere que SSL en hello publicado direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="e5a03-114">We assume that you have already set up SSL for SharePoint, because we require SSL on hello published URL.</span></span> <span data-ttu-id="e5a03-115">Necesita toohave que SSL habilitado en su sitio interno, tooensure que vínculos son enviados/asignada correctamente.</span><span class="sxs-lookup"><span data-stu-id="e5a03-115">You need toohave SSL enabled on your internal site, tooensure that links are sent/mapped correctly.</span></span> <span data-ttu-id="e5a03-116">Si no configuró SSL, vea [Configure SSL for SharePoint 2013 (Configurar SSL para SharePoint 2013)](https://blogs.msdn.microsoft.com/fabdulwahab/2013/01/20/configure-ssl-for-sharepoint-2013) para obtener instrucciones.</span><span class="sxs-lookup"><span data-stu-id="e5a03-116">If you haven't configured SSL, see [Configure SSL for SharePoint 2013](https://blogs.msdn.microsoft.com/fabdulwahab/2013/01/20/configure-ssl-for-sharepoint-2013) for instructions.</span></span> <span data-ttu-id="e5a03-117">Además, asegúrese de que ese certificado Hola de hello conector máquina relaciones de confianza que emite.</span><span class="sxs-lookup"><span data-stu-id="e5a03-117">Also, make sure that hello connector machine trusts hello certificate that you issue.</span></span> <span data-ttu-id="e5a03-118">(certificado de hello no necesita toobe públicamente emitido).</span><span class="sxs-lookup"><span data-stu-id="e5a03-118">(hello certificate does not need toobe publicly issued.)</span></span>

## <a name="step-1-set-up-single-sign-on-toosharepoint"></a><span data-ttu-id="e5a03-119">Paso 1: Configurar tooSharePoint de inicio de sesión único</span><span class="sxs-lookup"><span data-stu-id="e5a03-119">Step 1: Set up single sign-on tooSharePoint</span></span>

<span data-ttu-id="e5a03-120">Nuestros clientes desean Hola SSO mejor experiencia para sus aplicaciones de back-end, el servidor de SharePoint en este caso.</span><span class="sxs-lookup"><span data-stu-id="e5a03-120">Our customers want hello best SSO experience for their back-end applications, SharePoint server in this case.</span></span> <span data-ttu-id="e5a03-121">En este escenario habitual de Azure AD, usuario de Hola se autentica una sola vez, porque no se pedirá para la autenticación de nuevo.</span><span class="sxs-lookup"><span data-stu-id="e5a03-121">In this common Azure AD scenario, hello user is authenticated only once, because they will not be prompted for authentication again.</span></span>

<span data-ttu-id="e5a03-122">Para las aplicaciones locales que requieren o utilizan la autenticación de Windows, puede conseguir SSO mediante una característica denominada delegación limitada de Kerberos (KCD) y el protocolo de autenticación de Kerberos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-122">For on-premises applications that require or use Windows authentication, you can achieve SSO by using hello Kerberos authentication protocol and a feature called Kerberos constrained delegation (KCD).</span></span> <span data-ttu-id="e5a03-123">KCD, cuando se configura, permite tooobtain de conector de Proxy de aplicación Hola windows vale/símbolo (token) para un usuario, incluso si el usuario de hello no se ha iniciado sesión en tooWindows directamente.</span><span class="sxs-lookup"><span data-stu-id="e5a03-123">KCD, when configured, allows hello Application Proxy connector tooobtain a windows ticket/token for a user, even if hello user hasn’t signed in tooWindows directly.</span></span> <span data-ttu-id="e5a03-124">toolearn más información acerca de KCD, consulte [introducción de delegación limitada de Kerberos](https://technet.microsoft.com/library/jj553400.aspx).</span><span class="sxs-lookup"><span data-stu-id="e5a03-124">toolearn more about KCD, see [Kerberos Constrained Delegation Overview](https://technet.microsoft.com/library/jj553400.aspx).</span></span>

<span data-ttu-id="e5a03-125">tooset seguridad KCD para un servidor de SharePoint, usar los procedimientos de Hola Hola siguientes secciones secuenciales:</span><span class="sxs-lookup"><span data-stu-id="e5a03-125">tooset up KCD for a SharePoint server, use hello procedures in hello following sequential sections:</span></span>

### <a name="ensure-that-sharepoint-is-running-under-a-service-account"></a><span data-ttu-id="e5a03-126">Asegurarse de que SharePoint se ejecuta como una cuenta de servicio</span><span class="sxs-lookup"><span data-stu-id="e5a03-126">Ensure that SharePoint is running under a service account</span></span>

<span data-ttu-id="e5a03-127">En primer lugar, asegúrese de que SharePoint se ejecuta bajo una cuenta de servicio definida, no de sistema local, servicio local o servicio de red.</span><span class="sxs-lookup"><span data-stu-id="e5a03-127">First, make sure that SharePoint is running under a defined service account--not local system, local service, or network service.</span></span> <span data-ttu-id="e5a03-128">Hacer esto para que se pueda adjuntar cuenta válida de tooa de nombres de entidad de seguridad (SPN) de servicio.</span><span class="sxs-lookup"><span data-stu-id="e5a03-128">Do this so that you can attach service principal names (SPNs) tooa valid account.</span></span> <span data-ttu-id="e5a03-129">Los SPN son cómo Hola protocolo Kerberos identifica servicios diferentes.</span><span class="sxs-lookup"><span data-stu-id="e5a03-129">SPNs are how hello Kerberos protocol identifies different services.</span></span> <span data-ttu-id="e5a03-130">Y se necesita Hola cuenta más adelante tooconfigure Hola KCD.</span><span class="sxs-lookup"><span data-stu-id="e5a03-130">And you will need hello account later tooconfigure hello KCD.</span></span>

<span data-ttu-id="e5a03-131">tooensure que los sitios se ejecutan bajo una cuenta de servicio definido, lleve a cabo Hola pasos:</span><span class="sxs-lookup"><span data-stu-id="e5a03-131">tooensure that your sites are running under a defined service account, perform hello following steps:</span></span>

1. <span data-ttu-id="e5a03-132">Abra hello **Administración Central de SharePoint 2013** sitio.</span><span class="sxs-lookup"><span data-stu-id="e5a03-132">Open hello **SharePoint 2013 Central Administration** site.</span></span>
2. <span data-ttu-id="e5a03-133">Vaya demasiado**seguridad** y seleccione **configurar cuentas de servicio**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-133">Go too**Security** and select **Configure service accounts**.</span></span>
3. <span data-ttu-id="e5a03-134">Seleccione **Grupo de aplicaciones web - SharePoint - 80**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-134">Select **Web Application Pool - SharePoint - 80**.</span></span> <span data-ttu-id="e5a03-135">Opciones de Hello pueden diferir ligeramente según Hola nombre del grupo de servidores web, o si hello grupo web utiliza SSL de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e5a03-135">hello options may be slightly different based on hello name of your web pool, or if hello web pool uses SSL by default.</span></span>

  ![Opciones para configurar una cuenta de servicio](./media/application-proxy-remote-sharepoint/remote-sharepoint-service-web-application.png)

4. <span data-ttu-id="e5a03-137">Si **seleccionar una cuenta para este componente** es **servicio Local** o **servicio de red**, necesita una cuenta de toocreate.</span><span class="sxs-lookup"><span data-stu-id="e5a03-137">If **Select an account for this component** is **Local Service** or **Network Service**, you need toocreate an account.</span></span> <span data-ttu-id="e5a03-138">Si no es así, haya terminado y puede mover toohello próxima sección.</span><span class="sxs-lookup"><span data-stu-id="e5a03-138">If not, you're finished and can move toohello next section.</span></span>
5. <span data-ttu-id="e5a03-139">Haga clic en **Registrar una nueva cuenta administrada**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-139">Select **Register new managed account**.</span></span> <span data-ttu-id="e5a03-140">Después de crear la cuenta, debe establecer **grupo de aplicaciones Web** para poder usar la cuenta de hello.</span><span class="sxs-lookup"><span data-stu-id="e5a03-140">After your account is created, you must set **Web Application Pool** before you can use hello account.</span></span>

> [!NOTE]
<span data-ttu-id="e5a03-141">Necesita toohave un previamente creado la cuenta de Azure AD para servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-141">You need toohave a previously created Azure AD account for hello service.</span></span> <span data-ttu-id="e5a03-142">Se recomienda que permita un cambio de contraseña automático.</span><span class="sxs-lookup"><span data-stu-id="e5a03-142">We suggest that you allow for an automatic password change.</span></span> <span data-ttu-id="e5a03-143">Para obtener más información sobre el conjunto completo de Hola de pasos y solución de problemas, consulte [configurar el cambio de contraseña automático en SharePoint 2013](https://technet.microsoft.com/library/ff724280.aspx).</span><span class="sxs-lookup"><span data-stu-id="e5a03-143">For more information about hello full set of steps and troubleshooting issues, see [Configure automatic password change in SharePoint 2013](https://technet.microsoft.com/library/ff724280.aspx).</span></span>

### <a name="configure-sharepoint-for-kerberos"></a><span data-ttu-id="e5a03-144">Configurar SharePoint para Kerberos</span><span class="sxs-lookup"><span data-stu-id="e5a03-144">Configure SharePoint for Kerberos</span></span>

<span data-ttu-id="e5a03-145">Usar KCD tooperform único inicio de sesión toohello servidor de SharePoint, y esto solo funciona con Kerberos.</span><span class="sxs-lookup"><span data-stu-id="e5a03-145">You use KCD tooperform single sign-on toohello SharePoint server, and this works only with Kerberos.</span></span>

<span data-ttu-id="e5a03-146">tooconfigure de sitio de SharePoint para la autenticación Kerberos:</span><span class="sxs-lookup"><span data-stu-id="e5a03-146">tooconfigure your SharePoint site for Kerberos authentication:</span></span>

1. <span data-ttu-id="e5a03-147">Abra hello **Administración Central de SharePoint 2013** sitio.</span><span class="sxs-lookup"><span data-stu-id="e5a03-147">Open hello **SharePoint 2013 Central Administration** site.</span></span>
2. <span data-ttu-id="e5a03-148">Vaya demasiado**administración de aplicaciones**, seleccione **administrar aplicaciones web**y seleccione el sitio de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e5a03-148">Go too**Application Management**, select **Manage web applications**, and select your SharePoint site.</span></span> <span data-ttu-id="e5a03-149">En este ejemplo, es **SharePoint – 80**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-149">In this example, it is **SharePoint - 80**.</span></span>

  ![Seleccionar sitio de SharePoint de Hola](./media/application-proxy-remote-sharepoint/remote-sharepoint-manage-web-applications.png)

3. <span data-ttu-id="e5a03-151">Haga clic en **proveedores de autenticación** en la barra de herramientas de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-151">Click **Authentication Providers** on hello toolbar.</span></span>
4. <span data-ttu-id="e5a03-152">Hola **proveedores de autenticación** cuadro, haga clic en **zona predeterminada** configuración de tooview Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-152">In hello **Authentication Providers** box, click **Default Zone** tooview hello settings.</span></span>
5. <span data-ttu-id="e5a03-153">Hola **Editar autenticación** diálogo cuadro, desplácese hacia abajo hasta que vea **tipos de autenticación de notificaciones** y asegúrese de que ambos **habilitar la autenticación de Windows** y  **Autenticación de Windows integrada** están seleccionadas.</span><span class="sxs-lookup"><span data-stu-id="e5a03-153">In hello **Edit Authentication** dialog box, scroll down until you see **Claims Authentication Types** and ensure that both **Enable Windows Authentication** and **Integrated Windows Authentication** are selected.</span></span>
6. <span data-ttu-id="e5a03-154">En el cuadro de lista desplegable de hello, asegúrese de que **negociar (Kerberos)** está seleccionada.</span><span class="sxs-lookup"><span data-stu-id="e5a03-154">In hello drop-down box, make sure that **Negotiate (Kerberos)** is selected.</span></span>

  ![Cuadro de diálogo Editar autenticación](./media/application-proxy-remote-sharepoint/remote-sharepoint-service-edit-authentication.png)

7. <span data-ttu-id="e5a03-156">Final de Hola de hello **Editar autenticación** cuadro de diálogo, haga clic en **guardar**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-156">At hello bottom of hello **Edit Authentication** dialog box, click **Save**.</span></span>

### <a name="set-a-service-principal-name-for-hello-sharepoint-service-account"></a><span data-ttu-id="e5a03-157">Establezca un nombre principal de servicio para hello cuenta de servicio de SharePoint</span><span class="sxs-lookup"><span data-stu-id="e5a03-157">Set a service principal name for hello SharePoint service account</span></span>

<span data-ttu-id="e5a03-158">Antes de configurar Hola KCD, necesita servicio de SharePoint de hello tooidentify ejecuta como cuenta de servicio de Hola que haya configurado.</span><span class="sxs-lookup"><span data-stu-id="e5a03-158">Before you configure hello KCD, you need tooidentify hello SharePoint service running as hello service account that you've configured.</span></span> <span data-ttu-id="e5a03-159">Para ello se establece un SPN.</span><span class="sxs-lookup"><span data-stu-id="e5a03-159">You do this by setting an SPN.</span></span> <span data-ttu-id="e5a03-160">Para obtener más información, consulte [Service Principal Names](https://technet.microsoft.com/library/cc961723.aspx) (Nombres de entidad de seguridad de servicio).</span><span class="sxs-lookup"><span data-stu-id="e5a03-160">For more information, see [Service Principal Names](https://technet.microsoft.com/library/cc961723.aspx).</span></span>

<span data-ttu-id="e5a03-161">formato SPN de Hello es:</span><span class="sxs-lookup"><span data-stu-id="e5a03-161">hello SPN format is:</span></span>

```
<service class>/<host>:<port>
```

<span data-ttu-id="e5a03-162">En formato SPN de hello:</span><span class="sxs-lookup"><span data-stu-id="e5a03-162">In hello SPN format:</span></span>

* <span data-ttu-id="e5a03-163">_clase de servicio_ es un nombre único para el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-163">_service class_ is a unique name for hello service.</span></span> <span data-ttu-id="e5a03-164">Para SharePoint, se usa **HTTP**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-164">For SharePoint, you use **HTTP**.</span></span>

* <span data-ttu-id="e5a03-165">_host_ es dominio completo de Hola o nombre NetBIOS del host de Hola Hola servicio se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="e5a03-165">_host_ is hello fully qualified domain or NetBIOS name of hello host that hello service is running on.</span></span> <span data-ttu-id="e5a03-166">Un sitio de SharePoint, este texto podría tener toobe Hola URL de sitio de hello, según la versión de Hola de IIS que esté usando.</span><span class="sxs-lookup"><span data-stu-id="e5a03-166">For a SharePoint site, this text might need toobe hello URL of hello site, depending on hello version of IIS that you're using.</span></span>

* <span data-ttu-id="e5a03-167">_port_ es opcional.</span><span class="sxs-lookup"><span data-stu-id="e5a03-167">_port_ is optional.</span></span>

<span data-ttu-id="e5a03-168">Si es el FQDN del servidor de SharePoint de Hola Hola:</span><span class="sxs-lookup"><span data-stu-id="e5a03-168">If hello FQDN of hello SharePoint server is:</span></span>

```
sharepoint.demo.o365identity.us
```

<span data-ttu-id="e5a03-169">A continuación, Hola SPN es:</span><span class="sxs-lookup"><span data-stu-id="e5a03-169">Then hello SPN is:</span></span>

```
HTTP/ sharepoint.demo.o365identity.us demo
```

<span data-ttu-id="e5a03-170">También podría necesitar tooset SPN para sitios específicos en el servidor.</span><span class="sxs-lookup"><span data-stu-id="e5a03-170">You might also need tooset SPNs for specific sites on your server.</span></span> <span data-ttu-id="e5a03-171">Para más información, vea [Configuración de la autenticación Kerberos](https://technet.microsoft.com/library/cc263449(v=office.12).aspx).</span><span class="sxs-lookup"><span data-stu-id="e5a03-171">For more information, see [Configure Kerberos authentication](https://technet.microsoft.com/library/cc263449(v=office.12).aspx).</span></span> <span data-ttu-id="e5a03-172">Preste mucha atención toohello sección "Crear nombres de entidad de servicio para las aplicaciones Web mediante la autenticación Kerberos".</span><span class="sxs-lookup"><span data-stu-id="e5a03-172">Pay close attention toohello section "Create Service Principal Names for your Web applications using Kerberos authentication."</span></span>

<span data-ttu-id="e5a03-173">la manera más fácil de Hola para tooset SPN es formatos de SPN de hello toofollow que ya pueden estar presentes para los sitios.</span><span class="sxs-lookup"><span data-stu-id="e5a03-173">hello easiest way for you tooset SPNs is toofollow hello SPN formats that may already be present for your sites.</span></span> <span data-ttu-id="e5a03-174">Copie los tooregister SPN con la cuenta de servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-174">Copy those SPNs tooregister against hello service account.</span></span> <span data-ttu-id="e5a03-175">toodo esto:</span><span class="sxs-lookup"><span data-stu-id="e5a03-175">toodo this:</span></span>

1. <span data-ttu-id="e5a03-176">Examinar el sitio de toohello con hello SPN desde otro equipo.</span><span class="sxs-lookup"><span data-stu-id="e5a03-176">Browse toohello site with hello SPN from another machine.</span></span>
 <span data-ttu-id="e5a03-177">Cuando, Hola conjunto relevante de los vales Kerberos se almacena en caché en la máquina de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-177">When you do, hello relevant set of Kerberos tickets is cached on hello machine.</span></span> <span data-ttu-id="e5a03-178">Estos vales contienen Hola SPN del sitio de destino de Hola que buscó.</span><span class="sxs-lookup"><span data-stu-id="e5a03-178">These tickets contain hello SPN of hello target site that you browsed to.</span></span>

2. <span data-ttu-id="e5a03-179">Puede extraer Hola SPN para ese sitio mediante el uso de una herramienta denominada [Klist](http://web.mit.edu/kerberos/krb5-devel/doc/user/user_commands/klist.html).</span><span class="sxs-lookup"><span data-stu-id="e5a03-179">You can pull hello SPN for that site by using a tool called [Klist](http://web.mit.edu/kerberos/krb5-devel/doc/user/user_commands/klist.html).</span></span> <span data-ttu-id="e5a03-180">En una ventana de comandos que se ejecuta en hello mismo contexto que el usuario de Hola que ejecutan el sitio de acceso hello en el Explorador de hello, Hola siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="e5a03-180">In a command window that's running in hello same context as hello user who accessed hello site in hello browser, run hello following command:</span></span>
```
Klist
```
<span data-ttu-id="e5a03-181">Klist, a continuación, devuelve el conjunto de Hola de SPN de destino.</span><span class="sxs-lookup"><span data-stu-id="e5a03-181">Klist then returns hello set of target SPNs.</span></span> <span data-ttu-id="e5a03-182">En este ejemplo, el valor de hello resaltado es Hola SPN que se necesita:</span><span class="sxs-lookup"><span data-stu-id="e5a03-182">In this example, hello highlighted value is hello SPN that's needed:</span></span>

  ![Resultados del ejemplo de Klist](./media/application-proxy-remote-sharepoint/remote-sharepoint-target-service.png)

4. <span data-ttu-id="e5a03-184">Ahora que tienes Hola SPN, debe toomake seguro de que esté configurado correctamente en la cuenta de servicio de Hola que configuró para la aplicación antes de hello web.</span><span class="sxs-lookup"><span data-stu-id="e5a03-184">Now that you have hello SPN, you need toomake sure that it's configured correctly on hello service account that you set up for hello web application earlier.</span></span> <span data-ttu-id="e5a03-185">Ejecute hello siguiente comando desde el símbolo del sistema Hola como un administrador de dominio de hello:</span><span class="sxs-lookup"><span data-stu-id="e5a03-185">Run hello following command from hello command prompt as an administrator of hello domain:</span></span>

 ```
 setspn -S http/sharepoint.demo.o365identity.us demo\sp_svc
 ```

 <span data-ttu-id="e5a03-186">Este comando establece Hola SPN para el servicio de SharePoint de hello cuenta de ejecución como _demo\sp_svc_.</span><span class="sxs-lookup"><span data-stu-id="e5a03-186">This command sets hello SPN for hello SharePoint service account running as _demo\sp_svc_.</span></span>

 <span data-ttu-id="e5a03-187">Reemplace _http/sharepoint.demo.o365identity.us_ con hello SPN para el servidor y _demo\sp_svc_ con la cuenta de servicio de hello en su entorno.</span><span class="sxs-lookup"><span data-stu-id="e5a03-187">Replace _http/sharepoint.demo.o365identity.us_ with hello SPN for your server and _demo\sp_svc_ with hello service account in your environment.</span></span> <span data-ttu-id="e5a03-188">Hola Setspn comando busca Hola SPN antes de que agrega.</span><span class="sxs-lookup"><span data-stu-id="e5a03-188">hello Setspn command searches for hello SPN before it adds it.</span></span> <span data-ttu-id="e5a03-189">En este caso, es posible que vea un error de **valor SPN duplicado**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-189">In this case, you might see a **Duplicate SPN Value** error.</span></span> <span data-ttu-id="e5a03-190">Si ve este error, asegúrese de que el valor de hello está asociado con la cuenta de servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-190">If you see this error, make sure that hello value is associated with hello service account.</span></span>

<span data-ttu-id="e5a03-191">Puede comprobar que Hola que SPN se agregó al ejecutar el comando Setspn de hello con hello -l (opción).</span><span class="sxs-lookup"><span data-stu-id="e5a03-191">You can verify that hello SPN was added by running hello Setspn command with hello -l option.</span></span> <span data-ttu-id="e5a03-192">toolearn más información acerca de este comando, consulte [Setspn](https://technet.microsoft.com/library/cc731241.aspx).</span><span class="sxs-lookup"><span data-stu-id="e5a03-192">toolearn more about this command, see [Setspn](https://technet.microsoft.com/library/cc731241.aspx).</span></span>

### <a name="ensure-that-hello-connector-is-set-as-a-trusted-delegate-toosharepoint"></a><span data-ttu-id="e5a03-193">Asegúrese de que dicho conector Hola se establece como un delegado de confianza tooSharePoint</span><span class="sxs-lookup"><span data-stu-id="e5a03-193">Ensure that hello connector is set as a trusted delegate tooSharePoint</span></span>

<span data-ttu-id="e5a03-194">Configurar Hola KCD para que el servicio de Proxy de aplicación de Azure AD de hello puede delegar el servicio de SharePoint de toohello de identidades de usuario.</span><span class="sxs-lookup"><span data-stu-id="e5a03-194">Configure hello KCD so that hello Azure AD Application Proxy service can delegate user identities toohello SharePoint service.</span></span> <span data-ttu-id="e5a03-195">Para ello, habilitar el conector del Proxy de aplicación Hola tooretrieve vales de Kerberos para los usuarios que han sido autenticados en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e5a03-195">You do this by enabling hello Application Proxy connector tooretrieve Kerberos tickets for your users who have been authenticated in Azure AD.</span></span> <span data-ttu-id="e5a03-196">A continuación, ese servidor pasa la aplicación de destino de hello contexto toohello o SharePoint en este caso.</span><span class="sxs-lookup"><span data-stu-id="e5a03-196">Then that server passes hello context toohello target application, or SharePoint in this case.</span></span>

<span data-ttu-id="e5a03-197">Hola tooconfigure KCD, repita Hola siguiendo los pasos para cada máquina de conector:</span><span class="sxs-lookup"><span data-stu-id="e5a03-197">tooconfigure hello KCD, repeat hello following steps for each connector machine:</span></span>

1. <span data-ttu-id="e5a03-198">Inicie sesión como un tooa de administrador de dominio DC y, a continuación, abra **equipos y usuarios de Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-198">Log in as a domain administrator tooa DC, and then open **Active Directory Users and Computers**.</span></span>
2. <span data-ttu-id="e5a03-199">Buscar equipo Hola que Hola conector se ejecuta en.</span><span class="sxs-lookup"><span data-stu-id="e5a03-199">Find hello computer that hello connector is running on.</span></span> <span data-ttu-id="e5a03-200">En este ejemplo, ha Hola mismo servidor de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e5a03-200">In this example, it's hello same SharePoint server.</span></span>
3. <span data-ttu-id="e5a03-201">Haga doble clic en el equipo de hello y, a continuación, haga clic en hello **delegación** ficha.</span><span class="sxs-lookup"><span data-stu-id="e5a03-201">Double-click hello computer, and then click hello **Delegation** tab.</span></span>
4. <span data-ttu-id="e5a03-202">Asegúrese de que la configuración de delegación de Hola se establece demasiado**confiar en este equipo para toohello delegación especificado solo servicios**y, a continuación, seleccione **usar cualquier protocolo de autenticación**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-202">Ensure that hello delegation settings are set too**Trust this computer for delegation toohello specified services only**, and then select **Use any authentication protocol**.</span></span>

  ![Configuración de delegación](./media/application-proxy-remote-sharepoint/remote-sharepoint-delegation-box.png)

5. <span data-ttu-id="e5a03-204">Haga clic en hello **agregar** botón, haga clic en **usuarios o equipos**y busque la cuenta de servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-204">Click hello **Add** button, click **Users or Computers**, and locate hello service account.</span></span>

  ![Hola agregar SPN para la cuenta de servicio de Hola](./media/application-proxy-remote-sharepoint/remote-sharepoint-users-computers.png)

6. <span data-ttu-id="e5a03-206">En lista de Hola de SPN, seleccione Hola uno que creó anteriormente para la cuenta de servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-206">In hello list of SPNs, select hello one that you created earlier for hello service account.</span></span>
7. <span data-ttu-id="e5a03-207">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-207">Click **OK**.</span></span> <span data-ttu-id="e5a03-208">Haga clic en **Aceptar** nuevo toosave cambios de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-208">Click **OK** again toosave hello changes.</span></span>

## <a name="step-2-enable-remote-access-toosharepoint"></a><span data-ttu-id="e5a03-209">Paso 2: Habilitar el acceso remoto tooSharePoint</span><span class="sxs-lookup"><span data-stu-id="e5a03-209">Step 2: Enable remote access tooSharePoint</span></span>

<span data-ttu-id="e5a03-210">Ahora que ha habilitado SharePoint para Kerberos y configurar KCD, está listo tooset seguridad tooSharePoint de inicio de sesión único.</span><span class="sxs-lookup"><span data-stu-id="e5a03-210">Now that you’ve enabled SharePoint for Kerberos and configured KCD, you're ready tooset up single sign-on tooSharePoint.</span></span> <span data-ttu-id="e5a03-211">A continuación, desde el conector de hello, puede publicar granja de SharePoint de hello para el acceso remoto a través de Proxy de aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e5a03-211">Then from hello connector, you can publish hello SharePoint farm for remote access through Azure AD Application Proxy.</span></span>

<span data-ttu-id="e5a03-212">Hola tooperform siguiendo los pasos, deberá toobe un miembro de función de administrador Global de hello en la cuenta de Azure Active Directory de su organización.</span><span class="sxs-lookup"><span data-stu-id="e5a03-212">tooperform hello following steps, you need toobe a member of hello Global Administrator Role in your organization's Azure Active Directory account.</span></span>

1. <span data-ttu-id="e5a03-213">Inicie sesión en toohello [portal de Azure](https://manage.windowsazure.com) y busque el inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e5a03-213">Sign in toohello [Azure portal](https://manage.windowsazure.com) and find your Azure AD tenant.</span></span>
2. <span data-ttu-id="e5a03-214">Haga clic en **Aplicaciones** y luego en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-214">Click **Applications**, and then click **Add**.</span></span>
3. <span data-ttu-id="e5a03-215">Seleccione **Publicar una aplicación que estará accesible desde fuera de la red**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-215">Select **Publish an application that will be accessible from outside your network**.</span></span> <span data-ttu-id="e5a03-216">Si no ve esta opción, asegúrese de que dispone de Azure AD Basic o Premium configurado en el inquilino de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-216">If you don’t see this option, make sure that you have Azure AD Basic or Premium set up in hello tenant.</span></span>
4. <span data-ttu-id="e5a03-217">Complete cada una de las opciones de hello como sigue:</span><span class="sxs-lookup"><span data-stu-id="e5a03-217">Complete each of hello options as follows:</span></span>
 * <span data-ttu-id="e5a03-218">**Nombre**: use el valor que quiera, por ejemplo **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-218">**Name**: Use any value that you want--for example, **SharePoint**.</span></span>
 * <span data-ttu-id="e5a03-219">**Dirección URL interna**: se trata de hello URL del sitio de SharePoint de hello internamente, como **https://SharePoint/**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-219">**Internal URL**: This is hello URL of hello SharePoint site internally, such as **https://SharePoint/**.</span></span> <span data-ttu-id="e5a03-220">En este ejemplo, asegúrese de que toouse **https**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-220">In this example, make sure toouse **https**.</span></span>
 * <span data-ttu-id="e5a03-221">**Método de autenticación previa**: seleccione **Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-221">**Preauthentication Method**: Select **Azure Active Directory**.</span></span>

  ![Opciones para agregar una aplicación](./media/application-proxy-remote-sharepoint/remote-sharepoint-add-application.png)

5. <span data-ttu-id="e5a03-223">Cuando se publica la aplicación hello, haga clic en hello **configurar** ficha.</span><span class="sxs-lookup"><span data-stu-id="e5a03-223">After hello app is published, click hello **Configure** tab.</span></span>
6. <span data-ttu-id="e5a03-224">Desplácese hacia abajo de la opción de toohello **traducir URL en encabezados**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-224">Scroll down toohello option **Translate URL in Headers**.</span></span> <span data-ttu-id="e5a03-225">es el valor predeterminado de Hello **Sí**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-225">hello default value is **YES**.</span></span> <span data-ttu-id="e5a03-226">También cambian**NO**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-226">Change it too**NO**.</span></span>

 <span data-ttu-id="e5a03-227">Hola, SharePoint usa _encabezado de Host_ toolook valor sitio Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-227">SharePoint uses hello _Host Header_ value toolook up hello site.</span></span> <span data-ttu-id="e5a03-228">También genera vínculos basándose en este valor.</span><span class="sxs-lookup"><span data-stu-id="e5a03-228">It also generates links based on this value.</span></span> <span data-ttu-id="e5a03-229">efecto neto de Hello es toomake seguro de que cualquier vínculo que SharePoint genera una dirección URL publicada que se ha configurado correctamente toouse dirección URL externa de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-229">hello net effect is toomake sure that any link that SharePoint generates is a published URL that is correctly set toouse hello external URL.</span></span> <span data-ttu-id="e5a03-230">Establecer valor de hello demasiado**Sí** también permite Hola aplicación de conector tooforward hello solicitud toohello back-end.</span><span class="sxs-lookup"><span data-stu-id="e5a03-230">Setting hello value too**YES** also enables hello connector tooforward hello request toohello back-end application.</span></span> <span data-ttu-id="e5a03-231">Sin embargo, el valor de hello demasiado**n** decir Hola conector no enviará el nombre de host interno Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-231">However, setting hello value too**NO** means that hello connector will not send hello internal host name.</span></span> <span data-ttu-id="e5a03-232">En su lugar, el conector de hello envía encabezado de host de hello como Hola publicada aplicaciones back-end de toohello de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="e5a03-232">Instead, hello connector sends hello host header as hello published URL toohello back-end application.</span></span>

 <span data-ttu-id="e5a03-233">Además, tooensure que SharePoint acepta esta dirección URL, debes toocomplete una mayor configuración en el servidor de SharePoint de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-233">Also, tooensure that SharePoint accepts this URL, you need toocomplete one more configuration on hello SharePoint server.</span></span> <span data-ttu-id="e5a03-234">Llevará a cabo en la sección siguiente Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-234">You'll do that in hello next section.</span></span>

7. <span data-ttu-id="e5a03-235">Cambio **método de autenticación interno** demasiado**autenticación integrada de Windows**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-235">Change **Internal Authentication Method** too**Integrated Windows Authentication**.</span></span> <span data-ttu-id="e5a03-236">Si su inquilino de Azure AD usa un UPN en la nube de Hola que es diferente de hello UPN local, recuerde tooupdate **delegar la identidad de inicio de sesión** así.</span><span class="sxs-lookup"><span data-stu-id="e5a03-236">If your Azure AD tenant uses a UPN in hello cloud that's different from hello UPN on-premises, remember tooupdate **Delegated Login Identity** as well.</span></span>
8. <span data-ttu-id="e5a03-237">Establecer **SPN interno de la aplicación** valor toohello establecidas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e5a03-237">Set **Internal Application SPN** toohello value that you set earlier.</span></span> <span data-ttu-id="e5a03-238">Por ejemplo, use **http/sharepoint.demo.o365identity.us**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-238">For example, use **http/sharepoint.demo.o365identity.us**.</span></span>
9. <span data-ttu-id="e5a03-239">Asignar Hola aplicación tooyour usuarios de destino.</span><span class="sxs-lookup"><span data-stu-id="e5a03-239">Assign hello application tooyour target users.</span></span>

<span data-ttu-id="e5a03-240">La aplicación debe ser similar toohello siguiente ejemplo:</span><span class="sxs-lookup"><span data-stu-id="e5a03-240">Your application should look similar toohello following example:</span></span>

  ![Aplicación terminada](./media/application-proxy-remote-sharepoint/remote-sharepoint-internal-application-spn.png)

## <a name="step-3-ensure-that-sharepoint-knows-about-hello-external-url"></a><span data-ttu-id="e5a03-242">Paso 3: Asegurarse de que SharePoint se sabe de dirección URL externa de Hola</span><span class="sxs-lookup"><span data-stu-id="e5a03-242">Step 3: Ensure that SharePoint knows about hello external URL</span></span>

<span data-ttu-id="e5a03-243">El último paso tooensure en la que SharePoint puede encontrar el sitio de hello basado en dirección URL externa de hello, para que representarán los vínculos en función de dicha dirección URL externa.</span><span class="sxs-lookup"><span data-stu-id="e5a03-243">Your last step tooensure that SharePoint can find hello site based on hello external URL, so that it will render links based on that external URL.</span></span> <span data-ttu-id="e5a03-244">Para ello, mediante la configuración de asignaciones de acceso alternativas para el sitio de SharePoint de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-244">You do this by configuring alternate access mappings for hello SharePoint site.</span></span>

1. <span data-ttu-id="e5a03-245">Abra hello **Administración Central de SharePoint 2013** sitio.</span><span class="sxs-lookup"><span data-stu-id="e5a03-245">Open hello **SharePoint 2013 Central Administration** site.</span></span>
2. <span data-ttu-id="e5a03-246">En **Configuración del sistema**, seleccione **Configurar asignaciones de acceso alternativas**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-246">Under **System Settings**, select **Configure Alternate Access Mappings**.</span></span>

 <span data-ttu-id="e5a03-247">Se abrirá hello **asignaciones alternativas de acceso** cuadro.</span><span class="sxs-lookup"><span data-stu-id="e5a03-247">This opens hello **Alternate Access Mappings** box.</span></span>

  ![Cuadro Asignaciones de acceso alternativas](./media/application-proxy-remote-sharepoint/remote-sharepoint-alternate-access1.png)

3. <span data-ttu-id="e5a03-249">En la lista desplegable situada al lado de hello **la colección de asignaciones de acceso alternativas**, seleccione **colección de la asignación de acceso alternativas de cambio**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-249">In hello drop-down list beside **Alternate Access Mapping Collection**, select **Change Alternate Access Mapping Collection**.</span></span>
4. <span data-ttu-id="e5a03-250">Seleccione el sitio, por ejemplo **SharePoint - 80**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-250">Select your site--for example, **SharePoint - 80**.</span></span>

  ![Selección de un sitio](./media/application-proxy-remote-sharepoint/remote-sharepoint-alternate-access2.png)

5. <span data-ttu-id="e5a03-252">Puede elegir tooadd Hola publicado direcciones URL como una dirección URL interna o una dirección URL pública.</span><span class="sxs-lookup"><span data-stu-id="e5a03-252">You can choose tooadd hello published URL as either an internal URL or a public URL.</span></span> <span data-ttu-id="e5a03-253">Este ejemplo utiliza una dirección URL pública como Hola extranet.</span><span class="sxs-lookup"><span data-stu-id="e5a03-253">This example uses a public URL as hello extranet.</span></span>
6. <span data-ttu-id="e5a03-254">Haga clic en **editar direcciones URL públicas** en hello **Extranet** ruta de acceso y, a continuación, escriba ruta de acceso Hola Hola publicó la aplicación, como en el paso anterior de Hola.</span><span class="sxs-lookup"><span data-stu-id="e5a03-254">Click **Edit Public URLs** in hello **Extranet** path, and then enter hello path for hello published application, as in hello previous step.</span></span> <span data-ttu-id="e5a03-255">Por ejemplo, escriba **https://sharepoint-iddemo.msappproxy.net**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-255">For example, enter **https://sharepoint-iddemo.msappproxy.net**.</span></span>

  ![Escriba la ruta de acceso de Hola](./media/application-proxy-remote-sharepoint/remote-sharepoint-alternate-access3.png)

7. <span data-ttu-id="e5a03-257">Haga clic en **Guardar**.</span><span class="sxs-lookup"><span data-stu-id="e5a03-257">Click **Save**.</span></span>

 <span data-ttu-id="e5a03-258">Ahora puede tener acceso a sitio de SharePoint de hello externamente a través de Proxy de aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e5a03-258">You can now access hello SharePoint site externally via Azure AD Application Proxy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e5a03-259">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="e5a03-259">Next steps</span></span>

- [<span data-ttu-id="e5a03-260">Cómo tooprovide el acceso remoto a aplicaciones locales de tooon</span><span class="sxs-lookup"><span data-stu-id="e5a03-260">How tooprovide secure remote access tooon-premises applications</span></span>](active-directory-application-proxy-get-started.md)
- [<span data-ttu-id="e5a03-261">Descripción de los conectores del Proxy de aplicación de Azure AD</span><span class="sxs-lookup"><span data-stu-id="e5a03-261">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
- <span data-ttu-id="e5a03-262">[Publishing SharePoint 2016 and Office Online Server with Azure AD Application Proxy](https://blogs.technet.microsoft.com/dawiese/2016/06/09/publishing-sharepoint-2016-and-office-online-server-with-azure-ad-application-proxy/) (Publicación de SharePoint 2016 y Office Online Server con el proxy de aplicación de Azure AD)</span><span class="sxs-lookup"><span data-stu-id="e5a03-262">[Publishing SharePoint 2016 and Office Online Server with Azure AD Application Proxy](https://blogs.technet.microsoft.com/dawiese/2016/06/09/publishing-sharepoint-2016-and-office-online-server-with-azure-ad-application-proxy/)</span></span>
