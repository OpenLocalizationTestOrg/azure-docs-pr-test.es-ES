---
title: "Conceptos de diseño de Azure AD Connect | Microsoft Docs"
description: "En este tema se detallan algunas áreas de diseño de implementación"
services: active-directory
documentationcenter: 
author: billmath
manager: femila
editor: 
ms.assetid: 4114a6c0-f96a-493c-be74-1153666ce6c9
ms.service: active-directory
ms.custom: azure-ad-connect
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: f23443d438c95a784f655fb9a5f20dfcf37be189
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-design-concepts"></a><span data-ttu-id="0b5e6-103">Azure AD Connect: conceptos de diseño</span><span class="sxs-lookup"><span data-stu-id="0b5e6-103">Azure AD Connect: Design concepts</span></span>
<span data-ttu-id="0b5e6-104">El propósito de este tema es describir las áreas que se deben tener en cuenta durante el diseño de implementación de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-104">The purpose of this topic is to describe areas that must be thought through during the implementation design of Azure AD Connect.</span></span> <span data-ttu-id="0b5e6-105">Este tema trata de una profundización en determinadas áreas, y estos conceptos se describen también brevemente en otros temas.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-105">This topic is a deep dive on certain areas and these concepts are briefly described in other topics as well.</span></span>

## <a name="sourceanchor"></a><span data-ttu-id="0b5e6-106">sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="0b5e6-106">sourceAnchor</span></span>
<span data-ttu-id="0b5e6-107">El atributo sourceAnchor se define como *un atributo inmutable durante la vigencia de un objeto*.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-107">The sourceAnchor attribute is defined as *an attribute immutable during the lifetime of an object*.</span></span> <span data-ttu-id="0b5e6-108">Identifica de forma única que un objeto es el mismo objeto en el entorno local y en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-108">It uniquely identifies an object as being the same object on-premises and in Azure AD.</span></span> <span data-ttu-id="0b5e6-109">El atributo también se denomina **immutableId** y los dos nombres se usan indistintamente.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-109">The attribute is also called **immutableId** and the two names are used interchangeable.</span></span>

<span data-ttu-id="0b5e6-110">La palabra inmutable, es decir, no se puede cambiar, es importante en este tema.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-110">The word immutable, that is "cannot be changed", is important to this topic.</span></span> <span data-ttu-id="0b5e6-111">Puesto que el valor de este atributo no se puede cambiar después de que se haya establecido, es importante elegir un diseño que respalde su caso.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-111">Since this attribute’s value cannot be changed after it has been set, it is important to pick a design that supports your scenario.</span></span>

<span data-ttu-id="0b5e6-112">El atributo se usa en las situaciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-112">The attribute is used for the following scenarios:</span></span>

* <span data-ttu-id="0b5e6-113">Cuando un nuevo servidor de motor de sincronización se genera, o regenera, después de una situación de recuperación ante desastres, este atributo vincula los objetos existentes en Azure AD con los objetos locales.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-113">When a new sync engine server is built, or rebuilt after a disaster recovery scenario, this attribute links existing objects in Azure AD with objects on-premises.</span></span>
* <span data-ttu-id="0b5e6-114">Si se mueve de una identidad solo de nube a un modelo de identidad sincronizada, este atributo permitirá que los objetos existentes en Azure AD coincidan exactamente con los objetos locales.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-114">If you move from a cloud-only identity to a synchronized identity model, then this attribute allows objects to "hard match" existing objects in Azure AD with on-premises objects.</span></span>
* <span data-ttu-id="0b5e6-115">Si usa federación, este atributo junto con el **userPrincipalName** se usan en la notificación para identificar de forma exclusiva un usuario.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-115">If you use federation, then this attribute together with the **userPrincipalName** is used in the claim to uniquely identify a user.</span></span>

<span data-ttu-id="0b5e6-116">En este tema solo se habla de sourceAnchor, puesto que está relacionado con los usuarios.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-116">This topic only talks about sourceAnchor as it relates to users.</span></span> <span data-ttu-id="0b5e6-117">Las mismas reglas se aplican a todos los tipos de objeto, pero es solo este problema el que supone una preocupación para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-117">The same rules apply to all object types, but it is only for users this problem usually is a concern.</span></span>

### <a name="selecting-a-good-sourceanchor-attribute"></a><span data-ttu-id="0b5e6-118">Selección de un buen atributo sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="0b5e6-118">Selecting a good sourceAnchor attribute</span></span>
<span data-ttu-id="0b5e6-119">El valor de atributo debe seguir las reglas siguientes:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-119">The attribute value must follow the following rules:</span></span>

* <span data-ttu-id="0b5e6-120">Debe tener una longitud de menos de 60 caracteres.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-120">Be less than 60 characters in length</span></span>
  * <span data-ttu-id="0b5e6-121">Los caracteres que no estén entre a-z, A-Z o 0-9 se codifican y cuentan como 3 caracteres.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-121">Characters not being a-z, A-Z, or 0-9 are encoded and counted as 3 characters</span></span>
* <span data-ttu-id="0b5e6-122">No debe contener caracteres especiales: &#92; !</span><span class="sxs-lookup"><span data-stu-id="0b5e6-122">Not contain a special character: &#92; !</span></span> <span data-ttu-id="0b5e6-123"># $ % & * + / = ?</span><span class="sxs-lookup"><span data-stu-id="0b5e6-123"># $ % & * + / = ?</span></span> <span data-ttu-id="0b5e6-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span><span class="sxs-lookup"><span data-stu-id="0b5e6-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span></span>
* <span data-ttu-id="0b5e6-125">Debe ser único globalmente.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-125">Must be globally unique</span></span>
* <span data-ttu-id="0b5e6-126">Debe ser una cadena, un entero o un número binario.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-126">Must be either a string, integer, or binary</span></span>
* <span data-ttu-id="0b5e6-127">No se debe basar en el nombre del usuario, estos cambios</span><span class="sxs-lookup"><span data-stu-id="0b5e6-127">Should not be based on user's name, these changes</span></span>
* <span data-ttu-id="0b5e6-128">No debe distinguir mayúsculas y minúsculas; evite valores que pueden variar según el caso</span><span class="sxs-lookup"><span data-stu-id="0b5e6-128">Should not be case-sensitive and avoid values that may vary by case</span></span>
* <span data-ttu-id="0b5e6-129">Debe asignarse cuando se crea el objeto.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-129">Should be assigned when the object is created</span></span>

<span data-ttu-id="0b5e6-130">Si el atributo sourceAnchor seleccionado no es de tipo cadena, Azure AD Connect aplica Base64Encode al valor de atributo para asegurarse de que no se muestre ningún carácter especial.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-130">If the selected sourceAnchor is not of type string, then Azure AD Connect Base64Encode the attribute value to ensure no special characters appear.</span></span> <span data-ttu-id="0b5e6-131">Si usa otro servidor de federación distinto de ADFS, asegúrese de que también pueda aplicar Base64Encode al atributo.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-131">If you use another federation server than ADFS, make sure your server can also Base64Encode the attribute.</span></span>

<span data-ttu-id="0b5e6-132">El atributo sourceAnchor distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-132">The sourceAnchor attribute is case-sensitive.</span></span> <span data-ttu-id="0b5e6-133">El valor "JohnDoe" no es igual que "johndoe".</span><span class="sxs-lookup"><span data-stu-id="0b5e6-133">A value of “JohnDoe” is not the same as “johndoe”.</span></span> <span data-ttu-id="0b5e6-134">Pero no debería tener dos objetos diferentes con solo una diferencia en mayúsculas o minúsculas.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-134">But you should not have two different objects with only a difference in case.</span></span>

<span data-ttu-id="0b5e6-135">Si tiene un solo bosque local, el atributo que debe usar es **objectGUID**.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-135">If you have a single forest on-premises, then the attribute you should use is **objectGUID**.</span></span> <span data-ttu-id="0b5e6-136">También es el atributo que se usa con la configuración rápida en Azure AD Connect y el atributo de sincronización de directorios.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-136">This is also the attribute used when you use express settings in Azure AD Connect and also the attribute used by DirSync.</span></span>

<span data-ttu-id="0b5e6-137">Si tiene varios bosques y no mueve usuarios entre bosques y dominios, **objectGUID** es un buen atributo para usar incluso en este caso.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-137">If you have multiple forests and do not move users between forests and domains, then **objectGUID** is a good attribute to use even in this case.</span></span>

<span data-ttu-id="0b5e6-138">Si mueve usuarios entre bosques y dominios, debe buscar un atributo que no cambie o se puede mover con los usuarios durante el movimiento.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-138">If you move users between forests and domains, then you must find an attribute that does not change or can be moved with the users during the move.</span></span> <span data-ttu-id="0b5e6-139">Un enfoque recomendado es introducir un atributo sintético.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-139">A recommended approach is to introduce a synthetic attribute.</span></span> <span data-ttu-id="0b5e6-140">Un atributo que pueda contener algo parecido a un GUID sería adecuado.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-140">An attribute that could hold something that looks like a GUID would be suitable.</span></span> <span data-ttu-id="0b5e6-141">Durante la creación del objeto se crea un nuevo GUID y se marca en el usuario.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-141">During object creation, a new GUID is created and stamped on the user.</span></span> <span data-ttu-id="0b5e6-142">Puede crear una regla de sincronización en el servidor del motor de sincronización para crear este valor según el **objectGUID** y actualizar el atributo seleccionado en ADDS.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-142">A custom sync rule can be created in the sync engine server to create this value based on the **objectGUID** and update the selected attribute in ADDS.</span></span> <span data-ttu-id="0b5e6-143">Al mover el objeto, asegúrese de copiar también el contenido de este valor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-143">When you move the object, make sure to also copy the content of this value.</span></span>

<span data-ttu-id="0b5e6-144">Otra solución consiste en seleccionar un atributo existente que sepa que no va a cambiar.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-144">Another solution is to pick an existing attribute you know does not change.</span></span> <span data-ttu-id="0b5e6-145">Uno de los atributos de uso más común es **employeeID**.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-145">Commonly used attributes include **employeeID**.</span></span> <span data-ttu-id="0b5e6-146">Si está considerando el uso de un atributo que contenga letras, asegúrese de que no haya ninguna posibilidad de que la distinción de mayúsculas y minúsculas pueda cambiar el valor del atributo.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-146">If you consider an attribute that contains letters, make sure there is no chance the case (upper case vs. lower case) can change for the attribute's value.</span></span> <span data-ttu-id="0b5e6-147">Entre los atributos incorrectos que no deben usarse se incluyen aquellos con el nombre del usuario.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-147">Bad attributes that should not be used include those attributes with the name of the user.</span></span> <span data-ttu-id="0b5e6-148">En un matrimonio o divorcio se espera que cambie el nombre, lo que no está permitido para este atributo.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-148">In a marriage or divorce, the name is expected to change, which is not allowed for this attribute.</span></span> <span data-ttu-id="0b5e6-149">Este también es uno de los motivos de que atributos como **userPrincipalName**, **mail** y **targetAddress** no se puedan seleccionar en el asistente de instalación de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-149">This is also one reason why attributes such as **userPrincipalName**, **mail**, and **targetAddress** are not even possible to select in the Azure AD Connect installation wizard.</span></span> <span data-ttu-id="0b5e6-150">Esos atributos también contienen el carácter "@", que no está permitido en sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-150">Those attributes also contain the "@" character, which is not allowed in the sourceAnchor.</span></span>

### <a name="changing-the-sourceanchor-attribute"></a><span data-ttu-id="0b5e6-151">Cambio del atributo sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="0b5e6-151">Changing the sourceAnchor attribute</span></span>
<span data-ttu-id="0b5e6-152">No se puede cambiar el valor del atributo sourceAnchor después de que el objeto se ha creado en Azure AD y la identidad se ha sincronizado.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-152">The sourceAnchor attribute value cannot be changed after the object has been created in Azure AD and the identity is synchronized.</span></span>

<span data-ttu-id="0b5e6-153">Por este motivo, se aplican las restricciones siguientes a Azure AD Connect:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-153">For this reason, the following restrictions apply to Azure AD Connect:</span></span>

* <span data-ttu-id="0b5e6-154">El atributo sourceAnchor solo puede establecerse durante la instalación inicial.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-154">The sourceAnchor attribute can only be set during initial installation.</span></span> <span data-ttu-id="0b5e6-155">Si vuelve a ejecutar el asistente de instalación, esta opción es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-155">If you rerun the installation wizard, this option is read-only.</span></span> <span data-ttu-id="0b5e6-156">Si necesita cambiar esto, debe desinstalar y reinstalar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-156">If you need to change this setting, then you must uninstall and reinstall.</span></span>
* <span data-ttu-id="0b5e6-157">Si instala otro servidor de Azure AD Connect, debe seleccionar el mismo atributo sourceAnchor usado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-157">If you install another Azure AD Connect server, then you must select the same sourceAnchor attribute as previously used.</span></span> <span data-ttu-id="0b5e6-158">Si anteriormente ha estado usando la sincronización de directorios y se pasa a Azure AD Connect, debe usar **objectGUID** ya que es el atributo de sincronización de directorios.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-158">If you have earlier been using DirSync and move to Azure AD Connect, then you must use **objectGUID** since that is the attribute used by DirSync.</span></span>
* <span data-ttu-id="0b5e6-159">Si se cambia el valor de sourceAnchor después de que el objeto se ha exportado a Azure AD, Azure AD Connect Sync produce un error y no permite más cambios en ese objeto antes de que el problema se haya corregido y el atributo sourceAnchor cambie de nuevo en el directorio de origen.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-159">If the value for sourceAnchor is changed after the object has been exported to Azure AD, then Azure AD Connect sync throws an error and does not allow any more changes on that object before the issue has been fixed and the sourceAnchor is changed back in the source directory.</span></span>

## <a name="using-msds-consistencyguid-as-sourceanchor"></a><span data-ttu-id="0b5e6-160">Uso de msDS-ConsistencyGuid como sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="0b5e6-160">Using msDS-ConsistencyGuid as sourceAnchor</span></span>
<span data-ttu-id="0b5e6-161">De forma predeterminada, Azure AD Connect (versión 1.1.486.0 y anteriores) usa objectGUID como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-161">By default, Azure AD Connect (version 1.1.486.0 and older) uses objectGUID as the sourceAnchor attribute.</span></span> <span data-ttu-id="0b5e6-162">objectGUID es genera en el sistema.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-162">ObjectGUID is system-generated.</span></span> <span data-ttu-id="0b5e6-163">No puede especificar su valor al crear objetos de AD locales.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-163">You cannot specify its value when creating on-premises AD objects.</span></span> <span data-ttu-id="0b5e6-164">Como se explica en la sección [sourceAnchor](#sourceanchor), en algunos escenarios es necesario especificar el valor de sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-164">As explained in section [sourceAnchor](#sourceanchor), there are scenarios where you need to specify the sourceAnchor value.</span></span> <span data-ttu-id="0b5e6-165">Si es su caso, debe usar un atributo de AD configurable (por ejemplo, msDS-ConsistencyGuid) como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-165">If the scenarios are applicable to you, you must use a configurable AD attribute (for example, msDS-ConsistencyGuid) as the sourceAnchor attribute.</span></span>

<span data-ttu-id="0b5e6-166">Ahora, Azure AD Connect (versión 1.1.524.0 y posteriores) facilita el uso de msDS-ConsistencyGuid como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-166">Azure AD Connect (version 1.1.524.0 and after) now facilitates the use of msDS-ConsistencyGuid as sourceAnchor attribute.</span></span> <span data-ttu-id="0b5e6-167">Al utilizar esta característica, Azure AD Connect configura automáticamente las reglas de sincronización para:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-167">When using this feature, Azure AD Connect automatically configures the synchronization rules to:</span></span>

1. <span data-ttu-id="0b5e6-168">Usar msDS-ConsistencyGuid como atributo sourceAnchor para los objetos de usuario.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-168">Use msDS-ConsistencyGuid as the sourceAnchor attribute for User objects.</span></span> <span data-ttu-id="0b5e6-169">objectGUID se usa para otros tipos de objeto.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-169">ObjectGUID is used for other object types.</span></span>

2. <span data-ttu-id="0b5e6-170">Para cualquier objeto de usuario de AD local cuyo atributo msDS-ConsistencyGuid no esté rellenado, Azure AD Connect escribe su propio valor objectGUID en el atributo msDS-ConsistencyGuid de la instancia local de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-170">For any given on-premises AD User object whose msDS-ConsistencyGuid attribute isn't populated, Azure AD Connect writes its objectGUID value back to the msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span> <span data-ttu-id="0b5e6-171">Después de rellenar el atributo msDS-ConsistencyGuid, Azure AD Connect exporta el objeto a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-171">After the msDS-ConsistencyGuid attribute is populated, Azure AD Connect then exports the object to Azure AD.</span></span>

>[!NOTE]
> <span data-ttu-id="0b5e6-172">Una vez que se haya importado un objeto de AD local en Azure AD Connect (es decir, que se haya importado en el espacio conector de AD y se haya proyectado en el metaverso), ya no se puede cambiar su valor para sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-172">Once an on-premises AD object is imported into Azure AD Connect (that is, imported into the AD Connector Space and projected into the Metaverse), you cannot change its sourceAnchor value anymore.</span></span> <span data-ttu-id="0b5e6-173">Para especificar el valor de sourceAnchor para un objeto de AD local determinado, configure el atributo msDS-ConsistencyGuid antes de importarlo a Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-173">To specify the sourceAnchor value for a given on-premises AD object, configure its msDS-ConsistencyGuid attribute before it is imported into Azure AD Connect.</span></span>

### <a name="permission-required"></a><span data-ttu-id="0b5e6-174">Permiso necesario</span><span class="sxs-lookup"><span data-stu-id="0b5e6-174">Permission required</span></span>
<span data-ttu-id="0b5e6-175">Para que funcione esta característica, se debe conceder a la cuenta de AD DS que se utiliza para sincronizar con la instancia local de Active Directory permiso de escritura en el atributo msDS-ConsistencyGuid de la instancia local de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-175">For this feature to work, the AD DS account used to synchronize with on-premises Active Directory must be granted write permission to the msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span>

### <a name="how-to-enable-the-consistencyguid-feature---new-installation"></a><span data-ttu-id="0b5e6-176">Habilitación de la característica ConsistencyGuid: nueva instalación</span><span class="sxs-lookup"><span data-stu-id="0b5e6-176">How to enable the ConsistencyGuid feature - New installation</span></span>
<span data-ttu-id="0b5e6-177">Puede habilitar el uso de ConsistencyGuid como sourceAnchor durante la nueva instalación.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-177">You can enable the use of ConsistencyGuid as sourceAnchor during new installation.</span></span> <span data-ttu-id="0b5e6-178">En esta sección se trata la instalación rápida y personalizada con detalle.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-178">This section covers both Express and Custom installation in details.</span></span>

  >[!NOTE]
  > <span data-ttu-id="0b5e6-179">Solo las versiones más recientes de Azure AD Connect (1.1.524.0 y posteriores) admiten el uso de ConsistencyGuid como sourceAnchor durante la nueva instalación.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-179">Only newer versions of Azure AD Connect (1.1.524.0 and after) supports the use of ConsistencyGuid as sourceAnchor during new installation.</span></span>

### <a name="how-to-enable-the-consistencyguid-feature"></a><span data-ttu-id="0b5e6-180">Habilitación de la característica ConsistencyGuid</span><span class="sxs-lookup"><span data-stu-id="0b5e6-180">How to enable the ConsistencyGuid feature</span></span>
<span data-ttu-id="0b5e6-181">Actualmente, solo se puede habilitar la característica durante una nueva instalación de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-181">Currently, the feature can only be enabled during new Azure AD Connect installation only.</span></span>

#### <a name="express-installation"></a><span data-ttu-id="0b5e6-182">Instalación rápida</span><span class="sxs-lookup"><span data-stu-id="0b5e6-182">Express Installation</span></span>
<span data-ttu-id="0b5e6-183">Cuando se instala Azure AD Connect con el modo Rápido, el asistente de Azure AD Connect determina automáticamente el atributo de AD más adecuado para usarse como atributo sourceAnchor según la lógica siguiente:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-183">When installing Azure AD Connect with Express mode, the Azure AD Connect wizard automatically determines the most appropriate AD attribute to use as the sourceAnchor attribute using the following logic:</span></span>

* <span data-ttu-id="0b5e6-184">En primer lugar, el asistente de Azure AD Connect consulta el inquilino de Azure AD para recuperar el atributo de AD usado como atributo sourceAnchor en la anterior instalación de Azure AD Connect (de haberla).</span><span class="sxs-lookup"><span data-stu-id="0b5e6-184">First, the Azure AD Connect wizard queries your Azure AD tenant to retrieve the AD attribute used as the sourceAnchor attribute in the previous Azure AD Connect installation (if any).</span></span> <span data-ttu-id="0b5e6-185">Si esta información está disponible, Azure AD Connect usa el mismo atributo de AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-185">If this information is available, Azure AD Connect uses the same AD attribute.</span></span>

  >[!NOTE]
  > <span data-ttu-id="0b5e6-186">Las versiones más recientes de Azure AD Connect (1.1.524.0 y posteriores) son las únicas que almacenan información en su inquilino de Azure AD sobre el atributo sourceAnchor usado durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-186">Only newer versions of Azure AD Connect (1.1.524.0 and after) stores information in your Azure AD tenant about the sourceAnchor attribute used during installation.</span></span> <span data-ttu-id="0b5e6-187">Las versiones anteriores de Azure AD Connect no lo hacen.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-187">Older versions of Azure AD Connect do not.</span></span>

* <span data-ttu-id="0b5e6-188">Si la información sobre el atributo sourceAnchor usado no está disponible, el asistente comprueba el estado del atributo msDS-ConsistencyGuid en su Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-188">If information about the sourceAnchor attribute used isn't available, the wizard checks the state of the msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="0b5e6-189">Si el atributo no está configurado en ningún objeto del directorio, el asistente usa msDS-ConsistencyGuid como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-189">If the attribute isn't configured on any object in the directory, the wizard uses the msDS-ConsistencyGuid as the sourceAnchor attribute.</span></span> <span data-ttu-id="0b5e6-190">Si el atributo está configurado en uno o varios objetos del directorio, el asistente concluye que el atributo se está usando en otras aplicaciones y no es adecuado como atributo sourceAnchor…</span><span class="sxs-lookup"><span data-stu-id="0b5e6-190">If the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by other applications and is not suitable as sourceAnchor attribute...</span></span>

* <span data-ttu-id="0b5e6-191">En ese caso, el asistente recurre de nuevo a usar objectGUID como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-191">In which case, the wizard falls back to using objectGUID as the sourceAnchor attribute.</span></span>

* <span data-ttu-id="0b5e6-192">Una vez que decide el atributo sourceAnchor, el asistente almacena la información en su inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-192">Once the sourceAnchor attribute is decided, the wizard stores the information in your Azure AD tenant.</span></span> <span data-ttu-id="0b5e6-193">Se usará la información en una instalación futura de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-193">The information will be used by future installation of Azure AD Connect.</span></span>

<span data-ttu-id="0b5e6-194">Una vez completada la instalación rápida, el asistente le informa de qué atributo se ha elegido como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-194">Once Express installation completes, the wizard informs you which attribute has been picked as the Source Anchor attribute.</span></span>

![El asistente informa del atributo de AD seleccionado como sourceAnchor](./media/active-directory-aadconnect-design-concepts/consistencyGuid-01.png)

#### <a name="custom-installation"></a><span data-ttu-id="0b5e6-196">Instalación personalizada</span><span class="sxs-lookup"><span data-stu-id="0b5e6-196">Custom installation</span></span>
<span data-ttu-id="0b5e6-197">Cuando se instala Azure AD Connect con el modo Personalizado, el asistente de Azure AD Connect proporciona dos opciones al configurar el atributo sourceAnchor:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-197">When installing Azure AD Connect with Custom mode, the Azure AD Connect wizard provides two options when configuring sourceAnchor attribute:</span></span>

![Instalación personalizada: configuración de sourceAnchor](./media/active-directory-aadconnect-design-concepts/consistencyGuid-02.png)

| <span data-ttu-id="0b5e6-199">Configuración</span><span class="sxs-lookup"><span data-stu-id="0b5e6-199">Setting</span></span> | <span data-ttu-id="0b5e6-200">Descripción</span><span class="sxs-lookup"><span data-stu-id="0b5e6-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="0b5e6-201">Let Azure manage the source anchor for me (Dejar que Azure administre automáticamente el delimitador de origen)</span><span class="sxs-lookup"><span data-stu-id="0b5e6-201">Let Azure manage the source anchor for me</span></span> | <span data-ttu-id="0b5e6-202">Seleccione esta opción si desea que Azure AD elija automáticamente el atributo.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-202">Select this option if you want Azure AD to pick the attribute for you.</span></span> <span data-ttu-id="0b5e6-203">Si selecciona esta opción, el asistente de Azure AD Connect aplica la misma [lógica de selección del atributo sourceAnchor usada durante la instalación rápida](#express-installation).</span><span class="sxs-lookup"><span data-stu-id="0b5e6-203">If you select this option, Azure AD Connect wizard applies the same [sourceAnchor attribute selection logic used during Express installation](#express-installation).</span></span> <span data-ttu-id="0b5e6-204">De forma parecida a la instalación rápida, el asistente indica qué atributo se ha elegido como atributo sourceAnchor una vez finalizada la instalación personalizada.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-204">Similar to Express installation, the wizard informs you which attribute has been picked as the Source Anchor attribute after Custom installation completes.</span></span> |
| <span data-ttu-id="0b5e6-205">Un atributo específico</span><span class="sxs-lookup"><span data-stu-id="0b5e6-205">A specific attribute</span></span> | <span data-ttu-id="0b5e6-206">Seleccione esta opción si desea especificar un atributo existente de AD como atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-206">Select this option if you wish to specify an existing AD attribute as the sourceAnchor attribute.</span></span> |

### <a name="how-to-enable-the-consistencyguid-feature---existing-deployment"></a><span data-ttu-id="0b5e6-207">Habilitación de la característica ConsistencyGuid: implementación existente</span><span class="sxs-lookup"><span data-stu-id="0b5e6-207">How to enable the ConsistencyGuid feature - Existing deployment</span></span>
<span data-ttu-id="0b5e6-208">Si tiene una implementación de Azure AD Connect existente que está usando objectGUID como el atributo sourceAnchor, puede cambiarla para usar ConsistencyGuid en su lugar.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-208">If you have an existing Azure AD Connect deployment which is using objectGUID as the Source Anchor attribute, you can switch it to using ConsistencyGuid instead.</span></span>

>[!NOTE]
> <span data-ttu-id="0b5e6-209">Solo las versiones más recientes de Azure AD Connect (1.1.552.0 y posteriores) admiten el cambio de ObjectGuid a ConsistencyGuid como el atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-209">Only newer versions of Azure AD Connect (1.1.552.0 and after) supports switching from ObjectGuid to ConsistencyGuid as the Source Anchor attribute.</span></span>

<span data-ttu-id="0b5e6-210">Para cambiar de objectGUID a ConsistencyGuid como el atributo sourceAnchor:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-210">To switch from objectGUID to ConsistencyGuid as the Source Anchor attribute:</span></span>

1. <span data-ttu-id="0b5e6-211">Inicie el asistente de Azure AD Connect y haga clic en **Configurar** para ir a la pantalla de tareas.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-211">Start the Azure AD Connect wizard and click **Configure** to go to the Tasks screen.</span></span>

2. <span data-ttu-id="0b5e6-212">Seleccione la opción de tarea **Configuración del delimitador de origen** y haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-212">Select the **Configure Source Anchor** task option and click **Next**.</span></span>

   ![Habilitación de ConsistencyGuid para la implementación existente: paso 2](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment01.png)

3. <span data-ttu-id="0b5e6-214">Escriba sus credenciales de administrador de Azure AD y haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-214">Enter your Azure AD Administrator credentials and click **Next**.</span></span>

4. <span data-ttu-id="0b5e6-215">El asistente de Azure AD Connect analiza el estado del atributo msDS-ConsistencyGuid en Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-215">Azure AD Connect wizard analyzes the state of the msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="0b5e6-216">Si el atributo no está configurado en ningún objeto del directorio, Azure AD Connect concluye que ninguna otra aplicación está usando en estos momentos el atributo y es seguro usarlo como el atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-216">If the attribute isn't configured on any object in the directory, Azure AD Connect concludes that no other application is currently using the attribute and is safe to use it as the Source Anchor attribute.</span></span> <span data-ttu-id="0b5e6-217">Haga clic en **Siguiente** para continuar.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-217">Click **Next** to continue.</span></span>

   ![Habilitación de ConsistencyGuid para la implementación existente: paso 4](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment02.png)

5. <span data-ttu-id="0b5e6-219">En la pantalla **Listo para configurar**, haga clic en **Configurar** para que la configuración cambie.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-219">In the **Ready to Configure** screen, click **Configure** to make the configuration change.</span></span>

   ![Habilitación de ConsistencyGuid para la implementación existente: paso 5](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment03.png)

6. <span data-ttu-id="0b5e6-221">Una vez que se complete la configuración, el asistente indica que msDS-ConsistencyGuid ahora se usa como el atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-221">Once the configuration completes, the wizard indicates that msDS-ConsistencyGuid is now being used as the Source Anchor attribute.</span></span>

   ![Habilitación de ConsistencyGuid para la implementación existente: paso 6](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment04.png)

<span data-ttu-id="0b5e6-223">Durante el análisis (paso 4), si el atributo está configurado en uno o varios objetos del directorio, el asistente concluye que el atributo se está usando en otra aplicación y devuelve un error, como se ilustra en la imagen siguiente.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-223">During the analysis (step 4), if the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by another application and returns an error as illustrated in the diagram below.</span></span> <span data-ttu-id="0b5e6-224">Si está seguro de que el atributo no se está usando en aplicaciones existentes, debe ponerse en contacto con el soporte técnico para obtener información sobre cómo suprimir el error.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-224">If you are certain that the attribute isn't used by existing applications, you need to contact Support for information on how to suppress the error.</span></span>

![Habilitación de ConsistencyGuid para la implementación existente: error](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeploymenterror.png)

### <a name="impact-on-ad-fs-or-third-party-federation-configuration"></a><span data-ttu-id="0b5e6-226">Repercusiones en AD FS o la configuración de la federación de terceros</span><span class="sxs-lookup"><span data-stu-id="0b5e6-226">Impact on AD FS or third-party federation configuration</span></span>
<span data-ttu-id="0b5e6-227">Si usa Azure AD Connect para administrar una implementación de AD FS local, Azure AD Connect actualiza automáticamente las reglas de notificación para que usen el mismo atributo de AD como sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-227">If you are using Azure AD Connect to manage on-premises AD FS deployment, the Azure AD Connect automatically updates the claim rules to use the same AD attribute as sourceAnchor.</span></span> <span data-ttu-id="0b5e6-228">Esto garantiza que la notificación de ImmutableID generada por AD FS sea coherente con los valores de sourceAnchor que se exportan a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-228">This ensures that the ImmutableID claim generated by ADFS is consistent with the sourceAnchor values exported to Azure AD.</span></span>

<span data-ttu-id="0b5e6-229">Si administra AD FS fuera de Azure AD Connect o usa servidores de federación de terceros para la autenticación, debe actualizar manualmente las reglas de notificación para que la notificación de ImmutableID sea coherente con los valores de sourceAnchor exportados a Azure AD, como se describe en la sección del artículo [Modificación de las reglas de notificaciones de AD FS](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims).</span><span class="sxs-lookup"><span data-stu-id="0b5e6-229">If you are managing AD FS outside of Azure AD Connect or you are using third-party federation servers for authentication, you must manually update the claim rules for ImmutableID claim to be consistent with the sourceAnchor values exported to Azure AD as described in article section [Modify AD FS claim rules](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims).</span></span> <span data-ttu-id="0b5e6-230">El asistente devuelve la siguiente advertencia al completarse la instalación:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-230">The wizard returns the following warning after installation completes:</span></span>

![Configuración de federación de terceros](./media/active-directory-aadconnect-design-concepts/consistencyGuid-03.png)

### <a name="adding-new-directories-to-existing-deployment"></a><span data-ttu-id="0b5e6-232">Incorporación de nuevos directorios a la implementación existente</span><span class="sxs-lookup"><span data-stu-id="0b5e6-232">Adding new directories to existing deployment</span></span>
<span data-ttu-id="0b5e6-233">Suponga que ha implementado Azure AD Connect con la característica ConsistencyGuid habilitada y ahora desea agregar otro directorio a la implementación.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-233">Suppose you have deployed Azure AD Connect with the ConsistencyGuid feature enabled, and now you would like to add another directory to the deployment.</span></span> <span data-ttu-id="0b5e6-234">Cuando intenta agregarlo, el asistente de Azure AD Connect comprueba el estado del atributo msDS-ConsistencyGuid en el directorio.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-234">When you try to add the directory, Azure AD Connect wizard checks the state of the mSDS-ConsistencyGuid attribute in the directory.</span></span> <span data-ttu-id="0b5e6-235">Si el atributo está configurado en uno o varios objetos del directorio, el asistente concluye que el atributo se está usando en otras aplicaciones y devuelve un error, como se ilustra en la imagen siguiente.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-235">If the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by other applications and returns an error as illustrated in the diagram below.</span></span> <span data-ttu-id="0b5e6-236">Si está seguro de que el atributo no se está usando en aplicaciones existentes, debe ponerse en contacto con el soporte técnico para obtener información sobre cómo suprimir el error.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-236">If you are certain that the attribute isn't used by existing applications, you need to contact Support for information on how to suppress the error.</span></span>

![Incorporación de nuevos directorios a la implementación existente](./media/active-directory-aadconnect-design-concepts/consistencyGuid-04.png)

## <a name="azure-ad-sign-in"></a><span data-ttu-id="0b5e6-238">Inicio de sesión de Azure AD</span><span class="sxs-lookup"><span data-stu-id="0b5e6-238">Azure AD sign-in</span></span>
<span data-ttu-id="0b5e6-239">Al integrar su directorio local con Azure AD, es importante entender cómo la configuración de sincronización puede afectar a la forma en la que los usuarios se autentican.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-239">While integrating your on-premises directory with Azure AD, it is important to understand how the synchronization settings can affect the way user authenticates.</span></span> <span data-ttu-id="0b5e6-240">Azure AD usa userPrincipalName (UPN) para autenticar al usuario.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-240">Azure AD uses userPrincipalName (UPN) to authenticate the user.</span></span> <span data-ttu-id="0b5e6-241">Sin embargo, al sincronizar los usuarios tiene que elegir el atributo que se utilizará para el valor userPrincipalName cuidadosamente.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-241">However, when you synchronize your users, you must choose the attribute to be used for value of userPrincipalName carefully.</span></span>

### <a name="choosing-the-attribute-for-userprincipalname"></a><span data-ttu-id="0b5e6-242">Selección del atributo para userPrincipalName</span><span class="sxs-lookup"><span data-stu-id="0b5e6-242">Choosing the attribute for userPrincipalName</span></span>
<span data-ttu-id="0b5e6-243">Cuando se selecciona el atributo para proporcionar el valor de UPN que se va a usar en Azure es necesario asegurarse de lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0b5e6-243">When you are selecting the attribute for providing the value of UPN to be used in Azure one should ensure</span></span>

* <span data-ttu-id="0b5e6-244">Los valores de atributo se ajustan a la sintaxis UPN (RFC 822), es decir, debe tener el formato username@domain</span><span class="sxs-lookup"><span data-stu-id="0b5e6-244">The attribute values conform to the UPN syntax (RFC 822), that is it should be of the format username@domain</span></span>
* <span data-ttu-id="0b5e6-245">El sufijo en los valores coincide con uno de los dominios personalizados comprobados en Azure AD</span><span class="sxs-lookup"><span data-stu-id="0b5e6-245">The suffix in the values matches to one of the verified custom domains in Azure AD</span></span>

<span data-ttu-id="0b5e6-246">En la configuración rápida, la opción que se presupone para el atributo es userPrincipalName.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-246">In express settings, the assumed choice for the attribute is userPrincipalName.</span></span> <span data-ttu-id="0b5e6-247">Si el atributo userPrincipalName no contiene el valor que quiera que los usuarios inicien sesión en Azure, debe elegir la **instalación personalizada**.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-247">If the userPrincipalName attribute does not contain the value you want your users to sign in to Azure, then you must choose **Custom Installation**.</span></span>

### <a name="custom-domain-state-and-upn"></a><span data-ttu-id="0b5e6-248">Estado de dominio personalizado y UPN</span><span class="sxs-lookup"><span data-stu-id="0b5e6-248">Custom domain state and UPN</span></span>
<span data-ttu-id="0b5e6-249">Es importante asegurarse de que hay un dominio comprobado para el sufijo UPN.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-249">It is important to ensure that there is a verified domain for the UPN suffix.</span></span>

<span data-ttu-id="0b5e6-250">John es un usuario de "contoso.com".</span><span class="sxs-lookup"><span data-stu-id="0b5e6-250">John is a user in contoso.com.</span></span> <span data-ttu-id="0b5e6-251">Desea que John use el UPN local john@contoso.com para iniciar sesión en Azure después haber sincronizado a los usuarios con el directorio de Azure AD azurecontoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-251">You want John to use the on-premises UPN john@contoso.com to sign in to Azure after you have synced users to your Azure AD directory contoso.onmicrosoft.com.</span></span> <span data-ttu-id="0b5e6-252">Para ello, tiene que agregar y comprobar "contoso.com" como un dominio personalizado en Azure AD antes de sincronizar a los usuarios.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-252">To do so, you need to add and verify contoso.com as a custom domain in Azure AD before you can start syncing the users.</span></span> <span data-ttu-id="0b5e6-253">Si el sufijo UPN de John, por ejemplo, contoso.com, no coincide con un dominio comprobado en Azure AD, Azure AD reemplaza el sufijo UPN con contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-253">If the UPN suffix of John, for example contoso.com, does not match a verified domain in Azure AD, then Azure AD replaces the UPN suffix with contoso.onmicrosoft.com.</span></span>

### <a name="non-routable-on-premises-domains-and-upn-for-azure-ad"></a><span data-ttu-id="0b5e6-254">Dominios locales no enrutables y UPN para Azure AD</span><span class="sxs-lookup"><span data-stu-id="0b5e6-254">Non-routable on-premises domains and UPN for Azure AD</span></span>
<span data-ttu-id="0b5e6-255">Algunas organizaciones tienen dominios no enrutables, como "contoso.local" o dominios de etiqueta única simple como "contoso".</span><span class="sxs-lookup"><span data-stu-id="0b5e6-255">Some organizations have non-routable domains, like contoso.local, or simple single label domains like contoso.</span></span> <span data-ttu-id="0b5e6-256">No podrá comprobar un dominio no enrutable en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-256">You are not able to verify a non-routable domain in Azure AD.</span></span> <span data-ttu-id="0b5e6-257">Azure AD Connect puede sincronizarse solo con un dominio comprobado en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-257">Azure AD Connect can sync to only a verified domain in Azure AD.</span></span> <span data-ttu-id="0b5e6-258">Cuando se crea un directorio de Azure AD, se crea un dominio enrutable que se convierte en el dominio predeterminado para Azure SD, por ejemplo, "contoso.onmicrosoft.com".</span><span class="sxs-lookup"><span data-stu-id="0b5e6-258">When you create an Azure AD directory, it creates a routable domain that becomes default domain for your Azure AD for example, contoso.onmicrosoft.com.</span></span> <span data-ttu-id="0b5e6-259">Por lo tanto, es necesario comprobar cualquier otro dominio enrutable en este escenario, en caso de que no desee sincronizar con el valor predeterminado ".onmicrosoft.com".</span><span class="sxs-lookup"><span data-stu-id="0b5e6-259">Therefore, it becomes necessary to verify any other routable domain in such a scenario in case you don't want to sync to the default onmicrosoft.com domain.</span></span>

<span data-ttu-id="0b5e6-260">Consulte [Incorporación de su nombre de dominio personalizado a Azure Active Directory](../active-directory-add-domain.md) para más información sobre cómo agregar y comprobar dominios.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-260">Read [Add your custom domain name to Azure Active Directory](../active-directory-add-domain.md) for more info on adding and verifying domains.</span></span>

<span data-ttu-id="0b5e6-261">Azure AD Connect detecta si está ejecutando en un entorno de dominio no enrutable y le advertirá adecuadamente antes de que prosiga con la configuración rápida.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-261">Azure AD Connect detects if you are running in a non-routable domain environment and would appropriately warn you from going ahead with express settings.</span></span> <span data-ttu-id="0b5e6-262">Si está trabajando en un dominio no enrutable, es probable que el UPN de los usuarios tenga también un sufijo no enrutable.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-262">If you are operating in a non-routable domain, then it is likely that the UPN of the users have non-routable suffixes too.</span></span> <span data-ttu-id="0b5e6-263">Por ejemplo, si se ejecuta bajo "contoso.local", Azure AD Connect le sugiere que utilice la configuración personalizada en lugar de la configuración rápida.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-263">For example, if you are running under contoso.local, Azure AD Connect suggests you to use custom settings rather than using express settings.</span></span> <span data-ttu-id="0b5e6-264">Al usar una configuración personalizada, podrá especificar el atributo que debe usarse como UPN para iniciar sesión en Azure después de que los usuarios se sincronicen con Azure AD.</span><span class="sxs-lookup"><span data-stu-id="0b5e6-264">Using custom settings, you are able to specify the attribute that should be used as UPN to sign in to Azure after the users are synced to Azure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0b5e6-265">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="0b5e6-265">Next steps</span></span>
<span data-ttu-id="0b5e6-266">Obtenga más información sobre la [Integración de las identidades locales con Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="0b5e6-266">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
