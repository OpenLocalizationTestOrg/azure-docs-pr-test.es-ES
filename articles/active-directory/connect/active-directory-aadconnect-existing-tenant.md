---
title: 'Azure AD Connect: si ya tiene Azure AD | Microsoft Docs'
description: "En este tema se describe cómo utilizar Connect si ya tiene un inquilino de Azure AD."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: 908c576b0427a23934c844362a4fd69443800d0f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-when-you-have-an-existent-tenant"></a><span data-ttu-id="b40dc-103">Azure AD Connect: cuando ya hay un inquilino</span><span class="sxs-lookup"><span data-stu-id="b40dc-103">Azure AD Connect: When you have an existent tenant</span></span>
<span data-ttu-id="b40dc-104">En la mayoría de los temas sobre cómo usar Azure AD Connect se da por supuesto que empieza con un nuevo inquilino de Azure AD sin objetos ni usuarios.</span><span class="sxs-lookup"><span data-stu-id="b40dc-104">Most of the topics for how to use Azure AD Connect assumes you start with a new Azure AD tenant and that there are no users or other objects there.</span></span> <span data-ttu-id="b40dc-105">Sin embargo, si ha empezado con un inquilino de Azure AD, rellenado con usuarios y otros objetos, y ahora desea utilizar Connect, eche un vistazo a este tema.</span><span class="sxs-lookup"><span data-stu-id="b40dc-105">But if you have started with an Azure AD tenant, populated it with users and other objects, and now want to use Connect, then this topic is for you.</span></span>

## <a name="the-basics"></a><span data-ttu-id="b40dc-106">Conceptos básicos</span><span class="sxs-lookup"><span data-stu-id="b40dc-106">The basics</span></span>
<span data-ttu-id="b40dc-107">Un objeto de Azure AD se controla en la nube (Azure AD) o en un entorno local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-107">An object in Azure AD is either mastered in the cloud (Azure AD) or on-premises.</span></span> <span data-ttu-id="b40dc-108">En el caso de un solo objeto, no puede administrar algunos atributos en un entorno local y otros atributos en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-108">For one single object, you cannot manage some attributes on-premises and some other attributes in Azure AD.</span></span> <span data-ttu-id="b40dc-109">Cada objeto tiene una marca que indica que el objeto se ha administrado.</span><span class="sxs-lookup"><span data-stu-id="b40dc-109">Each object has a flag indicating where the object is managed.</span></span>

<span data-ttu-id="b40dc-110">Puede administrar algunos usuarios locales y otros en la nube.</span><span class="sxs-lookup"><span data-stu-id="b40dc-110">You can manage some users on-premises and other in the cloud.</span></span> <span data-ttu-id="b40dc-111">Un escenario común de esta configuración es una organización que tiene una combinación de trabajadores de contabilidad y trabajadores de ventas.</span><span class="sxs-lookup"><span data-stu-id="b40dc-111">A common scenario for this configuration is an organization with a mix of accounting workers and sales workers.</span></span> <span data-ttu-id="b40dc-112">Los trabajadores de contabilidad tienen una cuenta de AD local; sin embargo los trabajadores de ventas no, ellos tienen una cuenta de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-112">The accounting workers have an on-premises AD account, but the sales workers do not, they have an account in Azure AD.</span></span> <span data-ttu-id="b40dc-113">Tendría que administrar algunos usuarios en el entorno local y otros en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-113">You would manage some users on-premises and some in Azure AD.</span></span>

<span data-ttu-id="b40dc-114">Si ya comenzó a administrar usuarios en Azure AD que también se encuentran en AD local y, posteriormente, desea volver a utilizar Connect, debe tener en cuenta más escenarios.</span><span class="sxs-lookup"><span data-stu-id="b40dc-114">If you started to manage users in Azure AD that are also in on-premises AD and later want to use Connect, then there are some additional concerns you need to consider.</span></span>

## <a name="sync-with-existing-users-in-azure-ad"></a><span data-ttu-id="b40dc-115">Sincronización con los usuarios existentes de Azure AD</span><span class="sxs-lookup"><span data-stu-id="b40dc-115">Sync with existing users in Azure AD</span></span>
<span data-ttu-id="b40dc-116">Al instalar Azure AD Connect y empezar a sincronizar, el servicio de sincronización de Azure AD (en Azure AD) realiza una comprobación de cada nuevo objeto y trata de buscar un objeto coincidente que ya existe.</span><span class="sxs-lookup"><span data-stu-id="b40dc-116">When you install Azure AD Connect and you start synchronizing, the Azure AD sync service (in Azure AD) does a check on every new object and try to find an existing object to match.</span></span> <span data-ttu-id="b40dc-117">Hay tres atributos que se utilizan para este proceso: **userPrincipalName**, **proxyAddresses** y **sourceAnchor**/**immutableID**.</span><span class="sxs-lookup"><span data-stu-id="b40dc-117">There are three attributes used for this process: **userPrincipalName**, **proxyAddresses**, and **sourceAnchor**/**immutableID**.</span></span> <span data-ttu-id="b40dc-118">Una coincidencia de **userPrincipalName** y **proxyAddresses** se conoce como **coincidencia parcial**.</span><span class="sxs-lookup"><span data-stu-id="b40dc-118">A match on **userPrincipalName** and **proxyAddresses** is known as a **soft match**.</span></span> <span data-ttu-id="b40dc-119">Una coincidencia de **sourceAnchor** se conoce como **coincidencia exacta**.</span><span class="sxs-lookup"><span data-stu-id="b40dc-119">A match on **sourceAnchor** is known as **hard match**.</span></span> <span data-ttu-id="b40dc-120">En el caso del atributo **proxyAddresses**, solo se usa para la evaluación el valor con el atributo **SMTP:**, que es la dirección de correo electrónico principal.</span><span class="sxs-lookup"><span data-stu-id="b40dc-120">For the **proxyAddresses** attribute only the value with **SMTP:**, that is the primary email address, is used for the evaluation.</span></span>

<span data-ttu-id="b40dc-121">La coincidencia solo se evalúa para los nuevos objetos procedentes de Connect.</span><span class="sxs-lookup"><span data-stu-id="b40dc-121">The match is only evaluated for new objects coming from Connect.</span></span> <span data-ttu-id="b40dc-122">Si cambia uno que ya exista para que coincida con alguno de estos atributos, verá un error en su lugar.</span><span class="sxs-lookup"><span data-stu-id="b40dc-122">If you change an exiting object so it is matching any of these attributes, then you see an error instead.</span></span>

<span data-ttu-id="b40dc-123">Si Azure AD encuentra un objeto cuyos valores de atributo son los mismos que los de uno procedente de Connect y que ya se encuentra en Azure AD, el objeto de Azure AD pasa a ser propiedad de Connect.</span><span class="sxs-lookup"><span data-stu-id="b40dc-123">If Azure AD finds an object where the attribute values are the same for an object coming from Connect and that it is already present in Azure AD, then the object in Azure AD is taken over by Connect.</span></span> <span data-ttu-id="b40dc-124">El objeto administrado previamente en la nube se marca como administrado en local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-124">The previously cloud-managed object is flagged as on-premises managed.</span></span> <span data-ttu-id="b40dc-125">Todos los atributos de Azure AD con un valor en AD local se sobrescriben con el valor local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-125">All attributes in Azure AD with a value in on-premises AD are overwritten with the on-premises value.</span></span> <span data-ttu-id="b40dc-126">La excepción es cuando un atributo tiene un valor **NULL** local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-126">The exception is when an attribute has a **NULL** value on-premises.</span></span> <span data-ttu-id="b40dc-127">En este caso, el valor sigue estando en Azure AD, pero solo podrá cambiarlo en local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-127">In this case, the value in Azure AD remains, but you can still only change it on-premises to something else.</span></span>

> [!WARNING]
> <span data-ttu-id="b40dc-128">Puesto que todos los atributos de Azure AD se van a sobrescribir por el valor local, asegúrese de que dispone de datos en buen estado en un entorno local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-128">Since all attributes in Azure AD are going to be overwritten by the on-premises value, make sure you have good data on-premises.</span></span> <span data-ttu-id="b40dc-129">Por ejemplo, si solo tiene una dirección de correo electrónico administrada en Office 365 y no se mantiene actualizada en AD DS local, se pierden todos los valores de Azure AD u Office 365 que no se encuentren en AD DS.</span><span class="sxs-lookup"><span data-stu-id="b40dc-129">For example, if you only have managed email address in Office 365 and not kept it updated in on-premises AD DS, then you lose any values in Azure AD/Office 365 not present in AD DS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b40dc-130">Si usa la sincronización de contraseñas, que siempre se utiliza en la configuración rápida, la contraseña de Azure AD se sobrescribe por la de AD local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-130">If you use password sync, which is always used by express settings, then the password in Azure AD is overwritten with the password in on-premises AD.</span></span> <span data-ttu-id="b40dc-131">Si los usuarios se usan para administrar contraseñas diferentes, tendrá que informarles de que deben usar la contraseña local tras instalar Connect.</span><span class="sxs-lookup"><span data-stu-id="b40dc-131">If your users are used to manage different passwords, then you need to inform them that they should use the on-premises password when you have installed Connect.</span></span>

<span data-ttu-id="b40dc-132">Hay que tener en cuenta en la planeación la sección anterior y la advertencia.</span><span class="sxs-lookup"><span data-stu-id="b40dc-132">The previous section and warning must be considered in your planning.</span></span> <span data-ttu-id="b40dc-133">Si ha realizado muchos cambios en Azure AD que no se reflejan en AD DS local, debe planear cómo rellenar AD DS con los valores actualizados antes de sincronizar los objetos con Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="b40dc-133">If you have made many changes in Azure AD not reflected in on-premises AD DS, then you need to plan for how to populate AD DS with the updated values before you sync your objects with Azure AD Connect.</span></span>

<span data-ttu-id="b40dc-134">Si hay una coincidencia parcial de objetos, el atributo **sourceAnchor** se agrega al objeto en Azure AD para que más tarde se pueda usar una coincidencia exacta.</span><span class="sxs-lookup"><span data-stu-id="b40dc-134">If you matched your objects with a soft-match, then the **sourceAnchor** is added to the object in Azure AD so a hard match can be used later.</span></span>

### <a name="hard-match-vs-soft-match"></a><span data-ttu-id="b40dc-135">Diferencias entre la coincidencia parcial y la exacta</span><span class="sxs-lookup"><span data-stu-id="b40dc-135">Hard-match vs Soft-match</span></span>
<span data-ttu-id="b40dc-136">En una instalación nueva de Connect, apenas las hay.</span><span class="sxs-lookup"><span data-stu-id="b40dc-136">For a new installation of Connect, there is no practical difference between a soft- and a hard-match.</span></span> <span data-ttu-id="b40dc-137">La diferencia reside en los escenarios de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="b40dc-137">The difference is in a disaster recovery situation.</span></span> <span data-ttu-id="b40dc-138">Si su servidor ha perdido la conexión con Azure AD Connect, puede volver a instalar una nueva instancia sin perder datos.</span><span class="sxs-lookup"><span data-stu-id="b40dc-138">If you have lost your server with Azure AD Connect, you can reinstall a new instance without losing any data.</span></span> <span data-ttu-id="b40dc-139">Un objeto con un atributo sourceAnchor se envía a Connect durante la instalación inicial.</span><span class="sxs-lookup"><span data-stu-id="b40dc-139">An object with a sourceAnchor is sent to Connect during initial install.</span></span> <span data-ttu-id="b40dc-140">Después, el cliente (Azure AD Connect) puede evaluar la coincidencia, con lo que el proceso es más mucho rápido que se si hace en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-140">The match can then be evaluated by the client (Azure AD Connect), which is a lot faster than doing the same in Azure AD.</span></span> <span data-ttu-id="b40dc-141">Las coincidencias exactas las evalúan Connect y Azure AD,</span><span class="sxs-lookup"><span data-stu-id="b40dc-141">A hard match is evaluated both by Connect and by Azure AD.</span></span> <span data-ttu-id="b40dc-142">y las parciales, Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-142">A soft match is only evaluated by Azure AD.</span></span>

### <a name="other-objects-than-users"></a><span data-ttu-id="b40dc-143">Otros objetos distintos a los usuarios</span><span class="sxs-lookup"><span data-stu-id="b40dc-143">Other objects than users</span></span>
<span data-ttu-id="b40dc-144">Los usuarios suelen tener los atributos userPrincipalName y proxyAddresses, lo que facilita el proceso de coincidencia.</span><span class="sxs-lookup"><span data-stu-id="b40dc-144">Users usually have both userPrincipalName and proxyAddresses, making the match easy.</span></span> <span data-ttu-id="b40dc-145">Sin embargo, otros objetos, como los grupos de seguridad, no los tienen.</span><span class="sxs-lookup"><span data-stu-id="b40dc-145">But other objects, such as security groups, do not have those.</span></span> <span data-ttu-id="b40dc-146">En este caso, solo se pueden realizar coincidencias exactas con el atributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="b40dc-146">In this case, you can only match on a hard match using the sourceAnchor.</span></span> <span data-ttu-id="b40dc-147">Este atributo siempre es el valor **objectGUID** local convertido a Base64, por lo que debe actualizarlo en Azure AD cuando necesite que dos objetos coincidan.</span><span class="sxs-lookup"><span data-stu-id="b40dc-147">The sourceAnchor is always the Base64 converted **objectGUID** on-premises, so you must update the value in Azure AD when you need two objects to match.</span></span> <span data-ttu-id="b40dc-148">sourceAnchor e immutableID solo pueden actualizarse con PowerShell y no a través de los portales.</span><span class="sxs-lookup"><span data-stu-id="b40dc-148">The sourceAnchor/immutableID can only be updated with PowerShell and not through the portals.</span></span>

## <a name="create-a-new-on-premises-active-directory-from-data-in-azure-ad"></a><span data-ttu-id="b40dc-149">Creación de una instancia de Active Directory local a partir de los datos de Azure AD</span><span class="sxs-lookup"><span data-stu-id="b40dc-149">Create a new on-premises Active Directory from data in Azure AD</span></span>
<span data-ttu-id="b40dc-150">Algunos clientes comienzan con una solución solo en la nube con Azure AD y no tienen una implementación de AD local.</span><span class="sxs-lookup"><span data-stu-id="b40dc-150">Some customers start with a cloud-only solution with Azure AD and they do not have an on-premises AD.</span></span> <span data-ttu-id="b40dc-151">Más adelante, desean consumir recursos locales y crear una implementación de AD local basada en los datos de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-151">Later they want to consume on-premises resources and want to build an on-premises AD based on Azure AD data.</span></span> <span data-ttu-id="b40dc-152">Azure AD Connect no puede ayudarlo en este escenario,</span><span class="sxs-lookup"><span data-stu-id="b40dc-152">Azure AD Connect cannot help you for this scenario.</span></span> <span data-ttu-id="b40dc-153">ya que no crea los usuarios locales y no tiene ninguna funcionalidad para hacer que la contraseña local sea la misma que la de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="b40dc-153">It does not create users on-premises and it does not have any ability to set the password on-premises to the same as in Azure AD.</span></span>

<span data-ttu-id="b40dc-154">Si la única razón por la que piensa agregar AD local es admitir LOB (aplicaciones de línea de negocio), quizá debería plantearse usar los [servicios de dominio de Azure AD](../../active-directory-domain-services/index.md) en su lugar.</span><span class="sxs-lookup"><span data-stu-id="b40dc-154">If the only reason why you plan to add on-premises AD is to support LOBs (Line-of-Business apps), then maybe you should consider to use [Azure AD domain services](../../active-directory-domain-services/index.md) instead.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b40dc-155">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="b40dc-155">Next steps</span></span>
<span data-ttu-id="b40dc-156">Obtenga más información sobre la [Integración de las identidades locales con Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="b40dc-156">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
