---
title: "Connect de Azure AD: Cómo limitar toorecover de LocalDB 10GB problema | Documentos de Microsoft"
description: "Este tema describe cómo toorecover sincronización de Azure AD Connect Service cuando encuentra LocalDB 10GB limitar el problema."
services: active-directory
documentationcenter: 
author: cychua
manager: femila
editor: 
ms.assetid: 41d081af-ed89-4e17-be34-14f7e80ae358
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: 7b8ce6e19b68837639017bb0315eda4b924d525a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-how-toorecover-from-localdb-10-gb-limit"></a><span data-ttu-id="feee7-103">Connect de Azure AD: Cómo toorecover de límite de 10 GB de LocalDB</span><span class="sxs-lookup"><span data-stu-id="feee7-103">Azure AD Connect: How toorecover from LocalDB 10-GB limit</span></span>
<span data-ttu-id="feee7-104">Azure AD Connect requiere un datos de identidad de toostore de base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="feee7-104">Azure AD Connect requires a SQL Server database toostore identity data.</span></span> <span data-ttu-id="feee7-105">Puede usar SQL Server 2012 Express LocalDB instalada con Azure AD Connect de forma predeterminada de Hola o usar su propio SQL completa.</span><span class="sxs-lookup"><span data-stu-id="feee7-105">You can either use hello default SQL Server 2012 Express LocalDB installed with Azure AD Connect or use your own full SQL.</span></span> <span data-ttu-id="feee7-106">SQL Server Express impone un límite en el tamaño de 10 GB.</span><span class="sxs-lookup"><span data-stu-id="feee7-106">SQL Server Express imposes a 10-GB size limit.</span></span> <span data-ttu-id="feee7-107">Si usa LocalDB y se alcanza este límite, el servicio Azure AD Connect Synchronization no podrá iniciarse ni sincronizarse correctamente.</span><span class="sxs-lookup"><span data-stu-id="feee7-107">When using LocalDB and this limit is reached, Azure AD Connect Synchronization Service can no longer start or synchronize properly.</span></span> <span data-ttu-id="feee7-108">Este artículo proporciona pasos de recuperación de Hola.</span><span class="sxs-lookup"><span data-stu-id="feee7-108">This article provides hello recovery steps.</span></span>

## <a name="symptoms"></a><span data-ttu-id="feee7-109">Síntomas</span><span class="sxs-lookup"><span data-stu-id="feee7-109">Symptoms</span></span>
<span data-ttu-id="feee7-110">Hay dos síntomas comunes:</span><span class="sxs-lookup"><span data-stu-id="feee7-110">There are two common symptoms:</span></span>

* <span data-ttu-id="feee7-111">Servicio de sincronización de Connect de Azure AD **está ejecutando** , pero se produce un error toosynchronize con *"detenido-base de datos-disco lleno"* error.</span><span class="sxs-lookup"><span data-stu-id="feee7-111">Azure AD Connect Synchronization Service **is running** but fails toosynchronize with *“stopped-database-disk-full”* error.</span></span>

* <span data-ttu-id="feee7-112">Servicio de sincronización de Connect de Azure AD **es toostart no se puede**.</span><span class="sxs-lookup"><span data-stu-id="feee7-112">Azure AD Connect Synchronization Service **is unable toostart**.</span></span> <span data-ttu-id="feee7-113">Si trata de servicio de hello toostart, se produce un error con mensajes de error y eventos 6323 *"servidor hello detectó un error porque SQL Server está fuera del espacio en disco".*</span><span class="sxs-lookup"><span data-stu-id="feee7-113">When you attempt toostart hello service, it fails with event 6323 and error message *"hello server encountered an error because SQL Server is out of disk space."*</span></span>

## <a name="short-term-recovery-steps"></a><span data-ttu-id="feee7-114">Pasos para una recuperación a corto plazo</span><span class="sxs-lookup"><span data-stu-id="feee7-114">Short-term recovery steps</span></span>
<span data-ttu-id="feee7-115">Esta sección proporciona espacio en tooreclaim DB Hola pasos necesario para la operación de servicio de sincronización Connect de Azure AD tooresume.</span><span class="sxs-lookup"><span data-stu-id="feee7-115">This section provides hello steps tooreclaim DB space required for Azure AD Connect Synchronization Service tooresume operation.</span></span> <span data-ttu-id="feee7-116">Hola pasos incluyen:</span><span class="sxs-lookup"><span data-stu-id="feee7-116">hello steps include:</span></span>
1. [<span data-ttu-id="feee7-117">Determinar el estado del servicio de sincronización de Hola</span><span class="sxs-lookup"><span data-stu-id="feee7-117">Determine hello Synchronization Service status</span></span>](#determine-the-synchronization-service-status)
2. [<span data-ttu-id="feee7-118">Reducir base de datos de Hola</span><span class="sxs-lookup"><span data-stu-id="feee7-118">Shrink hello database</span></span>](#shrink-the-database)
3. [<span data-ttu-id="feee7-119">Eliminación de los datos del historial de ejecución</span><span class="sxs-lookup"><span data-stu-id="feee7-119">Delete run history data</span></span>](#delete-run-history-data)
4. [<span data-ttu-id="feee7-120">Reducción del período de retención de los datos del historial de ejecución</span><span class="sxs-lookup"><span data-stu-id="feee7-120">Shorten retention period for run history data</span></span>](#shorten-retention-period-for-run-history-data)

### <a name="determine-hello-synchronization-service-status"></a><span data-ttu-id="feee7-121">Determinar el estado del servicio de sincronización de Hola</span><span class="sxs-lookup"><span data-stu-id="feee7-121">Determine hello Synchronization Service status</span></span>
<span data-ttu-id="feee7-122">En primer lugar, determine si Hola servicio de sincronización aún se está ejecutando o no:</span><span class="sxs-lookup"><span data-stu-id="feee7-122">First, determine whether hello Synchronization Service is still running or not:</span></span>

1. <span data-ttu-id="feee7-123">Inicie sesión en tooyour servidor de Azure AD Connect como administrador.</span><span class="sxs-lookup"><span data-stu-id="feee7-123">Log in tooyour Azure AD Connect server as administrator.</span></span>

2. <span data-ttu-id="feee7-124">Vaya demasiado**Service Control Manager**.</span><span class="sxs-lookup"><span data-stu-id="feee7-124">Go too**Service Control Manager**.</span></span>

3. <span data-ttu-id="feee7-125">Comprobar el estado de Hola de **Microsoft Azure AD Sync**.</span><span class="sxs-lookup"><span data-stu-id="feee7-125">Check hello status of **Microsoft Azure AD Sync**.</span></span>


4. <span data-ttu-id="feee7-126">Si se está ejecutando, no detener ni reiniciar servicio Hola.</span><span class="sxs-lookup"><span data-stu-id="feee7-126">If it is running, do not stop or restart hello service.</span></span> <span data-ttu-id="feee7-127">Omitir [base de datos de reducción hello](#shrink-the-database) paso a paso y vaya demasiado[datos de historial de ejecución de Delete](#delete-run-history-data) paso.</span><span class="sxs-lookup"><span data-stu-id="feee7-127">Skip [Shrink hello database](#shrink-the-database) step and go too[Delete run history data](#delete-run-history-data) step.</span></span>

5. <span data-ttu-id="feee7-128">Si no se está ejecutando, pruebe a servicio de hello toostart.</span><span class="sxs-lookup"><span data-stu-id="feee7-128">If it is not running, try toostart hello service.</span></span> <span data-ttu-id="feee7-129">Si se inicia correctamente el servicio de hello, omitir [base de datos de reducción hello](#shrink-the-database) paso a paso y vaya demasiado[datos de historial de ejecución de eliminación](#delete-run-history-data) paso.</span><span class="sxs-lookup"><span data-stu-id="feee7-129">If hello service starts successfully, skip [Shrink hello database](#shrink-the-database) step and go too[Delete run history data](#delete-run-history-data) step.</span></span> <span data-ttu-id="feee7-130">En caso contrario, continúe con [base de datos de reducción hello](#shrink-the-database) paso.</span><span class="sxs-lookup"><span data-stu-id="feee7-130">Otherwise, continue with [Shrink hello database](#shrink-the-database) step.</span></span>

### <a name="shrink-hello-database"></a><span data-ttu-id="feee7-131">Reducir base de datos de Hola</span><span class="sxs-lookup"><span data-stu-id="feee7-131">Shrink hello database</span></span>
<span data-ttu-id="feee7-132">Utilice toofree de operación de reducción de hello seguridad suficiente hello toostart de espacio de base de datos servicio de sincronización.</span><span class="sxs-lookup"><span data-stu-id="feee7-132">Use hello Shrink operation toofree up enough DB space toostart hello Synchronization Service.</span></span> <span data-ttu-id="feee7-133">Libera el espacio de base de datos mediante la eliminación de espacios en blanco en la base de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="feee7-133">It frees up DB space by removing whitespaces in hello database.</span></span> <span data-ttu-id="feee7-134">Aunque este paso es el más indicado, no garantiza que se pueda recuperar espacio en todos los casos.</span><span class="sxs-lookup"><span data-stu-id="feee7-134">This step is best-effort as it is not guaranteed that you can always recover space.</span></span> <span data-ttu-id="feee7-135">toolearn más información acerca de la operación de reducción, lea este artículo [reducir una base de datos](https://msdn.microsoft.com/library/ms189035.aspx).</span><span class="sxs-lookup"><span data-stu-id="feee7-135">toolearn more about Shrink operation, read this article [Shrink a database](https://msdn.microsoft.com/library/ms189035.aspx).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="feee7-136">Omita este paso si puede obtener hello toorun de servicio de sincronización.</span><span class="sxs-lookup"><span data-stu-id="feee7-136">Skip this step if you can get hello Synchronization Service toorun.</span></span> <span data-ttu-id="feee7-137">No se recomienda hello tooshrink base de datos SQL ya que puede provocar toopoor rendimiento debido tooincreased fragmentación.</span><span class="sxs-lookup"><span data-stu-id="feee7-137">It is not recommended tooshrink hello SQL DB as it can lead toopoor performance due tooincreased fragmentation.</span></span>

<span data-ttu-id="feee7-138">Hola nombre de base de datos de hello creado para Azure AD Connect es **ADSync**.</span><span class="sxs-lookup"><span data-stu-id="feee7-138">hello name of hello database created for Azure AD Connect is **ADSync**.</span></span> <span data-ttu-id="feee7-139">tooperform una operación de reducción, debe iniciar sesión como administrador del sistema Hola o DBO de la base de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="feee7-139">tooperform a Shrink operation, you must log in either as hello sysadmin or DBO of hello database.</span></span> <span data-ttu-id="feee7-140">Durante la instalación de Azure AD Connect, Hola siguiendo las cuentas se les conceden derechos de administrador del sistema:</span><span class="sxs-lookup"><span data-stu-id="feee7-140">During Azure AD Connect installation, hello following accounts are granted sysadmin rights:</span></span>
* <span data-ttu-id="feee7-141">Administradores locales</span><span class="sxs-lookup"><span data-stu-id="feee7-141">Local Administrators</span></span>
* <span data-ttu-id="feee7-142">cuenta de usuario de Hola que era toorun usa Azure AD Connect instalación.</span><span class="sxs-lookup"><span data-stu-id="feee7-142">hello user account that was used toorun Azure AD Connect installation.</span></span>
* <span data-ttu-id="feee7-143">Hola cuenta de servicio de sincronización que se utiliza como Hola operativo contexto de servicio de sincronización de Connect de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="feee7-143">hello Sync Service account that is used as hello operating context of Azure AD Connect Synchronization Service.</span></span>
* <span data-ttu-id="feee7-144">grupo local de Hello ADSyncAdmins que se creó durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="feee7-144">hello local group ADSyncAdmins that was created during installation.</span></span>

1. <span data-ttu-id="feee7-145">Realizar copia de seguridad de hello copiando **ADSync.mdf** y **ADSync_log.ldf** archivos ubicados en `%ProgramFiles%\program files\Microsoft Azure AD Sync\Data` tooa de ubicación segura.</span><span class="sxs-lookup"><span data-stu-id="feee7-145">Back up hello database by copying **ADSync.mdf** and **ADSync_log.ldf** files located under `%ProgramFiles%\program files\Microsoft Azure AD Sync\Data` tooa safe location.</span></span>

2. <span data-ttu-id="feee7-146">Inicie una nueva sesión de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="feee7-146">Start a new PowerShell session.</span></span>

3. <span data-ttu-id="feee7-147">Navegue toofolder `%ProgramFiles%\Program Files\Microsoft SQL Server\110\Tools\Binn`.</span><span class="sxs-lookup"><span data-stu-id="feee7-147">Navigate toofolder `%ProgramFiles%\Program Files\Microsoft SQL Server\110\Tools\Binn`.</span></span>

4. <span data-ttu-id="feee7-148">Iniciar **sqlcmd** utilidad, ejecute el comando de hello `./SQLCMD.EXE -S “(localdb)\.\ADSync” -U <Username> -P <Password>`, mediante credenciales de Hola de un administrador del sistema u Hola DBO de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="feee7-148">Start **sqlcmd** utility by running hello command `./SQLCMD.EXE -S “(localdb)\.\ADSync” -U <Username> -P <Password>`, using hello credential of a sysadmin or hello database DBO.</span></span>

5. <span data-ttu-id="feee7-149">tooshrink Hola base de datos, en el símbolo del sistema de hello sqlcmd (1 >), escriba `DBCC Shrinkdatabase(ADSync,1);`, seguido de `GO` en la línea siguiente de saludo.</span><span class="sxs-lookup"><span data-stu-id="feee7-149">tooshrink hello database, at hello sqlcmd prompt (1>), enter `DBCC Shrinkdatabase(ADSync,1);`, followed by `GO` in hello next line.</span></span>

6. <span data-ttu-id="feee7-150">Si se realiza correctamente la operación de hello, vuelva a intentarlo hello toostart servicio de sincronización.</span><span class="sxs-lookup"><span data-stu-id="feee7-150">If hello operation is successful, try toostart hello Synchronization Service again.</span></span> <span data-ttu-id="feee7-151">Si puede iniciar el servicio de sincronización de Hola, vaya demasiado[datos de historial de ejecución de Delete](#delete-run-history-data) paso.</span><span class="sxs-lookup"><span data-stu-id="feee7-151">If you can start hello Synchronization Service, go too[Delete run history data](#delete-run-history-data) step.</span></span> <span data-ttu-id="feee7-152">De lo contrario, póngase en contacto con el servicio de soporte técnico.</span><span class="sxs-lookup"><span data-stu-id="feee7-152">If not, contact Support.</span></span>

### <a name="delete-run-history-data"></a><span data-ttu-id="feee7-153">Eliminación de los datos del historial de ejecución</span><span class="sxs-lookup"><span data-stu-id="feee7-153">Delete run history data</span></span>
<span data-ttu-id="feee7-154">De forma predeterminada, Azure AD Connect se conserva hasta días tooseven de datos de historial de ejecución.</span><span class="sxs-lookup"><span data-stu-id="feee7-154">By default, Azure AD Connect retains up tooseven days’ worth of run history data.</span></span> <span data-ttu-id="feee7-155">En este paso, eliminamos Hola espacio de tooreclaim base de datos de datos de historial de ejecución para que el servicio de sincronización de Connect de Azure AD puede empezar a sincronizar de nuevo.</span><span class="sxs-lookup"><span data-stu-id="feee7-155">In this step, we delete hello run history data tooreclaim DB space so that Azure AD Connect Synchronization Service can start syncing again.</span></span>

1.  <span data-ttu-id="feee7-156">Iniciar **Synchronization Service Manager** con va tooSTART → servicio de sincronización.</span><span class="sxs-lookup"><span data-stu-id="feee7-156">Start **Synchronization Service Manager** by going tooSTART → Synchronization Service.</span></span>

2.  <span data-ttu-id="feee7-157">Vaya toohello **Operations** ficha.</span><span class="sxs-lookup"><span data-stu-id="feee7-157">Go toohello **Operations** tab.</span></span>

3.  <span data-ttu-id="feee7-158">En **Actions** (Acciones), seleccione **Clear Runs...** (Borrar ejecuciones...).</span><span class="sxs-lookup"><span data-stu-id="feee7-158">Under **Actions**, select **Clear Runs**…</span></span>

4.  <span data-ttu-id="feee7-159">Puede seleccionar una de estas dos opciones: **Clear all runs** (Borrar todas las ejecuciones) o **Clear runs before… <date>** (Borrar todas las ejecuciones anteriores a...).</span><span class="sxs-lookup"><span data-stu-id="feee7-159">You can either choose **Clear all runs** or **Clear runs before… <date>** option.</span></span> <span data-ttu-id="feee7-160">Es conveniente que empiece borrando los datos del historial de ejecución que tienen más de dos días.</span><span class="sxs-lookup"><span data-stu-id="feee7-160">It is recommended that you start by clearing run history data that are older than two days.</span></span> <span data-ttu-id="feee7-161">Si continúa toorun en problema de tamaño de base de datos, a continuación, elija hello **borrar todas las ejecuciones de** opción.</span><span class="sxs-lookup"><span data-stu-id="feee7-161">If you continue toorun into DB size issue, then choose hello **Clear all runs** option.</span></span>

### <a name="shorten-retention-period-for-run-history-data"></a><span data-ttu-id="feee7-162">Reducción del período de retención de los datos del historial de ejecución</span><span class="sxs-lookup"><span data-stu-id="feee7-162">Shorten retention period for run history data</span></span>
<span data-ttu-id="feee7-163">Este paso es la probabilidad de hello tooreduce de ejecución en el problema de límite de 10 GB de hello después de varios ciclos de sincronización.</span><span class="sxs-lookup"><span data-stu-id="feee7-163">This step is tooreduce hello likelihood of running into hello 10-GB limit issue after multiple sync cycles.</span></span>

1. <span data-ttu-id="feee7-164">Abra una nueva sesión de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="feee7-164">Open a new PowerShell session.</span></span>

2. <span data-ttu-id="feee7-165">Ejecute `Get-ADSyncScheduler` y tome nota de la propiedad PurgeRunHistoryInterval, que especifica el período de retención actual Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="feee7-165">Run `Get-ADSyncScheduler` and take note of hello PurgeRunHistoryInterval property, which specifies hello current retention period.</span></span>

3. <span data-ttu-id="feee7-166">Ejecutar `Set-ADSyncScheduler -PurgeRunHistoryInterval 2.00:00:00` días de tootwo período de retención de tooset Hola.</span><span class="sxs-lookup"><span data-stu-id="feee7-166">Run `Set-ADSyncScheduler -PurgeRunHistoryInterval 2.00:00:00` tooset hello retention period tootwo days.</span></span> <span data-ttu-id="feee7-167">Ajustar el período de retención de hello según corresponda.</span><span class="sxs-lookup"><span data-stu-id="feee7-167">Adjust hello retention period as appropriate.</span></span>

## <a name="long-term-solution--migrate-toofull-sql"></a><span data-ttu-id="feee7-168">Solución a largo plazo, migrar toofull SQL</span><span class="sxs-lookup"><span data-stu-id="feee7-168">Long-term solution – Migrate toofull SQL</span></span>
<span data-ttu-id="feee7-169">En general, es indicativo de que el tamaño de base de datos de 10 GB ya no es suficiente para Azure AD Connect toosynchronize problema Hola su tooAzure de Active Directory local AD.</span><span class="sxs-lookup"><span data-stu-id="feee7-169">In general, hello issue is indicative that 10-GB database size is no longer sufficient for Azure AD Connect toosynchronize your on-premises Active Directory tooAzure AD.</span></span> <span data-ttu-id="feee7-170">Se recomienda que cambie la versión completa de hello toousing de SQL server.</span><span class="sxs-lookup"><span data-stu-id="feee7-170">It is recommended that you switch toousing hello full version of SQL server.</span></span> <span data-ttu-id="feee7-171">No se puede reemplazar directamente Hola LocalDB de una implementación existente de Azure AD Connect con base de datos de saludo de la versión completa de Hola de SQL.</span><span class="sxs-lookup"><span data-stu-id="feee7-171">You cannot directly replace hello LocalDB of an existing Azure AD Connect deployment with hello database of hello full version of SQL.</span></span> <span data-ttu-id="feee7-172">En su lugar, debe implementar un nuevo servidor de Azure AD Connect con la versión completa de Hola de SQL.</span><span class="sxs-lookup"><span data-stu-id="feee7-172">Instead, you must deploy a new Azure AD Connect server with hello full version of SQL.</span></span> <span data-ttu-id="feee7-173">Se recomienda que realice una migración swing donde se implementa el nuevo servidor de Azure AD Connect hello (con la base de datos de SQL) como un servidor de ensayo, servidor toohello de Azure AD Connect existente siguiente (con LocalDB).</span><span class="sxs-lookup"><span data-stu-id="feee7-173">It is recommended that you do a swing migration where hello new Azure AD Connect server (with SQL DB) is deployed as a staging server, next toohello existing Azure AD Connect server (with LocalDB).</span></span> 
* <span data-ttu-id="feee7-174">Para obtener instrucciones sobre cómo tooconfigure SQL remoto con Azure AD Connect, consulte tooarticle [instalación personalizada de Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-custom).</span><span class="sxs-lookup"><span data-stu-id="feee7-174">For instruction on how tooconfigure remote SQL with Azure AD Connect, refer tooarticle [Custom installation of Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-custom).</span></span>
* <span data-ttu-id="feee7-175">Para obtener instrucciones sobre la migración de recorrido de actualización de Azure AD Connect, consulte tooarticle [Azure AD Connect: actualización de un toohello de versión anterior más reciente](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-upgrade-previous-version#swing-migration).</span><span class="sxs-lookup"><span data-stu-id="feee7-175">For instructions on swing migration for Azure AD Connect upgrade, refer tooarticle [Azure AD Connect: Upgrade from a previous version toohello latest](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-upgrade-previous-version#swing-migration).</span></span>

## <a name="next-steps"></a><span data-ttu-id="feee7-176">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="feee7-176">Next steps</span></span>
<span data-ttu-id="feee7-177">Obtenga más información sobre la [Integración de las identidades locales con Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="feee7-177">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
