---
title: "aaaHow toobuild una aplicación que puede iniciar sesión en cualquier usuario de Azure AD | Documentos de Microsoft"
description: "Instrucciones paso a paso para crear una aplicación que pueda iniciar la sesión de un usuario desde cualquier inquilino de Azure Active Directory, lo que se conoce también como aplicación multiempresa."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 35af95cb-ced3-46ad-b01d-5d2f6fd064a3
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/26/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 123ea8125fa3c308ce0f124cc58e85ec28d476d5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="how-toosign-in-any-azure-active-directory-ad-user-using-hello-multi-tenant-application-pattern"></a><span data-ttu-id="e65be-103">¿Cómo toosign en cualquier usuario de Azure Active Directory (AD) mediante Hola patrón de aplicación de varios inquilinos</span><span class="sxs-lookup"><span data-stu-id="e65be-103">How toosign in any Azure Active Directory (AD) user using hello multi-tenant application pattern</span></span>
<span data-ttu-id="e65be-104">Si ofrece un Software como un toomany de aplicación de servicio de las organizaciones, puede configurar sus aplicación tooaccept inicios de sesión desde cualquier inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-104">If you offer a Software as a Service application toomany organizations, you can configure your application tooaccept sign-ins from any Azure AD tenant.</span></span>  <span data-ttu-id="e65be-105">En Azure AD, esto se conoce como convertir su aplicación en una aplicación multiempresa.</span><span class="sxs-lookup"><span data-stu-id="e65be-105">In Azure AD this is called making your application multi-tenant.</span></span>  <span data-ttu-id="e65be-106">Los usuarios de cualquier inquilino de Azure AD será capaz de toosign en tooyour aplicación después de dar su consentimiento toouse su cuenta con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e65be-106">Users in any Azure AD tenant will be able toosign in tooyour application after consenting toouse their account with your application.</span></span>  

<span data-ttu-id="e65be-107">Si tiene una aplicación existente que tiene su propio sistema de cuenta o es compatible con otros tipos de inicio de sesión de otros proveedores de nube, es sencillo agregar el inicio de sesión de Azure AD desde cualquier inquilino.</span><span class="sxs-lookup"><span data-stu-id="e65be-107">If you have an existing application that has its own account system, or supports other kinds of sign-in from other cloud providers, adding Azure AD sign-in from any tenant is simple.</span></span> <span data-ttu-id="e65be-108">Solo tiene que registrar la aplicación, agregar el código de inicio de sesión a través de OAuth2, OpenID Connect o SAML e incluir el botón "Iniciar sesión con Microsoft" en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e65be-108">Just register your app, add sign-in code via OAuth2, OpenID Connect, or SAML, and put a "Sign In with Microsoft" button on your application.</span></span> <span data-ttu-id="e65be-109">Haga clic en hello después botón toolearn más información acerca de la aplicación de personalización de marca.</span><span class="sxs-lookup"><span data-stu-id="e65be-109">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="e65be-110">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="e65be-110">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="e65be-111">En este artículo se da por supuesto que ya está familiarizado con la creación de una aplicación de un solo inquilino para Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-111">This article assumes you’re already familiar with building a single tenant application for Azure AD.</span></span>  <span data-ttu-id="e65be-112">Si no está, head respaldar toohello [página principal de guía para desarrolladores] [ AAD-Dev-Guide] y pruebe una de nuestras guías de inicio rápidos.</span><span class="sxs-lookup"><span data-stu-id="e65be-112">If you’re not, head back up toohello [developer guide homepage][AAD-Dev-Guide] and try one of our quick starts!</span></span>

<span data-ttu-id="e65be-113">Hay cuatro tooconvert sencillos pasos de la aplicación en una aplicación de varios inquilinos de Azure AD:</span><span class="sxs-lookup"><span data-stu-id="e65be-113">There are four simple steps tooconvert your application into an Azure AD multi-tenant app:</span></span>

1. <span data-ttu-id="e65be-114">Actualizar al inquilino de varios de toobe de registro de aplicación</span><span class="sxs-lookup"><span data-stu-id="e65be-114">Update your application registration toobe multi-tenant</span></span>
2. <span data-ttu-id="e65be-115">Actualizar su/Common toohello de las solicitudes de código toosend extremo</span><span class="sxs-lookup"><span data-stu-id="e65be-115">Update your code toosend requests toohello /common endpoint</span></span> 
3. <span data-ttu-id="e65be-116">Actualizar el código toohandle varios valores de emisor</span><span class="sxs-lookup"><span data-stu-id="e65be-116">Update your code toohandle multiple issuer values</span></span>
4. <span data-ttu-id="e65be-117">Comprenda el consentimiento de administrador y usuario y realice los cambios apropiados en el código</span><span class="sxs-lookup"><span data-stu-id="e65be-117">Understand user and admin consent and make appropriate code changes</span></span>

<span data-ttu-id="e65be-118">Vamos a examinar cada paso con detalle.</span><span class="sxs-lookup"><span data-stu-id="e65be-118">Let’s look at each step in detail.</span></span> <span data-ttu-id="e65be-119">También puede saltar directamente demasiado[esta lista de ejemplos de varios inquilinos][AAD-Samples-MT].</span><span class="sxs-lookup"><span data-stu-id="e65be-119">You can also jump straight too[this list of multi-tenant samples][AAD-Samples-MT].</span></span>

## <a name="update-registration-toobe-multi-tenant"></a><span data-ttu-id="e65be-120">Actualizar a varios inquilinos de registro toobe</span><span class="sxs-lookup"><span data-stu-id="e65be-120">Update registration toobe multi-tenant</span></span>
<span data-ttu-id="e65be-121">De forma predeterminada, los registros de API y de aplicación web en Azure son de un solo inquilino.</span><span class="sxs-lookup"><span data-stu-id="e65be-121">By default, web app/API registrations in Azure AD are single tenant.</span></span>  <span data-ttu-id="e65be-122">Puede realizar el registro de varios inquilinos mediante la búsqueda de Hola "varios inquilinos" cambiar de página de propiedades de Hola de su registro de la aplicación Hola [portal de Azure] [ AZURE-portal] y si se establece demasiado "Sí".</span><span class="sxs-lookup"><span data-stu-id="e65be-122">You can make your registration multi-tenant by finding hello “Multi-Tenanted” switch on hello properties page of your application registration in hello [Azure portal][AZURE-portal] and setting it too“Yes”.</span></span>

<span data-ttu-id="e65be-123">También tenga en cuenta que para poder realizar una aplicación multiempresa, Azure AD necesita Hola App ID URI de hello aplicación toobe único global.</span><span class="sxs-lookup"><span data-stu-id="e65be-123">Also note, before an application can be made multi-tenant, Azure AD requires hello App ID URI of hello application toobe globally unique.</span></span> <span data-ttu-id="e65be-124">Hola App ID URI es uno de los modos de hello que identifica a una aplicación en los mensajes de protocolo.</span><span class="sxs-lookup"><span data-stu-id="e65be-124">hello App ID URI is one of hello ways an application is identified in protocol messages.</span></span>  <span data-ttu-id="e65be-125">Para una aplicación de un solo inquilino, es suficiente para hello App ID URI toobe único dentro de ese inquilino.</span><span class="sxs-lookup"><span data-stu-id="e65be-125">For a single tenant application, it is sufficient for hello App ID URI toobe unique within that tenant.</span></span>  <span data-ttu-id="e65be-126">Para una aplicación de varios inquilinos, debe ser único globalmente para que Azure AD pueda encontrar la aplicación hello entre todos los inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-126">For a multi-tenant application, it must be globally unique so Azure AD can find hello application across all tenants.</span></span>  <span data-ttu-id="e65be-127">Se aplica la unicidad global exigiendo Hola App ID URI toohave un nombre de host que coincida con un dominio comprobado del inquilino de Azure AD Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-127">Global uniqueness is enforced by requiring hello App ID URI toohave a host name that matches a verified domain of hello Azure AD tenant.</span></span>  <span data-ttu-id="e65be-128">Por ejemplo, si el nombre de hello del inquilino era contoso.onmicrosoft.com, a continuación, válido App ID URI sería `https://contoso.onmicrosoft.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="e65be-128">For example, if hello name of your tenant was contoso.onmicrosoft.com then a valid App ID URI would be `https://contoso.onmicrosoft.com/myapp`.</span></span>  <span data-ttu-id="e65be-129">Si el inquilino tenía el dominio comprobado `contoso.com`, también sería un URI de id. de aplicación válido `https://contoso.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="e65be-129">If your tenant had a verified domain of `contoso.com`, then a valid App ID URI would also be `https://contoso.com/myapp`.</span></span>  <span data-ttu-id="e65be-130">Se producirá un error al configurar una aplicación como multiempresa si Hola App ID URI no sigue este patrón.</span><span class="sxs-lookup"><span data-stu-id="e65be-130">Setting an application as multi-tenant will fail if hello App ID URI doesn’t follow this pattern.</span></span>

<span data-ttu-id="e65be-131">Los registros de cliente nativo son multiempresa de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e65be-131">Native client registrations are multi-tenant by default.</span></span>  <span data-ttu-id="e65be-132">No es necesario tootake cualquier toomake acción cliente nativo aplicación registro de varios inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-132">You don’t need tootake any action toomake a native client application registration multi-tenant.</span></span>

## <a name="update-your-code-toosend-requests-toocommon"></a><span data-ttu-id="e65be-133">Actualizar el código toosend solicitudes demasiado/comunes</span><span class="sxs-lookup"><span data-stu-id="e65be-133">Update your code toosend requests too/common</span></span>
<span data-ttu-id="e65be-134">En una aplicación de un solo inquilino, las solicitudes de inicio de sesión se envían inicio de sesión de extremo del inquilino de toohello.</span><span class="sxs-lookup"><span data-stu-id="e65be-134">In a single tenant application, sign-in requests are sent toohello tenant’s sign-in endpoint.</span></span> <span data-ttu-id="e65be-135">Por ejemplo, para contoso.onmicrosoft.com extremo Hola sería:</span><span class="sxs-lookup"><span data-stu-id="e65be-135">For example, for contoso.onmicrosoft.com hello endpoint would be:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="e65be-136">Las solicitudes se envían el extremo del inquilino de tooa puede iniciar sesión en los usuarios (o invitados) en ese tooapplications inquilino en ese inquilino.</span><span class="sxs-lookup"><span data-stu-id="e65be-136">Requests sent tooa tenant’s endpoint can sign in users (or guests) in that tenant tooapplications in that tenant.</span></span>  <span data-ttu-id="e65be-137">Con una aplicación de varios inquilinos, no sabe la aplicación hello por adelantado qué usuario Hola de inquilinos es, por lo que no se puede enviar solicitudes de punto de conexión del inquilino de tooa.</span><span class="sxs-lookup"><span data-stu-id="e65be-137">With a multi-tenant application, hello application doesn’t know up front what tenant hello user is from, so you can’t send requests tooa tenant’s endpoint.</span></span>  <span data-ttu-id="e65be-138">En su lugar, las solicitudes se envían extremo tooan que multiplexes entre AD de Azure todos los inquilinos:</span><span class="sxs-lookup"><span data-stu-id="e65be-138">Instead, requests are sent tooan endpoint that multiplexes across all Azure AD tenants:</span></span>

    https://login.microsoftonline.com/common

<span data-ttu-id="e65be-139">Cuando Azure AD recibe una solicitud en hello/extremo común, inicia la sesión de usuario de hello en y como consecuencia detecta que el usuario inquilino Hola pertenece.</span><span class="sxs-lookup"><span data-stu-id="e65be-139">When Azure AD receives a request on hello /common endpoint, it signs hello user in and as a consequence discovers which tenant hello user is from.</span></span>  <span data-ttu-id="e65be-140">Hola/extremo común funciona con todos los protocolos de autenticación de hello compatibles con Azure AD: OpenID Connect, OAuth 2.0, SAML 2.0 y WS-Federation.</span><span class="sxs-lookup"><span data-stu-id="e65be-140">hello /common endpoint works with all of hello authentication protocols supported by Azure AD:  OpenID Connect, OAuth 2.0, SAML 2.0, and WS-Federation.</span></span>

<span data-ttu-id="e65be-141">aplicación de toohello de respuesta de inicio de sesión de Hello, a continuación, contiene un token que representa el usuario de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-141">hello sign-in response toohello application then contains a token representing hello user.</span></span>  <span data-ttu-id="e65be-142">valor de emisor de Hello en el token de hello indica que una aplicación qué usuario Hola de inquilinos es de.</span><span class="sxs-lookup"><span data-stu-id="e65be-142">hello issuer value in hello token tells an application what tenant hello user is from.</span></span>  <span data-ttu-id="e65be-143">Cuando devuelve una respuesta de Hola/extremo común, valor de emisor de hello en el token de hello corresponderá a inquilino del usuario toohello.</span><span class="sxs-lookup"><span data-stu-id="e65be-143">When a response returns from hello /common endpoint, hello issuer value in hello token will correspond toohello user’s tenant.</span></span>  <span data-ttu-id="e65be-144">Es importante toonote Hola/extremo común no es un inquilino y no es un emisor, es simplemente un multiplexor.</span><span class="sxs-lookup"><span data-stu-id="e65be-144">It’s important toonote hello /common endpoint is not a tenant and is not an issuer, it’s just a multiplexer.</span></span>  <span data-ttu-id="e65be-145">Cuando se utiliza/Common, lógica de hello en los tokens de toovalidate de aplicación debe toobe actualiza tootake esto en cuenta.</span><span class="sxs-lookup"><span data-stu-id="e65be-145">When using /common, hello logic in your application toovalidate tokens needs toobe updated tootake this into account.</span></span> 

<span data-ttu-id="e65be-146">Como las aplicaciones de varios inquilinos mencionadas anteriormente, también deben proporcionar una experiencia de inicio de sesión coherente para los usuarios, siguiente Hola directrices de personalización de marca de aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-146">As mentioned earlier, multi-tenant applications should also provide a consistent sign-in experience for users, following hello Azure AD application branding guidelines.</span></span> <span data-ttu-id="e65be-147">Haga clic en hello después botón toolearn más información acerca de la aplicación de personalización de marca.</span><span class="sxs-lookup"><span data-stu-id="e65be-147">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="e65be-148">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="e65be-148">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="e65be-149">¡Eche un vistazo a la utilice Hola de/Common Hola punto de conexión y su implementación en el código con más detalle.</span><span class="sxs-lookup"><span data-stu-id="e65be-149">Let’s take a look at hello use of hello /common endpoint and your code implementation in more detail.</span></span>

## <a name="update-your-code-toohandle-multiple-issuer-values"></a><span data-ttu-id="e65be-150">Actualizar el código toohandle varios valores de emisor</span><span class="sxs-lookup"><span data-stu-id="e65be-150">Update your code toohandle multiple issuer values</span></span>
<span data-ttu-id="e65be-151">Las aplicaciones web y las API web reciben y validan los tokens desde Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-151">Web applications and web APIs receive and validate tokens from Azure AD.</span></span>  

> [!NOTE]
> <span data-ttu-id="e65be-152">Mientras que las aplicaciones cliente nativas solicitar y reciban tokens de Azure AD, lo hacen toosend por lo que les tooAPIs, en el que se validarán.</span><span class="sxs-lookup"><span data-stu-id="e65be-152">While native client applications request and receive tokens from Azure AD, they do so toosend them tooAPIs, where they are validated.</span></span>  <span data-ttu-id="e65be-153">Las aplicaciones nativas no validan los tokens y deben tratarlos como opacos.</span><span class="sxs-lookup"><span data-stu-id="e65be-153">Native applications do not validate tokens and must treat them as opaque.</span></span>
> 
> 

<span data-ttu-id="e65be-154">Veamos cómo una aplicación valida los tokens que recibe de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-154">Let’s look at how an application validates tokens it receives from Azure AD.</span></span>  <span data-ttu-id="e65be-155">Una aplicación de un solo inquilino tomará normalmente un valor de punto de conexión como:</span><span class="sxs-lookup"><span data-stu-id="e65be-155">A single tenant application will normally take an endpoint value like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="e65be-156">y use tooconstruct como una dirección URL de metadatos (en este caso, OpenID Connect):</span><span class="sxs-lookup"><span data-stu-id="e65be-156">and use it tooconstruct a metadata URL (in this case, OpenID Connect) like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration

<span data-ttu-id="e65be-157">partes esenciales toodownload dos de información que son utilizados toovalidate tokens: inquilino Hola de firma de claves y el valor del emisor.</span><span class="sxs-lookup"><span data-stu-id="e65be-157">toodownload two critical pieces of information that are used toovalidate tokens:  hello tenant’s signing keys and issuer value.</span></span>  <span data-ttu-id="e65be-158">Cada inquilino de Azure AD tiene un valor único del emisor del formulario de hello:</span><span class="sxs-lookup"><span data-stu-id="e65be-158">Each Azure AD tenant has a unique issuer value of hello form:</span></span>

    https://sts.windows.net/31537af4-6d77-4bb9-a681-d2394888ea26/

<span data-ttu-id="e65be-159">donde el valor GUID de hello es versión de Hola seguro para cambiar el nombre de identificador del inquilino Hola de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-159">where hello GUID value is hello rename-safe version of hello tenant ID of hello tenant.</span></span>  <span data-ttu-id="e65be-160">Si hace clic en hello anterior vínculo de metadatos para `contoso.onmicrosoft.com`, puede ver este valor del emisor en el documento de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-160">If you click on hello preceding metadata link for `contoso.onmicrosoft.com`, you can see this issuer value in hello document.</span></span>

<span data-ttu-id="e65be-161">Cuando una aplicación de un solo inquilino valida un token, comprueba la firma de hello del token de hello contra Hola claves de documento de metadatos de Hola de firma.</span><span class="sxs-lookup"><span data-stu-id="e65be-161">When a single tenant application validates a token, it checks hello signature of hello token against hello signing keys from hello metadata document.</span></span> <span data-ttu-id="e65be-162">Esto le permite toomake que el valor de emisor Hola Hola coincidencias token Hola uno que se encontró en el documento de metadatos de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-162">This allows it toomake sure hello issuer value in hello token matches hello one that was found in hello metadata document.</span></span>

<span data-ttu-id="e65be-163">Desde Hola/comunes punto de conexión no corresponde a tooa inquilino y no es un emisor, al examinar el valor de emisor de hello en los metadatos de Hola para/común tiene una dirección URL basada en plantilla en lugar de un valor real:</span><span class="sxs-lookup"><span data-stu-id="e65be-163">Since hello /common endpoint doesn’t correspond tooa tenant and isn’t an issuer, when you examine hello issuer value in hello metadata for /common it has a templated URL instead of an actual value:</span></span>

    https://sts.windows.net/{tenantid}/

<span data-ttu-id="e65be-164">Por lo tanto, una aplicación de varios inquilinos no puede validar los tokens simplemente comparando el valor de emisor de hello en los metadatos de hello con hello `issuer` valor de token de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-164">Therefore, a multi-tenant application can’t validate tokens just by matching hello issuer value in hello metadata with hello `issuer` value in hello token.</span></span>  <span data-ttu-id="e65be-165">Una aplicación multiempresa necesidades de lógica toodecide qué valores de emisor son válidos y que están no, tomando como base el inquilino de hello parte del identificador del valor de emisor de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-165">A multi-tenant application needs logic toodecide which issuer values are valid and which are not, based on hello tenant ID portion of hello issuer value.</span></span>  

<span data-ttu-id="e65be-166">Por ejemplo, si una aplicación de varios inquilinos solo permite iniciar sesión de inquilinos específicos que se suscribieron para su servicio, a continuación, debe comprobar el valor del emisor de Hola o hello `tid` valor en hello token toomake seguro de ese inquilino está en su lista de notificación suscriptores.</span><span class="sxs-lookup"><span data-stu-id="e65be-166">For example, if a multi-tenant application only allows sign-in from specific tenants who have signed up for their service, then it must check either hello issuer value or hello `tid` claim value in hello token toomake sure that tenant is in their list of subscribers.</span></span>  <span data-ttu-id="e65be-167">Si una aplicación multiempresa sólo trabaja con usuarios y no tiene ninguna decisión relativa al acceso en función de los inquilinos, a continuación, puede omitir el valor del emisor de Hola por completo.</span><span class="sxs-lookup"><span data-stu-id="e65be-167">If a multi-tenant application only deals with individuals and doesn’t make any access decisions based on tenants, then it can ignore hello issuer value altogether.</span></span>

<span data-ttu-id="e65be-168">En los ejemplos de varios inquilinos de Hola Hola [Related Content](#related-content) sección Hola final de este artículo, la validación del emisor está deshabilitado tooenable cualquier toosign del inquilino de Azure AD en.</span><span class="sxs-lookup"><span data-stu-id="e65be-168">In hello multi-tenant samples in hello [Related Content](#related-content) section at hello end of this article, issuer validation is disabled tooenable any Azure AD tenant toosign in.</span></span>

<span data-ttu-id="e65be-169">Ahora Echemos un vistazo a la experiencia del usuario de Hola para los usuarios que inician sesión en las aplicaciones de inquilinos toomulti.</span><span class="sxs-lookup"><span data-stu-id="e65be-169">Now let’s look at hello user experience for users that are signing in toomulti-tenant applications.</span></span>

## <a name="understanding-user-and-admin-consent"></a><span data-ttu-id="e65be-170">Comprensión del consentimiento de usuario y administrador</span><span class="sxs-lookup"><span data-stu-id="e65be-170">Understanding user and admin consent</span></span>
<span data-ttu-id="e65be-171">Para toosign de usuario en la aplicación tooan en Azure AD, aplicación hello debe estar representado en el inquilino del usuario de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-171">For a user toosign in tooan application in Azure AD, hello application must be represented in hello user’s tenant.</span></span>  <span data-ttu-id="e65be-172">Esto permite organizar de hello toodo cosas como aplicar directivas únicas cuando los usuarios de su inquilino de sesión en la aplicación toohello.</span><span class="sxs-lookup"><span data-stu-id="e65be-172">This allows hello organization toodo things like apply unique policies when users from their tenant sign in toohello application.</span></span>  <span data-ttu-id="e65be-173">En una aplicación de un solo inquilino, este registro es simple; ha Hola uno que se produce al registrar la aplicación hello en hello [portal de Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="e65be-173">For a single tenant application, this registration is simple; it’s hello one that happens when you register hello application in hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="e65be-174">Para una aplicación de varios inquilinos, Hola inicial en el registro para aplicación hello vive en hello inquilino de Azure AD utilizada Hola programador.</span><span class="sxs-lookup"><span data-stu-id="e65be-174">For a multi-tenant application, hello initial registration for hello application lives in hello Azure AD tenant used by hello developer.</span></span>  <span data-ttu-id="e65be-175">Cuando un usuario de un inquilino diferente inicia sesión en la aplicación de toohello para hello primera vez, Azure AD les pide tooconsent toohello permisos solicitados por la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="e65be-175">When a user from a different tenant signs in toohello application for hello first time, Azure AD asks them tooconsent toohello permissions requested by hello application.</span></span>  <span data-ttu-id="e65be-176">Si dar el consentimiento, a continuación, llama a una representación de la aplicación hello un *entidad de servicio* se crea en Hola inquilino del usuario y en el inicio de sesión puede continuar.</span><span class="sxs-lookup"><span data-stu-id="e65be-176">If they consent, then a representation of hello application called a *service principal* is created in hello user’s tenant, and sign-in can continue.</span></span> <span data-ttu-id="e65be-177">También se crea una delegación en directorio de Hola que registra la aplicación de toohello de consentimiento del usuario de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-177">A delegation is also created in hello directory that records hello user’s consent toohello application.</span></span> <span data-ttu-id="e65be-178">Vea [objetos de entidad de servicio y aplicación] [ AAD-App-SP-Objects] para obtener más información sobre la aplicación hello objetos Application y ServicePrincipal, y cómo se relacionan tooeach otro.</span><span class="sxs-lookup"><span data-stu-id="e65be-178">See [Application Objects and Service Principal Objects][AAD-App-SP-Objects] for details on hello application's Application and ServicePrincipal objects, and how they relate tooeach other.</span></span>

![Aplicación de toosingle-nivel de consentimiento][Consent-Single-Tier] 

<span data-ttu-id="e65be-180">Esta experiencia de consentimiento se ve afectada por permisos de hello solicitados por la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="e65be-180">This consent experience is affected by hello permissions requested by hello application.</span></span>  <span data-ttu-id="e65be-181">Azure AD admite dos clases de permisos, solo de aplicación o delegado:</span><span class="sxs-lookup"><span data-stu-id="e65be-181">Azure AD supports two kinds of permissions, app-only and delegated:</span></span>

* <span data-ttu-id="e65be-182">Un permiso delegado concede un tooact de capacidad de aplicación Hola pueda realizar un usuario con sesión iniciada para un subconjunto de usuario de hello cosas Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-182">A delegated permission grants an application hello ability tooact as a signed in user for a subset of hello things hello user can do.</span></span>  <span data-ttu-id="e65be-183">Por ejemplo, puede conceder a una aplicación Hola permisos delegados tooread Hola firmado en el calendario del usuario.</span><span class="sxs-lookup"><span data-stu-id="e65be-183">For example, you can grant an application hello delegated permission tooread hello signed in user’s calendar.</span></span>
* <span data-ttu-id="e65be-184">Se concede un permiso de solo de aplicación directamente toohello identidad de aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="e65be-184">An app-only permission is granted directly toohello identity of hello application.</span></span>  <span data-ttu-id="e65be-185">Por ejemplo, puede conceder una lista de hello aplicación Hola permiso de solo aplicación tooread de usuarios en un inquilino, sin tener en cuenta que ha iniciado sesión en la aplicación toohello.</span><span class="sxs-lookup"><span data-stu-id="e65be-185">For example, you can grant an application hello app-only permission tooread hello list of users in a tenant, regardless of who is signed in toohello application.</span></span>

<span data-ttu-id="e65be-186">Algunos permisos pueden ser tooby con consentimiento de un usuario normal, mientras que otras requieren el consentimiento del Administrador de inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-186">Some permissions can be consented tooby a regular user, while others require a tenant administrator’s consent.</span></span> 

### <a name="admin-consent"></a><span data-ttu-id="e65be-187">Consentimiento de administrador</span><span class="sxs-lookup"><span data-stu-id="e65be-187">Admin consent</span></span>
<span data-ttu-id="e65be-188">Los permisos de solo aplicación siempre requieren el consentimiento del administrador de inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-188">App-only permissions always require a tenant administrator’s consent.</span></span>  <span data-ttu-id="e65be-189">Si la aplicación solicita un permiso de solo de aplicación y un usuario intenta toosign en toohello aplicación, se mostrará un mensaje de error que indica que el usuario de hello no es capaz de tooconsent.</span><span class="sxs-lookup"><span data-stu-id="e65be-189">If your application requests an app-only permission and a user tries toosign in toohello application, an error message will be displayed saying hello user isn’t able tooconsent.</span></span>

<span data-ttu-id="e65be-190">Algunos permisos delegados también requieren el consentimiento del administrador de inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-190">Certain delegated permissions also require a tenant administrator’s consent.</span></span>  <span data-ttu-id="e65be-191">Por ejemplo, hello capacidad toowrite atrás tooAzure AD como Hola firmado en usuario requiere consentimiento del Administrador de inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-191">For example, hello ability toowrite back tooAzure AD as hello signed in user requires a tenant administrator’s consent.</span></span>  <span data-ttu-id="e65be-192">Como los permisos de solo de aplicación, si trata de un usuario normal toosign en la aplicación de tooan que solicita un permiso delegado que requiere el consentimiento del administrador, la aplicación recibirá un error.</span><span class="sxs-lookup"><span data-stu-id="e65be-192">Like app-only permissions, if an ordinary user tries toosign in tooan application that requests a delegated permission that requires administrator consent, your application will receive an error.</span></span>  <span data-ttu-id="e65be-193">Si un permiso requiere consentimiento del administrador viene determinado por el desarrollador de Hola que publican los recursos de Hola y puede encontrarse en la documentación de hello para el recurso de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-193">Whether or not a permission requires admin consent is determined by hello developer that published hello resource, and can be found in hello documentation for hello resource.</span></span>  <span data-ttu-id="e65be-194">Vincula tootopics que describe los permisos disponibles de Hola para hello Azure AD Graph API y la API de Graph de Microsoft son Hola [Related Content](#related-content) sección de este artículo.</span><span class="sxs-lookup"><span data-stu-id="e65be-194">Links tootopics describing hello available permissions for hello Azure AD Graph API and Microsoft Graph API are in hello [Related Content](#related-content) section of this article.</span></span>

<span data-ttu-id="e65be-195">Si la aplicación usa los permisos que requieren el consentimiento del administrador, deberá toohave un movimiento como un botón o vínculo que Hola, administrador puede iniciar la acción de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-195">If your application uses permissions that require admin consent, you need toohave a gesture such as a button or link where hello admin can initiate hello action.</span></span>  <span data-ttu-id="e65be-196">solicitud de Hello envía su aplicación para esta acción es una solicitud de autorización de OAuth2/OpenID Connect habitual, pero que también incluye hello `prompt=admin_consent` parámetro de cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="e65be-196">hello request your application sends for this action is a usual OAuth2/OpenID Connect authorization request, but that also includes hello `prompt=admin_consent` query string parameter.</span></span>  <span data-ttu-id="e65be-197">Una vez que ha dado su consentimiento Hola, administrador y entidad de servicio de Hola se crea en el inquilino del cliente de hello, las solicitudes de inicio de sesión posteriores no es necesario hello `prompt=admin_consent` parámetro.</span><span class="sxs-lookup"><span data-stu-id="e65be-197">Once hello admin has consented and hello service principal is created in hello customer’s tenant, subsequent sign-in requests do not need hello `prompt=admin_consent` parameter.</span></span> <span data-ttu-id="e65be-198">Puesto que ha decidido administrador Hola Hola solicita permisos son aceptables, ningún otro usuario de inquilino de hello le pedirá su consentimiento a partir de ese punto.</span><span class="sxs-lookup"><span data-stu-id="e65be-198">Since hello administrator has decided hello requested permissions are acceptable, no other users in hello tenant will be prompted for consent from that point forward.</span></span>

<span data-ttu-id="e65be-199">Hola `prompt=admin_consent` parámetro también se puede utilizar con las aplicaciones que solicitan permisos que no se requiere el consentimiento del administrador.</span><span class="sxs-lookup"><span data-stu-id="e65be-199">hello `prompt=admin_consent` parameter can also be used by applications that request permissions that do not require admin consent.</span></span> <span data-ttu-id="e65be-200">Esto se hace cuando la aplicación hello requiere una experiencia donde un administrador de inquilinos Hola "se suscribe" uno se piden a los usuarios de tiempo y ninguna otros consentimiento desde ese punto en.</span><span class="sxs-lookup"><span data-stu-id="e65be-200">This is done when hello applicaton requires an experience where hello tenant admin “signs up” one time, and no other users are prompted for consent from that point on.</span></span>

<span data-ttu-id="e65be-201">Si una aplicación requiere el consentimiento del administrador y un administrador inicia sesión en pero hello `prompt=admin_consent` parámetro no se envía, Hola, administrador correctamente dar su consentimiento aplicación toohello **únicamente para su cuenta de usuario**.</span><span class="sxs-lookup"><span data-stu-id="e65be-201">If an application requires admin consent, and an admin signs in but hello `prompt=admin_consent` parameter is not sent, hello admin will successfully consent toohello application **only for their user account**.</span></span>  <span data-ttu-id="e65be-202">Los usuarios regulares todavía no estará pueda toosign en y aplicación toohello de consentimiento.</span><span class="sxs-lookup"><span data-stu-id="e65be-202">Regular users will still not be able toosign in and consent toohello application.</span></span>  <span data-ttu-id="e65be-203">Esto es útil si desea que Administrador de inquilinos de toogive Hola Hola capacidad tooexplore la aplicación antes de permitir el acceso a otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="e65be-203">This is useful if you want toogive hello tenant administrator hello ability tooexplore your application before allowing other users access.</span></span>

<span data-ttu-id="e65be-204">Un administrador de inquilinos puede deshabilitar la capacidad de Hola para los usuarios regulares tooconsent tooapplications.</span><span class="sxs-lookup"><span data-stu-id="e65be-204">A tenant administrator can disable hello ability for regular users tooconsent tooapplications.</span></span>  <span data-ttu-id="e65be-205">Si se deshabilita esta capacidad, siempre es necesario para hello toobe de aplicación configurado en el inquilino de hello consentimiento del administrador.</span><span class="sxs-lookup"><span data-stu-id="e65be-205">If this capability is disabled, admin consent is always required for hello application toobe set up in hello tenant.</span></span>  <span data-ttu-id="e65be-206">Si desea que tootest su aplicación con consentimiento de usuario normal deshabilitada, encontrará modificador de configuración de hello en inquilino de Azure AD Hola sección de configuración del programa Hola a [portal de Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="e65be-206">If you want tootest your application with regular user consent disabled, you can find hello configuration switch in hello Azure AD tenant configuration section of hello [Azure portal][AZURE-portal].</span></span>

> [!NOTE]
> <span data-ttu-id="e65be-207">Algunas aplicaciones desea una experiencia donde los usuarios normales son tooconsent capaz de inicialmente, y puede incluir la aplicación hello posterior administrador hello y solicitar los permisos que requieren el consentimiento del administrador.</span><span class="sxs-lookup"><span data-stu-id="e65be-207">Some applications want an experience where regular users are able tooconsent initially, and later hello application can involve hello administrator and request permissions that require admin consent.</span></span>  <span data-ttu-id="e65be-208">No hay ningún toodo de manera esto con un registro de aplicación único en Azure AD hoy en día.</span><span class="sxs-lookup"><span data-stu-id="e65be-208">There is no way toodo this with a single application registration in Azure AD today.</span></span>  <span data-ttu-id="e65be-209">el punto de conexión de Hello próximo AD Azure v2 le permitirá aplicaciones toorequest permisos en tiempo de ejecución, en lugar de en tiempo de registro, lo que le permitirá este escenario.</span><span class="sxs-lookup"><span data-stu-id="e65be-209">hello upcoming Azure AD v2 endpoint will allow applications toorequest permissions at runtime, instead of at registration time, which will enable this scenario.</span></span>  <span data-ttu-id="e65be-210">Para obtener más información, vea hello [guía para desarrolladores de modelo de aplicación de Azure AD v2][AAD-V2-Dev-Guide].</span><span class="sxs-lookup"><span data-stu-id="e65be-210">For more information, see hello [Azure AD App Model v2 Developer Guide][AAD-V2-Dev-Guide].</span></span>
> 
> 

### <a name="consent-and-multi-tier-applications"></a><span data-ttu-id="e65be-211">Consentimiento y aplicaciones de niveles múltiples</span><span class="sxs-lookup"><span data-stu-id="e65be-211">Consent and multi-tier applications</span></span>
<span data-ttu-id="e65be-212">La aplicación puede tener varios niveles, cada uno representado por su propio registro en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-212">Your application may have multiple tiers, each represented by its own registration in Azure AD.</span></span>  <span data-ttu-id="e65be-213">Por ejemplo, una aplicación nativa que llama a una API web o una aplicación web que llama a una API web.</span><span class="sxs-lookup"><span data-stu-id="e65be-213">For example, a native application that calls a web API, or a web application that calls a web API.</span></span>  <span data-ttu-id="e65be-214">En ambos casos, cliente de hello (aplicación nativa o una aplicación web) solicita recursos Hola de toocall permisos (API de web).</span><span class="sxs-lookup"><span data-stu-id="e65be-214">In both of these cases, hello client (native app or web app) requests permissions toocall hello resource (web API).</span></span>  <span data-ttu-id="e65be-215">Para hello cliente toobe aceptada correctamente en el inquilino de un cliente, todos los toowhich de recursos solicita permisos ya debe existir en el inquilino del cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-215">For hello client toobe successfully consented into a customer’s tenant, all resources toowhich it requests permissions must already exist in hello customer’s tenant.</span></span>  <span data-ttu-id="e65be-216">Si no se cumple esta condición, Azure AD devolverá un error que Hola recursos debe agregarse en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="e65be-216">If this condition isn’t met, Azure AD will return an error that hello resource must be added first.</span></span>

<span data-ttu-id="e65be-217">**Múltiples niveles en un solo inquilino**</span><span class="sxs-lookup"><span data-stu-id="e65be-217">**Multiple tiers in a single tenant**</span></span>

<span data-ttu-id="e65be-218">Esto puede ser un problema si la aplicación lógica consta de dos o más registros de aplicación, por ejemplo, un cliente y un recurso independientes.</span><span class="sxs-lookup"><span data-stu-id="e65be-218">This can be a problem if your logical application consists of two or more application registrations, for example a separate client and resource.</span></span>  <span data-ttu-id="e65be-219">¿Cómo se consigue recursos hello en el inquilino de cliente hello primera?</span><span class="sxs-lookup"><span data-stu-id="e65be-219">How do you get hello resource into hello customer tenant first?</span></span>  <span data-ttu-id="e65be-220">Azure AD trata este caso habilitando el cliente y el recurso toobe consentido en un solo paso.</span><span class="sxs-lookup"><span data-stu-id="e65be-220">Azure AD covers this case by enabling client and resource toobe consented in a single step.</span></span> <span data-ttu-id="e65be-221">usuario de Hello ve la suma total de Hola de permisos de Hola solicitados por el cliente de Hola y recursos en la página de consentimiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-221">hello user sees hello sum total of hello permissions requested by both hello client and resource on hello consent page.</span></span>  <span data-ttu-id="e65be-222">tooenable este comportamiento, registro de la aplicación del recurso de Hola debe incluir el identificador de aplicación del cliente de Hola como un `knownClientApplications` en su manifiesto de aplicación.</span><span class="sxs-lookup"><span data-stu-id="e65be-222">tooenable this behavior, hello resource’s application registration must include hello client’s App ID as a `knownClientApplications` in its application manifest.</span></span>  <span data-ttu-id="e65be-223">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="e65be-223">For example:</span></span>

    knownClientApplications": ["94da0930-763f-45c7-8d26-04d5938baab2"]

<span data-ttu-id="e65be-224">Esta propiedad se puede actualizar a través de recursos de hello [manifiesto de la aplicación][AAD-App-Manifest].</span><span class="sxs-lookup"><span data-stu-id="e65be-224">This property can be updated via hello resource [application’s manifest][AAD-App-Manifest].</span></span> <span data-ttu-id="e65be-225">Esto se muestra en un cliente nativo de nivel múltiples llamar al ejemplo de API web de hello [Related Content](#related-content) sección Hola final de este artículo.</span><span class="sxs-lookup"><span data-stu-id="e65be-225">This is demonstrated in a multi-tier native client calling web API sample in hello [Related Content](#related-content) section at hello end of this article.</span></span> <span data-ttu-id="e65be-226">Hello siguiente diagrama proporciona una visión general de consentimiento para una aplicación de varios nivel registrada en un solo inquilino:</span><span class="sxs-lookup"><span data-stu-id="e65be-226">hello following diagram provides an overview of consent for a multi-tier app registered in a single tenant :</span></span>

![Aplicación de cliente conocidas de toomulti nivel de consentimiento][Consent-Multi-Tier-Known-Client] 

<span data-ttu-id="e65be-228">**Múltiples niveles en varios inquilinos**</span><span class="sxs-lookup"><span data-stu-id="e65be-228">**Multiple tiers in multiple tenants**</span></span>

<span data-ttu-id="e65be-229">Un caso similar se produce si se ha registrado distintos niveles de una aplicación de hello en varios inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-229">A similar case happens if hello different tiers of an application are registered in different tenants.</span></span>  <span data-ttu-id="e65be-230">Por ejemplo, considere el caso de hello de la creación de una aplicación cliente nativa que llama Hola API de Office 365 Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="e65be-230">For example, consider hello case of building a native client application that calls hello Office 365 Exchange Online API.</span></span>  <span data-ttu-id="e65be-231">toodevelop Hola nativos aplicaciones y versiones posteriores para toorun de la aplicación nativa de hello en el inquilino de un cliente, de entidad de servicio de Exchange Online de hello debe estar presente.</span><span class="sxs-lookup"><span data-stu-id="e65be-231">toodevelop hello native application, and later for hello native application toorun in a customer’s tenant, hello Exchange Online service principal must be present.</span></span>  <span data-ttu-id="e65be-232">En este caso, hello desarrollador y el cliente deben adquirir Exchange Online para toobe principal del servicio Hola creado en sus inquilinos.</span><span class="sxs-lookup"><span data-stu-id="e65be-232">In this case, hello developer and customer must purchase Exchange Online for hello service principal toobe created in their tenants.</span></span>  

<span data-ttu-id="e65be-233">En caso de hello de una API generada por una organización que no sea de Microsoft, el desarrollador de Hola de hello API debe tooprovide una manera para su aplicación de los clientes tooconsent hello en los inquilinos de sus clientes.</span><span class="sxs-lookup"><span data-stu-id="e65be-233">In hello case of an API built by an organization other than Microsoft, hello developer of hello API needs tooprovide a way for their customers tooconsent hello application into their customers' tenants.</span></span> <span data-ttu-id="e65be-234">Hola recomienda diseño es para Hola 3ª parte developer toobuild Hola API tal que también puede funcionar como un inicio de sesión de tooimplement de cliente web:</span><span class="sxs-lookup"><span data-stu-id="e65be-234">hello recommended design is for hello 3rd party developer toobuild hello API such that it can also function as a web client tooimplement sign-up :</span></span>

1. <span data-ttu-id="e65be-235">Siga Hola Hola de tooensure secciones anterior API implementa los requisitos / código de registro de aplicación de varios inquilinos de Hola</span><span class="sxs-lookup"><span data-stu-id="e65be-235">Follow hello earlier sections tooensure hello API implements hello multi-tenant application registration/code requirements</span></span>
2. <span data-ttu-id="e65be-236">Además tooexposing Hola API ámbitos o roles, asegúrese de registro de hello incluye Hola "iniciar sesión y leer el perfil de usuario" permiso de Azure AD (proporcionada de forma predeterminada)</span><span class="sxs-lookup"><span data-stu-id="e65be-236">In addition tooexposing hello API's scopes/roles, ensure hello registration includes hello "Sign in and read user profile" Azure AD permission (provided by default)</span></span>
3. <span data-ttu-id="e65be-237">Implementar una página de inicio de sesión-en/sesión-up en el cliente web de hello, después de hello [consentimiento del administrador](#admin-consent) guía se ha descrito anteriormente</span><span class="sxs-lookup"><span data-stu-id="e65be-237">Implement a sign-in/sign-up page in hello web client, following hello [admin consent](#admin-consent) guidance discussed earlier</span></span> 
4. <span data-ttu-id="e65be-238">Una vez que la aplicación toohello de consentimiento del usuario de hello, hello servicio principal y consentimiento delegación se crean los vínculos en su inquilino y aplicación nativa de hello puede obtener tokens para hello API</span><span class="sxs-lookup"><span data-stu-id="e65be-238">Once hello user consents toohello application, hello service principal and consent delegation links are created in their tenant, and hello native application can get tokens for hello API</span></span>

<span data-ttu-id="e65be-239">Hola siguiente diagrama proporciona una introducción de consentimiento para una aplicación de varios nivel registrada en distintos inquilinos:</span><span class="sxs-lookup"><span data-stu-id="e65be-239">hello following diagram provides an overview of consent for a multi-tier app registered in different tenants:</span></span>

![Aplicación de varias parte de toomulti-nivel de consentimiento][Consent-Multi-Tier-Multi-Party] 

### <a name="revoking-consent"></a><span data-ttu-id="e65be-241">Revocación del consentimiento</span><span class="sxs-lookup"><span data-stu-id="e65be-241">Revoking Consent</span></span>
<span data-ttu-id="e65be-242">Los usuarios y administradores pueden revocar el consentimiento tooyour aplicación en cualquier momento:</span><span class="sxs-lookup"><span data-stu-id="e65be-242">Users and administrators can revoke consent tooyour application at any time:</span></span>

* <span data-ttu-id="e65be-243">Las aplicaciones de access tooindividual revoke de los usuarios mediante la eliminación de sus [aplicaciones de Panel de acceso] [ AAD-Access-Panel] lista.</span><span class="sxs-lookup"><span data-stu-id="e65be-243">Users revoke access tooindividual applications by removing them from their [Access Panel Applications][AAD-Access-Panel] list.</span></span>
* <span data-ttu-id="e65be-244">Los administradores de revocación el acceso tooapplications quitándolos de Azure AD utilizando la sección de administración de hello Azure AD de hello [portal de Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="e65be-244">Administrators revoke access tooapplications by removing them from Azure AD using hello Azure AD management section of hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="e65be-245">Si un administrador consiente tooan aplicación para todos los usuarios en un inquilino, los usuarios no pueden revocar el acceso individualmente.</span><span class="sxs-lookup"><span data-stu-id="e65be-245">If an administrator consents tooan application for all users in a tenant, users cannot revoke access individually.</span></span>  <span data-ttu-id="e65be-246">Solo el Administrador de hello puede revocar el acceso y solo para toda aplicación Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-246">Only hello administrator can revoke access, and only for hello whole application.</span></span>

### <a name="consent-and-protocol-support"></a><span data-ttu-id="e65be-247">Compatibilidad con el consentimiento y los protocolos</span><span class="sxs-lookup"><span data-stu-id="e65be-247">Consent and Protocol Support</span></span>
<span data-ttu-id="e65be-248">Consentimiento se admite en Azure AD a través de hello OAuth, OpenID Connect, WS-Federation y protocolos SAML.</span><span class="sxs-lookup"><span data-stu-id="e65be-248">Consent is supported in Azure AD via hello OAuth, OpenID Connect, WS-Federation, and SAML protocols.</span></span>  <span data-ttu-id="e65be-249">Hello protocolos SAML y WS-Federation no admiten hello `prompt=admin_consent` parámetro, por lo que solo es posible a través de OAuth y OpenID Connect de consentimiento del administrador.</span><span class="sxs-lookup"><span data-stu-id="e65be-249">hello SAML and WS-Federation protocols do not support hello `prompt=admin_consent` parameter, so admin consent is only possible via OAuth and OpenID Connect.</span></span>

## <a name="multi-tenant-applications-and-caching-access-tokens"></a><span data-ttu-id="e65be-250">Aplicaciones multiempresa y almacenamiento en caché de los tokens de acceso</span><span class="sxs-lookup"><span data-stu-id="e65be-250">Multi-Tenant Applications and Caching Access Tokens</span></span>
<span data-ttu-id="e65be-251">Aplicaciones de varios inquilinos también pueden obtener toocall de tokens de acceso a las API que están protegidas por Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e65be-251">Multi-tenant applications can also get access tokens toocall APIs that are protected by Azure AD.</span></span>  <span data-ttu-id="e65be-252">Un error común al utilizar Hola biblioteca de autenticación de Active Directory (ADAL) con una aplicación de varios inquilinos, es tooinitially solicitud un token para un usuario con/Common, recibir una respuesta y solicitar un token posterior para ese mismo usuario también usa/Common.</span><span class="sxs-lookup"><span data-stu-id="e65be-252">A common error when using hello Active Directory Authentication Library (ADAL) with a multi-tenant application, is tooinitially request a token for a user using /common, receive a response, then request a subsequent token for that same user also using /common.</span></span>  <span data-ttu-id="e65be-253">Puesto que la respuesta de Hola de Azure AD procede de un inquilino, no/común, AAL almacena en memoria caché de token de hello como procedente de inquilino de Hola.</span><span class="sxs-lookup"><span data-stu-id="e65be-253">Since hello response from Azure AD comes from a tenant, not /common, ADAL caches hello token as being from hello tenant.</span></span> <span data-ttu-id="e65be-254">Hola subsiguientes, llame a tooget demasiado común o un token de acceso de entrada de caché de Hola de errores de usuario de Hola y Hola usuario vuelve a estar toosign solicitada en.</span><span class="sxs-lookup"><span data-stu-id="e65be-254">hello subsequent call too/common tooget an access token for hello user misses hello cache entry, and hello user is prompted toosign in again.</span></span>  <span data-ttu-id="e65be-255">tooavoid falta memoria caché de hello, asegúrese de que seguidamente para un usuario de la sesión ya iniciada se realizan llamadas extremo del inquilino de toohello.</span><span class="sxs-lookup"><span data-stu-id="e65be-255">tooavoid missing hello cache, make sure subsequent calls for an already signed in user are made toohello tenant’s endpoint.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e65be-256">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="e65be-256">Next steps</span></span>
<span data-ttu-id="e65be-257">En este artículo, se habrá aprendido cómo toobuild una aplicación que puede iniciar sesión en un usuario de cualquier inquilino de Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e65be-257">In this article, you learned how toobuild an application that can sign in a user from any Azure Active Directory tenant.</span></span> <span data-ttu-id="e65be-258">Después de habilitar el inicio de sesión único entre la aplicación y Azure Active Directory, también puede actualizar su tooaccess aplicación API expuestas por los recursos de Microsoft, como Office 365.</span><span class="sxs-lookup"><span data-stu-id="e65be-258">After enabling Single Sign-On between your app and Azure Active Directory, you can also update your application tooaccess APIs exposed by Microsoft resources, like Office 365.</span></span> <span data-ttu-id="e65be-259">Por lo que puede ofrecer una experiencia personalizada en su aplicación, por ejemplo, que muestra información contextual toohello a los usuarios, como su imagen de perfil o su próxima cita de calendario.</span><span class="sxs-lookup"><span data-stu-id="e65be-259">So you can offer a personalized experience in your application, for example showing contextual information toohello users, like their profile picture or their next calendar appointment.</span></span> <span data-ttu-id="e65be-260">toolearn más acerca de cómo realizar API llama tooAzure Active Directory y servicios de Office 365 como Exchange, SharePoint, OneDrive, OneNote, Planner, Excel y obtener más información, visitan: [Microsoft Graph API][MSFT-Graph-overview].</span><span class="sxs-lookup"><span data-stu-id="e65be-260">toolearn more about making API calls tooAzure Active Directory and Office 365 services like Exchange, SharePoint, OneDrive, OneNote, Planner, Excel and more, visit: [Microsoft Graph API][MSFT-Graph-overview].</span></span>


## <a name="related-content"></a><span data-ttu-id="e65be-261">Contenido relacionado</span><span class="sxs-lookup"><span data-stu-id="e65be-261">Related content</span></span>
* <span data-ttu-id="e65be-262">[Ejemplos de aplicación multiinquilino][AAD-Samples-MT]</span><span class="sxs-lookup"><span data-stu-id="e65be-262">[Multi-tenant application samples][AAD-Samples-MT]</span></span>
* <span data-ttu-id="e65be-263">[Directrices de personalización de marca para aplicaciones][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="e65be-263">[Branding Guidelines for Applications][AAD-App-Branding]</span></span>
* <span data-ttu-id="e65be-264">[Guía del desarrollador de Azure AD][AAD-Dev-Guide]</span><span class="sxs-lookup"><span data-stu-id="e65be-264">[Azure AD Developer's Guide][AAD-Dev-Guide]</span></span>
* <span data-ttu-id="e65be-265">[Objetos Application y objetos ServicePrincipal][AAD-App-SP-Objects]</span><span class="sxs-lookup"><span data-stu-id="e65be-265">[Application Objects and Service Principal Objects][AAD-App-SP-Objects]</span></span>
* <span data-ttu-id="e65be-266">[Integración de aplicaciones con Azure Active Directory][AAD-Integrating-Apps]</span><span class="sxs-lookup"><span data-stu-id="e65be-266">[Integrating Applications with Azure Active Directory][AAD-Integrating-Apps]</span></span>
* <span data-ttu-id="e65be-267">[Información general de hello marco de consentimiento][AAD-Consent-Overview]</span><span class="sxs-lookup"><span data-stu-id="e65be-267">[Overview of hello Consent Framework][AAD-Consent-Overview]</span></span>
* <span data-ttu-id="e65be-268">[Ámbitos de permiso de la API Graph de Microsoft][MSFT-Graph-permision-scopes]</span><span class="sxs-lookup"><span data-stu-id="e65be-268">[Microsoft Graph API Permission Scopes][MSFT-Graph-permision-scopes]</span></span>
* <span data-ttu-id="e65be-269">[Ámbitos de permiso de la API Graph de Azure AD][AAD-Graph-Perm-Scopes]</span><span class="sxs-lookup"><span data-stu-id="e65be-269">[Azure AD Graph API Permission Scopes][AAD-Graph-Perm-Scopes]</span></span>

<span data-ttu-id="e65be-270">Use Hola después de comentarios de tooprovide de sección de comentarios y nos ayudan a refinar y dar forma a nuestro contenido.</span><span class="sxs-lookup"><span data-stu-id="e65be-270">Please use hello following comments section tooprovide feedback and help us refine and shape our content.</span></span>

<!--Reference style links IN USE -->
[AAD-Access-Panel]:  https://myapps.microsoft.com
[AAD-App-Branding]: ./active-directory-branding-guidelines.md
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Consent-Overview]: ./active-directory-integrating-applications.md#overview-of-the-consent-framework
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Overview]: https://azure.microsoft.com/en-us/documentation/articles/active-directory-graph-api/
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Samples-MT]: https://azure.microsoft.com/documentation/samples/?service=active-directory&term=multitenant
[AAD-Why-To-Integrate]: ./active-directory-how-to-integrate.md
[AZURE-portal]: https://portal.azure.com
[MSFT-Graph-overview]: https://graph.microsoft.io/en-us/docs/overview/overview
[MSFT-Graph-permision-scopes]: https://graph.microsoft.io/en-us/docs/authorization/permission_scopes

<!--Image references-->
[AAD-Sign-In]: ./media/active-directory-devhowto-multi-tenant-overview/sign-in-with-microsoft-light.png
[Consent-Single-Tier]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-single-tier.png
[Consent-Multi-Tier-Known-Client]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-known-clients.png
[Consent-Multi-Tier-Multi-Party]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-multi-party.png

<!--Reference style links -->
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Graph-App-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#application-entity
[AAD-Graph-Sp-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity
[AAD-Graph-User-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity
[AAD-How-To-Integrate]: ./active-directory-how-to-integrate.md
[AAD-Security-Token-Claims]: ./active-directory-authentication-scenarios/#claims-in-azure-ad-security-tokens
[AAD-Tokens-Claims]: ./active-directory-token-and-claims.md
[AAD-V2-Dev-Guide]: ../active-directory-appmodel-v2-overview.md
[AZURE-portal]: https://portal.azure.com
[Duyshant-Role-Blog]: http://www.dushyantgill.com/blog/2014/12/10/roles-based-access-control-in-cloud-applications-using-azure-ad/
[JWT]: https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-32
[O365-Perm-Ref]: https://msdn.microsoft.com/en-us/office/office365/howto/application-manifest
[OAuth2-Access-Token-Scopes]: https://tools.ietf.org/html/rfc6749#section-3.3
[OAuth2-AuthZ-Code-Grant-Flow]: https://msdn.microsoft.com/library/azure/dn645542.aspx
[OAuth2-AuthZ-Grant-Types]: https://tools.ietf.org/html/rfc6749#section-1.3 
[OAuth2-Client-Types]: https://tools.ietf.org/html/rfc6749#section-2.1
[OAuth2-Role-Def]: https://tools.ietf.org/html/rfc6749#page-6
[OpenIDConnect]: http://openid.net/specs/openid-connect-core-1_0.html
[OpenIDConnect-ID-Token]: http://openid.net/specs/openid-connect-core-1_0.html#IDToken














