---
title: Referencia de tokens de Azure Active Directory v2.0 | Microsoft Docs
description: "Los tipos de tokens y notificaciones emitidos por el punto de conexión de Azure AD v2.0"
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: dc58c282-9684-4b38-b151-f3e079f034fd
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: a3611a239fe044cf1b953220a6e96b0e101f47a4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="azure-active-directory-v20-tokens-reference"></a><span data-ttu-id="d8d13-103">Referencia de tokens de Azure Active Directory v2.0</span><span class="sxs-lookup"><span data-stu-id="d8d13-103">Azure Active Directory v2.0 tokens reference</span></span>
<span data-ttu-id="d8d13-104">El punto de conexión de Azure Active Directory (Azure AD) v2.0 emite varios tipos de tokens de seguridad en cada [flujo de autenticación](active-directory-v2-flows.md).</span><span class="sxs-lookup"><span data-stu-id="d8d13-104">The Azure Active Directory (Azure AD) v2.0 endpoint emits several types of security tokens in each [authentication flow](active-directory-v2-flows.md).</span></span> <span data-ttu-id="d8d13-105">Esta referencia describe el formato, las características de seguridad y el contenido de cada tipo de token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-105">This reference describes the format, security characteristics, and contents of each type of token.</span></span>

> [!NOTE]
> <span data-ttu-id="d8d13-106">No todas las características y escenarios de Azure Active Directory son compatibles con la versión 2.0 del punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="d8d13-106">The v2.0 endpoint does not support all Azure Active Directory scenarios and features.</span></span> <span data-ttu-id="d8d13-107">Para determinar si debe usar la versión 2.0 del punto de conexión, obtenga información sobre las [limitaciones de esta versión](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="d8d13-107">To determine whether you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>
>

## <a name="types-of-tokens"></a><span data-ttu-id="d8d13-108">Tipos de tokens</span><span class="sxs-lookup"><span data-stu-id="d8d13-108">Types of tokens</span></span>
<span data-ttu-id="d8d13-109">El punto de conexión v2.0 admite el [protocolo de autorización OAuth 2.0](active-directory-v2-protocols.md), que usa tanto tokens de acceso como tokens de actualización.</span><span class="sxs-lookup"><span data-stu-id="d8d13-109">The v2.0 endpoint supports the [OAuth 2.0 authorization protocol](active-directory-v2-protocols.md), which uses access tokens and refresh tokens.</span></span> <span data-ttu-id="d8d13-110">El punto de conexión de v2.0 también admite la autenticación y el inicio de sesión a través de [OpenID Connect](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="d8d13-110">The v2.0 endpoint also supports authentication and sign-in via [OpenID Connect](active-directory-v2-protocols.md).</span></span> <span data-ttu-id="d8d13-111">OpenID Connect presenta un tercer tipo de token: el token de identificador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-111">OpenID Connect introduces a third type of token, the ID token.</span></span> <span data-ttu-id="d8d13-112">Todos estos tokens se representan como un token de *portador*.</span><span class="sxs-lookup"><span data-stu-id="d8d13-112">Each of these tokens is represented as a *bearer* token.</span></span>

<span data-ttu-id="d8d13-113">Un token de portador es un token de seguridad ligero que concede al portador acceso a un recurso protegido.</span><span class="sxs-lookup"><span data-stu-id="d8d13-113">A bearer token is a lightweight security token that grants the bearer access to a protected resource.</span></span> <span data-ttu-id="d8d13-114">El "portador" es cualquier parte que pueda presentar el token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-114">The bearer is any party that can present the token.</span></span> <span data-ttu-id="d8d13-115">Aunque una parte debe autenticarse con Azure AD para recibir el token de portador, si no se realizan los pasos para asegurar el token durante la transmisión y el almacenamiento, este puede interceptarse y ser usado por un usuario no deseado.</span><span class="sxs-lookup"><span data-stu-id="d8d13-115">Although a party must authenticate with Azure AD to receive the bearer token, if steps are not taken to secure the token during transmission and storage, it can be intercepted and used by an unintended party.</span></span> <span data-ttu-id="d8d13-116">Algunos tokens de seguridad tienen un mecanismo integrado que impide que partes no autorizadas puedan usarlos, pero los tokens de portador no disponen de este mecanismo.</span><span class="sxs-lookup"><span data-stu-id="d8d13-116">Some security tokens have a built-in mechanism to prevent unauthorized parties from using them, but bearer tokens do not.</span></span> <span data-ttu-id="d8d13-117">Los tokens de portador deben ser transportados en un canal seguro, como Seguridad de la capa de transporte (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="d8d13-117">Bearer tokens must be transported in a secure channel such as transport layer security (HTTPS).</span></span> <span data-ttu-id="d8d13-118">Si un token de portador se transmite sin este tipo de seguridad, una parte malintencionada puede usar un ataque de tipo "Man in the middle" para adquirir el token y usarlo a fin de obtener acceso sin autorización a un recurso protegido.</span><span class="sxs-lookup"><span data-stu-id="d8d13-118">If a bearer token is transmitted without this type of security, a malicious party could use a "man-in-the-middle attack" to acquire the token and use it for unauthorized access to a protected resource.</span></span> <span data-ttu-id="d8d13-119">Los mismos principios de seguridad se aplican al almacenamiento o almacenamiento en caché de tokens portadores para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="d8d13-119">The same security principles apply when storing or caching bearer tokens for later use.</span></span> <span data-ttu-id="d8d13-120">Siempre debe asegurarse de que la aplicación transmite y almacena los tokens de portador de manera segura.</span><span class="sxs-lookup"><span data-stu-id="d8d13-120">Always ensure that your app securely transmits and stores bearer tokens.</span></span> <span data-ttu-id="d8d13-121">Para otras consideraciones de seguridad sobre los tokens de portador, consulte la [sección 5 de RFC 6750](http://tools.ietf.org/html/rfc6750).</span><span class="sxs-lookup"><span data-stu-id="d8d13-121">For more security considerations for bearer tokens, see [RFC 6750 Section 5](http://tools.ietf.org/html/rfc6750).</span></span>

<span data-ttu-id="d8d13-122">Muchos de los tokens emitidos por el punto de conexión de la versión 2.0 se implementan como JSON Web Tokens (JWT).</span><span class="sxs-lookup"><span data-stu-id="d8d13-122">Many of the tokens issued by the v2.0 endpoint are implemented as JSON Web Tokens (JWTs).</span></span> <span data-ttu-id="d8d13-123">Un JWT es una manera compacta y segura de la dirección URL para transferir información entre dos partes.</span><span class="sxs-lookup"><span data-stu-id="d8d13-123">A JWT is a compact, URL-safe way to transfer information between two parties.</span></span> <span data-ttu-id="d8d13-124">La información contenida en un JWT se denomina *notificación*.</span><span class="sxs-lookup"><span data-stu-id="d8d13-124">The information in a JWT is called a *claim*.</span></span> <span data-ttu-id="d8d13-125">Se trata de una aserción de información sobre el portador y el sujeto del token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-125">It's an assertion of information about the bearer and subject of the token.</span></span> <span data-ttu-id="d8d13-126">En un JWT, las notificaciones son objetos de notación de objetos JavaScript (JSON) que se codifican y serializan para su transmisión.</span><span class="sxs-lookup"><span data-stu-id="d8d13-126">The claims in a JWT are JavaScript Object Notation (JSON) objects that are encoded and serialized for transmission.</span></span> <span data-ttu-id="d8d13-127">Como los JWT que emite el punto de conexión de la versión 2.0 están firmados pero no cifrados, puede inspeccionar fácilmente el contenido de un JWT con fines de depuración.</span><span class="sxs-lookup"><span data-stu-id="d8d13-127">Because the JWTs issued by the v2.0 endpoint are signed but not encrypted, you can easily inspect the contents of a JWT for debugging purposes.</span></span> <span data-ttu-id="d8d13-128">Para más información sobre los JWT, consulte la [especificación de JWT](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html).</span><span class="sxs-lookup"><span data-stu-id="d8d13-128">For more information about JWTs, see the [JWT specification](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html).</span></span>

### <a name="id-tokens"></a><span data-ttu-id="d8d13-129">Tokens de identificador</span><span class="sxs-lookup"><span data-stu-id="d8d13-129">ID tokens</span></span>
<span data-ttu-id="d8d13-130">Un token de identificador es una forma de token de seguridad de inicio de sesión que recibe la aplicación cuando realiza la autenticación mediante [OpenID Connect](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="d8d13-130">An ID token is a form of sign-in security token that your app receives when it performs authentication by using [OpenID Connect](active-directory-v2-protocols.md).</span></span> <span data-ttu-id="d8d13-131">Los tokens de identificador se representan como si fueran [JWT](#types-of-tokens) y contienen notificaciones que se pueden usar para iniciar sesión del usuario en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-131">ID tokens are represented as [JWTs](#types-of-tokens), and they contain claims that you can use to sign the user in to your app.</span></span> <span data-ttu-id="d8d13-132">Puede usar las notificaciones en un token de identificador de varias maneras.</span><span class="sxs-lookup"><span data-stu-id="d8d13-132">You can use the claims in an ID token in various ways.</span></span> <span data-ttu-id="d8d13-133">Habitualmente, los administradores usan los tokens de identificador para mostrar información sobre la cuenta o para tomar decisiones relacionadas con el control de acceso en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-133">Typically, admins use ID tokens to display account information or to make access control decisions in an app.</span></span> <span data-ttu-id="d8d13-134">El punto de conexión de la versión 2.0 solo emite un tipo de token de identificador, que tiene un conjunto coherente de notificaciones, independientemente del tipo de usuario que inició sesión.</span><span class="sxs-lookup"><span data-stu-id="d8d13-134">The v2.0 endpoint issues only one type of ID token, which has a consistent set of claims, regardless of the type of user that is signed in.</span></span> <span data-ttu-id="d8d13-135">El formato y el contenido de los tokens de identificador es el mismo, tanto para los usuarios de cuentas personales de Microsoft como para las cuentas profesionales o educativas.</span><span class="sxs-lookup"><span data-stu-id="d8d13-135">The format and content of ID tokens are the same for personal Microsoft account users and for work or school accounts.</span></span>

<span data-ttu-id="d8d13-136">Actualmente, los tokens de identificador están firmados pero no cifrados.</span><span class="sxs-lookup"><span data-stu-id="d8d13-136">Currently, ID tokens are signed but not encrypted.</span></span> <span data-ttu-id="d8d13-137">Cuando la aplicación recibe un token de identificador, debe [validar la firma](#validating-tokens) para probar la autenticidad del token y validar algunas notificaciones en el token para probar su validez.</span><span class="sxs-lookup"><span data-stu-id="d8d13-137">When your app receives an ID token, it must [validate the signature](#validating-tokens) to prove the token's authenticity and validate a few claims in the token to prove its validity.</span></span> <span data-ttu-id="d8d13-138">Las notificaciones validadas por una aplicación varían en función de los requisitos del escenario, pero la aplicación debe realizar algunas [validaciones de notificación comunes](#validating-tokens) en todos los escenarios.</span><span class="sxs-lookup"><span data-stu-id="d8d13-138">The claims validated by an app vary depending on scenario requirements, but your app must perform some [common claim validations](#validating-tokens) in every scenario.</span></span>

<span data-ttu-id="d8d13-139">En las secciones siguientes, además de un token de identificador de ejemplo, se muestran todos los detalles sobre las notificaciones en los tokens de identificador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-139">We give you the full details about claims in ID tokens in the following sections, in addition to a sample ID token.</span></span> <span data-ttu-id="d8d13-140">Tenga en cuenta que las notificaciones en los tokens de identificador no se devuelven en ningún orden específico.</span><span class="sxs-lookup"><span data-stu-id="d8d13-140">Note that claims in ID tokens are not returned in a specific order.</span></span> <span data-ttu-id="d8d13-141">Además, se pueden agregar nuevas notificaciones en tokens de identificador en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="d8d13-141">Also, new claims can be introduced into ID tokens at any time.</span></span> <span data-ttu-id="d8d13-142">La aplicación no se debe interrumpir cuando se agregan notificaciones nuevas.</span><span class="sxs-lookup"><span data-stu-id="d8d13-142">Your app should not break when new claims are introduced.</span></span> <span data-ttu-id="d8d13-143">La lista siguiente incluye las notificaciones que la aplicación puede interpretar de manera confiable en el momento de redactar este artículo.</span><span class="sxs-lookup"><span data-stu-id="d8d13-143">The following list includes the claims that your app currently can reliably interpret.</span></span> <span data-ttu-id="d8d13-144">Puede encontrar más detalles en la [especificación de OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html).</span><span class="sxs-lookup"><span data-stu-id="d8d13-144">You can find more details in the [OpenID Connect specification](http://openid.net/specs/openid-connect-core-1_0.html).</span></span>

#### <a name="sample-id-token"></a><span data-ttu-id="d8d13-145">Token de identificador de ejemplo</span><span class="sxs-lookup"><span data-stu-id="d8d13-145">Sample ID token</span></span>
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ik1uQ19WWmNBVGZNNXBPWWlKSE1iYTlnb0VLWSJ9.eyJhdWQiOiI2NzMxZGU3Ni0xNGE2LTQ5YWUtOTdiYy02ZWJhNjkxNDM5MWUiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vYjk0MTk4MTgtMDlhZi00OWMyLWIwYzMtNjUzYWRjMWYzNzZlL3YyLjAiLCJpYXQiOjE0NTIyODUzMzEsIm5iZiI6MTQ1MjI4NTMzMSwiZXhwIjoxNDUyMjg5MjMxLCJuYW1lIjoiQmFiZSBSdXRoIiwibm9uY2UiOiIxMjM0NSIsIm9pZCI6ImExZGJkZGU4LWU0ZjktNDU3MS1hZDkzLTMwNTllMzc1MGQyMyIsInByZWZlcnJlZF91c2VybmFtZSI6InRoZWdyZWF0YmFtYmlub0BueXkub25taWNyb3NvZnQuY29tIiwic3ViIjoiTUY0Zi1nZ1dNRWppMTJLeW5KVU5RWnBoYVVUdkxjUXVnNWpkRjJubDAxUSIsInRpZCI6ImI5NDE5ODE4LTA5YWYtNDljMi1iMGMzLTY1M2FkYzFmMzc2ZSIsInZlciI6IjIuMCJ9.p_rYdrtJ1oCmgDBggNHB9O38KTnLCMGbMDODdirdmZbmJcTHiZDdtTc-hguu3krhbtOsoYM2HJeZM3Wsbp_YcfSKDY--X_NobMNsxbT7bqZHxDnA2jTMyrmt5v2EKUnEeVtSiJXyO3JWUq9R0dO-m4o9_8jGP6zHtR62zLaotTBYHmgeKpZgTFB9WtUq8DVdyMn_HSvQEfz-LWqckbcTwM_9RNKoGRVk38KChVJo4z5LkksYRarDo8QgQ7xEKmYmPvRr_I7gvM2bmlZQds2OeqWLB1NSNbFZqyFOCgYn3bAQ-nEQSKwBaA36jYGPOVG2r2Qv1uKcpSOxzxaQybzYpQ
```

> [!TIP]
> <span data-ttu-id="d8d13-146">Como práctica, para inspeccionar las notificaciones en el token de identificador de ejemplo, pegue el token de identificador de ejemplo en [calebb.net](http://calebb.net/).</span><span class="sxs-lookup"><span data-stu-id="d8d13-146">For practice, to inspect the claims in the sample ID token, paste the sample ID token into [calebb.net](http://calebb.net/).</span></span>
>
>

#### <a name="claims-in-id-tokens"></a><span data-ttu-id="d8d13-147">Notificaciones en tokens de identificador</span><span class="sxs-lookup"><span data-stu-id="d8d13-147">Claims in ID tokens</span></span>
| <span data-ttu-id="d8d13-148">Nombre</span><span class="sxs-lookup"><span data-stu-id="d8d13-148">Name</span></span> | <span data-ttu-id="d8d13-149">Notificación</span><span class="sxs-lookup"><span data-stu-id="d8d13-149">Claim</span></span> | <span data-ttu-id="d8d13-150">Valor de ejemplo</span><span class="sxs-lookup"><span data-stu-id="d8d13-150">Example value</span></span> | <span data-ttu-id="d8d13-151">Descripción</span><span class="sxs-lookup"><span data-stu-id="d8d13-151">Description</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="d8d13-152">audience</span><span class="sxs-lookup"><span data-stu-id="d8d13-152">audience</span></span> |`aud` |`6731de76-14a6-49ae-97bc-6eba6914391e` |<span data-ttu-id="d8d13-153">Identifica al destinatario previsto del token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-153">Identifies the intended recipient of the token.</span></span> <span data-ttu-id="d8d13-154">En los tokens de identificador, la audiencia es el identificador de aplicación de su aplicación, que se asigna a la aplicación en el portal de registro de aplicaciones de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="d8d13-154">In ID tokens, the audience is your app's Application ID, assigned to your app in the Microsoft Application Registration Portal.</span></span> <span data-ttu-id="d8d13-155">La aplicación debe validar este valor y rechazar el token si el valor no coincide.</span><span class="sxs-lookup"><span data-stu-id="d8d13-155">Your app should validate this value, and reject the token if the value does not match.</span></span> |
| <span data-ttu-id="d8d13-156">issuer</span><span class="sxs-lookup"><span data-stu-id="d8d13-156">issuer</span></span> |`iss` |`https://login.microsoftonline.com/b9419818-09af-49c2-b0c3-653adc1f376e/v2.0 ` |<span data-ttu-id="d8d13-157">Identifica el servicio de token de seguridad (STS) que construye y devuelve el token, así como el inquilino de Azure AD en el que se autenticó al usuario.</span><span class="sxs-lookup"><span data-stu-id="d8d13-157">Identifies the security token service (STS) that constructs and returns the token, and the Azure AD tenant in which the user was authenticated.</span></span> <span data-ttu-id="d8d13-158">La aplicación tiene que validar la notificación del emisor para asegurarse de que el token proviene del extremo de la versión 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-158">Your app should validate the issuer claim to ensure that the token came from the v2.0 endpoint.</span></span> <span data-ttu-id="d8d13-159">También debe usar la parte del GUID de la notificación para restringir el conjunto de inquilinos que pueden iniciar sesión en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-159">It also should use the GUID portion of the claim to restrict the set of tenants that can sign in to the app.</span></span> <span data-ttu-id="d8d13-160">El GUID que indica que el usuario es un usuario consumidor desde una cuenta de Microsoft es `9188040d-6c67-4c5b-b112-36a304b66dad`.</span><span class="sxs-lookup"><span data-stu-id="d8d13-160">The GUID that indicates that the user is a consumer user from a Microsoft account is `9188040d-6c67-4c5b-b112-36a304b66dad`.</span></span> |
| <span data-ttu-id="d8d13-161">issued at</span><span class="sxs-lookup"><span data-stu-id="d8d13-161">issued at</span></span> |`iat` |`1452285331` |<span data-ttu-id="d8d13-162">La hora en que se emitió el token, que se representa en tiempo de época.</span><span class="sxs-lookup"><span data-stu-id="d8d13-162">The time at which the token was issued, represented in epoch time.</span></span> |
| <span data-ttu-id="d8d13-163">expiration time</span><span class="sxs-lookup"><span data-stu-id="d8d13-163">expiration time</span></span> |`exp` |`1452289231` |<span data-ttu-id="d8d13-164">La hora en que el token deja de ser válido, que se representa en tiempo de época.</span><span class="sxs-lookup"><span data-stu-id="d8d13-164">The time at which the token becomes invalid, represented in epoch time.</span></span> <span data-ttu-id="d8d13-165">La aplicación tiene que usar esta notificación para comprobar la validez de la duración del token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-165">Your app should use this claim to verify the validity of the token lifetime.</span></span> |
| <span data-ttu-id="d8d13-166">not before</span><span class="sxs-lookup"><span data-stu-id="d8d13-166">not before</span></span> |`nbf` |`1452285331` |<span data-ttu-id="d8d13-167">Hora a la que el token pasa a ser válido, representada en tiempo de época.</span><span class="sxs-lookup"><span data-stu-id="d8d13-167">The time at which the token becomes valid, represented in epoch time.</span></span> <span data-ttu-id="d8d13-168">Normalmente es la misma que la hora de emisión.</span><span class="sxs-lookup"><span data-stu-id="d8d13-168">It is usually the same as the issuance time.</span></span> <span data-ttu-id="d8d13-169">La aplicación tiene que usar esta notificación para comprobar la validez de la duración del token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-169">Your app should use this claim to verify the validity of the token lifetime.</span></span> |
| <span data-ttu-id="d8d13-170">versión</span><span class="sxs-lookup"><span data-stu-id="d8d13-170">version</span></span> |`ver` |`2.0` |<span data-ttu-id="d8d13-171">La versión del token de identificador, tal como lo define Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d8d13-171">The version of the ID token, as defined by Azure AD.</span></span> <span data-ttu-id="d8d13-172">En el caso del punto de conexión de la versión 2.0, el valor es `2.0`.</span><span class="sxs-lookup"><span data-stu-id="d8d13-172">For the v2.0 endpoint, the value is `2.0`.</span></span> |
| <span data-ttu-id="d8d13-173">tenant ID</span><span class="sxs-lookup"><span data-stu-id="d8d13-173">tenant ID</span></span> |`tid` |`b9419818-09af-49c2-b0c3-653adc1f376e` |<span data-ttu-id="d8d13-174">Un GUID que representa el inquilino de Azure AD de donde proviene el usuario.</span><span class="sxs-lookup"><span data-stu-id="d8d13-174">A GUID that represents the Azure AD tenant that the user is from.</span></span> <span data-ttu-id="d8d13-175">En el caso de las cuentas profesionales y educativas, el GUID es el identificador del inquilino inmutable de la organización a la que pertenece el usuario.</span><span class="sxs-lookup"><span data-stu-id="d8d13-175">For work and school accounts, the GUID is the immutable tenant ID of the organization that the user belongs to.</span></span> <span data-ttu-id="d8d13-176">En el caso de las cuentas personales, el valor es `9188040d-6c67-4c5b-b112-36a304b66dad`.</span><span class="sxs-lookup"><span data-stu-id="d8d13-176">For personal accounts, the value is `9188040d-6c67-4c5b-b112-36a304b66dad`.</span></span> <span data-ttu-id="d8d13-177">El ámbito `profile` es necesario para recibir esta notificación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-177">The `profile` scope is required in order to receive this claim.</span></span> |
| <span data-ttu-id="d8d13-178">code hash</span><span class="sxs-lookup"><span data-stu-id="d8d13-178">code hash</span></span> |`c_hash` |`SGCPtt01wxwfgnYZy2VJtQ` |<span data-ttu-id="d8d13-179">El hash de código se incluye en los tokens de identificador solo cuando se emite el token de identificador con un código de autorización de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-179">The code hash is included in ID tokens only when the ID token is issued with an OAuth 2.0 authorization code.</span></span> <span data-ttu-id="d8d13-180">Se puede usar para validar la autenticidad de un código de autorización.</span><span class="sxs-lookup"><span data-stu-id="d8d13-180">It can be used to validate the authenticity of an authorization code.</span></span> <span data-ttu-id="d8d13-181">Para detalles sobre cómo realizar esta validación, consulte la [especificación de OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html).</span><span class="sxs-lookup"><span data-stu-id="d8d13-181">For details about performing this validation, see the [OpenID Connect specification](http://openid.net/specs/openid-connect-core-1_0.html).</span></span> |
| <span data-ttu-id="d8d13-182">access token hash</span><span class="sxs-lookup"><span data-stu-id="d8d13-182">access token hash</span></span> |`at_hash` |`SGCPtt01wxwfgnYZy2VJtQ` |<span data-ttu-id="d8d13-183">El hash de token de acceso se incluye en los tokens de identificador solo cuando el token de identificador se emite con un token de acceso de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-183">The access token hash is included in ID tokens only when the ID token is issued with an OAuth 2.0 access token.</span></span> <span data-ttu-id="d8d13-184">Se puede usar para validar la autenticidad de un token de acceso.</span><span class="sxs-lookup"><span data-stu-id="d8d13-184">It can be used to validate the authenticity of an access token.</span></span> <span data-ttu-id="d8d13-185">Para detalles sobre cómo realizar esta validación, consulte la [especificación de OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html).</span><span class="sxs-lookup"><span data-stu-id="d8d13-185">For details about performing this validation, see the [OpenID Connect specification](http://openid.net/specs/openid-connect-core-1_0.html).</span></span> |
| <span data-ttu-id="d8d13-186">valor de seguridad</span><span class="sxs-lookup"><span data-stu-id="d8d13-186">nonce</span></span> |`nonce` |`12345` |<span data-ttu-id="d8d13-187">El valor de seguridad es una estrategia para mitigar los ataques de reproducción de los tokens.</span><span class="sxs-lookup"><span data-stu-id="d8d13-187">The nonce is a strategy for mitigating token replay attacks.</span></span> <span data-ttu-id="d8d13-188">La aplicación puede especificar un valor de seguridad en una solicitud de autorización mediante el parámetro de consulta `nonce` .</span><span class="sxs-lookup"><span data-stu-id="d8d13-188">Your app can specify a nonce in an authorization request by using the `nonce` query parameter.</span></span> <span data-ttu-id="d8d13-189">El valor que proporciona en la solicitud se emite en la notificación `nonce` del token de identificador, sin modificaciones.</span><span class="sxs-lookup"><span data-stu-id="d8d13-189">The value you provide in the request is emitted in the ID token's `nonce` claim, unmodified.</span></span> <span data-ttu-id="d8d13-190">La aplicación puede comprobar el valor con respecto al valor que especifica en la solicitud, que asocia la sesión de la aplicación con un token de identificador específico.</span><span class="sxs-lookup"><span data-stu-id="d8d13-190">Your app can verify the value against the value it specified on the request, which associates the app's session with a specific ID token.</span></span> <span data-ttu-id="d8d13-191">La aplicación tiene que realizar esta validación durante el proceso de validación del token de identificador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-191">Your app should perform this validation during the ID token validation process.</span></span> |
| <span data-ttu-id="d8d13-192">name</span><span class="sxs-lookup"><span data-stu-id="d8d13-192">name</span></span> |`name` |`Babe Ruth` |<span data-ttu-id="d8d13-193">La notificación de nombre proporciona un valor en lenguaje natural que identifica al firmante del token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-193">The name claim provides a human-readable value that identifies the subject of the token.</span></span> <span data-ttu-id="d8d13-194">No se asegura que el valor sea único, es mutable y está diseñado para usarse solo con fines de visualización.</span><span class="sxs-lookup"><span data-stu-id="d8d13-194">The value is not guaranteed to be unique, it is mutable, and it's designed to be used only for display purposes.</span></span> <span data-ttu-id="d8d13-195">El ámbito `profile` es necesario para recibir esta notificación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-195">The `profile` scope is required in order to receive this claim.</span></span> |
| <span data-ttu-id="d8d13-196">email</span><span class="sxs-lookup"><span data-stu-id="d8d13-196">email</span></span> |`email` |`thegreatbambino@nyy.onmicrosoft.com` |<span data-ttu-id="d8d13-197">La dirección de correo electrónico principal asociada con la cuenta de usuario, si existe.</span><span class="sxs-lookup"><span data-stu-id="d8d13-197">The primary email address associated with the user account, if one exists.</span></span> <span data-ttu-id="d8d13-198">Su valor es mutable y podría cambiar en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="d8d13-198">Its value is mutable and might change over time.</span></span> <span data-ttu-id="d8d13-199">El ámbito `email` es necesario para recibir esta notificación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-199">The `email` scope is required in order to receive this claim.</span></span> |
| <span data-ttu-id="d8d13-200">preferred username</span><span class="sxs-lookup"><span data-stu-id="d8d13-200">preferred username</span></span> |`preferred_username` |`thegreatbambino@nyy.onmicrosoft.com` |<span data-ttu-id="d8d13-201">El nombre de usuario principal que representa al usuario en el punto de conexión de la versión 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-201">The primary username that represents the user in the v2.0 endpoint.</span></span> <span data-ttu-id="d8d13-202">Puede ser una dirección de correo electrónico, un número de teléfono o un nombre de usuario genérico sin un formato especificado.</span><span class="sxs-lookup"><span data-stu-id="d8d13-202">It could be an email address, phone number, or a generic username without a specified format.</span></span> <span data-ttu-id="d8d13-203">Su valor es mutable y podría cambiar en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="d8d13-203">Its value is mutable and might change over time.</span></span> <span data-ttu-id="d8d13-204">El ámbito `profile` es necesario para recibir esta notificación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-204">The `profile` scope is required in order to receive this claim.</span></span> |
| <span data-ttu-id="d8d13-205">subject</span><span class="sxs-lookup"><span data-stu-id="d8d13-205">subject</span></span> |`sub` |`MF4f-ggWMEji12KynJUNQZphaUTvLcQug5jdF2nl01Q` | <span data-ttu-id="d8d13-206">La entidad de seguridad sobre la que el token declara información como, por ejemplo, el usuario de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-206">The principal about which the token asserts information, such as the user of an app.</span></span> <span data-ttu-id="d8d13-207">Este valor es inmutable y no se puede reasignar ni volver a usar.</span><span class="sxs-lookup"><span data-stu-id="d8d13-207">This value is immutable and cannot be reassigned or reused.</span></span> <span data-ttu-id="d8d13-208">Se puede usar para realizar comprobaciones de autorización de forma segura, por ejemplo, cuando el token se usa para acceder a un recurso, y se puede usar como clave en tablas de base de datos.</span><span class="sxs-lookup"><span data-stu-id="d8d13-208">It can be used to perform authorization checks safely, such as when the token is used to access a resource, and can be used as a key in database tables.</span></span> <span data-ttu-id="d8d13-209">Dado que el firmante siempre está presente en los tokens que emite Azure AD, se recomienda usar este valor en un sistema de autorización de propósito general.</span><span class="sxs-lookup"><span data-stu-id="d8d13-209">Because the subject is always present in the tokens that Azure AD issues, we recommend using this value in a general-purpose authorization system.</span></span> <span data-ttu-id="d8d13-210">El asunto es, sin embargo, un identificador en pares (es único para un id. de aplicación determinado).</span><span class="sxs-lookup"><span data-stu-id="d8d13-210">The subject is, however, a pairwise identifier - it is unique to a particular application ID.</span></span>  <span data-ttu-id="d8d13-211">Por lo tanto, si un usuario inicia sesión en dos aplicaciones diferentes con dos identificadores de cliente diferente, esas aplicaciones recibirán dos valores diferentes para la notificación de asunto.</span><span class="sxs-lookup"><span data-stu-id="d8d13-211">Therefore, if a single user signs into two different apps using two different client IDs, those apps will receive two different values for the subject claim.</span></span>  <span data-ttu-id="d8d13-212">Esto puede ser o no deseable dependiendo de los requisitos de arquitectura y privacidad.</span><span class="sxs-lookup"><span data-stu-id="d8d13-212">This may or may not be desired depending on your architecture and privacy requirements.</span></span> |
| <span data-ttu-id="d8d13-213">object ID</span><span class="sxs-lookup"><span data-stu-id="d8d13-213">object ID</span></span> |`oid` |`a1dbdde8-e4f9-4571-ad93-3059e3750d23` | <span data-ttu-id="d8d13-214">El identificador inmutable de un objeto en el sistema de identidades Microsoft, en este caso, una cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="d8d13-214">The immutable identifier for an object in the Microsoft identity system, in this case, a user account.</span></span>  <span data-ttu-id="d8d13-215">También se puede usar para realizar comprobaciones de autorización de forma segura y como clave en tablas de base de datos.</span><span class="sxs-lookup"><span data-stu-id="d8d13-215">It can also be used to perform authorization checks safely and as a key in database tables.</span></span> <span data-ttu-id="d8d13-216">Este identificador identifica de forma única el usuario entre aplicaciones: dos aplicaciones diferentes que inician sesión con el mismo usuario recibirán el mismo valor en la notificación `oid`.</span><span class="sxs-lookup"><span data-stu-id="d8d13-216">This ID uniquely identifies the user across applications - two different applications signing in the same user will receive the same value in the `oid` claim.</span></span>  <span data-ttu-id="d8d13-217">Esto significa que puede usarse al realizar consultas en Microsoft Online Services, como Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="d8d13-217">This means that it can be used when making queries to Microsoft online services, such as the Microsoft Graph.</span></span>  <span data-ttu-id="d8d13-218">Microsoft Graph devuelve este identificador como la propiedad `id` para una cuenta de usuario determinada.</span><span class="sxs-lookup"><span data-stu-id="d8d13-218">The Microsoft Graph will return this ID as the `id` property for a given user account.</span></span>  <span data-ttu-id="d8d13-219">Dado que la notificación `oid` permite que varias aplicaciones pongan en correlación a los usuarios, se requiere el ámbito `profile` para recibir esta notificación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-219">Because the `oid` allows multiple apps to correlate users, the `profile` scope is required in order to receive this claim.</span></span> <span data-ttu-id="d8d13-220">Tenga en cuenta que si un usuario existe en varios inquilinos, el usuario contendrá un identificador de objeto distinto en cada inquilino, se consideran cuentas diferentes, incluso si el usuario inicia sesión en todas las cuentas con las mismas credenciales.</span><span class="sxs-lookup"><span data-stu-id="d8d13-220">Note that if a single user exists in multiple tenants, the user will contain a different object ID in each tenant - they are considered different accounts, even though the user logs into each account with the same credentials.</span></span> |

### <a name="access-tokens"></a><span data-ttu-id="d8d13-221">Tokens de acceso</span><span class="sxs-lookup"><span data-stu-id="d8d13-221">Access tokens</span></span>
<span data-ttu-id="d8d13-222">Actualmente, solo los servicios Microsoft pueden consumir los tokens de acceso que emite el punto de conexión de la versión 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-222">Currently, access tokens issued by the v2.0 endpoint can be consumed only by Microsoft Services.</span></span> <span data-ttu-id="d8d13-223">Las aplicaciones no necesitan realizar ninguna validación o inspección de los tokens de acceso para ninguno de los escenarios admitidos actualmente.</span><span class="sxs-lookup"><span data-stu-id="d8d13-223">Your apps shouldn't need to perform any validation or inspection of access tokens for any of the currently supported scenarios.</span></span> <span data-ttu-id="d8d13-224">Los tokens de acceso se pueden tratar como completamente opacos.</span><span class="sxs-lookup"><span data-stu-id="d8d13-224">You can treat access tokens as completely opaque.</span></span> <span data-ttu-id="d8d13-225">Solo son cadenas que la aplicación puede pasar a Microsoft en las solicitudes HTTP.</span><span class="sxs-lookup"><span data-stu-id="d8d13-225">They are just strings that your app can pass to Microsoft in HTTP requests.</span></span>

<span data-ttu-id="d8d13-226">En un futuro próximo, el extremo de la versión 2.0 podrá hacer que la aplicación reciba los tokens de acceso de otros clientes.</span><span class="sxs-lookup"><span data-stu-id="d8d13-226">In the near future, the v2.0 endpoint will introduce the ability for your app to receive access tokens from other clients.</span></span> <span data-ttu-id="d8d13-227">En ese momento, la información que aparece en este tema de referencia se actualizará con la información que necesita para que la aplicación realice la validación del token de acceso y otras tareas similares.</span><span class="sxs-lookup"><span data-stu-id="d8d13-227">At that time, the information in this reference topic will be updated with the information that you need for your app to perform access token validation and other similar tasks.</span></span>

<span data-ttu-id="d8d13-228">Cuando solicitas un token de acceso desde el punto de conexión de la versión 2.0, este punto de acceso también devuelve metadatos sobre el token de acceso para el uso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-228">When you request an access token from the v2.0 endpoint, the v2.0 endpoint also returns metadata about the access token for your app to use.</span></span> <span data-ttu-id="d8d13-229">Esta información incluye la hora de expiración del token de acceso y los ámbitos para los que es válido.</span><span class="sxs-lookup"><span data-stu-id="d8d13-229">This information includes the expiry time of the access token and the scopes for which it is valid.</span></span> <span data-ttu-id="d8d13-230">La aplicación usa estos metadatos para realizar un almacenamiento en caché inteligente de los tokens de acceso sin tener que analizar y abrir el token de acceso mismo.</span><span class="sxs-lookup"><span data-stu-id="d8d13-230">Your app uses this metadata to perform intelligent caching of access tokens without having to parse open the access token itself.</span></span>

### <a name="refresh-tokens"></a><span data-ttu-id="d8d13-231">Tokens de actualización</span><span class="sxs-lookup"><span data-stu-id="d8d13-231">Refresh tokens</span></span>
<span data-ttu-id="d8d13-232">Los tokens de actualización son tokens de seguridad que la aplicación puede usar para obtener nuevos tokens de acceso en un flujo de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-232">Refresh tokens are security tokens that your app can use to get new access tokens in an OAuth 2.0 flow.</span></span> <span data-ttu-id="d8d13-233">La aplicación puede usar tokens de actualización para obtener acceso a largo plazo a los recursos en nombre de un usuario sin necesidad de interacción con el usuario.</span><span class="sxs-lookup"><span data-stu-id="d8d13-233">Your app can use refresh tokens to achieve long-term access to resources on behalf of a user without requiring interaction with the user.</span></span>

<span data-ttu-id="d8d13-234">Los tokens de actualización tienen varios recursos.</span><span class="sxs-lookup"><span data-stu-id="d8d13-234">Refresh tokens are multi-resource.</span></span> <span data-ttu-id="d8d13-235">Un token de actualización recibido durante una solicitud de token para un recurso se puede canjear para los tokens de acceso a un recurso completamente diferente.</span><span class="sxs-lookup"><span data-stu-id="d8d13-235">A refresh token received during a token request for one resource can be redeemed for access tokens to a completely different resource.</span></span>

<span data-ttu-id="d8d13-236">Para recibir una actualización en la respuesta de un token, la aplicación debe solicitar el ámbito `offline_acesss` y obtener su concesión.</span><span class="sxs-lookup"><span data-stu-id="d8d13-236">To receive a refresh in a token response, your app must request and be granted the `offline_acesss` scope.</span></span> <span data-ttu-id="d8d13-237">Para más información sobre el ámbito `offline_access`, consulte el artículo sobre [consentimiento y ámbitos](active-directory-v2-scopes.md).</span><span class="sxs-lookup"><span data-stu-id="d8d13-237">To learn more about the `offline_access` scope, see the [consent and scopes](active-directory-v2-scopes.md) article.</span></span>

<span data-ttu-id="d8d13-238">Los tokens de actualización son, y siempre serán, totalmente opacos para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-238">Refresh tokens are, and always will be, completely opaque to your app.</span></span> <span data-ttu-id="d8d13-239">Los emite el punto de conexión de Azure AD v2.0 y solo los puede inspeccionar e interpretar el punto de conexión v2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-239">They are issued by the Azure AD v2.0 endpoint and can only be inspected and interpreted by the v2.0 endpoint.</span></span> <span data-ttu-id="d8d13-240">También son de larga duración, pero no se debe componer la aplicación esperando que un token de actualización dure por cualquier período de tiempo.</span><span class="sxs-lookup"><span data-stu-id="d8d13-240">They are long-lived, but your app should not be written to expect that a refresh token will last for any period of time.</span></span> <span data-ttu-id="d8d13-241">Los tokens de actualización pueden invalidarse en cualquier momento por diversos motivos.</span><span class="sxs-lookup"><span data-stu-id="d8d13-241">Refresh tokens can be invalidated at any moment for various reasons.</span></span> <span data-ttu-id="d8d13-242">La única forma para que la aplicación sepa si un token de actualización es válido es intentar canjearlo realizando una solicitud de token al extremo de la versión 2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-242">The only way for your app to know if a refresh token is valid is to attempt to redeem it by making a token request to the v2.0 endpoint.</span></span>

<span data-ttu-id="d8d13-243">Cuando se canjea un token de actualización por un nuevo token de acceso (y si se concedió el ámbito `offline_access` a la aplicación), se recibe un nuevo token de actualización en la respuesta del token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-243">When you redeem a refresh token for a new access token (and if your app had been granted the `offline_access` scope), you receive a new refresh token in the token response.</span></span> <span data-ttu-id="d8d13-244">Debe guardar el token de actualización recién emitido; para ello, reemplace el que usó en la solicitud.</span><span class="sxs-lookup"><span data-stu-id="d8d13-244">Save the newly issued refresh token, to replace the one you used in the request.</span></span> <span data-ttu-id="d8d13-245">Esto garantiza que los tokens de actualización sigan siendo válidos mientras sea posible.</span><span class="sxs-lookup"><span data-stu-id="d8d13-245">This guarantees that your refresh tokens remain valid for as long as possible.</span></span>

## <a name="validating-tokens"></a><span data-ttu-id="d8d13-246">Validación de los tokens</span><span class="sxs-lookup"><span data-stu-id="d8d13-246">Validating tokens</span></span>
<span data-ttu-id="d8d13-247">En este momento, la única validación de tokens que deberían realizar las aplicaciones es la validación de tokens de identificador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-247">Currently, the only token validation your apps should need to perform is validating ID tokens.</span></span> <span data-ttu-id="d8d13-248">Para validar un token de identificador, la aplicación debe validar tanto la firma del token de identificador como las notificaciones en el token de identificador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-248">To validate an ID token, your app should validate both the ID token's signature and the claims in the ID token.</span></span>

<!-- TODO: Link -->
<span data-ttu-id="d8d13-249">Microsoft proporciona bibliotecas y ejemplos de código que le muestran cómo controlar fácilmente la validación de token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-249">Microsoft provides libraries and code samples that show you how to easily handle token validation.</span></span> <span data-ttu-id="d8d13-250">En las secciones siguientes, se describe el proceso subyacente.</span><span class="sxs-lookup"><span data-stu-id="d8d13-250">In the next sections, we describe the underlying process.</span></span> <span data-ttu-id="d8d13-251">Varias bibliotecas de código abierto de terceros también están disponibles para validación de JWT.</span><span class="sxs-lookup"><span data-stu-id="d8d13-251">Several third-party open-source libraries also are available for JWT validation.</span></span> <span data-ttu-id="d8d13-252">Hay al menos una opción de biblioteca para casi cualquier plataforma y lenguaje.</span><span class="sxs-lookup"><span data-stu-id="d8d13-252">There's at least one library option for almost every platform and language.</span></span>

### <a name="validate-the-signature"></a><span data-ttu-id="d8d13-253">validar la firma</span><span class="sxs-lookup"><span data-stu-id="d8d13-253">Validate the signature</span></span>
<span data-ttu-id="d8d13-254">Un JWT contiene tres segmentos, que están separados por el carácter `.` .</span><span class="sxs-lookup"><span data-stu-id="d8d13-254">A JWT contains three segments, which are separated by the `.` character.</span></span> <span data-ttu-id="d8d13-255">El primer segmento se conoce como el *encabezado*, el segundo, como el *cuerpo*, y el tercero como la *firma*.</span><span class="sxs-lookup"><span data-stu-id="d8d13-255">The first segment is known as the *header*, the second segment is the *body*, and the third segment is the *signature*.</span></span> <span data-ttu-id="d8d13-256">El segmento de firma se puede usar para validar la autenticidad del token de identificador para que la aplicación pueda confiar en él.</span><span class="sxs-lookup"><span data-stu-id="d8d13-256">The signature segment can be used to validate the authenticity of the ID token so that it can be trusted by your app.</span></span>

<span data-ttu-id="d8d13-257">Los tokens de identificador se firman con algoritmos de cifrado asimétrico estándar del sector, como RSA 256.</span><span class="sxs-lookup"><span data-stu-id="d8d13-257">ID tokens are signed by using industry-standard asymmetric encryption algorithms, such as RSA 256.</span></span> <span data-ttu-id="d8d13-258">El encabezado del token de identificador tiene información sobre el método de cifrado y la clave que se usan para firmar el token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-258">The header of the ID token has information about the key and encryption method used to sign the token.</span></span> <span data-ttu-id="d8d13-259">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d8d13-259">For example:</span></span>

```
{
  "typ": "JWT",
  "alg": "RS256",
  "kid": "MnC_VZcATfM5pOYiJHMba9goEKY"
}
```

<span data-ttu-id="d8d13-260">La notificación `alg` indica el algoritmo que se usó para firmar el token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-260">The `alg` claim indicates the algorithm that was used to sign the token.</span></span> <span data-ttu-id="d8d13-261">La notificación `kid` indica la clave pública que se usó para firmar el token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-261">The `kid` claim indicates the public key that was used to sign the token.</span></span>

<span data-ttu-id="d8d13-262">En cualquier momento, el punto de conexión v2.0 puede firmar un token de identificador mediante cualquiera de un determinado conjunto de pares de claves pública y privada.</span><span class="sxs-lookup"><span data-stu-id="d8d13-262">At any time, the v2.0 endpoint might sign an ID token by using any one of a specific set of public-private key pairs.</span></span> <span data-ttu-id="d8d13-263">El punto de conexión v2.0 gira el conjunto de claves posible de manera periódica, por lo que la aplicación debería estar escrita de manera de controlar automáticamente esos cambios de clave.</span><span class="sxs-lookup"><span data-stu-id="d8d13-263">The v2.0 endpoint periodically rotates the possible set of keys, so your app should be written to handle those key changes automatically.</span></span> <span data-ttu-id="d8d13-264">Una frecuencia razonable para comprobar las actualizaciones de las claves públicas que usa el punto de conexión v2.0 es cada 24 horas.</span><span class="sxs-lookup"><span data-stu-id="d8d13-264">A reasonable frequency to check for updates to the public keys used by the v2.0 endpoint is every 24 hours.</span></span>

<span data-ttu-id="d8d13-265">Puede adquirir los datos de la clave de firma que necesita para validar la firma usando el documento de metadatos de OpenID Connect, ubicado en:</span><span class="sxs-lookup"><span data-stu-id="d8d13-265">You can acquire the signing key data that you need to validate the signature by using the OpenID Connect metadata document located at:</span></span>

```
https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration
```

> [!TIP]
> <span data-ttu-id="d8d13-266">Pruebe la dirección URL en un explorador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-266">Try the URL in a browser!</span></span>
>
>

<span data-ttu-id="d8d13-267">Este documento de metadatos es un objeto JSON que tiene varias piezas útiles de información, como la ubicación de los diferentes puntos de conexión que se necesitan para la autenticación de OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="d8d13-267">This metadata document is a JSON object that has several useful pieces of information, such as the location of the various endpoints required for OpenID Connect authentication.</span></span>  <span data-ttu-id="d8d13-268">El documento también incluye un *jwks_uri*, que ofrece la ubicación del conjunto de claves públicas que se usan para firmar los tokens.</span><span class="sxs-lookup"><span data-stu-id="d8d13-268">The document also includes a *jwks_uri*, which gives the location of the set of public keys used to sign tokens.</span></span> <span data-ttu-id="d8d13-269">El documento JSON que se encuentra en el jwks_uri tiene toda la información de la clave pública que actualmente está en uso.</span><span class="sxs-lookup"><span data-stu-id="d8d13-269">The JSON document located at the jwks_uri has all the public key information that is currently in use.</span></span> <span data-ttu-id="d8d13-270">La aplicación puede usar la notificación `kid` en el encabezado de JWT para seleccionar la clave pública que se usó en este documento para firmar un token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-270">Your app can use the `kid` claim in the JWT header to select which public key in this document has been used to sign a token.</span></span> <span data-ttu-id="d8d13-271">Luego realiza la validación de la firma mediante la clave pública correcta y el algoritmo indicado.</span><span class="sxs-lookup"><span data-stu-id="d8d13-271">It then performs signature validation by using the correct public key and the indicated algorithm.</span></span>

<span data-ttu-id="d8d13-272">Cómo se realiza la validación de la firma queda fuera del ámbito de este documento.</span><span class="sxs-lookup"><span data-stu-id="d8d13-272">Performing signature validation is outside the scope of this document.</span></span> <span data-ttu-id="d8d13-273">Hay muchas bibliotecas de código abierto disponibles para ayudarle con esto.</span><span class="sxs-lookup"><span data-stu-id="d8d13-273">Many open-source libraries are available to help you with this.</span></span>

### <a name="validate-the-claims"></a><span data-ttu-id="d8d13-274">Validación de las notificaciones</span><span class="sxs-lookup"><span data-stu-id="d8d13-274">Validate the claims</span></span>
<span data-ttu-id="d8d13-275">Cuando la aplicación recibe un token de identificador al inicio de sesión del usuario, también debe realizar algunas comprobaciones de las notificaciones del token de identificador.</span><span class="sxs-lookup"><span data-stu-id="d8d13-275">When your app receives an ID token upon user sign-in, it should also perform a few checks against the claims in the ID token.</span></span> <span data-ttu-id="d8d13-276">Estas incluyen, pero no se limitan a:</span><span class="sxs-lookup"><span data-stu-id="d8d13-276">These include but are not limited to:</span></span>

* <span data-ttu-id="d8d13-277">Notificación **audience**, para comprobar que estaba previsto proporcionar el token de identificador a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-277">**audience** claim, to verify that the ID token was intended to be given to your app</span></span>
* <span data-ttu-id="d8d13-278">Notificaciones **not before** y **expiration time**, para comprobar que el token de identificador no expiró.</span><span class="sxs-lookup"><span data-stu-id="d8d13-278">**not before** and **expiration time** claims, to verify that the ID token has not expired</span></span>
* <span data-ttu-id="d8d13-279">Notificación **issuer**, para comprobar que el punto de conexión v2.0 emitió el token a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d8d13-279">**issuer** claim, to verify that the token was issued to your app by the v2.0 endpoint</span></span>
* <span data-ttu-id="d8d13-280">**nonce**, como mitigación de ataques de reproducción de tokens.</span><span class="sxs-lookup"><span data-stu-id="d8d13-280">**nonce**, as a token replay attack mitigation</span></span>

<span data-ttu-id="d8d13-281">Para ver una lista completa de las validaciones de notificaciones que debe realizar la aplicación, consulte la [especificación de OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation).</span><span class="sxs-lookup"><span data-stu-id="d8d13-281">For a full list of claim validations that your app should perform, see the [OpenID Connect specification](http://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation).</span></span>

<span data-ttu-id="d8d13-282">En la sección sobre [tokens de identificador](# ID tokens) se incluyen detalles sobre los valores esperados para estas notificaciones.</span><span class="sxs-lookup"><span data-stu-id="d8d13-282">Details of the expected values for these claims are included in the [ID tokens](# ID tokens) section.</span></span>

## <a name="token-lifetimes"></a><span data-ttu-id="d8d13-283">Vigencia de los tokens</span><span class="sxs-lookup"><span data-stu-id="d8d13-283">Token lifetimes</span></span>
<span data-ttu-id="d8d13-284">Proporcionamos la siguiente vigencia de los tokens solo como información.</span><span class="sxs-lookup"><span data-stu-id="d8d13-284">We provide the following token lifetimes for your information only.</span></span> <span data-ttu-id="d8d13-285">La información puede ayudarle a desarrollar y depurar aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d8d13-285">The information might help you as you develop and debug apps.</span></span> <span data-ttu-id="d8d13-286">Las aplicaciones no se deben escribir esperando que estas vigencias permanezcan constantes.</span><span class="sxs-lookup"><span data-stu-id="d8d13-286">Your apps should not be written to expect any of these lifetimes to remain constant.</span></span> <span data-ttu-id="d8d13-287">La vigencia de los tokens puede cambiar en cualquier momento, y así será.</span><span class="sxs-lookup"><span data-stu-id="d8d13-287">Token lifetimes can and will change at any time.</span></span>

| <span data-ttu-id="d8d13-288">SWT</span><span class="sxs-lookup"><span data-stu-id="d8d13-288">Token</span></span> | <span data-ttu-id="d8d13-289">Vigencia</span><span class="sxs-lookup"><span data-stu-id="d8d13-289">Lifetime</span></span> | <span data-ttu-id="d8d13-290">Descripción</span><span class="sxs-lookup"><span data-stu-id="d8d13-290">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="d8d13-291">Tokens de identificador (cuentas profesionales o educativas)</span><span class="sxs-lookup"><span data-stu-id="d8d13-291">ID tokens (work or school accounts)</span></span> |<span data-ttu-id="d8d13-292">1 hora</span><span class="sxs-lookup"><span data-stu-id="d8d13-292">1 hour</span></span> |<span data-ttu-id="d8d13-293">Habitualmente, los tokens de identificador son válidos durante 1 hora.</span><span class="sxs-lookup"><span data-stu-id="d8d13-293">ID tokens typically are valid for 1 hour.</span></span> <span data-ttu-id="d8d13-294">La aplic. web puede usar esta misma vigencia para mantener su propia sesión con el usuario (recomendado), o bien puede elegir una vigencia de sesión completamente distinta.</span><span class="sxs-lookup"><span data-stu-id="d8d13-294">Your web app can use this same lifetime to maintain its own session with the user (recommended), or you can choose a completely different session lifetime.</span></span> <span data-ttu-id="d8d13-295">Si la aplicación necesita obtener un nuevo token de identificador, debe realizar una nueva solicitud de inicio de sesión en el punto de conexión de autorización v2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-295">If your app needs to get a new ID token, it needs to make a new sign-in request to the v2.0 authorize endpoint.</span></span> <span data-ttu-id="d8d13-296">Si el usuario tiene una sesión de explorador válida con el punto de conexión v2.0, no se le solicitará que vuelva a escribir sus credenciales.</span><span class="sxs-lookup"><span data-stu-id="d8d13-296">If the user has a valid browser session with the v2.0 endpoint, the user might not be required to enter their credentials again.</span></span> |
| <span data-ttu-id="d8d13-297">Tokens de identificador (cuentas personales)</span><span class="sxs-lookup"><span data-stu-id="d8d13-297">ID tokens (personal accounts)</span></span> |<span data-ttu-id="d8d13-298">24 horas</span><span class="sxs-lookup"><span data-stu-id="d8d13-298">24 hours</span></span> |<span data-ttu-id="d8d13-299">Habitualmente, los tokens de identificador para cuentas personales son válidos durante 24 horas.</span><span class="sxs-lookup"><span data-stu-id="d8d13-299">ID tokens for personal accounts typically are valid for 24 hours.</span></span> <span data-ttu-id="d8d13-300">La aplic. web puede usar esta misma vigencia para mantener su propia sesión con el usuario (recomendado), o bien puede elegir una vigencia de sesión completamente distinta.</span><span class="sxs-lookup"><span data-stu-id="d8d13-300">Your web app can use this same lifetime to maintain its own session with the user (recommended), or you can choose a completely different session lifetime.</span></span> <span data-ttu-id="d8d13-301">Si la aplicación necesita obtener un nuevo token de identificador, debe realizar una nueva solicitud de inicio de sesión en el punto de conexión de autorización v2.0.</span><span class="sxs-lookup"><span data-stu-id="d8d13-301">If your app needs to get a new ID token, it needs to make a new sign-in request to the v2.0 authorize endpoint.</span></span> <span data-ttu-id="d8d13-302">Si el usuario tiene una sesión de explorador válida con el punto de conexión v2.0, no se le solicitará que vuelva a escribir sus credenciales.</span><span class="sxs-lookup"><span data-stu-id="d8d13-302">If the user has a valid browser session with the v2.0 endpoint, the user might not be required to enter their credentials again.</span></span> |
| <span data-ttu-id="d8d13-303">Tokens de acceso (cuentas profesionales o educativas)</span><span class="sxs-lookup"><span data-stu-id="d8d13-303">Access tokens (work or school accounts)</span></span> |<span data-ttu-id="d8d13-304">1 hora</span><span class="sxs-lookup"><span data-stu-id="d8d13-304">1 hour</span></span> |<span data-ttu-id="d8d13-305">Se indican en las respuestas de tokens como parte de los metadatos de token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-305">Indicated in token responses as part of the token metadata.</span></span> |
| <span data-ttu-id="d8d13-306">Tokens de acceso (cuentas personales)</span><span class="sxs-lookup"><span data-stu-id="d8d13-306">Access tokens (personal accounts)</span></span> |<span data-ttu-id="d8d13-307">1 hora</span><span class="sxs-lookup"><span data-stu-id="d8d13-307">1 hour</span></span> |<span data-ttu-id="d8d13-308">Se indican en las respuestas de tokens como parte de los metadatos de token.</span><span class="sxs-lookup"><span data-stu-id="d8d13-308">Indicated in token responses as part of the token metadata.</span></span> <span data-ttu-id="d8d13-309">Los tokens de acceso que se emiten en nombre de las cuentas personales se pueden configurar para que tengan una vigencia distinta, pero lo habitual suele ser 1 hora.</span><span class="sxs-lookup"><span data-stu-id="d8d13-309">Access tokens that are issued on behalf of personal accounts can be configured for a different lifetime, but 1 hour is typical.</span></span> |
| <span data-ttu-id="d8d13-310">Tokens de actualización (cuentas profesionales o educativas)</span><span class="sxs-lookup"><span data-stu-id="d8d13-310">Refresh tokens (work or school account)</span></span> |<span data-ttu-id="d8d13-311">Hasta 14 días</span><span class="sxs-lookup"><span data-stu-id="d8d13-311">Up to 14 days</span></span> |<span data-ttu-id="d8d13-312">Un token de actualización solo es válido durante un máximo de 14 días.</span><span class="sxs-lookup"><span data-stu-id="d8d13-312">A single refresh token is valid for a maximum of 14 days.</span></span> <span data-ttu-id="d8d13-313">Sin embargo, el token de actualización puede dejar de ser válido en cualquier momento por varias razones, por lo que la aplicación tiene que continuar probando y usando un token de actualización hasta que se produzca un error o hasta que la aplicación lo sustituya por un nuevo token de actualización.</span><span class="sxs-lookup"><span data-stu-id="d8d13-313">However, the refresh token might become invalid at any time for various reasons, so your app should continue to try to use a refresh token until it fails, or until your app replaces it with a new refresh token.</span></span> <span data-ttu-id="d8d13-314">Un token de actualización también deja de ser válido si han pasado 90 días desde que el usuario escribió sus credenciales.</span><span class="sxs-lookup"><span data-stu-id="d8d13-314">A refresh token also becomes invalid if it has been 90 days since the user has entered their credentials.</span></span> |
| <span data-ttu-id="d8d13-315">Tokens de actualización (cuentas personales)</span><span class="sxs-lookup"><span data-stu-id="d8d13-315">Refresh tokens (personal accounts)</span></span> |<span data-ttu-id="d8d13-316">Hasta 1 año</span><span class="sxs-lookup"><span data-stu-id="d8d13-316">Up to 1 year</span></span> |<span data-ttu-id="d8d13-317">Un token de actualización solo es válido durante un máximo de 1 año.</span><span class="sxs-lookup"><span data-stu-id="d8d13-317">A single refresh token is valid for a maximum of 1 year.</span></span> <span data-ttu-id="d8d13-318">Sin embargo, el token de actualización puede dejar de ser válido en cualquier momento por varias razones, por lo que la aplicación debe continuar probando y usando un token de actualización hasta que se produzca un error.</span><span class="sxs-lookup"><span data-stu-id="d8d13-318">However, the refresh token might become invalid at any time for various reasons, so your app should continue to try to use a refresh token until it fails.</span></span> |
| <span data-ttu-id="d8d13-319">Códigos de autorización (cuentas profesionales o educativas)</span><span class="sxs-lookup"><span data-stu-id="d8d13-319">Authorization codes (work or school accounts)</span></span> |<span data-ttu-id="d8d13-320">10 minutos</span><span class="sxs-lookup"><span data-stu-id="d8d13-320">10 minutes</span></span> |<span data-ttu-id="d8d13-321">Los códigos de autorización son de corta duración a propósito y se deben canjear inmediatamente por tokens de acceso y tokens de actualización cuando se reciban.</span><span class="sxs-lookup"><span data-stu-id="d8d13-321">Authorization codes are purposely short-lived, and should be immediately redeemed for access tokens and refresh tokens when the tokens are received.</span></span> |
| <span data-ttu-id="d8d13-322">Códigos de autorización (cuentas personales)</span><span class="sxs-lookup"><span data-stu-id="d8d13-322">Authorization codes (personal accounts)</span></span> |<span data-ttu-id="d8d13-323">5 minutos</span><span class="sxs-lookup"><span data-stu-id="d8d13-323">5 minutes</span></span> |<span data-ttu-id="d8d13-324">Los códigos de autorización son de corta duración a propósito y se deben canjear inmediatamente por tokens de acceso y tokens de actualización cuando se reciban.</span><span class="sxs-lookup"><span data-stu-id="d8d13-324">Authorization codes are purposely short-lived, and should be immediately redeemed for access tokens and refresh tokens when the tokens are received.</span></span> <span data-ttu-id="d8d13-325">Los códigos de autorización emitidos en nombre de las cuentas personales son de un solo uso.</span><span class="sxs-lookup"><span data-stu-id="d8d13-325">Authorization codes that are issued on behalf of personal accounts are for one-time use.</span></span> |
