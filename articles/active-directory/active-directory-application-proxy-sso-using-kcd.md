---
title: "inicio de sesión en aaaSingle con el Proxy de aplicación | Documentos de Microsoft"
description: "Explica cómo tooprovide inicio de sesión único mediante el Proxy de aplicación de Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="547d4-103">Delegación limitada de Kerberos para las aplicaciones de tooyour de inicio de sesión único con el Proxy de aplicación</span><span class="sxs-lookup"><span data-stu-id="547d4-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="547d4-104">Puede proporcionar un inicio de sesión único para las aplicaciones locales publicadas a través de Proxy de aplicación que se protegen con la autenticación integrada de Windows.</span><span class="sxs-lookup"><span data-stu-id="547d4-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="547d4-105">Estas aplicaciones requieren un vale Kerberos para el acceso.</span><span class="sxs-lookup"><span data-stu-id="547d4-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="547d4-106">Proxy de aplicación utiliza la delegación limitada de Kerberos (KCD) toosupport estas aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="547d4-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="547d4-107">Puede habilitar las aplicaciones de tooyour de inicio de sesión único mediante la autenticación de Windows integrada (IWA) proporcionando el permiso de conectores de Proxy de aplicación en los usuarios de Active Directory tooimpersonate.</span><span class="sxs-lookup"><span data-stu-id="547d4-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="547d4-108">conectores de Hello usar este permiso toosend y reciban tokens en su nombre.</span><span class="sxs-lookup"><span data-stu-id="547d4-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="547d4-109">Cómo funciona el inicio de sesión único con KCD</span><span class="sxs-lookup"><span data-stu-id="547d4-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="547d4-110">Este diagrama explica el flujo de hello cuando un usuario intenta tooaccess una aplicación local que usa IWA.</span><span class="sxs-lookup"><span data-stu-id="547d4-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Diagrama de flujos de autenticación de Microsoft AAD](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="547d4-112">usuario de Hello entra en la aplicación hello URL tooaccess Hola local a través de Proxy de aplicación.</span><span class="sxs-lookup"><span data-stu-id="547d4-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="547d4-113">Proxy de aplicación redirige toopreauthenticate de servicios de autenticación de hello solicitud tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="547d4-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="547d4-114">En este momento, Azure AD aplica cualquier autenticación correspondiente, así como directivas de autorización, como la autenticación multifactor.</span><span class="sxs-lookup"><span data-stu-id="547d4-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="547d4-115">Si se valida el usuario de hello, Azure AD crea un token y lo envía toohello usuario.</span><span class="sxs-lookup"><span data-stu-id="547d4-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="547d4-116">usuario de Hello pasa Hola token tooApplication Proxy.</span><span class="sxs-lookup"><span data-stu-id="547d4-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="547d4-117">Proxy de aplicación valida el token de Hola y recupera Hola nombre Principal de usuario (UPN) del mismo y, a continuación, envía Hola solicitud, Hola UPN y Hola nombre Principal de servicio (SPN) toohello conector a través de un canal seguro con doble autenticación.</span><span class="sxs-lookup"><span data-stu-id="547d4-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="547d4-118">Hola conector realiza la negociación de la delegación limitada de Kerberos (KCD) con hello local AD, suplantando Hola usuario tooget una aplicación de toohello símbolo (token) de Kerberos.</span><span class="sxs-lookup"><span data-stu-id="547d4-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="547d4-119">Active Directory envía el token de Kerberos Hola Hola aplicación toohello conector.</span><span class="sxs-lookup"><span data-stu-id="547d4-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="547d4-120">Hola conector envía Hola solicitud toohello aplicación servidor original, con el token de Kerberos de Hola que recibió de AD.</span><span class="sxs-lookup"><span data-stu-id="547d4-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="547d4-121">aplicación Hello envía Hola respuesta toohello conector, que, a continuación, se devuelve toohello servicio de Proxy de aplicación y, finalmente, el usuario toohello.</span><span class="sxs-lookup"><span data-stu-id="547d4-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="547d4-122">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="547d4-122">Prerequisites</span></span>
<span data-ttu-id="547d4-123">Antes de empezar a trabajar con un inicio de sesión único para aplicaciones IWA, asegúrese de que su entorno está listo con hello siguientes configuraciones:</span><span class="sxs-lookup"><span data-stu-id="547d4-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="547d4-124">Las aplicaciones, como las aplicaciones SharePoint Web, se establecen toouse autenticación integrada de Windows.</span><span class="sxs-lookup"><span data-stu-id="547d4-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="547d4-125">Para más información, consulte [Habilitar la compatibilidad con la autenticación Kerberos](https://technet.microsoft.com/library/dd759186.aspx) o, para SharePoint, consulte [Planear la autenticación Kerberos en SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="547d4-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="547d4-126">Todas las aplicaciones tienen [nombres de entidad de seguridad de servicio](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="547d4-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="547d4-127">Hola Hola de ejecución de servidor Conector y el servidor de hello ejecutando la aplicación hello están unidos a un dominio y parte del programa Hola mismo dominio o en dominios de confianza.</span><span class="sxs-lookup"><span data-stu-id="547d4-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="547d4-128">Para obtener más información sobre la unión a un dominio, consulte [unirse a un dominio de equipo tooa](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="547d4-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="547d4-129">servidor de Hello ejecutando Hola conector tiene tooread de atributo TokenGroupsGlobalAndUniversal acceso Hola para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="547d4-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="547d4-130">Esta configuración predeterminada podría ha visto afectada por el entorno de Hola de refuerzo de la seguridad.</span><span class="sxs-lookup"><span data-stu-id="547d4-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="547d4-131">Configurar Active Directory</span><span class="sxs-lookup"><span data-stu-id="547d4-131">Configure Active Directory</span></span>
<span data-ttu-id="547d4-132">la configuración de Active Directory Hola varía, dependiendo de si el conector del Proxy de aplicación y el servidor de aplicaciones de hello están en Hola el mismo dominio o no.</span><span class="sxs-lookup"><span data-stu-id="547d4-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="547d4-133">Conector y el servidor de aplicaciones de hello mismo dominio</span><span class="sxs-lookup"><span data-stu-id="547d4-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="547d4-134">En Active Directory, vaya demasiado**herramientas** > **usuarios y equipos de**.</span><span class="sxs-lookup"><span data-stu-id="547d4-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="547d4-135">Seleccione servidor hello ejecuta el conector de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="547d4-136">Haga clic en el botón derecho y seleccione **Propiedades** > **Delegación**.</span><span class="sxs-lookup"><span data-stu-id="547d4-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="547d4-137">Seleccione **confiar en este equipo para servicios solo de delegación toospecified**.</span><span class="sxs-lookup"><span data-stu-id="547d4-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="547d4-138">En **toowhich servicios esta cuenta puede presentar credenciales delegadas** agregar valor Hola para hello identidad SPN Hola del servidor de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="547d4-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="547d4-139">Esto permite a los usuarios tooimpersonate de conector del Proxy de aplicación hello en AD frente a aplicaciones de hello definidas en la lista de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Captura de pantalla de ventana Conector-Propiedades SVR](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="547d4-141">Conector y servidor de aplicaciones en dominios diferentes</span><span class="sxs-lookup"><span data-stu-id="547d4-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="547d4-142">Para obtener una lista de requisitos previos para trabajar con KCD entre dominios, vea [Delegación limitada Kerberos entre dominios](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="547d4-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="547d4-143">Hola de uso `principalsallowedtodelegateto` propiedad toodelegate Hola conector server tooenable Hola Proxy de aplicación para el servidor de conector de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="547d4-144">servidor de aplicaciones de Hello es `sharepointserviceaccount` y hello delegación de servidor es `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="547d4-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="547d4-145">Para Windows 2012 R2, use este código como un ejemplo:</span><span class="sxs-lookup"><span data-stu-id="547d4-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="547d4-146">Sharepointserviceaccount puede ser la cuenta de equipo SPS de Hola o una cuenta de servicio bajo qué Hola SPS se ejecuta el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="547d4-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="547d4-147">Configurar inicio de sesión único</span><span class="sxs-lookup"><span data-stu-id="547d4-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="547d4-148">Publicar su aplicación según las instrucciones de toohello descritas en [publicar aplicaciones con Proxy de aplicación](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="547d4-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="547d4-149">Asegúrese de que tooselect **Azure Active Directory** como hello **método de autenticación previa**.</span><span class="sxs-lookup"><span data-stu-id="547d4-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="547d4-150">Después de la aplicación aparece en la lista de Hola de aplicaciones empresariales, selecciónelo y haga clic en **inicio de sesión único**.</span><span class="sxs-lookup"><span data-stu-id="547d4-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="547d4-151">Establecer el modo de inicio de sesión único de hello demasiado**autenticación integrada de Windows**.</span><span class="sxs-lookup"><span data-stu-id="547d4-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="547d4-152">Escriba hello **SPN interno de la aplicación** Hola servidor de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="547d4-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="547d4-153">En este ejemplo, hello SPN de nuestra aplicación publicada es http/www.contoso.com. Esta toobe de necesidades SPN en lista de hello del conector de servicios toowhich Hola puede presentar credenciales delegadas.</span><span class="sxs-lookup"><span data-stu-id="547d4-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="547d4-154">Elija hello **delegar la identidad de inicio de sesión** para toouse de conector de hello en nombre de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="547d4-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="547d4-155">Para más información, vea [Trabajar con identidades en la nube y locales diferentes](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="547d4-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Configuración avanzada de aplicaciones](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="547d4-157">SSO para las aplicaciones no son de Windows</span><span class="sxs-lookup"><span data-stu-id="547d4-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="547d4-158">Hola flujo de la delegación de Kerberos en el Proxy de aplicación de Azure AD se inicia cuando Azure AD autentica el usuario de hello en la nube de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="547d4-159">Una vez que llega de solicitud de hello en local, Hola Proxy de aplicación de Azure AD conector emite un vale de Kerberos en nombre de usuario de hello interactuando con Hola Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="547d4-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="547d4-160">Este proceso es que se hace referencia tooas delegación limitada de Kerberos (KCD).</span><span class="sxs-lookup"><span data-stu-id="547d4-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="547d4-161">Hola fase siguiente, se envía una solicitud toohello aplicación de back-end con este vale de Kerberos.</span><span class="sxs-lookup"><span data-stu-id="547d4-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="547d4-162">Hay varios protocolos que definen cómo toosend tales solicitudes.</span><span class="sxs-lookup"><span data-stu-id="547d4-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="547d4-163">La mayoría de los servidores que no son Windows esperan Negotiate/SPNego, que ahora se admite en el proxy de aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="547d4-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="547d4-164">Para obtener más información acerca de Kerberos, consulte [todo lo que desea tooknow sobre la delegación limitada de Kerberos (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="547d4-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="547d4-165">Las aplicaciones que no son de Windows normalmente usan nombres de usuario o nombres de cuenta SAM en lugar de direcciones de correo electrónico de dominio.</span><span class="sxs-lookup"><span data-stu-id="547d4-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="547d4-166">Si esa situación aplica a las aplicaciones de tooyour, deberá tooconfigure Hola delegada inicio de sesión identidad campo tooconnect las identidades de aplicaciones de nube identidades tooyour.</span><span class="sxs-lookup"><span data-stu-id="547d4-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="547d4-167">Trabajar con diferentes identidades locales y de nube</span><span class="sxs-lookup"><span data-stu-id="547d4-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="547d4-168">Proxy de aplicación se da por supuesto que los usuarios tengan exactamente Hola la misma identidad en la nube de Hola y local.</span><span class="sxs-lookup"><span data-stu-id="547d4-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="547d4-169">Si no es el caso de hello, puede seguir sirve KCD para inicio de sesión único.</span><span class="sxs-lookup"><span data-stu-id="547d4-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="547d4-170">Configurar un **delegar la identidad de inicio de sesión** para cada toospecify aplicación qué identidad debe usarse al realizar el inicio de sesión único.</span><span class="sxs-lookup"><span data-stu-id="547d4-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="547d4-171">Esta funcionalidad permite muchas organizaciones que tienen diferentes en el local y en la nube identidades toohave SSO de hello en la nube local tooon aplicaciones sin necesidad de hello usuarios tooenter diferentes nombres de usuario y contraseñas.</span><span class="sxs-lookup"><span data-stu-id="547d4-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="547d4-172">Esto incluye las organizaciones que:</span><span class="sxs-lookup"><span data-stu-id="547d4-172">This includes organizations that:</span></span>

* <span data-ttu-id="547d4-173">Tiene varios dominios internamente (joe@us.contoso.com, joe@eu.contoso.com) y un dominio individual en la nube de hello (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="547d4-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="547d4-174">Tiene el nombre de dominio no enrutables internamente (joe@contoso.usa) y otra en la nube de hello legal.</span><span class="sxs-lookup"><span data-stu-id="547d4-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="547d4-175">No utilizan nombres de dominio internamente (joe)</span><span class="sxs-lookup"><span data-stu-id="547d4-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="547d4-176">Usar distintos alias local y en la nube de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="547d4-177">Por ejemplo, joe-johns@contoso.com en comparación con joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="547d4-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="547d4-178">Con el Proxy de aplicación, puede seleccionar qué Hola de tooobtain toouse de identidad vale de Kerberos.</span><span class="sxs-lookup"><span data-stu-id="547d4-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="547d4-179">Esta configuración es por aplicación.</span><span class="sxs-lookup"><span data-stu-id="547d4-179">This setting is per application.</span></span> <span data-ttu-id="547d4-180">Algunas de estas opciones son adecuadas para los sistemas que no aceptan el formato de dirección de correo electrónico, otras están pensadas para el inicio de sesión alternativo.</span><span class="sxs-lookup"><span data-stu-id="547d4-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Captura de pantalla de parámetro de identidad de inicio de sesión delegado](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="547d4-182">Si se utiliza la identidad de inicio de sesión delegados, el valor de hello podría no ser único en todos los dominios de Hola o bosques de su organización.</span><span class="sxs-lookup"><span data-stu-id="547d4-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="547d4-183">Puede evitar este problema al publicar estas aplicaciones dos veces con dos grupos diferentes de conector.</span><span class="sxs-lookup"><span data-stu-id="547d4-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="547d4-184">Puesto que cada aplicación tiene una audiencia de usuarios diferentes, puede combinar su dominio diferente de tooa de conectores.</span><span class="sxs-lookup"><span data-stu-id="547d4-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="547d4-185">Configurar el inicio de sesión único para distintas identidades</span><span class="sxs-lookup"><span data-stu-id="547d4-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="547d4-186">Configurar Azure AD Connect para que identidad principal hello es la dirección de correo electrónico (correo electrónico) de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="547d4-187">Esto se realiza como parte del programa Hola a personalizar el proceso, cambiando hello **nombre Principal de usuario** campo en la configuración de sincronización Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="547d4-188">Estas opciones también determinan cómo los usuarios iniciar sesión en tooOffice365, Windows10 dispositivos y otras aplicaciones que usan Azure AD como su almacén de identidades.</span><span class="sxs-lookup"><span data-stu-id="547d4-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="547d4-189">![Captura de pantalla de la identificación de usuarios - lista desplegable de Nombre principal de usuario](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="547d4-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="547d4-190">En Opciones de configuración de aplicación de hello para la aplicación hello le gustaría toomodify, seleccione hello **delegar la identidad de inicio de sesión** toobe utiliza:</span><span class="sxs-lookup"><span data-stu-id="547d4-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="547d4-191">Nombre principal de usuario (por ejemplo, joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="547d4-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="547d4-192">Nombre principal de usuario alternativo (por ejemplo, joed@contoso.local).</span><span class="sxs-lookup"><span data-stu-id="547d4-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="547d4-193">Parte nombre de usuario del nombre principal de usuario (por ejemplo, joe).</span><span class="sxs-lookup"><span data-stu-id="547d4-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="547d4-194">Parte nombre de usuario del nombre principal de usuario alternativo (por ejemplo, joed).</span><span class="sxs-lookup"><span data-stu-id="547d4-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="547d4-195">Nombre de cuenta SAM local (depende de la configuración del controlador de dominio de hello)</span><span class="sxs-lookup"><span data-stu-id="547d4-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="547d4-196">Solución de problemas de SSO para diferentes identidades</span><span class="sxs-lookup"><span data-stu-id="547d4-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="547d4-197">Si hay un error en el proceso SSO de hello, aparece en el registro de eventos de máquina de conector de hello como se explica en [solución de problemas](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="547d4-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="547d4-198">Sin embargo, en algunos casos, solicitud de Hola se envía correctamente toohello back-end aplicación mientras esta aplicación responde en diversas otras respuestas HTTP.</span><span class="sxs-lookup"><span data-stu-id="547d4-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="547d4-199">Solución de problemas de estos casos debe empezar examinando el número de evento 24029 en la máquina de conector de hello en el registro de eventos de sesión de Proxy de aplicación Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="547d4-200">identidad de usuario de Hola que se usó para la delegación aparece en campos de "usuario" hello en detalles del evento Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="547d4-201">Seleccione tooturn en el registro de sesión, **mostrar analíticos y de depuración registros** en el menú de vista del Visor de eventos de Hola.</span><span class="sxs-lookup"><span data-stu-id="547d4-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="547d4-202">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="547d4-202">Next steps</span></span>

* [<span data-ttu-id="547d4-203">¿Cómo tooconfigure una toouse de aplicación de Proxy de aplicación delegación limitada de Kerberos</span><span class="sxs-lookup"><span data-stu-id="547d4-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="547d4-204">Solucionar los problemas que tiene con el Proxy de aplicación</span><span class="sxs-lookup"><span data-stu-id="547d4-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="547d4-205">Para obtener las actualizaciones y noticias más recientes de hello, visite hello [blog de Proxy de aplicación](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="547d4-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

