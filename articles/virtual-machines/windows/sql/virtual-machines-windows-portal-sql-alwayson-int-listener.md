---
title: "aaaCreate un agente de escucha de grupo de disponibilidad de SQL Server en máquinas virtuales de Azure | Documentos de Microsoft"
description: Instrucciones paso a paso para crear un agente de escucha en un grupo de disponibilidad AlwaysOn para SQL Server en Azure Virtual Machines
services: virtual-machines
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: monicar
ms.assetid: d1f291e9-9af2-41ba-9d29-9541e3adcfcf
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/01/2017
ms.author: mikeray
ms.openlocfilehash: c6a44dc5c7c18b572c2bf5772b4651b7210aacbd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="configure-a-load-balancer-for-an-always-on-availability-group-in-azure"></a><span data-ttu-id="9253e-103">Configuración de un equilibrador de carga para un grupo de disponibilidad AlwaysOn en Azure</span><span class="sxs-lookup"><span data-stu-id="9253e-103">Configure a load balancer for an Always On availability group in Azure</span></span>
<span data-ttu-id="9253e-104">Este artículo explica cómo un equilibrador de carga para un grupo de disponibilidad AlwaysOn de SQL Server en Azure virtual toocreate máquinas que se ejecutan con el Administrador de recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="9253e-104">This article explains how toocreate a load balancer for a SQL Server Always On availability group in Azure virtual machines that are running with Azure Resource Manager.</span></span> <span data-ttu-id="9253e-105">Un grupo de disponibilidad requiere un equilibrador de carga cuando hay instancias de SQL Server de hello en máquinas virtuales de Azure.</span><span class="sxs-lookup"><span data-stu-id="9253e-105">An availability group requires a load balancer when hello SQL Server instances are on Azure virtual machines.</span></span> <span data-ttu-id="9253e-106">equilibrador de carga de Hello almacena la dirección IP de hello para el agente de escucha del grupo de disponibilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-106">hello load balancer stores hello IP address for hello availability group listener.</span></span> <span data-ttu-id="9253e-107">Si un grupo de disponibilidad abarca varias regiones, cada región necesitará su propio equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="9253e-107">If an availability group spans multiple regions, each region needs a load balancer.</span></span>

<span data-ttu-id="9253e-108">toocomplete esta tarea, deberá toohave un grupo de disponibilidad de SQL Server implementado en máquinas virtuales de Azure que se ejecutan con el Administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="9253e-108">toocomplete this task, you need toohave a SQL Server availability group deployed on Azure virtual machines that are running with Resource Manager.</span></span> <span data-ttu-id="9253e-109">Las máquinas virtuales de SQL Server debe pertenecer toohello mismo conjunto de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9253e-109">Both SQL Server virtual machines must belong toohello same availability set.</span></span> <span data-ttu-id="9253e-110">Puede usar hello [plantilla Microsoft](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically crear grupo de disponibilidad de hello en el Administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="9253e-110">You can use hello [Microsoft template](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically create hello availability group in Resource Manager.</span></span> <span data-ttu-id="9253e-111">Esta plantilla crea automáticamente un equilibrador de carga interno.</span><span class="sxs-lookup"><span data-stu-id="9253e-111">This template automatically creates an internal load balancer for you.</span></span> 

<span data-ttu-id="9253e-112">Si lo prefiere, puede [configurar manualmente un grupo de disponibilidad](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span><span class="sxs-lookup"><span data-stu-id="9253e-112">If you prefer, you can [manually configure an availability group](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span></span>

<span data-ttu-id="9253e-113">En este artículo, es necesario que los grupos de disponibilidad ya estén configurados.</span><span class="sxs-lookup"><span data-stu-id="9253e-113">This article requires that your availability groups are already configured.</span></span>  

<span data-ttu-id="9253e-114">Temas relacionados:</span><span class="sxs-lookup"><span data-stu-id="9253e-114">Related topics include:</span></span>

* [<span data-ttu-id="9253e-115">Configuración de Grupos de disponibilidad AlwaysOn en la máquina virtual de Azure (GUI)</span><span class="sxs-lookup"><span data-stu-id="9253e-115">Configure Always On availability groups in Azure VM (GUI)</span></span>](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md)   
* [<span data-ttu-id="9253e-116">Configuración de una conexión entre dos redes virtuales mediante Azure Resource Manager y PowerShell</span><span class="sxs-lookup"><span data-stu-id="9253e-116">Configure a VNet-to-VNet connection by using Azure Resource Manager and PowerShell</span></span>](../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md)

<span data-ttu-id="9253e-117">A la vez a través de este artículo, cree y configure un equilibrador de carga en hello portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="9253e-117">By walking through this article, you create and configure a load balancer in hello Azure portal.</span></span> <span data-ttu-id="9253e-118">Una vez completado el proceso de hello, configure hello toouse Hola dirección IP del equilibrador de carga de hello para el agente de escucha del grupo de disponibilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-118">After hello process is complete, you configure hello cluster toouse hello IP address from hello load balancer for hello availability group listener.</span></span>

## <a name="create-and-configure-hello-load-balancer-in-hello-azure-portal"></a><span data-ttu-id="9253e-119">Cree y configure el equilibrador de carga de Hola Hola portal de Azure</span><span class="sxs-lookup"><span data-stu-id="9253e-119">Create and configure hello load balancer in hello Azure portal</span></span>
<span data-ttu-id="9253e-120">En esta parte de la tarea hello, Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="9253e-120">In this portion of hello task, do hello following:</span></span>

1. <span data-ttu-id="9253e-121">Hola portal de Azure, crear equilibrador de carga de Hola y configurar la dirección IP de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-121">In hello Azure portal, create hello load balancer and configure hello IP address.</span></span>
2. <span data-ttu-id="9253e-122">Configurar grupo de back-end de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-122">Configure hello back-end pool.</span></span>
3. <span data-ttu-id="9253e-123">Crear el sondeo de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-123">Create hello probe.</span></span> 
4. <span data-ttu-id="9253e-124">Establecer reglas de equilibrio de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-124">Set hello load balancing rules.</span></span>

> [!NOTE]
> <span data-ttu-id="9253e-125">Si son instancias de SQL Server de hello en varios grupos de recursos y regiones, realizar cada paso dos veces, una vez en cada grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="9253e-125">If hello SQL Server instances are in multiple resource groups and regions, perform each step twice, once in each resource group.</span></span>
> 
> 

### <a name="step-1-create-hello-load-balancer-and-configure-hello-ip-address"></a><span data-ttu-id="9253e-126">Paso 1: Crear el equilibrador de carga de Hola y configurar la dirección IP de Hola</span><span class="sxs-lookup"><span data-stu-id="9253e-126">Step 1: Create hello load balancer and configure hello IP address</span></span>
<span data-ttu-id="9253e-127">En primer lugar, cree el equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-127">First, create hello load balancer.</span></span> 

1. <span data-ttu-id="9253e-128">Hola portal de Azure, abra el grupo de recursos de Hola que contiene máquinas virtuales de SQL Server de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-128">In hello Azure portal, open hello resource group that contains hello SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="9253e-129">En el grupo de recursos de hello, haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-129">In hello resource group, click **Add**.</span></span>

3. <span data-ttu-id="9253e-130">Busque **equilibrador de carga** y, a continuación, en resultados de búsqueda de hello, seleccione **equilibrador de carga**, que se publica mediante **Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="9253e-130">Search for **load balancer** and then, in hello search results, select **Load Balancer**, which is published by **Microsoft**.</span></span>

4. <span data-ttu-id="9253e-131">En hello **equilibrador de carga** hoja, haga clic en **crear**.</span><span class="sxs-lookup"><span data-stu-id="9253e-131">On hello **Load Balancer** blade, click **Create**.</span></span>

5. <span data-ttu-id="9253e-132">Hola **equilibrador de carga de crear** diálogo cuadro, configure el equilibrador de carga de hello como sigue:</span><span class="sxs-lookup"><span data-stu-id="9253e-132">In hello **Create load balancer** dialog box, configure hello load balancer as follows:</span></span>

   | <span data-ttu-id="9253e-133">Configuración</span><span class="sxs-lookup"><span data-stu-id="9253e-133">Setting</span></span> | <span data-ttu-id="9253e-134">Valor</span><span class="sxs-lookup"><span data-stu-id="9253e-134">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="9253e-135">**Name**</span><span class="sxs-lookup"><span data-stu-id="9253e-135">**Name**</span></span> |<span data-ttu-id="9253e-136">Un nombre de texto que representa el equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-136">A text name representing hello load balancer.</span></span> <span data-ttu-id="9253e-137">Por ejemplo, **sqlLB**.</span><span class="sxs-lookup"><span data-stu-id="9253e-137">For example, **sqlLB**.</span></span> |
   | <span data-ttu-id="9253e-138">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="9253e-138">**Type**</span></span> |<span data-ttu-id="9253e-139">**Interno**: mayoría de implementaciones de usa un equilibrador de carga interno, que permite a las aplicaciones dentro de hello mismo grupo de disponibilidad de red virtual tooconnect toohello.</span><span class="sxs-lookup"><span data-stu-id="9253e-139">**Internal**: Most implementations use an internal load balancer, which allows applications within hello same virtual network tooconnect toohello availability group.</span></span>  </br> <span data-ttu-id="9253e-140">**Externo**: permite el grupo de disponibilidad de aplicaciones tooconnect toohello a través de una conexión a Internet pública.</span><span class="sxs-lookup"><span data-stu-id="9253e-140">**External**: Allows applications tooconnect toohello availability group through a public Internet connection.</span></span> |
   | <span data-ttu-id="9253e-141">**Red virtual**</span><span class="sxs-lookup"><span data-stu-id="9253e-141">**Virtual network**</span></span> |<span data-ttu-id="9253e-142">Seleccione Hola red virtual que Hola aceptadas de SQL Server se encuentran en.</span><span class="sxs-lookup"><span data-stu-id="9253e-142">Select hello virtual network that hello SQL Server intances are in.</span></span> |
   | <span data-ttu-id="9253e-143">**Subred**</span><span class="sxs-lookup"><span data-stu-id="9253e-143">**Subnet**</span></span> |<span data-ttu-id="9253e-144">Seleccione subred Hola que son instancias de SQL Server de hello en.</span><span class="sxs-lookup"><span data-stu-id="9253e-144">Select hello subnet that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="9253e-145">**Asignación de dirección IP**</span><span class="sxs-lookup"><span data-stu-id="9253e-145">**IP address assignment**</span></span> |<span data-ttu-id="9253e-146">**Estática**</span><span class="sxs-lookup"><span data-stu-id="9253e-146">**Static**</span></span> |
   | <span data-ttu-id="9253e-147">**Dirección IP privada**</span><span class="sxs-lookup"><span data-stu-id="9253e-147">**Private IP address**</span></span> |<span data-ttu-id="9253e-148">Especifique una dirección IP disponible de la subred de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-148">Specify an available IP address from hello subnet.</span></span> <span data-ttu-id="9253e-149">Use esta dirección IP cuando se crea un agente de escucha en el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-149">Use this IP address when you create a listener on hello cluster.</span></span> <span data-ttu-id="9253e-150">En un script de PowerShell, más adelante en este artículo, use esta dirección para hello `$ILBIP` variable.</span><span class="sxs-lookup"><span data-stu-id="9253e-150">In a PowerShell script, later in this article, use this address for hello `$ILBIP` variable.</span></span> |
   | <span data-ttu-id="9253e-151">**Suscripción**</span><span class="sxs-lookup"><span data-stu-id="9253e-151">**Subscription**</span></span> |<span data-ttu-id="9253e-152">Si tiene varias suscripciones, puede aparecer este campo.</span><span class="sxs-lookup"><span data-stu-id="9253e-152">If you have multiple subscriptions, this field might appear.</span></span> <span data-ttu-id="9253e-153">Seleccione la suscripción de Hola que desea tooassociate con este recurso.</span><span class="sxs-lookup"><span data-stu-id="9253e-153">Select hello subscription that you want tooassociate with this resource.</span></span> <span data-ttu-id="9253e-154">Normalmente se Hola a misma suscripción como todos los recursos de Hola Hola grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9253e-154">It is normally hello same subscription as all hello resources for hello availability group.</span></span> |
   | <span data-ttu-id="9253e-155">**Grupos de recursos**</span><span class="sxs-lookup"><span data-stu-id="9253e-155">**Resource group**</span></span> |<span data-ttu-id="9253e-156">Seleccione el grupo de recursos de Hola que son instancias de SQL Server de hello en.</span><span class="sxs-lookup"><span data-stu-id="9253e-156">Select hello resource group that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="9253e-157">**Ubicación**</span><span class="sxs-lookup"><span data-stu-id="9253e-157">**Location**</span></span> |<span data-ttu-id="9253e-158">Seleccione hello ubicación de Azure que son instancias de SQL Server de hello en.</span><span class="sxs-lookup"><span data-stu-id="9253e-158">Select hello Azure location that hello SQL Server instances are in.</span></span> |

6. <span data-ttu-id="9253e-159">Haga clic en **Crear**.</span><span class="sxs-lookup"><span data-stu-id="9253e-159">Click **Create**.</span></span> 

<span data-ttu-id="9253e-160">Azure crea equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-160">Azure creates hello load balancer.</span></span> <span data-ttu-id="9253e-161">equilibrador de carga de Hello pertenece tooa de red específicas, subred, grupo de recursos y ubicación.</span><span class="sxs-lookup"><span data-stu-id="9253e-161">hello load balancer belongs tooa specific network, subnet, resource group, and location.</span></span> <span data-ttu-id="9253e-162">Una vez Azure complete la tarea de hello, compruebe la configuración de equilibrador de carga de hello en Azure.</span><span class="sxs-lookup"><span data-stu-id="9253e-162">After Azure completes hello task, verify hello load balancer settings in Azure.</span></span> 

### <a name="step-2-configure-hello-back-end-pool"></a><span data-ttu-id="9253e-163">Paso 2: Configurar grupo de back-end de Hola</span><span class="sxs-lookup"><span data-stu-id="9253e-163">Step 2: Configure hello back-end pool</span></span>
<span data-ttu-id="9253e-164">Llamadas Azure Hola grupo de direcciones de back-end *grupo back-end*.</span><span class="sxs-lookup"><span data-stu-id="9253e-164">Azure calls hello back-end address pool *backend pool*.</span></span> <span data-ttu-id="9253e-165">En este caso, el grupo de back-end de hello es direcciones Hola Hola dos instancias de SQL Server en el grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="9253e-165">In this case, hello back-end pool is hello addresses of hello two SQL Server instances in your availability group.</span></span> 

1. <span data-ttu-id="9253e-166">En el grupo de recursos, haga clic en el equilibrador de carga de Hola que ha creado.</span><span class="sxs-lookup"><span data-stu-id="9253e-166">In your resource group, click hello load balancer that you created.</span></span> 

2. <span data-ttu-id="9253e-167">En **Configuración**, haga clic en **Grupos de back-end**.</span><span class="sxs-lookup"><span data-stu-id="9253e-167">On **Settings**, click **Backend pools**.</span></span>

3. <span data-ttu-id="9253e-168">En **grupos back-end**, haga clic en **agregar** toocreate un grupo de direcciones de back-end.</span><span class="sxs-lookup"><span data-stu-id="9253e-168">On **Backend pools**, click **Add** toocreate a back-end address pool.</span></span> 

4. <span data-ttu-id="9253e-169">En **Agregar grupo back-end**, en **nombre**, escriba un nombre para el grupo de back-end de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-169">On **Add backend pool**, under **Name**, type a name for hello back-end pool.</span></span>

5. <span data-ttu-id="9253e-170">En **Máquinas virtuales**, haga clic en **+ Agregar una máquina virtual**.</span><span class="sxs-lookup"><span data-stu-id="9253e-170">Under **Virtual machines**, click **Add a virtual machine**.</span></span> 

6. <span data-ttu-id="9253e-171">En **elegir máquinas virtuales**, haga clic en **elegir un conjunto de disponibilidad**y, a continuación, especifique el conjunto de disponibilidad de Hola que máquinas virtuales de SQL Server de hello pertenecen a.</span><span class="sxs-lookup"><span data-stu-id="9253e-171">Under **Choose virtual machines**, click **Choose an availability set**, and then specify hello availability set that hello SQL Server virtual machines belong to.</span></span>

7. <span data-ttu-id="9253e-172">Una vez que haya elegido el conjunto de disponibilidad de hello, haga clic en **elegir máquinas virtuales de hello**, seleccione Hola dos máquinas virtuales que hospedan instancias de SQL Server de hello en grupo de disponibilidad de hello y, a continuación, haga clic en **seleccione**.</span><span class="sxs-lookup"><span data-stu-id="9253e-172">After you have chosen hello availability set, click **Choose hello virtual machines**, select hello two virtual machines that host hello SQL Server instances in hello availability group, and then click **Select**.</span></span> 

8. <span data-ttu-id="9253e-173">Haga clic en **Aceptar** tooclose hojas de Hola para **elegir máquinas virtuales**, y **Agregar grupo back-end**.</span><span class="sxs-lookup"><span data-stu-id="9253e-173">Click **OK** tooclose hello blades for **Choose virtual machines**, and **Add backend pool**.</span></span> 

<span data-ttu-id="9253e-174">Azure actualiza la configuración de hello para el grupo de direcciones de back-end de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-174">Azure updates hello settings for hello back-end address pool.</span></span> <span data-ttu-id="9253e-175">Ahora, el conjunto de disponibilidad tiene un grupo de dos instancias de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9253e-175">Now your availability set has a pool of two SQL Server instances.</span></span>

### <a name="step-3-create-a-probe"></a><span data-ttu-id="9253e-176">Paso 3: Elaboración de un sondeo</span><span class="sxs-lookup"><span data-stu-id="9253e-176">Step 3: Create a probe</span></span>
<span data-ttu-id="9253e-177">sondeo de Hello define cómo Azure comprueba que Hola instancias de SQL Server posee actualmente el agente de escucha del grupo de disponibilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-177">hello probe defines how Azure verifies which of hello SQL Server instances currently owns hello availability group listener.</span></span> <span data-ttu-id="9253e-178">Servicio de hello en función de la dirección IP de hello en un puerto que define al crear el sondeo de hello las comprobaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="9253e-178">Azure probes hello service based on hello IP address on a port that you define when you create hello probe.</span></span>

1. <span data-ttu-id="9253e-179">Equilibrador de carga en hello **configuración** hoja, haga clic en **sondeos de estado**.</span><span class="sxs-lookup"><span data-stu-id="9253e-179">On hello load balancer **Settings** blade, click **Health probes**.</span></span> 

2. <span data-ttu-id="9253e-180">En hello **sondeos de estado** hoja, haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-180">On hello **Health probes** blade, click **Add**.</span></span>

3. <span data-ttu-id="9253e-181">Configurar el sondeo de hello en hello **agregar sondeo** hoja.</span><span class="sxs-lookup"><span data-stu-id="9253e-181">Configure hello probe on hello **Add probe** blade.</span></span> <span data-ttu-id="9253e-182">Hola de uso después de sondeo de hello tooconfigure de valores:</span><span class="sxs-lookup"><span data-stu-id="9253e-182">Use hello following values tooconfigure hello probe:</span></span>

   | <span data-ttu-id="9253e-183">Configuración</span><span class="sxs-lookup"><span data-stu-id="9253e-183">Setting</span></span> | <span data-ttu-id="9253e-184">Valor</span><span class="sxs-lookup"><span data-stu-id="9253e-184">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="9253e-185">**Name**</span><span class="sxs-lookup"><span data-stu-id="9253e-185">**Name**</span></span> |<span data-ttu-id="9253e-186">Un nombre de texto que representa el sondeo de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-186">A text name representing hello probe.</span></span> <span data-ttu-id="9253e-187">Por ejemplo, **SQLAlwaysOnEndPointProbe**.</span><span class="sxs-lookup"><span data-stu-id="9253e-187">For example, **SQLAlwaysOnEndPointProbe**.</span></span> |
   | <span data-ttu-id="9253e-188">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="9253e-188">**Protocol**</span></span> |<span data-ttu-id="9253e-189">**TCP**</span><span class="sxs-lookup"><span data-stu-id="9253e-189">**TCP**</span></span> |
   | <span data-ttu-id="9253e-190">**Puerto**</span><span class="sxs-lookup"><span data-stu-id="9253e-190">**Port**</span></span> |<span data-ttu-id="9253e-191">Puede usar cualquier puerto que esté disponible.</span><span class="sxs-lookup"><span data-stu-id="9253e-191">You can use any available port.</span></span> <span data-ttu-id="9253e-192">Por ejemplo, *59999*.</span><span class="sxs-lookup"><span data-stu-id="9253e-192">For example, *59999*.</span></span> |
   | <span data-ttu-id="9253e-193">**Intervalo**</span><span class="sxs-lookup"><span data-stu-id="9253e-193">**Interval**</span></span> |<span data-ttu-id="9253e-194">*5*</span><span class="sxs-lookup"><span data-stu-id="9253e-194">*5*</span></span> |
   | <span data-ttu-id="9253e-195">**Umbral incorrecto**</span><span class="sxs-lookup"><span data-stu-id="9253e-195">**Unhealthy threshold**</span></span> |<span data-ttu-id="9253e-196">*2*</span><span class="sxs-lookup"><span data-stu-id="9253e-196">*2*</span></span> |

4.  <span data-ttu-id="9253e-197">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-197">Click **OK**.</span></span> 

> [!NOTE]
> <span data-ttu-id="9253e-198">Asegúrese de que especifica el puerto de hello está abierto en firewall de Hola de las dos instancias de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9253e-198">Make sure that hello port you specify is open on hello firewall of both SQL Server instances.</span></span> <span data-ttu-id="9253e-199">Ambas instancias requieren una regla de entrada para el puerto TCP que usa hello.</span><span class="sxs-lookup"><span data-stu-id="9253e-199">Both instances require an inbound rule for hello TCP port that you use.</span></span> <span data-ttu-id="9253e-200">Consulte [Agregar o editar regla de firewall](http://technet.microsoft.com/library/cc753558.aspx) para más información.</span><span class="sxs-lookup"><span data-stu-id="9253e-200">For more information, see [Add or Edit Firewall Rule](http://technet.microsoft.com/library/cc753558.aspx).</span></span> 
> 
> 

<span data-ttu-id="9253e-201">Azure crea Hola sondeo y, a continuación, usa tootest qué instancia de SQL Server tiene el agente de escucha de hello para el grupo de disponibilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-201">Azure creates hello probe and then uses it tootest which SQL Server instance has hello listener for hello availability group.</span></span>

### <a name="step-4-set-hello-load-balancing-rules"></a><span data-ttu-id="9253e-202">Paso 4: Configurar reglas de equilibrio de carga de Hola</span><span class="sxs-lookup"><span data-stu-id="9253e-202">Step 4: Set hello load balancing rules</span></span>
<span data-ttu-id="9253e-203">reglas de equilibrio de carga de Hello configurar cómo equilibrador de carga de hello enruta instancias de SQL Server toohello de tráfico.</span><span class="sxs-lookup"><span data-stu-id="9253e-203">hello load balancing rules configure how hello load balancer routes traffic toohello SQL Server instances.</span></span> <span data-ttu-id="9253e-204">Para este equilibrador de carga, habilitar a direct server devuelto porque solo uno de dos instancias de SQL Server Hola pertenece recurso de agente de escucha de grupo de disponibilidad de Hola a la vez.</span><span class="sxs-lookup"><span data-stu-id="9253e-204">For this load balancer, you enable direct server return because only one of hello two SQL Server instances owns hello availability group listener resource at a time.</span></span>

1. <span data-ttu-id="9253e-205">Equilibrador de carga en hello **configuración** hoja, haga clic en **reglas de equilibrio de carga**.</span><span class="sxs-lookup"><span data-stu-id="9253e-205">On hello load balancer **Settings** blade, click **Load balancing rules**.</span></span> 

2. <span data-ttu-id="9253e-206">En hello **reglas de equilibrio de carga** hoja, haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-206">On hello **Load balancing rules** blade, click **Add**.</span></span>

3. <span data-ttu-id="9253e-207">En hello **reglas de equilibrio de carga de agregar** hoja, configurar la regla de equilibrio de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-207">On hello **Add load balancing rules** blade, configure hello load balancing rule.</span></span> <span data-ttu-id="9253e-208">Usar hello después de configuración:</span><span class="sxs-lookup"><span data-stu-id="9253e-208">Use hello following settings:</span></span> 

   | <span data-ttu-id="9253e-209">Configuración</span><span class="sxs-lookup"><span data-stu-id="9253e-209">Setting</span></span> | <span data-ttu-id="9253e-210">Valor</span><span class="sxs-lookup"><span data-stu-id="9253e-210">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="9253e-211">**Name**</span><span class="sxs-lookup"><span data-stu-id="9253e-211">**Name**</span></span> |<span data-ttu-id="9253e-212">Un nombre de texto que representa las reglas de equilibrio de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-212">A text name representing hello load balancing rules.</span></span> <span data-ttu-id="9253e-213">Por ejemplo, **SQLAlwaysOnEndPointListener**.</span><span class="sxs-lookup"><span data-stu-id="9253e-213">For example, **SQLAlwaysOnEndPointListener**.</span></span> |
   | <span data-ttu-id="9253e-214">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="9253e-214">**Protocol**</span></span> |<span data-ttu-id="9253e-215">**TCP**</span><span class="sxs-lookup"><span data-stu-id="9253e-215">**TCP**</span></span> |
   | <span data-ttu-id="9253e-216">**Puerto**</span><span class="sxs-lookup"><span data-stu-id="9253e-216">**Port**</span></span> |<span data-ttu-id="9253e-217">*1433*</span><span class="sxs-lookup"><span data-stu-id="9253e-217">*1433*</span></span> |
   | <span data-ttu-id="9253e-218">**Puerto back-end**</span><span class="sxs-lookup"><span data-stu-id="9253e-218">**Backend Port**</span></span> |<span data-ttu-id="9253e-219">*1433*. Este valor se ignorará porque la regla usa **IP flotante (Direct Server Return)**.</span><span class="sxs-lookup"><span data-stu-id="9253e-219">*1433*. This value is ignored because this rule uses **Floating IP (direct server return)**.</span></span> |
   | <span data-ttu-id="9253e-220">**Sondeo**</span><span class="sxs-lookup"><span data-stu-id="9253e-220">**Probe**</span></span> |<span data-ttu-id="9253e-221">Usar el nombre de Hola de sondeo de Hola que creó para este equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="9253e-221">Use hello name of hello probe that you created for this load balancer.</span></span> |
   | <span data-ttu-id="9253e-222">**Persistencia de la sesión**</span><span class="sxs-lookup"><span data-stu-id="9253e-222">**Session persistence**</span></span> |<span data-ttu-id="9253e-223">**None**</span><span class="sxs-lookup"><span data-stu-id="9253e-223">**None**</span></span> |
   | <span data-ttu-id="9253e-224">**Tiempo de espera de inactividad (minutos)**</span><span class="sxs-lookup"><span data-stu-id="9253e-224">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="9253e-225">*4*</span><span class="sxs-lookup"><span data-stu-id="9253e-225">*4*</span></span> |
   | <span data-ttu-id="9253e-226">**IP flotante (Direct Server Return)**</span><span class="sxs-lookup"><span data-stu-id="9253e-226">**Floating IP (direct server return)**</span></span> |<span data-ttu-id="9253e-227">**Enabled**</span><span class="sxs-lookup"><span data-stu-id="9253e-227">**Enabled**</span></span> |

   > [!NOTE]
   > <span data-ttu-id="9253e-228">Es posible que tenga tooscroll hacia abajo Hola hoja tooview todas las configuraciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-228">You might have tooscroll down hello blade tooview all hello settings.</span></span>
   > 

4. <span data-ttu-id="9253e-229">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-229">Click **OK**.</span></span> 
5. <span data-ttu-id="9253e-230">Azure configura la regla de equilibrio de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-230">Azure configures hello load balancing rule.</span></span> <span data-ttu-id="9253e-231">Ahora equilibrador de carga de hello es tooroute configurado tráfico toohello SQL instancia del servidor que hospeda el agente de escucha de hello para el grupo de disponibilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-231">Now hello load balancer is configured tooroute traffic toohello SQL Server instance that hosts hello listener for hello availability group.</span></span> 

<span data-ttu-id="9253e-232">En este momento, grupo de recursos de hello tiene un equilibrador de carga que se conecta tooboth máquinas de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9253e-232">At this point, hello resource group has a load balancer that connects tooboth SQL Server machines.</span></span> <span data-ttu-id="9253e-233">equilibrador de carga de Hello también contiene una dirección IP de hello SQL Server Always On disponibilidad escucha de grupo, por lo que cualquier máquina puede responder toorequests para grupos de disponibilidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-233">hello load balancer also contains an IP address for hello SQL Server Always On availability group listener, so that either machine can respond toorequests for hello availability groups.</span></span>

> [!NOTE]
> <span data-ttu-id="9253e-234">Si las instancias de SQL Server se encuentran en dos regiones independientes, repita los pasos de Hola Hola otra región.</span><span class="sxs-lookup"><span data-stu-id="9253e-234">If your SQL Server instances are in two separate regions, repeat hello steps in hello other region.</span></span> <span data-ttu-id="9253e-235">Cada una de las regiones necesita su propio equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="9253e-235">Each region requires a load balancer.</span></span> 
> 
> 

## <a name="configure-hello-cluster-toouse-hello-load-balancer-ip-address"></a><span data-ttu-id="9253e-236">Configurar la dirección IP del equilibrador de carga de hello clúster toouse Hola</span><span class="sxs-lookup"><span data-stu-id="9253e-236">Configure hello cluster toouse hello load balancer IP address</span></span>
<span data-ttu-id="9253e-237">paso siguiente Hello es agente de escucha de tooconfigure hello en clúster de Hola y ponga Hola el agente de escucha en línea.</span><span class="sxs-lookup"><span data-stu-id="9253e-237">hello next step is tooconfigure hello listener on hello cluster, and bring hello listener online.</span></span> <span data-ttu-id="9253e-238">Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="9253e-238">Do hello following:</span></span> 

1. <span data-ttu-id="9253e-239">Crear Agente de escucha del grupo de disponibilidad de hello en clúster de conmutación por error de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-239">Create hello availability group listener on hello failover cluster.</span></span> 

2. <span data-ttu-id="9253e-240">Ponga el agente de escucha de hello en línea.</span><span class="sxs-lookup"><span data-stu-id="9253e-240">Bring hello listener online.</span></span>

### <a name="step-5-create-hello-availability-group-listener-on-hello-failover-cluster"></a><span data-ttu-id="9253e-241">Paso 5: Crear el agente de escucha del grupo de disponibilidad de hello en clúster de conmutación por error de Hola</span><span class="sxs-lookup"><span data-stu-id="9253e-241">Step 5: Create hello availability group listener on hello failover cluster</span></span>
<span data-ttu-id="9253e-242">En este paso, se crea manualmente el agente de escucha del grupo de disponibilidad de hello en el Administrador de clústeres de conmutación por error y SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="9253e-242">In this step, you manually create hello availability group listener in Failover Cluster Manager and SQL Server Management Studio.</span></span>

[!INCLUDE [ag-listener-configure](../../../../includes/virtual-machines-ag-listener-configure.md)]

### <a name="verify-hello-configuration-of-hello-listener"></a><span data-ttu-id="9253e-243">Comprobar la configuración de Hola de agente de escucha de Hola</span><span class="sxs-lookup"><span data-stu-id="9253e-243">Verify hello configuration of hello listener</span></span>

<span data-ttu-id="9253e-244">Si las dependencias y los recursos de clúster de hello estén configuradas correctamente, debe ser capaz de tooview agente de escucha hello en SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="9253e-244">If hello cluster resources and dependencies are correctly configured, you should be able tooview hello listener in SQL Server Management Studio.</span></span> <span data-ttu-id="9253e-245">tooset Hola puerto de escucha, Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="9253e-245">tooset hello listener port, do hello following:</span></span>

1. <span data-ttu-id="9253e-246">Inicie SQL Server Management Studio y, a continuación, conecte toohello de réplica principal.</span><span class="sxs-lookup"><span data-stu-id="9253e-246">Start SQL Server Management Studio, and then connect toohello primary replica.</span></span>

2. <span data-ttu-id="9253e-247">Vaya demasiado**alta disponibilidad de AlwaysOn** > **grupos de disponibilidad** > **los agentes de escucha del grupo de disponibilidad**.</span><span class="sxs-lookup"><span data-stu-id="9253e-247">Go too**AlwaysOn High Availability** > **Availability Groups** > **Availability Group Listeners**.</span></span>  
    <span data-ttu-id="9253e-248">Ahora debería ver el nombre de agente de escucha de Hola que creó en el Administrador de clústeres de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="9253e-248">You should now see hello listener name that you created in Failover Cluster Manager.</span></span> 

3. <span data-ttu-id="9253e-249">Haga clic en nombre de agente de escucha de hello y, a continuación, haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="9253e-249">Right-click hello listener name, and then click **Properties**.</span></span>

4. <span data-ttu-id="9253e-250">Hola **puerto** , especifique el número de puerto de hello para el agente de escucha del grupo de disponibilidad de hello mediante el uso de hello $EndpointPort que usó anteriormente (1433 pasaba Hola valor predeterminado) y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-250">In hello **Port** box, specify hello port number for hello availability group listener by using hello $EndpointPort you used earlier (1433 was hello default), and then click **OK**.</span></span>

<span data-ttu-id="9253e-251">Ahora tiene un grupo de disponibilidad en máquinas virtuales de Azure que se ejecutan con el modelo de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="9253e-251">You now have an availability group in Azure virtual machines running in Resource Manager mode.</span></span> 

## <a name="test-hello-connection-toohello-listener"></a><span data-ttu-id="9253e-252">El agente de escucha de prueba Hola conexión toohello</span><span class="sxs-lookup"><span data-stu-id="9253e-252">Test hello connection toohello listener</span></span>
<span data-ttu-id="9253e-253">Probar la conexión de hello haciendo Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="9253e-253">Test hello connection by doing hello following:</span></span>

1. <span data-ttu-id="9253e-254">Instancia de SQL Server tooa RDP que se encuentra en hello mismo virtual de red, pero no no réplica Hola propio.</span><span class="sxs-lookup"><span data-stu-id="9253e-254">RDP tooa SQL Server instance that is in hello same virtual network, but does not own hello replica.</span></span> <span data-ttu-id="9253e-255">Este servidor puede ser Hola otra instancia SQL Server en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-255">This server can be hello other SQL Server instance in hello cluster.</span></span>

2. <span data-ttu-id="9253e-256">Use **sqlcmd** conexión de utilidad tootest Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-256">Use **sqlcmd** utility tootest hello connection.</span></span> <span data-ttu-id="9253e-257">Por ejemplo, Establece la siguiente secuencia de comandos de hello un **sqlcmd** réplica principal de conexión toohello a través de agente de escucha de hello con autenticación de Windows:</span><span class="sxs-lookup"><span data-stu-id="9253e-257">For example, hello following script establishes a **sqlcmd** connection toohello primary replica through hello listener with Windows authentication:</span></span>
   
        sqlcmd -S <listenerName> -E

<span data-ttu-id="9253e-258">Hola conexión SQLCMD conecta automáticamente toohello instancia de SQL Server que hospeda la réplica principal de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-258">hello SQLCMD connection automatically connects toohello SQL Server instance that hosts hello primary replica.</span></span> 

## <a name="create-an-ip-address-for-an-additional-availability-group"></a><span data-ttu-id="9253e-259">Creación de una dirección IP para un grupo de disponibilidad adicional</span><span class="sxs-lookup"><span data-stu-id="9253e-259">Create an IP address for an additional availability group</span></span>

<span data-ttu-id="9253e-260">Cada grupo de disponibilidad usa un agente de escucha independiente.</span><span class="sxs-lookup"><span data-stu-id="9253e-260">Each availability group uses a separate listener.</span></span> <span data-ttu-id="9253e-261">Cada agente de escucha tiene su propia dirección IP.</span><span class="sxs-lookup"><span data-stu-id="9253e-261">Each listener has its own IP address.</span></span> <span data-ttu-id="9253e-262">Use Hola misma dirección IP de hello toohold de equilibrador de carga para agentes de escucha adicionales.</span><span class="sxs-lookup"><span data-stu-id="9253e-262">Use hello same load balancer toohold hello IP address for additional listeners.</span></span> <span data-ttu-id="9253e-263">Después de crear un grupo de disponibilidad, agregar equilibrador de carga de toohello de dirección IP de hello y, a continuación, configure el agente de escucha de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-263">After you create an availability group, add hello IP address toohello load balancer, and then configure hello listener.</span></span>

<span data-ttu-id="9253e-264">tooadd un equilibrador de carga de tooa de dirección IP con hello portal de Azure, Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="9253e-264">tooadd an IP address tooa load balancer with hello Azure portal, do hello following:</span></span>

1. <span data-ttu-id="9253e-265">En hello portal de Azure, abra el grupo de recursos de Hola que contiene el equilibrador de carga de hello y, a continuación, haga clic en el equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-265">In hello Azure portal, open hello resource group that contains hello load balancer, and then click hello load balancer.</span></span> 

2. <span data-ttu-id="9253e-266">En **Configuración**, haga clic en **Grupo de direcciones IP de front-end** y, después, en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-266">Under **SETTINGS**, click **Frontend IP pool**, and then click **Add**.</span></span> 

3. <span data-ttu-id="9253e-267">En **agregar dirección IP de front-end**, asigne un nombre de front-end de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-267">Under **Add frontend IP address**, assign a name for hello front end.</span></span> 

4. <span data-ttu-id="9253e-268">Compruebe que hello **red Virtual** hello y **subred** se Hola igual Hola instancias de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9253e-268">Verify that hello **Virtual network** and hello **Subnet** are hello same as hello SQL Server instances.</span></span>

5. <span data-ttu-id="9253e-269">Establecer la dirección IP de hello para el agente de escucha de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-269">Set hello IP address for hello listener.</span></span> 
   
   >[!TIP]
   ><span data-ttu-id="9253e-270">Puede establecer toostatic de dirección IP de Hola y escriba una dirección que no se utiliza actualmente en la subred de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-270">You can set hello IP address toostatic and type an address that is not currently used in hello subnet.</span></span> <span data-ttu-id="9253e-271">Como alternativa, puede establecer toodynamic de dirección IP de Hola y guardar el nuevo grupo de IP front-end Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-271">Alternatively, you can set hello IP address toodynamic and save hello new front-end IP pool.</span></span> <span data-ttu-id="9253e-272">Al hacerlo, Hola portal de Azure asigna automáticamente un grupo de toohello de direcciones IP disponible.</span><span class="sxs-lookup"><span data-stu-id="9253e-272">When you do so, hello Azure portal automatically assigns an available IP address toohello pool.</span></span> <span data-ttu-id="9253e-273">A continuación, puede volver a abrir el grupo de direcciones IP de front-end de Hola y cambiar Hola asignación toostatic.</span><span class="sxs-lookup"><span data-stu-id="9253e-273">You can then reopen hello front-end IP pool and change hello assignment toostatic.</span></span> 

6. <span data-ttu-id="9253e-274">Guarde la dirección IP de hello para el agente de escucha de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-274">Save hello IP address for hello listener.</span></span> 

7. <span data-ttu-id="9253e-275">Agregar un sondeo de estado mediante Hola después de configuración:</span><span class="sxs-lookup"><span data-stu-id="9253e-275">Add a health probe by using hello following settings:</span></span>

   |<span data-ttu-id="9253e-276">Configuración</span><span class="sxs-lookup"><span data-stu-id="9253e-276">Setting</span></span> |<span data-ttu-id="9253e-277">Valor</span><span class="sxs-lookup"><span data-stu-id="9253e-277">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="9253e-278">**Name**</span><span class="sxs-lookup"><span data-stu-id="9253e-278">**Name**</span></span> |<span data-ttu-id="9253e-279">Un sondeo de hello tooidentify de nombre.</span><span class="sxs-lookup"><span data-stu-id="9253e-279">A name tooidentify hello probe.</span></span>
   |<span data-ttu-id="9253e-280">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="9253e-280">**Protocol**</span></span> |<span data-ttu-id="9253e-281">TCP</span><span class="sxs-lookup"><span data-stu-id="9253e-281">TCP</span></span>
   |<span data-ttu-id="9253e-282">**Puerto**</span><span class="sxs-lookup"><span data-stu-id="9253e-282">**Port**</span></span> |<span data-ttu-id="9253e-283">Un puerto TCP sin usar, que debe estar disponible en todas las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="9253e-283">An unused TCP port, which must be available on all virtual machines.</span></span> <span data-ttu-id="9253e-284">No se puede usar para ningún otro fin.</span><span class="sxs-lookup"><span data-stu-id="9253e-284">It cannot be used for any other purpose.</span></span> <span data-ttu-id="9253e-285">No hay dos agentes de escucha pueden usar Hola mismo puerto de sondeo.</span><span class="sxs-lookup"><span data-stu-id="9253e-285">No two listeners can use hello same probe port.</span></span> 
   |<span data-ttu-id="9253e-286">**Intervalo**</span><span class="sxs-lookup"><span data-stu-id="9253e-286">**Interval**</span></span> |<span data-ttu-id="9253e-287">Hola intervalo de tiempo entre el sondeo de los intentos.</span><span class="sxs-lookup"><span data-stu-id="9253e-287">hello amount of time between probe attempts.</span></span> <span data-ttu-id="9253e-288">Usar valor predeterminado es hello (5).</span><span class="sxs-lookup"><span data-stu-id="9253e-288">Use hello default (5).</span></span>
   |<span data-ttu-id="9253e-289">**Umbral incorrecto**</span><span class="sxs-lookup"><span data-stu-id="9253e-289">**Unhealthy threshold**</span></span> |<span data-ttu-id="9253e-290">número de Hola de umbrales consecutivos que deben fallar antes de una máquina virtual se considera incorrecto.</span><span class="sxs-lookup"><span data-stu-id="9253e-290">hello number of consecutive thresholds that should fail before a virtual machine is considered unhealthy.</span></span>

8. <span data-ttu-id="9253e-291">Haga clic en **Aceptar** sondeo de hello toosave.</span><span class="sxs-lookup"><span data-stu-id="9253e-291">Click **OK** toosave hello probe.</span></span> 

9. <span data-ttu-id="9253e-292">Cree una regla de equilibrio de carga.</span><span class="sxs-lookup"><span data-stu-id="9253e-292">Create a load balancing rule.</span></span> <span data-ttu-id="9253e-293">Haga clic en **Reglas de equilibrio de carga** y luego haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="9253e-293">Click **Load balancing rules**, and then click **Add**.</span></span>

10. <span data-ttu-id="9253e-294">Configurar Hola nuevo equilibrio de carga regla mediante el uso de hello después de configuración:</span><span class="sxs-lookup"><span data-stu-id="9253e-294">Configure hello new load balancing rule by using hello following settings:</span></span>

   |<span data-ttu-id="9253e-295">Configuración</span><span class="sxs-lookup"><span data-stu-id="9253e-295">Setting</span></span> |<span data-ttu-id="9253e-296">Valor</span><span class="sxs-lookup"><span data-stu-id="9253e-296">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="9253e-297">**Name**</span><span class="sxs-lookup"><span data-stu-id="9253e-297">**Name**</span></span> |<span data-ttu-id="9253e-298">Un saludo de tooidentify nombre cargar la regla de equilibrio.</span><span class="sxs-lookup"><span data-stu-id="9253e-298">A name tooidentify hello load balancing rule.</span></span> 
   |<span data-ttu-id="9253e-299">**Frontend IP address** (Dirección IP de front-end)</span><span class="sxs-lookup"><span data-stu-id="9253e-299">**Frontend IP address**</span></span> |<span data-ttu-id="9253e-300">Seleccione la dirección IP de Hola que creó.</span><span class="sxs-lookup"><span data-stu-id="9253e-300">Select hello IP address you created.</span></span> 
   |<span data-ttu-id="9253e-301">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="9253e-301">**Protocol**</span></span> |<span data-ttu-id="9253e-302">TCP</span><span class="sxs-lookup"><span data-stu-id="9253e-302">TCP</span></span>
   |<span data-ttu-id="9253e-303">**Puerto**</span><span class="sxs-lookup"><span data-stu-id="9253e-303">**Port**</span></span> |<span data-ttu-id="9253e-304">Usar el puerto de Hola que usan instancias de SQL Server de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-304">Use hello port that hello SQL Server instances are using.</span></span> <span data-ttu-id="9253e-305">Una instancia predeterminada usa el puerto 1433, a menos que lo haya modificado.</span><span class="sxs-lookup"><span data-stu-id="9253e-305">A default instance uses port 1433, unless you changed it.</span></span> 
   |<span data-ttu-id="9253e-306">**Puerto back-end**</span><span class="sxs-lookup"><span data-stu-id="9253e-306">**Backend port**</span></span> |<span data-ttu-id="9253e-307">Hola uso mismo valor que **puerto**.</span><span class="sxs-lookup"><span data-stu-id="9253e-307">Use hello same value as **Port**.</span></span>
   |<span data-ttu-id="9253e-308">**Grupo de back-end**</span><span class="sxs-lookup"><span data-stu-id="9253e-308">**Backend pool**</span></span> |<span data-ttu-id="9253e-309">grupo de Hola que contiene máquinas virtuales de hello con instancias de SQL Server de Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-309">hello pool that contains hello virtual machines with hello SQL Server instances.</span></span> 
   |<span data-ttu-id="9253e-310">**Sondeo de estado**</span><span class="sxs-lookup"><span data-stu-id="9253e-310">**Health probe**</span></span> |<span data-ttu-id="9253e-311">Elija el sondeo de Hola que creó.</span><span class="sxs-lookup"><span data-stu-id="9253e-311">Choose hello probe you created.</span></span>
   |<span data-ttu-id="9253e-312">**Persistencia de la sesión**</span><span class="sxs-lookup"><span data-stu-id="9253e-312">**Session persistence**</span></span> |<span data-ttu-id="9253e-313">None</span><span class="sxs-lookup"><span data-stu-id="9253e-313">None</span></span>
   |<span data-ttu-id="9253e-314">**Tiempo de espera de inactividad (minutos)**</span><span class="sxs-lookup"><span data-stu-id="9253e-314">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="9253e-315">Valor predeterminado (4)</span><span class="sxs-lookup"><span data-stu-id="9253e-315">Default (4)</span></span>
   |<span data-ttu-id="9253e-316">**IP flotante (Direct Server Return)**</span><span class="sxs-lookup"><span data-stu-id="9253e-316">**Floating IP (direct server return)**</span></span> | <span data-ttu-id="9253e-317">habilitado</span><span class="sxs-lookup"><span data-stu-id="9253e-317">Enabled</span></span>

### <a name="configure-hello-availability-group-toouse-hello-new-ip-address"></a><span data-ttu-id="9253e-318">Configurar Hola disponibilidad toouse Hola nueva dirección IP del grupo</span><span class="sxs-lookup"><span data-stu-id="9253e-318">Configure hello availability group toouse hello new IP address</span></span>

<span data-ttu-id="9253e-319">toofinish configuración de clúster de hello, pasos de repetición Hola que seguir cuando realiza el primer grupo de disponibilidad Hola.</span><span class="sxs-lookup"><span data-stu-id="9253e-319">toofinish configuring hello cluster, repeat hello steps that you followed when you made hello first availability group.</span></span> <span data-ttu-id="9253e-320">Es decir, configure hello [Hola de toouse nueva dirección IP del clúster](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span><span class="sxs-lookup"><span data-stu-id="9253e-320">That is, configure hello [cluster toouse hello new IP address](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span></span> 

<span data-ttu-id="9253e-321">Después de haber agregado una dirección IP para el agente de escucha de hello, configurar grupo de disponibilidad adicional de hello haciendo Hola siguiente:</span><span class="sxs-lookup"><span data-stu-id="9253e-321">After you have added an IP address for hello listener, configure hello additional availability group by doing hello following:</span></span> 

1. <span data-ttu-id="9253e-322">Compruebe que el puerto de sondeo de Hola para nuevas direcciones IP Hola está abierto en ambas máquinas virtuales de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9253e-322">Verify that hello probe port for hello new IP address is open on both SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="9253e-323">[En el Administrador de clústeres, agregue el punto de acceso de cliente de hello](#addcap).</span><span class="sxs-lookup"><span data-stu-id="9253e-323">[In Cluster Manager, add hello client access point](#addcap).</span></span>

3. <span data-ttu-id="9253e-324">[Configurar recurso IP de hello para el grupo de disponibilidad de hello](#congroup).</span><span class="sxs-lookup"><span data-stu-id="9253e-324">[Configure hello IP resource for hello availability group](#congroup).</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="9253e-325">Cuando se crea la dirección IP de hello, use la dirección IP de Hola que agregó toohello equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="9253e-325">When you create hello IP address, use hello IP address that you added toohello load balancer.</span></span>  

4. <span data-ttu-id="9253e-326">[Asegúrese de recurso de grupo de disponibilidad de SQL Server de hello depende del punto de acceso de cliente de hello](#dependencyGroup).</span><span class="sxs-lookup"><span data-stu-id="9253e-326">[Make hello SQL Server availability group resource dependent on hello client access point](#dependencyGroup).</span></span>

5. <span data-ttu-id="9253e-327">[Hacer que el acceso de cliente de hello elija recursos depende de la dirección IP de hello](#listname).</span><span class="sxs-lookup"><span data-stu-id="9253e-327">[Make hello client access point resource dependent on hello IP address](#listname).</span></span>
 
6. <span data-ttu-id="9253e-328">[Establecer parámetros de clúster de hello en PowerShell](#setparam).</span><span class="sxs-lookup"><span data-stu-id="9253e-328">[Set hello cluster parameters in PowerShell](#setparam).</span></span>

<span data-ttu-id="9253e-329">Después de configurar Hola disponibilidad toouse Hola nueva dirección IP del grupo, configure el agente de escucha de hello conexión toohello.</span><span class="sxs-lookup"><span data-stu-id="9253e-329">After you configure hello availability group toouse hello new IP address, configure hello connection toohello listener.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="9253e-330">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="9253e-330">Next steps</span></span>

- [<span data-ttu-id="9253e-331">Configuración de un grupo de disponibilidad de SQL Server AlwaysOn en Azure Virtual Machines en regiones distintas</span><span class="sxs-lookup"><span data-stu-id="9253e-331">Configure a SQL Server Always On availability group on Azure virtual machines in different regions</span></span>](virtual-machines-windows-portal-sql-availability-group-dr.md)
