---
title: "Configuración de grupos de disponibilidad Always On en Azure Virtual Machines (implementación clásica) | Microsoft Docs"
description: Cree un grupo de disponibilidad AlwaysOn con Azure Virtual Machines. Este tutorial usa principalmente la interfaz de usuario y herramientas en lugar de scripts.
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 8d48a3d2-79f8-4ab0-9327-2f30ee0b2ff1
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 03/17/2017
ms.author: mikeray
ms.openlocfilehash: b360fe9f28eeb9b10c82fce729165b1b572ac3c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="configure-always-on-availability-group-in-azure-virtual-machines-classic"></a><span data-ttu-id="2f171-104">Configuración de grupos de disponibilidad Always On en Azure Virtual Machines (implementación clásica)</span><span class="sxs-lookup"><span data-stu-id="2f171-104">Configure Always On availability group in Azure Virtual Machines (classic)</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="2f171-105">Portal de Azure clásico: interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="2f171-105">Classic: UI</span></span>](../classic/portal-sql-alwayson-availability-groups.md)
> * <span data-ttu-id="2f171-106">[Clásico: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span><span class="sxs-lookup"><span data-stu-id="2f171-106">[Classic: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span></span><br/>

<span data-ttu-id="2f171-107">Antes de comenzar, considere que ahora puede completar esta tarea en un modelo de Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="2f171-107">Before you begin, consider that you can now complete this task in Azure Resource Manager model.</span></span> <span data-ttu-id="2f171-108">Se recomienda el modelo de Azure Resource Manager para las implementaciones nuevas.</span><span class="sxs-lookup"><span data-stu-id="2f171-108">We recommend Azure Resource Manager model for new deployments.</span></span> <span data-ttu-id="2f171-109">Consulte [Grupos de disponibilidad de SQL Server AlwaysOn en Azure Virtual Machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-109">See [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="2f171-110">Microsoft recomienda que las implementaciones más recientes usen el modelo del Administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="2f171-110">Microsoft recommends that most new deployments use the Resource Manager model.</span></span> <span data-ttu-id="2f171-111">Azure tiene dos modelos de implementación diferentes para crear recursos y trabajar con ellos: [Resource Manager y el clásico](../../../azure-resource-manager/resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-111">Azure has two different deployment models to create and work with resources: [Resource Manager and classic](../../../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="2f171-112">Este artículo explica cómo utilizar el modelo de implementación clásico.</span><span class="sxs-lookup"><span data-stu-id="2f171-112">This article explains how to use the classic deployment model.</span></span> 

<span data-ttu-id="2f171-113">Para completar esta tarea con el modelo de Azure Resource Manager, consulte el artículo [Grupos de disponibilidad de SQL Server AlwaysOn en Azure Virtual Machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-113">To complete this task with the Azure Resource Manager model, see [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

<span data-ttu-id="2f171-114">Este tutorial integral muestra cómo implementar grupos de disponibilidad mediante SQL Server AlwaysOn ejecutándose en Azure Virtual Machines.</span><span class="sxs-lookup"><span data-stu-id="2f171-114">This end-to-end tutorial shows you how to implement availability groups by using SQL Server Always On running on Azure Virtual Machines.</span></span>

<span data-ttu-id="2f171-115">Al final del tutorial, la solución SQL Server AlwaysOn en Azure constará de los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="2f171-115">At the end of the tutorial, your SQL Server Always On solution in Azure will consist of the following elements:</span></span>

* <span data-ttu-id="2f171-116">Una red virtual que contiene varias subredes, incluida una subred front-end y back-end</span><span class="sxs-lookup"><span data-stu-id="2f171-116">A virtual network that contains multiple subnets and includes a frontend and a backend subnet</span></span>
* <span data-ttu-id="2f171-117">Un controlador de dominio con un dominio de Active Directory (Azure AD)</span><span class="sxs-lookup"><span data-stu-id="2f171-117">A domain controller with an Active Directory (Azure AD) domain</span></span>
* <span data-ttu-id="2f171-118">Dos máquinas virtuales que ejecutan SQL Server y están implementadas en la subred de back-end y unidas al dominio de Azure AD</span><span class="sxs-lookup"><span data-stu-id="2f171-118">Two virtual machines that run SQL Server and are deployed to the backend subnet and joined to the Azure AD domain</span></span>
* <span data-ttu-id="2f171-119">Un clúster de conmutación por error de tres nodos con el modelo de cuórum Mayoría de nodo</span><span class="sxs-lookup"><span data-stu-id="2f171-119">A three-node failover cluster with the Node Majority quorum model</span></span>
* <span data-ttu-id="2f171-120">Un grupo de disponibilidad que tiene dos réplicas de confirmación sincrónica de una base de datos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="2f171-120">An availability group that has two synchronous-commit replicas of an availability database</span></span>

<span data-ttu-id="2f171-121">La siguiente ilustración es una representación gráfica de la solución.</span><span class="sxs-lookup"><span data-stu-id="2f171-121">The following illustration is a graphical representation of the solution.</span></span>

![Arquitectura de pruebas para grupos de disponibilidad en Azure](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC791912.png)

<span data-ttu-id="2f171-123">Tenga en cuenta que se trata de una de las posibles configuraciones.</span><span class="sxs-lookup"><span data-stu-id="2f171-123">Note that this is one possible configuration.</span></span> <span data-ttu-id="2f171-124">Por ejemplo, puede minimizar el número de máquinas virtuales para un grupo de disponibilidad de dos réplicas.</span><span class="sxs-lookup"><span data-stu-id="2f171-124">For example, you can minimize the number of virtual machines for a two-replica availability group.</span></span> <span data-ttu-id="2f171-125">Esta configuración guarda las horas de proceso en Azure mediante el controlador de dominio como el testigo del recurso compartido del archivo de quórum en un clúster de dos nodos.</span><span class="sxs-lookup"><span data-stu-id="2f171-125">This configuration saves on compute hours in Azure by using the domain controller as the quorum file share witness in a two-node cluster.</span></span> <span data-ttu-id="2f171-126">Este método reduce el número de máquinas virtuales en uno desde la configuración mostrada.</span><span class="sxs-lookup"><span data-stu-id="2f171-126">This method reduces the virtual machine count by one from the illustrated configuration.</span></span>

<span data-ttu-id="2f171-127">En este tutorial se da por hecho lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f171-127">This tutorial assumes the following:</span></span>

* <span data-ttu-id="2f171-128">Ya tiene una cuenta de Azure.</span><span class="sxs-lookup"><span data-stu-id="2f171-128">You already have an Azure account.</span></span>
* <span data-ttu-id="2f171-129">Ya sabe cómo usar la GUI en la galería de máquinas virtuales para aprovisionar una máquina virtual clásica con SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-129">You already know how to use the GUI in the virtual machine gallery to provision a classic virtual machine that runs SQL Server.</span></span>
* <span data-ttu-id="2f171-130">Ya tiene un conocimiento sólido de los grupos de disponibilidad AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="2f171-130">You already have a solid understanding of Always On availability groups.</span></span> <span data-ttu-id="2f171-131">Para obtener más información, consulte [Grupos de disponibilidad AlwaysOn (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span><span class="sxs-lookup"><span data-stu-id="2f171-131">For more information, see [Always On Availability Groups (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="2f171-132">Si le interesa utilizar los grupos de disponibilidad Always On con SharePoint, consulte también [Configuración de grupos de disponibilidad AlwaysOn de SQL Server 2012 para SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span><span class="sxs-lookup"><span data-stu-id="2f171-132">If you are interested in using Always On availability groups with SharePoint, also see [Configure SQL Server 2012 Always On Availability Groups for SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span></span>
> 
> 

## <a name="create-the-virtual-network-and-domain-controller-server"></a><span data-ttu-id="2f171-133">Creación de la red virtual y el servidor del controlador de dominio</span><span class="sxs-lookup"><span data-stu-id="2f171-133">Create the virtual network and domain controller server</span></span>
<span data-ttu-id="2f171-134">Comience con una nueva cuenta de prueba de Azure.</span><span class="sxs-lookup"><span data-stu-id="2f171-134">You begin with a new Azure trial account.</span></span> <span data-ttu-id="2f171-135">Una vez que haya configurado la cuenta, debería estar en la pantalla de inicio del Portal de Azure clásico.</span><span class="sxs-lookup"><span data-stu-id="2f171-135">After you set up your account, you should be on the home screen of the Azure classic portal.</span></span>

1. <span data-ttu-id="2f171-136">Haga clic en el botón **Nuevo** de la esquina izquierda de la parte inferior de la página, como se muestra en la captura de pantalla siguiente.</span><span class="sxs-lookup"><span data-stu-id="2f171-136">Click the **New** button at the left corner of the bottom of the page, as shown in the following screenshot.</span></span>
   
    ![Haga clic en Nuevo, en el Portal](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665511.gif)
2. <span data-ttu-id="2f171-138">Haga clic en **Network Services** > **Red virtual** > **Creación personalizada** tal como se muestra en la siguiente ilustración.</span><span class="sxs-lookup"><span data-stu-id="2f171-138">Click **Network Services** > **Virtual Network** > **Custom Create**, as shown in the following screenshot.</span></span>
   
    ![Crear red virtual](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665512.gif)
3. <span data-ttu-id="2f171-140">En el cuadro de diálogo **CREAR UNA RED VIRTUAL** , cree una nueva red virtual recorriendo las páginas y usando la configuración de la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="2f171-140">In the **CREATE A VIRTUAL NETWORK** dialog box, create a new virtual network by stepping through the pages and using the settings in the following table.</span></span> 
   
   | <span data-ttu-id="2f171-141">Page</span><span class="sxs-lookup"><span data-stu-id="2f171-141">Page</span></span> | <span data-ttu-id="2f171-142">Settings</span><span class="sxs-lookup"><span data-stu-id="2f171-142">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="2f171-143">Detalles de red virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-143">Virtual Network Details</span></span> |<span data-ttu-id="2f171-144">**NOMBRE = ContosoNET**</span><span class="sxs-lookup"><span data-stu-id="2f171-144">**NAME = ContosoNET**</span></span><br/><span data-ttu-id="2f171-145">**REGIÓN = Oeste de EE. UU.**</span><span class="sxs-lookup"><span data-stu-id="2f171-145">**REGION = West US**</span></span> |
   | <span data-ttu-id="2f171-146">Servidores DNS y conectividad VPN</span><span class="sxs-lookup"><span data-stu-id="2f171-146">DNS Servers and VPN Connectivity</span></span> |<span data-ttu-id="2f171-147">None</span><span class="sxs-lookup"><span data-stu-id="2f171-147">None</span></span> |
   | <span data-ttu-id="2f171-148">Espacios de direcciones de la red virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-148">Virtual Network Address Spaces</span></span> |<span data-ttu-id="2f171-149">La configuración se muestra en la siguiente captura de pantalla:</span><span class="sxs-lookup"><span data-stu-id="2f171-149">Settings are shown in the following screenshot:</span></span> ![Crear red virtual](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784620.png) |
4. <span data-ttu-id="2f171-151">Cree la máquina virtual que se usará como controlador de dominio (DC).</span><span class="sxs-lookup"><span data-stu-id="2f171-151">Create the virtual machine that you will use as the domain controller (DC).</span></span> <span data-ttu-id="2f171-152">Haga clic en **Nuevo** > **Proceso** > **Máquina virtual** > **Desde galería**, como se muestra en la siguiente captura de pantalla.</span><span class="sxs-lookup"><span data-stu-id="2f171-152">Click **New** > **Compute** > **Virtual Machine** > **From Gallery**, as shown in the following screenshot.</span></span>
   
    ![de una máquina virtual](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784621.png)
5. <span data-ttu-id="2f171-154">En el cuadro de diálogo **CREAR UNA MÁQUINA VIRTUAL** , configure una nueva máquina virtual recorriendo las páginas y usando la configuración de la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="2f171-154">In the **CREATE A VIRTUAL MACHINE** dialog box, configure a new virtual machine by stepping through the pages and using the settings in the following table.</span></span> 
   
   | <span data-ttu-id="2f171-155">Page</span><span class="sxs-lookup"><span data-stu-id="2f171-155">Page</span></span> | <span data-ttu-id="2f171-156">Settings</span><span class="sxs-lookup"><span data-stu-id="2f171-156">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="2f171-157">Seleccionar el sistema operativo de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-157">Select the virtual machine operating system</span></span> |<span data-ttu-id="2f171-158">Windows Server 2012 R2 Datacenter</span><span class="sxs-lookup"><span data-stu-id="2f171-158">Windows Server 2012 R2 Datacenter</span></span> |
   | <span data-ttu-id="2f171-159">Configuración de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-159">Virtual machine configuration</span></span> |<span data-ttu-id="2f171-160">**FECHA DE LANZAMIENTO DE LA VERSIÓN** = (última)</span><span class="sxs-lookup"><span data-stu-id="2f171-160">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="2f171-161">**NOMBRE DE MÁQUINA VIRTUAL** = ContosoDC</span><span class="sxs-lookup"><span data-stu-id="2f171-161">**VIRTUAL MACHINE NAME** = ContosoDC</span></span><br/><span data-ttu-id="2f171-162">**NIVEL**: ESTÁNDAR</span><span class="sxs-lookup"><span data-stu-id="2f171-162">**TIER** = STANDARD</span></span><br/><span data-ttu-id="2f171-163">**TAMAÑO** = A2 (2 núcleos)</span><span class="sxs-lookup"><span data-stu-id="2f171-163">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="2f171-164">**NUEVO NOMBRE de USUARIO** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="2f171-164">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="2f171-165">**NUEVA CONTRASEÑA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-165">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="2f171-166">**CONFIRMAR** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-166">**CONFIRM** = Contoso!000</span></span> |
   | <span data-ttu-id="2f171-167">Configuración de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-167">Virtual machine configuration</span></span> |<span data-ttu-id="2f171-168">**SERVICIO EN LA NUBE**: Crear un nuevo servicio en la nube</span><span class="sxs-lookup"><span data-stu-id="2f171-168">**CLOUD SERVICE** = Create a new cloud service</span></span><br/><span data-ttu-id="2f171-169">**NOMBRE DE DNS DEL SERVICIO EN LA NUBE** = un nombre de servicio en la nube único</span><span class="sxs-lookup"><span data-stu-id="2f171-169">**CLOUD SERVICE DNS NAME** = A unique cloud service name</span></span><br/><span data-ttu-id="2f171-170">**NOMBRE DNS** = un nombre único (por ejemplo, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="2f171-170">**DNS NAME** = A unique name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="2f171-171">**REGION/GRUPO DE AFINIDAD/RED VIRTUAL** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="2f171-171">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="2f171-172">**SUBREDES DE LA RED VIRTUAL** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="2f171-172">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="2f171-173">**CUENTA DE ALMACENAMIENTO** = usar una cuenta de almacenamiento generada automáticamente</span><span class="sxs-lookup"><span data-stu-id="2f171-173">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="2f171-174">**CONJUNTO DE DISPONIBILIDAD**: (Ninguno)</span><span class="sxs-lookup"><span data-stu-id="2f171-174">**AVAILABILITY SET** = (None)</span></span> |
   | <span data-ttu-id="2f171-175">Opciones de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-175">Virtual machine options</span></span> |<span data-ttu-id="2f171-176">Usar predeterminados</span><span class="sxs-lookup"><span data-stu-id="2f171-176">Use defaults</span></span> |

<span data-ttu-id="2f171-177">Después de configurar la nueva máquina virtual, espere a que se realice el aprovisionamiento de la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="2f171-177">After you configure the new virtual machine, wait for the virtual machine to be provsioned.</span></span> <span data-ttu-id="2f171-178">Este proceso tarda algo de tiempo en finalizarse.</span><span class="sxs-lookup"><span data-stu-id="2f171-178">This process takes some time to finish.</span></span> <span data-ttu-id="2f171-179">Si hace clic en la pestaña **Máquina virtual** en el Portal de Azure clásico, puede ver que ContosoDC recorre los estados de **Iniciando (aprovisionamiento)** a **Detenido**, **Iniciando**, **En ejecución (aprovisionamiento)** y, finalmente, **En ejecución**.</span><span class="sxs-lookup"><span data-stu-id="2f171-179">If you click the **Virtual Machine** tab in the Azure classic portal, you can see ContosoDC cycling states from **Starting (Provisioning)** to **Stopped**, **Starting**, **Running (Provisioning)**, and finally **Running**.</span></span>

<span data-ttu-id="2f171-180">El servidor DC ya está aprovisionado correctamente.</span><span class="sxs-lookup"><span data-stu-id="2f171-180">The DC server is now successfully provisioned.</span></span> <span data-ttu-id="2f171-181">A continuación, configurará el dominio de Active Directory en este servidor DC.</span><span class="sxs-lookup"><span data-stu-id="2f171-181">Next, you will configure the Active Directory domain on this DC server.</span></span>

## <a name="configure-the-domain-controller"></a><span data-ttu-id="2f171-182">Configuración del controlador de dominio</span><span class="sxs-lookup"><span data-stu-id="2f171-182">Configure the domain controller</span></span>
<span data-ttu-id="2f171-183">En los pasos siguientes configurará la máquina ContosoDC como controlador de dominio para corp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="2f171-183">In the following steps, you configure the ContosoDC machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="2f171-184">En el Portal, seleccione la máquina **ContosoDC** .</span><span class="sxs-lookup"><span data-stu-id="2f171-184">In the portal, select the **ContosoDC** machine.</span></span> <span data-ttu-id="2f171-185">En la pestaña **Panel** haga clic en **Conectar** para abrir un archivo de escritorio remoto (RDP) para el acceso de escritorio remoto.</span><span class="sxs-lookup"><span data-stu-id="2f171-185">On the **Dashboard** tab, click **Connect** to open a remote desktop (RDP) file for remote desktop access.</span></span>
   
    ![Conectarse a máquinas virtuales](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784622.png)
2. <span data-ttu-id="2f171-187">Inicie sesión con su cuenta de administrador configurada (**\AzureAdmin**) y la contraseña (**Contoso!000**).</span><span class="sxs-lookup"><span data-stu-id="2f171-187">Sign in with your configured administrator account (**\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="2f171-188">De forma predeterminada, se debe mostrar el panel **Administrador del servidor** .</span><span class="sxs-lookup"><span data-stu-id="2f171-188">By default, the **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="2f171-189">Haga clic en el vínculo **Agregar roles y características** en el panel.</span><span class="sxs-lookup"><span data-stu-id="2f171-189">Click the **Add roles and features** link on the dashboard.</span></span>
   
    ![Explorador de servidores Agregar roles](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784623.png)
5. <span data-ttu-id="2f171-191">Haga clic en **Siguiente** hasta llegar a la sección **Roles de servidor**.</span><span class="sxs-lookup"><span data-stu-id="2f171-191">Click **Next** until you get to the **Server Roles** section.</span></span>
6. <span data-ttu-id="2f171-192">Seleccione los roles **Active Directory Domain Services** y **Servidor DNS**.</span><span class="sxs-lookup"><span data-stu-id="2f171-192">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="2f171-193">Cuando se le solicite, agregue más características que requieran estos roles.</span><span class="sxs-lookup"><span data-stu-id="2f171-193">When prompted, add more features that these roles require.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="2f171-194">Recibirá una advertencia de validación que le indicará que no hay ninguna dirección IP estática.</span><span class="sxs-lookup"><span data-stu-id="2f171-194">You will get a validation warning that there is no static IP address.</span></span> <span data-ttu-id="2f171-195">Si está probando la configuración, haga clic en **Continuar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-195">If you are testing the configuration, click **Continue**.</span></span> <span data-ttu-id="2f171-196">En los escenarios de producción [use PowerShell para establecer la dirección IP estática de la máquina del controlador de dominio](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-196">For production scenarios [use PowerShell to set the static IP address of the domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   > 
   > 
   
    ![Diálogo Agregar roles](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784624.png)
7. <span data-ttu-id="2f171-198">Haga clic en **Siguiente** hasta llegar a la sección **Confirmación**.</span><span class="sxs-lookup"><span data-stu-id="2f171-198">Click **Next** until you reach the **Confirmation** section.</span></span> <span data-ttu-id="2f171-199">Active la casilla **Reiniciar automáticamente el servidor de destino en caso necesario** .</span><span class="sxs-lookup"><span data-stu-id="2f171-199">Select the **Restart the destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="2f171-200">Haga clic en **Instalar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-200">Click **Install**.</span></span>
9. <span data-ttu-id="2f171-201">Cuando se instalen las características, vuelva al panel **Administrador del servidor** .</span><span class="sxs-lookup"><span data-stu-id="2f171-201">After the features are installed, return to the **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="2f171-202">Seleccione la nueva opción **AD DS** en el panel izquierdo.</span><span class="sxs-lookup"><span data-stu-id="2f171-202">Select the new **AD DS** option on the left pane.</span></span>
11. <span data-ttu-id="2f171-203">Haga clic en el vínculo **Más** en la barra de advertencia amarilla.</span><span class="sxs-lookup"><span data-stu-id="2f171-203">Click the **More** link on the yellow warning bar.</span></span>
    
     ![Cuadro de diálogo de AD DS en la máquina virtual del servidor DNS](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784625.png)
12. <span data-ttu-id="2f171-205">En la columna **Acción** del cuadro de diálogo **Todos los detalles de la tarea del servidor**, haga clic en **Promover este servidor a controlador de dominio**.</span><span class="sxs-lookup"><span data-stu-id="2f171-205">In the **Action** column of the **All Server Task Details** dialog box, click **Promote this server to a domain controller**.</span></span>
13. <span data-ttu-id="2f171-206">En el **Asistente de configuración de Servicios de dominio de Active Directory**, use los siguientes valores:</span><span class="sxs-lookup"><span data-stu-id="2f171-206">In the **Active Directory Domain Services Configuration Wizard**, use the following values:</span></span>
    
    | <span data-ttu-id="2f171-207">Page</span><span class="sxs-lookup"><span data-stu-id="2f171-207">Page</span></span> | <span data-ttu-id="2f171-208">Configuración</span><span class="sxs-lookup"><span data-stu-id="2f171-208">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="2f171-209">Configuración de la implementación</span><span class="sxs-lookup"><span data-stu-id="2f171-209">Deployment Configuration</span></span> |<span data-ttu-id="2f171-210">**Agregar un nuevo bosque** = seleccionado</span><span class="sxs-lookup"><span data-stu-id="2f171-210">**Add a new forest** = Selected</span></span><br/><span data-ttu-id="2f171-211">**Nombre del dominio raíz** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="2f171-211">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="2f171-212">Opciones del controlador de dominio</span><span class="sxs-lookup"><span data-stu-id="2f171-212">Domain Controller Options</span></span> |<span data-ttu-id="2f171-213">**Password** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-213">**Password** = Contoso!000</span></span><br/><span data-ttu-id="2f171-214">**Confirmar contraseña** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-214">**Confirm Password** = Contoso!000</span></span> |
14. <span data-ttu-id="2f171-215">Haga clic en **Siguiente** para avanzar por las otras páginas del asistente.</span><span class="sxs-lookup"><span data-stu-id="2f171-215">Click **Next** to go through the other pages in the wizard.</span></span> <span data-ttu-id="2f171-216">En la página **Comprobación de requisitos previos**, compruebe que ve el mensaje siguiente: **Todas las comprobaciones de requisitos previos se realizaron correctamente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-216">On the **Prerequisites Check** page, verify that you see the following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="2f171-217">Tenga en cuenta que debe revisar todos los mensajes de advertencia aplicables, pero puede continuar con la instalación.</span><span class="sxs-lookup"><span data-stu-id="2f171-217">Note that you should review all applicable warning messages, but it is possible to continue with the installation.</span></span>
15. <span data-ttu-id="2f171-218">Haga clic en **Instalar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-218">Click **Install**.</span></span> <span data-ttu-id="2f171-219">La máquina virtual **ContosoDC** se reiniciará automáticamente.</span><span class="sxs-lookup"><span data-stu-id="2f171-219">The **ContosoDC** virtual machine will automatically reboot.</span></span>

## <a name="configure-domain-accounts"></a><span data-ttu-id="2f171-220">Configuración de cuentas de dominio</span><span class="sxs-lookup"><span data-stu-id="2f171-220">Configure domain accounts</span></span>
<span data-ttu-id="2f171-221">Los pasos siguientes configuran las cuentas de Active Directory para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="2f171-221">The next steps configure the Active Directory accounts for later use.</span></span>

1. <span data-ttu-id="2f171-222">Vuelva a iniciar sesión en la máquina **ContosoDC**.</span><span class="sxs-lookup"><span data-stu-id="2f171-222">Sign back in to the **ContosoDC** machine.</span></span>
2. <span data-ttu-id="2f171-223">En **Administrador del servidor**, haga clic en **Herramientas** > **Centro de administración de Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="2f171-223">In **Server Manager**, click **Tools** > **Active Directory Administrative Center**.</span></span>
   
    ![Centro de administración de Active Directory](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784626.png)
3. <span data-ttu-id="2f171-225">En el **Centro de administración de Active Directory**, seleccione **corp (local)** en el panel izquierdo.</span><span class="sxs-lookup"><span data-stu-id="2f171-225">In the **Active Directory Administrative Center**, select **corp (local)** in the left pane.</span></span>
4. <span data-ttu-id="2f171-226">En el panel derecho **Tareas**, haga clic en **Nuevo** > **Usuario**.</span><span class="sxs-lookup"><span data-stu-id="2f171-226">On the right **Tasks** pane, click **New** > **User**.</span></span> <span data-ttu-id="2f171-227">Use la configuración siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f171-227">Use the following settings:</span></span>
   
   | <span data-ttu-id="2f171-228">Configuración</span><span class="sxs-lookup"><span data-stu-id="2f171-228">Setting</span></span> | <span data-ttu-id="2f171-229">Valor</span><span class="sxs-lookup"><span data-stu-id="2f171-229">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="2f171-230">**Nombre**</span><span class="sxs-lookup"><span data-stu-id="2f171-230">**First Name**</span></span> |<span data-ttu-id="2f171-231">Instalar</span><span class="sxs-lookup"><span data-stu-id="2f171-231">Install</span></span> |
   | <span data-ttu-id="2f171-232">**Usuario NombreDeCuentaSam**</span><span class="sxs-lookup"><span data-stu-id="2f171-232">**User SamAccountName**</span></span> |<span data-ttu-id="2f171-233">Instalar</span><span class="sxs-lookup"><span data-stu-id="2f171-233">Install</span></span> |
   | <span data-ttu-id="2f171-234">**Password**</span><span class="sxs-lookup"><span data-stu-id="2f171-234">**Password**</span></span> |<span data-ttu-id="2f171-235">Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-235">Contoso!000</span></span> |
   | <span data-ttu-id="2f171-236">**Confirmar contraseña**</span><span class="sxs-lookup"><span data-stu-id="2f171-236">**Confirm password**</span></span> |<span data-ttu-id="2f171-237">Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-237">Contoso!000</span></span> |
   | <span data-ttu-id="2f171-238">**Otras opciones de contraseña**</span><span class="sxs-lookup"><span data-stu-id="2f171-238">**Other password options**</span></span> |<span data-ttu-id="2f171-239">Seleccionado</span><span class="sxs-lookup"><span data-stu-id="2f171-239">Selected</span></span> |
   | <span data-ttu-id="2f171-240">**La contraseña nunca expira**</span><span class="sxs-lookup"><span data-stu-id="2f171-240">**Password never expires**</span></span> |<span data-ttu-id="2f171-241">Activado</span><span class="sxs-lookup"><span data-stu-id="2f171-241">Checked</span></span> |
5. <span data-ttu-id="2f171-242">Haga clic en **Aceptar** para crear el usuario **Install**.</span><span class="sxs-lookup"><span data-stu-id="2f171-242">Click **OK** to create the **Install** user.</span></span> <span data-ttu-id="2f171-243">Esta cuenta se usará para configurar el clúster de conmutación por error y el grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="2f171-243">This account will be used to configure the failover cluster and the availability group.</span></span>
6. <span data-ttu-id="2f171-244">Cree dos usuarios adicionales, **CORP\SQLSvc1** y **CORP\SQLSvc2** con los mismos pasos.</span><span class="sxs-lookup"><span data-stu-id="2f171-244">Create two additional users, **CORP\SQLSvc1** and **CORP\SQLSvc2**, with the same steps.</span></span> <span data-ttu-id="2f171-245">Estas cuentas se utilizarán para las instancias de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-245">These accounts will be used for the SQL Server instances.</span></span> <span data-ttu-id="2f171-246">Después, tendrá que proporcionar a **CORP\Install** los permisos necesarios para configurar los clústeres de conmutación por error de Windows.</span><span class="sxs-lookup"><span data-stu-id="2f171-246">Next, you need to give **CORP\Install** the necessary permissions to configure Windows failover clustering.</span></span>
7. <span data-ttu-id="2f171-247">En el **Centro de administración de Active Directory**, haga clic en **corp (local)** en el panel izquierdo.</span><span class="sxs-lookup"><span data-stu-id="2f171-247">In the **Active Directory Administrative Center**, click **corp (local)** in the left pane.</span></span> <span data-ttu-id="2f171-248">En el panel **Tareas**, haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="2f171-248">In the **Tasks** pane, click **Properties**.</span></span>
   
    ![Propiedades de usuario CORP](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784627.png)
8. <span data-ttu-id="2f171-250">Seleccione **Extensiones** y luego haga clic en el botón **Avanzadas** situado en la pestaña **Seguridad**.</span><span class="sxs-lookup"><span data-stu-id="2f171-250">Select **Extensions**, and then click the **Advanced** button on the **Security** tab.</span></span>
9. <span data-ttu-id="2f171-251">En el cuadro de diálogo **Configuración de seguridad avanzada**, haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-251">In the **Advanced Security Settings for corp** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="2f171-252">Haga clic en **Seleccionar una entidad de seguridad**, busque **CORP\Install** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-252">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
11. <span data-ttu-id="2f171-253">Seleccione los permisos **Leer todas las propiedades** y **Crear objetos de equipo**.</span><span class="sxs-lookup"><span data-stu-id="2f171-253">Select the **Read all properties** and **Create Computer objects** permissions.</span></span>
    
     ![Permisos de usuario Corp](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784628.png)
12. <span data-ttu-id="2f171-255">Haga clic en **Aceptar** y luego vuelva a hacer clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-255">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="2f171-256">Cierre la ventana de propiedades de corp.</span><span class="sxs-lookup"><span data-stu-id="2f171-256">Close the corp properties window.</span></span>

<span data-ttu-id="2f171-257">Ahora que ha configurado Active Directory y los objetos de usuario, creará tres máquinas virtuales de SQL Server y las unirá a este dominio.</span><span class="sxs-lookup"><span data-stu-id="2f171-257">Now that you configured Active Directory and the user objects, you will create three SQL Server virtual machines and join them to this domain.</span></span>

## <a name="create-the-sql-server-virtual-machines"></a><span data-ttu-id="2f171-258">Creación de máquinas virtuales de SQL Server</span><span class="sxs-lookup"><span data-stu-id="2f171-258">Create the SQL Server virtual machines</span></span>
<span data-ttu-id="2f171-259">Cree tres máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="2f171-259">Create three virtual machines.</span></span> <span data-ttu-id="2f171-260">Una es para un nodo de clúster y dos para SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-260">One is for a cluster node and two are for SQL Server.</span></span> <span data-ttu-id="2f171-261">Para crear cada una de las máquinas virtuales, vuelva al Portal de Azure clásico, haga clic en **Nuevo** > **Compute** > **Máquina virtual** > **Desde la galería**.</span><span class="sxs-lookup"><span data-stu-id="2f171-261">To create each of the virtual machines, go back to the Azure classic portal, click **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span> <span data-ttu-id="2f171-262">Después use las plantillas de la tabla siguiente para ayudarle a crear las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="2f171-262">Then, use the templates in the following table to help you create the virtual machines.</span></span>

| <span data-ttu-id="2f171-263">Page</span><span class="sxs-lookup"><span data-stu-id="2f171-263">Page</span></span> | <span data-ttu-id="2f171-264">VM1</span><span class="sxs-lookup"><span data-stu-id="2f171-264">VM1</span></span> | <span data-ttu-id="2f171-265">VM2</span><span class="sxs-lookup"><span data-stu-id="2f171-265">VM2</span></span> | <span data-ttu-id="2f171-266">VM3</span><span class="sxs-lookup"><span data-stu-id="2f171-266">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="2f171-267">Seleccionar el sistema operativo de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-267">Select the virtual machine operating system</span></span> |<span data-ttu-id="2f171-268">**Windows Server 2012 R2 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="2f171-268">**Windows Server 2012 R2 Datacenter**</span></span> |<span data-ttu-id="2f171-269">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="2f171-269">**SQL Server 2014 RTM Enterprise**</span></span> |<span data-ttu-id="2f171-270">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="2f171-270">**SQL Server 2014 RTM Enterprise**</span></span> |
| <span data-ttu-id="2f171-271">Configuración de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-271">Virtual machine configuration</span></span> |<span data-ttu-id="2f171-272">**FECHA DE LANZAMIENTO DE LA VERSIÓN** = (última)</span><span class="sxs-lookup"><span data-stu-id="2f171-272">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="2f171-273">**NOMBRE DE LA MÁQUINA VIRTUAL** = ContosoWSFCNode</span><span class="sxs-lookup"><span data-stu-id="2f171-273">**VIRTUAL MACHINE NAME** = ContosoWSFCNode</span></span><br/><span data-ttu-id="2f171-274">**NIVEL**: ESTÁNDAR</span><span class="sxs-lookup"><span data-stu-id="2f171-274">**TIER** = STANDARD</span></span><br/><span data-ttu-id="2f171-275">**TAMAÑO** = A2 (2 núcleos)</span><span class="sxs-lookup"><span data-stu-id="2f171-275">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="2f171-276">**NUEVO NOMBRE de USUARIO** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="2f171-276">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="2f171-277">**NUEVA CONTRASEÑA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-277">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="2f171-278">**CONFIRMAR** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-278">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="2f171-279">**FECHA DE LANZAMIENTO DE LA VERSIÓN** = (última)</span><span class="sxs-lookup"><span data-stu-id="2f171-279">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="2f171-280">**NOMBRE DE MÁQUINA VIRTUAL** = ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="2f171-280">**VIRTUAL MACHINE NAME** = ContosoSQL1</span></span><br/><span data-ttu-id="2f171-281">**NIVEL**: ESTÁNDAR</span><span class="sxs-lookup"><span data-stu-id="2f171-281">**TIER** = STANDARD</span></span><br/><span data-ttu-id="2f171-282">**TAMAÑO** = A3 (4 núcleos)</span><span class="sxs-lookup"><span data-stu-id="2f171-282">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="2f171-283">**NUEVO NOMBRE de USUARIO** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="2f171-283">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="2f171-284">**NUEVA CONTRASEÑA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-284">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="2f171-285">**CONFIRMAR** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-285">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="2f171-286">**FECHA DE LANZAMIENTO DE LA VERSIÓN** = (última)</span><span class="sxs-lookup"><span data-stu-id="2f171-286">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="2f171-287">**NOMBRE DE MÁQUINA VIRTUAL** = ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="2f171-287">**VIRTUAL MACHINE NAME** = ContosoSQL2</span></span><br/><span data-ttu-id="2f171-288">**NIVEL**: ESTÁNDAR</span><span class="sxs-lookup"><span data-stu-id="2f171-288">**TIER** = STANDARD</span></span><br/><span data-ttu-id="2f171-289">**TAMAÑO** = A3 (4 núcleos)</span><span class="sxs-lookup"><span data-stu-id="2f171-289">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="2f171-290">**NUEVO NOMBRE de USUARIO** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="2f171-290">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="2f171-291">**NUEVA CONTRASEÑA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-291">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="2f171-292">**CONFIRMAR** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="2f171-292">**CONFIRM** = Contoso!000</span></span> |
| <span data-ttu-id="2f171-293">Configuración de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-293">Virtual machine configuration</span></span> |<span data-ttu-id="2f171-294">**SERVICIO EN LA NUBE** = nombre DNS del servicio en la nube único creado anteriormente (por ejemplo, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="2f171-294">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="2f171-295">**REGION/GRUPO DE AFINIDAD/RED VIRTUAL** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="2f171-295">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="2f171-296">**SUBREDES DE LA RED VIRTUAL** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="2f171-296">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="2f171-297">**CUENTA DE ALMACENAMIENTO** = usar una cuenta de almacenamiento generada automáticamente</span><span class="sxs-lookup"><span data-stu-id="2f171-297">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="2f171-298">**CONJUNTO DE DISPONIBILIDAD** = Crear un conjunto de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="2f171-298">**AVAILABILITY SET** = Create an availability set</span></span><br/><span data-ttu-id="2f171-299">**NOMBRE DEL CONJUNTO DE DISPONIBILIDAD** = SQLHADR</span><span class="sxs-lookup"><span data-stu-id="2f171-299">**AVAILABILITY SET NAME** = SQLHADR</span></span> |<span data-ttu-id="2f171-300">**SERVICIO EN LA NUBE** = nombre DNS del servicio en la nube único creado anteriormente (por ejemplo, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="2f171-300">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="2f171-301">**REGION/GRUPO DE AFINIDAD/RED VIRTUAL** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="2f171-301">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="2f171-302">**SUBREDES DE LA RED VIRTUAL** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="2f171-302">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="2f171-303">**CUENTA DE ALMACENAMIENTO** = usar una cuenta de almacenamiento generada automáticamente</span><span class="sxs-lookup"><span data-stu-id="2f171-303">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="2f171-304">**CONJUNTO de DISPONIBILIDAD** = SQLHADR (también puede configurar el conjunto de disponibilidad una vez creada la máquina).</span><span class="sxs-lookup"><span data-stu-id="2f171-304">**AVAILABILITY SET** = SQLHADR (You can also configure the availability set after the machine has been created.</span></span> <span data-ttu-id="2f171-305">Las tres máquinas deben asignarse al conjunto de disponibilidad SQLHADR).</span><span class="sxs-lookup"><span data-stu-id="2f171-305">All three machines should be assigned to the SQLHADR availability set.)</span></span> |<span data-ttu-id="2f171-306">**SERVICIO EN LA NUBE** = nombre DNS del servicio en la nube único creado anteriormente (por ejemplo, ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="2f171-306">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="2f171-307">**REGION/GRUPO DE AFINIDAD/RED VIRTUAL** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="2f171-307">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="2f171-308">**SUBREDES DE LA RED VIRTUAL** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="2f171-308">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="2f171-309">**CUENTA DE ALMACENAMIENTO** = usar una cuenta de almacenamiento generada automáticamente</span><span class="sxs-lookup"><span data-stu-id="2f171-309">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="2f171-310">**CONJUNTO de DISPONIBILIDAD** = SQLHADR (también puede configurar el conjunto de disponibilidad una vez creada la máquina).</span><span class="sxs-lookup"><span data-stu-id="2f171-310">**AVAILABILITY SET** = SQLHADR (You can also configure the availability set after the machine has been created.</span></span> <span data-ttu-id="2f171-311">Las tres máquinas deben asignarse al conjunto de disponibilidad SQLHADR).</span><span class="sxs-lookup"><span data-stu-id="2f171-311">All three machines should be assigned to the SQLHADR availability set.)</span></span> |
| <span data-ttu-id="2f171-312">Opciones de la máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-312">Virtual machine options</span></span> |<span data-ttu-id="2f171-313">Usar predeterminados</span><span class="sxs-lookup"><span data-stu-id="2f171-313">Use defaults</span></span> |<span data-ttu-id="2f171-314">Usar predeterminados</span><span class="sxs-lookup"><span data-stu-id="2f171-314">Use defaults</span></span> |<span data-ttu-id="2f171-315">Usar predeterminados</span><span class="sxs-lookup"><span data-stu-id="2f171-315">Use defaults</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="2f171-316">La configuración anterior le sugiere usar máquinas virtuales de nivel ESTÁNDAR, porque las máquinas de nivel BÁSICO no admiten puntos de conexión de carga equilibrada.</span><span class="sxs-lookup"><span data-stu-id="2f171-316">The previous configuration suggests STANDARD tier virtual machines, because BASIC tier machines do not support load-balanced endpoints.</span></span> <span data-ttu-id="2f171-317">Necesitará puntos de conexión de carga equilibrada más adelante para crear un agente de escucha del grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="2f171-317">You need load-balanced endpoints later to create an availability group listener.</span></span> <span data-ttu-id="2f171-318">Asimismo, los tamaños de máquina que se sugieren aquí están diseñados para probar los grupos de disponibilidad en Azure Virtual Machines.</span><span class="sxs-lookup"><span data-stu-id="2f171-318">Also, the machine sizes that are suggested here are meant for testing availability groups in Azure Virtual Machines.</span></span> <span data-ttu-id="2f171-319">Para optimizar el rendimiento de las cargas de trabajo de producción, consulte las recomendaciones de tamaños de máquina y la configuración de SQL Server en [Procedimientos recomendados de SQL Server en máquinas virtuales de Azure](../sql/virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-319">For the best performance on production workloads, see the recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure Virtual Machines](../sql/virtual-machines-windows-sql-performance.md).</span></span>
> 
> 

<span data-ttu-id="2f171-320">Una vez que las tres máquinas virtuales estén totalmente aprovisionadas, tendrá que unirlas al dominio **corp.contoso.com** y conceder a CORP\Install los derechos administrativos sobre las máquinas.</span><span class="sxs-lookup"><span data-stu-id="2f171-320">After the three virtual machines are fully provisioned, you need to join them to the **corp.contoso.com** domain and grant CORP\Install administrative rights to the machines.</span></span> <span data-ttu-id="2f171-321">Para ello, siga estos pasos para cada una de las tres máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="2f171-321">To do this, use the following steps for each of the three virtual machines.</span></span>

1. <span data-ttu-id="2f171-322">En primer lugar, cambie la dirección del servidor DNS preferido.</span><span class="sxs-lookup"><span data-stu-id="2f171-322">First, change the preferred DNS server address.</span></span> <span data-ttu-id="2f171-323">Descargue el archivo RDP de cada máquina virtual en el directorio local; para ello, seleccione la máquina virtual en la lista y haga clic en el botón **Conectar** .</span><span class="sxs-lookup"><span data-stu-id="2f171-323">Download each virtual machine's RDP file to your local directory by selecting the virtual machine in the list and clicking the **Connect** button.</span></span> <span data-ttu-id="2f171-324">Para seleccionar una máquina virtual, haga clic en cualquier celda que no sea la primera de la fila, tal y como se muestra en la captura de pantalla siguiente.</span><span class="sxs-lookup"><span data-stu-id="2f171-324">To select a virtual machine, click anywhere but the first cell in the row, as shown in the following screenshot.</span></span>
   
    ![Descarga del archivo RDP](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664953.jpg)
2. <span data-ttu-id="2f171-326">Abra el archivo RDP que descargó e inicie sesión en la máquina virtual con la cuenta de administrador configurada (**BUILTIN\AzureAdmin**) y la contraseña (**Contoso!000**).</span><span class="sxs-lookup"><span data-stu-id="2f171-326">Open the RDP file that you downloaded, and sign in to the virtual machine by using your configured administrator account (**BUILTIN\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="2f171-327">Una vez iniciada la sesión, debería ver el panel **Administrador del servidor** .</span><span class="sxs-lookup"><span data-stu-id="2f171-327">After you sign in, you should see the **Server Manager** dashboard.</span></span> <span data-ttu-id="2f171-328">En el panel izquierdo, haga clic en **Servidor local** .</span><span class="sxs-lookup"><span data-stu-id="2f171-328">Click **Local Server** in the left pane.</span></span>
4. <span data-ttu-id="2f171-329">Haga clic en el vínculo **Dirección IPv4 asignada por DHCP, IPv6 habilitado** .</span><span class="sxs-lookup"><span data-stu-id="2f171-329">Click the **IPv4 address assigned by DHCP, IPv6 enabled** link.</span></span>
5. <span data-ttu-id="2f171-330">En el cuadro de diálogo **Conexiones de red** , haga clic en el icono de red.</span><span class="sxs-lookup"><span data-stu-id="2f171-330">In the **Network Connections** dialog box, click the network icon.</span></span>
   
    ![Cambio del servidor DNS de la máquina virtual preferido](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784629.png)
6. <span data-ttu-id="2f171-332">En la barra de comandos, haga clic en **Cambiar la configuración de esta conexión**.</span><span class="sxs-lookup"><span data-stu-id="2f171-332">On the command bar, click **Change the settings of this connection**.</span></span> <span data-ttu-id="2f171-333">(Según el tamaño de la ventana, tendrá que hacer clic en la flecha doble que está mirando hacia la derecha para ver este comando).</span><span class="sxs-lookup"><span data-stu-id="2f171-333">(Depending on the size of your window, you might have to click the double right arrow to see this command).</span></span>
7. <span data-ttu-id="2f171-334">Seleccione **Protocolo de Internet versión 4 (TCP/IPv4)** y luego haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="2f171-334">Select **Internet Protocol Version 4 (TCP/IPv4)**, and then click **Properties**.</span></span>
8. <span data-ttu-id="2f171-335">Seleccione **Usar las siguientes direcciones de servidor DNS** y luego especifique **10.10.2.4** en **Servidor DNS preferido**.</span><span class="sxs-lookup"><span data-stu-id="2f171-335">Select **Use the following DNS server addresses** and then specify **10.10.2.4** in **Preferred DNS server**.</span></span>
9. <span data-ttu-id="2f171-336">La dirección **10.10.2.4** es la que se asigna a una máquina virtual en la subred 10.10.2.0/24 de una instancia de Azure Virtual Network.</span><span class="sxs-lookup"><span data-stu-id="2f171-336">The **10.10.2.4** address is the address that's assigned to a virtual machine in the 10.10.2.0/24 subnet in an Azure virtual network.</span></span> <span data-ttu-id="2f171-337">La máquina virtual es **ContosoDC**.</span><span class="sxs-lookup"><span data-stu-id="2f171-337">That virtual machine is **ContosoDC**.</span></span> <span data-ttu-id="2f171-338">Para comprobar la dirección IP de **ContosoDC**, use **nslookup contosodc** en la ventana del símbolo del sistema , según se muestra en la captura de pantalla siguiente.</span><span class="sxs-lookup"><span data-stu-id="2f171-338">To verify **ContosoDC**'s IP address, use **nslookup contosodc** in the command prompt window, as shown in the following screenshot.</span></span>
   
    ![Uso de NSLOOKUP para buscar la dirección IP para el controlador de dominio](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664954.jpg)
10. <span data-ttu-id="2f171-340">Haga clic en **Aceptar** > **Cerrar** para confirmar los cambios.</span><span class="sxs-lookup"><span data-stu-id="2f171-340">Click **OK** > **Close** to commit the changes.</span></span> <span data-ttu-id="2f171-341">Ahora puede unirse a la máquina virtual en **corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2f171-341">You can now join the virtual machine to **corp.contoso.com**.</span></span>
11. <span data-ttu-id="2f171-342">De vuelta en la ventana **Servidor Local**, haga clic en el vínculo **GRUPO_DE_TRABAJO**.</span><span class="sxs-lookup"><span data-stu-id="2f171-342">Back in the **Local Server** window, click the **WORKGROUP** link.</span></span>
12. <span data-ttu-id="2f171-343">En la sección **Nombre de equipo**, haga clic en **Cambiar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-343">In the **Computer Name** section, click **Change**.</span></span>
13. <span data-ttu-id="2f171-344">Active la casilla **Dominio** y escriba **corp.contoso.com** en el cuadro de texto y luego haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-344">Select the **Domain** check box, type **corp.contoso.com** in the text box, and then click **OK**.</span></span>
14. <span data-ttu-id="2f171-345">En el cuadro de diálogo **Seguridad de Windows**, especifique las credenciales de la cuenta de administrador del dominio predeterminado (**CORP\AzureAdmin**) y la contraseña (**Contoso!000**).</span><span class="sxs-lookup"><span data-stu-id="2f171-345">In the **Windows Security** dialog box, specify the credentials for the default domain administrator account (**CORP\AzureAdmin**) and the password (**Contoso!000**).</span></span>
15. <span data-ttu-id="2f171-346">Cuando vea el mensaje "Bienvenida al dominio corp.contoso.com", haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-346">When you see the "Welcome to the corp.contoso.com domain" message, click **OK**.</span></span>
16. <span data-ttu-id="2f171-347">Haga clic en **Cerrar** > **Reiniciar ahora** en el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="2f171-347">Click **Close** > **Restart Now** in the dialog box.</span></span>

### <a name="add-the-corpinstall-user-as-an-administrator-on-each-virtual-machine"></a><span data-ttu-id="2f171-348">Adición del usuario Corp\Install como administrador en cada máquina virtual</span><span class="sxs-lookup"><span data-stu-id="2f171-348">Add the Corp\Install user as an administrator on each virtual machine</span></span>
1. <span data-ttu-id="2f171-349">Espere hasta que la máquina virtual se reinicie y luego abra el archivo RDP de nuevo archivo para iniciar sesión en la máquina virtual mediante la cuenta **BUILTIN\AzureAdmin**.</span><span class="sxs-lookup"><span data-stu-id="2f171-349">Wait until the virtual machine restarts, and then open the RDP file again to sign in to the virtual machine by using the **BUILTIN\AzureAdmin** account.</span></span>
2. <span data-ttu-id="2f171-350">En **Administrador de servidores**, haga clic en **Herramientas** > **Administración de equipos**.</span><span class="sxs-lookup"><span data-stu-id="2f171-350">In **Server Manager** click **Tools** > **Computer Management**.</span></span>
   
    ![Administración de equipos](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784630.png)
3. <span data-ttu-id="2f171-352">En el cuadro de diálogo **Administración de equipos**, expanda **Usuarios y grupos locales** y luego haga clic en **Grupos**.</span><span class="sxs-lookup"><span data-stu-id="2f171-352">In the **Computer Management** dialog box, expand **Local Users and Groups**, and then click **Groups**.</span></span>
4. <span data-ttu-id="2f171-353">Haga doble clic en el grupo **Administradores** .</span><span class="sxs-lookup"><span data-stu-id="2f171-353">Double-click the **Administrators** group.</span></span>
5. <span data-ttu-id="2f171-354">En el cuadro de diálogo **Propiedades de administradores**, haga clic en el botón **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-354">In the **Administrators Properties** dialog box, click the **Add** button.</span></span>
6. <span data-ttu-id="2f171-355">Especifique el usuario **CORP\Install** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-355">Enter the user **CORP\Install**, and then click **OK**.</span></span> <span data-ttu-id="2f171-356">Cuando se le pidan las credenciales, use la cuenta **AzureAdmin** con la contraseña **Contoso!000**.</span><span class="sxs-lookup"><span data-stu-id="2f171-356">When prompted for credentials, use the **AzureAdmin** account with the **Contoso!000** password.</span></span>
7. <span data-ttu-id="2f171-357">Haga clic en **Aceptar** para cerrar el cuadro de diálogo **Propiedades de administradores**.</span><span class="sxs-lookup"><span data-stu-id="2f171-357">Click **OK** to close the **Administrator Properties** dialog box.</span></span>

### <a name="add-the-failover-clustering-feature-to-each-virtual-machine"></a><span data-ttu-id="2f171-358">Adición de la característica Clústeres de conmutación por error a todas las máquinas virtuales</span><span class="sxs-lookup"><span data-stu-id="2f171-358">Add the Failover Clustering feature to each virtual machine</span></span>
1. <span data-ttu-id="2f171-359">En el panel **Administrador del servidor** haga clic en **Agregar roles y características**.</span><span class="sxs-lookup"><span data-stu-id="2f171-359">In the **Server Manager** dashboard, click **Add roles and features**.</span></span>
2. <span data-ttu-id="2f171-360">En el **Asistente para agregar roles y características**, haga clic en **Siguiente** hasta llegar a la página **Características**.</span><span class="sxs-lookup"><span data-stu-id="2f171-360">In the **Add Roles and Features Wizard**, click **Next** until you get to the **Features** page.</span></span>
3. <span data-ttu-id="2f171-361">Seleccione **Clústeres de conmutación por error**.</span><span class="sxs-lookup"><span data-stu-id="2f171-361">Select **Failover Clustering**.</span></span> <span data-ttu-id="2f171-362">Cuando se le solicite, agregue otras las características dependientes.</span><span class="sxs-lookup"><span data-stu-id="2f171-362">When prompted, add other dependent features.</span></span>
   
    ![Adición de la característica Clústeres de conmutación por error a la máquina virtual](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784631.png)
4. <span data-ttu-id="2f171-364">Haga clic en **Siguiente** y después en **Instalar** en la página **Confirmación**.</span><span class="sxs-lookup"><span data-stu-id="2f171-364">Click **Next**, and then click **Install** on the **Confirmation** page.</span></span>
5. <span data-ttu-id="2f171-365">Cuando la instalación de la característica **Clústeres de conmutación por error** esté finalizada, haga clic en **Cerrar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-365">When the **Failover Clustering** feature installation is finished, click **Close**.</span></span>
6. <span data-ttu-id="2f171-366">Cierre sesión en la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="2f171-366">Sign out of the virtual machine.</span></span>
7. <span data-ttu-id="2f171-367">Repita los pasos de esta sección para los tres servidores: **ContosoWSFCNode**, **ContosoSQL1** y **ContosoSQL2**.</span><span class="sxs-lookup"><span data-stu-id="2f171-367">Repeat the steps in this section for all three servers: **ContosoWSFCNode**, **ContosoSQL1**, and **ContosoSQL2**.</span></span>

<span data-ttu-id="2f171-368">Ahora se aprovisionan máquinas virtuales de SQL Server y se ejecutan, pero cada una tiene las opciones predeterminadas para SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-368">The SQL Server virtual machines are now provisioned and running, but each has the default options for SQL Server.</span></span>

## <a name="create-the-failover-cluster"></a><span data-ttu-id="2f171-369">Creación del clúster de conmutación por error</span><span class="sxs-lookup"><span data-stu-id="2f171-369">Create the failover cluster</span></span>
<span data-ttu-id="2f171-370">En esta sección, cree el clúster de conmutación por error que hospedará el grupo de disponibilidad que creará más adelante.</span><span class="sxs-lookup"><span data-stu-id="2f171-370">In this section, you create the failover cluster that will host the availability group that you will create later.</span></span> <span data-ttu-id="2f171-371">Por ahora, debería haber hecho lo siguiente para cada una de las tres máquinas virtuales que se usarán en el clúster de conmutación por error:</span><span class="sxs-lookup"><span data-stu-id="2f171-371">By now, you should have done the following to each of the three virtual machines that you will use in the failover cluster:</span></span>

* <span data-ttu-id="2f171-372">Aprovisionamiento completo de la máquina virtual en Azure.</span><span class="sxs-lookup"><span data-stu-id="2f171-372">Fully provisioned the virtual machine in Azure</span></span>
* <span data-ttu-id="2f171-373">Máquina virtual unida al dominio.</span><span class="sxs-lookup"><span data-stu-id="2f171-373">Joined the virtual machine to the domain</span></span>
* <span data-ttu-id="2f171-374">Se ha agregado **CORP\Install** al grupo de administradores locales</span><span class="sxs-lookup"><span data-stu-id="2f171-374">Added **CORP\Install** to the local Administrators group</span></span>
* <span data-ttu-id="2f171-375">Se agregó la característica Clústeres de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="2f171-375">Added the failover clustering feature</span></span>

<span data-ttu-id="2f171-376">Todos estos son los requisitos previos en cada máquina virtual para que pueda unirse al clúster de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="2f171-376">All these are prerequisites on each virtual machine before you can join it to the failover cluster.</span></span>

<span data-ttu-id="2f171-377">Además, tenga en cuenta que la red virtual de Azure no se comporta de la misma manera que una red local.</span><span class="sxs-lookup"><span data-stu-id="2f171-377">Also, note that the Azure virtual network does not behave in the same way as an on-premises network.</span></span> <span data-ttu-id="2f171-378">Tendrá que crear el clúster en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f171-378">You need to create the cluster in the following order:</span></span>

1. <span data-ttu-id="2f171-379">Cree un clúster de nodo único en un nodo (**ContosoSQL1**).</span><span class="sxs-lookup"><span data-stu-id="2f171-379">Create a single-node cluster on one node (**ContosoSQL1**).</span></span>
2. <span data-ttu-id="2f171-380">Modifique la dirección IP del clúster en una dirección IP sin usar (**10.10.2.101**).</span><span class="sxs-lookup"><span data-stu-id="2f171-380">Modify the cluster IP address to an unused IP address (**10.10.2.101**).</span></span>
3. <span data-ttu-id="2f171-381">Ponga el nombre de clúster en línea.</span><span class="sxs-lookup"><span data-stu-id="2f171-381">Bring the cluster name online.</span></span>
4. <span data-ttu-id="2f171-382">Agregue los demás nodos (**ContosoSQL2** y **ContosoWSFCNode**).</span><span class="sxs-lookup"><span data-stu-id="2f171-382">Add the other nodes (**ContosoSQL2** and **ContosoWSFCNode**).</span></span>

<span data-ttu-id="2f171-383">Utilice los pasos siguientes para completar las tareas que configuran totalmente el clúster.</span><span class="sxs-lookup"><span data-stu-id="2f171-383">Use the following steps to complete the tasks that fully configure the cluster.</span></span>

1. <span data-ttu-id="2f171-384">Abra el archivo RDP de **ContosoSQL1** e inicie sesión con la cuenta de dominio **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="2f171-384">Open the RDP file for **ContosoSQL1**, and sign in by using the domain account **CORP\Install**.</span></span>
2. <span data-ttu-id="2f171-385">En el panel **Administrador del servidor**, haga clic en **Herramientas** > **Administrador de clústeres de conmutación por error**.</span><span class="sxs-lookup"><span data-stu-id="2f171-385">In the **Server Manager** dashboard, click **Tools** > **Failover Cluster Manager**.</span></span>
3. <span data-ttu-id="2f171-386">En el panel izquierdo, haga clic con el botón derecho en **Administrador de clústeres de conmutación por error** y, después, haga clic en **Crear un clúster** en la siguiente captura de pantalla.</span><span class="sxs-lookup"><span data-stu-id="2f171-386">In the left pane, right-click **Failover Cluster Manager**, and then click **Create a Cluster**, as shown in the following screenshot.</span></span>
   
    ![Crear clúster](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784632.png)
4. <span data-ttu-id="2f171-388">En el Asistente para crear clúster, cree un clúster de un solo nodo avanzando por las páginas y con la configuración de la tabla siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f171-388">In the Create Cluster Wizard, create a one-node cluster by stepping through the pages and using the settings in the following table:</span></span>
   
   | <span data-ttu-id="2f171-389">Page</span><span class="sxs-lookup"><span data-stu-id="2f171-389">Page</span></span> | <span data-ttu-id="2f171-390">Configuración</span><span class="sxs-lookup"><span data-stu-id="2f171-390">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="2f171-391">Antes de empezar</span><span class="sxs-lookup"><span data-stu-id="2f171-391">Before You Begin</span></span> |<span data-ttu-id="2f171-392">Usar predeterminados</span><span class="sxs-lookup"><span data-stu-id="2f171-392">Use defaults</span></span> |
   | <span data-ttu-id="2f171-393">Seleccionar servidores</span><span class="sxs-lookup"><span data-stu-id="2f171-393">Select Servers</span></span> |<span data-ttu-id="2f171-394">Escriba **ContosoSQL1** en **Especifique el nombre del servidor** y haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-394">Type **ContosoSQL1** in **Enter server name** and click **Add**</span></span> |
   | <span data-ttu-id="2f171-395">Advertencia de validación</span><span class="sxs-lookup"><span data-stu-id="2f171-395">Validation Warning</span></span> |<span data-ttu-id="2f171-396">Seleccione **No. No necesito compatibilidad con Microsoft para este clúster y por tanto no deseo ejecutar las pruebas de validación. Al hacer clic en Siguiente, continuar con la creación del clúster**.</span><span class="sxs-lookup"><span data-stu-id="2f171-396">Select **No. I do not require support from Microsoft for this cluster, and therefore do not want to run the validation tests. When I click Next, continue creating the cluster**.</span></span> |
   | <span data-ttu-id="2f171-397">Punto de acceso para administrar el clúster</span><span class="sxs-lookup"><span data-stu-id="2f171-397">Access Point for Administering the Cluster</span></span> |<span data-ttu-id="2f171-398">Escriba **Cluster1** en **Nombre de clúster**</span><span class="sxs-lookup"><span data-stu-id="2f171-398">Type **Cluster1** in **Cluster Name**</span></span> |
   | <span data-ttu-id="2f171-399">Confirmación</span><span class="sxs-lookup"><span data-stu-id="2f171-399">Confirmation</span></span> |<span data-ttu-id="2f171-400">Use los valores predeterminados a menos que use Espacios de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="2f171-400">Use defaults unless you are using Storage Spaces.</span></span> <span data-ttu-id="2f171-401">Consulte la advertencia que sigue a esta tabla.</span><span class="sxs-lookup"><span data-stu-id="2f171-401">See the warning following this table.</span></span> |
   
   > [!WARNING]
   > <span data-ttu-id="2f171-402">Si está usando [Espacios de almacenamiento](https://technet.microsoft.com/library/hh831739), que agrupa varios discos en grupos de almacenamiento, tiene que desactivar la casilla **Agregar todo el almacenamiento apto al clúster** en la página **Confirmación**.</span><span class="sxs-lookup"><span data-stu-id="2f171-402">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear the **Add all eligible storage to the cluster** check box on the **Confirmation** page.</span></span> <span data-ttu-id="2f171-403">Si no desactiva esta opción, los discos virtuales se desasociarán durante el proceso de agrupación en clústeres.</span><span class="sxs-lookup"><span data-stu-id="2f171-403">If you do not clear this option, the virtual disks will be detached during the clustering process.</span></span> <span data-ttu-id="2f171-404">Como resultado, tampoco aparecerán en el Administrador de discos o el explorador hasta que se quiten los espacios de almacenamiento del clúster y se vuelvan a asociar mediante PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2f171-404">As a result, they will also not appear in Disk Manager or Explorer until the storage spaces are removed from the cluster and reattached by using PowerShell.</span></span>
   > 
   > 
5. <span data-ttu-id="2f171-405">En el panel izquierdo, expanda **Administrador de clústeres de conmutación por error** y, a continuación, haga clic en **Cluster1.corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="2f171-405">In the left pane, expand **Failover Cluster Manager**, and then click **Cluster1.corp.contoso.com**.</span></span>
6. <span data-ttu-id="2f171-406">En el panel central, desplácese hacia abajo hasta la sección **Recursos principales de clúster** y expanda los detalles de **Nombre: Cluster1**.</span><span class="sxs-lookup"><span data-stu-id="2f171-406">In the center pane, scroll down to the **Cluster Core Resources** section, and expand the **Name: Clutser1** details.</span></span> <span data-ttu-id="2f171-407">Debería de ver los recursos **Nombre** y **Dirección IP** en el estado **Con error**.</span><span class="sxs-lookup"><span data-stu-id="2f171-407">You should see both the **Name** and the **IP Address** resources in the **Failed** state.</span></span> <span data-ttu-id="2f171-408">El recurso de dirección IP no se puede poner en línea porque al clúster se le asigna la misma dirección IP que la de la propia máquina, que es una dirección duplicada.</span><span class="sxs-lookup"><span data-stu-id="2f171-408">The IP address resource cannot be brought online because the cluster is assigned the same IP address as the machine itself, which is a duplicate address.</span></span>
7. <span data-ttu-id="2f171-409">Haga clic con el botón secundario en el recurso **dirección IP** erróneo y después haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="2f171-409">Right-click the failed **IP Address** resource, and then click **Properties**.</span></span>
   
    ![Propiedades de clúster](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784633.png)
8. <span data-ttu-id="2f171-411">Seleccione **Dirección IP estática**, especifique **10.10.2.101** en el cuadro de texto **Dirección** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-411">Select **Static IP Address**, specify **10.10.2.101** in the **Address** text box, and then click **OK**.</span></span>
9. <span data-ttu-id="2f171-412">En la sección **Recursos principales de clúster**, haga clic con el botón derecho en **Nombre: Cluster1** y luego haga clic en **Poner en línea**.</span><span class="sxs-lookup"><span data-stu-id="2f171-412">In the **Cluster Core Resources** section, right-click **Name: Cluster1**, and then click **Bring Online**.</span></span> <span data-ttu-id="2f171-413">Espere hasta que los recursos estén en línea.</span><span class="sxs-lookup"><span data-stu-id="2f171-413">Wait until both resources are online.</span></span> <span data-ttu-id="2f171-414">Cuando el recurso de nombre de clúster esté en línea, el servidor DC se actualiza con una nueva cuenta de equipo de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f171-414">When the cluster name resource comes online, the DC server is updated with a new Active Directory computer account.</span></span> <span data-ttu-id="2f171-415">Esta cuenta de Active Directory se usará para ejecutar más tarde el servicio de clúster del grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="2f171-415">This Active Directory account will be used to run the availability group clustered service later.</span></span>
10. <span data-ttu-id="2f171-416">Agregue los nodos restantes al clúster.</span><span class="sxs-lookup"><span data-stu-id="2f171-416">Add the remaining nodes to the cluster.</span></span> <span data-ttu-id="2f171-417">En el árbol del explorador, haga clic con el botón derecho en **Cluster1.corp.contoso.com** y luego haga clic en **Agregar nodo**, tal como se muestra en la captura de pantalla siguiente.</span><span class="sxs-lookup"><span data-stu-id="2f171-417">In the browser tree, right-click **Cluster1.corp.contoso.com**, and then click **Add Node**, as shown in the following screenshot.</span></span>
    
     ![Adición de un nodo al clúster](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784634.png)
11. <span data-ttu-id="2f171-419">En la página **Asistente para agregar nodo**, haga clic en **Siguiente** en la página **Seleccionar servidores**, agregue**ContosoSQL2** y **ContosoWSFCNode** a la lista escribiendo el nombre del servidor en **Especifique el nombre de servidor** y luego haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-419">In the **Add Node Wizard**, click **Next** on the **Select Servers** page, add **ContosoSQL2** and **ContosoWSFCNode** to the list by typing the server name in **Enter server name** and then clicking **Add**.</span></span> <span data-ttu-id="2f171-420">Cuando haya terminado, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-420">When you are done, click **Next**.</span></span>
12. <span data-ttu-id="2f171-421">En la página **Advertencia de validación**, haga clic en **No** (aunque en un escenario de producción debe realizar las pruebas de validación).</span><span class="sxs-lookup"><span data-stu-id="2f171-421">On the **Validation Warning** page, click **No**, although in a production scenario, you should perform the validation tests.</span></span> <span data-ttu-id="2f171-422">A continuación, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-422">Then, click **Next**.</span></span>
13. <span data-ttu-id="2f171-423">En la página **Confirmación**, haga clic en **Siguiente** para agregar los nodos.</span><span class="sxs-lookup"><span data-stu-id="2f171-423">On the **Confirmation** page, click **Next** to add the nodes.</span></span>
    
    > [!WARNING]
    > <span data-ttu-id="2f171-424">Si está usando [Espacios de almacenamiento](https://technet.microsoft.com/library/hh831739), que agrupa varios discos en grupos de almacenamiento, tiene que desactivar la casilla **Agregar todo el almacenamiento apto al clúster** .</span><span class="sxs-lookup"><span data-stu-id="2f171-424">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear the **Add all eligible storage to the cluster** check box.</span></span> <span data-ttu-id="2f171-425">Si no desactiva esta opción, los discos virtuales se desasociarán durante el proceso de agrupación en clústeres.</span><span class="sxs-lookup"><span data-stu-id="2f171-425">If you do not clear this option, the virtual disks will be detached during the clustering process.</span></span> <span data-ttu-id="2f171-426">Como resultado, tampoco aparecerán en el Administrador de discos o el explorador hasta que se quiten los espacios de almacenamiento del clúster y se vuelvan a asociar mediante PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2f171-426">As a result, they will also not appear in Disk Manager or Explorer until the storage spaces are removed from cluster and reattached using PowerShell.</span></span>
    > 
    > 
14. <span data-ttu-id="2f171-427">Una vez que se agregan los nodos al clúster, haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-427">After the nodes are added to the cluster, click **Finish**.</span></span> <span data-ttu-id="2f171-428">Ahora el Administrador de clústeres de conmutación por error tiene que indicar que el clúster tiene tres nodos y mostrarlos en una lista en el contenedor **Nodos** .</span><span class="sxs-lookup"><span data-stu-id="2f171-428">Failover Cluster Manager should now show that your cluster has three nodes and list them in the **Nodes** container.</span></span>
15. <span data-ttu-id="2f171-429">Cierre sesión en la sesión de escritorio remoto.</span><span class="sxs-lookup"><span data-stu-id="2f171-429">Sign out of the remote desktop session.</span></span>

## <a name="prepare-the-sql-server-instances-for-availability-groups"></a><span data-ttu-id="2f171-430">Preparación de las instancias de SQL Server para el grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="2f171-430">Prepare the SQL Server instances for availability groups</span></span>
<span data-ttu-id="2f171-431">En esta sección, hará lo siguiente tanto en **ContosoSQL1** como en **ContosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="2f171-431">In this section, you will do the following on both **ContosoSQL1** and **contosoSQL2**:</span></span>

* <span data-ttu-id="2f171-432">Agregar un inicio de sesión para **NT AUTHORITY\System** con un conjunto de permisos necesarios preestablecido para la instancia de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-432">Add a login for **NT AUTHORITY\System** with necessary permissions set to the default SQL Server instance.</span></span>
* <span data-ttu-id="2f171-433">Agregar **CORP\Install** como un rol sysadmin a la instancia de SQL Server predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2f171-433">Add **CORP\Install** as a sysadmin role to the default SQL Server instance.</span></span>
* <span data-ttu-id="2f171-434">Abra el firewall para el acceso remoto de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-434">Open the firewall for remote access of SQL Server.</span></span>
* <span data-ttu-id="2f171-435">Habilitar la característica Grupos de disponibilidad AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="2f171-435">Enable the Always On availability groups feature.</span></span>
* <span data-ttu-id="2f171-436">Cambiar la cuenta de servicio de SQL Server a **CORP\SQLSvc1** y **CORP\SQLSvc2**, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2f171-436">Change the SQL Server service account to **CORP\SQLSvc1** and **CORP\SQLSvc2**, respectively.</span></span>

<span data-ttu-id="2f171-437">Estas acciones pueden realizarse en cualquier orden.</span><span class="sxs-lookup"><span data-stu-id="2f171-437">These actions can be performed in any order.</span></span> <span data-ttu-id="2f171-438">No obstante, los pasos siguientes se seguirán en orden.</span><span class="sxs-lookup"><span data-stu-id="2f171-438">Nevertheless, the following steps will walk through them in order.</span></span> <span data-ttu-id="2f171-439">Siga los pasos para **ContosoSQL1** y **ContosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="2f171-439">Follow the steps for both **ContosoSQL1** and **ContosoSQL2**:</span></span>

1. <span data-ttu-id="2f171-440">Si no ha cerrado la sesión de escritorio remoto para la máquina virtual, hágalo ahora.</span><span class="sxs-lookup"><span data-stu-id="2f171-440">If you have not signed out of the remote desktop session for the virtual machine, do so now.</span></span>
2. <span data-ttu-id="2f171-441">Abra los archivos RDP para **ContosoSQL1** y **ContosoSQL2** e inicie sesión como **BUILTIN\AzureAdmin**.</span><span class="sxs-lookup"><span data-stu-id="2f171-441">Open the RDP files for **ContosoSQL1** and **ContosoSQL2**, and sign in as **BUILTIN\AzureAdmin**.</span></span>
3. <span data-ttu-id="2f171-442">Agregue **NT AUTHORITY\System** a los inicios de sesión de SQL Server con los permisos necesarios.</span><span class="sxs-lookup"><span data-stu-id="2f171-442">Add **NT AUTHORITY\System** to the SQL Server logins with necessary permissions.</span></span> <span data-ttu-id="2f171-443">Abra **SQL Server Management Studio**.</span><span class="sxs-lookup"><span data-stu-id="2f171-443">Open **SQL Server Management Studio**.</span></span>
4. <span data-ttu-id="2f171-444">Haga clic en **Conectar** para conectarse a la instancia predeterminada de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-444">Click **Connect** to connect to the default SQL Server instance.</span></span>
5. <span data-ttu-id="2f171-445">En el **Explorador de objetos**, expanda **Seguridad** y luego expanda **Inicios de sesión**.</span><span class="sxs-lookup"><span data-stu-id="2f171-445">In **Object Explorer**, expand **Security**, and then expand **Logins**.</span></span>
6. <span data-ttu-id="2f171-446">Haga clic con el botón derecho en el inicio de sesión **NT AUTHORITY\System** y luego haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="2f171-446">Right-click the **NT AUTHORITY\System** login, and then click **Properties**.</span></span>
7. <span data-ttu-id="2f171-447">En la página **Elementos protegibles**  para el servidor local, seleccione **Conceder** para los siguientes permisos y luego haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-447">On the **Securables** page, for the local server, select **Grant** for the following permissions, and then click **OK**.</span></span>
   
   * <span data-ttu-id="2f171-448">Modificar cualquier grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="2f171-448">Alter any availability group</span></span>
   * <span data-ttu-id="2f171-449">Conectar SQL</span><span class="sxs-lookup"><span data-stu-id="2f171-449">Connect SQL</span></span>
   * <span data-ttu-id="2f171-450">Ver estado del servidor</span><span class="sxs-lookup"><span data-stu-id="2f171-450">View server state</span></span>
8. <span data-ttu-id="2f171-451">Agregar **CORP\Install** como un rol **sysadmin** a la instancia de SQL Server predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2f171-451">Add **CORP\Install** as a **sysadmin** role to the default SQL Server instance.</span></span> <span data-ttu-id="2f171-452">En el **Explorador de objetos**, haga clic con el botón derecho en **Inicios de sesión** y luego en **Nuevo inicio de sesión**.</span><span class="sxs-lookup"><span data-stu-id="2f171-452">In **Object Explorer**, right-click **Logins**, and then click **New Login**.</span></span>
9. <span data-ttu-id="2f171-453">Escriba **CORP\Install** en **Nombre de inicio de sesión**.</span><span class="sxs-lookup"><span data-stu-id="2f171-453">Type **CORP\Install** in **Login name**.</span></span>
10. <span data-ttu-id="2f171-454">En la página **Roles de servidor**, seleccione **sysadmin** y luego haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-454">On the **Server Roles** page, select **sysadmin**, and then click **OK**.</span></span> <span data-ttu-id="2f171-455">Una vez creado el inicio de sesión, puede verlo expandiendo **Inicios de sesión** en **Explorador de objetos**.</span><span class="sxs-lookup"><span data-stu-id="2f171-455">After you create the login, you can see it by expanding **Logins** in **Object Explorer**.</span></span>
11. <span data-ttu-id="2f171-456">Para crear una regla de firewall para SQL Server, en la pantalla de **inicio**, abra **Firewall de Windows con seguridad avanzada**.</span><span class="sxs-lookup"><span data-stu-id="2f171-456">To create a firewall rule for SQL Server, on the **Start** screen, open **Windows Firewall with Advanced Security**.</span></span>
12. <span data-ttu-id="2f171-457">En el panel izquierdo, seleccione **Reglas de entrada**.</span><span class="sxs-lookup"><span data-stu-id="2f171-457">In the left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="2f171-458">En el panel derecho, haga clic en **Nueva regla**.</span><span class="sxs-lookup"><span data-stu-id="2f171-458">In the right pane, click **New Rule**.</span></span>
13. <span data-ttu-id="2f171-459">En la página **Tipo de regla**, haga clic en **Programa** > **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-459">On the **Rule Type** page, click **Program** > **Next**.</span></span>
14. <span data-ttu-id="2f171-460">En la página **Programa**, seleccione **Esta ruta de acceso del programa**, escriba **%ProgramFiles%\Microsoft SQL Server\MSSQL12. MSSQLSERVER\MSSQL\Binn\sqlservr.exe** en el cuadro de texto y luego haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-460">On the **Program** page, select **This program path**, type **%ProgramFiles%\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\sqlservr.exe** in the text box, and then click **Next**.</span></span> <span data-ttu-id="2f171-461">Si está siguiendo estas instrucciones, pero usa SQL Server 2012, el directorio de SQL Server es **MSSQL11. MSSQLSERVER**.</span><span class="sxs-lookup"><span data-stu-id="2f171-461">If you are following these directions but using SQL Server 2012, the SQL Server directory is **MSSQL11.MSSQLSERVER**.</span></span>
15. <span data-ttu-id="2f171-462">En la página **Acción**, mantenga seleccionado **Permitir la conexión** y luego haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-462">On the **Action** page, keep **Allow the connection** selected, and then click **Next**.</span></span>
16. <span data-ttu-id="2f171-463">En la página **Perfiles**, acepte la configuración predeterminada y luego haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-463">On the **Profile** page, accept the default settings, and then click **Next**.</span></span>
17. <span data-ttu-id="2f171-464">En la página **Nombre**, especifique el nombre de una regla, como **SQL Server (regla de programa)** en el cuadro de texto **Nombre** y haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-464">On the **Name** page, specify a rule name, such as **SQL Server (Program Rule)**, in the **Name** text box, then click **Finish**.</span></span>
18. <span data-ttu-id="2f171-465">Para habilitar la característica **Grupos de disponibilidad AlwaysOn**, en la pantalla de **inicio**, abra **Administrador de configuración de SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="2f171-465">To enable the **Always On Availability Groups** feature, on the **Start** screen, open **SQL Server Configuration Manager**.</span></span>
19. <span data-ttu-id="2f171-466">En el árbol del explorador, haga clic en **Servicios SQL Server**, luego haga clic con el botón derecho en el servicio **SQL Server (MSSQLSERVER)** y luego haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="2f171-466">In the browser tree, click **SQL Server Services**, right-click the **SQL Server (MSSQLSERVER)** service, and then click **Properties**.</span></span>
20. <span data-ttu-id="2f171-467">Haga clic en la pestaña **Alta disponibilidad AlwaysOn** y seleccione **Habilitar los grupos de disponibilidad de AlwaysOn**, tal como se muestra en la siguiente captura de pantalla, y haga clic en **Aplicar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-467">Click the **Always On High Availability** tab, select **Enable Always On Availability Groups**, as shown in the following screenshot, and then click **Apply**.</span></span> <span data-ttu-id="2f171-468">Haga clic en **Aceptar** en el cuadro de diálogo y no cierre el cuadro de diálogo **Propiedades** aún.</span><span class="sxs-lookup"><span data-stu-id="2f171-468">Click **OK** in the dialog box, and do not close the **Properties** dialog box yet.</span></span> <span data-ttu-id="2f171-469">Reiniciará el servicio SQL Server tras cambiar la cuenta de servicio.</span><span class="sxs-lookup"><span data-stu-id="2f171-469">You will restart the SQL Server service after you change the service account.</span></span>
    
     ![Habilitación de grupos de disponibilidad AlwaysOn](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665520.gif)
21. <span data-ttu-id="2f171-471">Para cambiar la cuenta de servicio de SQL Server, haga clic en la pestaña **Iniciar sesión**, escriba **CORP\SQLSvc1** (para **ContosoSQL1**) o **CORP\SQLSvc2** (para **ContosoSQL2**) en **Nombre de cuenta**, escriba y confirme la contraseña y luego haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-471">To change the SQL Server service account, click the **Log On** tab, type **CORP\SQLSvc1** (for **ContosoSQL1**) or **CORP\SQLSvc2** (for **ContosoSQL2**) in **Account Name**, fill in and confirm the password, and then click **OK**.</span></span>
22. <span data-ttu-id="2f171-472">En el cuadro de diálogo que se abre, haga clic en **Sí** para reiniciar el servicio de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-472">In the dialog box that opens, click **Yes** to restart the SQL Server service.</span></span> <span data-ttu-id="2f171-473">Después de reiniciar el servicio SQL Server, se aplican los cambios que realizó en el cuadro de diálogo **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="2f171-473">After the SQL Server service restarts, changes that you made in the **Properties** dialog box are effective.</span></span>
23. <span data-ttu-id="2f171-474">Cierre sesión en la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="2f171-474">Sign out of the virtual machines.</span></span>

## <a name="create-the-availability-group"></a><span data-ttu-id="2f171-475">Creación del grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="2f171-475">Create the availability group</span></span>
<span data-ttu-id="2f171-476">Ahora está en disposición de configurar un grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="2f171-476">You are now ready to configure an availability group.</span></span> <span data-ttu-id="2f171-477">A continuación se resume lo que debe hacer:</span><span class="sxs-lookup"><span data-stu-id="2f171-477">Below is an outline of what you will do:</span></span>

* <span data-ttu-id="2f171-478">Crear una nueva base de datos (**MyDB1**) en **ContosoSQL1**.</span><span class="sxs-lookup"><span data-stu-id="2f171-478">Create a new database (**MyDB1**) on **ContosoSQL1**.</span></span>
* <span data-ttu-id="2f171-479">Realizar una copia de seguridad completa y una copia de seguridad del registro de transacciones de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f171-479">Take both a full backup and a transaction log backup of the database.</span></span>
* <span data-ttu-id="2f171-480">Restaurar las copias de seguridad completas y de registro en **ContosoSQL2** con la opción **NORECOVERY**.</span><span class="sxs-lookup"><span data-stu-id="2f171-480">Restore the full and log backups to **ContosoSQL2** with the **NORECOVERY** option.</span></span>
* <span data-ttu-id="2f171-481">Crear el grupo de disponibilidad (**AG1**) con confirmación sincrónica, conmutación automática por error y réplicas secundarias legibles.</span><span class="sxs-lookup"><span data-stu-id="2f171-481">Create the availability group (**AG1**) with synchronous commit, automatic failover, and readable secondary replicas.</span></span>

### <a name="create-the-mydb1-database-on-contososql1"></a><span data-ttu-id="2f171-482">Creación de la base de datos de MyDB1 en ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="2f171-482">Create the MyDB1 database on ContosoSQL1</span></span>
1. <span data-ttu-id="2f171-483">Si no cerró aún las sesiones de escritorio remoto para **ContosoSQL1** y **ContosoSQL2**, hágalo ahora.</span><span class="sxs-lookup"><span data-stu-id="2f171-483">If you have not already signed out of the remote desktop sessions for **ContosoSQL1** and **ContosoSQL2**, do so now.</span></span>
2. <span data-ttu-id="2f171-484">Abra el archivo RDP para **ContosoSQL1** e inicie sesión como **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="2f171-484">Open the RDP file for **ContosoSQL1**, and sign in as **CORP\Install**.</span></span>
3. <span data-ttu-id="2f171-485">En el **Explorador de archivos**, en **\\C:**, cree un directorio denominado **backup**.</span><span class="sxs-lookup"><span data-stu-id="2f171-485">In **File Explorer**, under **C:\\**, create a directory named **backup**.</span></span> <span data-ttu-id="2f171-486">Usará este directorio para la copia de seguridad y restauración de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f171-486">You will use this directory to back up and restore your database.</span></span>
4. <span data-ttu-id="2f171-487">Haga clic con el botón derecho en el nuevo directorio, seleccione **Compartir con** y luego haga clic en **Personas específicas**, tal como se muestra en la siguiente captura de pantalla.</span><span class="sxs-lookup"><span data-stu-id="2f171-487">Right-click the new directory, point to **Share with**, and then click **Specific people**, as shown in the following screenshot.</span></span>
   
    ![Creación de una carpeta de copia de seguridad](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665521.gif)
5. <span data-ttu-id="2f171-489">Agregue **CORP\SQLSvc1** y luego asígnele el permiso de **lectura/escritura**.</span><span class="sxs-lookup"><span data-stu-id="2f171-489">Add **CORP\SQLSvc1**, and then give it the **Read/Write** permission.</span></span> <span data-ttu-id="2f171-490">Agregue **CORP\SQLSvc2** y luego asígnele el permiso de **lectura**, como se muestra en la siguiente captura de pantalla y, a continuación, haga clic en **Compartir**.</span><span class="sxs-lookup"><span data-stu-id="2f171-490">Add **CORP\SQLSvc2**, and then give it the **Read** permission, as shown in the following screenshot, and then click **Share**.</span></span> <span data-ttu-id="2f171-491">Una vez que se complete el proceso de uso compartido de archivos, haga clic en **Listo**.</span><span class="sxs-lookup"><span data-stu-id="2f171-491">After the file-sharing process is finished, click **Done**.</span></span>
   
    ![Concesión de permisos para la carpeta de copia de seguridad](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665522.gif)
6. <span data-ttu-id="2f171-493">Para crear la base de datos, desde el menú **Inicio**, abra **SQL Server Management Studio** y luego haga clic en **Conectar** para conectar con la instancia predeterminada de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-493">To create the database, from the **Start** menu, open **SQL Server Management Studio**, and then click **Connect** to connect to the default SQL Server instance.</span></span>
7. <span data-ttu-id="2f171-494">En el **Explorador de objetos**, haga clic con el botón derecho en **Bases de datos** y, después, haga clic en **Nueva base de datos**.</span><span class="sxs-lookup"><span data-stu-id="2f171-494">In **Object Explorer**, right-click **Databases**, and then click **New Database**.</span></span>
8. <span data-ttu-id="2f171-495">En **Nombre de base de datos**, escriba **MyDB1** y después haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-495">In **Database name**, type **MyDB1**, and then click **OK**.</span></span>

### <a name="make-a-full-backup-of-mydb1-and-restore-it-on-contososql2"></a><span data-ttu-id="2f171-496">Realización de una copia de seguridad completa de MyDB1 y restauración en ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="2f171-496">Make a full backup of MyDB1 and restore it on ContosoSQL2</span></span>
1. <span data-ttu-id="2f171-497">Para realizar una copia de seguridad completa de la base de datos, en el **Explorador de objetos**, expanda **Bases de datos**, luego haga clic con el botón derecho en **MyDB1**, seleccione **Tareas** y, finalmente, haga clic en **Copia de seguridad**.</span><span class="sxs-lookup"><span data-stu-id="2f171-497">To make a full backup of the database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point to **Tasks**, and then click **Back Up**.</span></span>
2. <span data-ttu-id="2f171-498">En la sección **Origen**, mantenga el **Tipo de copia de seguridad** establecido en **Completa**.</span><span class="sxs-lookup"><span data-stu-id="2f171-498">In the **Source** section, keep **Backup type** set to **Full**.</span></span> <span data-ttu-id="2f171-499">En la sección **Destino**, haga clic en **Quitar** para quitar la ruta de acceso del archivo predeterminado para el archivo de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="2f171-499">In the **Destination** section, click **Remove** to remove the default file path for the backup file.</span></span>
3. <span data-ttu-id="2f171-500">En la sección **Destino**, haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-500">In the **Destination** section, click **Add**.</span></span>
4. <span data-ttu-id="2f171-501">En el cuadro de texto **Nombre de archivo**, escriba  **\\ContosoSQL1\backup\MyDB1.bak**, haga clic en **Aceptar** y, a continuación, haga clic en **Aceptar** de nuevo para realizar la copias de seguridad de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f171-501">In the **File name** text box, type **\\ContosoSQL1\backup\MyDB1.bak**, click **OK**, and then click **OK** again to back up the database.</span></span> <span data-ttu-id="2f171-502">Cuando finalice la operación de copia de seguridad, vuelva a hacer clic en **Aceptar** para cerrar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="2f171-502">When the backup operation finishes, click **OK** again to close the dialog box.</span></span>
5. <span data-ttu-id="2f171-503">Para realizar una copia de seguridad de registro de transacciones de la base de datos, en el **Explorador de objetos**, expanda **Bases de datos**, luego haga clic con el botón derecho en **MyDB1**, seleccione **Tareas** y, finalmente, haga clic en **Copia de seguridad**.</span><span class="sxs-lookup"><span data-stu-id="2f171-503">To make a transaction log backup of the database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point to **Tasks**, and then click **Back Up**.</span></span>
6. <span data-ttu-id="2f171-504">En **Tipo de copia de seguridad**, seleccione **Registro de transacciones**.</span><span class="sxs-lookup"><span data-stu-id="2f171-504">In **Backup type**, select **Transaction Log**.</span></span> <span data-ttu-id="2f171-505">Mantenga la ruta de acceso al archivo de **Destino** establecida en la que ha especificado anteriormente y luego haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-505">Keep the **Destination** file path set to the one you specified earlier, and then click **OK**.</span></span> <span data-ttu-id="2f171-506">Una vez se complete la operación de copia de seguridad, haga clic de nuevo en **Aceptar** .</span><span class="sxs-lookup"><span data-stu-id="2f171-506">After the backup operation finishes, click **OK** again.</span></span>
7. <span data-ttu-id="2f171-507">Para restaurar las copias de seguridad de registro de transacciones y completas en **ContosoSQL2**, abra el archivo RDP para **ContosoSQL2** e inicie sesión como **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="2f171-507">To restore the full and transaction log backups on **ContosoSQL2**, open the RDP file for **ContosoSQL2**, and sign in as **CORP\Install**.</span></span> <span data-ttu-id="2f171-508">Deje abierta la sesión de escritorio remoto para **ContosoSQL1** .</span><span class="sxs-lookup"><span data-stu-id="2f171-508">Leave the remote desktop session for **ContosoSQL1** open.</span></span>
8. <span data-ttu-id="2f171-509">Desde el menú **Inicio**, abra **SQL Server Management Studio** y luego haga clic en **Conectar** para conectar con la instancia predeterminada de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2f171-509">From the **Start** menu, open **SQL Server Management Studio**, and then click **Connect** to connect to the default SQL Server instance.</span></span>
9. <span data-ttu-id="2f171-510">En el **Explorador de objetos**, haga clic con el botón derecho en **Bases de datos** y luego en **Restaurar base de datos**.</span><span class="sxs-lookup"><span data-stu-id="2f171-510">In **Object Explorer**, right-click **Databases**, and then click **Restore Database**.</span></span>
10. <span data-ttu-id="2f171-511">En la sección **Origen**, seleccione **Dispositivo** y haga clic en el botón de puntos suspensivos **...**</span><span class="sxs-lookup"><span data-stu-id="2f171-511">In the **Source** section, select **Device**, and click the ellipsis **…**</span></span> <span data-ttu-id="2f171-512">.</span><span class="sxs-lookup"><span data-stu-id="2f171-512">button.</span></span>
11. <span data-ttu-id="2f171-513">En **Seleccionar dispositivos de copia de seguridad**, haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-513">In **Select backup devices**, click **Add**.</span></span>
12. <span data-ttu-id="2f171-514">En la **ubicación del archivo de copia de seguridad**, escriba **\\ContosoSQL1\backup**, haga clic en **Actualizar**, a continuación, seleccione **MyDB1.bak** y haga clic en **Aceptar**, luego haga clic de nuevo en **Aceptar** .</span><span class="sxs-lookup"><span data-stu-id="2f171-514">In **Backup file location**, type **\\ContosoSQL1\backup**, click **Refresh**, select **MyDB1.bak**, click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="2f171-515">Ahora debería ver la copia de seguridad completa y la copia de seguridad del registro en el panel **Conjuntos de copia de seguridad para restaurar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-515">You should now see the full backup and the log backup in the **Backup sets to restore** pane.</span></span>
13. <span data-ttu-id="2f171-516">Vaya a la página **Opciones**, seleccione **RESTAURAR CON NORECOVERY** en **Estado de recuperación** y, a continuación, haga clic en **Aceptar** para restaurar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f171-516">Go to the **Options** page, select **RESTORE WITH NORECOVERY** in **Recovery state**, and then click **OK** to restore the database.</span></span> <span data-ttu-id="2f171-517">Una vez se complete la operación de restauración, haga clic en **Aceptar** .</span><span class="sxs-lookup"><span data-stu-id="2f171-517">After the restore operation finishes, click **OK**.</span></span>

### <a name="create-the-availability-group"></a><span data-ttu-id="2f171-518">Creación del grupo de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="2f171-518">Create the availability group</span></span>
1. <span data-ttu-id="2f171-519">Vuelva a la sesión de escritorio remoto para **ContosoSQL1**.</span><span class="sxs-lookup"><span data-stu-id="2f171-519">Go back to the remote desktop session for **ContosoSQL1**.</span></span> <span data-ttu-id="2f171-520">En el **Explorador de objetos** de SQL Server Management Studio, haga clic con el botón derecho en **Alta disponibilidad AlwaysOn** y luego haga clic en **Asistente para nuevo grupo de disponibilidad** como se muestra en la siguiente captura de pantalla.</span><span class="sxs-lookup"><span data-stu-id="2f171-520">In **Object Explorer** in SQL Server Management Studio, right-click **Always On High Availability**, and then click **New Availability Group Wizard**, as shown in the following screenshot.</span></span>
   
    ![Inicio del Asistente para nuevo grupo de disponibilidad](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665523.gif)
2. <span data-ttu-id="2f171-522">En la página **Introducción**, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-522">On the **Introduction** page, click **Next**.</span></span> <span data-ttu-id="2f171-523">En la página **Especificar nombre de grupo de disponibilidad**, escriba **AG1** en **Nombre del grupo de disponibilidad** y luego vuelva a hacer clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-523">On the **Specify Availability Group Name** page, type **AG1** in **Availability group name**, then click **Next** again.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Especificación del nombre de grupo de disponibilidad](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665524.gif)
3. <span data-ttu-id="2f171-525">En la página **Seleccionar bases de datos**, seleccione **MyDB1** y luego haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-525">On the **Select Databases** page, select **MyDB1**, and then click **Next**.</span></span> <span data-ttu-id="2f171-526">La base de datos cumple los requisitos previos para un grupo de disponibilidad porque ha realizado al menos una copia de seguridad completa en la réplica principal pretendida.</span><span class="sxs-lookup"><span data-stu-id="2f171-526">The database meets the prerequisites for an availability group because you have taken at least one full backup on the intended primary replica.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Selección de base de datos](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665525.gif)
4. <span data-ttu-id="2f171-528">En la página **Especificar réplicas**, haga clic en **Agregar réplica**.</span><span class="sxs-lookup"><span data-stu-id="2f171-528">on the **Specify Replicas** page, click **Add Replica**.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Especificación de réplicas](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665526.gif)
5. <span data-ttu-id="2f171-530">En el cuadro de diálogo **Conectar al servidor**, escriba **ContosoSQL2** en **nombre del servidor** y, a continuación, haga clic en **Conectar**.</span><span class="sxs-lookup"><span data-stu-id="2f171-530">In the **Connect to Server** dialog box, type **ContosoSQL2** in **Server name**, and then click **Connect**.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Conexión al servidor](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665527.gif)
6. <span data-ttu-id="2f171-532">De vuelta en la página **Especificar réplicas**, ahora debería ver **ContosoSQL2** en **Réplicas de disponibilidad**.</span><span class="sxs-lookup"><span data-stu-id="2f171-532">Back on the **Specify Replicas** page, you should now see **ContosoSQL2** listed in **Available Replicas**.</span></span> <span data-ttu-id="2f171-533">Configure las réplicas como se muestra en la siguiente captura de pantalla.</span><span class="sxs-lookup"><span data-stu-id="2f171-533">Configure the replicas as shown in the following screenshot.</span></span> <span data-ttu-id="2f171-534">Cuando haya terminado, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-534">When you are finished, click **Next**.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Especificación de réplicas (completo)](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665528.gif)
7. <span data-ttu-id="2f171-536">En la página **Seleccionar sincronización de datos iniciales**, seleccione **Solo unión** y luego haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-536">On the **Select Initial Data Synchronization** page, select **Join only**, and then click **Next**.</span></span> <span data-ttu-id="2f171-537">Ya realizó la sincronización de datos de forma manual cuando efectuó las copias de seguridad completas y de transacciones en **ContosoSQL1** y las restauró en **ContosoSQL2**.</span><span class="sxs-lookup"><span data-stu-id="2f171-537">You already performed data synchronization manually when you made the full and transaction backups on **ContosoSQL1** and restored them on **ContosoSQL2**.</span></span> <span data-ttu-id="2f171-538">Puede elegir no realizar las operaciones de copia de seguridad y restauración en la base de datos y seleccionar **Total** para permitir que el Asistente del nuevo grupo de disponibilidad realice la sincronización de datos en su lugar.</span><span class="sxs-lookup"><span data-stu-id="2f171-538">You can choose not to perform the backup and restore operations on your database and instead select **Full** to let the New Availability Group Wizard perform data synchronization for you.</span></span> <span data-ttu-id="2f171-539">Sin embargo, no se recomienda esta opción para bases de datos de gran tamaño como las que se encuentran en algunas empresas.</span><span class="sxs-lookup"><span data-stu-id="2f171-539">However, we do not recommend this option for very large databases that are found in some enterprises.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad, seleccionar sincronización de datos iniciales](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665529.gif)
8. <span data-ttu-id="2f171-541">En la página **Validación**, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="2f171-541">On the **Validation** page, click **Next**.</span></span> <span data-ttu-id="2f171-542">Esta página debe tener un aspecto similar a la siguiente captura de pantalla.</span><span class="sxs-lookup"><span data-stu-id="2f171-542">This page should look similar to the following screenshot.</span></span> <span data-ttu-id="2f171-543">Hay una advertencia para la configuración del agente de escucha porque no ha configurado un agente de escucha de grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="2f171-543">There is a warning for the listener configuration because you have not configured an availability group listener.</span></span> <span data-ttu-id="2f171-544">Puede omitir esta advertencia, ya que este tutorial no configura un agente de escucha.</span><span class="sxs-lookup"><span data-stu-id="2f171-544">You can ignore this warning, because this tutorial does not configure a listener.</span></span> <span data-ttu-id="2f171-545">Para configurar el agente de escucha después de completar este tutorial, consulte [Configuración de un agente de escucha con ILB para grupos de disponibilidad AlwaysOn en Azure](../classic/ps-sql-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-545">To configure the listener after you complete this tutorial, see [Configure an ILB listener for Always On Availability Groups in Azure](../classic/ps-sql-int-listener.md).</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Validación](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665530.gif)
9. <span data-ttu-id="2f171-547">En la página **Resumen**, haga clic en **Finalizar** y espere hasta que el asistente configure el nuevo grupo de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="2f171-547">On the **Summary** page, click **Finish**, and then wait while the wizard configures the new availability group.</span></span> <span data-ttu-id="2f171-548">En la página **Progreso**, puede hacer clic en **Más detalles** para ver el progreso detallado.</span><span class="sxs-lookup"><span data-stu-id="2f171-548">On the **Progress** page, you can click **More details** to view the detailed progress.</span></span> <span data-ttu-id="2f171-549">Cuando el asistente termine, inspeccione la página **Resultados** para comprobar que se ha creado correctamente el grupo de disponibilidad, como se muestra en la siguiente captura de pantalla, y después haga clic en **Cerrar** para salir del asistente.</span><span class="sxs-lookup"><span data-stu-id="2f171-549">After the wizard finishes, inspect the **Results** page to verify that the availability group is successfully created, as shown in the following screenshot, and then click **Close** to exit the wizard.</span></span>
   
    ![Asistente para nuevo grupo de disponibilidad: Resultados](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665531.gif)
10. <span data-ttu-id="2f171-551">En el **Explorador de objetos**, expanda **Alta disponibilidad AlwaysOn** y después, expanda **Grupos de disponibilidad**.</span><span class="sxs-lookup"><span data-stu-id="2f171-551">In **Object Explorer**, expand **Always On High Availability**, and then expand **Availability Groups**.</span></span> <span data-ttu-id="2f171-552">Ahora debería de ver el nuevo grupo de disponibilidad en este contenedor.</span><span class="sxs-lookup"><span data-stu-id="2f171-552">You should now see the new availability group in this container.</span></span> <span data-ttu-id="2f171-553">Haga clic con el botón derecho en **AG1 (principal)** y luego en **Mostrar panel**.</span><span class="sxs-lookup"><span data-stu-id="2f171-553">Right-click **AG1 (Primary)**, and then click **Show Dashboard**.</span></span>
    
     ![Visualización del panel del grupo de disponibilidad](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665532.gif)
11. <span data-ttu-id="2f171-555">El **Panel AlwaysOn** debería ser similar al que se muestra en la captura de pantalla siguiente.</span><span class="sxs-lookup"><span data-stu-id="2f171-555">Your **Always On Dashboard** should look similar to the one in the following screenshot.</span></span> <span data-ttu-id="2f171-556">Puede ver las réplicas, el modo de conmutación por error de cada réplica y el estado de sincronización.</span><span class="sxs-lookup"><span data-stu-id="2f171-556">You can see the replicas, the failover mode of each replica, and the synchronization state.</span></span>
    
     ![Panel del grupo de disponibilidad](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665533.gif)
12. <span data-ttu-id="2f171-558">Vuelva a **Administrador del servidor**, haga clic en **Herramientas** y, después, inicie **Administrador de clústeres de conmutación por error**.</span><span class="sxs-lookup"><span data-stu-id="2f171-558">Return to **Server Manager**, click **Tools**, and then open **Failover Cluster Manager**.</span></span>
13. <span data-ttu-id="2f171-559">Expanda **Cluster1.corp.contoso.com** y expanda **Servicios y aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="2f171-559">Expand **Cluster1.corp.contoso.com**, and then expand **Services and applications**.</span></span> <span data-ttu-id="2f171-560">Elija **Roles** y tenga en cuenta que se ha creado el rol del grupo de disponibilidad **AG1**.</span><span class="sxs-lookup"><span data-stu-id="2f171-560">Select **Roles** and note that the **AG1** availability group role has been created.</span></span> <span data-ttu-id="2f171-561">Tenga en cuenta que AG1 no tiene ninguna dirección IP por la que los clientes de la base de datos puedan conectarse al grupo de disponibilidad, porque no configuró ningún agente de escucha.</span><span class="sxs-lookup"><span data-stu-id="2f171-561">Note that AG1 does not have an IP address by which database clients can connect to the availability group, because you did not configure a listener.</span></span> <span data-ttu-id="2f171-562">Puede conectarse directamente al nodo principal para las operaciones de lectura y escritura y al nodo secundario para las consultas de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="2f171-562">You can connect directly to the primary node for read-write operations and the secondary node for read-only queries.</span></span>
    
     ![Grupo de disponibilidad en el administrador de clústeres de conmutación por error.](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665534.gif)

> [!WARNING]
> <span data-ttu-id="2f171-564">No trate de realizar una conmutación por error del grupo de disponibilidad desde el Administrador de clústeres de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="2f171-564">Do not try to fail over the availability group from the Failover Cluster Manager.</span></span> <span data-ttu-id="2f171-565">Todas las operaciones de conmutación por error deben realizarse desde el **Panel AlwaysOn** de SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="2f171-565">All failover operations should be performed from within **Always On Dashboard** in SQL Server Management Studio.</span></span> <span data-ttu-id="2f171-566">Para obtener más información, consulte el artículo de [restricciones en el uso del Administrador de clústeres de conmutación por error con grupos de disponibilidad](https://msdn.microsoft.com/library/ff929171.aspx).</span><span class="sxs-lookup"><span data-stu-id="2f171-566">For more information, see [Restrictions on Using The Failover Cluster Manager with Availability Groups](https://msdn.microsoft.com/library/ff929171.aspx).</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="2f171-567">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="2f171-567">Next steps</span></span>
<span data-ttu-id="2f171-568">Ha implementado correctamente SQL Server AlwaysOn mediante la creación de un grupo de disponibilidad en Azure.</span><span class="sxs-lookup"><span data-stu-id="2f171-568">You have now successfully implemented SQL Server Always On by creating an availability group in Azure.</span></span> <span data-ttu-id="2f171-569">Para configurar un agente de escucha para este grupo de disponibilidad, consulte [Configuración de un agente de escucha con ILB para grupos de disponibilidad AlwaysOn en Azure](../classic/ps-sql-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-569">To configure a listener for this availability group, see [Configure an ILB listener for Always On availability groups in Azure](../classic/ps-sql-int-listener.md).</span></span>

<span data-ttu-id="2f171-570">Para obtener más información sobre el uso de SQL Server en Azure, consulte [SQL Server en Máquinas virtuales de Azure](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2f171-570">For other information about using SQL Server in Azure, see [SQL Server on Azure Virtual Machines](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

