---
title: "Solución de problemas de implementación de máquinas virtuales Windows en el modelo clásico | Microsoft Docs"
description: "Solución de problemas de implementación clásica al crear una nueva máquina virtual de Windows en Azure"
services: virtual-machines-windows
documentationcenter: 
author: JiangChen79
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 9f01d237-ba39-4c32-b72d-18f5f505d43a
ms.service: virtual-machines-windows
ms.workload: na
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 12/16/2016
ms.author: cjiang
ms.openlocfilehash: 990914e3d9541e8574ce6ba0bf6c996cb394470a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-classic-deployment-issues-with-creating-a-new-windows-virtual-machine-in-azure"></a><span data-ttu-id="a6cba-103">Solución de problemas de la implementación clásica con la creación de una máquina virtual de Windows en Azure</span><span class="sxs-lookup"><span data-stu-id="a6cba-103">Troubleshoot classic deployment issues with creating a new Windows virtual machine in Azure</span></span>
[!INCLUDE [virtual-machines-troubleshoot-deployment-new-vm-selectors](../../../../includes/virtual-machines-windows-troubleshoot-deployment-new-vm-selectors-include.md)]

[!INCLUDE [virtual-machines-troubleshoot-deployment-new-vm-opening](../../../../includes/virtual-machines-troubleshoot-deployment-new-vm-opening-include.md)]

> [!IMPORTANT] 
> <span data-ttu-id="a6cba-104">Azure tiene dos modelos de implementación diferentes para crear recursos y trabajar con ellos: [Resource Manager y el clásico](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="a6cba-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="a6cba-105">En este artículo se trata el modelo de implementación clásico.</span><span class="sxs-lookup"><span data-stu-id="a6cba-105">This article covers using the Classic deployment model.</span></span> <span data-ttu-id="a6cba-106">Microsoft recomienda que las implementaciones más recientes usen el modelo del Administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="a6cba-106">Microsoft recommends that most new deployments use the Resource Manager model.</span></span> <span data-ttu-id="a6cba-107">Para la versión de Resource Manager de este artículo, consulte [aquí](../../virtual-machines-windows-troubleshoot-deployment-new-vm.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="a6cba-107">For the Resource Manager version of this article, see [here](../../virtual-machines-windows-troubleshoot-deployment-new-vm.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

[!INCLUDE [support-disclaimer](../../../../includes/support-disclaimer.md)]

## <a name="collect-audit-logs"></a><span data-ttu-id="a6cba-108">Recopilación de registros de auditoría</span><span class="sxs-lookup"><span data-stu-id="a6cba-108">Collect audit logs</span></span>
<span data-ttu-id="a6cba-109">Para iniciar la solución de problemas, recopile los registros de auditoría para identificar el error asociado con el problema.</span><span class="sxs-lookup"><span data-stu-id="a6cba-109">To start troubleshooting, collect the audit logs to identify the error associated with the issue.</span></span>

<span data-ttu-id="a6cba-110">En Azure Portal, haga clic en **Examinar** > **Máquinas virtuales** > *su máquina virtual de Windows* > **Configuración** > **Registros de auditoría**.</span><span class="sxs-lookup"><span data-stu-id="a6cba-110">In the Azure portal, click **Browse** > **Virtual machines** > *your Windows virtual machine* > **Settings** > **Audit logs**.</span></span>

[!INCLUDE [virtual-machines-troubleshoot-deployment-new-vm-issue1](../../../../includes/virtual-machines-troubleshoot-deployment-new-vm-issue1-include.md)]

[!INCLUDE [virtual-machines-windows-troubleshoot-deployment-new-vm-table](../../../../includes/virtual-machines-windows-troubleshoot-deployment-new-vm-table.md)]

<span data-ttu-id="a6cba-111">**Y:** si el sistema operativo es Windows generalizado y se carga o captura con la configuración generalizada, no habrá errores.</span><span class="sxs-lookup"><span data-stu-id="a6cba-111">**Y:** If the OS is Windows generalized, and it is uploaded and/or captured with the generalized setting, then there won’t be any errors.</span></span> <span data-ttu-id="a6cba-112">De forma similar, si el sistema operativo es Windows especializado y se carga o captura con la configuración especializada, no habrá errores.</span><span class="sxs-lookup"><span data-stu-id="a6cba-112">Similarly, if the OS is Windows specialized, and it is uploaded and/or captured with the specialized setting, then there won’t be any errors.</span></span>

<span data-ttu-id="a6cba-113">**Errores de carga:**</span><span class="sxs-lookup"><span data-stu-id="a6cba-113">**Upload Errors:**</span></span>

<span data-ttu-id="a6cba-114">**N<sup>1</sup>:** si el sistema operativo es Windows generalizado y se carga como especializado, aparecerá un error de tiempo de espera de aprovisionamiento con la máquina virtual bloqueada en la pantalla de OOBE.</span><span class="sxs-lookup"><span data-stu-id="a6cba-114">**N<sup>1</sup>:** If the OS is Windows generalized, and it is uploaded as specialized, you will get a provisioning timeout error with the VM stuck at the OOBE screen.</span></span>

<span data-ttu-id="a6cba-115">**N<sup>2</sup>:** si el sistema operativo es Windows especializado y se carga como generalizado, recibirá un error de aprovisionamiento con la máquina virtual bloqueada en la pantalla de OOBE porque la nueva máquina virtual se ejecuta con el nombre del equipo, el nombre de usuario y la contraseña originales.</span><span class="sxs-lookup"><span data-stu-id="a6cba-115">**N<sup>2</sup>:** If the OS is Windows specialized, and it is uploaded as generalized, you will get a provisioning failure error with the VM stuck at the OOBE screen because the new VM is running with the original computer name, username and password.</span></span>

<span data-ttu-id="a6cba-116">**Resolución:**</span><span class="sxs-lookup"><span data-stu-id="a6cba-116">**Resolution:**</span></span>

<span data-ttu-id="a6cba-117">Para resolver estos errores, cargue el VHD original, disponible en el entorno local, con la misma configuración que para el sistema operativo (generalizada o especializada).</span><span class="sxs-lookup"><span data-stu-id="a6cba-117">To resolve both these errors, upload the original VHD, available on-prem, with the same setting as that for the OS (generalized/specialized).</span></span> <span data-ttu-id="a6cba-118">Para cargar como generalizado, no olvide ejecutar sysprep antes.</span><span class="sxs-lookup"><span data-stu-id="a6cba-118">To upload as generalized, remember to run sysprep first.</span></span> <span data-ttu-id="a6cba-119">Para más información, consulte [Crear y cargar un VHD de Windows Server a Azure](createupload-vhd.md) .</span><span class="sxs-lookup"><span data-stu-id="a6cba-119">See [Create and upload a Windows Server VHD to Azure](createupload-vhd.md) for more information.</span></span>

<span data-ttu-id="a6cba-120">**Errores de captura:**</span><span class="sxs-lookup"><span data-stu-id="a6cba-120">**Capture Errors:**</span></span>

<span data-ttu-id="a6cba-121">**N<sup>3</sup>:** si el sistema operativo es Windows generalizado y se captura como especializado, recibirá un error de tiempo de espera de aprovisionamiento porque la máquina virtual original no se puede utilizar, ya que está marcada como generalizada.</span><span class="sxs-lookup"><span data-stu-id="a6cba-121">**N<sup>3</sup>:** If the OS is Windows generalized, and it is captured as specialized, you will get a provisioning timeout error because the original VM is not usable as it is marked as generalized.</span></span>

<span data-ttu-id="a6cba-122">**N<sup>4</sup>:** si el sistema operativo es Windows especializado y se captura como generalizado, recibirá un error de aprovisionamiento porque la nueva máquina virtual se está ejecutando con el nombre del equipo, el nombre de usuario y la contraseña originales.</span><span class="sxs-lookup"><span data-stu-id="a6cba-122">**N<sup>4</sup>:** If the OS is Windows specialized, and it is captured as generalized, you will get a provisioning failure error because the new VM is running with the original computer name, username and password.</span></span> <span data-ttu-id="a6cba-123">Además, no se puede utilizar la máquina virtual original ya que está marcada como especializada.</span><span class="sxs-lookup"><span data-stu-id="a6cba-123">Also, the original VM is not usable because it is marked as specialized.</span></span>

<span data-ttu-id="a6cba-124">**Resolución:**</span><span class="sxs-lookup"><span data-stu-id="a6cba-124">**Resolution:**</span></span>

<span data-ttu-id="a6cba-125">Para resolver estos errores, elimine la imagen actual del portal y [vuelva a capturarla desde los discos duros virtuales actuales](capture-image.md) con la misma configuración que para el sistema operativo (generalizada o especializada).</span><span class="sxs-lookup"><span data-stu-id="a6cba-125">To resolve both these errors, delete the current image from the portal, and [recapture it from the current VHDs](capture-image.md) with the same setting as that for the OS (generalized/specialized).</span></span>

## <a name="issue-custom-gallery-marketplace-image-allocation-failure"></a><span data-ttu-id="a6cba-126">Problema: Imagen de galería/marketplace/personalizada; error de asignación</span><span class="sxs-lookup"><span data-stu-id="a6cba-126">Issue: Custom/ gallery/ marketplace image; allocation failure</span></span>
<span data-ttu-id="a6cba-127">Este error se produce en situaciones en las que la nueva solicitud de máquina virtual se envía a un clúster que no tiene espacio libre disponible para alojar la solicitud o no admite el tamaño de la máquina virtual que se solicita.</span><span class="sxs-lookup"><span data-stu-id="a6cba-127">This error arises in situations when the new VM request is sent to a cluster that either does not have available free space to accommodate the request, or cannot support the VM size being requested.</span></span> <span data-ttu-id="a6cba-128">No es posible mezclar varias series diferentes de máquinas virtuales en el mismo servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="a6cba-128">It is not possible to mix different series of VMs in the same cloud service.</span></span> <span data-ttu-id="a6cba-129">Por tanto, si desea crear una nueva máquina virtual de un tamaño distinto al que puede admitir el servicio en la nube, la solicitud de proceso producirá un error.</span><span class="sxs-lookup"><span data-stu-id="a6cba-129">So if you want to create a new VM of a different size than what your cloud service can support, the compute request will fail.</span></span>

<span data-ttu-id="a6cba-130">Según las restricciones del servicio en la nube que utilice para crear la nueva máquina virtual, podría recibir un error debido a una de estas dos situaciones.</span><span class="sxs-lookup"><span data-stu-id="a6cba-130">Depending on the constraints of the cloud service you use to create the new VM, you might encounter an error caused by one of two situations.</span></span>

<span data-ttu-id="a6cba-131">**Causa 1:** El servicio en la nube está anclado a un clúster concreto o está vinculado a un grupo de afinidad y anclado, por tanto, a un clúster específico por diseño.</span><span class="sxs-lookup"><span data-stu-id="a6cba-131">**Cause 1:** The cloud service is pinned to a specific cluster, or it is linked to an affinity group, and hence pinned to a specific cluster by design.</span></span> <span data-ttu-id="a6cba-132">Por ello, las nuevas solicitudes de recursos de proceso de ese grupo de afinidad se intentan llevar a cabo en el mismo clúster en el que están hospedados los recursos existentes.</span><span class="sxs-lookup"><span data-stu-id="a6cba-132">So new compute resource requests in that affinity group are tried in the same cluster where the existing resources are hosted.</span></span> <span data-ttu-id="a6cba-133">Sin embargo, el mismo clúster puede no admitir el tamaño solicitado de la máquina virtual o no tener suficiente espacio disponible, lo que generará un error de asignación.</span><span class="sxs-lookup"><span data-stu-id="a6cba-133">However, the same cluster may either not support the requested VM size or have insufficient available space, resulting in an allocation error.</span></span> <span data-ttu-id="a6cba-134">Esto es así con independencia de que los nuevos recursos se creen mediante un servicio en la nube nuevo o existente.</span><span class="sxs-lookup"><span data-stu-id="a6cba-134">This is true whether the new resources are created through a new cloud service or through an existing cloud service.</span></span>

<span data-ttu-id="a6cba-135">**Resolución 1:**</span><span class="sxs-lookup"><span data-stu-id="a6cba-135">**Resolution 1:**</span></span>

* <span data-ttu-id="a6cba-136">Cree un nuevo servicio en la nube y asócielo a una región o a una red virtual basada en regiones.</span><span class="sxs-lookup"><span data-stu-id="a6cba-136">Create a new cloud service and associate it with either a region or a region-based virtual network.</span></span>
* <span data-ttu-id="a6cba-137">Cree una nueva máquina virtual en el nuevo servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="a6cba-137">Create a new VM in the new cloud service.</span></span>
  <span data-ttu-id="a6cba-138">Si se produce un error al intentar crear un nuevo servicio en la nube, vuelva a intentarlo más tarde o cambie la región de dicho servicio.</span><span class="sxs-lookup"><span data-stu-id="a6cba-138">If you get an error when trying to create a new cloud service, either retry at a later time or change the region for the cloud service.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="a6cba-139">Si intentó crear una nueva máquina virtual en un servicio en la nube existente, pero no lo logró y tuvo que crear uno nuevo para la nueva máquina virtual, puede consolidar todas las máquinas virtuales en el mismo servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="a6cba-139">If you were trying to create a new VM in an existing cloud service but couldn’t, and had to create a new cloud service for your new VM, you can choose to consolidate all your VMs in the same cloud service.</span></span> <span data-ttu-id="a6cba-140">Para ello, elimine las máquinas virtuales en el servicio en la nube existente y vuelva a capturarlas desde los discos del nuevo servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="a6cba-140">To do so, delete the VMs in the existing cloud service, and recapture them from their disks in the new cloud service.</span></span> <span data-ttu-id="a6cba-141">No obstante, es importante recordar que el nuevo servicio en la nube tendrá un nuevo nombre y dirección VIP, por lo que deberá actualizar esta información en todas las dependencias que utilicen esta información para el servicio en la nube existente.</span><span class="sxs-lookup"><span data-stu-id="a6cba-141">However, it is important to remember that the new cloud service will have a new name and VIP, so you will need to update these for all the dependencies that currently use this information for the existing cloud service.</span></span>
> 
> 

<span data-ttu-id="a6cba-142">**Causa 2:** El servicio en la nube está asociado con una red virtual que está vinculada a un grupo de afinidad y anclada, por tanto, a un clúster específico por diseño.</span><span class="sxs-lookup"><span data-stu-id="a6cba-142">**Cause 2:** The cloud service is associated with a virtual network that is linked to an affinity group, so it is pinned to a specific cluster by design.</span></span> <span data-ttu-id="a6cba-143">Por tanto, todas las nuevas solicitudes de recursos de proceso de ese grupo de afinidad se intentarán llevar a cabo en el mismo clúster en el que están hospedados los recursos existentes.</span><span class="sxs-lookup"><span data-stu-id="a6cba-143">All new compute resource requests in that affinity group are therefore tried in the same cluster where the existing resources are hosted.</span></span> <span data-ttu-id="a6cba-144">Sin embargo, el mismo clúster puede no admitir el tamaño solicitado de la máquina virtual o no tener suficiente espacio disponible, lo que generará un error de asignación.</span><span class="sxs-lookup"><span data-stu-id="a6cba-144">However, the same cluster may either not support the requested VM size or have insufficient available space, resulting in an allocation error.</span></span> <span data-ttu-id="a6cba-145">Esto es así con independencia de que los nuevos recursos se creen mediante un servicio en la nube nuevo o existente.</span><span class="sxs-lookup"><span data-stu-id="a6cba-145">This is true whether the new resources are created through a new cloud service or through an existing cloud service.</span></span>

<span data-ttu-id="a6cba-146">**Resolución 2:**</span><span class="sxs-lookup"><span data-stu-id="a6cba-146">**Resolution 2:**</span></span>

* <span data-ttu-id="a6cba-147">Cree una nueva red virtual regional.</span><span class="sxs-lookup"><span data-stu-id="a6cba-147">Create a new regional virtual network.</span></span>
* <span data-ttu-id="a6cba-148">Cree la nueva máquina virtual en la nueva red virtual.</span><span class="sxs-lookup"><span data-stu-id="a6cba-148">Create the new VM in the new virtual network.</span></span>
* <span data-ttu-id="a6cba-149">[Conecte la red virtual existente](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/) a la nueva red virtual.</span><span class="sxs-lookup"><span data-stu-id="a6cba-149">[Connect your existing virtual network](https://azure.microsoft.com/blog/vnet-to-vnet-connecting-virtual-networks-in-azure-across-different-regions/) to the new virtual network.</span></span> <span data-ttu-id="a6cba-150">Consulte más información sobre las [redes virtuales regionales](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).</span><span class="sxs-lookup"><span data-stu-id="a6cba-150">See more about [regional virtual networks](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/).</span></span> <span data-ttu-id="a6cba-151">Asimismo, puede [migrar la red virtual basada en un grupo de afinidad a una red virtual regional](https://azure.microsoft.com/blog/2014/11/26/migrating-existing-services-to-regional-scope/)y, después, crear la nueva máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="a6cba-151">Alternatively, you can [migrate your affinity-group-based virtual network to a regional virtual network](https://azure.microsoft.com/blog/2014/11/26/migrating-existing-services-to-regional-scope/), and then create the new VM.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a6cba-152">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="a6cba-152">Next steps</span></span>
<span data-ttu-id="a6cba-153">Si tiene problemas al iniciar una máquina virtual Windows detenida o al cambiar el tamaño de una máquina virtual Windows existente en Azure, consulte [Solución de problemas de la implementación clásica con el reinicio o el cambio de tamaño de una máquina virtual de Windows existente en Azure](virtual-machines-windows-classic-restart-resize-error-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="a6cba-153">If you encounter issues when you start a stopped Windows VM or resize an existing Windows VM in Azure, see [Troubleshoot classic deployment issues with restarting or resizing an existing Windows Virtual Machine in Azure](virtual-machines-windows-classic-restart-resize-error-troubleshooting.md).</span></span>

