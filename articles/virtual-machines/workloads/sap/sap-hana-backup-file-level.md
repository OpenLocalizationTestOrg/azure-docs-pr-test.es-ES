---
title: aaaSAP HANA la copia de seguridad de Azure en el nivel de archivo | Documentos de Microsoft
description: "Existen dos posibilidades de copia de seguridad principales para SAP HANA en Azure Virtual Machines. Este artículo trata sobre Azure Backup de SAP HANA en el nivel de archivo"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="20827-103">Azure Backup de SAP HANA en el nivel de archivo</span><span class="sxs-lookup"><span data-stu-id="20827-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="20827-104">Introducción</span><span class="sxs-lookup"><span data-stu-id="20827-104">Introduction</span></span>

<span data-ttu-id="20827-105">Esto forma parte de una serie de tres partes de artículos relacionados sobre copia de seguridad de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="20827-106">[Guía de backup para SAP HANA en máquinas virtuales Azure](./sap-hana-backup-guide.md) proporciona una introducción e información sobre los pasos iniciales, y [copia de seguridad de SAP HANA basándose en instantáneas de almacenamiento](./sap-hana-backup-storage-snapshots.md) portadas Hola opción de copia de seguridad basados en instantáneas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="20827-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="20827-107">Examinando los tamaños de máquina virtual de Azure de hello, uno puede ver que una GS5 permite 64 discos de datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="20827-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="20827-108">Para los sistemas de SAP HANA de gran tamaño, puede haberse tomado ya un número significativo de discos para archivos de registro y datos, posiblemente junto con el RAID del software para ofrecer un rendimiento óptimo de E/S del disco.</span><span class="sxs-lookup"><span data-stu-id="20827-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="20827-109">¿a continuación, la pregunta de Hello es donde toostore SAP HANA copia de seguridad de archivos, que podrían llenarse datos Hola adjunta discos con el tiempo?</span><span class="sxs-lookup"><span data-stu-id="20827-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="20827-110">Vea [tamaños de máquinas virtuales de Linux en Azure](../../linux/sizes.md) para las tablas de tamaño de máquina virtual de Azure Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="20827-111">En este momento no hay ninguna integración de copia de seguridad de SAP HANA disponible con el servicio Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="20827-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="20827-112">manera estándar de Hello toomanage copia de seguridad/restauración en el nivel de archivo hello es con una copia de seguridad basada en archivos a través de SAP HANA Studio o instrucciones SQL de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="20827-113">Vea [SAP HANA SQL y referencia de vistas del sistema](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="20827-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![Esta ilustración muestra el cuadro de diálogo de Hola Hola copia de seguridad del elemento de menú en SAP HANA Studio](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="20827-115">Esta ilustración muestra el cuadro de diálogo de Hola Hola copia de seguridad del elemento de menú en SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="20827-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="20827-116">Al elegir el tipo &quot;archivo&quot; uno tiene toospecify una ruta de acceso del sistema de archivos de Hola donde SAP HANA escribe archivos de copia de seguridad de Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="20827-117">Restauración funciona Hola igual.</span><span class="sxs-lookup"><span data-stu-id="20827-117">Restore works hello same way.</span></span>

<span data-ttu-id="20827-118">Aunque esta opción suena simple y sencilla, existen algunas consideraciones.</span><span class="sxs-lookup"><span data-stu-id="20827-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="20827-119">Como se mencionó antes, una máquina virtual de Azure tiene una limitación del número de discos de datos que se pueden asociar.</span><span class="sxs-lookup"><span data-stu-id="20827-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="20827-120">No puede haber archivos de copia de seguridad de SAP HANA de toostore y capacidad en sistemas de archivos de Hola Hola de máquina virtual, según el tamaño de Hola de hello base de datos y disco requisitos de rendimiento, que podría causar el software RAID mediante la creación de bandas a través de los datos de varios discos.</span><span class="sxs-lookup"><span data-stu-id="20827-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="20827-121">Se proporcionan más opciones para mover estos archivos de copia de seguridad y administrar las restricciones de tamaño de archivo y el rendimiento cuando se administran terabytes de datos más adelante en este artículo.</span><span class="sxs-lookup"><span data-stu-id="20827-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="20827-122">Otra opción, que ofrece más libertad con respecto a la capacidad total, es Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="20827-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="20827-123">Mientras un único blob también está restringido too1 TB, la capacidad total de Hola de un único contenedor blobs está actualmente 500 TB.</span><span class="sxs-lookup"><span data-stu-id="20827-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="20827-124">Además, ofrece a los clientes Hola choice tooselect denominada &quot;frío&quot; almacenamiento de blobs, que tiene una ventaja de costo.</span><span class="sxs-lookup"><span data-stu-id="20827-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="20827-125">Vea [Azure Blob Storage: capas de almacenamiento de acceso frecuente y esporádico](../../../storage/blobs/storage-blob-storage-tiers.md) para obtener más información sobre el almacenamiento de blobs en frío.</span><span class="sxs-lookup"><span data-stu-id="20827-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="20827-126">Por motivos de seguridad adicional, utilice un almacenamiento de replicación geográfica cuenta toostore Hola SAP HANA las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="20827-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="20827-127">Vea [Replicación de Azure Storage](../../../storage/common/storage-redundancy.md) para obtener más información sobre la replicación de la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="20827-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="20827-128">Puede colocar VHD dedicados para copias de seguridad de SAP HANA en una cuenta de almacenamiento de copia de seguridad dedicada con replicación geográfica.</span><span class="sxs-lookup"><span data-stu-id="20827-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="20827-129">O bien uno podría copiar discos duros virtuales de Hola que mantienen copias de seguridad de SAP HANA Hola cuenta de almacenamiento georreplicadas tooa o tooa cuenta de almacenamiento que se encuentra en una región diferente.</span><span class="sxs-lookup"><span data-stu-id="20827-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="20827-130">Azure Backup Agent</span><span class="sxs-lookup"><span data-stu-id="20827-130">Azure backup agent</span></span>

<span data-ttu-id="20827-131">Ofertas de copia de seguridad de Azure Hola opción toonot solo realizar una copia completa de máquinas virtuales, pero también archivos y directorios a través de agente de copia de seguridad de hello, que tiene instalado en el sistema operativo invitado de Hola de toobe.</span><span class="sxs-lookup"><span data-stu-id="20827-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="20827-132">Pero a partir de 2016 de diciembre, este agente sólo se admite en Windows (vea [copia de seguridad una tooAzure de Windows Server o cliente utilizando el modelo de implementación del Administrador de recursos de hello](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="20827-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="20827-133">Una solución alternativa es copia de toofirst tooa de archivos de copia de seguridad de SAP HANA VM de Windows en Azure (por ejemplo, a través de recursos compartidos SAMBA) y, a continuación, usar hello agente de copia de seguridad de Azure desde allí.</span><span class="sxs-lookup"><span data-stu-id="20827-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="20827-134">Aunque es técnicamente posible, podría agregar complejidad y ralentizar la copia de seguridad de Hola o proceso un poco debido toohello copia entre hello VM de Windows y Linux de Hola de restauración.</span><span class="sxs-lookup"><span data-stu-id="20827-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="20827-135">No es recomendable toofollow este enfoque.</span><span class="sxs-lookup"><span data-stu-id="20827-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="20827-136">Detalles de la utilidad bloxfer de Azure</span><span class="sxs-lookup"><span data-stu-id="20827-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="20827-137">toostore directorios y archivos en almacenamiento de Azure, podría usar una CLI o PowerShell, o desarrolle una herramienta mediante uno de hello [Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="20827-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="20827-138">También hay una utilidad listos para usar, AzCopy, para la copia de almacenamiento de datos tooAzure, pero se trata solo de Windows (consulte [transferir datos con hello utilidad de línea de comandos de AzCopy](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="20827-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="20827-139">Por lo tanto, se usó blobxfer para copiar los archivos de copia de seguridad de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="20827-140">Se trata de código abierto, que usan muchos clientes en entornos de producción, y que está disponible en [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="20827-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="20827-141">Esta herramienta permite que los datos de una toocopy directamente tooeither Azure blob storage o recurso compartido de archivos de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="20827-142">También ofrece una gama de características útiles, como hash md5 o paralelismo automático al copiar un directorio con varios archivos.</span><span class="sxs-lookup"><span data-stu-id="20827-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="20827-143">Rendimiento de copia de seguridad de SAP HANA</span><span class="sxs-lookup"><span data-stu-id="20827-143">SAP HANA backup performance</span></span>

![Esta captura de pantalla es de la consola de copia de seguridad de SAP HANA hello en SAP HANA Studio](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="20827-145">Esta captura de pantalla es de la consola de copia de seguridad de SAP HANA hello en SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="20827-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="20827-146">Copia de seguridad de aproximadamente 42 minutos toodo Hola. se tardó de hello 230 GB en un disco de almacenamiento de Azure único estándar adjunta toohello HANA VM mediante el sistema de archivos XFS.</span><span class="sxs-lookup"><span data-stu-id="20827-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![Esta captura de pantalla es de YaST en la máquina virtual de la prueba de SAP HANA Hola](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="20827-148">Esta captura de pantalla es de YaST en la máquina virtual de la prueba de SAP HANA Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="20827-149">Como se mencionó antes, se puede ver solo disco de 1 TB de Hola para copia de seguridad de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="20827-150">Se tardó aproximadamente 42 minutos toobackup 230 GB.</span><span class="sxs-lookup"><span data-stu-id="20827-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="20827-151">Además, se asocian cinco discos de 200 GB y software RAID md0 creado, con la fragmentación en la parte superior de estaos cinco discos de datos de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Repetir Hola igual de copia de seguridad en RAID de software con creación de bandas en cinco discos de datos de almacenamiento estándar Azure conectados](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="20827-153">Hola repetición igual de copia de seguridad en RAID de software con creación de bandas en cinco conectado hora de copia de seguridad de Azure almacenamiento estándar datos discos poner Hola de 42 minutos hacia abajo too10 minutos.</span><span class="sxs-lookup"><span data-stu-id="20827-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="20827-154">se han adjuntado discos Hola sin almacenamiento en caché toohello máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="20827-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="20827-155">Por lo que resulta evidente la importancia rendimiento de escritura en disco es para tiempo de copia de seguridad de Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="20827-156">Uno podría conmutador tooAzure premium almacenamiento toofurther acelerar el proceso de Hola para un rendimiento óptimo.</span><span class="sxs-lookup"><span data-stu-id="20827-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="20827-157">En general, debe usarse Azure Premium Storage para los sistemas de producción.</span><span class="sxs-lookup"><span data-stu-id="20827-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="20827-158">Copie el almacenamiento de blobs de tooAzure de archivos de copia de seguridad de SAP HANA</span><span class="sxs-lookup"><span data-stu-id="20827-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="20827-159">Como de 2016 de diciembre, Hola mejor opción tooquickly almacén SAP HANA copias de seguridad es el almacenamiento de blobs de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="20827-160">Un contenedor de blob único tiene un límite de 500 TB, suficiente para la mayoría de los sistemas de SAP HANA, ejecute en una máquina virtual GS5 en Azure, tookeep suficientes SAP HANA las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="20827-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="20827-161">Los clientes tienen la opción de hello entre &quot;activa&quot; y &quot;frío&quot; almacenamiento de blobs (vea [almacenamiento de blobs de Azure: caliente y estupendo capas de almacenamiento](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="20827-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="20827-162">Con la herramienta de blobxfer Hola, son archivos de copia de seguridad de fácil toocopy Hola SAP HANA directamente tooAzure almacenamiento de blobs.</span><span class="sxs-lookup"><span data-stu-id="20827-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Aquí se pueden ver archivos de Hola de una copia de seguridad completa del archivo de SAP HANA](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="20827-164">Aquí se pueden ver archivos de Hola de una copia de seguridad completa del archivo de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="20827-165">Hay cuatro archivos y una mayor hello tiene aproximadamente 230 GB.</span><span class="sxs-lookup"><span data-stu-id="20827-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Se tardó aproximadamente 3.000 segundos contenedor de blob de la cuenta del almacenamiento estándar Azure tooan toocopy Hola de 230 GB](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="20827-167">No usar hash md5 en prueba inicial de hello, que tardó aproximadamente 3.000 segundos contenedor de blob de la cuenta del almacenamiento estándar Azure tooan toocopy Hola de 230 GB.</span><span class="sxs-lookup"><span data-stu-id="20827-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![En esta captura de pantalla, uno puede ver su aspecto en hello portal de Azure](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="20827-169">En esta captura de pantalla, uno puede ver su aspecto en hello portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="20827-170">Un contenedor de blobs denominado &quot;backups de sap hana&quot; creó e incluye blobs Hola cuatro, que representan los archivos de copia de seguridad de SAP HANA Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="20827-171">Uno de ellos tiene un tamaño de aproximadamente 230 GB.</span><span class="sxs-lookup"><span data-stu-id="20827-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="20827-172">consola de copia de seguridad de Hello HANA Studio permite un tamaño máximo de archivo de hello toorestrict de archivos de copia de seguridad de HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="20827-173">En el entorno de ejemplo de Hola, lo mayor rendimiento posible toohave archivos de varias copias de seguridad más pequeños, en lugar de un archivo grande de 230 GB para convertirla.</span><span class="sxs-lookup"><span data-stu-id="20827-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![Establecer límite de tamaño de archivo de copia de seguridad de hello en hello HANA lado &#39; t mejorar el tiempo de copia de seguridad de Hola](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="20827-175">Establecer límite de tamaño de archivo de copia de seguridad de hello en hello HANA lado &#39; t mejoran el tiempo de copia de seguridad de hello, dado que los archivos de saludo se escriben secuencialmente, tal como se muestra en esta ilustración.</span><span class="sxs-lookup"><span data-stu-id="20827-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="20827-176">límite de tamaño de archivo de Hola se estableció too60 GB, por lo que copia de seguridad de hello crea cuatro archivos de datos de gran tamaño en lugar de hello 230 GB único archivo.</span><span class="sxs-lookup"><span data-stu-id="20827-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![paralelismo de tootest de herramienta de hello blobxfer, tamaño máximo de archivo de Hola para copias de seguridad HANA, a continuación, se estableció too15 GB](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="20827-178">paralelismo de tootest de herramienta de hello blobxfer, tamaño máximo de archivo de Hola para copias de seguridad HANA, a continuación, se estableció too15 GB, lo que provocó 19 archivos de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="20827-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="20827-179">Esta configuración, vuelva a tiempo hello para el almacenamiento de blobs de blobxfer toocopy Hola de 230 GB tooAzure de 3.000 segundos hacia abajo too875 segundos.</span><span class="sxs-lookup"><span data-stu-id="20827-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="20827-180">El resultado es pagar toohello límite de 60 MB/s para escribir un blob de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="20827-181">Paralelismo a través de varios blobs resuelve el cuello de botella de hello, pero tiene un inconveniente: aumento del rendimiento de hello blobxfer herramienta toocopy estos tooAzure de copia de seguridad de archivos HANA almacenamiento de blobs supone una carga en hello HANA VM y red de Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="20827-182">Afecta al funcionamiento del sistema de HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="20827-183">Copia de blob de discos de datos de Azure dedicados en el software RAID de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="20827-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="20827-184">A diferencia de hello VM datos disco copia de seguridad manual, en este enfoque uno no realizar copias de seguridad todos los discos de datos de hello en una máquina virtual toosave Hola SAP instalación completa, incluidos los datos HANA HANA registra los archivos y archivos de configuración.</span><span class="sxs-lookup"><span data-stu-id="20827-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="20827-185">En su lugar, Hola idea es RAID de software toohave dedicado con creación de bandas en varios discos duros virtuales de datos de Azure para almacenar una copia de seguridad completa del archivo de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="20827-186">Una copia de solo estos discos, que tienen copia de seguridad de hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="20827-187">Se podía mantenerse fácilmente en una cuenta de almacenamiento de copia de seguridad de HANA dedicada o adjunta tooa dedicado &quot;administración de máquinas virtuales de copia de seguridad&quot; para su posterior procesamiento.</span><span class="sxs-lookup"><span data-stu-id="20827-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Se han copiado todos los discos duros virtuales implicadas con Hola ** iniciar-azurestorageblobcopy ** comandos de PowerShell](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="20827-189">Después de que se completó hello toohello copia de seguridad local de software RAID, todos los discos duros virtuales implicadas se copiaron con hello **inicio azurestorageblobcopy** comando de PowerShell (vea [AzureStorageBlobCopy inicio](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="20827-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="20827-190">Como solo afecta al sistema de archivos de hello dedicado para conservar los archivos de copia de seguridad de hello, no hay preocupaciones acerca de la coherencia de los archivos de datos o de registro de SAP HANA en disco Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="20827-191">Una ventaja de este comando es que funciona mientras Hola VM permanece en línea.</span><span class="sxs-lookup"><span data-stu-id="20827-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="20827-192">toobe determinado que no hay ningún proceso escribe un conjunto de copia de seguridad bandas toohello, ser seguro toounmount con anterioridad Hola copia de blob y montar de nuevo posteriormente.</span><span class="sxs-lookup"><span data-stu-id="20827-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="20827-193">O se podría usar un adecuado demasiado&quot;inmovilizar&quot; Hola de sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="20827-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="20827-194">Por ejemplo, a través de xfs\_inmovilizar Hola XFS sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="20827-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![Esta captura de pantalla muestra la lista de Hola de blobs en contenedor de discos duros virtuales Hola Hola portal de Azure](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="20827-196">Esta captura de pantalla muestra la lista de Hola de blobs en hello &quot;discos duros virtuales&quot; contenedor en hello portal de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="20827-197">captura de pantalla de Hello muestra hello cinco discos duros virtuales, que estuviera conectada toohello SAP HANA servidor VM tooserve como archivos de copia de seguridad de hello software RAID tookeep SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="20827-198">También muestra hello cinco copias, que se han realizado a través del comando de copia de blob de Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![Para realizar pruebas, copias de Hola de los discos RAID de software de copia de seguridad de SAP HANA Hola estaban máquina virtual del servidor de aplicación toohello adjunto](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="20827-200">Para realizar pruebas, copias de Hola de los discos RAID de software de copia de seguridad de SAP HANA Hola eran máquina virtual del servidor de aplicación toohello adjunto.</span><span class="sxs-lookup"><span data-stu-id="20827-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![máquina virtual del servidor de aplicación Hola se cerró tooattach Hola disco copias](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="20827-202">máquina virtual del servidor de aplicación Hola se cerró tooattach Hola disco copias.</span><span class="sxs-lookup"><span data-stu-id="20827-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="20827-203">Después de iniciar Hola VM, se detectaron correctamente hello RAID y discos de hello (montado a través de UUID).</span><span class="sxs-lookup"><span data-stu-id="20827-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="20827-204">Solo el punto de montaje Hola faltaba, que se creó mediante particionador de YaST Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="20827-205">Después copias de archivos de copia de seguridad de SAP HANA de hello pasara a ser visibles en el nivel del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="20827-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="20827-206">Copiar archivos de copia de seguridad de SAP HANA tooNFS compartir</span><span class="sxs-lookup"><span data-stu-id="20827-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="20827-207">toolessen Hola posible impacto en el sistema de SAP HANA desde una perspectiva de espacio de disco o rendimiento hello, uno puede almacenar los archivos de copia de seguridad de SAP HANA hello en un recurso compartido NFS.</span><span class="sxs-lookup"><span data-stu-id="20827-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="20827-208">Técnicamente funciona, pero significa utilizando una segunda máquina virtual de Azure como host de Hola de hello que recursos compartidos de NFS.</span><span class="sxs-lookup"><span data-stu-id="20827-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="20827-209">No debe ser un tamaño de máquina virtual pequeño, debido a ancho de banda de red VM de toohello.</span><span class="sxs-lookup"><span data-stu-id="20827-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="20827-210">Sería sentido, a continuación, tooshut hacia abajo esto &quot;VM de copia de seguridad&quot; y solo se ponga a ejecutar copia de seguridad de hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="20827-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="20827-211">Escribir en un NFS recurso compartido supone una carga de red de Hola e impactos Hola sistema SAP HANA, pero simplemente administrar Hola archivos de copia de seguridad después de hello &quot;VM de copia de seguridad&quot; no pueda influir en sistema de SAP HANA hello en absoluto.</span><span class="sxs-lookup"><span data-stu-id="20827-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![Un recurso compartido NFS desde otra máquina virtual de Azure era la máquina virtual del servidor de SAP HANA toohello montado](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="20827-213">caso de uso de hello tooverify NFS, un recurso compartido NFS desde otra máquina virtual de Azure fue la máquina virtual del servidor de SAP HANA toohello montada.</span><span class="sxs-lookup"><span data-stu-id="20827-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="20827-214">No se ha aplicado ningún ajuste de NFS especial.</span><span class="sxs-lookup"><span data-stu-id="20827-214">There was no special NFS tuning applied.</span></span>

![Tardó copia de seguridad de 1 hora y 46 minutos toodo Hola directamente](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="20827-216">recurso compartido NFS de Hello era un conjunto de bandas rápida, como Hola uno en el servidor de SAP HANA Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="20827-217">No obstante, se tardaron 1 hora y Hola de 46 minutos toodo copia de seguridad directamente en el recurso compartido NFS de hello en lugar de 10 minutos, cuando se escribe un conjunto de bandas local tooa.</span><span class="sxs-lookup"><span data-stu-id="20827-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![alternativa de Hello no estaba mucho más rápido en 1 hora y 43 minutos](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="20827-219">alternativa de Hola de realizar un conjunto de bandas local de copia de seguridad tooa y copiar toohello recursos compartidos de NFS en el nivel del sistema operativo (un sencillo **cp - avr** comandos) no estaba mucho más rápido.</span><span class="sxs-lookup"><span data-stu-id="20827-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="20827-220">Se tardó 1 hora y 43 minutos.</span><span class="sxs-lookup"><span data-stu-id="20827-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="20827-221">Por lo que funciona, pero el rendimiento no era válido durante la prueba de copia de seguridad de 230 GB Hola.</span><span class="sxs-lookup"><span data-stu-id="20827-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="20827-222">Podría ser incluso peor para varios terabytes.</span><span class="sxs-lookup"><span data-stu-id="20827-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="20827-223">Copie el servicio de archivos de tooAzure de archivos de copia de seguridad de SAP HANA</span><span class="sxs-lookup"><span data-stu-id="20827-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="20827-224">Es posible toomount compartir un archivo de Azure dentro de una máquina virtual Linux de Azure.</span><span class="sxs-lookup"><span data-stu-id="20827-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="20827-225">artículo de Hello [cómo toouse almacenamiento de archivos de Azure con Linux](../../../storage/files/storage-how-to-use-files-linux.md) proporciona detalles acerca de cómo toodo lo.</span><span class="sxs-lookup"><span data-stu-id="20827-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="20827-226">Tenga en cuenta que actualmente hay un límite de cuota de 5 TB de un recurso compartido de archivos de Azure y un límite de tamaño de archivo de 1 TB por cada archivo.</span><span class="sxs-lookup"><span data-stu-id="20827-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="20827-227">Vea [Objetivos de escalabilidad y rendimiento de Azure Storage](../../../storage/common/storage-scalability-targets.md) para obtener más información sobre los límites de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="20827-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="20827-228">Sin embargo, las pruebas demuestran que la copia de seguridad de SAP HANA no funciona hoy en día directamente con este tipo de montaje CIFS.</span><span class="sxs-lookup"><span data-stu-id="20827-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="20827-229">También se estableció en la [nota 1820529 de SAP](https://launchpad.support.sap.com/#/notes/1820529) que no se recomienda CIFS.</span><span class="sxs-lookup"><span data-stu-id="20827-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![Esta ilustración muestra un error en el cuadro de diálogo copia de seguridad de Hola de SAP HANA Studio](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="20827-231">En esta ilustración se muestra un error en el cuadro de diálogo copia de seguridad de Hola de SAP HANA Studio, al tratar de tooback directamente recurso compartido de archivos de Azure montados en CIFS tooa.</span><span class="sxs-lookup"><span data-stu-id="20827-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="20827-232">Por lo que uno tiene toodo una copia de seguridad estándar de SAP HANA en un sistema de archivos de máquina virtual en primer lugar y, a continuación, archivos de copia de seguridad de Hola desde ahí tooAzure servicio de archivos.</span><span class="sxs-lookup"><span data-stu-id="20827-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![Esta ilustración muestra que tardó aproximadamente 929 segundos toocopy 19 SAP HANA copias de seguridad](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="20827-234">Esta ilustración muestra que tardaron aproximadamente 929 segundos toocopy 19 archivos de copia de seguridad de SAP HANA con un tamaño total aproximadamente 230 GB toohello Azure recurso compartido de archivos.</span><span class="sxs-lookup"><span data-stu-id="20827-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![estructura de directorios de origen de Hello en hello VM de SAP HANA era el recurso compartido de archivos de Azure toohello copiados](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="20827-236">En esta captura de pantalla, se puede ver que estructura de directorios de origen de hello en hello VM de SAP HANA fue recurso compartido de archivos de Azure toohello copiada: un directorio (hana\_copia de seguridad\_fsl\_15 gb) y 19 archivos de copia de seguridad individuales.</span><span class="sxs-lookup"><span data-stu-id="20827-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="20827-237">Almacenar los archivos de copia de seguridad de SAP HANA en archivos de Azure podría ser una opción interesante en hello futuro, cuando las copias de seguridad del archivo de SAP HANA admitan directamente.</span><span class="sxs-lookup"><span data-stu-id="20827-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="20827-238">O bien, cuando es posible que toomount archivos de Azure a través de NFS y límite de cuota máximo hello es considerablemente mayor que 5 TB.</span><span class="sxs-lookup"><span data-stu-id="20827-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="20827-239">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="20827-239">Next steps</span></span>
* <span data-ttu-id="20827-240">[Guía de copia de seguridad de SAP HANA en Azure Virtual Machines](sap-hana-backup-guide.md) ofrece una introducción e información sobre los pasos iniciales.</span><span class="sxs-lookup"><span data-stu-id="20827-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="20827-241">[Copia de seguridad de SAP HANA basándose en instantáneas de almacenamiento](sap-hana-backup-storage-snapshots.md) describe Hola almacenamiento basados en instantáneas copia de seguridad de las opciones.</span><span class="sxs-lookup"><span data-stu-id="20827-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="20827-242">toolearn tooestablish alta disponibilidad y el plan de recuperación ante desastres de SAP HANA en Azure (instancias grandes), vea [SAP HANA (instancias de gran tamaño) alta disponibilidad y recuperación ante desastres en Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="20827-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
