---
title: aaaCreate y cargar un VHD de Linux en Azure
description: "Obtenga información acerca de toocreate y cargar un Azure disco duro virtual (VHD) que contiene un sistema operativo Linux."
services: virtual-machines-linux
documentationcenter: 
author: szarkos
manager: timlt
editor: tysonn
tags: azure-resource-manager,azure-service-management
ms.assetid: d351396c-95a0-4092-b7bf-c6aae0bbd112
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 02/02/2017
ms.author: szark
ms.openlocfilehash: 208e15c035edb5520fc29ba8e4e71c42b041864d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="information-for-non-endorsed-distributions"></a><span data-ttu-id="ce5e1-103">Información para las distribuciones no aprobadas</span><span class="sxs-lookup"><span data-stu-id="ce5e1-103">Information for Non-Endorsed Distributions</span></span>
[!INCLUDE [learn-about-deployment-models](../../../includes/learn-about-deployment-models-both-include.md)]

<span data-ttu-id="ce5e1-104">plataforma Windows Azure SLA Hello aplica máquinas toovirtual ejecutando Hola sistema operativo de Linux sólo cuando uno de hello [están aprobados distribuciones](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) se utiliza.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-104">hello Azure platform SLA applies toovirtual machines running hello Linux OS only when one of hello [endorsed distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) is used.</span></span> <span data-ttu-id="ce5e1-105">Todas las distribuciones de Linux que se proporcionan en hello Azure son Galería de imágenes están aprobados distribuciones con la configuración necesaria de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-105">All Linux distributions that are provided in hello Azure image gallery are endorsed distributions with hello required configuration.</span></span>

* [<span data-ttu-id="ce5e1-106">Linux en distribuciones aprobadas por Azure</span><span class="sxs-lookup"><span data-stu-id="ce5e1-106">Linux on Azure - Endorsed Distributions</span></span>](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [<span data-ttu-id="ce5e1-107">Compatibilidad con las imágenes de Linux en Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="ce5e1-107">Support for Linux images in Microsoft Azure</span></span>](https://support.microsoft.com/kb/2941892)

<span data-ttu-id="ce5e1-108">Todas las distribuciones que se ejecuta en Azure deberá toomeet una serie de requisitos previos toohave un tooproperly ocasión se ejecuta en plataforma Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-108">All distributions running on Azure will need toomeet a number of prerequisites toohave a chance tooproperly run on hello platform.</span></span>  <span data-ttu-id="ce5e1-109">En este artículo es una lista de ninguna manera completo como cada distribución es diferente; y es bastante posible que incluso si se cumplen todos los criterios de hello siguiente que seguirá siendo necesario toosignificantly retocar la tooensure de sistema de Linux que se ejecuta correctamente en la plataforma de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-109">This article is by no means comprehensive as every distribution is different; and it is quite possible that even if you meet all hello criteria below you will still need toosignificantly tweak your Linux system tooensure that it properly runs on hello platform.</span></span>

<span data-ttu-id="ce5e1-110">Por eso recomendamos que empiece con una de nuestras [distribuciones aprobadas de Linux en Azure](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) cuando sea posible.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-110">It is for this reason that we recommend that you start with one of our [Linux on Azure Endorsed Distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) when possible.</span></span> <span data-ttu-id="ce5e1-111">Hello siguientes artículos le ayudará a cómo tooprepare Hola distintos con el respaldo de las distribuciones de Linux que se admiten en Azure:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-111">hello following articles will guide you through how tooprepare hello various endorsed Linux distributions that are supported on Azure:</span></span>

* <span data-ttu-id="ce5e1-112">**[Distribuciones basadas en CentOS](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="ce5e1-112">**[CentOS-based Distributions](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="ce5e1-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="ce5e1-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="ce5e1-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="ce5e1-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="ce5e1-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="ce5e1-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="ce5e1-116">**[SLES y openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="ce5e1-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="ce5e1-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="ce5e1-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>

<span data-ttu-id="ce5e1-118">resto de Hola de este artículo se centrará en instrucciones generales para ejecutar la distribución de Linux en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-118">hello rest of this article will focus on general guidance for running your Linux distribution on Azure.</span></span>

## <a name="general-linux-installation-notes"></a><span data-ttu-id="ce5e1-119">Notas generales sobre la instalación de Linux</span><span class="sxs-lookup"><span data-stu-id="ce5e1-119">General Linux Installation Notes</span></span>
* <span data-ttu-id="ce5e1-120">no se admite el formato VHDX Hello en Azure, solo **VHD fijo**.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-120">hello VHDX format is not supported in Azure, only **fixed VHD**.</span></span>  <span data-ttu-id="ce5e1-121">Puede convertir Hola disco tooVHD formato con el Administrador de Hyper-V u Hola cmdlet convert-vhd.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-121">You can convert hello disk tooVHD format using Hyper-V Manager or hello convert-vhd cmdlet.</span></span> <span data-ttu-id="ce5e1-122">Si usas VirtualBox Esto significa seleccionar **tamaño fijo** como opone predeterminado toohello asignada de forma dinámica al crear el disco de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-122">If you are using VirtualBox this means selecting **Fixed size** as opposed toohello default dynamically allocated when creating hello disk.</span></span>
* <span data-ttu-id="ce5e1-123">Azure solo admite máquinas virtuales de la generación 1.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-123">Azure only supports generation 1 virtual machines.</span></span> <span data-ttu-id="ce5e1-124">Puede convertir una generación 1 máquina virtual desde el formato de archivo de disco duro virtual de VHDX toohello y de expansión dinámica tooa fijada de tamaño de disco.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-124">You can convert a generation 1 virtual machine from VHDX toohello VHD file format and from dynamically expanding tooa fixed sized disk.</span></span> <span data-ttu-id="ce5e1-125">Sin embargo, no puede cambiar la generación de una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-125">But you can't change a virtual machine's generation.</span></span> <span data-ttu-id="ce5e1-126">Para obtener más información, vea [¿Debería crear una máquina virtual de generación 1 o 2 en Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span><span class="sxs-lookup"><span data-stu-id="ce5e1-126">For more information, see [Should I create a generation 1 or 2 virtual machine in Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span></span>
* <span data-ttu-id="ce5e1-127">Hola tamaño máximo permitido para hello VHD 1.023 GB.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-127">hello maximum size allowed for hello VHD is 1,023 GB.</span></span>
* <span data-ttu-id="ce5e1-128">Al instalar el sistema de Linux de hello es *recomienda* utilizar particiones estándar en lugar de LVM (a menudo predeterminado de Hola para muchas instalaciones).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-128">When installing hello Linux system it is *recommended* that you use standard partitions rather than LVM (often hello default for many installations).</span></span> <span data-ttu-id="ce5e1-129">Esto evitará conflictos de nombres LVM con máquinas virtuales clonadas, especialmente si un disco del sistema operativo alguna vez necesita tooanother toobe adjunta VM idéntico para solucionar el problema.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-129">This will avoid LVM name conflicts with cloned VMs, particularly if an OS disk ever needs toobe attached tooanother identical VM for troubleshooting.</span></span> <span data-ttu-id="ce5e1-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) o [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) se pueden utilizar en discos de datos.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) or [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) may be used on data disks.</span></span>
* <span data-ttu-id="ce5e1-131">Se requiere la compatibilidad de kernel para el montaje de sistemas de archivos UDF.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-131">Kernel support for mounting UDF file systems is required.</span></span> <span data-ttu-id="ce5e1-132">En el primer arranque en hello Azure configuración del aprovisionamiento pasa toohello VM de Linux a través de medios con formato UDF que está invitado toohello adjunto.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-132">At first boot on Azure hello provisioning configuration is passed toohello Linux VM via UDF-formatted media that is attached toohello guest.</span></span> <span data-ttu-id="ce5e1-133">agente de Linux de Azure de Hello debe ser capaz de toomount Hola UDF archivo sistema tooread su configuración y aprovisionar Hola VM.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-133">hello Azure Linux agent must be able toomount hello UDF file system tooread its configuration and provision hello VM.</span></span>
* <span data-ttu-id="ce5e1-134">Las versiones de kernel de Linux inferiores a la versión 2.6.37 no admiten NUMA en Hyper-V con tamaños de VM más grandes.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-134">Linux kernel versions below 2.6.37 do not support NUMA on Hyper-V with larger VM sizes.</span></span> <span data-ttu-id="ce5e1-135">Este problema afecta principalmente distribuciones anteriores mediante hello en dirección ascendente kernel de Red Hat 2.6.32 y se ha corregido en RHEL 6.6 (kernel-2.6.32-504).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-135">This issue primarily impacts older distributions using hello upstream Red Hat 2.6.32 kernel, and was fixed in RHEL 6.6 (kernel-2.6.32-504).</span></span> <span data-ttu-id="ce5e1-136">Sistemas que ejecutan kernels personalizados anteriores a 2.6.37 o basado en RHEL kernels anteriores que se debe establecer 2.6.32-504 Hola parámetro de arranque `numa=off` en kernel Hola de línea de comandos en grub.conf.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-136">Systems running custom kernels older than 2.6.37, or RHEL-based kernels older than 2.6.32-504 must set hello boot parameter `numa=off` on hello kernel command-line in grub.conf.</span></span> <span data-ttu-id="ce5e1-137">Para obtener más información, consulte Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-137">For more information see Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span></span>
* <span data-ttu-id="ce5e1-138">No configure una partición de intercambio en el disco del sistema operativo de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-138">Do not configure a swap partition on hello OS disk.</span></span> <span data-ttu-id="ce5e1-139">agente de Linux de Hello puede ser toocreate configurado un archivo de intercambio en el disco de recursos temporal Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-139">hello Linux agent can be configured toocreate a swap file on hello temporary resource disk.</span></span>  <span data-ttu-id="ce5e1-140">Para obtener más información acerca de este puede encontrarse en pasos Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-140">More information about this can be found in hello steps below.</span></span>
* <span data-ttu-id="ce5e1-141">Todos de hello discos duros virtuales deben tener que sean múltiplos de 1 MB.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-141">All of hello VHDs must have sizes that are multiples of 1 MB.</span></span>

### <a name="installing-kernel-modules-without-hyper-v"></a><span data-ttu-id="ce5e1-142">Instalación de los módulos de kernel sin Hyper-V</span><span class="sxs-lookup"><span data-stu-id="ce5e1-142">Installing kernel modules without Hyper-V</span></span>
<span data-ttu-id="ce5e1-143">Azure se ejecuta en hipervisor de Hyper-V de hello, por lo que Linux requiere que ciertos módulos de kernel se instalan en orden toorun en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-143">Azure runs on hello Hyper-V hypervisor, so Linux requires that certain kernel modules are installed in order toorun in Azure.</span></span> <span data-ttu-id="ce5e1-144">Si tiene una máquina virtual que se creó fuera de Hyper-V, instaladores de Linux Hola pueden no incluir Hola controladores para Hyper-V en ramdisk inicial de hello (initrd o initramfs) a menos que detecte que se está ejecutando un entorno de Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-144">If you have a VM that was created outside of Hyper-V, hello Linux installers may not include hello drivers for Hyper-V in hello initial ramdisk (initrd or initramfs) unless it detects that it is running an a Hyper-V environment.</span></span> <span data-ttu-id="ce5e1-145">Cuando se usa un tooprepare del sistema (es decir, Virtualbox, KVM, etc.) de virtualización distinto de la imagen de Linux, puede que necesite toorebuild Hola initrd tooensure que al menos Hola `hv_vmbus` y `hv_storvsc` módulos kernel están disponibles en ramdisk inicial Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-145">When using a different virtualization system (i.e. Virtualbox, KVM, etc.) tooprepare your Linux image, you may need toorebuild hello initrd tooensure that at least hello `hv_vmbus` and `hv_storvsc` kernel modules are available on hello initial ramdisk.</span></span>  <span data-ttu-id="ce5e1-146">Esto es un problema conocido al menos en sistemas basados en la distribución de Red Hat de nivel superior de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-146">This is a known issue at least on systems based on hello upstream Red Hat distribution.</span></span>

<span data-ttu-id="ce5e1-147">mecanismo de Hola para volver a generar Hola initrd o initramfs una imagen puede variar en función de distribución de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-147">hello mechanism for rebuilding hello initrd or initramfs image may vary depending on hello distribution.</span></span> <span data-ttu-id="ce5e1-148">Por favor, consulte la documentación de la distribución o de procedimiento correcto de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-148">Please consult your distribution's documentation or support for hello proper procedure.</span></span>  <span data-ttu-id="ce5e1-149">Este es un ejemplo de cómo toorebuild Hola initrd con hello `mkinitrd` utilidad:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-149">Here is one example for how toorebuild hello initrd using hello `mkinitrd` utility:</span></span>

<span data-ttu-id="ce5e1-150">En primer lugar, realizar copias de seguridad Hola existente initrd imagen:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-150">First, back up hello existing initrd image:</span></span>

    # cd /boot
    # sudo cp initrd-`uname -r`.img  initrd-`uname -r`.img.bak

<span data-ttu-id="ce5e1-151">A continuación, volver a generar Hola initrd con hello `hv_vmbus` y `hv_storvsc` módulos kernel:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-151">Next, rebuild hello initrd with hello `hv_vmbus` and `hv_storvsc` kernel modules:</span></span>

    # sudo mkinitrd --preload=hv_storvsc --preload=hv_vmbus -v -f initrd-`uname -r`.img `uname -r`


### <a name="resizing-vhds"></a><span data-ttu-id="ce5e1-152">Cambio de tamaño de los discos duros virtuales</span><span class="sxs-lookup"><span data-stu-id="ce5e1-152">Resizing VHDs</span></span>
<span data-ttu-id="ce5e1-153">Imágenes de disco duro virtual en Azure deben tener un too1MB virtual alineada con el tamaño.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-153">VHD images on Azure must have a virtual size aligned too1MB.</span></span>  <span data-ttu-id="ce5e1-154">Normalmente, los discos duros virtuales creados con Hyper-V ya deben alinearse correctamente.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-154">Typically, VHDs created using Hyper-V should already be aligned correctly.</span></span>  <span data-ttu-id="ce5e1-155">Si Hola VHD no está alineada correctamente, a continuación, es posible que reciba un error mensaje similares toohello siguientes cuando se intente toocreate una *imagen* desde el disco duro virtual:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-155">If hello VHD is not aligned correctly then you may receive an error message similar toohello following when you attempt toocreate an *image* from your VHD:</span></span>

    "hello VHD http://<mystorageaccount>.blob.core.windows.net/vhds/MyLinuxVM.vhd has an unsupported virtual size of 21475270656 bytes. hello size must be a whole number (in MBs).”

<span data-ttu-id="ce5e1-156">tooremedy Esto puede cambiar el tamaño Hola máquina virtual mediante la consola de administrador de Hyper-V de Hola o hello [Resize-VHD](http://technet.microsoft.com/library/hh848535.aspx) cmdlet de Powershell.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-156">tooremedy this you can resize hello VM using either hello Hyper-V Manager console or hello [Resize-VHD](http://technet.microsoft.com/library/hh848535.aspx) Powershell cmdlet.</span></span>  <span data-ttu-id="ce5e1-157">Si no se está ejecutando en un entorno de Windows, a continuación, se recomienda toouse qemu img tooconvert (si es necesario) y cambiar el tamaño de disco duro virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-157">If you are not running in a Windows environment then it is recommended toouse qemu-img tooconvert (if needed) and resize hello VHD.</span></span>

> [!NOTE]
> <span data-ttu-id="ce5e1-158">Hay un problema conocido en versiones de qemu-img >= 2.2.1 que da como resultado un VHD con formato incorrecto.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-158">There is a known bug in qemu-img versions >=2.2.1 that results in an improperly formatted VHD.</span></span> <span data-ttu-id="ce5e1-159">se ha solucionado el problema de Hello en QEMU 2.6.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-159">hello issue has been fixed in QEMU 2.6.</span></span> <span data-ttu-id="ce5e1-160">Se recomienda toouse qemu-img 2.2.0 o inferior o actualización too2.6 o superior.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-160">It is recommended toouse either qemu-img 2.2.0 or lower, or update too2.6 or higher.</span></span> <span data-ttu-id="ce5e1-161">Referencia: https://bugs.launchpad.net/qemu/+bug/1490611.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-161">Reference: https://bugs.launchpad.net/qemu/+bug/1490611.</span></span>
> 
> 

1. <span data-ttu-id="ce5e1-162">Cambiar el tamaño de Hola VHD directamente con herramientas como `qemu-img` o `vbox-manage` puede dar lugar a un disco duro virtual no se pueda arrancar.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-162">Resizing hello VHD directly using tools such as `qemu-img` or `vbox-manage` may result in an unbootable VHD.</span></span>  <span data-ttu-id="ce5e1-163">Por lo tanto, se recomienda toofirst convert Hola imagen de disco sin procesar de tooa de disco duro virtual.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-163">So it is recommended toofirst convert hello VHD tooa RAW disk image.</span></span>  <span data-ttu-id="ce5e1-164">Si ya se creó la imagen VM de hello como imagen de disco sin procesar (predeterminado de Hola para algunos hipervisores como KVM), a continuación, puede omitir este paso:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-164">If hello VM image was already created as RAW disk image (hello default for some Hypervisors such as KVM) then you may skip this step:</span></span>
   
       # qemu-img convert -f vpc -O raw MyLinuxVM.vhd MyLinuxVM.raw

2. <span data-ttu-id="ce5e1-165">Calcular Hola necesaria de tamaño de tooensure de imagen de disco de Hola que Hola tamaño virtual es too1MB alineado.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-165">Calculate hello required size of hello disk image tooensure that hello virtual size is aligned too1MB.</span></span>  <span data-ttu-id="ce5e1-166">Hola siguiente secuencia de comandos de shell de bash puede ayudarle con esto.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-166">hello following bash shell script can assist with this.</span></span>  <span data-ttu-id="ce5e1-167">script de Hola usa "`qemu-img info`" toodetermine Hola virtual tamaño de imagen de disco de hello y, a continuación, calcula Hola tamaño toohello siguiente 1 MB:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-167">hello script uses "`qemu-img info`" toodetermine hello virtual size of hello disk image and then calculates hello size toohello next 1MB:</span></span>
   
       rawdisk="MyLinuxVM.raw"
       vhddisk="MyLinuxVM.vhd"
   
       MB=$((1024*1024))
       size=$(qemu-img info -f raw --output json "$rawdisk" | \
              gawk 'match($0, /"virtual-size": ([0-9]+),/, val) {print val[1]}')
   
       rounded_size=$((($size/$MB + 1)*$MB))
       echo "Rounded Size = $rounded_size"

3. <span data-ttu-id="ce5e1-168">Cambiar el tamaño de disco sin procesar de hello mediante $rounded_size como se establece en hello por encima de la secuencia de comandos:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-168">Resize hello raw disk using $rounded_size as set in hello above script:</span></span>
   
       # qemu-img resize MyLinuxVM.raw $rounded_size

4. <span data-ttu-id="ce5e1-169">Ahora, convierta tooa atrás de disco sin procesar de hello VHD de tamaño fijo:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-169">Now, convert hello RAW disk back tooa fixed-size VHD:</span></span>
   
       # qemu-img convert -f raw -o subformat=fixed -O vpc MyLinuxVM.raw MyLinuxVM.vhd

   <span data-ttu-id="ce5e1-170">O bien, con la versión de qemu **2.6 +** incluyen hello `force_size` opción:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-170">Or, with qemu version **2.6+** include hello `force_size` option:</span></span>

       # qemu-img convert -f raw -o subformat=fixed,force_size -O vpc MyLinuxVM.raw MyLinuxVM.vhd

## <a name="linux-kernel-requirements"></a><span data-ttu-id="ce5e1-171">Requisitos para el kernel de Linux</span><span class="sxs-lookup"><span data-stu-id="ce5e1-171">Linux Kernel Requirements</span></span>
<span data-ttu-id="ce5e1-172">Hello controladores de servicios de integración de Linux (LIS) para Hyper-V y Azure se aportan directamente toohello ascendente kernel de Linux.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-172">hello Linux Integration Services (LIS) drivers for Hyper-V and Azure are contributed directly toohello upstream Linux kernel.</span></span> <span data-ttu-id="ce5e1-173">Muchas de las distribuciones que incluyen una versión reciente del kernel de Linux (por ejemplo, 3.x) ya tendrán estos controladores disponibles, o de lo contrario ofrecerán versiones con modificaciones de versiones anteriores de estos controladores con sus kernel.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-173">Many distributions that include a recent Linux kernel version (i.e. 3.x) will have these drivers available already, or otherwise provide backported versions of these drivers with their kernels.</span></span>  <span data-ttu-id="ce5e1-174">Estos controladores se actualizan constantemente en el núcleo de nivel superior Hola con correcciones y características, por lo que siempre que sea posible, se recomienda toorun una [están aprobados distribución](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) que incluyen estas correcciones y actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-174">These drivers are constantly being updated in hello upstream kernel with new fixes and features, so when possible it is recommended toorun an [endorsed distribution](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) that will include these fixes and updates.</span></span>

<span data-ttu-id="ce5e1-175">Si está ejecutando una variante de versiones de Red Hat Enterprise Linux **6.0 6.3**, necesitará controladores de tooinstall hello más recientes LIS para Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-175">If you are running a variant of Red Hat Enterprise Linux versions **6.0-6.3**, then you will need tooinstall hello latest LIS drivers for Hyper-V.</span></span> <span data-ttu-id="ce5e1-176">pueden encontrar controladores de Hello [en esta ubicación](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-176">hello drivers can be found [at this location](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span></span> <span data-ttu-id="ce5e1-177">A partir de RHEL **6.4 +** (y derivados) controladores LIS Hola ya están incluidos con kernel hello y por lo que ningún paquete de instalación adicionales es necesario toorun esos sistemas en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-177">As of RHEL **6.4+** (and derivatives) hello LIS drivers are already included with hello kernel and so no additional installation packages are needed toorun those systems on Azure.</span></span>

<span data-ttu-id="ce5e1-178">Si se requiere un kernel personalizado, es recomendable toouse una versión más reciente de kernel (es decir, **3.8 +**).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-178">If a custom kernel is required, it is recommended toouse a more recent kernel version (i.e. **3.8+**).</span></span> <span data-ttu-id="ce5e1-179">Para los proveedores que mantienen su propios kernel o los distribuciones, algunos esfuerzo será necesario tooregularly de atrás Hola LIS controladores del kernel de hello kernel ascendente tooyour personalizado de.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-179">For those distributions or vendors who maintain their own kernel, some effort will be required tooregularly backport hello LIS drivers from hello upstream kernel tooyour custom kernel.</span></span>  <span data-ttu-id="ce5e1-180">Incluso si ya está ejecutando una versión de kernel relativamente recientes, se recomienda encarecidamente tookeep realizar un seguimiento de cualquier en dirección ascendente correcciones en Atrás y controladores LIS hello las según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-180">Even if you are already running a relatively recent kernel version, it is highly recommended tookeep track of any upstream fixes in hello LIS drivers and backport those as needed.</span></span> <span data-ttu-id="ce5e1-181">ubicación de Hola Hola LIS origen de archivos de controlador está disponible en hello [MANTENEDORES](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) archivo hello Linux kernel árbol de origen:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-181">hello location of hello LIS driver source files is available in hello [MAINTAINERS](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) file in hello Linux kernel source tree:</span></span>

    F:    arch/x86/include/asm/mshyperv.h
    F:    arch/x86/include/uapi/asm/hyperv.h
    F:    arch/x86/kernel/cpu/mshyperv.c
    F:    drivers/hid/hid-hyperv.c
    F:    drivers/hv/
    F:    drivers/input/serio/hyperv-keyboard.c
    F:    drivers/net/hyperv/
    F:    drivers/scsi/storvsc_drv.c
    F:    drivers/video/fbdev/hyperv_fb.c
    F:    include/linux/hyperv.h
    F:    tools/hv/

<span data-ttu-id="ce5e1-182">Como mínimo, ausencia de Hola de hello después revisiones famosos toocause problemas en Azure y por lo que estos deben incluirse en el núcleo de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-182">At a very minimum, hello absence of hello following patches have been known toocause problems on Azure and so these must be included in hello kernel.</span></span> <span data-ttu-id="ce5e1-183">Esta lista no es exhaustiva ni está completa para todas las distribuciones:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-183">This list is by no means exhaustive or complete for all distributions:</span></span>

* [<span data-ttu-id="ce5e1-184">ata_piix: aplazar controladores de discos toohello Hyper-V de forma predeterminada</span><span class="sxs-lookup"><span data-stu-id="ce5e1-184">ata_piix: defer disks toohello Hyper-V drivers by default</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/ata/ata_piix.c?id=cd006086fa5d91414d8ff9ff2b78fbb593878e3c)
* [<span data-ttu-id="ce5e1-185">storvsc: la cuenta para los paquetes en tránsito en la ruta de acceso de restablecimiento de Hola</span><span class="sxs-lookup"><span data-stu-id="ce5e1-185">storvsc: Account for in-transit packets in hello RESET path</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/scsi/storvsc_drv.c?id=5c1b10ab7f93d24f29b5630286e323d1c5802d5c)
* [<span data-ttu-id="ce5e1-186">storvsc: Evitar el uso de WRITE_SAME</span><span class="sxs-lookup"><span data-stu-id="ce5e1-186">storvsc: avoid usage of WRITE_SAME</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=3e8f4f4065901c8dfc51407e1984495e1748c090)
* [<span data-ttu-id="ce5e1-187">storvsc: Deshabilita WRITE SAME para RAID y controladores del adaptador de host virtual</span><span class="sxs-lookup"><span data-stu-id="ce5e1-187">storvsc: Disable WRITE SAME for RAID and virtual host adapter drivers</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=54b2b50c20a61b51199bedb6e5d2f8ec2568fb43)
* [<span data-ttu-id="ce5e1-188">storvsc: Corrección de desreferenciación del puntero NULL</span><span class="sxs-lookup"><span data-stu-id="ce5e1-188">storvsc: NULL pointer dereference fix</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=b12bb60d6c350b348a4e1460cd68f97ccae9822e)
* [<span data-ttu-id="ce5e1-189">storvsc: Los errores de búfer de anillo pueden dar lugar a una inmovilización de E/S</span><span class="sxs-lookup"><span data-stu-id="ce5e1-189">storvsc: ring buffer failures may result in I/O freeze</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=e86fb5e8ab95f10ec5f2e9430119d5d35020c951)
* [<span data-ttu-id="ce5e1-190">scsi_sysfs: Protección contra la ejecución doble de __scsi_remove_device</span><span class="sxs-lookup"><span data-stu-id="ce5e1-190">scsi_sysfs: protect against double execution of __scsi_remove_device</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/scsi_sysfs.c?id=be821fd8e62765de43cc4f0e2db363d0e30a7e9b)

## <a name="hello-azure-linux-agent"></a><span data-ttu-id="ce5e1-191">Hola agente Linux de Azure</span><span class="sxs-lookup"><span data-stu-id="ce5e1-191">hello Azure Linux Agent</span></span>
<span data-ttu-id="ce5e1-192">Hola [agente Linux de Azure](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) se requiere tooproperly aprovisionar una máquina virtual de Linux en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-192">hello [Azure Linux Agent](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) is required tooproperly provision a Linux virtual machine in Azure.</span></span> <span data-ttu-id="ce5e1-193">Puede obtener la versión más reciente de hello, problemas de archivos o enviar solicitudes de extracción en hello [repositorio de GitHub de agente de Linux](https://github.com/Azure/WALinuxAgent).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-193">You can get hello latest version, file issues or submit pull requests at hello [Linux Agent GitHub repo](https://github.com/Azure/WALinuxAgent).</span></span>

* <span data-ttu-id="ce5e1-194">agente de Linux Hola se libera bajo licencia de Apache 2.0 Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-194">hello Linux agent is released under hello Apache 2.0 license.</span></span> <span data-ttu-id="ce5e1-195">Número de distribuciones ya proporciona RPM o deb paquetes para agente de hello, y por lo que en algunos casos esto se puede instalar y actualizar con poco esfuerzo.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-195">Many distributions already provide RPM or deb packages for hello agent, and so in some cases this can be installed and updated with little effort.</span></span>
* <span data-ttu-id="ce5e1-196">Hola agente Linux de Azure requiere Python v2.6 +.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-196">hello Azure Linux Agent requires Python v2.6+.</span></span>
* <span data-ttu-id="ce5e1-197">agente de Hello también requiere el módulo de python pyasn1 de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-197">hello agent also requires hello python-pyasn1 module.</span></span> <span data-ttu-id="ce5e1-198">La mayoría de distribuciones lo proporcionan como un paquete independiente que se puede instalar.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-198">Most distributions provide this as a separate package that can be installed.</span></span>
* <span data-ttu-id="ce5e1-199">En algunos casos es posible que no sea compatible con NetworkManager Hola agente Linux de Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-199">In some cases hello Azure Linux Agent may not be compatible with NetworkManager.</span></span> <span data-ttu-id="ce5e1-200">Muchos de los paquetes RPM/Deb Hola proporcionados por las distribuciones configuración NetworkManager como un paquete de waagent toohello de conflicto y, por tanto, desinstalarán NetworkManager al instalar paquetes de agente de Linux Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-200">Many of hello RPM/Deb packages provided by distributions configure NetworkManager as a conflict toohello waagent package, and thus will uninstall NetworkManager when you install hello Linux agent package.</span></span>

## <a name="general-linux-system-requirements"></a><span data-ttu-id="ce5e1-201">Requisitos generales del sistema Linux</span><span class="sxs-lookup"><span data-stu-id="ce5e1-201">General Linux System Requirements</span></span>

* <span data-ttu-id="ce5e1-202">Modificar línea de arranque de kernel de hello en GRUB o GRUB2 hello tooinclude parámetros siguientes.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-202">Modify hello kernel boot line in GRUB or GRUB2 tooinclude hello following parameters.</span></span> <span data-ttu-id="ce5e1-203">Esto garantizará también todos los mensajes de la consola se envían toohello primer puerto serie, que puede ayudar a Azure compatibilidad con la depuración de problemas:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-203">This will also ensure all console messages are sent toohello first serial port, which can assist Azure support with debugging issues:</span></span>
  
        console=ttyS0,115200n8 earlyprintk=ttyS0,115200 rootdelay=300
  
    <span data-ttu-id="ce5e1-204">Esto garantizará también todos los mensajes de la consola se envían toohello primer puerto serie, que puede ayudar a Azure compatibilidad con la depuración de problemas.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-204">This will also ensure all console messages are sent toohello first serial port, which can assist Azure support with debugging issues.</span></span>
  
    <span data-ttu-id="ce5e1-205">Además toohello anterior, se recomienda demasiado*quitar* Hola siguientes parámetros si existen:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-205">In addition toohello above, it is recommended too*remove* hello following parameters if they exist:</span></span>
  
        rhgb quiet crashkernel=auto
  
    <span data-ttu-id="ce5e1-206">Arranque gráfica y silencioso no son útiles en un entorno de nube donde se desea que todos los toobe de registros de hello envía toohello de puerto serie.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-206">Graphical and quiet boot are not useful in a cloud environment where we want all hello logs toobe sent toohello serial port.</span></span> <span data-ttu-id="ce5e1-207">Hola `crashkernel` opción puede ser izquierda configurado si lo desea, pero tenga en cuenta que este parámetro reducirá la cantidad de Hola de memoria disponible en hello máquina virtual por medio de 128 MB o más, lo que puede ser problemático en tamaños VM de hello más pequeños.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-207">hello `crashkernel` option may be left configured if desired, but note that this parameter will reduce hello amount of available memory in hello VM by 128MB or more, which may be problematic on hello smaller VM sizes.</span></span>

* <span data-ttu-id="ce5e1-208">Hola instalar Agente Linux de Azure</span><span class="sxs-lookup"><span data-stu-id="ce5e1-208">Installing hello Azure Linux Agent</span></span>
  
    <span data-ttu-id="ce5e1-209">Hola agente Linux de Azure es necesario para el aprovisionamiento de una imagen de Linux en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-209">hello Azure Linux Agent is required for provisioning a Linux image on Azure.</span></span>  <span data-ttu-id="ce5e1-210">Número de distribuciones proporciona agente Hola como un paquete RPM o Deb (normalmente se denomina paquete hello 'WALinuxAgent' o 'walinuxagent').</span><span class="sxs-lookup"><span data-stu-id="ce5e1-210">Many distributions provide hello agent as an RPM or Deb package (hello package is typically called 'WALinuxAgent' or 'walinuxagent').</span></span>  <span data-ttu-id="ce5e1-211">Hello agente también se puede instalar manualmente siguiendo los pasos de Hola Hola [Guía de agente de Linux](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="ce5e1-211">hello agent can also be installed manually by following hello steps in hello [Linux Agent Guide](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

* <span data-ttu-id="ce5e1-212">Asegúrese de que el servidor SSH Hola se instala y configura toostart al arrancar el sistema.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-212">Ensure that hello SSH server is installed and configured toostart at boot time.</span></span>  <span data-ttu-id="ce5e1-213">Esto suele ser el predeterminado de Hola.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-213">This is usually hello default.</span></span>

* <span data-ttu-id="ce5e1-214">No cree el espacio de intercambio en el disco del sistema operativo de Hola</span><span class="sxs-lookup"><span data-stu-id="ce5e1-214">Do not create swap space on hello OS disk</span></span>
  
    <span data-ttu-id="ce5e1-215">Hola agente Linux de Azure puede configurar automáticamente el espacio de intercambio con el disco del recurso local Hola que está adjunto toohello VM después de aprovisionar en Azure.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-215">hello Azure Linux Agent can automatically configure swap space using hello local resource disk that is attached toohello VM after provisioning on Azure.</span></span> <span data-ttu-id="ce5e1-216">Tenga en cuenta ese disco del recurso local hello es un *temporal* en disco y puede ser vaciada cuando Hola VM es deprovisioned.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-216">Note that hello local resource disk is a *temporary* disk, and might be emptied when hello VM is deprovisioned.</span></span> <span data-ttu-id="ce5e1-217">Después de instalar Hola agente Linux de Azure (vea el paso anterior), modificar Hola parámetros en /etc/waagent.conf siguientes correctamente:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-217">After installing hello Azure Linux Agent (see previous step), modify hello following parameters in /etc/waagent.conf appropriately:</span></span>
  
        ResourceDisk.Format=y
        ResourceDisk.Filesystem=ext4
        ResourceDisk.MountPoint=/mnt/resource
        ResourceDisk.EnableSwap=y
        ResourceDisk.SwapSizeMB=2048    ## NOTE: set this toowhatever you need it toobe.

* <span data-ttu-id="ce5e1-218">Como paso final, ejecute hello después de la máquina virtual de comandos toodeprovision hello:</span><span class="sxs-lookup"><span data-stu-id="ce5e1-218">As a final step, run hello following commands toodeprovision hello virtual machine:</span></span>
  
        # sudo waagent -force -deprovision
        # export HISTSIZE=0
        # logout
  
  > [!NOTE]
  > <span data-ttu-id="ce5e1-219">En Virtualbox se puede ver Hola siguiente error después de ejecutar ' waagent-force - desaprovisionamiento ': `[Errno 5] Input/output error`.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-219">On Virtualbox you may see hello following error after running 'waagent -force -deprovision': `[Errno 5] Input/output error`.</span></span> <span data-ttu-id="ce5e1-220">Este mensaje de error no es crítico, por lo que se puede omitir.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-220">This error message is not critical and can be ignored.</span></span>
  > 
  > 

* <span data-ttu-id="ce5e1-221">A continuación, necesitará tooshut hacia abajo de la máquina virtual de Hola y cargar hello tooAzure de disco duro virtual.</span><span class="sxs-lookup"><span data-stu-id="ce5e1-221">You will then need tooshut down hello virtual machine and upload hello VHD tooAzure.</span></span>

