---
title: aaaRun Casandra con Linux en Azure | Documentos de Microsoft
description: "Cómo toorun una Casandra de Cluster Server en Linux en máquinas virtuales de Azure desde una aplicación Node.js."
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 381ca301bbe88d3740cf182f9c44fada5b9ba7cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="25d0f-103">Ejecución de Cassandra con Linux en Azure y acceso desde Node.js</span><span class="sxs-lookup"><span data-stu-id="25d0f-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="25d0f-104">Azure tiene dos modelos de implementación diferentes para crear recursos y trabajar con ellos: [Resource Manager y el clásico](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="25d0f-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="25d0f-105">Este artículo tratan con modelo de implementación de hello clásico.</span><span class="sxs-lookup"><span data-stu-id="25d0f-105">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="25d0f-106">Microsoft recomienda que más nuevas implementaciones de usar el modelo del Administrador de recursos de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-106">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="25d0f-107">Consulte las plantillas de Resource Manager para [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) y el [clúster de Spark y Cassandra en CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="25d0f-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="25d0f-108">Información general</span><span class="sxs-lookup"><span data-stu-id="25d0f-108">Overview</span></span>
<span data-ttu-id="25d0f-109">Microsoft Azure es una plataforma de nube abierta que ejecuta tanto software de Microsoft como ajeno a Microsoft que incluye sistemas operativos, servidores de aplicaciones, middleware de mensajería, así como bases de datos SQL y NoSQL tanto de modelos comerciales como de código abierto.</span><span class="sxs-lookup"><span data-stu-id="25d0f-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="25d0f-110">Crear servicios resistentes en nubes públicas, incluido Azure, requiere una cuidadosa planeación y una arquitectura deliberada para ambos servidores de aplicaciones, así como capas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="25d0f-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="25d0f-111">La arquitectura de almacenamiento distribuido de Cassandra ayuda naturalmente a crear sistemas de alta disponibilidad que son tolerantes a errores de clúster.</span><span class="sxs-lookup"><span data-stu-id="25d0f-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="25d0f-112">Cassandra es una base de datos NoSQL de escala de nube mantenida por Apache Software Foundation en cassandra.apache.org; Cassandra está escrita en Java y, por tanto, se ejecuta tanto en plataformas Windows como Linux.</span><span class="sxs-lookup"><span data-stu-id="25d0f-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="25d0f-113">enfoque Hola de este artículo es la implementación de Casandra tooshow en Ubuntu, ejecute como un clúster único y múltiples data center aprovechar las máquinas virtuales de Microsoft Azure y redes virtuales.</span><span class="sxs-lookup"><span data-stu-id="25d0f-113">hello focus of this article is tooshow Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="25d0f-114">Hello para cargas de trabajo de producción con optimización para la implementación del clúster se fuera del ámbito de este artículo porque requiere la configuración de disco de múltiples nodos, diseño de la topología de anillo adecuado y toosupport Hola de modelado de datos necesitan replicación, la coherencia de los datos, rendimiento y requisitos de alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-114">hello cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling toosupport hello needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="25d0f-115">Esta forma de artículo un tooshow enfoque fundamentales las implicaciones de creación Hola clúster Casandra en comparación con Docker, Chef o Puppet lo que puede hacer Hola mucho más fácil de implementación de la infraestructura.</span><span class="sxs-lookup"><span data-stu-id="25d0f-115">This article takes a fundamental approach tooshow what is involved in building hello Cassandra cluster compared Docker, Chef or Puppet which can make hello infrastructure deployment a lot easier.</span></span>  

## <a name="hello-deployment-models"></a><span data-ttu-id="25d0f-116">Hola modelos de implementación</span><span class="sxs-lookup"><span data-stu-id="25d0f-116">hello Deployment Models</span></span>
<span data-ttu-id="25d0f-117">Redes de Microsoft Azure permiten la implementación de Hola de clústeres privados aislados, acceso Hola de los cuales puede ser tooattain restringido seguridad de un problema de red específica.</span><span class="sxs-lookup"><span data-stu-id="25d0f-117">Microsoft Azure networking allows hello deployment of isolated private clusters, hello access of which can be restricted tooattain fine grained network security.</span></span>  <span data-ttu-id="25d0f-118">Puesto que este artículo trata sobre la que muestra la implementación de Casandra hello en un nivel fundamental, no nos centraremos en nivel de coherencia de Hola y el diseño de almacenamiento sean óptimos de hello para el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="25d0f-118">Since this article is about showing hello Cassandra deployment at a fundamental level, we will not focus on hello consistency level and hello optimal storage design for throughput.</span></span> <span data-ttu-id="25d0f-119">Esta es Hola lista de requisitos de red para nuestro clúster hipotético:</span><span class="sxs-lookup"><span data-stu-id="25d0f-119">Here is hello list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="25d0f-120">Los sistemas externos no tienen acceso a la base de datos Cassandra desde dentro o fuera de Azure</span><span class="sxs-lookup"><span data-stu-id="25d0f-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="25d0f-121">Clúster de Casandra tiene toobe detrás de un equilibrador de carga para el tráfico de thrift</span><span class="sxs-lookup"><span data-stu-id="25d0f-121">Cassandra cluster has toobe behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="25d0f-122">Implemente nodos de Cassandra en dos grupos en cada centro de datos para una disponibilidad mejorada</span><span class="sxs-lookup"><span data-stu-id="25d0f-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="25d0f-123">Bloquear clúster Hola así solo el conjunto de servidores de aplicación tiene base de datos de access toohello directamente</span><span class="sxs-lookup"><span data-stu-id="25d0f-123">Lock down hello cluster so that only application server farm has access toohello database directly</span></span>
* <span data-ttu-id="25d0f-124">Ningún extremo de red pública distinto a SSH</span><span class="sxs-lookup"><span data-stu-id="25d0f-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="25d0f-125">Cada nodo de Cassandra necesita una dirección IP interna fija</span><span class="sxs-lookup"><span data-stu-id="25d0f-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="25d0f-126">Casandra puede ser implementado tooa sola región de Azure o las regiones de toomultiple según su naturaleza distribuida de Hola de carga de trabajo de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-126">Cassandra can be deployed tooa single Azure region or toomultiple regions based on hello distributed nature of hello workload.</span></span> <span data-ttu-id="25d0f-127">Modelo de implementación de varias regiones puede ser aprovechado tooserve a los usuarios finales más cerca de tooa determinado geography a través de hello misma infraestructura de Casandra.</span><span class="sxs-lookup"><span data-stu-id="25d0f-127">Multi-region deployment model can be leveraged tooserve end users closer tooa particular geography through hello same Cassandra infrastructure.</span></span> <span data-ttu-id="25d0f-128">La replicación se encarga de Casandra nodo integrado de sincronización de Hola de varios maestros escribe procedentes de varios centros de datos y presenta una vista coherente de hello tooapplications de datos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-128">Cassandra’s built-in node replication takes care of hello synchronization of multi-master writes originating from multiple data centers and presents a consistent view of hello data tooapplications.</span></span> <span data-ttu-id="25d0f-129">Implementación de varias regiones también puede ayudar con la mitigación de riesgos de Hola Hola más amplio Azure interrupción del servicio.</span><span class="sxs-lookup"><span data-stu-id="25d0f-129">Multi-region deployment can also help with hello risk mitigation of hello broader Azure service outages.</span></span> <span data-ttu-id="25d0f-130">La coherencia ajustable de Cassandra y la topología de la replicación le ayudará a satisfacer distintas necesidades RPO de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="25d0f-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="25d0f-131">Implementación de una sola región</span><span class="sxs-lookup"><span data-stu-id="25d0f-131">Single Region Deployment</span></span>
<span data-ttu-id="25d0f-132">Empezaremos con una implementación única región y cosecha Hola basándonos en la creación de un modelo de varias regiones.</span><span class="sxs-lookup"><span data-stu-id="25d0f-132">We will start with a single region deployment and harvest hello learnings in creating a multi-region model.</span></span> <span data-ttu-id="25d0f-133">Red virtual de Azure será usado toocreate aislada subredes para que se puedan cumplir requisitos de seguridad de red de hello mencionados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-133">Azure virtual networking will be used toocreate isolated subnets so that hello network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="25d0f-134">proceso de Hello descrito en la creación de la implementación de una única región hello usa Ubuntu 14.04 LTS y Casandra 2.08; Sin embargo, el proceso de hello puede fácilmente ser toohello adoptado otras variantes de Linux.</span><span class="sxs-lookup"><span data-stu-id="25d0f-134">hello process described in creating hello single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, hello process can easily be adopted toohello other Linux variants.</span></span> <span data-ttu-id="25d0f-135">siguiente Hola es algunas características sistémicas de Hola de implementación en una sola región Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-135">hello following are some of hello systemic characteristics of hello single region deployment.</span></span>  

<span data-ttu-id="25d0f-136">**Alta disponibilidad:** Hola nodos Casandra se muestra en la figura 1 se implementan de Hola tootwo disponibilidad se establece para que los nodos de hello están repartidos entre varios dominios de error para lograr alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-136">**High Availability:** hello Cassandra nodes shown in hello Figure 1 are deployed tootwo availability sets so that hello nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="25d0f-137">Máquinas virtuales que se anota con cada conjunto de disponibilidad es too2 asignado los dominios de error.</span><span class="sxs-lookup"><span data-stu-id="25d0f-137">VMs annotated with each availability set is mapped too2 fault domains.</span></span>  <span data-ttu-id="25d0f-138">Microsoft Azure usa Hola concepto de toomanage de dominio de error no planeada hacia abajo de tiempo (por ejemplo, los errores de hardware o software) al concepto de Hola de dominio de actualización (por ejemplo, host o invitado aplicación de revisiones y actualizaciones de sistema operativo, las actualizaciones de aplicaciones) se utiliza para administrar programado tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-138">Microsoft Azure uses hello concept of fault domain toomanage unplanned down time (e.g. hardware or software failures) while hello concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="25d0f-139">Vea [recuperación ante desastres y alta disponibilidad para aplicaciones de Azure](http://msdn.microsoft.com/library/dn251004.aspx) para rol de Hola de dominios de error y de actualización para alcanzar la alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for hello role of fault and upgrade domains in attaining high availability.</span></span>

![Implementación de una sola región](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="25d0f-141">Ilustración 1: Implementación de una sola región</span><span class="sxs-lookup"><span data-stu-id="25d0f-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="25d0f-142">Tenga en cuenta que en tiempo de Hola de redactar este artículo, Azure no permite una asignación explícita de un grupo de dominio de error concreto de máquinas virtuales tooa; Hola por lo tanto, incluso con el modelo de implementación de Hola que se muestra en la figura 1, es estadísticamente probable que todas las máquinas virtuales de hello puede ser tootwo asignado los dominios de error en lugar de cuatro.</span><span class="sxs-lookup"><span data-stu-id="25d0f-142">Note that at hello time of this writing, Azure doesn’t allow hello explicit mapping of a group of VMs tooa specific fault domain; consequently, even with hello deployment model shown in Figure 1, it is statistically probable that all hello virtual machines may be mapped tootwo fault domains instead of four.</span></span>

<span data-ttu-id="25d0f-143">**Tráfico de Thrift de equilibrio de carga:** bibliotecas de cliente de Thrift dentro de hello web server conectan el clúster de toohello a través de un equilibrador de carga interno.</span><span class="sxs-lookup"><span data-stu-id="25d0f-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside hello web server connect toohello cluster through an internal load balancer.</span></span> <span data-ttu-id="25d0f-144">Esto requiere el proceso de Hola de Agregar subred de datos"toohello de equilibrador de carga interno de saludo" (consulte la figura 1) en el contexto de hello del servicio de nube de hello hospeda hello Casandra clúster.</span><span class="sxs-lookup"><span data-stu-id="25d0f-144">This requires hello process of adding hello internal load balancer toohello “data” subnet (refer Figure 1) in hello context of hello cloud service hosting hello Cassandra cluster.</span></span> <span data-ttu-id="25d0f-145">Una vez definido el equilibrador de carga interno de hello, cada nodo requiere toobe de extremo con equilibrio de carga de hello agregado con anotaciones de Hola de un conjunto de carga equilibrada con los nombre del equilibrador de carga definidos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-145">Once hello internal load balancer is defined, each node requires hello load balanced endpoint toobe added with hello annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="25d0f-146">Consulte [Equilibrio de carga interno de Azure ](../../../load-balancer/load-balancer-internal-overview.md)para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="25d0f-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="25d0f-147">**Valores de inicialización de clúster:** es importante tooselect Hola nodos de alta disponibilidad de la mayoría de valores de inicialización como Hola nuevos nodos se comunicarán con topología de Hola de toodiscover inicialización nodos de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-147">**Cluster Seeds:** It is important tooselect hello most highly available nodes for seeds as hello new nodes will communicate with seed nodes toodiscover hello topology of hello cluster.</span></span> <span data-ttu-id="25d0f-148">Un nodo de cada conjunto de disponibilidad se designa como valor de inicialización nodos tooavoid punto de error único.</span><span class="sxs-lookup"><span data-stu-id="25d0f-148">One node from each availability set is designated as seed nodes tooavoid single point of failure.</span></span>

<span data-ttu-id="25d0f-149">**Factor de replicación y el nivel de coherencia:** compilación de alta disponibilidad y datos durabilidad de Casandra se caracteriza por hello Factor de replicación (RF - número de copias de cada fila almacenada en el clúster de hello) y el nivel de coherencia (número de réplicas toobe leídos/escritos antes de devolver el autor de llamada de hello resultado toohello).</span><span class="sxs-lookup"><span data-stu-id="25d0f-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by hello Replication Factor (RF - number of copies of each row stored on hello cluster) and Consistency Level (number of replicas toobe read/written before returning hello result toohello caller).</span></span> <span data-ttu-id="25d0f-150">Factor de replicación se especifica durante Hola creación KEYSPACE (base de datos relacional de similar tooa), mientras que se especifica el nivel de coherencia de hello al emitir consultas CRUD Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-150">Replication factor is specified during hello KEYSPACE (similar tooa relational database) creation whereas hello consistency level is specified while issuing hello CRUD query.</span></span> <span data-ttu-id="25d0f-151">Consulte la documentación de Casandra en [configurar para mantener la coherencia](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) para obtener detalles de la coherencia y fórmula hello para el cálculo de quórum.</span><span class="sxs-lookup"><span data-stu-id="25d0f-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and hello formula for quorum computation.</span></span>

<span data-ttu-id="25d0f-152">Casandra admite dos tipos de modelos de integridad de datos: coherencia y coherencia definitiva; Hola Factor de replicación y el nivel de coherencia juntos determinará si los datos de hello serán coherentes tan pronto como se ha completado una operación de escritura o será coherente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; hello Replication Factor and Consistency Level will together determine if hello data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="25d0f-153">Por ejemplo, especificar QUÓRUM ya Hola que usarán el nivel de coherencia garantiza datos coherencia durante cualquier nivel de coherencia, debajo de número de Hola de toobe de réplicas que se escribe como sea necesario tooattain resultados QUÓRUM (por ejemplo, uno) de datos es coherente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-153">For example, specifying QUORUM as hello Consistency Level will always ensures data Consistency while any consistency level, below hello number of replicas toobe written as needed tooattain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="25d0f-154">clúster de 8 nodos de Hello mostrado anteriormente, con un factor de replicación de QUÓRUM y 3 (2 nodos se leen o escritos por motivos de coherencia) nivel de coherencia de lectura/escritura, puede sobrevivir a la pérdida teórico de Hola de en hello mayoría 1 nodo por replicación grupo antes de iniciar la aplicación hello teniendo en cuenta el error de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-154">hello 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive hello theoretical loss of at hello most 1 node per replication group before hello application start noticing hello failure.</span></span> <span data-ttu-id="25d0f-155">Se supone que todos los espacios de clave de hello también han equilibra las solicitudes de lectura/escritura.</span><span class="sxs-lookup"><span data-stu-id="25d0f-155">This assumes that all hello key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="25d0f-156">siguiente Hola es parámetros de Hola que se usará para el clúster de hello implementado:</span><span class="sxs-lookup"><span data-stu-id="25d0f-156">hello following are hello parameters we will use for hello deployed cluster:</span></span>

<span data-ttu-id="25d0f-157">Configuración de clúster de Cassandra de una sola región:</span><span class="sxs-lookup"><span data-stu-id="25d0f-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="25d0f-158">Parámetro de clúster</span><span class="sxs-lookup"><span data-stu-id="25d0f-158">Cluster Parameter</span></span> | <span data-ttu-id="25d0f-159">Valor</span><span class="sxs-lookup"><span data-stu-id="25d0f-159">Value</span></span> | <span data-ttu-id="25d0f-160">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="25d0f-161">Número de nodos (N)</span><span class="sxs-lookup"><span data-stu-id="25d0f-161">Number of Nodes (N)</span></span> |<span data-ttu-id="25d0f-162">8</span><span class="sxs-lookup"><span data-stu-id="25d0f-162">8</span></span> |<span data-ttu-id="25d0f-163">Número total de nodos de clúster de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-163">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="25d0f-164">Factor de replicación (RF)</span><span class="sxs-lookup"><span data-stu-id="25d0f-164">Replication Factor (RF)</span></span> |<span data-ttu-id="25d0f-165">3</span><span class="sxs-lookup"><span data-stu-id="25d0f-165">3</span></span> |<span data-ttu-id="25d0f-166">Número de réplicas de una fila determinada</span><span class="sxs-lookup"><span data-stu-id="25d0f-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="25d0f-167">Nivel de coherencia (escritura)</span><span class="sxs-lookup"><span data-stu-id="25d0f-167">Consistency Level (Write)</span></span> |<span data-ttu-id="25d0f-168">QUORUM[(RF/2) +1) = 2] Hola result de hello fórmula se redondea hacia abajo</span><span class="sxs-lookup"><span data-stu-id="25d0f-168">QUORUM[(RF/2) +1) = 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="25d0f-169">Escribe en hello mayoría 2 réplicas antes de enviar respuesta hello toohello llamador; réplica 3rd se escribe de forma coherente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-169">Writes at hello most 2 replicas before hello response is sent toohello caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="25d0f-170">Nivel de coherencia (lectura)</span><span class="sxs-lookup"><span data-stu-id="25d0f-170">Consistency Level (Read)</span></span> |<span data-ttu-id="25d0f-171">QUÓRUM [(RF/2) + 1 = 2] se redondea el resultado de hello de fórmula de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-171">QUORUM [(RF/2) +1= 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="25d0f-172">Lee 2 réplicas antes de enviar el autor de llamada de respuesta toohello.</span><span class="sxs-lookup"><span data-stu-id="25d0f-172">Reads 2 replicas before sending response toohello caller.</span></span> |
| <span data-ttu-id="25d0f-173">Estrategia de replicación</span><span class="sxs-lookup"><span data-stu-id="25d0f-173">Replication Strategy</span></span> |<span data-ttu-id="25d0f-174">NetworkTopologyStrategy vea la [replicación de datos](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) en la documentación de Cassandra para obtener más información</span><span class="sxs-lookup"><span data-stu-id="25d0f-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="25d0f-175">Entiende la topología de implementación de Hola y coloca las réplicas en los nodos para que todas las réplicas de hello no terminan en hello mismo bastidor</span><span class="sxs-lookup"><span data-stu-id="25d0f-175">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="25d0f-176">Snitch</span><span class="sxs-lookup"><span data-stu-id="25d0f-176">Snitch</span></span> |<span data-ttu-id="25d0f-177">GossipingPropertyFileSnitch. Vea [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) en la documentación de Cassandra para más información</span><span class="sxs-lookup"><span data-stu-id="25d0f-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="25d0f-178">NetworkTopologyStrategy utiliza un concepto de topología de snitch toounderstand Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-178">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="25d0f-179">GossipingPropertyFileSnitch ofrece un mejor control de asignación de cada centro de toodata de nodo y bastidor.</span><span class="sxs-lookup"><span data-stu-id="25d0f-179">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="25d0f-180">clúster de Hello, a continuación, usa cotilleos toopropagate esta información.</span><span class="sxs-lookup"><span data-stu-id="25d0f-180">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="25d0f-181">Esto es mucho más fácil en tooPropertyFileSnitch relativa de configuración de IP dinámica</span><span class="sxs-lookup"><span data-stu-id="25d0f-181">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

<span data-ttu-id="25d0f-182">**Consideraciones de Azure para el clúster de Cassandra**: La funcionalidad Microsoft Azure Virtual Machines usa Azure Blob Storage para la persistencia de disco; Azure Storage guarda tres réplicas de cada disco que proporcionan gran durabilidad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="25d0f-183">Esto significa que cada fila de datos insertados en una tabla de Casandra ya está almacenada en 3 réplicas y, por tanto, coherencia de los datos es ya controlada aunque Hola Factor de replicación (RF) es 1.</span><span class="sxs-lookup"><span data-stu-id="25d0f-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if hello Replication Factor (RF) is 1.</span></span> <span data-ttu-id="25d0f-184">Hola principal problema con el Factor de replicación que se va a 1 es aplicación hello experimentarán tiempo de inactividad incluso si se produce un error en un único nodo Casandra.</span><span class="sxs-lookup"><span data-stu-id="25d0f-184">hello main problem with Replication Factor being 1 is that hello application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="25d0f-185">Sin embargo, si un nodo está inactivo para problemas de hello (p. ej., hardware, errores de software del sistema) reconocidos por el controlador de tejido de Azure, proporcionará un nuevo nodo en su lugar con hello las mismas unidades de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="25d0f-185">However, if a node is down for hello problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using hello same storage drives.</span></span> <span data-ttu-id="25d0f-186">Aprovisionamiento de un nuevo nodo tooreplace Hola antiguo uno puede tardar unos minutos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-186">Provisioning a new node tooreplace hello old one may take a few minutes.</span></span>  <span data-ttu-id="25d0f-187">De forma similar para las actividades de mantenimiento planificado como los cambios del sistema operativo invitado, Casandra actualiza y cambios en la aplicación controlador de tejido de Azure lleva a cabo actualizaciones sucesivas de nodos de hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of hello nodes in hello cluster.</span></span>  <span data-ttu-id="25d0f-188">Actualizaciones sucesivas también pueden dar de baja varios nodos a la vez y, por tanto, clúster de hello puede experimentar breve período de inactividad para algunas particiones.</span><span class="sxs-lookup"><span data-stu-id="25d0f-188">Rolling upgrades also may take down a few nodes at a time and hence hello cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="25d0f-189">Sin embargo, no se perderán debido redundancia de almacenamiento de Azure integrada toohello Hola datos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-189">However, hello data will not be lost due toohello built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="25d0f-190">Para los sistemas implementaron tooAzure que no necesita una alta disponibilidad (por ejemplo, 99,9 aproximadamente que es equivalente too8.76 horas/año; vea [alta disponibilidad](http://en.wikipedia.org/wiki/High_availability) para obtener más información) puede ser capaz de toorun con RF = 1 y nivel de coherencia = uno.</span><span class="sxs-lookup"><span data-stu-id="25d0f-190">For systems deployed tooAzure that doesn’t require high availability (e.g. around 99.9 which is equivalent too8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able toorun with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="25d0f-191">Para las aplicaciones con requisitos de alta disponibilidad, RF = 3 y el nivel de coherencia = QUÓRUM tolerarán Hola tiempo de inactividad de uno de hello nodos de réplicas de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate hello down time of one of hello nodes one of hello replicas.</span></span> <span data-ttu-id="25d0f-192">RF = 1 en las implementaciones tradicionales (por ejemplo, local) no se puede usar debido toohello posible pérdida de datos resultantes de los problemas como errores de disco.</span><span class="sxs-lookup"><span data-stu-id="25d0f-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due toohello possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="25d0f-193">Implementación en varias regiones</span><span class="sxs-lookup"><span data-stu-id="25d0f-193">Multi-region Deployment</span></span>
<span data-ttu-id="25d0f-194">Replicación center-orientadas a datos y el modelo de coherencia se ha descrito anteriormente ayuda con la implementación de varias regiones de hello fuera del cuadro de hello sin Hola de Casandra necesitan para las herramientas externas.</span><span class="sxs-lookup"><span data-stu-id="25d0f-194">Cassandra’s data-center-aware replication and consistency model described above helps with hello multi-region deployment out of hello box without hello need for any external tooling.</span></span> <span data-ttu-id="25d0f-195">Esto es bastante diferente de bases de datos relacionales Hola tradicional donde el programa de instalación de hello para la creación de reflejo de base de datos de varios maestros escribe puede ser bastante compleja.</span><span class="sxs-lookup"><span data-stu-id="25d0f-195">This is quite different from hello traditional relational databases where hello setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="25d0f-196">Puede ayudar Casandra en una región múltiples configurar con escenarios de uso de hello incluidos Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-196">Cassandra in a multi-region set up can help with hello usage scenarios including hello following:</span></span>

<span data-ttu-id="25d0f-197">**Implementación basada en proximidad:** aplicaciones de varios inquilinos, con borrar la asignación de usuarios del inquilino-a-región, se puede beneficiado por las latencias baja del clúster de hello varias regiones.</span><span class="sxs-lookup"><span data-stu-id="25d0f-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by hello multi-region cluster’s low latencies.</span></span> <span data-ttu-id="25d0f-198">Por ejemplo un aprendizaje de administración de sistemas para instituciones educativas pueden implementar un clúster distribuido en UU y oeste de Estados Unidos regiones tooserve Hola respectivo campus para transaccional, así como análisis.</span><span class="sxs-lookup"><span data-stu-id="25d0f-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions tooserve hello respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="25d0f-199">datos de Hello puede estar localmente coherentes en hello tiempo lecturas y escrituras y pueden ser coherentes entre ambas regiones Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-199">hello data can be locally consistent at hello time reads and writes and can be eventually consistent across both hello regions.</span></span> <span data-ttu-id="25d0f-200">Hay otros ejemplos como la distribución de medios, el comercio electrónico y todo lo que sirva a una base de usuario concentrada geográficamente es un buen caso de uso para este modelo de implementación.</span><span class="sxs-lookup"><span data-stu-id="25d0f-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="25d0f-201">**Alta disponibilidad:** La redundancia es un factor clave para lograr una alta disponibilidad de software y hardware; consulte Creación de sistemas en nube confiables en Microsoft Azure para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="25d0f-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="25d0f-202">En Microsoft Azure, Hola única manera confiable de lograr redundancia true es mediante la implementación de un clúster de varias regiones.</span><span class="sxs-lookup"><span data-stu-id="25d0f-202">On Microsoft Azure, hello only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="25d0f-203">Las aplicaciones pueden implementarse en un modo activo / activo o activo / pasivo y si una de las regiones de hello está inactivo, Azure Traffic Manager puede redirigir la región activa de tráfico toohello.</span><span class="sxs-lookup"><span data-stu-id="25d0f-203">Applications can be deployed in an active-active or active-passive mode and if one of hello regions is down, Azure Traffic Manager can redirect traffic toohello active region.</span></span>  <span data-ttu-id="25d0f-204">Con la implementación de una única región hello, si la disponibilidad de hello es 99,9, una implementación en una región de dos puede alcanzar una disponibilidad de 99,9999 calculada mediante la fórmula de hello: (1-(1-0.999) * (1-0,999)) * 100); vea Hola anteriormente para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="25d0f-204">With hello single region deployment, if hello availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by hello formula: (1-(1-0.999) * (1-0.999))*100); see hello above paper for details.</span></span>

<span data-ttu-id="25d0f-205">**Recuperación ante desastres:** El clúster de Cassandra de varias regiones, si está correctamente diseñado, puede resistir interrupciones del centro de datos por catástrofes.</span><span class="sxs-lookup"><span data-stu-id="25d0f-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="25d0f-206">Si una región está inactivo, pueden iniciar Hola aplicación implementada tooother regiones que atienden a los usuarios finales de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-206">If one region is down, hello application deployed tooother regions can start serving hello end users.</span></span> <span data-ttu-id="25d0f-207">Al igual que cualquier otra implementación de continuidad empresarial, aplicación hello tiene toobe tolerante a errores de pérdida de datos resultantes de los datos de hello en canalización asincrónica Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-207">Like any other business continuity implementations, hello application has toobe tolerant for some data loss resulting from hello data in hello asynchronous pipeline.</span></span> <span data-ttu-id="25d0f-208">Sin embargo, Casandra hace recuperación hello swifter mucho más tiempo del Hola realizada por los procesos de recuperación de base de datos tradicional.</span><span class="sxs-lookup"><span data-stu-id="25d0f-208">However, Cassandra makes hello recovery much swifter than hello time taken by traditional database recovery processes.</span></span> <span data-ttu-id="25d0f-209">Figura 2 muestra el modelo de implementación típica de varias regiones de hello con ocho nodos en cada región.</span><span class="sxs-lookup"><span data-stu-id="25d0f-209">Figure 2 shows hello typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="25d0f-210">Ambas regiones son imágenes reflejadas entre sí para hello mismo de simetría; diseños de mundo real dependen del tipo de carga de trabajo de hello (p. ej., transaccional o analítico), RPO, RTO, coherencia de los datos y requisitos de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-210">Both regions are mirror images of each other for hello same of symmetry; real world designs depend on hello workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Implementación de varias regiones](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="25d0f-212">Ilustración 2: Implementación de Cassandra en varias regiones</span><span class="sxs-lookup"><span data-stu-id="25d0f-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="25d0f-213">Integración de red</span><span class="sxs-lookup"><span data-stu-id="25d0f-213">Network Integration</span></span>
<span data-ttu-id="25d0f-214">Conjuntos de máquinas virtuales de redes de implementada tooprivate ubicadas en dos regiones se comunica entre sí mediante un túnel VPN.</span><span class="sxs-lookup"><span data-stu-id="25d0f-214">Sets of virtual machines deployed tooprivate networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="25d0f-215">túnel VPN de Hello conecta dos puertas de enlace de software aprovisionados durante el proceso de implementación de red de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-215">hello VPN tunnel connects two software gateways provisioned during hello network deployment process.</span></span> <span data-ttu-id="25d0f-216">Ambas regiones tienen una arquitectura de red similar en cuanto a subredes "web" y "datos"; Las redes de Azure permite la creación de hello de subredes tantos según sea necesario y aplique las ACL según sea necesario por la seguridad de red.</span><span class="sxs-lookup"><span data-stu-id="25d0f-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows hello creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="25d0f-217">Al diseñar la topología de clúster de hello entre datos center comunicación hello y latencia impacto económico de tráfico de red de hello necesidad toobe considerada.</span><span class="sxs-lookup"><span data-stu-id="25d0f-217">While designing hello cluster topology inter data center communication latency and hello economic impact of hello network traffic need toobe considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="25d0f-218">Coherencia de los datos para la implementación de varios centros de datos</span><span class="sxs-lookup"><span data-stu-id="25d0f-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="25d0f-219">Distribuye las implementaciones necesidad toobe tenga en cuenta el impacto de topología de clúster de hello en rendimiento y alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="25d0f-219">Distributed deployments need toobe aware of hello cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="25d0f-220">Hola RF y nivel de coherencia toobe necesidad seleccionado de modo que Hola quórum no depende de disponibilidad de Hola de todos los centros de datos de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-220">hello RF and Consistency Level need toobe selected in such way that hello quorum doesn’t depend on hello availability of all hello data centers.</span></span>
<span data-ttu-id="25d0f-221">Para un sistema que necesita consistencia alta, un LOCAL_QUORUM de nivel de coherencia (para las lecturas y escrituras) asegurará que Hola local lee y escribe se satisface desde Hola local nodos mientras los datos están replican de forma asincrónica toohello centros de datos remotos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that hello local reads and writes are satisfied from hello local nodes while data is replicated asynchronously toohello remote data centers.</span></span>  <span data-ttu-id="25d0f-222">Tabla 2 se resume la configuración Hola detalles de clúster de varias regiones de Hola que se describen más adelante en hello escribir una.</span><span class="sxs-lookup"><span data-stu-id="25d0f-222">Table 2 summarizes hello configuration details for hello multi-region cluster outlined later in hello write up.</span></span>

<span data-ttu-id="25d0f-223">**Configuración del clúster de Cassandra de dos regiones**</span><span class="sxs-lookup"><span data-stu-id="25d0f-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="25d0f-224">Parámetro de clúster</span><span class="sxs-lookup"><span data-stu-id="25d0f-224">Cluster Parameter</span></span> | <span data-ttu-id="25d0f-225">Valor</span><span class="sxs-lookup"><span data-stu-id="25d0f-225">Value</span></span> | <span data-ttu-id="25d0f-226">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="25d0f-227">Número de nodos (N)</span><span class="sxs-lookup"><span data-stu-id="25d0f-227">Number of Nodes (N)</span></span> |<span data-ttu-id="25d0f-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="25d0f-228">8 + 8</span></span> |<span data-ttu-id="25d0f-229">Número total de nodos de clúster de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-229">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="25d0f-230">Factor de replicación (RF)</span><span class="sxs-lookup"><span data-stu-id="25d0f-230">Replication Factor (RF)</span></span> |<span data-ttu-id="25d0f-231">3</span><span class="sxs-lookup"><span data-stu-id="25d0f-231">3</span></span> |<span data-ttu-id="25d0f-232">Número de réplicas de una fila determinada</span><span class="sxs-lookup"><span data-stu-id="25d0f-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="25d0f-233">Nivel de coherencia (escritura)</span><span class="sxs-lookup"><span data-stu-id="25d0f-233">Consistency Level (Write)</span></span> |<span data-ttu-id="25d0f-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] resultado de hello de fórmula de saludo se redondea hacia abajo</span><span class="sxs-lookup"><span data-stu-id="25d0f-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="25d0f-235">2 nodos se escribirán toohello primer centro de datos de forma sincrónica; Hola 2 nodos adicionales necesarios para el quórum se escribirán asincrónicamente toohello 2nd centro de datos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-235">2 nodes will be written toohello first data center synchronously; hello additional 2 nodes needed for quorum will be written asynchronously toohello 2nd data center.</span></span> |
| <span data-ttu-id="25d0f-236">Nivel de coherencia (lectura)</span><span class="sxs-lookup"><span data-stu-id="25d0f-236">Consistency Level (Read)</span></span> |<span data-ttu-id="25d0f-237">LOCAL_QUORUM ((RF/2) + 1) = 2 resultado de hello de fórmula de saludo se redondea hacia abajo</span><span class="sxs-lookup"><span data-stu-id="25d0f-237">LOCAL_QUORUM ((RF/2) +1) = 2 hello result of hello formula is rounded down</span></span> |<span data-ttu-id="25d0f-238">Las solicitudes de lectura se satisfacen desde sólo una región; 2 nodos se leen antes de respuesta de hello enviar a atrás toohello cliente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-238">Read requests are satisfied from only one region; 2 nodes are read before hello response is sent back toohello client.</span></span> |
| <span data-ttu-id="25d0f-239">Estrategia de replicación</span><span class="sxs-lookup"><span data-stu-id="25d0f-239">Replication Strategy</span></span> |<span data-ttu-id="25d0f-240">NetworkTopologyStrategy vea la [replicación de datos](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) en la documentación de Cassandra para obtener más información</span><span class="sxs-lookup"><span data-stu-id="25d0f-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="25d0f-241">Entiende la topología de implementación de Hola y coloca las réplicas en los nodos para que todas las réplicas de hello no terminan en hello mismo bastidor</span><span class="sxs-lookup"><span data-stu-id="25d0f-241">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="25d0f-242">Snitch</span><span class="sxs-lookup"><span data-stu-id="25d0f-242">Snitch</span></span> |<span data-ttu-id="25d0f-243">GossipingPropertyFileSnitch. Vea [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) en la documentación de Cassandra para más información</span><span class="sxs-lookup"><span data-stu-id="25d0f-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="25d0f-244">NetworkTopologyStrategy utiliza un concepto de topología de snitch toounderstand Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-244">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="25d0f-245">GossipingPropertyFileSnitch ofrece un mejor control de asignación de cada centro de toodata de nodo y bastidor.</span><span class="sxs-lookup"><span data-stu-id="25d0f-245">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="25d0f-246">clúster de Hello, a continuación, usa cotilleos toopropagate esta información.</span><span class="sxs-lookup"><span data-stu-id="25d0f-246">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="25d0f-247">Esto es mucho más fácil en tooPropertyFileSnitch relativa de configuración de IP dinámica</span><span class="sxs-lookup"><span data-stu-id="25d0f-247">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

## <a name="hello-software-configuration"></a><span data-ttu-id="25d0f-248">Hola una configuración de SOFTWARE</span><span class="sxs-lookup"><span data-stu-id="25d0f-248">hello SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="25d0f-249">Hola después de las versiones de software se utiliza durante la implementación de hello:</span><span class="sxs-lookup"><span data-stu-id="25d0f-249">hello following software versions are used during hello deployment:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-250">Software</span><span class="sxs-lookup"><span data-stu-id="25d0f-250">Software</span></span></th><th><span data-ttu-id="25d0f-251">Origen</span><span class="sxs-lookup"><span data-stu-id="25d0f-251">Source</span></span></th><th><span data-ttu-id="25d0f-252">Versión</span><span class="sxs-lookup"><span data-stu-id="25d0f-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-253">JRE</span><span class="sxs-lookup"><span data-stu-id="25d0f-253">JRE</span></span>    </td><td><span data-ttu-id="25d0f-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="25d0f-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="25d0f-255">8U5</span><span class="sxs-lookup"><span data-stu-id="25d0f-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-256">JNA</span><span class="sxs-lookup"><span data-stu-id="25d0f-256">JNA</span></span>    </td><td><span data-ttu-id="25d0f-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="25d0f-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="25d0f-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="25d0f-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="25d0f-259">Cassandra</span></span></td><td>[<span data-ttu-id="25d0f-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="25d0f-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="25d0f-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="25d0f-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="25d0f-262">Ubuntu</span></span>    </td><td><span data-ttu-id="25d0f-263">[Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="25d0f-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="25d0f-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="25d0f-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="25d0f-265">Puesto que la descarga de JRE requiere manual aceptación de licencia de Oracle, implementación de hello toosimplify, descarga que todas Hola escritorio toohello de software necesarias para cargar más adelante en la imagen de la plantilla de Ubuntu Hola que se crearán como un clúster de toohello precursor implementación.</span><span class="sxs-lookup"><span data-stu-id="25d0f-265">Since downloading of JRE requires manual acceptance of Oracle license, toosimplify hello deployment, download all hello required software toohello desktop for later uploading into hello Ubuntu template image we will be creating as a precursor toohello cluster deployment.</span></span>

<span data-ttu-id="25d0f-266">Descargue Hola por encima de software en un directorio de descarga conocido (por ejemplo, %TEMP%/downloads en Windows o ~/Downloads en la mayoría de las distribuciones de Linux o Mac) en el equipo local de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-266">Download hello above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on hello local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="25d0f-267">CREAR LA MÁQUINA VIRTUAL DE UBUNTU</span><span class="sxs-lookup"><span data-stu-id="25d0f-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="25d0f-268">En este paso del proceso de Hola crearemos Ubuntu imagen con software de requisito previo de Hola para que hello imagen se puede reutilizar para el aprovisionamiento de varios nodos de Casandra.</span><span class="sxs-lookup"><span data-stu-id="25d0f-268">In this step of hello process we will create Ubuntu image with hello pre-requisite software so that hello image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="25d0f-269">PASO 1: Generación de par de claves de SSH</span><span class="sxs-lookup"><span data-stu-id="25d0f-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="25d0f-270">Azure necesita una clave pública PEM o DER codificado a Hola tiempo de aprovisionamiento de X509.</span><span class="sxs-lookup"><span data-stu-id="25d0f-270">Azure needs an X509 public key that is either PEM or DER encoded at hello provisioning time.</span></span> <span data-ttu-id="25d0f-271">Generar un par de claves pública/privada mediante instrucciones de hello ubicadas en cómo tooUse SSH con Linux en Azure.</span><span class="sxs-lookup"><span data-stu-id="25d0f-271">Generate a public/private key pair using hello instructions located at How tooUse SSH with Linux on Azure.</span></span> <span data-ttu-id="25d0f-272">Si tiene previsto toouse putty.exe como un cliente de SSH en Windows o Linux, tendrá que tooconvert Hola PEM codificado formato de tooPPK clave privada RSA con puttygen.exe; instrucciones de Hola para esto pueden encontrarse en hello por encima de la página web.</span><span class="sxs-lookup"><span data-stu-id="25d0f-272">If you plan toouse putty.exe as an SSH client either on Windows or Linux, you have tooconvert hello PEM encoded RSA private key tooPPK format using puttygen.exe; hello instructions for this can be found in hello above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="25d0f-273">PASO 2: Creación de la máquina virtual de la plantilla de Ubuntu</span><span class="sxs-lookup"><span data-stu-id="25d0f-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="25d0f-274">plantilla de hello toocreate máquina virtual, inicie sesión en hello Azure Hola de portal y el uso clásico sigue secuencia: haga clic en nuevo, proceso, máquina VIRTUAL, de la galería, UBUNTU, Ubuntu Server 14.04 LTS y, a continuación, haga clic en la flecha derecha Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-274">toocreate hello template VM, log into hello Azure classic portal and use hello following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click hello right arrow.</span></span> <span data-ttu-id="25d0f-275">Para obtener un tutorial que describe cómo toocreate una VM de Linux, consulte Crear una máquina Virtual ejecuta Linux.</span><span class="sxs-lookup"><span data-stu-id="25d0f-275">For a tutorial that describes how toocreate a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="25d0f-276">Escriba Hola siga la información en pantalla de "configuración de máquina Virtual" hello #1:</span><span class="sxs-lookup"><span data-stu-id="25d0f-276">Enter hello following information on hello “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-277">NOMBRE DEL CAMPO</span><span class="sxs-lookup"><span data-stu-id="25d0f-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="25d0f-278">VALOR DEL CAMPO</span><span class="sxs-lookup"><span data-stu-id="25d0f-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="25d0f-279">COMENTARIOS</span><span class="sxs-lookup"><span data-stu-id="25d0f-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="25d0f-280">FECHA DE LANZAMIENTO DE LA VERSIÓN</span><span class="sxs-lookup"><span data-stu-id="25d0f-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="25d0f-281">Seleccione una fecha en la lista desplegable de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-281">Select a date from hello drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="25d0f-282">NOMBRE DE MÁQUINA VIRTUAL</span><span class="sxs-lookup"><span data-stu-id="25d0f-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="25d0f-283">cass-template</span><span class="sxs-lookup"><span data-stu-id="25d0f-283">cass-template</span></span>                   </td><td> <span data-ttu-id="25d0f-284">Este es el nombre de host de Hola de hello VM</span><span class="sxs-lookup"><span data-stu-id="25d0f-284">This is hello hostname of hello VM</span></span> </td><tr>
<tr><td><span data-ttu-id="25d0f-285">NIVEL</span><span class="sxs-lookup"><span data-stu-id="25d0f-285">TIER</span></span>                     </td><td> <span data-ttu-id="25d0f-286">ESTÁNDAR</span><span class="sxs-lookup"><span data-stu-id="25d0f-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="25d0f-287">Deje Hola predeterminado</span><span class="sxs-lookup"><span data-stu-id="25d0f-287">Leave hello default</span></span>              </td><tr>
<tr><td><span data-ttu-id="25d0f-288">TAMAÑO</span><span class="sxs-lookup"><span data-stu-id="25d0f-288">SIZE</span></span>                     </td><td> <span data-ttu-id="25d0f-289">A1</span><span class="sxs-lookup"><span data-stu-id="25d0f-289">A1</span></span>                              </td><td><span data-ttu-id="25d0f-290">Seleccione Hola que VM en función de hello E/S necesita; para este propósito deje el valor predeterminado de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-290">Select hello VM based on hello IO needs; for this purpose leave hello default</span></span> </td><tr>
<tr><td> <span data-ttu-id="25d0f-291">NOMBRE DE USUARIO NUEVO</span><span class="sxs-lookup"><span data-stu-id="25d0f-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="25d0f-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="25d0f-292">localadmin</span></span>                       </td><td> <span data-ttu-id="25d0f-293">"admin" es un nombre de usuario reservado en Ubuntu 12.xx y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="25d0f-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="25d0f-294">AUTENTICACIÓN</span><span class="sxs-lookup"><span data-stu-id="25d0f-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="25d0f-295">Haga clic en la casilla</span><span class="sxs-lookup"><span data-stu-id="25d0f-295">Click check box</span></span>                 </td><td><span data-ttu-id="25d0f-296">Actívelo si desea toosecure con una clave SSH</span><span class="sxs-lookup"><span data-stu-id="25d0f-296">Check if you want toosecure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="25d0f-297">CERTIFICADO</span><span class="sxs-lookup"><span data-stu-id="25d0f-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="25d0f-298">nombre de archivo del certificado de clave pública de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-298">file name of hello public key certificate</span></span> </td><td> <span data-ttu-id="25d0f-299">Usar Hola clave pública generado anteriormente</span><span class="sxs-lookup"><span data-stu-id="25d0f-299">Use hello public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="25d0f-300">New Password</span><span class="sxs-lookup"><span data-stu-id="25d0f-300">New Password</span></span>    </td><td> <span data-ttu-id="25d0f-301">contraseña segura</span><span class="sxs-lookup"><span data-stu-id="25d0f-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="25d0f-302">Confirm Password</span><span class="sxs-lookup"><span data-stu-id="25d0f-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="25d0f-303">contraseña segura</span><span class="sxs-lookup"><span data-stu-id="25d0f-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="25d0f-304">Escriba Hola siga la información en pantalla de "configuración de máquina Virtual" hello #2:</span><span class="sxs-lookup"><span data-stu-id="25d0f-304">Enter hello following information on hello “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-305">NOMBRE DEL CAMPO</span><span class="sxs-lookup"><span data-stu-id="25d0f-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="25d0f-306">VALOR DEL CAMPO</span><span class="sxs-lookup"><span data-stu-id="25d0f-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="25d0f-307">COMENTARIOS</span><span class="sxs-lookup"><span data-stu-id="25d0f-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="25d0f-308">SERVICIO EN LA NUBE</span><span class="sxs-lookup"><span data-stu-id="25d0f-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="25d0f-309">Crear un nuevo servicio en la nube</span><span class="sxs-lookup"><span data-stu-id="25d0f-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="25d0f-310">El servicio de nube es un recurso de proceso de contenedor como máquinas virtuales</span><span class="sxs-lookup"><span data-stu-id="25d0f-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="25d0f-311">NOMBRE DE DNS DEL SERVICIO EN LA NUBE</span><span class="sxs-lookup"><span data-stu-id="25d0f-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="25d0f-312">ubuntu-template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="25d0f-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="25d0f-313">Defina un nombre de equilibrador de carga independiente de la máquina</span><span class="sxs-lookup"><span data-stu-id="25d0f-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="25d0f-314">REGION/GRUPO DE AFINIDAD/RED VIRTUAL</span><span class="sxs-lookup"><span data-stu-id="25d0f-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="25d0f-315">Oeste de EE. UU.</span><span class="sxs-lookup"><span data-stu-id="25d0f-315">West US</span></span>    </td><td> <span data-ttu-id="25d0f-316">Seleccione una región desde la que las aplicaciones web acceso clúster de hello Casandra</span><span class="sxs-lookup"><span data-stu-id="25d0f-316">Select a region from which your web applications access hello Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-317">STORAGE ACCOUNT</span><span class="sxs-lookup"><span data-stu-id="25d0f-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="25d0f-318">Use el valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="25d0f-318">Use default</span></span>    </td><td><span data-ttu-id="25d0f-319">Usar cuenta de almacenamiento predeterminada de Hola o una cuenta de almacenamiento creada previamente en una región determinada</span><span class="sxs-lookup"><span data-stu-id="25d0f-319">Use hello default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-320">El conjunto de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="25d0f-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="25d0f-321">None</span><span class="sxs-lookup"><span data-stu-id="25d0f-321">None</span></span> </td><td>    <span data-ttu-id="25d0f-322">Deje este parámetro en blanco</span><span class="sxs-lookup"><span data-stu-id="25d0f-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-323">EXTREMOS</span><span class="sxs-lookup"><span data-stu-id="25d0f-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="25d0f-324">Use el valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="25d0f-324">Use default</span></span> </td><td>    <span data-ttu-id="25d0f-325">Utilizar la configuración de SSH de hello predeterminada</span><span class="sxs-lookup"><span data-stu-id="25d0f-325">Use hello default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="25d0f-326">Haga clic en la flecha derecha, deje los valores predeterminados de hello en pantalla de bienvenida #3 y haga clic en hello "comprobación" botón toocomplete Hola VM proceso de aprovisionamiento.</span><span class="sxs-lookup"><span data-stu-id="25d0f-326">Click right arrow, leave hello defaults on hello screen #3 and click hello “check” button toocomplete hello VM provisioning process.</span></span> <span data-ttu-id="25d0f-327">Después de unos minutos, Hola VM con hello nombre "ubuntu-template" debe estar en un estado "en ejecución".</span><span class="sxs-lookup"><span data-stu-id="25d0f-327">After a few minutes, hello VM with hello name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-hello-necessary-software"></a><span data-ttu-id="25d0f-328">INSTALAR el SOFTWARE necesario de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-328">INSTALL hello NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="25d0f-329">PASO 1: Carga de tarballs</span><span class="sxs-lookup"><span data-stu-id="25d0f-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="25d0f-330">Uso de scp o pscp, Hola copia descargaron software demasiado ~ / directorio de descargas con hello siguiendo el formato de comando:</span><span class="sxs-lookup"><span data-stu-id="25d0f-330">Using scp or pscp, copy hello previously downloaded software too~/downloads directory using hello following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="25d0f-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="25d0f-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="25d0f-332">Repita Hola por encima de comando para JRE, así como para los bits de Casandra Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-332">Repeat hello above command for JRE as well as for hello Cassandra bits.</span></span>

#### <a name="step-2-prepare-hello-directory-structure-and-extract-hello-archives"></a><span data-ttu-id="25d0f-333">PASO 2: Preparar la estructura de directorios de Hola y extraer archivos Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-333">STEP 2: Prepare hello directory structure and extract hello archives</span></span>
<span data-ttu-id="25d0f-334">Inicie sesión en hello VM y crear la estructura de directorios de Hola y extraer software como un superusuario mediante Hola intensiva de script siguiente:</span><span class="sxs-lookup"><span data-stu-id="25d0f-334">Log into hello VM and create hello directory structure and extract software as a super user using hello bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change hello ownership toohello service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile tooadd JRE toohello PATH"
    echo "installation is complete"


<span data-ttu-id="25d0f-335">Si pega este script en la ventana de vim, asegúrese de carro de hello tooremove seguro de valor devuelto ('\r ") con el siguiente comando de hello:</span><span class="sxs-lookup"><span data-stu-id="25d0f-335">If you paste this script into vim window, make sure tooremove hello carriage return (‘\r”) using hello following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="25d0f-336">Paso 3: Edición de perfil/etc.</span><span class="sxs-lookup"><span data-stu-id="25d0f-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="25d0f-337">Anexar siguiente Hola final hello:</span><span class="sxs-lookup"><span data-stu-id="25d0f-337">Append hello following at hello end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="25d0f-338">Paso 4: Instalación de JNA para sistemas de producción</span><span class="sxs-lookup"><span data-stu-id="25d0f-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="25d0f-339">Secuencia de comandos siguiente Hola de uso: siguiente Hola comando install jna-3.2.7.jar y 3.2.7.jar de plataforma de jna too/usr/share.java directory sudo apt-get instalará libjna java</span><span class="sxs-lookup"><span data-stu-id="25d0f-339">Use hello following command sequence: hello following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar too/usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="25d0f-340">Cree vínculos simbólicos en el directorio de $CASS_HOME/lib para que el script de inicio de Cassandra pueda encontrar estos JAR:</span><span class="sxs-lookup"><span data-stu-id="25d0f-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="25d0f-341">Paso 5: Configuración de cassandra.yaml</span><span class="sxs-lookup"><span data-stu-id="25d0f-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="25d0f-342">Editar cassandra.yaml en cada configuración de tooreflect de máquina virtual necesaria para todas las máquinas virtuales de hello [se se Retocar durante el aprovisionamiento real de hello]:</span><span class="sxs-lookup"><span data-stu-id="25d0f-342">Edit cassandra.yaml on each VM tooreflect configuration needed by all hello virtual machines [we will tweak this during hello actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-343">Nombre del campo</span><span class="sxs-lookup"><span data-stu-id="25d0f-343">Field Name</span></span>   </th><th> <span data-ttu-id="25d0f-344">Valor</span><span class="sxs-lookup"><span data-stu-id="25d0f-344">Value</span></span>  </th><th>    <span data-ttu-id="25d0f-345">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="25d0f-346">cluster_name</span><span class="sxs-lookup"><span data-stu-id="25d0f-346">cluster_name</span></span> </td><td>    <span data-ttu-id="25d0f-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="25d0f-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="25d0f-348">Usar el nombre de Hola que refleja la implementación</span><span class="sxs-lookup"><span data-stu-id="25d0f-348">Use hello name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="25d0f-349">listen_address</span></span>    </td><td><span data-ttu-id="25d0f-350">[deje este parámetro en blanco]</span><span class="sxs-lookup"><span data-stu-id="25d0f-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="25d0f-351">Elimine "localhost"</span><span class="sxs-lookup"><span data-stu-id="25d0f-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="25d0f-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="25d0f-352">rpc_addres</span></span>   </td><td><span data-ttu-id="25d0f-353">[deje este parámetro en blanco]</span><span class="sxs-lookup"><span data-stu-id="25d0f-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="25d0f-354">Elimine "localhost"</span><span class="sxs-lookup"><span data-stu-id="25d0f-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="25d0f-355">seeds</span><span class="sxs-lookup"><span data-stu-id="25d0f-355">seeds</span></span>    </td><td><span data-ttu-id="25d0f-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="25d0f-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="25d0f-357">Lista de todas las direcciones IP de Hola que están designados como valores de inicialización.</span><span class="sxs-lookup"><span data-stu-id="25d0f-357">List of  all hello IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="25d0f-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="25d0f-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="25d0f-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="25d0f-360">Se utiliza por hello NetworkTopologyStrateg deducir Hola centro de datos y bastidor Hola de hello VM</span><span class="sxs-lookup"><span data-stu-id="25d0f-360">This is used by hello NetworkTopologyStrateg for inferring hello data center and hello rack of hello VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-hello-vm-image"></a><span data-ttu-id="25d0f-361">Paso 6: Capturar imagen de máquina virtual de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-361">Step 6: Capture hello VM image</span></span>
<span data-ttu-id="25d0f-362">Inicie sesión en la máquina virtual de hello mediante Hola hostname (hk-CA-template.cloudapp.net) y clave privada de hello SSH creado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-362">Log into hello virtual machine using hello hostname (hk-cas-template.cloudapp.net) and hello SSH private key previously created.</span></span> <span data-ttu-id="25d0f-363">Vea cómo tooUse SSH con Linux en Azure para detalles sobre cómo toolog en uso Hola comando ssh o putty.exe.</span><span class="sxs-lookup"><span data-stu-id="25d0f-363">See How tooUse SSH with Linux on Azure for details on how toolog in using hello command ssh or putty.exe.</span></span>

<span data-ttu-id="25d0f-364">Ejecute hello sigue la secuencia de imagen de hello toocapture de acciones:</span><span class="sxs-lookup"><span data-stu-id="25d0f-364">Execute hello following sequence of actions toocapture hello image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="25d0f-365">1. Desaprovisionamiento</span><span class="sxs-lookup"><span data-stu-id="25d0f-365">1. Deprovision</span></span>
<span data-ttu-id="25d0f-366">Use el comando de Hola "sudo waagent – desaprovisionamiento + user" tooremove información específica de la instancia de máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="25d0f-366">Use hello command “sudo waagent –deprovision+user” tooremove Virtual Machine instance specific information.</span></span> <span data-ttu-id="25d0f-367">Puede encontrar [cómo tooCapture una máquina Virtual Linux](capture-image.md) tooUse como una plantilla ofrecen más detalles en el proceso de captura de imagen de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-367">See for [How tooCapture a Linux Virtual Machine](capture-image.md) tooUse as a Template more details on hello image capture process.</span></span>

##### <a name="2-shutdown-hello-vm"></a><span data-ttu-id="25d0f-368">2: Hola apagar VM</span><span class="sxs-lookup"><span data-stu-id="25d0f-368">2: Shutdown hello VM</span></span>
<span data-ttu-id="25d0f-369">Asegúrese de que la máquina virtual Hola se resalta y haga clic en el vínculo de cierre de Hola de barra de comandos de hello inferior.</span><span class="sxs-lookup"><span data-stu-id="25d0f-369">Make sure that hello virtual machine is highlighted and click hello SHUTDOWN link from hello bottom command bar.</span></span>

##### <a name="3-capture-hello-image"></a><span data-ttu-id="25d0f-370">3: captura de imagen de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-370">3: Capture hello image</span></span>
<span data-ttu-id="25d0f-371">Asegúrese de que la máquina virtual Hola se resalta y haga clic en el vínculo de captura de Hola de barra de comandos de hello inferior.</span><span class="sxs-lookup"><span data-stu-id="25d0f-371">Make sure that hello virtual machine is highlighted and click hello CAPTURE link from hello bottom command bar.</span></span> <span data-ttu-id="25d0f-372">En la siguiente pantalla de bienvenida, asigne un nombre de imagen (por ejemplo, hk-cas-2-08-ub-14-04-2014071), caso descripción de la imagen y haga clic en proceso de captura de Hola "comprobación" marca toofinish Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-372">In hello next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click hello “check” mark toofinish hello CAPTURE process.</span></span>

<span data-ttu-id="25d0f-373">Este proceso tardará unos segundos e imagen Hola debe estar disponible en la sección Mis imágenes de galería de imágenes de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-373">This will take a few seconds and hello image should be available in MY IMAGES section of hello image gallery.</span></span> <span data-ttu-id="25d0f-374">una VM de origen Hola se eliminarán automáticamente tras captura imagen de Hola correctamente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-374">hello source VM will be automatically deleted after hello image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="25d0f-375">Proceso de implementación en una sola región</span><span class="sxs-lookup"><span data-stu-id="25d0f-375">Single Region Deployment Process</span></span>
<span data-ttu-id="25d0f-376">**Paso 1: Crear red Virtual de hello** sesión en hello portal de Azure y crear una red virtual (clásica) con atributos de Hola se muestra en hello en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-376">**Step 1: Create hello Virtual Network** Log into hello Azure portal and create a virtual network (classic) with hello attributes shown in hello following table.</span></span> <span data-ttu-id="25d0f-377">Vea [crear una red virtual (clásica) mediante el portal de Azure de hello](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) para obtener pasos detallados del proceso de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-377">See [Create a virtual network (classic) using hello Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="25d0f-378">Nombre del atributo de VM</span><span class="sxs-lookup"><span data-stu-id="25d0f-378">VM Attribute Name</span></span></th><th><span data-ttu-id="25d0f-379">Valor</span><span class="sxs-lookup"><span data-stu-id="25d0f-379">Value</span></span></th><th><span data-ttu-id="25d0f-380">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-381">Nombre</span><span class="sxs-lookup"><span data-stu-id="25d0f-381">Name</span></span></td><td><span data-ttu-id="25d0f-382">vnet-cass-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="25d0f-383">Region</span><span class="sxs-lookup"><span data-stu-id="25d0f-383">Region</span></span></td><td><span data-ttu-id="25d0f-384">Oeste de EE. UU.</span><span class="sxs-lookup"><span data-stu-id="25d0f-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="25d0f-385">Servidores DNS</span><span class="sxs-lookup"><span data-stu-id="25d0f-385">DNS Servers</span></span></td><td><span data-ttu-id="25d0f-386">None</span><span class="sxs-lookup"><span data-stu-id="25d0f-386">None</span></span></td><td><span data-ttu-id="25d0f-387">Ignore esto, ya que no estamos usando un servidor DNS</span><span class="sxs-lookup"><span data-stu-id="25d0f-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-388">Espacio de direcciones</span><span class="sxs-lookup"><span data-stu-id="25d0f-388">Address Space</span></span></td><td><span data-ttu-id="25d0f-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="25d0f-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="25d0f-390">IP inicial:</span><span class="sxs-lookup"><span data-stu-id="25d0f-390">Starting IP</span></span></td><td><span data-ttu-id="25d0f-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="25d0f-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="25d0f-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="25d0f-392">CIDR</span></span> </td><td><span data-ttu-id="25d0f-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="25d0f-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="25d0f-394">Agregue Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-394">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-395">Nombre</span><span class="sxs-lookup"><span data-stu-id="25d0f-395">Name</span></span></th><th><span data-ttu-id="25d0f-396">IP inicial:</span><span class="sxs-lookup"><span data-stu-id="25d0f-396">Starting IP</span></span></th><th><span data-ttu-id="25d0f-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="25d0f-397">CIDR</span></span></th><th><span data-ttu-id="25d0f-398">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-399">web</span><span class="sxs-lookup"><span data-stu-id="25d0f-399">web</span></span></td><td><span data-ttu-id="25d0f-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="25d0f-400">10.1.1.0</span></span></td><td><span data-ttu-id="25d0f-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="25d0f-401">/24 (251)</span></span></td><td><span data-ttu-id="25d0f-402">Subred para la granja de servidores de hello web</span><span class="sxs-lookup"><span data-stu-id="25d0f-402">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-403">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-403">data</span></span></td><td><span data-ttu-id="25d0f-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="25d0f-404">10.1.2.0</span></span></td><td><span data-ttu-id="25d0f-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="25d0f-405">/24 (251)</span></span></td><td><span data-ttu-id="25d0f-406">Subred para los nodos de la base de datos de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-406">Subnet for hello database nodes</span></span></td></tr>
</table>

<span data-ttu-id="25d0f-407">Subredes de Web y los datos se pueden proteger a través de grupos de seguridad de red cobertura Hola de los cuales está fuera del ámbito de este artículo.</span><span class="sxs-lookup"><span data-stu-id="25d0f-407">Data and Web subnets can be protected through network security groups hello coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="25d0f-408">**Paso 2: Aprovisionar máquinas de virtuales** con imagen Hola creado anteriormente, crearemos Hola después de máquinas virtuales en la nube de hello server "hk-c-svc-west" y enlazarlas toohello respectivas subredes tal y como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="25d0f-408">**Step 2: Provision Virtual Machines** Using hello image created previously, we will create hello following virtual machines in hello cloud server “hk-c-svc-west” and bind them toohello respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-409">Nombre de máquina</span><span class="sxs-lookup"><span data-stu-id="25d0f-409">Machine Name</span></span>    </th><th><span data-ttu-id="25d0f-410">Subred</span><span class="sxs-lookup"><span data-stu-id="25d0f-410">Subnet</span></span>    </th><th><span data-ttu-id="25d0f-411">Dirección IP</span><span class="sxs-lookup"><span data-stu-id="25d0f-411">IP Address</span></span>    </th><th><span data-ttu-id="25d0f-412">El conjunto de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="25d0f-412">Availability set</span></span></th><th><span data-ttu-id="25d0f-413">Controlador de dominio/bastidor</span><span class="sxs-lookup"><span data-stu-id="25d0f-413">DC/Rack</span></span></th><th><span data-ttu-id="25d0f-414">¿Valor de inicialización?</span><span class="sxs-lookup"><span data-stu-id="25d0f-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-415">hk-c1-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="25d0f-416">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-416">data</span></span>    </td><td><span data-ttu-id="25d0f-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="25d0f-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="25d0f-418">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="25d0f-419">dc =WESTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="25d0f-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="25d0f-420">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-421">hk-c2-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="25d0f-422">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-422">data</span></span>    </td><td><span data-ttu-id="25d0f-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="25d0f-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="25d0f-424">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="25d0f-425">dc =WESTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="25d0f-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="25d0f-426">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="25d0f-427">hk-c3-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="25d0f-428">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-428">data</span></span>    </td><td><span data-ttu-id="25d0f-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="25d0f-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="25d0f-430">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="25d0f-431">dc =WESTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="25d0f-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="25d0f-432">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-433">hk-c4-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="25d0f-434">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-434">data</span></span>    </td><td><span data-ttu-id="25d0f-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="25d0f-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="25d0f-436">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="25d0f-437">dc =WESTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="25d0f-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="25d0f-438">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="25d0f-439">hk-c5-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="25d0f-440">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-440">data</span></span>    </td><td><span data-ttu-id="25d0f-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="25d0f-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="25d0f-442">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="25d0f-443">dc =WESTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="25d0f-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="25d0f-444">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-445">hk-c6-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="25d0f-446">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-446">data</span></span>    </td><td><span data-ttu-id="25d0f-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="25d0f-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="25d0f-448">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="25d0f-449">dc =WESTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="25d0f-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="25d0f-450">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="25d0f-451">hk-c7-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="25d0f-452">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-452">data</span></span>    </td><td><span data-ttu-id="25d0f-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="25d0f-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="25d0f-454">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="25d0f-455">dc =WESTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="25d0f-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="25d0f-456">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-457">hk-c8-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="25d0f-458">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-458">data</span></span>    </td><td><span data-ttu-id="25d0f-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="25d0f-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="25d0f-460">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="25d0f-461">dc =WESTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="25d0f-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="25d0f-462">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="25d0f-463">hk-w1-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="25d0f-464">web</span><span class="sxs-lookup"><span data-stu-id="25d0f-464">web</span></span>    </td><td><span data-ttu-id="25d0f-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="25d0f-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="25d0f-466">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="25d0f-467">N/D</span><span class="sxs-lookup"><span data-stu-id="25d0f-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-468">hk-w2-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="25d0f-469">web</span><span class="sxs-lookup"><span data-stu-id="25d0f-469">web</span></span>    </td><td><span data-ttu-id="25d0f-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="25d0f-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="25d0f-471">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="25d0f-472">N/D</span><span class="sxs-lookup"><span data-stu-id="25d0f-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="25d0f-473">Creación de hello por encima de la lista de máquinas virtuales requiere Hola siguiendo el proceso:</span><span class="sxs-lookup"><span data-stu-id="25d0f-473">Creation of hello above list of VMs requires hello following process:</span></span>

1. <span data-ttu-id="25d0f-474">Crear un servicio de nube vacía en una región determinada</span><span class="sxs-lookup"><span data-stu-id="25d0f-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="25d0f-475">Crear una máquina virtual de hello capturados anteriormente imagen y adjuntarlo toohello red virtual creado anteriormente; Repita este paso para todas las máquinas virtuales de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-475">Create a VM from hello previously captured image and attach it toohello virtual network created previously; repeat this for all hello VMs</span></span>
3. <span data-ttu-id="25d0f-476">Agregar un servicio de nube toohello del equilibrador de carga interno y adjuntarlo subred toohello "datos"</span><span class="sxs-lookup"><span data-stu-id="25d0f-476">Add an internal load balancer toohello cloud service and attach it toohello “data” subnet</span></span>
4. <span data-ttu-id="25d0f-477">Para cada máquina virtual creado anteriormente, agregue un extremo con equilibrio de carga para tráfico de thrift a través de un equilibrador de carga interno de carga equilibrada conjunto conectado toohello creado anteriormente</span><span class="sxs-lookup"><span data-stu-id="25d0f-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected toohello previously created internal load balancer</span></span>

<span data-ttu-id="25d0f-478">Hola por encima de proceso se puede ejecutar con el portal de Azure clásico; usar una máquina de Windows (utilice una máquina virtual de Azure si no dispone de máquina de Windows tooa de acceso), usar hello después tooprovision de secuencia de comandos de PowerShell todas las máquinas 8 virtuales automáticamente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-478">hello above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access tooa Windows machine), use hello following PowerShell script tooprovision all 8 VMs automatically.</span></span>

<span data-ttu-id="25d0f-479">**Lista 1: script de PowerShell para el aprovisionamiento de máquinas virtuales**</span><span class="sxs-lookup"><span data-stu-id="25d0f-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into hello current Powershell session before proceeding
        #hello process: 1. create Azure Storage account, 2. create virtual network, 3.create hello VM template, 2. crate a list of VMs from hello template

        #fundamental variables - change these tooreflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores hello list of azure vm configuration objects
        #create hello list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add hello thrift endpoint toohello internal load balancer for all hello VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="25d0f-480">**Paso 3: Configuración de Cassandra en cada máquina virtual**</span><span class="sxs-lookup"><span data-stu-id="25d0f-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="25d0f-481">Inicie sesión en hello VM y realizar Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-481">Log into hello VM and perform hello following:</span></span>

* <span data-ttu-id="25d0f-482">Editar $CASS_HOME/conf/cassandra-rackdc.properties toospecify Hola center y el bastidor de propiedades de datos:</span><span class="sxs-lookup"><span data-stu-id="25d0f-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="25d0f-483">Editar nodos de valor de inicialización de cassandra.yaml tooconfigure como sigue:</span><span class="sxs-lookup"><span data-stu-id="25d0f-483">Edit cassandra.yaml tooconfigure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="25d0f-484">**Paso 4: Iniciar las máquinas virtuales de Hola y probar Hola del clúster**</span><span class="sxs-lookup"><span data-stu-id="25d0f-484">**Step 4: Start hello VMs and test hello cluster**</span></span>

<span data-ttu-id="25d0f-485">Inicie sesión en uno de los nodos de hello (p. ej. hk-c1-oeste-us) y ejecución Hola siguiendo el estado del comando toosee Hola de clúster de hello:</span><span class="sxs-lookup"><span data-stu-id="25d0f-485">Log into one of hello nodes (e.g. hk-c1-west-us) and run hello following command toosee hello status of hello cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="25d0f-486">Debería ver Hola presentación similar toohello uno por debajo de un clúster de 8 nodos:</span><span class="sxs-lookup"><span data-stu-id="25d0f-486">You should see hello display similar toohello one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-487">Estado</span><span class="sxs-lookup"><span data-stu-id="25d0f-487">Status</span></span></th><th><span data-ttu-id="25d0f-488">Dirección</span><span class="sxs-lookup"><span data-stu-id="25d0f-488">Address</span></span>    </th><th><span data-ttu-id="25d0f-489">Carga</span><span class="sxs-lookup"><span data-stu-id="25d0f-489">Load</span></span>    </th><th><span data-ttu-id="25d0f-490">Tokens</span><span class="sxs-lookup"><span data-stu-id="25d0f-490">Tokens</span></span>    </th><th><span data-ttu-id="25d0f-491">Propiedad</span><span class="sxs-lookup"><span data-stu-id="25d0f-491">Owns</span></span> </th><th><span data-ttu-id="25d0f-492">Identificador de host</span><span class="sxs-lookup"><span data-stu-id="25d0f-492">Host ID</span></span>    </th><th><span data-ttu-id="25d0f-493">Bastidor</span><span class="sxs-lookup"><span data-stu-id="25d0f-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="25d0f-494">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-494">UN</span></span>    </td><td><span data-ttu-id="25d0f-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="25d0f-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="25d0f-496">87,81 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-496">87.81 KB</span></span>    </td><td><span data-ttu-id="25d0f-497">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-497">256</span></span>    </td><td><span data-ttu-id="25d0f-498">38,0 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-498">38.0%</span></span>    </td><td><span data-ttu-id="25d0f-499">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-499">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-500">rack1</span><span class="sxs-lookup"><span data-stu-id="25d0f-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-501">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-501">UN</span></span>    </td><td><span data-ttu-id="25d0f-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="25d0f-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="25d0f-503">41,08 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-503">41.08 KB</span></span>    </td><td><span data-ttu-id="25d0f-504">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-504">256</span></span>    </td><td><span data-ttu-id="25d0f-505">68,9 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-505">68.9%</span></span>    </td><td><span data-ttu-id="25d0f-506">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-506">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-507">rack1</span><span class="sxs-lookup"><span data-stu-id="25d0f-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-508">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-508">UN</span></span>    </td><td><span data-ttu-id="25d0f-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="25d0f-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="25d0f-510">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-510">55.29 KB</span></span>    </td><td><span data-ttu-id="25d0f-511">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-511">256</span></span>    </td><td><span data-ttu-id="25d0f-512">68,8 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-512">68.8%</span></span>    </td><td><span data-ttu-id="25d0f-513">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-513">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-514">rack2</span><span class="sxs-lookup"><span data-stu-id="25d0f-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-515">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-515">UN</span></span>    </td><td><span data-ttu-id="25d0f-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="25d0f-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="25d0f-517">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-517">55.29 KB</span></span>    </td><td><span data-ttu-id="25d0f-518">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-518">256</span></span>    </td><td><span data-ttu-id="25d0f-519">68,8 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-519">68.8%</span></span>    </td><td><span data-ttu-id="25d0f-520">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-520">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-521">rack2</span><span class="sxs-lookup"><span data-stu-id="25d0f-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-522">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-522">UN</span></span>    </td><td><span data-ttu-id="25d0f-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="25d0f-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="25d0f-524">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-524">55.29 KB</span></span>    </td><td><span data-ttu-id="25d0f-525">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-525">256</span></span>    </td><td><span data-ttu-id="25d0f-526">68,8 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-526">68.8%</span></span>    </td><td><span data-ttu-id="25d0f-527">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-527">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-528">rack3</span><span class="sxs-lookup"><span data-stu-id="25d0f-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-529">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-529">UN</span></span>    </td><td><span data-ttu-id="25d0f-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="25d0f-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="25d0f-531">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-531">55.29 KB</span></span>    </td><td><span data-ttu-id="25d0f-532">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-532">256</span></span>    </td><td><span data-ttu-id="25d0f-533">68,8 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-533">68.8%</span></span>    </td><td><span data-ttu-id="25d0f-534">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-534">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-535">rack3</span><span class="sxs-lookup"><span data-stu-id="25d0f-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-536">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-536">UN</span></span>    </td><td><span data-ttu-id="25d0f-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="25d0f-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="25d0f-538">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-538">55.29 KB</span></span>    </td><td><span data-ttu-id="25d0f-539">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-539">256</span></span>    </td><td><span data-ttu-id="25d0f-540">68,8 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-540">68.8%</span></span>    </td><td><span data-ttu-id="25d0f-541">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-541">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-542">rack4</span><span class="sxs-lookup"><span data-stu-id="25d0f-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="25d0f-543">UN</span><span class="sxs-lookup"><span data-stu-id="25d0f-543">UN</span></span>    </td><td><span data-ttu-id="25d0f-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="25d0f-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="25d0f-545">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="25d0f-545">55.29 KB</span></span>    </td><td><span data-ttu-id="25d0f-546">256</span><span class="sxs-lookup"><span data-stu-id="25d0f-546">256</span></span>    </td><td><span data-ttu-id="25d0f-547">68,8 %</span><span class="sxs-lookup"><span data-stu-id="25d0f-547">68.8%</span></span>    </td><td><span data-ttu-id="25d0f-548">GUID (eliminado)</span><span class="sxs-lookup"><span data-stu-id="25d0f-548">Guid (removed)</span></span></td><td><span data-ttu-id="25d0f-549">rack4</span><span class="sxs-lookup"><span data-stu-id="25d0f-549">rack4</span></span></td></tr>
</table>

## <a name="test-hello-single-region-cluster"></a><span data-ttu-id="25d0f-550">Hola de prueba único clúster de región</span><span class="sxs-lookup"><span data-stu-id="25d0f-550">Test hello Single Region Cluster</span></span>
<span data-ttu-id="25d0f-551">Usar hello después de clúster de hello tootest de pasos:</span><span class="sxs-lookup"><span data-stu-id="25d0f-551">Use hello following steps tootest hello cluster:</span></span>

1. <span data-ttu-id="25d0f-552">Mediante el commandlet de Get-AzureInternalLoadbalancer de comandos de Powershell de hello, obtener dirección IP de hello del equilibrador de carga interno de hello (p. ej.  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="25d0f-552">Using hello Powershell command Get-AzureInternalLoadbalancer commandlet, obtain hello IP address of hello internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="25d0f-553">a continuación se muestran la sintaxis de Hello del comando de hello: Get-AzureLoadbalancer – ServiceName "hk-c-svc-oeste-us" [muestra los detalles de Hola de equilibrador de carga interno de hello junto con su dirección IP]</span><span class="sxs-lookup"><span data-stu-id="25d0f-553">hello syntax of hello command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays hello details of hello internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="25d0f-554">Inicie sesión en la granja de servidores web de hello VM (p. ej. hk-w1-oeste-us) mediante Putty o ssh</span><span class="sxs-lookup"><span data-stu-id="25d0f-554">Log into hello web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="25d0f-555">Ejecute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="25d0f-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="25d0f-556">Usar hello después CQL comandos tooverify si Hola clúster funciona:</span><span class="sxs-lookup"><span data-stu-id="25d0f-556">Use hello following CQL commands tooverify if hello cluster is working:</span></span>
   
     <span data-ttu-id="25d0f-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span><span class="sxs-lookup"><span data-stu-id="25d0f-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="25d0f-558">SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="25d0f-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="25d0f-559">Debería ver una presentación como Hola a continuación:</span><span class="sxs-lookup"><span data-stu-id="25d0f-559">You should see a display like hello one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="25d0f-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="25d0f-560">customer_id</span></span> </th><th> <span data-ttu-id="25d0f-561">firstname</span><span class="sxs-lookup"><span data-stu-id="25d0f-561">firstname</span></span> </th><th> <span data-ttu-id="25d0f-562">Lastname</span><span class="sxs-lookup"><span data-stu-id="25d0f-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="25d0f-563">1</span><span class="sxs-lookup"><span data-stu-id="25d0f-563">1</span></span> </td><td> <span data-ttu-id="25d0f-564">John</span><span class="sxs-lookup"><span data-stu-id="25d0f-564">John</span></span> </td><td> <span data-ttu-id="25d0f-565">Doe</span><span class="sxs-lookup"><span data-stu-id="25d0f-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="25d0f-566">2</span><span class="sxs-lookup"><span data-stu-id="25d0f-566">2</span></span> </td><td> <span data-ttu-id="25d0f-567">Julia</span><span class="sxs-lookup"><span data-stu-id="25d0f-567">Jane</span></span> </td><td> <span data-ttu-id="25d0f-568">Doe</span><span class="sxs-lookup"><span data-stu-id="25d0f-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="25d0f-569">Tenga en cuenta que keyspace Hola creado en el paso 4 utiliza SimpleStrategy con un replication_factor de 3.</span><span class="sxs-lookup"><span data-stu-id="25d0f-569">Please note that hello keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="25d0f-570">SimpleStrategy se recomienda para las implementaciones de un solo centro de datos, mientras que NetworkTopologyStrategy para implementaciones de varios centros de datos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="25d0f-571">Un replication_factor de 3 proporcionará tolerancia a errores de nodo.</span><span class="sxs-lookup"><span data-stu-id="25d0f-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="25d0f-572"><a id="tworegion"></a>Proceso de implementación de varias regiones</span><span class="sxs-lookup"><span data-stu-id="25d0f-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="25d0f-573">Se aprovechan la implementación en una única región Hola completado y repita Hola mismo proceso para la instalación de la segunda región de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-573">Will leverage hello single region deployment completed and repeat hello same process for installing hello second region.</span></span> <span data-ttu-id="25d0f-574">Hola principal diferencia entre hello único y varios implementación en una región es configuración de túnel VPN de hello para la comunicación entre región; comenzar con la instalación de red de hello, aprovisionar máquinas virtuales de Hola y configurar a Casandra.</span><span class="sxs-lookup"><span data-stu-id="25d0f-574">hello key difference between hello single and multiple region deployment is hello VPN tunnel setup for inter-region communication; we will start with hello network installation, provision hello VMs and configure Cassandra.</span></span>

### <a name="step-1-create-hello-virtual-network-at-hello-2nd-region"></a><span data-ttu-id="25d0f-575">Paso 1: Crear red Virtual de hello en hello 2nd región</span><span class="sxs-lookup"><span data-stu-id="25d0f-575">Step 1: Create hello Virtual Network at hello 2nd Region</span></span>
<span data-ttu-id="25d0f-576">Inicie sesión en el portal de Azure clásico de Hola y crear una red Virtual con el programa de atributos de hello en la tabla de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-576">Log into hello Azure classic portal and create a Virtual Network with hello attributes show in hello table.</span></span> <span data-ttu-id="25d0f-577">Vea [configurar una red Virtual solo en el portal de Azure clásico hello](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) para obtener pasos detallados del proceso de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-577">See [Configure a Cloud-Only Virtual Network in hello Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="25d0f-578">Nombre del atributo</span><span class="sxs-lookup"><span data-stu-id="25d0f-578">Attribute Name</span></span>    </th><th><span data-ttu-id="25d0f-579">Valor</span><span class="sxs-lookup"><span data-stu-id="25d0f-579">Value</span></span>    </th><th><span data-ttu-id="25d0f-580">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-581">Nombre</span><span class="sxs-lookup"><span data-stu-id="25d0f-581">Name</span></span>    </td><td><span data-ttu-id="25d0f-582">vnet-cass-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="25d0f-583">Region</span><span class="sxs-lookup"><span data-stu-id="25d0f-583">Region</span></span>    </td><td><span data-ttu-id="25d0f-584">Este de EE. UU.</span><span class="sxs-lookup"><span data-stu-id="25d0f-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="25d0f-585">Servidores DNS</span><span class="sxs-lookup"><span data-stu-id="25d0f-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="25d0f-586">Ignore esto, ya que no estamos usando un servidor DNS</span><span class="sxs-lookup"><span data-stu-id="25d0f-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-587">Configurar una VPN de punto a sitio</span><span class="sxs-lookup"><span data-stu-id="25d0f-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="25d0f-588">Ignore esto</span><span class="sxs-lookup"><span data-stu-id="25d0f-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-589">Configurar una VPN de sitio a sitio</span><span class="sxs-lookup"><span data-stu-id="25d0f-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="25d0f-590">Ignore esto</span><span class="sxs-lookup"><span data-stu-id="25d0f-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-591">Espacio de direcciones</span><span class="sxs-lookup"><span data-stu-id="25d0f-591">Address Space</span></span>    </td><td><span data-ttu-id="25d0f-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="25d0f-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="25d0f-593">IP inicial:</span><span class="sxs-lookup"><span data-stu-id="25d0f-593">Starting IP</span></span>    </td><td><span data-ttu-id="25d0f-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="25d0f-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="25d0f-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="25d0f-595">CIDR</span></span>    </td><td><span data-ttu-id="25d0f-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="25d0f-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="25d0f-597">Agregue Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-597">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-598">Nombre</span><span class="sxs-lookup"><span data-stu-id="25d0f-598">Name</span></span>    </th><th><span data-ttu-id="25d0f-599">IP inicial:</span><span class="sxs-lookup"><span data-stu-id="25d0f-599">Starting IP</span></span>    </th><th><span data-ttu-id="25d0f-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="25d0f-600">CIDR</span></span>    </th><th><span data-ttu-id="25d0f-601">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-602">web</span><span class="sxs-lookup"><span data-stu-id="25d0f-602">web</span></span>    </td><td><span data-ttu-id="25d0f-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="25d0f-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="25d0f-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="25d0f-604">/24 (251)</span></span>    </td><td><span data-ttu-id="25d0f-605">Subred para la granja de servidores de hello web</span><span class="sxs-lookup"><span data-stu-id="25d0f-605">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-606">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-606">data</span></span>    </td><td><span data-ttu-id="25d0f-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="25d0f-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="25d0f-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="25d0f-608">/24 (251)</span></span>    </td><td><span data-ttu-id="25d0f-609">Subred para los nodos de la base de datos de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-609">Subnet for hello database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="25d0f-610">Paso 2: Creación de redes locales</span><span class="sxs-lookup"><span data-stu-id="25d0f-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="25d0f-611">Una red Local en la red virtual de Azure es un espacio de direcciones de proxy que se asigna el sitio remoto tooa como una nube privada u otra región de Azure.</span><span class="sxs-lookup"><span data-stu-id="25d0f-611">A Local Network in Azure virtual networking is a proxy address space that maps tooa remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="25d0f-612">Este espacio de direcciones de proxy es tooa enlazado puerta de enlace remota para enrutamiento de red de toohello derecha destinos de red.</span><span class="sxs-lookup"><span data-stu-id="25d0f-612">This proxy address space is bound tooa remote gateway for routing network toohello right networking destinations.</span></span> <span data-ttu-id="25d0f-613">Vea [configurar una conexión de red virtual tooVNet](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) para obtener instrucciones acerca de cómo establecer la conexión de red virtual a red virtual Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-613">See [Configure a VNet tooVNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for hello instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="25d0f-614">Cree dos redes locales por hello detalles siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-614">Create two local networks per hello following details:</span></span>

| <span data-ttu-id="25d0f-615">Nombre de red</span><span class="sxs-lookup"><span data-stu-id="25d0f-615">Network Name</span></span> | <span data-ttu-id="25d0f-616">Dirección de puerta de enlace VPN</span><span class="sxs-lookup"><span data-stu-id="25d0f-616">VPN Gateway Address</span></span> | <span data-ttu-id="25d0f-617">Espacio de direcciones</span><span class="sxs-lookup"><span data-stu-id="25d0f-617">Address Space</span></span> | <span data-ttu-id="25d0f-618">Comentarios</span><span class="sxs-lookup"><span data-stu-id="25d0f-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="25d0f-619">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="25d0f-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="25d0f-620">23.1.1.1</span></span> |<span data-ttu-id="25d0f-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="25d0f-621">10.2.0.0/16</span></span> |<span data-ttu-id="25d0f-622">Durante la creación de hello red Local proporcionan un marcador de posición de la dirección de puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="25d0f-622">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="25d0f-623">dirección de puerta de enlace real de Hola se rellena una vez creada la puerta de enlace de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-623">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="25d0f-624">Libere espacio de dirección de hello seguro coincide exactamente con Hola respectivo red virtual remota; en este caso hello red virtual creados en hello región Este de EE..</span><span class="sxs-lookup"><span data-stu-id="25d0f-624">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello East US region.</span></span> |
| <span data-ttu-id="25d0f-625">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="25d0f-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="25d0f-626">23.2.2.2</span></span> |<span data-ttu-id="25d0f-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="25d0f-627">10.1.0.0/16</span></span> |<span data-ttu-id="25d0f-628">Durante la creación de hello red Local proporcionan un marcador de posición de la dirección de puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="25d0f-628">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="25d0f-629">dirección de puerta de enlace real de Hola se rellena una vez creada la puerta de enlace de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-629">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="25d0f-630">Libere espacio de dirección de hello seguro coincide exactamente con Hola respectivo red virtual remota; en este caso hello red virtual creados en hello región Oeste de Estados Unidos.</span><span class="sxs-lookup"><span data-stu-id="25d0f-630">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello West US region.</span></span> |

### <a name="step-3-map-local-network-toohello-respective-vnets"></a><span data-ttu-id="25d0f-631">Paso 3: Mapa "red"Local"toohello respectivas redes virtuales</span><span class="sxs-lookup"><span data-stu-id="25d0f-631">Step 3: Map “Local” network toohello respective VNETs</span></span>
<span data-ttu-id="25d0f-632">De hello portal de Azure clásico, seleccione cada red virtual, haga clic en "Configurar", compruebe "Conectar toohello red local" y seleccione Hola redes locales por hello detalles siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-632">From hello Azure classic portal, select each vnet, click “Configure”, check “Connect toohello local network”, and select hello Local Networks per hello following details:</span></span>

| <span data-ttu-id="25d0f-633">Virtual Network</span><span class="sxs-lookup"><span data-stu-id="25d0f-633">Virtual Network</span></span> | <span data-ttu-id="25d0f-634">Red local</span><span class="sxs-lookup"><span data-stu-id="25d0f-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="25d0f-635">hk-vnet-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-635">hk-vnet-west-us</span></span> |<span data-ttu-id="25d0f-636">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="25d0f-637">hk-vnet-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-637">hk-vnet-east-us</span></span> |<span data-ttu-id="25d0f-638">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="25d0f-639">Paso 4: Creación de puertas de enlace en VNET1 y VNET2</span><span class="sxs-lookup"><span data-stu-id="25d0f-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="25d0f-640">En el panel de Hola de ambas redes virtuales hello, haga clic en crear puerta de enlace que se desencadenará el proceso de aprovisionamiento de puerta de enlace VPN Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-640">From hello dashboard of both hello virtual networks, click CREATE GATEWAY which will trigger hello VPN gateway provisioning process.</span></span> <span data-ttu-id="25d0f-641">Después de unos minutos Hola panel de cada red virtual debe mostrar la dirección de puerta de enlace real de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-641">After a few minutes hello dashboard of each virtual network should display hello actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-hello-respective-gateway-addresses"></a><span data-ttu-id="25d0f-642">Paso 5: Actualización "Local" las redes con direcciones de respectivos "Gateway" hello</span><span class="sxs-lookup"><span data-stu-id="25d0f-642">Step 5: Update “Local” networks with hello respective “Gateway” addresses</span></span>
<span data-ttu-id="25d0f-643">Editar ambos Hola redes locales tooreplace Hola marcador de posición puerta de enlace IP dirección con la dirección IP real de Hola de hello simplemente aprovisionado puertas de enlace.</span><span class="sxs-lookup"><span data-stu-id="25d0f-643">Edit both hello local networks tooreplace hello placeholder gateway IP address with hello real IP address of hello just provisioned gateways.</span></span> <span data-ttu-id="25d0f-644">Usar hello después de asignación:</span><span class="sxs-lookup"><span data-stu-id="25d0f-644">Use hello following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="25d0f-645">Red local</span><span class="sxs-lookup"><span data-stu-id="25d0f-645">Local Network</span></span>    </th><th><span data-ttu-id="25d0f-646">Puerta de enlace de red virtual</span><span class="sxs-lookup"><span data-stu-id="25d0f-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="25d0f-647">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="25d0f-648">Puerta de enlace de hk-vnet-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="25d0f-649">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="25d0f-650">Puerta de enlace de hk-vnet-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-hello-shared-key"></a><span data-ttu-id="25d0f-651">Paso 6: Actualizar la clave compartida de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-651">Step 6: Update hello shared key</span></span>
<span data-ttu-id="25d0f-652">Hola de uso después de la clave IPSec Hola de tooupdate de script de Powershell de cada puerta de enlace VPN [usar Hola simplificar clave para las puertas de enlace de hello]: hk-lnet-map-to-west-us - LocalNetworkSiteName de Set-AzureVNetGatewayKey - VNetName hk-red virtual-este-us - SharedKey D9E76BKK Set-AzureVNetGatewayKey VNetName - hk-red virtual-oeste-us - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="25d0f-652">Use hello following Powershell script tooupdate hello IPSec key of each VPN gateway [use hello sake key for both hello gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-hello-vnet-to-vnet-connection"></a><span data-ttu-id="25d0f-653">Paso 7: Establecer la conexión de red virtual a red virtual de Hola</span><span class="sxs-lookup"><span data-stu-id="25d0f-653">Step 7: Establish hello VNET-to-VNET connection</span></span>
<span data-ttu-id="25d0f-654">En hello portal de Azure clásico, use el menú de "Panel" de Hola de ambos conexión de puerta de enlace a puerta de enlace hello tooestablish de redes virtuales.</span><span class="sxs-lookup"><span data-stu-id="25d0f-654">From hello Azure classic portal, use hello “DASHBOARD” menu of both hello virtual networks tooestablish gateway-to-gateway connection.</span></span> <span data-ttu-id="25d0f-655">Usar elementos de menú de Hola "Conectar" en la barra de herramientas de hello inferior.</span><span class="sxs-lookup"><span data-stu-id="25d0f-655">Use hello “CONNECT” menu items in hello bottom toolbar.</span></span> <span data-ttu-id="25d0f-656">Después de unos minutos panel Hola debe mostrar detalles de la conexión de hello gráficamente.</span><span class="sxs-lookup"><span data-stu-id="25d0f-656">After a few minutes hello dashboard should display hello connection details graphically.</span></span>

### <a name="step-8-create-hello-virtual-machines-in-region-2"></a><span data-ttu-id="25d0f-657">Paso 8: Crear máquinas virtuales de hello en la región #2</span><span class="sxs-lookup"><span data-stu-id="25d0f-657">Step 8: Create hello virtual machines in region #2</span></span>
<span data-ttu-id="25d0f-658">Crear imagen de Ubuntu Hola según se describió en la implementación de una región #1 siguiente Hola mismo pasos o copiar Hola imagen VHD toohello almacenamiento de Azure cuenta archivos ubicado en la región #2 y crear imagen de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-658">Create hello Ubuntu image as described in region #1 deployment by following hello same steps or copy hello image VHD file toohello Azure storage account located in region #2 and create hello image.</span></span> <span data-ttu-id="25d0f-659">Use esta imagen y crear Hola siguiendo la lista de máquinas virtuales en un nuevo servicio de nube hk-c-svc-este-us:</span><span class="sxs-lookup"><span data-stu-id="25d0f-659">Use this image and create hello following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="25d0f-660">Nombre de máquina</span><span class="sxs-lookup"><span data-stu-id="25d0f-660">Machine Name</span></span> | <span data-ttu-id="25d0f-661">Subred</span><span class="sxs-lookup"><span data-stu-id="25d0f-661">Subnet</span></span> | <span data-ttu-id="25d0f-662">Dirección IP</span><span class="sxs-lookup"><span data-stu-id="25d0f-662">IP Address</span></span> | <span data-ttu-id="25d0f-663">El conjunto de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="25d0f-663">Availability set</span></span> | <span data-ttu-id="25d0f-664">Controlador de dominio/bastidor</span><span class="sxs-lookup"><span data-stu-id="25d0f-664">DC/Rack</span></span> | <span data-ttu-id="25d0f-665">¿Valor de inicialización?</span><span class="sxs-lookup"><span data-stu-id="25d0f-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="25d0f-666">hk-c1-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-666">hk-c1-east-us</span></span> |<span data-ttu-id="25d0f-667">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-667">data</span></span> |<span data-ttu-id="25d0f-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="25d0f-668">10.2.2.4</span></span> |<span data-ttu-id="25d0f-669">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-669">hk-c-aset-1</span></span> |<span data-ttu-id="25d0f-670">dc =EASTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="25d0f-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="25d0f-671">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-671">Yes</span></span> |
| <span data-ttu-id="25d0f-672">hk-c2-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-672">hk-c2-east-us</span></span> |<span data-ttu-id="25d0f-673">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-673">data</span></span> |<span data-ttu-id="25d0f-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="25d0f-674">10.2.2.5</span></span> |<span data-ttu-id="25d0f-675">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-675">hk-c-aset-1</span></span> |<span data-ttu-id="25d0f-676">dc =EASTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="25d0f-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="25d0f-677">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-677">No</span></span> |
| <span data-ttu-id="25d0f-678">hk-c3-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-678">hk-c3-east-us</span></span> |<span data-ttu-id="25d0f-679">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-679">data</span></span> |<span data-ttu-id="25d0f-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="25d0f-680">10.2.2.6</span></span> |<span data-ttu-id="25d0f-681">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-681">hk-c-aset-1</span></span> |<span data-ttu-id="25d0f-682">dc =EASTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="25d0f-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="25d0f-683">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-683">Yes</span></span> |
| <span data-ttu-id="25d0f-684">hk-c5-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-684">hk-c5-east-us</span></span> |<span data-ttu-id="25d0f-685">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-685">data</span></span> |<span data-ttu-id="25d0f-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="25d0f-686">10.2.2.8</span></span> |<span data-ttu-id="25d0f-687">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-687">hk-c-aset-2</span></span> |<span data-ttu-id="25d0f-688">dc =EASTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="25d0f-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="25d0f-689">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-689">Yes</span></span> |
| <span data-ttu-id="25d0f-690">hk-c6-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-690">hk-c6-east-us</span></span> |<span data-ttu-id="25d0f-691">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-691">data</span></span> |<span data-ttu-id="25d0f-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="25d0f-692">10.2.2.9</span></span> |<span data-ttu-id="25d0f-693">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-693">hk-c-aset-2</span></span> |<span data-ttu-id="25d0f-694">dc =EASTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="25d0f-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="25d0f-695">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-695">No</span></span> |
| <span data-ttu-id="25d0f-696">hk-c7-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-696">hk-c7-east-us</span></span> |<span data-ttu-id="25d0f-697">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-697">data</span></span> |<span data-ttu-id="25d0f-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="25d0f-698">10.2.2.10</span></span> |<span data-ttu-id="25d0f-699">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-699">hk-c-aset-2</span></span> |<span data-ttu-id="25d0f-700">dc =EASTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="25d0f-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="25d0f-701">Sí</span><span class="sxs-lookup"><span data-stu-id="25d0f-701">Yes</span></span> |
| <span data-ttu-id="25d0f-702">hk-c8-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-702">hk-c8-east-us</span></span> |<span data-ttu-id="25d0f-703">data</span><span class="sxs-lookup"><span data-stu-id="25d0f-703">data</span></span> |<span data-ttu-id="25d0f-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="25d0f-704">10.2.2.11</span></span> |<span data-ttu-id="25d0f-705">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="25d0f-705">hk-c-aset-2</span></span> |<span data-ttu-id="25d0f-706">dc =EASTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="25d0f-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="25d0f-707">No</span><span class="sxs-lookup"><span data-stu-id="25d0f-707">No</span></span> |
| <span data-ttu-id="25d0f-708">hk-w1-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-708">hk-w1-east-us</span></span> |<span data-ttu-id="25d0f-709">web</span><span class="sxs-lookup"><span data-stu-id="25d0f-709">web</span></span> |<span data-ttu-id="25d0f-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="25d0f-710">10.2.1.4</span></span> |<span data-ttu-id="25d0f-711">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-711">hk-w-aset-1</span></span> |<span data-ttu-id="25d0f-712">N/D</span><span class="sxs-lookup"><span data-stu-id="25d0f-712">N/A</span></span> |<span data-ttu-id="25d0f-713">N/D</span><span class="sxs-lookup"><span data-stu-id="25d0f-713">N/A</span></span> |
| <span data-ttu-id="25d0f-714">hk-w2-east-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-714">hk-w2-east-us</span></span> |<span data-ttu-id="25d0f-715">web</span><span class="sxs-lookup"><span data-stu-id="25d0f-715">web</span></span> |<span data-ttu-id="25d0f-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="25d0f-716">10.2.1.5</span></span> |<span data-ttu-id="25d0f-717">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="25d0f-717">hk-w-aset-1</span></span> |<span data-ttu-id="25d0f-718">N/D</span><span class="sxs-lookup"><span data-stu-id="25d0f-718">N/A</span></span> |<span data-ttu-id="25d0f-719">N/D</span><span class="sxs-lookup"><span data-stu-id="25d0f-719">N/A</span></span> |

<span data-ttu-id="25d0f-720">Seguimiento Hola mismo instrucciones como región #1 pero usan el espacio de direcciones de 10.2.xxx.xxx.</span><span class="sxs-lookup"><span data-stu-id="25d0f-720">Follow hello same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="25d0f-721">Paso 9: Configuración de Cassandra en cada máquina virtual</span><span class="sxs-lookup"><span data-stu-id="25d0f-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="25d0f-722">Inicie sesión en hello VM y realizar Hola siguientes:</span><span class="sxs-lookup"><span data-stu-id="25d0f-722">Log into hello VM and perform hello following:</span></span>

1. <span data-ttu-id="25d0f-723">Editar $CASS_HOME/conf/cassandra-rackdc.properties toospecify Hola center y el bastidor de propiedades de datos en formato de hello: dc = bastidor EASTUS = bastidor1</span><span class="sxs-lookup"><span data-stu-id="25d0f-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties in hello format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="25d0f-724">Editar los nodos de valor de inicialización de cassandra.yaml tooconfigure: inicializaciones: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="25d0f-724">Edit cassandra.yaml tooconfigure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="25d0f-725">Paso 10: Inicio de Cassandra</span><span class="sxs-lookup"><span data-stu-id="25d0f-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="25d0f-726">Inicie sesión en cada máquina virtual e iniciar Casandra en segundo plano de Hola ejecutando el siguiente comando de hello: $CASS_HOME/bin/Casandra</span><span class="sxs-lookup"><span data-stu-id="25d0f-726">Log into each VM and start Cassandra in hello background by running hello following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-hello-multi-region-cluster"></a><span data-ttu-id="25d0f-727">Hola clúster consta de varias regiones de prueba</span><span class="sxs-lookup"><span data-stu-id="25d0f-727">Test hello Multi-Region Cluster</span></span>
<span data-ttu-id="25d0f-728">Por ahora Casandra ha sido implementado too16 nodos con 8 nodos en cada región de Azure.</span><span class="sxs-lookup"><span data-stu-id="25d0f-728">By now Cassandra has been deployed too16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="25d0f-729">Estos nodos están en hello mismo clúster en virtud de nombre de clúster común de Hola y la configuración de nodos de valor de inicialización de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-729">These nodes are in hello same cluster by virtue of hello common cluster name and hello seed node configuration.</span></span> <span data-ttu-id="25d0f-730">Usar hello después de clúster de proceso tootest hello:</span><span class="sxs-lookup"><span data-stu-id="25d0f-730">Use hello following process tootest hello cluster:</span></span>

### <a name="step-1-get-hello-internal-load-balancer-ip-for-both-hello-regions-using-powershell"></a><span data-ttu-id="25d0f-731">Paso 1: Obtener IP de equilibrador de carga interno de Hola para ambas regiones de hello mediante PowerShell</span><span class="sxs-lookup"><span data-stu-id="25d0f-731">Step 1: Get hello internal load balancer IP for both hello regions using PowerShell</span></span>
* <span data-ttu-id="25d0f-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span><span class="sxs-lookup"><span data-stu-id="25d0f-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="25d0f-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span><span class="sxs-lookup"><span data-stu-id="25d0f-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="25d0f-734">Tenga en cuenta las direcciones IP hello (por ejemplo, oeste - 10.1.2.101, este - 10.2.2.101) muestra.</span><span class="sxs-lookup"><span data-stu-id="25d0f-734">Note hello IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-hello-following-in-hello-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="25d0f-735">Paso 2: Ejecutar siguiente hello en la región del Oeste Hola tras iniciar sesión en hk-w1-oeste-us</span><span class="sxs-lookup"><span data-stu-id="25d0f-735">Step 2: Execute hello following in hello west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="25d0f-736">Ejecute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="25d0f-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="25d0f-737">Ejecute hello seguir CQL comandos:</span><span class="sxs-lookup"><span data-stu-id="25d0f-737">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="25d0f-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="25d0f-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="25d0f-739">Debería ver una presentación como Hola a continuación:</span><span class="sxs-lookup"><span data-stu-id="25d0f-739">You should see a display like hello one below:</span></span>

| <span data-ttu-id="25d0f-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="25d0f-740">customer_id</span></span> | <span data-ttu-id="25d0f-741">firstname</span><span class="sxs-lookup"><span data-stu-id="25d0f-741">firstname</span></span> | <span data-ttu-id="25d0f-742">Lastname</span><span class="sxs-lookup"><span data-stu-id="25d0f-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="25d0f-743">1</span><span class="sxs-lookup"><span data-stu-id="25d0f-743">1</span></span> |<span data-ttu-id="25d0f-744">John</span><span class="sxs-lookup"><span data-stu-id="25d0f-744">John</span></span> |<span data-ttu-id="25d0f-745">Doe</span><span class="sxs-lookup"><span data-stu-id="25d0f-745">Doe</span></span> |
| <span data-ttu-id="25d0f-746">2</span><span class="sxs-lookup"><span data-stu-id="25d0f-746">2</span></span> |<span data-ttu-id="25d0f-747">Julia</span><span class="sxs-lookup"><span data-stu-id="25d0f-747">Jane</span></span> |<span data-ttu-id="25d0f-748">Doe</span><span class="sxs-lookup"><span data-stu-id="25d0f-748">Doe</span></span> |

### <a name="step-3-execute-hello-following-in-hello-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="25d0f-749">Paso 3: Ejecutar siguiente hello en la región Este de hello tras iniciar sesión en hk-w1-este-us:</span><span class="sxs-lookup"><span data-stu-id="25d0f-749">Step 3: Execute hello following in hello east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="25d0f-750">Ejecute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="25d0f-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="25d0f-751">Ejecute hello seguir CQL comandos:</span><span class="sxs-lookup"><span data-stu-id="25d0f-751">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="25d0f-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="25d0f-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="25d0f-753">Debería ver Hola mismo mostrar tal como se muestra para la región del Oeste hello:</span><span class="sxs-lookup"><span data-stu-id="25d0f-753">You should see hello same display as seen for hello West region:</span></span>

| <span data-ttu-id="25d0f-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="25d0f-754">customer_id</span></span> | <span data-ttu-id="25d0f-755">firstname</span><span class="sxs-lookup"><span data-stu-id="25d0f-755">firstname</span></span> | <span data-ttu-id="25d0f-756">Lastname</span><span class="sxs-lookup"><span data-stu-id="25d0f-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="25d0f-757">1</span><span class="sxs-lookup"><span data-stu-id="25d0f-757">1</span></span> |<span data-ttu-id="25d0f-758">John</span><span class="sxs-lookup"><span data-stu-id="25d0f-758">John</span></span> |<span data-ttu-id="25d0f-759">Doe</span><span class="sxs-lookup"><span data-stu-id="25d0f-759">Doe</span></span> |
| <span data-ttu-id="25d0f-760">2</span><span class="sxs-lookup"><span data-stu-id="25d0f-760">2</span></span> |<span data-ttu-id="25d0f-761">Julia</span><span class="sxs-lookup"><span data-stu-id="25d0f-761">Jane</span></span> |<span data-ttu-id="25d0f-762">Doe</span><span class="sxs-lookup"><span data-stu-id="25d0f-762">Doe</span></span> |

<span data-ttu-id="25d0f-763">Ejecutar unas inserciones más y vea que las que se pueden obtener replicada toowest-us parte del clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="25d0f-763">Execute a few more inserts and see that those get replicated toowest-us part of hello cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="25d0f-764">Probar el clúster de Cassandra desde Node.js</span><span class="sxs-lookup"><span data-stu-id="25d0f-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="25d0f-765">Utilizando una de las máquinas virtuales de Linux de hello crearán previamente en el nivel de "web" Hola, ejecutamos una simples datos Hola insertada previamente de Node.js script tooread</span><span class="sxs-lookup"><span data-stu-id="25d0f-765">Using one of hello Linux VMs crated in hello "web" tier previously, we will execute a simple Node.js script tooread hello previously inserted data</span></span>

<span data-ttu-id="25d0f-766">**Paso 1: Instalación de Node.js y del cliente de Cassandra**</span><span class="sxs-lookup"><span data-stu-id="25d0f-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="25d0f-767">Instalar Node.js y NPM</span><span class="sxs-lookup"><span data-stu-id="25d0f-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="25d0f-768">Instalar el paquete de nodo "cassandra-client" con NPM</span><span class="sxs-lookup"><span data-stu-id="25d0f-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="25d0f-769">Ejecute hello siguiente secuencia de comandos en símbolo del sistema de hello shell que muestra la cadena de json de Hola de hello recuperar datos:</span><span class="sxs-lookup"><span data-stu-id="25d0f-769">Execute hello following script at hello shell prompt which displays hello json string of hello retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed toocreate Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed toocreate column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert hello record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read hello two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue hello code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="25d0f-770">Conclusión</span><span class="sxs-lookup"><span data-stu-id="25d0f-770">Conclusion</span></span>
<span data-ttu-id="25d0f-771">Microsoft Azure es una plataforma flexible que permite la ejecución de Hola de Microsoft así como software de código abierto como se muestra en este ejercicio.</span><span class="sxs-lookup"><span data-stu-id="25d0f-771">Microsoft Azure is a flexible platform that allows hello running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="25d0f-772">Clústeres de alta disponibilidad Casandra pueden implementarse en un solo centro de datos a través de hello repartir Hola nodos de clúster entre varios dominios de error.</span><span class="sxs-lookup"><span data-stu-id="25d0f-772">Highly available Cassandra clusters can be deployed on a single data center through hello spreading of hello cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="25d0f-773">También se pueden implementar clústeres Cassandra en varias regiones de Azure geográficamente distantes para sistemas de prueba ante desastres.</span><span class="sxs-lookup"><span data-stu-id="25d0f-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="25d0f-774">Azure y permite juntos Casandra Hola construcción de altamente escalable, de alta disponibilidad y servicios en la nube recuperable ante desastres necesitan por internet de hoy en día escalar los servicios.</span><span class="sxs-lookup"><span data-stu-id="25d0f-774">Azure and Cassandra together enables hello construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="25d0f-775">Referencias</span><span class="sxs-lookup"><span data-stu-id="25d0f-775">References</span></span>
* [<span data-ttu-id="25d0f-776">http://cassandra.apache.org</span><span class="sxs-lookup"><span data-stu-id="25d0f-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="25d0f-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="25d0f-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="25d0f-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="25d0f-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

