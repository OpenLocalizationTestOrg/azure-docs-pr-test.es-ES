---
title: "Opciones de resolución de nombres DNS para máquinas virtuales Linux en Azure"
description: "Escenarios de resolución de nombres DNS para máquinas virtuales Linux en IaaS de Azure, incluidos los servicios DNS proporcionados y el servidor DNS externo híbrido y Bring Your Own DNS."
services: virtual-machines
documentationcenter: na
author: RicksterCDN
manager: timlt
editor: tysonn
ms.assetid: 787a1e04-cebf-4122-a1b4-1fcf0a2bbf5f
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2016
ms.author: rclaus
ms.openlocfilehash: cc06ee9305b4d3034154a0825c1aea53fe446f80
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="dns-name-resolution-options-for-linux-virtual-machines-in-azure"></a><span data-ttu-id="fe826-103">Opciones de resolución de nombres DNS para máquinas virtuales Linux en Azure</span><span class="sxs-lookup"><span data-stu-id="fe826-103">DNS Name Resolution options for Linux virtual machines in Azure</span></span>
<span data-ttu-id="fe826-104">Azure proporciona resolución de nombres DNS de forma predeterminada para todas las máquinas virtuales de una única red virtual.</span><span class="sxs-lookup"><span data-stu-id="fe826-104">Azure provides DNS name resolution by default for all virtual machines that are in a single virtual network.</span></span> <span data-ttu-id="fe826-105">Puede implementar su propia solución de resolución de nombre DNS si configura sus propios servicios DNS en las máquinas virtuales hospedadas de Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-105">You can implement your own DNS name resolution solution by configuring your own DNS services on your virtual machines that Azure hosts.</span></span> <span data-ttu-id="fe826-106">Los siguientes escenarios deberían ayudarle a elegir cuál funciona mejor para su situación.</span><span class="sxs-lookup"><span data-stu-id="fe826-106">The following scenarios should help you choose the one that works for your situation.</span></span>

* [<span data-ttu-id="fe826-107">Resolución de nombres que proporciona Azure</span><span class="sxs-lookup"><span data-stu-id="fe826-107">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution)
* [<span data-ttu-id="fe826-108">Resolución de nombres mediante su propio servidor DNS</span><span class="sxs-lookup"><span data-stu-id="fe826-108">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server)

<span data-ttu-id="fe826-109">El tipo de resolución de nombres que use dependerá de cómo se comuniquen las máquinas virtuales y las instancias de rol entre sí.</span><span class="sxs-lookup"><span data-stu-id="fe826-109">The type of name resolution that you use depends on how your virtual machines and role instances need to communicate with each other.</span></span>

<span data-ttu-id="fe826-110">En la siguiente tabla se muestran los escenarios y las soluciones de resolución de nombre correspondientes:</span><span class="sxs-lookup"><span data-stu-id="fe826-110">The following table illustrates scenarios and corresponding name resolution solutions:</span></span>

| <span data-ttu-id="fe826-111">**Escenario**</span><span class="sxs-lookup"><span data-stu-id="fe826-111">**Scenario**</span></span> | <span data-ttu-id="fe826-112">**Solución**</span><span class="sxs-lookup"><span data-stu-id="fe826-112">**Solution**</span></span> | <span data-ttu-id="fe826-113">**Sufijo**</span><span class="sxs-lookup"><span data-stu-id="fe826-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fe826-114">Resolución de nombres entre instancias de rol o máquinas virtuales de la misma red virtual</span><span class="sxs-lookup"><span data-stu-id="fe826-114">Name resolution between role instances or virtual machines in the same virtual network</span></span> |[<span data-ttu-id="fe826-115">Resolución de nombres que proporciona Azure</span><span class="sxs-lookup"><span data-stu-id="fe826-115">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="fe826-116">El nombre de host o el nombre de dominio completo (FQDN)</span><span class="sxs-lookup"><span data-stu-id="fe826-116">hostname or fully-qualified domain name (FQDN)</span></span> |
| <span data-ttu-id="fe826-117">Resolución de nombres entre instancias de rol o máquinas virtuales de redes virtuales diferentes</span><span class="sxs-lookup"><span data-stu-id="fe826-117">Name resolution between role instances or virtual machines in different virtual networks</span></span> |<span data-ttu-id="fe826-118">Servidores DNS administrados por el cliente que reenvían consultas entre redes virtuales para la resolución mediante Azure (proxy DNS).</span><span class="sxs-lookup"><span data-stu-id="fe826-118">Customer-managed DNS servers that forward queries between virtual networks for resolution by Azure (DNS proxy).</span></span> <span data-ttu-id="fe826-119">Consulte [Resolución de nombres mediante su propio servidor DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="fe826-119">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="fe826-120">Solo FQDN</span><span class="sxs-lookup"><span data-stu-id="fe826-120">FQDN only</span></span> |
| <span data-ttu-id="fe826-121">Resolución de nombres de servicios y de equipos locales desde instancias de rol o máquinas virtuales en Azure</span><span class="sxs-lookup"><span data-stu-id="fe826-121">Resolution of on-premises computers and service names from role instances or virtual machines in Azure</span></span> |<span data-ttu-id="fe826-122">Servidores DNS administrados por el cliente (por ejemplo, controlador de dominio local, controlador de dominio de solo lectura local o un DNS secundario sincronizado mediante transferencias de zona).</span><span class="sxs-lookup"><span data-stu-id="fe826-122">Customer-managed DNS servers (for example, on-premises domain controller, local read-only domain controller, or a DNS secondary synced by using zone transfers).</span></span> <span data-ttu-id="fe826-123">Consulte [Resolución de nombres mediante su propio servidor DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="fe826-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="fe826-124">Solo FQDN</span><span class="sxs-lookup"><span data-stu-id="fe826-124">FQDN only</span></span> |
| <span data-ttu-id="fe826-125">Resolución de nombres de host de Azure desde equipos locales</span><span class="sxs-lookup"><span data-stu-id="fe826-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="fe826-126">Reenvío de consultas a un servidor proxy DNS administrado por el cliente en la red virtual correspondiente.</span><span class="sxs-lookup"><span data-stu-id="fe826-126">Forward queries to a customer-managed DNS proxy server in the corresponding virtual network.</span></span> <span data-ttu-id="fe826-127">El servidor proxy reenvía consultas a Azure para resolverlas.</span><span class="sxs-lookup"><span data-stu-id="fe826-127">The proxy server forwards queries to Azure for resolution.</span></span> <span data-ttu-id="fe826-128">Consulte [Resolución de nombres mediante su propio servidor DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="fe826-128">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="fe826-129">Solo FQDN</span><span class="sxs-lookup"><span data-stu-id="fe826-129">FQDN only</span></span> |
| <span data-ttu-id="fe826-130">DNS inverso para direcciones IP internas</span><span class="sxs-lookup"><span data-stu-id="fe826-130">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="fe826-131">Resolución de nombres mediante su propio servidor DNS</span><span class="sxs-lookup"><span data-stu-id="fe826-131">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="fe826-132">N/D</span><span class="sxs-lookup"><span data-stu-id="fe826-132">n/a</span></span> |

## <a name="name-resolution-that-azure-provides"></a><span data-ttu-id="fe826-133">Resolución de nombres que proporciona Azure</span><span class="sxs-lookup"><span data-stu-id="fe826-133">Name resolution that Azure provides</span></span>
<span data-ttu-id="fe826-134">Junto con la resolución de nombres DNS públicos, Azure proporciona resolución de nombres interna para máquinas virtuales e instancias de rol que se encuentren en la misma red virtual.</span><span class="sxs-lookup"><span data-stu-id="fe826-134">Along with resolution of public DNS names, Azure provides internal name resolution for virtual machines and role instances that are in the same virtual network.</span></span> <span data-ttu-id="fe826-135">En las redes virtuales basadas en Azure Resource Manager, el sufijo DNS es coherente en toda la red virtual. El FQDN no es necesario.</span><span class="sxs-lookup"><span data-stu-id="fe826-135">In virtual networks that are based on Azure Resource Manager, the DNS suffix is consistent across the virtual network; the FQDN is not needed.</span></span> <span data-ttu-id="fe826-136">Los nombres DNS pueden asignarse tanto a tarjetas de interfaz de red (NIC) como a máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="fe826-136">DNS names can be assigned to both network interface cards (NICs) and virtual machines.</span></span> <span data-ttu-id="fe826-137">Aunque la resolución de nombres que proporciona Azure no necesita ningún tipo de configuración, no es la opción adecuada para todos los escenarios de implementación, tal y como se mostró en la tabla anterior.</span><span class="sxs-lookup"><span data-stu-id="fe826-137">Although the name resolution that Azure provides does not require any configuration, it is not the appropriate choice for all deployment scenarios, as seen on the preceding table.</span></span>

### <a name="features-and-considerations"></a><span data-ttu-id="fe826-138">Características y consideraciones</span><span class="sxs-lookup"><span data-stu-id="fe826-138">Features and considerations</span></span>
<span data-ttu-id="fe826-139">**Características**</span><span class="sxs-lookup"><span data-stu-id="fe826-139">**Features:**</span></span>

* <span data-ttu-id="fe826-140">No es necesario realizar configuración alguna para usar la resolución de nombres proporcionada por Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-140">No configuration is required to use name resolution that Azure provides.</span></span>
* <span data-ttu-id="fe826-141">El servicio de resolución de nombres que proporciona Azure tiene una alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="fe826-141">The name resolution service that Azure provides is highly available.</span></span> <span data-ttu-id="fe826-142">No es necesario crear clústeres de sus propios servidores DNS ni administrarlos.</span><span class="sxs-lookup"><span data-stu-id="fe826-142">You don't need to create and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="fe826-143">El servicio de resolución de nombres proporcionado por Azure puede usarse junto con sus propios servidores DNS para resolver nombres de host tanto de Azure como locales.</span><span class="sxs-lookup"><span data-stu-id="fe826-143">The name resolution service that Azure provides can be used along with your own DNS servers to resolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="fe826-144">Se proporciona resolución de nombres entre las máquinas virtuales en redes virtuales sin necesidad de FQDN.</span><span class="sxs-lookup"><span data-stu-id="fe826-144">Name resolution is provided between virtual machines in virtual networks without need for the FQDN.</span></span>
* <span data-ttu-id="fe826-145">Puede usar los nombres de host que describan mejor las implementaciones, en lugar de trabajar con nombres generados automáticamente.</span><span class="sxs-lookup"><span data-stu-id="fe826-145">You can use hostnames that best describe your deployments rather than working with auto-generated names.</span></span>

<span data-ttu-id="fe826-146">**Consideraciones:**</span><span class="sxs-lookup"><span data-stu-id="fe826-146">**Considerations:**</span></span>

* <span data-ttu-id="fe826-147">No se puede modificar el sufijo DNS creado por Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-147">The DNS suffix that Azure creates cannot be modified.</span></span>
* <span data-ttu-id="fe826-148">No se pueden registrar manualmente los registros propios.</span><span class="sxs-lookup"><span data-stu-id="fe826-148">You cannot manually register your own records.</span></span>
* <span data-ttu-id="fe826-149">No se admiten ni WINS ni NetBIOS.</span><span class="sxs-lookup"><span data-stu-id="fe826-149">WINS and NetBIOS are not supported.</span></span>
* <span data-ttu-id="fe826-150">Los nombres de host deben ser compatibles con DNS.</span><span class="sxs-lookup"><span data-stu-id="fe826-150">Hostnames must be DNS-compatible.</span></span>
    <span data-ttu-id="fe826-151">Los nombres solamente pueden contener caracteres 0-9, a-z y "-", y no pueden comenzar ni terminar por "-".</span><span class="sxs-lookup"><span data-stu-id="fe826-151">Names must use only 0-9, a-z, and '-', and they cannot start or end with a '-'.</span></span> <span data-ttu-id="fe826-152">Consulte la sección 2 de RFC 3696.</span><span class="sxs-lookup"><span data-stu-id="fe826-152">See RFC 3696 Section 2.</span></span>
* <span data-ttu-id="fe826-153">El tráfico de consultas de DNS está limitado en cada máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="fe826-153">DNS query traffic is throttled for each virtual machine.</span></span> <span data-ttu-id="fe826-154">La limitación no debería afectar a la mayoría de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="fe826-154">Throttling shouldn't impact most applications.</span></span>  <span data-ttu-id="fe826-155">Si se observa una limitación de solicitudes, asegúrese de que está habilitado el almacenamiento en caché del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="fe826-155">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="fe826-156">Para obtener más información, consulte [Obtención del máximo partido de la resolución de nombres de Azure](#getting-the-most-from-name-resolution-that-azure-provides).</span><span class="sxs-lookup"><span data-stu-id="fe826-156">For more information, see [Getting the most from name resolution that Azure provides](#getting-the-most-from-name-resolution-that-azure-provides).</span></span>

### <a name="getting-the-most-from-name-resolution-that-azure-provides"></a><span data-ttu-id="fe826-157">Obtención del máximo partido de la resolución de nombres de Azure</span><span class="sxs-lookup"><span data-stu-id="fe826-157">Getting the most from name resolution that Azure provides</span></span>
<span data-ttu-id="fe826-158">**Almacenamiento en caché del lado cliente:**</span><span class="sxs-lookup"><span data-stu-id="fe826-158">**Client-side caching:**</span></span>

<span data-ttu-id="fe826-159">Algunas consultas de DNS no se envían a través de la red.</span><span class="sxs-lookup"><span data-stu-id="fe826-159">Some DNS queries are not sent across the network.</span></span> <span data-ttu-id="fe826-160">El almacenamiento en caché del lado cliente ayuda a reducir la latencia y mejorar la resistencia a las incoherencias de la red mediante la resolución de consultas de DNS periódicas desde una caché local.</span><span class="sxs-lookup"><span data-stu-id="fe826-160">Client-side caching helps reduce latency and improve resilience to network inconsistencies by resolving recurring DNS queries from a local cache.</span></span> <span data-ttu-id="fe826-161">Los registros DNS contienen un período de vida (TTL) que permite a la caché almacenar el registro durante tanto tiempo como sea posible sin afectar a la actualización de los registros.</span><span class="sxs-lookup"><span data-stu-id="fe826-161">DNS records contain a Time-To-Live (TTL), which enables the cache to store the record for as long as possible without impacting record freshness.</span></span> <span data-ttu-id="fe826-162">Por ello, la caché del cliente es adecuada para la mayoría de las situaciones.</span><span class="sxs-lookup"><span data-stu-id="fe826-162">As a result, client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="fe826-163">Algunas distribuciones de Linux no incluyen el almacenamiento en caché de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="fe826-163">Some Linux distributions do not include caching by default.</span></span> <span data-ttu-id="fe826-164">Se recomienda agregar una caché a cada máquina virtual Linux una vez comprobado que no exista ya una caché local.</span><span class="sxs-lookup"><span data-stu-id="fe826-164">We recommend that you add a cache to each Linux virtual machine after you check that there isn't a local cache already.</span></span>

<span data-ttu-id="fe826-165">Hay disponibles varios paquetes de almacenamiento en caché DNS, como dnsmasq.</span><span class="sxs-lookup"><span data-stu-id="fe826-165">Several different DNS caching packages, such as dnsmasq, are available.</span></span> <span data-ttu-id="fe826-166">Estos son los pasos que hay que seguir para instalar dnsmasq en las distribuciones más habituales:</span><span class="sxs-lookup"><span data-stu-id="fe826-166">Here are the steps to install dnsmasq on the most common distributions:</span></span>

<span data-ttu-id="fe826-167">**Ubuntu (usa resolvconf)**</span><span class="sxs-lookup"><span data-stu-id="fe826-167">**Ubuntu (uses resolvconf)**</span></span>
  * <span data-ttu-id="fe826-168">Instale el paquete dnsmasq ("sudo apt-get install dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="fe826-168">Install the dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>

<span data-ttu-id="fe826-169">**SUSE (usa netconf)**:</span><span class="sxs-lookup"><span data-stu-id="fe826-169">**SUSE (uses netconf)**:</span></span>
1. <span data-ttu-id="fe826-170">Instale el paquete dnsmasq ("sudo zypper install dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="fe826-170">Install the dnsmasq package (“sudo zypper install dnsmasq”).</span></span>
2. <span data-ttu-id="fe826-171">Habilite el servicio de dnsmasq ("systemctl enable dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="fe826-171">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="fe826-172">Inicie el servicio de dnsmasq ("systemctl start dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="fe826-172">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="fe826-173">Edite "/etc/sysconfig/network/config" y cambie NETCONFIG_DNS_FORWARDER="" por "dnsmasq".</span><span class="sxs-lookup"><span data-stu-id="fe826-173">Edit “/etc/sysconfig/network/config”, and change NETCONFIG_DNS_FORWARDER="" to ”dnsmasq”.</span></span>
5. <span data-ttu-id="fe826-174">Actualice resolv.conf ("netconfig update") para establecer la memoria caché como la resolución DNS local.</span><span class="sxs-lookup"><span data-stu-id="fe826-174">Update resolv.conf ("netconfig update") to set the cache as the local DNS resolver.</span></span>

<span data-ttu-id="fe826-175">**CentOS de Rogue Wave Software (anteriormente OpenLogic; usa NetworkManager)**</span><span class="sxs-lookup"><span data-stu-id="fe826-175">**CentOS by Rogue Wave Software (formerly OpenLogic; uses NetworkManager)**</span></span>
1. <span data-ttu-id="fe826-176">Instale el paquete dnsmasq ("sudo yum install dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="fe826-176">Install the dnsmasq package (“sudo yum install dnsmasq”).</span></span>
2. <span data-ttu-id="fe826-177">Habilite el servicio de dnsmasq ("systemctl enable dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="fe826-177">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="fe826-178">Inicie el servicio de dnsmasq ("systemctl start dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="fe826-178">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="fe826-179">Agregue "prepend domain-name-servers 127.0.0.1;" a "/etc/dhclient-eth0.conf".</span><span class="sxs-lookup"><span data-stu-id="fe826-179">Add “prepend domain-name-servers 127.0.0.1;” to “/etc/dhclient-eth0.conf”.</span></span>
5. <span data-ttu-id="fe826-180">Reinicie el servicio de red ("service network restart") para establecer la caché como la resolución DNS local.</span><span class="sxs-lookup"><span data-stu-id="fe826-180">Restart the network service (“service network restart”) to set the cache as the local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="fe826-181">: El paquete "dnsmasq" es solo una de las muchas cachés DNS disponibles para Linux.</span><span class="sxs-lookup"><span data-stu-id="fe826-181">: The 'dnsmasq' package is only one of the many DNS caches that are available for Linux.</span></span> <span data-ttu-id="fe826-182">Antes de usarlo, compruebe su idoneidad para sus necesidades y asegúrese de que no haya instalada ninguna otra memoria caché.</span><span class="sxs-lookup"><span data-stu-id="fe826-182">Before you use it, check its suitability for your needs and that no other cache is installed.</span></span>
>
>

<span data-ttu-id="fe826-183">**Reintentos del cliente:**</span><span class="sxs-lookup"><span data-stu-id="fe826-183">**Client-side retries**</span></span>

<span data-ttu-id="fe826-184">DNS es principalmente un protocolo UDP.</span><span class="sxs-lookup"><span data-stu-id="fe826-184">DNS is primarily a UDP protocol.</span></span> <span data-ttu-id="fe826-185">Dado que el protocolo UDP no garantiza la entrega de mensajes, es el propio protocolo DNS el que controla la lógica de reintento.</span><span class="sxs-lookup"><span data-stu-id="fe826-185">Because the UDP protocol doesn't guarantee message delivery, the DNS protocol itself handles retry logic.</span></span> <span data-ttu-id="fe826-186">Cada cliente DNS (sistema operativo) puede presentar una lógica de reintento diferente en función de la preferencia del creador:</span><span class="sxs-lookup"><span data-stu-id="fe826-186">Each DNS client (operating system) can exhibit different retry logic depending on the creator's preference:</span></span>

* <span data-ttu-id="fe826-187">Los sistemas operativos Windows realizan un reintento tras un segundo y después tras otros dos, cuatro y otros cuatro segundos.</span><span class="sxs-lookup"><span data-stu-id="fe826-187">Windows operating systems retry after one second and then again after another two, four, and another four seconds.</span></span>
* <span data-ttu-id="fe826-188">El programa de instalación predeterminado de Linux lo intenta después de cinco segundos.</span><span class="sxs-lookup"><span data-stu-id="fe826-188">The default Linux setup retries after five seconds.</span></span>  <span data-ttu-id="fe826-189">Se recomienda cambiar esta opción para reintentarlo cinco veces a intervalos de un segundo.</span><span class="sxs-lookup"><span data-stu-id="fe826-189">You should change this to retry five times at one-second intervals.</span></span>  

<span data-ttu-id="fe826-190">Para comprobar la configuración actual en una máquina virtual Linux, vaya a "cat /etc/resolv.conf" y busque la línea "options", por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="fe826-190">To check the current settings on a Linux virtual machine, 'cat /etc/resolv.conf', and look at the 'options' line, for example:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="fe826-191">El archivo resolv.conf es autogenerado y no se debe editar.</span><span class="sxs-lookup"><span data-stu-id="fe826-191">The resolv.conf file is auto-generated and should not be edited.</span></span> <span data-ttu-id="fe826-192">Los pasos específicos para agregar la línea "options" varían según la distribución:</span><span class="sxs-lookup"><span data-stu-id="fe826-192">The specific steps that add the 'options' line vary by distribution:</span></span>

<span data-ttu-id="fe826-193">**Ubuntu** (usa resolvconf)</span><span class="sxs-lookup"><span data-stu-id="fe826-193">**Ubuntu** (uses resolvconf)</span></span>
1. <span data-ttu-id="fe826-194">Agregue la línea de opciones a "/ etc/resolveconf/resolv.conf.d/head".</span><span class="sxs-lookup"><span data-stu-id="fe826-194">Add the options line to '/etc/resolveconf/resolv.conf.d/head'.</span></span>
2. <span data-ttu-id="fe826-195">Ejecute "resolvconf -u" para efectuar la actualización.</span><span class="sxs-lookup"><span data-stu-id="fe826-195">Run 'resolvconf -u' to update.</span></span>

<span data-ttu-id="fe826-196">**SUSE** (usa netconf)</span><span class="sxs-lookup"><span data-stu-id="fe826-196">**SUSE** (uses netconf)</span></span>
1. <span data-ttu-id="fe826-197">Agregue "timeout:1 attempts:5" al parámetro NETCONFIG_DNS_RESOLVER_OPTIONS="" en "/etc/sysconfig/network/config".</span><span class="sxs-lookup"><span data-stu-id="fe826-197">Add 'timeout:1 attempts:5' to the NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'.</span></span>
2. <span data-ttu-id="fe826-198">Ejecute "netconfig update" para efectuar la actualización.</span><span class="sxs-lookup"><span data-stu-id="fe826-198">Run 'netconfig update' to update.</span></span>

<span data-ttu-id="fe826-199">**CentOS de Rogue Wave Software (anteriormente OpenLogic)** (usa NetworkManager)</span><span class="sxs-lookup"><span data-stu-id="fe826-199">**CentOS by Rogue Wave Software (formerly OpenLogic)** (uses NetworkManager)</span></span>
1. <span data-ttu-id="fe826-200">Agregue "echo "options timeout:1 attempts:5"" a "/etc/NetworkManager/dispatcher.d/11-dhclient".</span><span class="sxs-lookup"><span data-stu-id="fe826-200">Add 'echo "options timeout:1 attempts:5"' to '/etc/NetworkManager/dispatcher.d/11-dhclient'.</span></span>
2. <span data-ttu-id="fe826-201">Ejecute "service network restart" para efectuar la actualización.</span><span class="sxs-lookup"><span data-stu-id="fe826-201">Run 'service network restart' to update.</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="fe826-202">Resolución de nombres mediante su propio servidor DNS</span><span class="sxs-lookup"><span data-stu-id="fe826-202">Name resolution using your own DNS server</span></span>
<span data-ttu-id="fe826-203">Puede que sus necesidades de resolución de nombres se escapen a las posibilidades de las características de Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-203">Your name resolution needs may go beyond the features that Azure provides.</span></span> <span data-ttu-id="fe826-204">Por ejemplo, puede necesitar resolución DNS entre redes virtuales.</span><span class="sxs-lookup"><span data-stu-id="fe826-204">For example, you might require DNS resolution between virtual networks.</span></span> <span data-ttu-id="fe826-205">Para resolver este tipo de escenarios, puede usar sus propios servidores DNS.</span><span class="sxs-lookup"><span data-stu-id="fe826-205">To cover this scenario, you can use your own DNS servers.</span></span>  

<span data-ttu-id="fe826-206">Los servidores DNS de una red virtual pueden reenviar consultas de DNS a resoluciones recursivas de Azure para resolver los nombres de host que se encuentren en la misma red virtual.</span><span class="sxs-lookup"><span data-stu-id="fe826-206">DNS servers within a virtual network can forward DNS queries to recursive resolvers of Azure to resolve hostnames that are in the same virtual network.</span></span> <span data-ttu-id="fe826-207">Por ejemplo, un servidor DNS que se ejecute en Azure puede responder a consultas de DNS de sus propios archivos de zonas DNS y reenviar todas las demás consultas a Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-207">For example, a DNS server that runs in Azure can respond to DNS queries for its own DNS zone files and forward all other queries to Azure.</span></span> <span data-ttu-id="fe826-208">Esta funcionalidad permite a la máquina virtual detectar tanto las entradas de los archivos de zona como los nombres de host proporcionados por Azure (a través del reenviador).</span><span class="sxs-lookup"><span data-stu-id="fe826-208">This functionality enables virtual machines to see both your entries in your zone files and hostnames that Azure provides (via the forwarder).</span></span> <span data-ttu-id="fe826-209">El acceso a las resoluciones recursivas de Azure se proporciona a través de la IP virtual 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="fe826-209">Access to the recursive resolvers of Azure is provided via the virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="fe826-210">El reenvío de DNS también habilita la resolución DNS entre redes virtuales y permite que las máquinas locales resuelvan los nombres de host que proporciona Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-210">DNS forwarding also enables DNS resolution between virtual networks and enables your on-premises machines to resolve hostnames that Azure provides.</span></span> <span data-ttu-id="fe826-211">Para resolver el nombre de host de una máquina virtual, la máquina virtual del servidor DNS debe residir en la misma red virtual y debe configurarse para desviar consultas de nombre de host a Azure.</span><span class="sxs-lookup"><span data-stu-id="fe826-211">To resolve a virtual machine's hostname, the DNS server virtual machine must reside in the same virtual network and be configured to forward hostname queries to Azure.</span></span> <span data-ttu-id="fe826-212">Dado que el sufijo DNS es diferente en cada red virtual, puede usar las reglas de desvío condicional para enviar consultas de DNS a la red virtual correcta para su resolución.</span><span class="sxs-lookup"><span data-stu-id="fe826-212">Because the DNS suffix is different in each virtual network, you can use conditional forwarding rules to send DNS queries to the correct virtual network for resolution.</span></span> <span data-ttu-id="fe826-213">En la imagen siguiente se muestran dos redes virtuales y una red local que está realizando resolución DNS entre redes virtuales con este método:</span><span class="sxs-lookup"><span data-stu-id="fe826-213">The following image shows two virtual networks and an on-premises network doing DNS resolution between virtual networks by using this method:</span></span>

![Resolución DNS entre redes virtuales](./media/azure-dns/inter-vnet-dns.png)

<span data-ttu-id="fe826-215">Cuando se usa la resolución de nombres proporcionada por Azure, el sufijo DNS interno se proporciona a cada máquina virtual mediante DHCP.</span><span class="sxs-lookup"><span data-stu-id="fe826-215">When you use name resolution that Azure provides, the internal DNS suffix is provided to each virtual machine by using DHCP.</span></span> <span data-ttu-id="fe826-216">Cuando usa su propia solución de resolución de nombres, no se proporciona este sufijo a las máquinas virtuales puesto que interfiere en otras arquitecturas DNS.</span><span class="sxs-lookup"><span data-stu-id="fe826-216">When you use your own name resolution solution, this suffix is not supplied to virtual machines because the suffix interferes with other DNS architectures.</span></span> <span data-ttu-id="fe826-217">Para hacer referencia a máquinas mediante FQDN, o para configurar el sufijo en las máquinas virtuales, este puede determinarse mediante PowerShell o la API:</span><span class="sxs-lookup"><span data-stu-id="fe826-217">To refer to machines by FQDN or to configure the suffix on your virtual machines, you can use PowerShell or the API to determine the suffix:</span></span>

* <span data-ttu-id="fe826-218">Para aquellas redes virtuales administradas por Azure Resource Manager, el sufijo está disponible a través del recurso de [tarjeta de interfaz de red](https://msdn.microsoft.com/library/azure/mt163668.aspx).</span><span class="sxs-lookup"><span data-stu-id="fe826-218">For virtual networks that are managed by Azure Resource Manager, the suffix is available via the [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource.</span></span> <span data-ttu-id="fe826-219">También puede ejecutar el comando `azure network public-ip show <resource group> <pip name>` para mostrar los datos de la IP pública, entre los que se incluye el FQDN de la NIC.</span><span class="sxs-lookup"><span data-stu-id="fe826-219">You can also run the `azure network public-ip show <resource group> <pip name>` command to display the details of your public IP, which includes the FQDN of the NIC.</span></span>

<span data-ttu-id="fe826-220">Si el reenvío de consultas a Azure no satisface sus necesidades, debe proporcionar su propia solución de DNS.</span><span class="sxs-lookup"><span data-stu-id="fe826-220">If forwarding queries to Azure doesn't suit your needs, you need to provide your own DNS solution.</span></span>  <span data-ttu-id="fe826-221">La solución DNS debe:</span><span class="sxs-lookup"><span data-stu-id="fe826-221">Your DNS solution needs to:</span></span>

* <span data-ttu-id="fe826-222">Proporcionar la resolución adecuada de nombres de host, por ejemplo, mediante [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="fe826-222">Provide appropriate hostname resolution, for example via [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span></span> <span data-ttu-id="fe826-223">Si usa DDNS, puede necesitar deshabilitar la limpieza de registros DNS.</span><span class="sxs-lookup"><span data-stu-id="fe826-223">If you use DDNS, you might need to disable DNS record scavenging.</span></span> <span data-ttu-id="fe826-224">Las concesiones DHCP de Azure son muy largas y la limpieza puede eliminar registros DNS de forma prematura.</span><span class="sxs-lookup"><span data-stu-id="fe826-224">DHCP leases of Azure are very long and scavenging may remove DNS records prematurely.</span></span>
* <span data-ttu-id="fe826-225">Proporcionar la resolución recursiva adecuada para permitir la resolución de nombres de dominio externos.</span><span class="sxs-lookup"><span data-stu-id="fe826-225">Provide appropriate recursive resolution to allow resolution of external domain names.</span></span>
* <span data-ttu-id="fe826-226">Estar accesible (TCP y UDP en el puerto 53) desde los clientes a los que sirve y poder acceder a Internet.</span><span class="sxs-lookup"><span data-stu-id="fe826-226">Be accessible (TCP and UDP on port 53) from the clients it serves and be able to access the Internet.</span></span>
* <span data-ttu-id="fe826-227">Tener protección contra el acceso desde Internet para mitigar las amenazas que suponen agentes externos.</span><span class="sxs-lookup"><span data-stu-id="fe826-227">Be secured against access from the Internet to mitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="fe826-228">Para conseguir un rendimiento óptimo, al usar máquinas virtuales en servidores DNS de Azure, deshabilite IPv6 y asigne una [Dirección IP pública a nivel de instancia](../../virtual-network/virtual-networks-instance-level-public-ip.md) a cada máquina virtual de servidor DNS.</span><span class="sxs-lookup"><span data-stu-id="fe826-228">For best performance, when you use virtual machines in Azure DNS servers, disable IPv6 and assign an [Instance-Level Public IP](../../virtual-network/virtual-networks-instance-level-public-ip.md) to each DNS server virtual machine.</span></span>  
>
>
