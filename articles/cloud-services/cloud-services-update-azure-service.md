---
title: "Actualización de un servicio en la nube | Microsoft Docs"
description: "Aprenda a actualizar servicios en la nube en Azure. Obtenga información acerca de cómo se realiza una actualización en un servicio en la nube para garantizar la disponibilidad."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 2ba9676ed2afce7f18446642527971f5001b5ca7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-update-a-cloud-service"></a><span data-ttu-id="42694-104">Actualización de un servicio en la nube</span><span class="sxs-lookup"><span data-stu-id="42694-104">How to update a cloud service</span></span>

<span data-ttu-id="42694-105">La actualización de un servicio en la nube, incluidos sus roles y el sistema operativo invitado, es un proceso de tres pasos.</span><span class="sxs-lookup"><span data-stu-id="42694-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="42694-106">En primer lugar, se deben cargar los archivos binarios y archivos de configuración para el nuevo servicio en la nube, o la versión del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="42694-106">First, the binaries and configuration files for the new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="42694-107">A continuación, Azure reserva recursos informáticos y de red para el servicio en la nube según los requisitos de la nueva versión de dicho servicio.</span><span class="sxs-lookup"><span data-stu-id="42694-107">Next, Azure reserves compute and network resources for the cloud service based on the requirements of the new cloud service version.</span></span> <span data-ttu-id="42694-108">Por último, Azure lleva a cabo una actualización gradual para actualizar de forma incremental el inquilino a la nueva versión o sistema operativo invitado, conservando su disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="42694-108">Finally, Azure performs a rolling upgrade to incrementally update the tenant to the new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="42694-109">En este artículo se tratan los detalles de este último paso: la actualización gradual.</span><span class="sxs-lookup"><span data-stu-id="42694-109">This article discusses the details of this last step – the rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="42694-110">Actualización de un servicio de Azure</span><span class="sxs-lookup"><span data-stu-id="42694-110">Update an Azure Service</span></span>
<span data-ttu-id="42694-111">Azure organiza las instancias de rol en agrupaciones lógicas denominadas dominios de actualización (UD).</span><span class="sxs-lookup"><span data-stu-id="42694-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="42694-112">Los dominios de actualización (UD) son conjuntos lógicos de instancias de rol que se actualizan como un grupo.</span><span class="sxs-lookup"><span data-stu-id="42694-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="42694-113">Azure actualiza un servicio en la nube con los UD de uno en uno, lo que permite a las instancias de otros UD continuar atendiendo el tráfico.</span><span class="sxs-lookup"><span data-stu-id="42694-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs to continue serving traffic.</span></span>

<span data-ttu-id="42694-114">El número predeterminado de dominios de actualización es 5.</span><span class="sxs-lookup"><span data-stu-id="42694-114">The default number of upgrade domains is 5.</span></span> <span data-ttu-id="42694-115">Puede especificar un número diferente de dominios de actualización incluyendo el atributo upgradeDomainCount en el archivo de definición de servicio (.csdef).</span><span class="sxs-lookup"><span data-stu-id="42694-115">You can specify a different number of upgrade domains by including the upgradeDomainCount attribute in the service’s definition file (.csdef).</span></span> <span data-ttu-id="42694-116">Para más información sobre el atributo upgradeDomainCount, consulte [Esquema WebRole](https://msdn.microsoft.com/library/azure/gg557553.aspx) o [Esquema WorkerRole](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="42694-116">For more information about the upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="42694-117">Al realizar una actualización local de uno o varios roles en el servicio, Azure actualiza los conjuntos de instancias de rol según el dominio de actualización al que pertenecen.</span><span class="sxs-lookup"><span data-stu-id="42694-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according to the upgrade domain to which they belong.</span></span> <span data-ttu-id="42694-118">Azure actualiza todas las instancias de un dominio de actualización dado (deteniéndolas, actualizándolas, conectándolas de nuevo), y luego pasa al dominio siguiente.</span><span class="sxs-lookup"><span data-stu-id="42694-118">Azure updates all of the instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto the next domain.</span></span> <span data-ttu-id="42694-119">Al detener solo las instancias que se ejecutan en el dominio de actualización en ese moment, Azure se asegura de que una actualización se realiza con el menor impacto posible en el servicio que está en ejecución.</span><span class="sxs-lookup"><span data-stu-id="42694-119">By stopping only the instances running in the current upgrade domain, Azure makes sure that an update occurs with the least possible impact to the running service.</span></span> <span data-ttu-id="42694-120">Para obtener más información, consulte [Cómo se realiza una actualización](#howanupgradeproceeds) más adelante en este artículo.</span><span class="sxs-lookup"><span data-stu-id="42694-120">For more information, see [How the update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="42694-121">Aunque en el contexto de Azure hay pequeñas diferencias entre los distintos tipos de **actualización**, en este documento el término "**actualización**" se usa de forma general en las explicaciones de los procesos y las descripciones de las características.</span><span class="sxs-lookup"><span data-stu-id="42694-121">While the terms **update** and **upgrade** have slightly different meaning in the context Azure, they can be used interchangeably for the processes and descriptions of the features in this document.</span></span>
>
>

<span data-ttu-id="42694-122">El servicio tiene que definir al menos dos instancias de un rol para que ese rol se actualice localmente sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="42694-122">Your service must define at least two instances of a role for that role to be updated in-place without downtime.</span></span> <span data-ttu-id="42694-123">Si consta de una única instancia de un rol, el servicio no estará disponible hasta que haya finalizado la actualización local.</span><span class="sxs-lookup"><span data-stu-id="42694-123">If the service consists of only one instance of one role, your service will be unavailable until the in-place update has finished.</span></span>

<span data-ttu-id="42694-124">Este tema trata la siguiente información sobre las actualizaciones de Azure:</span><span class="sxs-lookup"><span data-stu-id="42694-124">This topic covers the following information about Azure updates:</span></span>

* [<span data-ttu-id="42694-125">Cambios de servicio permitidos durante una actualización</span><span class="sxs-lookup"><span data-stu-id="42694-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="42694-126">Cómo se realiza una actualización</span><span class="sxs-lookup"><span data-stu-id="42694-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="42694-127">Reversión de una actualización</span><span class="sxs-lookup"><span data-stu-id="42694-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="42694-128">Iniciación de varias operaciones mutantes en una implementación en curso</span><span class="sxs-lookup"><span data-stu-id="42694-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="42694-129">Distribución de roles entre dominios de actualización</span><span class="sxs-lookup"><span data-stu-id="42694-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="42694-130">Cambios de servicio permitidos durante una actualización</span><span class="sxs-lookup"><span data-stu-id="42694-130">Allowed service changes during an update</span></span>
<span data-ttu-id="42694-131">La siguiente tabla muestra los cambios permitidos en un servicio durante una actualización:</span><span class="sxs-lookup"><span data-stu-id="42694-131">The following table shows the allowed changes to a service during an update:</span></span>

| <span data-ttu-id="42694-132">Cambios permitidos en el hospedaje, servicios y roles</span><span class="sxs-lookup"><span data-stu-id="42694-132">Changes permitted to hosting, services, and roles</span></span> | <span data-ttu-id="42694-133">Actualización local</span><span class="sxs-lookup"><span data-stu-id="42694-133">In-place update</span></span> | <span data-ttu-id="42694-134">Por etapas (intercambio de VIP)</span><span class="sxs-lookup"><span data-stu-id="42694-134">Staged (VIP swap)</span></span> | <span data-ttu-id="42694-135">Eliminar y volver a implementar</span><span class="sxs-lookup"><span data-stu-id="42694-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="42694-136">Versión del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="42694-136">Operating system version</span></span> |<span data-ttu-id="42694-137">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-137">Yes</span></span> |<span data-ttu-id="42694-138">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-138">Yes</span></span> |<span data-ttu-id="42694-139">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-139">Yes</span></span> |
| <span data-ttu-id="42694-140">Nivel de confianza de .NET</span><span class="sxs-lookup"><span data-stu-id="42694-140">.NET trust level</span></span> |<span data-ttu-id="42694-141">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-141">Yes</span></span> |<span data-ttu-id="42694-142">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-142">Yes</span></span> |<span data-ttu-id="42694-143">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-143">Yes</span></span> |
| <span data-ttu-id="42694-144">Tamaño de la máquina virtual<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="42694-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="42694-145">Sí<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="42694-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="42694-146">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-146">Yes</span></span> |<span data-ttu-id="42694-147">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-147">Yes</span></span> |
| <span data-ttu-id="42694-148">Configuración de almacenamiento local</span><span class="sxs-lookup"><span data-stu-id="42694-148">Local storage settings</span></span> |<span data-ttu-id="42694-149">Solo aumentar<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="42694-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="42694-150">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-150">Yes</span></span> |<span data-ttu-id="42694-151">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-151">Yes</span></span> |
| <span data-ttu-id="42694-152">Agregar o quitar roles en un servicio</span><span class="sxs-lookup"><span data-stu-id="42694-152">Add or remove roles in a service</span></span> |<span data-ttu-id="42694-153">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-153">Yes</span></span> |<span data-ttu-id="42694-154">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-154">Yes</span></span> |<span data-ttu-id="42694-155">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-155">Yes</span></span> |
| <span data-ttu-id="42694-156">Número de instancias de un rol concreto</span><span class="sxs-lookup"><span data-stu-id="42694-156">Number of instances of a particular role</span></span> |<span data-ttu-id="42694-157">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-157">Yes</span></span> |<span data-ttu-id="42694-158">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-158">Yes</span></span> |<span data-ttu-id="42694-159">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-159">Yes</span></span> |
| <span data-ttu-id="42694-160">Número o tipo de puntos de conexión de un servicio</span><span class="sxs-lookup"><span data-stu-id="42694-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="42694-161">Sí<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="42694-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="42694-162">No</span><span class="sxs-lookup"><span data-stu-id="42694-162">No</span></span> |<span data-ttu-id="42694-163">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-163">Yes</span></span> |
| <span data-ttu-id="42694-164">Nombres y valores de configuración</span><span class="sxs-lookup"><span data-stu-id="42694-164">Names and values of configuration settings</span></span> |<span data-ttu-id="42694-165">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-165">Yes</span></span> |<span data-ttu-id="42694-166">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-166">Yes</span></span> |<span data-ttu-id="42694-167">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-167">Yes</span></span> |
| <span data-ttu-id="42694-168">Valores (pero no nombres) de configuración</span><span class="sxs-lookup"><span data-stu-id="42694-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="42694-169">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-169">Yes</span></span> |<span data-ttu-id="42694-170">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-170">Yes</span></span> |<span data-ttu-id="42694-171">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-171">Yes</span></span> |
| <span data-ttu-id="42694-172">Incorporación de nuevos certificados</span><span class="sxs-lookup"><span data-stu-id="42694-172">Add new certificates</span></span> |<span data-ttu-id="42694-173">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-173">Yes</span></span> |<span data-ttu-id="42694-174">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-174">Yes</span></span> |<span data-ttu-id="42694-175">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-175">Yes</span></span> |
| <span data-ttu-id="42694-176">Cambio de certificados existentes</span><span class="sxs-lookup"><span data-stu-id="42694-176">Change existing certificates</span></span> |<span data-ttu-id="42694-177">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-177">Yes</span></span> |<span data-ttu-id="42694-178">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-178">Yes</span></span> |<span data-ttu-id="42694-179">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-179">Yes</span></span> |
| <span data-ttu-id="42694-180">Implementación de nuevo código</span><span class="sxs-lookup"><span data-stu-id="42694-180">Deploy new code</span></span> |<span data-ttu-id="42694-181">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-181">Yes</span></span> |<span data-ttu-id="42694-182">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-182">Yes</span></span> |<span data-ttu-id="42694-183">Sí</span><span class="sxs-lookup"><span data-stu-id="42694-183">Yes</span></span> |

<span data-ttu-id="42694-184"><sup>1</sup> Cambio de tamaño limitado al subconjunto de tamaños disponibles para el servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="42694-184"><sup>1</sup> Size change limited to the subset of sizes available for the cloud service.</span></span>

<span data-ttu-id="42694-185"><sup>2</sup> Requiere Azure SDK 1.5 o versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="42694-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="42694-186">Cambiar el tamaño de la máquina virtual destruirá los datos locales.</span><span class="sxs-lookup"><span data-stu-id="42694-186">Changing the virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="42694-187">Los elementos siguientes no se admiten durante una actualización:</span><span class="sxs-lookup"><span data-stu-id="42694-187">The following items are not supported during an update:</span></span>

* <span data-ttu-id="42694-188">Cambio del nombre de un rol.</span><span class="sxs-lookup"><span data-stu-id="42694-188">Changing the name of a role.</span></span> <span data-ttu-id="42694-189">Quitar y, a continuación, agregar el rol con el nuevo nombre.</span><span class="sxs-lookup"><span data-stu-id="42694-189">Remove and then add the role with the new name.</span></span>
* <span data-ttu-id="42694-190">Cambio del número de dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="42694-190">Changing of the Upgrade Domain count.</span></span>
* <span data-ttu-id="42694-191">Disminución del tamaño de los recursos locales.</span><span class="sxs-lookup"><span data-stu-id="42694-191">Decreasing the size of the local resources.</span></span>

<span data-ttu-id="42694-192">Si está realizando otras actualizaciones a la definición del servicio, como reducir el tamaño del recurso local, debe realizar una actualización de intercambio de VIP en su lugar.</span><span class="sxs-lookup"><span data-stu-id="42694-192">If you are making other updates to your service's definition, such as decreasing the size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="42694-193">Para obtener más información, consulte [Intercambiar implementaciones](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="42694-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="42694-194">Cómo se realiza una actualización</span><span class="sxs-lookup"><span data-stu-id="42694-194">How an upgrade proceeds</span></span>
<span data-ttu-id="42694-195">Puede decidir si desea actualizar todos los roles en el servicio o un único rol.</span><span class="sxs-lookup"><span data-stu-id="42694-195">You can decide whether you want to update all of the roles in your service or a single role in the service.</span></span> <span data-ttu-id="42694-196">En cualquier caso, todas las instancias de cada rol que se está actualizando y que pertenecen al primer dominio de actualización se detienen, se actualizan y se vuelven a conectar.</span><span class="sxs-lookup"><span data-stu-id="42694-196">In either case, all instances of each role that is being upgraded and belong to the first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="42694-197">Una vez que vuelvan a conectarse, las instancias en el segundo dominio de actualización se detienen, se actualizan y se vuelven a conectar.</span><span class="sxs-lookup"><span data-stu-id="42694-197">Once they are back online, the instances in the second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="42694-198">Un servicio en la nube puede tener como mucho una actualización activa a la vez.</span><span class="sxs-lookup"><span data-stu-id="42694-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="42694-199">La actualización se realiza siempre con la versión más reciente del servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="42694-199">The upgrade is always performed against the latest version of the cloud service.</span></span>

<span data-ttu-id="42694-200">El siguiente diagrama ilustra cómo funciona la actualización si está actualizando todos los roles en el servicio:</span><span class="sxs-lookup"><span data-stu-id="42694-200">The following diagram illustrates how the upgrade proceeds if you are upgrading all of the roles in the service:</span></span>

<span data-ttu-id="42694-201">![Actualizar servicio](media/cloud-services-update-azure-service/IC345879.png "Actualizar servicio")</span><span class="sxs-lookup"><span data-stu-id="42694-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="42694-202">El diagrama a continuación ilustra cómo tiene lugar la actualización si actualiza un único rol:</span><span class="sxs-lookup"><span data-stu-id="42694-202">This next diagram illustrates how the update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="42694-203">![Actualizar rol](media/cloud-services-update-azure-service/IC345880.png "Actualizar rol")</span><span class="sxs-lookup"><span data-stu-id="42694-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="42694-204">Durante una actualización automática, el controlador de tejido de Azure evalúa periódicamente el estado del servicio en la nube para determinar cuándo es seguro introducir el siguiente UD.</span><span class="sxs-lookup"><span data-stu-id="42694-204">During an automatic update, the Azure Fabric Controller periodically evaluates the health of the cloud service to determine when it’s safe to walk the next UD.</span></span> <span data-ttu-id="42694-205">Esta evaluación de estado se realiza por rol y tiene en cuenta únicamente las instancias de la versión más reciente (es decir, instancias de las UD que ya se han introducido).</span><span class="sxs-lookup"><span data-stu-id="42694-205">This health evaluation is performed on a per-role basis and considers only instances in the latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="42694-206">Comprueba que un número mínimo de instancias de rol, para cada rol, hayan alcanzado un estado terminal satisfactorio.</span><span class="sxs-lookup"><span data-stu-id="42694-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="42694-207">Tiempo de espera de inicio de la instancia de rol</span><span class="sxs-lookup"><span data-stu-id="42694-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="42694-208">Fabric Controller esperará 30 minutos a que cada instancia de rol llegue a un estado Iniciado.</span><span class="sxs-lookup"><span data-stu-id="42694-208">The Fabric Controller will wait 30 minutes for each role instance to reach a Started state.</span></span> <span data-ttu-id="42694-209">Si ha transcurrido la duración del tiempo de espera, Fabric Controller seguirá avanzando hasta la siguiente instancia de rol.</span><span class="sxs-lookup"><span data-stu-id="42694-209">If the timeout duration elapses, the Fabric Controller will continue walking to the next role instance.</span></span>

### <a name="impact-to-drive-data-during-cloud-service-upgrades"></a><span data-ttu-id="42694-210">Impacto en los datos de la unidad durante las actualizaciones de un servicio en la nube</span><span class="sxs-lookup"><span data-stu-id="42694-210">Impact to drive data during Cloud Service upgrades</span></span>

<span data-ttu-id="42694-211">Al actualizar un servicio desde una instancia única a varias instancias, el servicio se desactiva mientras se realiza la actualización debido a la forma en la que Azure actualiza los servicios.</span><span class="sxs-lookup"><span data-stu-id="42694-211">When upgrading a service from a single instance to multiple instances your service will be brought down while the upgrade is performed due to the way Azure upgrades services.</span></span> <span data-ttu-id="42694-212">La disponibilidad de servicio garantizada por el contrato de nivel de servicio solo se aplica a los servicios que se implementan con más de una instancia.</span><span class="sxs-lookup"><span data-stu-id="42694-212">The service level agreement guaranteeing service availability only applies to services that are deployed with more than one instance.</span></span> <span data-ttu-id="42694-213">En la lista siguiente se describe cómo afectará a los datos de cada unidad cada escenario de actualización de servicio de Azure:</span><span class="sxs-lookup"><span data-stu-id="42694-213">The following list describes how the data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="42694-214">Escenario</span><span class="sxs-lookup"><span data-stu-id="42694-214">Scenario</span></span>|<span data-ttu-id="42694-215">Unidad C</span><span class="sxs-lookup"><span data-stu-id="42694-215">C Drive</span></span>|<span data-ttu-id="42694-216">Unidad D</span><span class="sxs-lookup"><span data-stu-id="42694-216">D Drive</span></span>|<span data-ttu-id="42694-217">Unidad E</span><span class="sxs-lookup"><span data-stu-id="42694-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="42694-218">Reinicio de máquina virtual</span><span class="sxs-lookup"><span data-stu-id="42694-218">VM reboot</span></span>|<span data-ttu-id="42694-219">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-219">Preserved</span></span>|<span data-ttu-id="42694-220">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-220">Preserved</span></span>|<span data-ttu-id="42694-221">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-221">Preserved</span></span>|
|<span data-ttu-id="42694-222">Reinicio del Portal</span><span class="sxs-lookup"><span data-stu-id="42694-222">Portal reboot</span></span>|<span data-ttu-id="42694-223">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-223">Preserved</span></span>|<span data-ttu-id="42694-224">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-224">Preserved</span></span>|<span data-ttu-id="42694-225">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-225">Destroyed</span></span>|
|<span data-ttu-id="42694-226">Restablecimiento de la imagen inicial del portal</span><span class="sxs-lookup"><span data-stu-id="42694-226">Portal reimage</span></span>|<span data-ttu-id="42694-227">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-227">Preserved</span></span>|<span data-ttu-id="42694-228">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-228">Destroyed</span></span>|<span data-ttu-id="42694-229">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-229">Destroyed</span></span>|
|<span data-ttu-id="42694-230">Actualización local</span><span class="sxs-lookup"><span data-stu-id="42694-230">In-Place Upgrade</span></span>|<span data-ttu-id="42694-231">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-231">Preserved</span></span>|<span data-ttu-id="42694-232">Conservado</span><span class="sxs-lookup"><span data-stu-id="42694-232">Preserved</span></span>|<span data-ttu-id="42694-233">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-233">Destroyed</span></span>|
|<span data-ttu-id="42694-234">Migración de nodos</span><span class="sxs-lookup"><span data-stu-id="42694-234">Node migration</span></span>|<span data-ttu-id="42694-235">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-235">Destroyed</span></span>|<span data-ttu-id="42694-236">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-236">Destroyed</span></span>|<span data-ttu-id="42694-237">Destruido</span><span class="sxs-lookup"><span data-stu-id="42694-237">Destroyed</span></span>|

<span data-ttu-id="42694-238">Tenga en cuenta que, en la lista anterior, la unidad E: representa la unidad raíz de rol y no debe ser de tipo no modificable.</span><span class="sxs-lookup"><span data-stu-id="42694-238">Note that, in the above list, the E: drive represents the role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="42694-239">En su lugar, use la variable de entorno **%RoleRoot%** para representar la unidad.</span><span class="sxs-lookup"><span data-stu-id="42694-239">Instead, use the **%RoleRoot%** environment variable to represent the drive.</span></span>

<span data-ttu-id="42694-240">Para minimizar el tiempo de inactividad al actualizar un servicio de instancia única, implemente un nuevo servicio de varias instancias en el servidor de ensayo y realice un intercambio de VIP.</span><span class="sxs-lookup"><span data-stu-id="42694-240">To minimize the downtime when upgrading a single-instance service, deploy a new multi-instance service to the staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="42694-241">Reversión de una actualización</span><span class="sxs-lookup"><span data-stu-id="42694-241">Rollback of an update</span></span>
<span data-ttu-id="42694-242">Azure proporciona flexibilidad en la administración de servicios durante una actualización, permitiéndole iniciar operaciones adicionales en un servicio, una vez que el controlador de tejido de Azure acepta la solicitud de actualización inicial.</span><span class="sxs-lookup"><span data-stu-id="42694-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after the initial update request is accepted by the Azure Fabric Controller.</span></span> <span data-ttu-id="42694-243">Solo puede realizar una reversión cuando una actualización se encuentra en el estado de implementación **en curso** .</span><span class="sxs-lookup"><span data-stu-id="42694-243">A rollback can only be performed when an update (configuration change) or upgrade is in the **in progress** state on the deployment.</span></span> <span data-ttu-id="42694-244">Se considera que una actualización está en curso, siempre que haya por lo menos una instancia del servicio que aún no se ha actualizado a la nueva versión.</span><span class="sxs-lookup"><span data-stu-id="42694-244">An update or upgrade is considered to be in-progress as long as there is at least one instance of the service which has not yet been updated to the new version.</span></span> <span data-ttu-id="42694-245">Para ver si se permite una reversión, compruebe que el valor de la marca RollbackAllowed, devuelto por las operaciones [Obtener implementación](https://msdn.microsoft.com/library/azure/ee460804.aspx) y [Obtener propiedades de servicio en la nube](https://msdn.microsoft.com/library/azure/ee460806.aspx), está establecido en true.</span><span class="sxs-lookup"><span data-stu-id="42694-245">To test whether a rollback is allowed, check the value of the RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set to true.</span></span>

> [!NOTE]
> <span data-ttu-id="42694-246">Solo tiene sentido realizar una reversión en una actualización **local** , porque las actualizaciones de intercambio de VIP implican reemplazar una instancia en ejecución completa del servicio con otra.</span><span class="sxs-lookup"><span data-stu-id="42694-246">It only makes sense to call Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="42694-247">La reversión de una actualización en curso tiene los efectos siguientes en la implementación:</span><span class="sxs-lookup"><span data-stu-id="42694-247">Rollback of an in-progress update has the following effects on the deployment:</span></span>

* <span data-ttu-id="42694-248">Las instancias de rol que aún no se hayan actualizado a la nueva versión no se actualizan, porque esas instancias ya están ejecutando la versión de destino del servicio.</span><span class="sxs-lookup"><span data-stu-id="42694-248">Any role instances which had not yet been updated or upgraded to the new version are not updated or upgraded, because those instances are already running the target version of the service.</span></span>
* <span data-ttu-id="42694-249">Las instancias de rol que ya se hayan actualizado a la nueva versión del archivo de paquete de servicio (\*.cspkg) o del archivo de configuración (\*.cscfg) (o ambos archivos), se revierten a la versión previa a la actualización de estos archivos.</span><span class="sxs-lookup"><span data-stu-id="42694-249">Any role instances which had already been updated or upgraded to the new version of the service package (\*.cspkg) file or the service configuration (\*.cscfg) file (or both files) are reverted to the pre-upgrade version of these files.</span></span>

<span data-ttu-id="42694-250">Esta funcionalidad la proporcionan las características siguientes:</span><span class="sxs-lookup"><span data-stu-id="42694-250">This functionally is provided by the following features:</span></span>

* <span data-ttu-id="42694-251">La operación [Actualización o reversión de la actualización](https://msdn.microsoft.com/library/azure/hh403977.aspx), que puede llamarse en una actualización de configuración (desencadenada al llamar a [Cambiar configuración de implementación](https://msdn.microsoft.com/library/azure/ee460809.aspx)) o una actualización (desencadenada al llamar a [Actualizar implementación](https://msdn.microsoft.com/library/azure/ee460793.aspx)) siempre que haya como mínimo una instancia en el servicio que aún no se haya actualizado a la nueva versión.</span><span class="sxs-lookup"><span data-stu-id="42694-251">The [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in the service which has not yet been updated to the new version.</span></span>
* <span data-ttu-id="42694-252">El elemento bloqueado y el elemento RollbackAllowed, que se devuelven como parte del cuerpo de respuesta de las operaciones [Obtener implementación](https://msdn.microsoft.com/library/azure/ee460804.aspx) y [Obtener propiedades de servicio en la nube](https://msdn.microsoft.com/library/azure/ee460806.aspx):</span><span class="sxs-lookup"><span data-stu-id="42694-252">The Locked element and the RollbackAllowed element, which are returned as part of the response body of the [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="42694-253">El elemento bloqueado permite detectar cuándo se puede invocar una operación de mutación en una implementación determinada.</span><span class="sxs-lookup"><span data-stu-id="42694-253">The Locked element allows you to detect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="42694-254">El elemento RollbackAllowed permite detectar cuándo la operación de [Actualización o reversión de la actualización](https://msdn.microsoft.com/library/azure/hh403977.aspx) puede llamarse en una implementación determinada.</span><span class="sxs-lookup"><span data-stu-id="42694-254">The RollbackAllowed element allows you to detect when the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="42694-255">Para realizar una reversión, no es necesario comprobar los dos elementos Locked y RollbackAllowed.</span><span class="sxs-lookup"><span data-stu-id="42694-255">In order to perform a rollback, you do not have to check both the Locked and the RollbackAllowed elements.</span></span> <span data-ttu-id="42694-256">Es suficiente con confirmar que RollbackAllowed está establecido en true.</span><span class="sxs-lookup"><span data-stu-id="42694-256">It suffices to confirm that RollbackAllowed is set to true.</span></span> <span data-ttu-id="42694-257">Estos elementos solo se devuelven si estos métodos se invocan usando el encabezado de solicitud establecido en "x-ms-version: 2011-10-01" o una versión posterior.</span><span class="sxs-lookup"><span data-stu-id="42694-257">These elements are only returned if these methods are invoked by using the request header set to “x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="42694-258">Para obtener más información acerca de los encabezados de control de versiones, consulte [Control de versiones de la administración del servicio](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="42694-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="42694-259">Hay algunas situaciones en las que no se admite la reversión de una actualización, estas son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="42694-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="42694-260">Reducción de recursos locales: si la actualización aumenta los recursos locales para un rol, la plataforma Azure no permite la reversión.</span><span class="sxs-lookup"><span data-stu-id="42694-260">Reduction in local resources - If the update increases the local resources for a role the Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="42694-261">Limitaciones de cuota: si la actualización fue una operación de reducción vertical, es posible que no tenga una cuota de proceso suficiente para completar la operación de reversión.</span><span class="sxs-lookup"><span data-stu-id="42694-261">Quota limitations - If the update was a scale down operation you may no longer have sufficient compute quota to complete the rollback operation.</span></span> <span data-ttu-id="42694-262">Cada suscripción a Azure tiene una cuota asociada que especifica el número máximo de núcleos que todos los servicios hospedados que pertenecen a dicha suscripción pueden usar.</span><span class="sxs-lookup"><span data-stu-id="42694-262">Each Azure subscription has a quota associated with it that specifies the maximum number of cores which can be consumed by all hosted services that belong to that subscription.</span></span> <span data-ttu-id="42694-263">Si la reversión de una determinada actualización hace que su suscripción supere la cuota asignada, no se habilitará dicha reversión.</span><span class="sxs-lookup"><span data-stu-id="42694-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="42694-264">Condición de carrera: si se completó la actualización inicial, no es posible una reversión.</span><span class="sxs-lookup"><span data-stu-id="42694-264">Race condition - If the initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="42694-265">Un ejemplo de cuando la reversión de una actualización podría resultar útil es si está usando la operación [Actualizar implementación](https://msdn.microsoft.com/library/azure/ee460793.aspx) en el modo manual para controlar la velocidad a la que se realiza una actualización local importante en su servicio hospedado de Azure.</span><span class="sxs-lookup"><span data-stu-id="42694-265">An example of when the rollback of an update might be useful is if you are using the [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode to control the rate at which a major in-place upgrade to your Azure hosted service is rolled out.</span></span>

<span data-ttu-id="42694-266">Durante la ejecución de la actualización se llama a [Actualizar implementación](https://msdn.microsoft.com/library/azure/ee460793.aspx) en modo manual y se comienzan a recorrer los dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="42694-266">During the rollout of the upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin to walk upgrade domains.</span></span> <span data-ttu-id="42694-267">Si en algún momento, mientras supervisa la actualización, se da cuenta de que algunas instancias de rol en los primeros dominios de actualización examinados han dejado de responder, puede llamar a la operación [Actualización o reversión de la actualización](https://msdn.microsoft.com/library/azure/hh403977.aspx) en la implementación, lo que dejará intactas las instancias que aún no se hayan actualizado y revertirá las instancias que se hayan actualizado al paquete de servicio y configuración anteriores.</span><span class="sxs-lookup"><span data-stu-id="42694-267">If at some point, as you monitor the upgrade, you note some role instances in the first upgrade domains that you examine have become unresponsive, you can call the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on the deployment, which will leave untouched the instances which had not yet been upgraded and rollback instances which had been upgraded to the previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="42694-268">Iniciación de varias operaciones mutantes en una implementación en curso</span><span class="sxs-lookup"><span data-stu-id="42694-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="42694-269">En algunos casos puede que desee iniciar varias operaciones simultáneas de mutación en una implementación en curso.</span><span class="sxs-lookup"><span data-stu-id="42694-269">In some cases you may want to initiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="42694-270">Por ejemplo, puede realizar una actualización del servicio y, mientras la actualización se está distribuyendo a través de su servicio, quiere realizar algún cambio, por ejemplo, para revertir la actualización, aplicar otra actualización o incluso eliminar la implementación.</span><span class="sxs-lookup"><span data-stu-id="42694-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want to make some change, e.g. to roll the update back, apply a different update, or even delete the deployment.</span></span> <span data-ttu-id="42694-271">Un caso en el que esto podría ser necesario es si una actualización de servicio contiene código con errores que hace que una instancia de rol actualizada se bloquee repetidamente.</span><span class="sxs-lookup"><span data-stu-id="42694-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance to repeatedly crash.</span></span> <span data-ttu-id="42694-272">En este caso, el controlador de tejido de Azure no puede progresar en la aplicación de esa actualización, ya que el número de instancias en el dominio actualizado que están en buen estado es insuficiente.</span><span class="sxs-lookup"><span data-stu-id="42694-272">In this case, the Azure Fabric Controller will not be able to make progress in applying that upgrade because an insufficient number of instances in the upgraded domain are healthy.</span></span> <span data-ttu-id="42694-273">Este estado se conoce como una *implementación bloqueada*.</span><span class="sxs-lookup"><span data-stu-id="42694-273">This state is referred to as a *stuck deployment*.</span></span> <span data-ttu-id="42694-274">Puede desbloquear la implementación revirtiendo la actualización o aplicando una nueva actualización encima de la que tiene los errores.</span><span class="sxs-lookup"><span data-stu-id="42694-274">You can unstick the deployment by rolling back the update or applying a fresh update over top of the failing one.</span></span>

<span data-ttu-id="42694-275">Una vez que el controlador de tejido de Azure ha recibido la solicitud inicial para actualizar el servicio, puede iniciar las operaciones de mutación subsiguientes.</span><span class="sxs-lookup"><span data-stu-id="42694-275">Once the initial request to update or upgrade the service has been received by the Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="42694-276">Es decir, no es necesario esperar a que la operación inicial se complete antes de iniciar una operación de mutación.</span><span class="sxs-lookup"><span data-stu-id="42694-276">That is, you do not have to wait for the initial operation to complete before you can start another mutating operation.</span></span>

<span data-ttu-id="42694-277">Iniciar una segunda operación de actualización mientras se está realizando la primera actualización, funcionará de una forma similar a la operación de reversión.</span><span class="sxs-lookup"><span data-stu-id="42694-277">Initiating a second update operation while the first update is ongoing will perform similar to the rollback operation.</span></span> <span data-ttu-id="42694-278">Si la segunda actualización está en modo automático, el primer dominio de actualización se actualizará inmediatamente, lo que posiblemente ocasionará que las instancias de varios dominios de actualización estén sin conexión al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="42694-278">If the second update is in automatic mode, the first upgrade domain will be upgraded immediately, possibly leading to instances from multiple upgrade domains being offline at the same point in time.</span></span>

<span data-ttu-id="42694-279">Las operaciones de mutación son las siguientes: [Cambiar configuración de implementación](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Actualizar implementación](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Actualizar estado de la implementación](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Eliminar implementación](https://msdn.microsoft.com/library/azure/ee460815.aspx) y [Actualización o reversión de la actualización](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="42694-279">The mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="42694-280">Dos operaciones, [Obtener implementación](https://msdn.microsoft.com/library/azure/ee460804.aspx) y [Obtener propiedades de servicio en la nube](https://msdn.microsoft.com/library/azure/ee460806.aspx), devuelven la marca de bloqueado que se puede examinar para determinar si una operación de mutación se puede llamar en una implementación determinada.</span><span class="sxs-lookup"><span data-stu-id="42694-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return the Locked flag which can be examined to determine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="42694-281">Para llamar a la versión de estos métodos que devuelve la marca de bloqueado, debe establecer el encabezado de solicitud a "x-ms-version: 2011-10-01" o una versión posterior.</span><span class="sxs-lookup"><span data-stu-id="42694-281">In order to call the version of these methods which returns the Locked flag, you must set request header to “x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="42694-282">Para obtener más información acerca de los encabezados de control de versiones, consulte [Control de versiones de la administración del servicio](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="42694-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="42694-283">Distribución de roles entre dominios de actualización</span><span class="sxs-lookup"><span data-stu-id="42694-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="42694-284">Azure distribuye las instancias de un rol uniformemente en un número determinado de dominios de actualización, que pueden configurarse como parte del archivo de definición (.csdef).</span><span class="sxs-lookup"><span data-stu-id="42694-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of the service definition (.csdef) file.</span></span> <span data-ttu-id="42694-285">El número máximo de dominios de actualización es 20 y el número predeterminado 5.</span><span class="sxs-lookup"><span data-stu-id="42694-285">The max number of upgrade domains is 20 and the default is 5.</span></span> <span data-ttu-id="42694-286">Para obtener más información sobre cómo modificar el archivo de definición de servicio, consulte [Esquema de definición del servicio de Azure (archivo .csdef)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="42694-286">For more information about how to modify the service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="42694-287">Por ejemplo, si su rol tiene diez instancias, de forma predeterminada cada dominio de actualización contiene dos instancias.</span><span class="sxs-lookup"><span data-stu-id="42694-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="42694-288">Si su rol tiene 14 instancias, entonces cuatro de los dominios de actualización contienen tres instancias y un quinto dominio contiene dos.</span><span class="sxs-lookup"><span data-stu-id="42694-288">If your role has 14 instances, then four of the upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="42694-289">Los dominios de actualización se identifican con un índice basado en cero: el primer dominio de actualización tiene un identificador de 0 y el segundo un identificador de 1 y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="42694-289">Upgrade domains are identified with a zero-based index: the first upgrade domain has an ID of 0, and the second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="42694-290">El siguiente diagrama ilustra cómo se distribuyen los dos roles que contiene un servicio, cuando el servicio define dos dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="42694-290">The following diagram illustrates how a service than contains two roles are distributed when the service defines two upgrade domains.</span></span> <span data-ttu-id="42694-291">El servicio está ejecutando ocho instancias del rol web y nueve instancias del rol de trabajo.</span><span class="sxs-lookup"><span data-stu-id="42694-291">The service is running eight instances of the web role and nine instances of the worker role.</span></span>

<span data-ttu-id="42694-292">![Distribución de dominios de actualización](media/cloud-services-update-azure-service/IC345533.png "Distribución de dominios de actualización")</span><span class="sxs-lookup"><span data-stu-id="42694-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="42694-293">Tenga en cuenta que Azure controla cómo se asignan las instancias en los dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="42694-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="42694-294">No es posible especificar las instancias que se asignan a un dominio determinado.</span><span class="sxs-lookup"><span data-stu-id="42694-294">It's not possible to specify which instances are allocated to which domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="42694-295">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="42694-295">Next steps</span></span>
[<span data-ttu-id="42694-296">Administración de Cloud Services</span><span class="sxs-lookup"><span data-stu-id="42694-296">How to Manage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="42694-297">Supervisión de Cloud Services</span><span class="sxs-lookup"><span data-stu-id="42694-297">How to Monitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="42694-298">Configuración de Cloud Services</span><span class="sxs-lookup"><span data-stu-id="42694-298">How to Configure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
