---
title: "Error de asignación de servicio en la nube aaaTroubleshooting | Documentos de Microsoft"
description: "Solución de errores de asignación al implementar Servicios en la nube de Azure"
services: azure-service-management, cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 529157eb-e4a1-4388-aa2b-09e8b923af74
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: dfd5cc4663ccc6ed1b27ca9df579182737363b0e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-allocation-failure-when-you-deploy-cloud-services-in-azure"></a><span data-ttu-id="04fdc-103">Solución de errores de asignación al implementar Servicios en la nube de Azure</span><span class="sxs-lookup"><span data-stu-id="04fdc-103">Troubleshooting allocation failure when you deploy Cloud Services in Azure</span></span>
## <a name="summary"></a><span data-ttu-id="04fdc-104">Resumen</span><span class="sxs-lookup"><span data-stu-id="04fdc-104">Summary</span></span>
<span data-ttu-id="04fdc-105">Al implementar instancias tooa servicio en la nube o agregar nuevo sitio web o instancias de rol de trabajo, Windows Azure asigna recursos de proceso.</span><span class="sxs-lookup"><span data-stu-id="04fdc-105">When you deploy instances tooa Cloud Service or add new web or worker role instances, Microsoft Azure allocates compute resources.</span></span> <span data-ttu-id="04fdc-106">En ocasiones, puede recibir errores al realizar estas operaciones, incluso antes de llegar a los límites de suscripción de Azure Hola.</span><span class="sxs-lookup"><span data-stu-id="04fdc-106">You may occasionally receive errors when performing these operations even before you reach hello Azure subscription limits.</span></span> <span data-ttu-id="04fdc-107">Este artículo explica causas Hola de algunos de los errores de asignación comunes de Hola y sugiere posibles correcciones.</span><span class="sxs-lookup"><span data-stu-id="04fdc-107">This article explains hello causes of some of hello common allocation failures and suggests possible remediation.</span></span> <span data-ttu-id="04fdc-108">información de Hello también puede resultarle útil cuando planee la implementación de Hola de sus servicios.</span><span class="sxs-lookup"><span data-stu-id="04fdc-108">hello information may also be useful when you plan hello deployment of your services.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

### <a name="background--how-allocation-works"></a><span data-ttu-id="04fdc-109">Información de contexto: cómo funciona la asignación</span><span class="sxs-lookup"><span data-stu-id="04fdc-109">Background – How allocation works</span></span>
<span data-ttu-id="04fdc-110">servidores de Hello en centros de datos de Azure se dividen en clústeres.</span><span class="sxs-lookup"><span data-stu-id="04fdc-110">hello servers in Azure datacenters are partitioned into clusters.</span></span> <span data-ttu-id="04fdc-111">Se intenta una nueva solicitud de asignación de servicio en la nube en varios clústeres.</span><span class="sxs-lookup"><span data-stu-id="04fdc-111">A new cloud service allocation request is attempted in multiple clusters.</span></span> <span data-ttu-id="04fdc-112">Cuando primera instancia de hello es servicio de nube de implementada tooa (en almacenamiento provisional o producción), que el servicio de nube obtiene clúster tooa anclados.</span><span class="sxs-lookup"><span data-stu-id="04fdc-112">When hello first instance is deployed tooa cloud service(in either staging or production), that cloud service gets pinned tooa cluster.</span></span> <span data-ttu-id="04fdc-113">Ningún otro implementaciones para servicio de nube de hello tendrá lugar en hello mismo clúster.</span><span class="sxs-lookup"><span data-stu-id="04fdc-113">Any further deployments for hello cloud service will happen in hello same cluster.</span></span> <span data-ttu-id="04fdc-114">En este artículo, nos referiremos toothis como "anclado tooa clúster".</span><span class="sxs-lookup"><span data-stu-id="04fdc-114">In this article, we'll refer toothis as "pinned tooa cluster".</span></span> <span data-ttu-id="04fdc-115">Diagrama 1 a continuación ilustra el caso de hello de una asignación normal que se intenta en varios clústeres; Diagrama 2 ilustra caso de hello de una asignación que tooCluster anclado 2 ya que es donde Hola CS_1 de servicio de nube existente se hospeda.</span><span class="sxs-lookup"><span data-stu-id="04fdc-115">Diagram 1 below illustrates hello case of a normal allocation which is attempted in multiple clusters; Diagram 2 illustrates hello case of an allocation that's pinned tooCluster 2 because that's where hello existing Cloud Service CS_1 is hosted.</span></span>

![Diagrama de asignación](./media/cloud-services-allocation-failure/Allocation1.png)

### <a name="why-allocation-failure-happens"></a><span data-ttu-id="04fdc-117">¿Por qué se producen errores de asignación?</span><span class="sxs-lookup"><span data-stu-id="04fdc-117">Why allocation failure happens</span></span>
<span data-ttu-id="04fdc-118">Cuando una solicitud de asignación está anclado tooa clúster, hay una mayor probabilidad de errores toofind liberar recursos como grupo de recursos disponibles de hello es clúster tooa limitado.</span><span class="sxs-lookup"><span data-stu-id="04fdc-118">When an allocation request is pinned tooa cluster, there's a higher chance of failing toofind free resources since hello available resource pool is limited tooa cluster.</span></span> <span data-ttu-id="04fdc-119">Además, si su solicitud de asignación está anclado tooa clúster pero tipo hello de recurso solicitado no es compatible con dicho clúster, se producirá un error en la solicitud incluso si el clúster de hello tiene recurso gratuito.</span><span class="sxs-lookup"><span data-stu-id="04fdc-119">Furthermore, if your allocation request is pinned tooa cluster but hello type of resource you requested is not supported by that cluster, your request will fail even if hello cluster has free resource.</span></span> <span data-ttu-id="04fdc-120">Diagrama 3 a continuación ilustra el caso en Hola donde una asignación anclada produce un error porque Hola candidato solo clúster no tiene recursos libres.</span><span class="sxs-lookup"><span data-stu-id="04fdc-120">Diagram 3 below illustrates hello case where a pinned allocation fails because hello only candidate cluster does not have free resources.</span></span> <span data-ttu-id="04fdc-121">Diagrama 4 muestra caso Hola donde una asignación anclada produce un error porque no es compatible con clúster candidato solo de Hola Hola solicitado tamaño de máquina virtual, aunque el clúster de hello tiene liberar recursos.</span><span class="sxs-lookup"><span data-stu-id="04fdc-121">Diagram 4 illustrates hello case where a pinned allocation fails because hello only candidate cluster does not support hello requested VM size, even though hello cluster has free resources.</span></span>

![Error de asignaciones ancladas](./media/cloud-services-allocation-failure/Allocation2.png)

## <a name="troubleshooting-allocation-failure-for-cloud-services"></a><span data-ttu-id="04fdc-123">Solución de errores de asignación para servicios en la nube</span><span class="sxs-lookup"><span data-stu-id="04fdc-123">Troubleshooting allocation failure for cloud services</span></span>
### <a name="error-message"></a><span data-ttu-id="04fdc-124">Mensaje de error</span><span class="sxs-lookup"><span data-stu-id="04fdc-124">Error Message</span></span>
<span data-ttu-id="04fdc-125">Puede ver Hola mensaje de error siguiente:</span><span class="sxs-lookup"><span data-stu-id="04fdc-125">You may see hello following error message:</span></span>

    "Azure operation '{operation id}' failed with code Compute.ConstrainedAllocationFailed. Details: Allocation failed; unable toosatisfy constraints in request. hello requested new service deployment is bound tooan Affinity Group, or it targets a Virtual Network, or there is an existing deployment under this hosted service. Any of these conditions constrains hello new deployment toospecific Azure resources. Please retry later or try reducing hello VM size or number of role instances. Alternatively, if possible, remove hello aforementioned constraints or try deploying tooa different region."

### <a name="common-issues"></a><span data-ttu-id="04fdc-126">Problemas comunes</span><span class="sxs-lookup"><span data-stu-id="04fdc-126">Common Issues</span></span>
<span data-ttu-id="04fdc-127">Presentamos Hola comunes asignación los escenarios que provocan un asignación solicitud toobe tooa anclados solo clúster.</span><span class="sxs-lookup"><span data-stu-id="04fdc-127">Here are hello common allocation scenarios that cause an allocation request toobe pinned tooa single cluster.</span></span>

* <span data-ttu-id="04fdc-128">A continuación, implementar tooStaging ranura: si un servicio de nube tiene una implementación en cualquier ranura, servicio de nube todo de Hola y está anclado tooa específico del clúster.</span><span class="sxs-lookup"><span data-stu-id="04fdc-128">Deploying tooStaging Slot - If a cloud service has a deployment in either slot, then hello entire cloud service is pinned tooa specific cluster.</span></span>  <span data-ttu-id="04fdc-129">Esto significa que si una implementación ya existe en la ranura de producción de hello, a continuación, una nueva implementación de ensayo se solo pueden asignar en el mismo clúster según la zona de producción de hello de Hola.</span><span class="sxs-lookup"><span data-stu-id="04fdc-129">This means that if a deployment already exists in hello production slot, then a new staging deployment can only be allocated in hello same cluster as hello production slot.</span></span> <span data-ttu-id="04fdc-130">Si el clúster de hello está cerca de su capacidad, puede producir un error en la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="04fdc-130">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="04fdc-131">Ajuste de escala: agregar nuevas instancias tooan servicio en la nube debe asignar Hola mismo clúster.</span><span class="sxs-lookup"><span data-stu-id="04fdc-131">Scaling - Adding new instances tooan existing cloud service must allocate in hello same cluster.</span></span>  <span data-ttu-id="04fdc-132">Normalmente, las solicitudes de escalado pequeño se pueden asignar, pero no siempre.</span><span class="sxs-lookup"><span data-stu-id="04fdc-132">Small scaling requests can usually be allocated, but not always.</span></span> <span data-ttu-id="04fdc-133">Si el clúster de hello está cerca de su capacidad, puede producir un error en la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="04fdc-133">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="04fdc-134">Grupo de afinidad: un nuevo servicio de nube vacía de tooan de implementación se puede asignar por tejido de Hola en cualquier clúster en dicha región, a menos que el servicio de nube de hello está anclado tooan grupo de afinidad.</span><span class="sxs-lookup"><span data-stu-id="04fdc-134">Affinity Group - A new deployment tooan empty cloud service can be allocated by hello fabric in any cluster in that region, unless hello cloud service is pinned tooan affinity group.</span></span> <span data-ttu-id="04fdc-135">Toohello de las implementaciones se tratará el mismo grupo de afinidad en hello mismo clúster.</span><span class="sxs-lookup"><span data-stu-id="04fdc-135">Deployments toohello same affinity group will be attempted on hello same cluster.</span></span> <span data-ttu-id="04fdc-136">Si el clúster de hello está cerca de su capacidad, puede producir un error en la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="04fdc-136">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="04fdc-137">Red virtual del grupo de afinidad - redes virtuales anteriores estaban relacionados tooaffinity grupos en lugar de las regiones y servicios en la nube en estas redes virtuales sería clúster del grupo de afinidad toohello anclados.</span><span class="sxs-lookup"><span data-stu-id="04fdc-137">Affinity Group vNet - Older Virtual Networks were tied tooaffinity groups instead of regions, and cloud services in these Virtual Networks would be pinned toohello affinity group cluster.</span></span> <span data-ttu-id="04fdc-138">Tipo de toothis de las implementaciones de red virtual se tratará en clúster de hello anclado.</span><span class="sxs-lookup"><span data-stu-id="04fdc-138">Deployments toothis type of virtual network will be attempted on hello pinned cluster.</span></span> <span data-ttu-id="04fdc-139">Si el clúster de hello está cerca de su capacidad, puede producir un error en la solicitud de saludo.</span><span class="sxs-lookup"><span data-stu-id="04fdc-139">If hello cluster is nearing capacity, hello request may fail.</span></span>

## <a name="solutions"></a><span data-ttu-id="04fdc-140">Soluciones</span><span class="sxs-lookup"><span data-stu-id="04fdc-140">Solutions</span></span>
1. <span data-ttu-id="04fdc-141">Volver a implementar tooa nuevo servicio de nube - esta solución es probable toobe más correcta, ya que permite Hola plataforma toochoose de todos los clústeres en dicha región.</span><span class="sxs-lookup"><span data-stu-id="04fdc-141">Redeploy tooa new cloud service - This solution is likely toobe most successful as it allows hello platform toochoose from all clusters in that region.</span></span>

   * <span data-ttu-id="04fdc-142">Implementar cargas de trabajo hello tooa nuevo servicio de nube</span><span class="sxs-lookup"><span data-stu-id="04fdc-142">Deploy hello workload tooa new cloud service</span></span>  
   * <span data-ttu-id="04fdc-143">Actualizar Hola CNAME o un registro toopoint tráfico toohello nuevo servicio en la nube</span><span class="sxs-lookup"><span data-stu-id="04fdc-143">Update hello CNAME or A record toopoint traffic toohello new cloud service</span></span>
   * <span data-ttu-id="04fdc-144">Una vez cero tráfico va toohello del sitio antiguo, puede eliminar servicio en la nube antiguo Hola.</span><span class="sxs-lookup"><span data-stu-id="04fdc-144">Once zero traffic is going toohello old site, you can delete hello old cloud service.</span></span> <span data-ttu-id="04fdc-145">Esta solución debe incurrir en tiempo de inactividad cero.</span><span class="sxs-lookup"><span data-stu-id="04fdc-145">This solution should incur zero downtime.</span></span>
2. <span data-ttu-id="04fdc-146">Eliminar la producción y las ranuras de almacenamiento provisional: esta solución, conservará el nombre DNS existente, pero hará que la aplicación de tooyour de tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="04fdc-146">Delete both production and staging slots - This solution will preserve your existing DNS name, but will cause downtime tooyour application.</span></span>

   * <span data-ttu-id="04fdc-147">Eliminar de producción de hello y ensayo ranuras de un servicio de nube existente para que el servicio en la nube Hola está vacía y, a continuación,</span><span class="sxs-lookup"><span data-stu-id="04fdc-147">Delete hello production and staging slots of an existing cloud service so that hello cloud service is empty, and then</span></span>
   * <span data-ttu-id="04fdc-148">Cree una nueva implementación Hola existente del servicio en nube.</span><span class="sxs-lookup"><span data-stu-id="04fdc-148">Create a new deployment in hello existing cloud service.</span></span> <span data-ttu-id="04fdc-149">Esto intentará volver a tooallocation en todos los clústeres en la región de Hola.</span><span class="sxs-lookup"><span data-stu-id="04fdc-149">This will re-attempt tooallocation on all clusters in hello region.</span></span> <span data-ttu-id="04fdc-150">Asegúrese de servicio de nube de hello no está ligada tooan grupo de afinidad.</span><span class="sxs-lookup"><span data-stu-id="04fdc-150">Ensure hello cloud service is not tied tooan affinity group.</span></span>
3. <span data-ttu-id="04fdc-151">Dirección IP reservada - esta solución, conservará la IP existentes de direcciones, pero hará que la aplicación de tooyour de tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="04fdc-151">Reserved IP -  This solution will preserve your existing IP address, but will cause downtime tooyour application.</span></span>  

   * <span data-ttu-id="04fdc-152">Crear una dirección IP reservada para la implementación mediante Powershell.</span><span class="sxs-lookup"><span data-stu-id="04fdc-152">Create a ReservedIP for your existing deployment using Powershell</span></span>

     ```
     New-AzureReservedIP -ReservedIPName {new reserved IP name} -Location {location} -ServiceName {existing service name}
     ```
   * <span data-ttu-id="04fdc-153">Siga #2 desde encima, realizar toospecify seguro Hola nueva dirección IP reservada en CSCFG del servicio de hello.</span><span class="sxs-lookup"><span data-stu-id="04fdc-153">Follow #2 from above, making sure toospecify hello new ReservedIP in hello service's CSCFG.</span></span>
4. <span data-ttu-id="04fdc-154">Quitar el grupo de afinidad para nuevas implementaciones - Ya no se recomienda utilizar grupos de afinidad.</span><span class="sxs-lookup"><span data-stu-id="04fdc-154">Remove affinity group for new deployments - Affinity Groups are no longer recommended.</span></span> <span data-ttu-id="04fdc-155">Siga los pasos para #1 anteriormente toodeploy un nuevo servicio de nube.</span><span class="sxs-lookup"><span data-stu-id="04fdc-155">Follow steps for #1 above toodeploy a new cloud service.</span></span> <span data-ttu-id="04fdc-156">Asegúrese de que el servicio en la nube no se encuentra en un grupo de afinidad.</span><span class="sxs-lookup"><span data-stu-id="04fdc-156">Ensure cloud service is not in an affinity group.</span></span>
5. <span data-ttu-id="04fdc-157">Convertir tooa red Virtual Regional - vea [cómo toomigrate de grupos de afinidad tooa (VNet) de red Virtual Regional](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="04fdc-157">Convert tooa Regional Virtual Network - See [How toomigrate from Affinity Groups tooa Regional Virtual Network (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
