---
title: "Hola aaaConfigure extensión de NPS de MFA de Azure | Documentos de Microsoft"
description: "Después de instalar la extensión NPS hello, siga estos pasos para la configuración avanzada como la creación de listas blancas IP y el reemplazo de UPN."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="a10d2-103">Configuración las opciones avanzadas para hello extensión NPS para la autenticación multifactor</span><span class="sxs-lookup"><span data-stu-id="a10d2-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="a10d2-104">Hola extensión de servidor de directivas de redes (NPS) amplía las características de la autenticación multifactor Azure basada en la nube a la infraestructura local.</span><span class="sxs-lookup"><span data-stu-id="a10d2-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="a10d2-105">En este artículo se da por supuesto que ya tienen la extensión de hello instalado y ahora desea tooknow cómo debe extensión de hello toocustomize para usted.</span><span class="sxs-lookup"><span data-stu-id="a10d2-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="a10d2-106">Identificador de inicio de sesión alternativo</span><span class="sxs-lookup"><span data-stu-id="a10d2-106">Alternate login ID</span></span>

<span data-ttu-id="a10d2-107">Puesto que Hola extensión NPS conecta tooboth su en la nube local y directorios, puede producirse un problema donde los nombres de entidad de seguridad de usuario (UPN) local no coinciden con los nombres de hello en la nube de Hola.</span><span class="sxs-lookup"><span data-stu-id="a10d2-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="a10d2-108">toosolve este problema, el inicio de sesión use alternativo identificadores.</span><span class="sxs-lookup"><span data-stu-id="a10d2-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="a10d2-109">Dentro de hello extensión NPS, puede designar un toobe de atributo de Active Directory usado en lugar de hello UPN para la autenticación multifactor Azure.</span><span class="sxs-lookup"><span data-stu-id="a10d2-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="a10d2-110">Esto permite tooprotect sus recursos locales con la verificacion sin modificar los UPN local.</span><span class="sxs-lookup"><span data-stu-id="a10d2-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="a10d2-111">inicio de sesión tooconfigure alternativo identificadores, vaya demasiado`HKLM\SOFTWARE\Microsoft\AzureMfa` y editar los siguientes valores del registro de hello:</span><span class="sxs-lookup"><span data-stu-id="a10d2-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="a10d2-112">Nombre</span><span class="sxs-lookup"><span data-stu-id="a10d2-112">Name</span></span> | <span data-ttu-id="a10d2-113">Escriba</span><span class="sxs-lookup"><span data-stu-id="a10d2-113">Type</span></span> | <span data-ttu-id="a10d2-114">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="a10d2-114">Default value</span></span> | <span data-ttu-id="a10d2-115">Descripción</span><span class="sxs-lookup"><span data-stu-id="a10d2-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="a10d2-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="a10d2-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="a10d2-117">cadena</span><span class="sxs-lookup"><span data-stu-id="a10d2-117">string</span></span> | <span data-ttu-id="a10d2-118">Vacío</span><span class="sxs-lookup"><span data-stu-id="a10d2-118">Empty</span></span> | <span data-ttu-id="a10d2-119">Designar Hola nombre del atributo de Active Directory que desea que toouse en lugar de hello UPN.</span><span class="sxs-lookup"><span data-stu-id="a10d2-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="a10d2-120">Este atributo se utiliza como atributo de AlternateLoginId Hola.</span><span class="sxs-lookup"><span data-stu-id="a10d2-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="a10d2-121">Si este valor del registro se establece tooa [atributo de Active Directory válido](https://msdn.microsoft.com/library/ms675090.aspx) (por ejemplo, correo electrónico o displayName), a continuación, valor del atributo de Hola se utiliza en lugar UPN del usuario de hello para la autenticación.</span><span class="sxs-lookup"><span data-stu-id="a10d2-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="a10d2-122">Si este valor del registro está vacío o no configurado, a continuación, se deshabilita AlternateLoginId y UPN del usuario de Hola se utiliza para la autenticación.</span><span class="sxs-lookup"><span data-stu-id="a10d2-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="a10d2-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="a10d2-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="a10d2-124">boolean</span><span class="sxs-lookup"><span data-stu-id="a10d2-124">boolean</span></span> | <span data-ttu-id="a10d2-125">False</span><span class="sxs-lookup"><span data-stu-id="a10d2-125">False</span></span> | <span data-ttu-id="a10d2-126">Utilice esta marca tooforce Hola de catálogo Global para búsquedas LDAP al buscar AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="a10d2-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="a10d2-127">Configurar un controlador de dominio como catálogo Global, agregue hello AlternateLoginId atributo toohello catálogo Global y, a continuación, habilite esta marca.</span><span class="sxs-lookup"><span data-stu-id="a10d2-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="a10d2-128">Si se ha configurado (no vacíos), LDAP_LOOKUP_FORESTS **esta marca se aplica como true**, independientemente del valor de Hola de configuración del registro de hello.</span><span class="sxs-lookup"><span data-stu-id="a10d2-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="a10d2-129">En este caso, Hola extensión NPS requiere hello toobe de catálogo Global configurado con hello AlternateLoginId atributo para cada bosque.</span><span class="sxs-lookup"><span data-stu-id="a10d2-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="a10d2-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="a10d2-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="a10d2-131">cadena</span><span class="sxs-lookup"><span data-stu-id="a10d2-131">string</span></span> | <span data-ttu-id="a10d2-132">Vacío</span><span class="sxs-lookup"><span data-stu-id="a10d2-132">Empty</span></span> | <span data-ttu-id="a10d2-133">Proporcionar una lista separada por punto y coma de toosearch de bosques.</span><span class="sxs-lookup"><span data-stu-id="a10d2-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="a10d2-134">Por ejemplo, *contoso.com;foobar.com*. Si se configura este valor del registro, Hola extensión NPS busca iterativa todos los bosques de hello en el orden de hello en el que se muestran y devuelve el primer valor correcta AlternateLoginId Hola.</span><span class="sxs-lookup"><span data-stu-id="a10d2-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="a10d2-135">Si este valor del registro no está configurada, búsqueda de hello AlternateLoginId es toohello reducidos actual.</span><span class="sxs-lookup"><span data-stu-id="a10d2-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="a10d2-136">problemas de tootroubleshoot con inicio de sesión alternativo identificadores, use Hola pasos recomendado para [alternativas errores de Id. de inicio de sesión](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="a10d2-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="a10d2-137">Excepciones de dirección IP</span><span class="sxs-lookup"><span data-stu-id="a10d2-137">IP exceptions</span></span>

<span data-ttu-id="a10d2-138">Si necesita toomonitor disponibilidad del servidor, como si los equilibradores de carga compruebe qué servidores se ejecutan antes de enviar las cargas de trabajo, no desea que estos toobe comprobaciones bloqueando las solicitudes de comprobación.</span><span class="sxs-lookup"><span data-stu-id="a10d2-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="a10d2-139">En su lugar, cree una lista de direcciones IP que sepa que las cuentas de servicio las utilizan y deshabilite los requisitos de Multi-Factor Authentication en esa lista.</span><span class="sxs-lookup"><span data-stu-id="a10d2-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="a10d2-140">tooconfigure una lista blanca de direcciones IP, vaya demasiado`HKLM\SOFTWARE\Microsoft\AzureMfa` y configurar Hola siguiente valor del registro:</span><span class="sxs-lookup"><span data-stu-id="a10d2-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="a10d2-141">Nombre</span><span class="sxs-lookup"><span data-stu-id="a10d2-141">Name</span></span> | <span data-ttu-id="a10d2-142">Escriba</span><span class="sxs-lookup"><span data-stu-id="a10d2-142">Type</span></span> | <span data-ttu-id="a10d2-143">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="a10d2-143">Default value</span></span> | <span data-ttu-id="a10d2-144">Descripción</span><span class="sxs-lookup"><span data-stu-id="a10d2-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="a10d2-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="a10d2-145">IP_WHITELIST</span></span> | <span data-ttu-id="a10d2-146">cadena</span><span class="sxs-lookup"><span data-stu-id="a10d2-146">string</span></span> | <span data-ttu-id="a10d2-147">Vacío</span><span class="sxs-lookup"><span data-stu-id="a10d2-147">Empty</span></span> | <span data-ttu-id="a10d2-148">Proporcione una lista separada por puntos y coma de direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="a10d2-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="a10d2-149">Incluir las direcciones IP de los equipos donde se originan las solicitudes de servicio, como Hola servidor NAS/VPN Hola.</span><span class="sxs-lookup"><span data-stu-id="a10d2-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="a10d2-150">Los intervalos de direcciones IP y las subredes no se admiten.</span><span class="sxs-lookup"><span data-stu-id="a10d2-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="a10d2-151">Por ejemplo, *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="a10d2-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="a10d2-152">Cuando llega una solicitud de una dirección IP que existe en la lista blanca de hello, se omite la verificación en dos pasos.</span><span class="sxs-lookup"><span data-stu-id="a10d2-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="a10d2-153">Hola lista aprobada de IP es comparados toohello dirección IP que se proporciona en hello *ratNASIPAddress* atributos de solicitud RADIUS Hola.</span><span class="sxs-lookup"><span data-stu-id="a10d2-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="a10d2-154">Si llega una solicitud RADIUS sin atributo ratNASIPAddress de hello, se registra Hola siguiente advertencia: "Lista blanca de direcciones P_WHITE_LIST_WARNING::IP se ha omitido porque falta en la solicitud RADIUS en el atributo NasIpAddress la dirección IP de origen."</span><span class="sxs-lookup"><span data-stu-id="a10d2-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="a10d2-155">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="a10d2-155">Next steps</span></span>

[<span data-ttu-id="a10d2-156">Resolver mensajes de error de hello extensión NPS para la autenticación multifactor de Azure</span><span class="sxs-lookup"><span data-stu-id="a10d2-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
