---
title: "Configuración de la agrupación en clústeres de Redis para una Azure Redis Cache Premium | Microsoft Docs"
description: "Obtener información sobre cómo crear y administrar la agrupación en clústeres de para sus instancias de Caché en Redis de Azure de nivel Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 62208eec-52ae-4713-b077-62659fd844ab
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 07/05/2017
ms.author: sdanie
ms.openlocfilehash: 86a4a605dbb3b11924c14ff42238009742f72898
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-configure-redis-clustering-for-a-premium-azure-redis-cache"></a><span data-ttu-id="ac714-103">Cómo configurar la agrupación en clústeres de Redis para una Caché en Redis de Azure Premium</span><span class="sxs-lookup"><span data-stu-id="ac714-103">How to configure Redis clustering for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="ac714-104">Azure Redis Cache tiene diferentes ofertas de caché que proporcionan flexibilidad en la elección del tamaño y las características de la caché, incluidas las características de nivel premium como la agrupación en clústeres, la persistencia y la compatibilidad de red virtual.</span><span class="sxs-lookup"><span data-stu-id="ac714-104">Azure Redis Cache has different cache offerings, which provide flexibility in the choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="ac714-105">En este artículo se describe cómo configurar la agrupación en clústeres en una instancia de Caché en Redis de Azure premium.</span><span class="sxs-lookup"><span data-stu-id="ac714-105">This article describes how to configure clustering in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="ac714-106">Para obtener información sobre otras características de caché Premium, consulte [Introducción al nivel Premium de Azure Redis Cache](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="ac714-106">For information on other premium cache features, see [Introduction to the Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-redis-cluster"></a><span data-ttu-id="ac714-107">¿Qué es Clúster Redis?</span><span class="sxs-lookup"><span data-stu-id="ac714-107">What is Redis Cluster?</span></span>
<span data-ttu-id="ac714-108">Caché en Redis de Azure ofrece clúster de Redis como [implementado en Redis](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="ac714-108">Azure Redis Cache offers Redis cluster as [implemented in Redis](http://redis.io/topics/cluster-tutorial).</span></span> <span data-ttu-id="ac714-109">Con el Clúster de Redis, obtendrá las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="ac714-109">With Redis Cluster, you get the following benefits:</span></span> 

* <span data-ttu-id="ac714-110">La capacidad de dividir automáticamente el conjunto de datos entre varios nodos.</span><span class="sxs-lookup"><span data-stu-id="ac714-110">The ability to automatically split your dataset among multiple nodes.</span></span> 
* <span data-ttu-id="ac714-111">La capacidad de continuar las operaciones cuando un subconjunto de los nodos está teniendo errores o no se puede comunicar con el resto del clúster.</span><span class="sxs-lookup"><span data-stu-id="ac714-111">The ability to continue operations when a subset of the nodes is experiencing failures or are unable to communicate with the rest of the cluster.</span></span> 
* <span data-ttu-id="ac714-112">Mayor rendimiento: el rendimiento aumenta de manera lineal a medida que aumenta el número de particiones.</span><span class="sxs-lookup"><span data-stu-id="ac714-112">More throughput: Throughput increases linearly as you increase the number of shards.</span></span> 
* <span data-ttu-id="ac714-113">Mayor tamaño de memoria: aumenta de manera lineal a medida que aumenta el número de particiones.</span><span class="sxs-lookup"><span data-stu-id="ac714-113">More memory size: Increases linearly as you increase the number of shards.</span></span>  

<span data-ttu-id="ac714-114">Para obtener información sobre el tamaño, el rendimiento y el ancho de banda con memorias caché premium, vea [¿Qué oferta y tamaño de Caché en Redis debo utilizar?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)</span><span class="sxs-lookup"><span data-stu-id="ac714-114">For more information about size, throughput, and bandwidth with premium caches, see [What Redis Cache offering and size should I use?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)</span></span>

<span data-ttu-id="ac714-115">En Azure, el clúster de Redis se ofrece como un modelo de principal/réplica donde cada partición tiene un par de principal/réplica con la replicación donde la replicación se administra mediante el servicio de la Caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="ac714-115">In Azure, Redis cluster is offered as a primary/replica model where each shard has a primary/replica pair with replication where the replication is managed by Azure Redis Cache service.</span></span> 

## <a name="clustering"></a><span data-ttu-id="ac714-116">Agrupación en clústeres</span><span class="sxs-lookup"><span data-stu-id="ac714-116">Clustering</span></span>
<span data-ttu-id="ac714-117">La agrupación en clústeres se habilita en la hoja **Nueva caché en Redis** durante la creación de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="ac714-117">Clustering is enabled on the **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="ac714-118">La agrupación en clústeres se configura en la hoja **Clúster de Redis** .</span><span class="sxs-lookup"><span data-stu-id="ac714-118">Clustering is configured on the **Redis Cluster** blade.</span></span>

![Agrupación en clústeres][redis-cache-clustering]

<span data-ttu-id="ac714-120">Puede tener hasta 10 particiones en el clúster.</span><span class="sxs-lookup"><span data-stu-id="ac714-120">You can have up to 10 shards in the cluster.</span></span> <span data-ttu-id="ac714-121">Haga clic en **Habilitado** y deslice el control deslizante o escriba un número comprendido entre 1 y 10 para **Número de particiones** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="ac714-121">Click **Enabled** and slide the slider or type a number between 1 and 10 for **Shard count** and click **OK**.</span></span>

<span data-ttu-id="ac714-122">Cada partición es un par de caché principal/réplica administrado por Azure y el tamaño total de la memoria caché se calcula multiplicando el número de particiones por el tamaño de la memoria caché seleccionado en el plan de tarifa.</span><span class="sxs-lookup"><span data-stu-id="ac714-122">Each shard is a primary/replica cache pair managed by Azure, and the total size of the cache is calculated by multiplying the number of shards by the cache size selected in the pricing tier.</span></span> 

![agrupación en clústeres][redis-cache-clustering-selected]

<span data-ttu-id="ac714-124">Cuando se haya creado la memoria caché, conéctese a ella y úsela simplemente como una memoria caché no agrupada y Redis distribuirá los datos a través de las particiones de memoria caché.</span><span class="sxs-lookup"><span data-stu-id="ac714-124">Once the cache is created you connect to it and use it just like a non-clustered cache, and Redis distributes the data throughout the Cache shards.</span></span> <span data-ttu-id="ac714-125">Si el diagnóstico está [habilitado](cache-how-to-monitor.md#enable-cache-diagnostics), las métricas se capturan por separado para cada partición y pueden [verse](cache-how-to-monitor.md) en la hoja Caché en Redis.</span><span class="sxs-lookup"><span data-stu-id="ac714-125">If diagnostics is [enabled](cache-how-to-monitor.md#enable-cache-diagnostics), metrics are captured separately for each shard and can be [viewed](cache-how-to-monitor.md) in the Redis Cache blade.</span></span> 

> [!NOTE]
> 
> <span data-ttu-id="ac714-126">Hay algunas diferencias menores necesarias en la aplicación cliente cuando se configura la agrupación en clústeres.</span><span class="sxs-lookup"><span data-stu-id="ac714-126">There are some minor differences required in your client application when clustering is configured.</span></span> <span data-ttu-id="ac714-127">Para más información, consulte [Configuración de Caché en Redis de Azure](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)</span><span class="sxs-lookup"><span data-stu-id="ac714-127">For more information, see [Do I need to make any changes to my client application to use clustering?](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)</span></span>
> 
> 

<span data-ttu-id="ac714-128">Para obtener el código de ejemplo sobre el trabajo con clústeres con el cliente StackExchange.Redis, consulte la parte [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) del ejemplo [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld).</span><span class="sxs-lookup"><span data-stu-id="ac714-128">For sample code on working with clustering with the StackExchange.Redis client, see the [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) portion of the [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) sample.</span></span>

<a name="cluster-size"></a>

## <a name="change-the-cluster-size-on-a-running-premium-cache"></a><span data-ttu-id="ac714-129">Cambio del tamaño del clúster en una caché premium en ejecución</span><span class="sxs-lookup"><span data-stu-id="ac714-129">Change the cluster size on a running premium cache</span></span>
<span data-ttu-id="ac714-130">Para cambiar el tamaño del clúster de una caché premium en ejecución con la agrupación en clústeres habilitada, haga clic en **Tamaño del clúster en Redis** desde el **menú Recursos**.</span><span class="sxs-lookup"><span data-stu-id="ac714-130">To change the cluster size on a running premium cache with clustering enabled, click **Redis Cluster Size** from the **Resource menu**.</span></span>

> [!NOTE]
> <span data-ttu-id="ac714-131">A pesar de que el nivel Premium de Azure Redis Cache Premium se publicó con disponibilidad general, la característica Tamaño del clúster en Redis está actualmente en la versión preliminar.</span><span class="sxs-lookup"><span data-stu-id="ac714-131">While the Azure Redis Cache Premium tier has been released to General Availability, the Redis Cluster Size feature is currently in preview.</span></span>
> 
> 

![Tamaño del Clúster en Redis][redis-cache-redis-cluster-size]

<span data-ttu-id="ac714-133">Para modificar el tamaño del clúster, utilice el control deslizante o especifique un número comprendido entre 1 y 10 en el cuadro de texto **Número de particiones**. Después, haga clic en **Aceptar** para guardar.</span><span class="sxs-lookup"><span data-stu-id="ac714-133">To change the cluster size, use the slider or type a number between 1 and 10 in the **Shard count** text box and click **OK** to save.</span></span>

> [!NOTE]
> <span data-ttu-id="ac714-134">El escalado de un clúster ejecuta el comando [MIGRATE](https://redis.io/commands/migrate), que es un comando caro. Por lo tanto, para un impacto mínimo, considere ejecutar esta operación durante horas de poca actividad.</span><span class="sxs-lookup"><span data-stu-id="ac714-134">Scaling a cluster runs the [MIGRATE](https://redis.io/commands/migrate) command, which is an expensive command, so for minimal impact, consider running this operation during non-peak hours.</span></span> <span data-ttu-id="ac714-135">Durante el proceso de migración, verá un pico de carga del servidor.</span><span class="sxs-lookup"><span data-stu-id="ac714-135">During the migration process, you will see a spike in server load.</span></span> <span data-ttu-id="ac714-136">El escalado de un clúster es un proceso de ejecución duradero y la cantidad de tiempo transcurrido depende del número de claves y el tamaño de los valores asociados a estas claves.</span><span class="sxs-lookup"><span data-stu-id="ac714-136">Scaling a cluster is a long running process and the amount of time taken depends on the number of keys and size of the values associated with those keys.</span></span>
> 
> 

## <a name="clustering-faq"></a><span data-ttu-id="ac714-137">P+F de agrupación en clústeres</span><span class="sxs-lookup"><span data-stu-id="ac714-137">Clustering FAQ</span></span>
<span data-ttu-id="ac714-138">La lista siguiente contiene las respuestas a las preguntas más frecuentes sobre la agrupación en clústeres de Caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="ac714-138">The following list contains answers to commonly asked questions about Azure Redis Cache clustering.</span></span>

* [<span data-ttu-id="ac714-139">¿Es necesario realizar algún cambio en mi aplicación cliente para usar la agrupación en clústeres?</span><span class="sxs-lookup"><span data-stu-id="ac714-139">Do I need to make any changes to my client application to use clustering?</span></span>](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)
* [<span data-ttu-id="ac714-140">¿Cómo se distribuyen las claves en un clúster?</span><span class="sxs-lookup"><span data-stu-id="ac714-140">How are keys distributed in a cluster?</span></span>](#how-are-keys-distributed-in-a-cluster)
* [<span data-ttu-id="ac714-141">¿Cuál es el mayor tamaño de caché que puedo crear?</span><span class="sxs-lookup"><span data-stu-id="ac714-141">What is the largest cache size I can create?</span></span>](#what-is-the-largest-cache-size-i-can-create)
* [<span data-ttu-id="ac714-142">¿Todos los clientes de Redis admiten la agrupación en clústeres?</span><span class="sxs-lookup"><span data-stu-id="ac714-142">Do all Redis clients support clustering?</span></span>](#do-all-redis-clients-support-clustering)
* [<span data-ttu-id="ac714-143">¿Cómo me conecto a mi memoria caché cuando la agrupación en clústeres esté habilitada?</span><span class="sxs-lookup"><span data-stu-id="ac714-143">How do I connect to my cache when clustering is enabled?</span></span>](#how-do-i-connect-to-my-cache-when-clustering-is-enabled)
* [<span data-ttu-id="ac714-144">¿Puedo conectarme directamente a las particiones individuales de mi memoria caché?</span><span class="sxs-lookup"><span data-stu-id="ac714-144">Can I directly connect to the individual shards of my cache?</span></span>](#can-i-directly-connect-to-the-individual-shards-of-my-cache)
* [<span data-ttu-id="ac714-145">¿Puedo configurar la agrupación en clústeres para una memoria caché creada anteriormente?</span><span class="sxs-lookup"><span data-stu-id="ac714-145">Can I configure clustering for a previously created cache?</span></span>](#can-i-configure-clustering-for-a-previously-created-cache)
* [<span data-ttu-id="ac714-146">¿Puedo configurar la agrupación en clústeres para una caché básica o estándar?</span><span class="sxs-lookup"><span data-stu-id="ac714-146">Can I configure clustering for a basic or standard cache?</span></span>](#can-i-configure-clustering-for-a-basic-or-standard-cache)
* [<span data-ttu-id="ac714-147">¿Puedo usar la agrupación en clústeres con los proveedores de estado de sesión y de almacenamiento en caché de salida de ASP.NET de Redis?.</span><span class="sxs-lookup"><span data-stu-id="ac714-147">Can I use clustering with the Redis ASP.NET Session State and Output Caching providers?</span></span>](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)
* [<span data-ttu-id="ac714-148">Estoy recibiendo excepciones MOVE al usar StackExchange.Redis y agrupaciones en clústeres, ¿qué debo hacer?</span><span class="sxs-lookup"><span data-stu-id="ac714-148">I am getting MOVE exceptions when using StackExchange.Redis and clustering, what should I do?</span></span>](#i-am-getting-move-exceptions-when-using-stackexchangeredis-and-clustering-what-should-i-do)

### <a name="do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering"></a><span data-ttu-id="ac714-149">¿Es necesario realizar algún cambio en mi aplicación cliente para usar la agrupación en clústeres?</span><span class="sxs-lookup"><span data-stu-id="ac714-149">Do I need to make any changes to my client application to use clustering?</span></span>
* <span data-ttu-id="ac714-150">Cuando la agrupación en clústeres está habilitada, solo está disponible la base de datos 0.</span><span class="sxs-lookup"><span data-stu-id="ac714-150">When clustering is enabled, only database 0 is available.</span></span> <span data-ttu-id="ac714-151">Si la aplicación cliente usa varias bases de datos e intenta leer o escribir en una base de datos distinta de 0, se produce la siguiente excepción.</span><span class="sxs-lookup"><span data-stu-id="ac714-151">If your client application uses multiple databases and it tries to read or write to a database other than 0, the following exception is thrown.</span></span> <span data-ttu-id="ac714-152">`Unhandled Exception: StackExchange.Redis.RedisConnectionException: ProtocolFailure on GET --->` `StackExchange.Redis.RedisCommandException: Multiple databases are not supported on this server; cannot switch to database: 6`</span><span class="sxs-lookup"><span data-stu-id="ac714-152">`Unhandled Exception: StackExchange.Redis.RedisConnectionException: ProtocolFailure on GET --->` `StackExchange.Redis.RedisCommandException: Multiple databases are not supported on this server; cannot switch to database: 6`</span></span>
  
  <span data-ttu-id="ac714-153">Para obtener más información, consulte [Redis Cluster Specification - Implemented subset](http://redis.io/topics/cluster-spec#implemented-subset)(Especificación de clúster en Redis: subconjunto implementado).</span><span class="sxs-lookup"><span data-stu-id="ac714-153">For more information, see [Redis Cluster Specification - Implemented subset](http://redis.io/topics/cluster-spec#implemented-subset).</span></span>
* <span data-ttu-id="ac714-154">Si usa [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/), debe usar la versión 1.0.481 o posterior.</span><span class="sxs-lookup"><span data-stu-id="ac714-154">If you are using [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/), you must use 1.0.481 or later.</span></span> <span data-ttu-id="ac714-155">Se conecta a la memoria caché con los mismos [puntos de conexión, puertos y claves](cache-configure.md#properties) que usa al conectarse a una memoria caché que no tenga la agrupación en clústeres habilitada.</span><span class="sxs-lookup"><span data-stu-id="ac714-155">You connect to the cache using the same [endpoints, ports, and keys](cache-configure.md#properties) that you use when connecting to a cache that does not have clustering enabled.</span></span> <span data-ttu-id="ac714-156">La única diferencia es que se deben realizar todas las lecturas y escrituras en la base de datos 0.</span><span class="sxs-lookup"><span data-stu-id="ac714-156">The only difference is that all reads and writes must be done to database 0.</span></span>
  
  * <span data-ttu-id="ac714-157">Otros clientes pueden tener requisitos diferentes.</span><span class="sxs-lookup"><span data-stu-id="ac714-157">Other clients may have different requirements.</span></span> <span data-ttu-id="ac714-158">Vea [¿Todos los clientes de Redis admiten la agrupación en clústeres?](#do-all-redis-clients-support-clustering)</span><span class="sxs-lookup"><span data-stu-id="ac714-158">See [Do all Redis clients support clustering?](#do-all-redis-clients-support-clustering)</span></span>
* <span data-ttu-id="ac714-159">Si la aplicación usa varias operaciones de claves por lotes en un solo comando, todas las claves deben estar ubicadas en la misma partición.</span><span class="sxs-lookup"><span data-stu-id="ac714-159">If your application uses multiple key operations batched into a single command, all keys must be located in the same shard.</span></span> <span data-ttu-id="ac714-160">Para ubicar claves en la misma partición, vea [¿Cómo se distribuyen las claves en un clúster?](#how-are-keys-distributed-in-a-cluster)</span><span class="sxs-lookup"><span data-stu-id="ac714-160">To locate keys in the same shard, see [How are keys distributed in a cluster?](#how-are-keys-distributed-in-a-cluster)</span></span>
* <span data-ttu-id="ac714-161">Si está usando el proveedor de estado de sesión de ASP.NET de Redis, debe usar 2.0.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="ac714-161">If you are using Redis ASP.NET Session State provider you must use 2.0.1 or higher.</span></span> <span data-ttu-id="ac714-162">Consulte [¿Puedo usar la agrupación en clústeres con los proveedores de estado de sesión y de almacenamiento en caché de salida de ASP.NET de Redis?](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)</span><span class="sxs-lookup"><span data-stu-id="ac714-162">See [Can I use clustering with the Redis ASP.NET Session State and Output Caching providers?](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)</span></span>

### <a name="how-are-keys-distributed-in-a-cluster"></a><span data-ttu-id="ac714-163">¿Cómo se distribuyen las claves en un clúster?</span><span class="sxs-lookup"><span data-stu-id="ac714-163">How are keys distributed in a cluster?</span></span>
<span data-ttu-id="ac714-164">Según la documentación del [modelo de distribución de claves](http://redis.io/topics/cluster-spec#keys-distribution-model) de Redis, el espacio de claves se divide en 16 384 espacios.</span><span class="sxs-lookup"><span data-stu-id="ac714-164">Per the Redis [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model) documentation: The key space is split into 16384 slots.</span></span> <span data-ttu-id="ac714-165">Cada clave tiene un hash y se asigna a una de estas ranuras, que se distribuyen por todos los nodos del clúster.</span><span class="sxs-lookup"><span data-stu-id="ac714-165">Each key is hashed and assigned to one of these slots, which are distributed across the nodes of the cluster.</span></span> <span data-ttu-id="ac714-166">Puede configurar qué parte de la clave está con hash para asegurarse de que varias claves se encuentran en la misma partición con etiquetas hash.</span><span class="sxs-lookup"><span data-stu-id="ac714-166">You can configure which part of the key is hashed to ensure that multiple keys are located in the same shard using hash tags.</span></span>

* <span data-ttu-id="ac714-167">Claves con una etiqueta hash: si cualquier parte de la clave está encerrada entre `{` y `}`, se aplica un algoritmo hash únicamente a esa parte de la clave para determinar la ranura hash de una clave.</span><span class="sxs-lookup"><span data-stu-id="ac714-167">Keys with a hash tag - if any part of the key is enclosed in `{` and `}`, only that part of the key is hashed for the purposes of determining the hash slot of a key.</span></span> <span data-ttu-id="ac714-168">Por ejemplo, las siguientes tres claves se encontrarían en la misma partición: `{key}1`, `{key}2` y `{key}3` ya que solo la parte `key` del nombre está con hash.</span><span class="sxs-lookup"><span data-stu-id="ac714-168">For example, the following 3 keys would be located in the same shard: `{key}1`, `{key}2`, and `{key}3` since only the `key` part of the name is hashed.</span></span> <span data-ttu-id="ac714-169">Para obtener una lista completa de especificaciones de etiquetas hash de claves, consulte [Etiquetas hash de claves](http://redis.io/topics/cluster-spec#keys-hash-tags).</span><span class="sxs-lookup"><span data-stu-id="ac714-169">For a complete list of keys hash tag specifications, see [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags).</span></span>
* <span data-ttu-id="ac714-170">Claves sin etiquetas hash: se usa todo el nombre de la clave para aplicar el hash.</span><span class="sxs-lookup"><span data-stu-id="ac714-170">Keys without a hash tag - the entire key name is used for hashing.</span></span> <span data-ttu-id="ac714-171">Esto produce una distribución estadísticamente uniforme entre las particiones de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="ac714-171">This results in a statistically even distribution across the shards of the cache.</span></span>

<span data-ttu-id="ac714-172">Para optimizar el rendimiento, se recomienda distribuir las claves de manera uniforme.</span><span class="sxs-lookup"><span data-stu-id="ac714-172">For best performance and throughput, we recommend distributing the keys evenly.</span></span> <span data-ttu-id="ac714-173">Si usa claves con etiquetas hash, es responsabilidad de la aplicación asegurarse de que las claves se distribuyan de manera uniforme.</span><span class="sxs-lookup"><span data-stu-id="ac714-173">If you are using keys with a hash tag it is the application's responsibility to ensure the keys are distributed evenly.</span></span>

<span data-ttu-id="ac714-174">Para obtener más información, consulte [Modelo de distribución de claves](http://redis.io/topics/cluster-spec#keys-distribution-model), [Particionamiento de datos de clúster Redis](http://redis.io/topics/cluster-tutorial#redis-cluster-data-sharding) y [Etiquetas hash de claves](http://redis.io/topics/cluster-spec#keys-hash-tags).</span><span class="sxs-lookup"><span data-stu-id="ac714-174">For more information, see [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model), [Redis Cluster data sharding](http://redis.io/topics/cluster-tutorial#redis-cluster-data-sharding), and [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags).</span></span>

<span data-ttu-id="ac714-175">Para obtener el código de ejemplo sobre el trabajo con agrupación en clústeres y la ubicación de claves en la misma partición con el cliente StackExchange.Redis, consulte la parte [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) del ejemplo [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld).</span><span class="sxs-lookup"><span data-stu-id="ac714-175">For sample code on working with clustering and locating keys in the same shard with the StackExchange.Redis client, see the [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) portion of the [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) sample.</span></span>

### <a name="what-is-the-largest-cache-size-i-can-create"></a><span data-ttu-id="ac714-176">¿Cuál es el mayor tamaño de caché que puedo crear?</span><span class="sxs-lookup"><span data-stu-id="ac714-176">What is the largest cache size I can create?</span></span>
<span data-ttu-id="ac714-177">El tamaño máximo de caché premium es 53 GB.</span><span class="sxs-lookup"><span data-stu-id="ac714-177">The largest premium cache size is 53 GB.</span></span> <span data-ttu-id="ac714-178">Puede crear hasta 10 particiones con un tamaño máximo de 530 GB.</span><span class="sxs-lookup"><span data-stu-id="ac714-178">You can create up to 10 shards giving you a maximum size of 530 GB.</span></span> <span data-ttu-id="ac714-179">Si necesita un tamaño mayor, puede [solicitar más](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase).</span><span class="sxs-lookup"><span data-stu-id="ac714-179">If you need a larger size you can [request more](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase).</span></span> <span data-ttu-id="ac714-180">Para obtener más información, consulte [Precios de Caché en Redis de Azure](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="ac714-180">For more information, see [Azure Redis Cache Pricing](https://azure.microsoft.com/pricing/details/cache/).</span></span>

### <a name="do-all-redis-clients-support-clustering"></a><span data-ttu-id="ac714-181">¿Todos los clientes de Redis admiten la agrupación en clústeres?</span><span class="sxs-lookup"><span data-stu-id="ac714-181">Do all Redis clients support clustering?</span></span>
<span data-ttu-id="ac714-182">En este momento no todos los clientes admiten la agrupación en clústeres de Redis.</span><span class="sxs-lookup"><span data-stu-id="ac714-182">At the present time not all clients support Redis clustering.</span></span> <span data-ttu-id="ac714-183">StackExchange.Redis es uno de los que los admiten.</span><span class="sxs-lookup"><span data-stu-id="ac714-183">StackExchange.Redis is one that does support for it.</span></span> <span data-ttu-id="ac714-184">Para obtener más información sobre otros clientes, consulte la sección [Jugar con el clúster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) del [Tutorial de clúster de Redis](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="ac714-184">For more information on other clients, see the [Playing with the cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) section of the [Redis cluster tutorial](http://redis.io/topics/cluster-tutorial).</span></span>

> [!NOTE]
> <span data-ttu-id="ac714-185">Si está usando StackExchange.Redis como su cliente, asegúrese de que está usando la versión más reciente de [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 o posterior para que la agrupación en clústeres funcione correctamente.</span><span class="sxs-lookup"><span data-stu-id="ac714-185">If you are using StackExchange.Redis as your client, ensure you are using the latest version of [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 or later for clustering to work correctly.</span></span> <span data-ttu-id="ac714-186">Si tiene problemas con las excepciones move, consulte la explicación sobre [excepciones move](#move-exceptions) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="ac714-186">If you have any issues with move exceptions, see [move exceptions](#move-exceptions) for more information.</span></span>
> 
> 

### <a name="how-do-i-connect-to-my-cache-when-clustering-is-enabled"></a><span data-ttu-id="ac714-187">¿Cómo me conecto a mi memoria caché cuando la agrupación en clústeres esté habilitada?</span><span class="sxs-lookup"><span data-stu-id="ac714-187">How do I connect to my cache when clustering is enabled?</span></span>
<span data-ttu-id="ac714-188">Puede conectarse a su memoria caché con los mismos [puntos de conexión](cache-configure.md#properties), [puertos](cache-configure.md#properties) y [claves](cache-configure.md#access-keys) que usa al conectarse a una memoria caché que no tenga la agrupación en clústeres habilitada.</span><span class="sxs-lookup"><span data-stu-id="ac714-188">You can connect to your cache using the same [endpoints](cache-configure.md#properties), [ports](cache-configure.md#properties), and [keys](cache-configure.md#access-keys) that you use when connecting to a cache that does not have clustering enabled.</span></span> <span data-ttu-id="ac714-189">Redis administra la agrupación en clústeres en el back-end para que no tenga que administrarla desde el cliente.</span><span class="sxs-lookup"><span data-stu-id="ac714-189">Redis manages the clustering on the backend so you don't have to manage it from your client.</span></span>

### <a name="can-i-directly-connect-to-the-individual-shards-of-my-cache"></a><span data-ttu-id="ac714-190">¿Puedo conectarme directamente a las particiones individuales de mi memoria caché?</span><span class="sxs-lookup"><span data-stu-id="ac714-190">Can I directly connect to the individual shards of my cache?</span></span>
<span data-ttu-id="ac714-191">Esto no se admite oficialmente.</span><span class="sxs-lookup"><span data-stu-id="ac714-191">This is not officially supported.</span></span> <span data-ttu-id="ac714-192">Dicho esto, cada partición consta de un par de caché principal/réplica que se conoce colectivamente como una instancia de caché.</span><span class="sxs-lookup"><span data-stu-id="ac714-192">With that said, each shard consists of a primary/replica cache pair, collectively known as a cache instance.</span></span> <span data-ttu-id="ac714-193">Puede conectarse a estas instancias de caché mediante la utilidad redis-cli en la rama [inestable](http://redis.io/download) del repositorio de Redis en GitHub.</span><span class="sxs-lookup"><span data-stu-id="ac714-193">You can connect to these cache instances using the redis-cli utility in the [unstable](http://redis.io/download) branch of the Redis repository at GitHub.</span></span> <span data-ttu-id="ac714-194">Esta versión implementa compatibilidad básica cuando se inicia con el conmutador `-c` .</span><span class="sxs-lookup"><span data-stu-id="ac714-194">This version implements basic support when started with the `-c` switch.</span></span> <span data-ttu-id="ac714-195">Para más información, consulte la sección [Playing with the cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) (Jugar con el clúster) del [tutorial de clústeres de Redis](http://redis.io) que encontrará en [http://redis.io](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="ac714-195">For more information see [Playing with the cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) on [http://redis.io](http://redis.io) in the [Redis cluster tutorial](http://redis.io/topics/cluster-tutorial).</span></span>

<span data-ttu-id="ac714-196">Cuando no sea ssl, use los siguientes comandos.</span><span class="sxs-lookup"><span data-stu-id="ac714-196">For non-ssl, use the following commands.</span></span>

    Redis-cli.exe –h <<cachename>> -p 13000 (to connect to instance 0)
    Redis-cli.exe –h <<cachename>> -p 13001 (to connect to instance 1)
    Redis-cli.exe –h <<cachename>> -p 13002 (to connect to instance 2)
    ...
    Redis-cli.exe –h <<cachename>> -p 1300N (to connect to instance N)

<span data-ttu-id="ac714-197">Para ssl, reemplace `1300N` por `1500N`.</span><span class="sxs-lookup"><span data-stu-id="ac714-197">For ssl, replace `1300N` with `1500N`.</span></span>

### <a name="can-i-configure-clustering-for-a-previously-created-cache"></a><span data-ttu-id="ac714-198">¿Puedo configurar la agrupación en clústeres para una memoria caché creada anteriormente?</span><span class="sxs-lookup"><span data-stu-id="ac714-198">Can I configure clustering for a previously created cache?</span></span>
<span data-ttu-id="ac714-199">En este momento solo puede habilitar la agrupación en clústeres cuando cree una memoria caché.</span><span class="sxs-lookup"><span data-stu-id="ac714-199">Currently you can only enable clustering when you create a cache.</span></span> <span data-ttu-id="ac714-200">También puede cambiar el tamaño de clúster una vez creada la memoria caché, pero no puede agregar la agrupación en clústeres a una caché premium o quitar la agrupación en clústeres de una memoria caché premium una vez creada la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="ac714-200">You can change the cluster size after the cache is created, but you can't add clustering to a premium cache or remove clustering from a premium cache after the cache is created.</span></span> <span data-ttu-id="ac714-201">Una memoria caché premium que tiene habilitada la agrupación en clústeres y solo una partición es distinta de una memoria caché premium del mismo tamaño, sin agrupación en clústeres.</span><span class="sxs-lookup"><span data-stu-id="ac714-201">A premium cache with clustering enabled and only one shard is different than a premium cache of the same size with no clustering.</span></span>

### <a name="can-i-configure-clustering-for-a-basic-or-standard-cache"></a><span data-ttu-id="ac714-202">¿Puedo configurar la agrupación en clústeres para una caché básica o estándar?</span><span class="sxs-lookup"><span data-stu-id="ac714-202">Can I configure clustering for a basic or standard cache?</span></span>
<span data-ttu-id="ac714-203">La agrupación en clústeres solo está disponible para las memorias cachés premium.</span><span class="sxs-lookup"><span data-stu-id="ac714-203">Clustering is only available for premium caches.</span></span>

### <a name="can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers"></a><span data-ttu-id="ac714-204">¿Puedo usar la agrupación en clústeres con los proveedores de estado de sesión y de almacenamiento en caché de salida de ASP.NET de Redis?.</span><span class="sxs-lookup"><span data-stu-id="ac714-204">Can I use clustering with the Redis ASP.NET Session State and Output Caching providers?</span></span>
* <span data-ttu-id="ac714-205">**Proveedor de caché de salida de Redis** : no se requieren cambios.</span><span class="sxs-lookup"><span data-stu-id="ac714-205">**Redis Output Cache provider** - no changes required.</span></span>
* <span data-ttu-id="ac714-206">**Proveedor de estado de sesión de Redis**: para usar la agrupación en clústeres, debe usar [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 o superior o se iniciará una excepción.</span><span class="sxs-lookup"><span data-stu-id="ac714-206">**Redis Session State provider** - to use clustering, you must use [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 or higher or an exception is thrown.</span></span> <span data-ttu-id="ac714-207">Este es un cambio importante. Para obtener más información, consulte [v2.0.0 Breaking Change Details](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details) (Detalles sobre cambios importantes de la versión 2.0.0).</span><span class="sxs-lookup"><span data-stu-id="ac714-207">This is a breaking change; for more information see [v2.0.0 Breaking Change Details](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details).</span></span>

<a name="move-exceptions"></a>

### <a name="i-am-getting-move-exceptions-when-using-stackexchangeredis-and-clustering-what-should-i-do"></a><span data-ttu-id="ac714-208">Estoy recibiendo excepciones MOVE al usar StackExchange.Redis y agrupaciones en clústeres, ¿qué debo hacer?</span><span class="sxs-lookup"><span data-stu-id="ac714-208">I am getting MOVE exceptions when using StackExchange.Redis and clustering, what should I do?</span></span>
<span data-ttu-id="ac714-209">Si utiliza StackExchange.Redis y recibe `MOVE` excepciones al emplear agrupaciones en clústeres, asegúrese de que está utilizando la versión [1.1.603 de StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) o posterior.</span><span class="sxs-lookup"><span data-stu-id="ac714-209">If you are using StackExchange.Redis and receive `MOVE` exceptions when using clustering, ensure that you are using [StackExchange.Redis 1.1.603](https://www.nuget.org/packages/StackExchange.Redis/) or later.</span></span> <span data-ttu-id="ac714-210">Para obtener instrucciones sobre cómo configurar las aplicaciones .NET para usar StackExchange.Redis, consulte [Configuración de los clientes de caché](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span><span class="sxs-lookup"><span data-stu-id="ac714-210">For instructions on configuring your .NET applications to use StackExchange.Redis, see [Configure the cache clients](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ac714-211">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="ac714-211">Next steps</span></span>
<span data-ttu-id="ac714-212">Obtenga información acerca de cómo usar más características de la memoria caché del nivel Premium.</span><span class="sxs-lookup"><span data-stu-id="ac714-212">Learn how to use more premium cache features.</span></span>

* [<span data-ttu-id="ac714-213">Introducción al nivel Premium de Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="ac714-213">Introduction to the Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-clustering]: ./media/cache-how-to-premium-clustering/redis-cache-clustering.png

[redis-cache-clustering-selected]: ./media/cache-how-to-premium-clustering/redis-cache-clustering-selected.png

[redis-cache-redis-cluster-size]: ./media/cache-how-to-premium-clustering/redis-cache-redis-cluster-size.png







