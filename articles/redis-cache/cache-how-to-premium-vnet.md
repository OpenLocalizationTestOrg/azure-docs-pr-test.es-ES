---
title: "una red Virtual para una caché en Redis de Azure Premium aaaConfigure | Documentos de Microsoft"
description: "Obtenga información acerca de cómo toocreate y administrar la compatibilidad con red Virtual para las instancias de caché en Redis de Azure de nivel Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="771c9-103">Cómo tooconfigure admite la red Virtual para una caché de Redis de Azure Premium</span><span class="sxs-lookup"><span data-stu-id="771c9-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="771c9-104">Caché en Redis de Azure tiene diferentes ofertas de caché, lo que proporciona flexibilidad en la elección de Hola de tamaño de caché y las características, incluidas las características de nivel Premium como de agrupación en clústeres, la persistencia y la compatibilidad de red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="771c9-105">Una red virtual es una red privada en la nube de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="771c9-106">Cuando una instancia de caché en Redis de Azure se configura con una red virtual, no es direccionable de forma pública y solo puede tener acceso desde máquinas virtuales y las aplicaciones dentro de hello red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="771c9-107">Este artículo describe cómo son compatibles con tooconfigure de red virtual para una instancia de caché en Redis de Azure premium.</span><span class="sxs-lookup"><span data-stu-id="771c9-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="771c9-108">Azure Redis Cache admite redes virtuales clásicas y de Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="771c9-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="771c9-109">Para obtener información sobre otras características de caché premium, consulte [nivel Premium de caché de Redis de Azure de introducción toohello](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="771c9-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="771c9-110">¿Por qué una red virtual?</span><span class="sxs-lookup"><span data-stu-id="771c9-110">Why VNet?</span></span>
<span data-ttu-id="771c9-111">[Red Virtual de Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) implementación ofrece seguridad mejorada y aislamiento para la caché en Redis de Azure, así como las subredes, las directivas de control de acceso, y otra características toofurther restringir el acceso.</span><span class="sxs-lookup"><span data-stu-id="771c9-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="771c9-112">Compatibilidad con redes virtuales</span><span class="sxs-lookup"><span data-stu-id="771c9-112">Virtual network support</span></span>
<span data-ttu-id="771c9-113">Compatibilidad de red virtual está configurado en hello **nueva caché en Redis** hoja durante la creación de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="771c9-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="771c9-114">Una vez haya seleccionado un elevado nivel de precios, puede configurar la integración de red virtual Redis seleccionando una red virtual que se encuentra en hello misma suscripción y ubicación que la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="771c9-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="771c9-115">toouse una red virtual nueva, cree primero siguiendo los pasos de hello en [crear una red virtual con el portal de Azure hello](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) o [crear una red virtual (clásica) mediante el uso de hello portal de Azure](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) y, a continuación, devolver toohello **Nueva caché en Redis** toocreate hoja y configure la caché premium.</span><span class="sxs-lookup"><span data-stu-id="771c9-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="771c9-116">Hola tooconfigure red virtual para la caché de nuevo, haga clic en **red Virtual** en hello **nueva caché en Redis** hoja y seleccione Hola deseada red virtual de la lista desplegable de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Red virtual][redis-cache-vnet]

<span data-ttu-id="771c9-118">Seleccione Hola subred deseada de hello **subred** lista desplegable lista y especificar Hola deseado **dirección IP estática**.</span><span class="sxs-lookup"><span data-stu-id="771c9-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="771c9-119">Si usas un clásico Hola de red virtual **dirección IP estática** campo es opcional y si no se especifica ninguno, se elige una de la subred de hello seleccionado.</span><span class="sxs-lookup"><span data-stu-id="771c9-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="771c9-120">Al implementar un tooa de caché en Redis de Azure Resource Manager VNet, caché Hola debe estar en una subred dedicada que no contiene ningún otro recurso excepto instancias de caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="771c9-121">Si se realiza un intento de toodeploy un tooa de caché en Redis de Azure Resource Manager VNet tooa subred que contiene otros recursos, la implementación de hello produce un error.</span><span class="sxs-lookup"><span data-stu-id="771c9-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Red virtual][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="771c9-123">Azure reserva algunas direcciones IP dentro de cada subred y estas direcciones no se pueden usar.</span><span class="sxs-lookup"><span data-stu-id="771c9-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="771c9-124">Hello primeros y últimas direcciones IP de subredes de hello están reservadas para la conformidad con el protocolo, junto con tres direcciones más utilizadas para los servicios de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="771c9-125">Para más información, consulte [¿Hay alguna restricción en el uso de direcciones IP dentro de estas subredes?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="771c9-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="771c9-126">En suma toohello direcciones IP que usa la infraestructura de red virtual de Azure hello, cada Redis instancia en la subred de direcciones IP hello usa dos por partición y una dirección IP adicional para el equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="771c9-127">Una memoria caché no clúster se considera toohave una partición.</span><span class="sxs-lookup"><span data-stu-id="771c9-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="771c9-128">Después de crea la memoria caché de hello, puede ver configuración Hola Hola red virtual haciendo clic en **red Virtual** de hello **menú recursos**.</span><span class="sxs-lookup"><span data-stu-id="771c9-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Red virtual][redis-cache-vnet-info]

<span data-ttu-id="771c9-130">tooconnect tooyour Redis de Azure, instancia de caché cuando se usa una red virtual, especifique el nombre de host de hello de la memoria caché en la cadena de conexión de hello tal y como se muestra en el siguiente ejemplo de Hola:</span><span class="sxs-lookup"><span data-stu-id="771c9-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="771c9-131">Preguntas frecuentes sobre la red virtual de Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="771c9-132">Hola lista siguiente contiene toocommonly respuestas preguntas más frecuentes sobre la escala de hello Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="771c9-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="771c9-133">¿Cuáles son algunos de los problemas comunes de configuración incorrecta con Caché en Redis de Azure y las redes virtuales?</span><span class="sxs-lookup"><span data-stu-id="771c9-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="771c9-134">¿Cómo se puede comprobar que la memoria caché funciona una red virtual?</span><span class="sxs-lookup"><span data-stu-id="771c9-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="771c9-135">¿Se pueden usar redes virtuales con una memoria caché Basic o Estándar?</span><span class="sxs-lookup"><span data-stu-id="771c9-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="771c9-136">¿Por qué se produce un error al crear una caché en Redis en algunas subredes, pero no en otras?</span><span class="sxs-lookup"><span data-stu-id="771c9-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="771c9-137">¿Cuáles son los requisitos de espacio de dirección de subred de hello?</span><span class="sxs-lookup"><span data-stu-id="771c9-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="771c9-138">¿Funcionarán todas las características al alojar una caché en una red virtual?</span><span class="sxs-lookup"><span data-stu-id="771c9-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="771c9-139">¿Cuáles son algunos de los problemas comunes de configuración incorrecta con Caché en Redis de Azure y las redes virtuales?</span><span class="sxs-lookup"><span data-stu-id="771c9-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="771c9-140">Cuando la caché en Redis de Azure se hospeda en una red virtual, se usan puertos Hola Hola las tablas siguientes.</span><span class="sxs-lookup"><span data-stu-id="771c9-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="771c9-141">Si se bloquean los puertos de hello en hello las tablas siguientes, caché hello no funcionen correctamente.</span><span class="sxs-lookup"><span data-stu-id="771c9-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="771c9-142">Con uno o varios de estos puertos que están bloqueados es el problema más común de una configuración incorrecta de hello cuando se usa la caché en Redis de Azure en una red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="771c9-143">Requisitos de puerto de salida</span><span class="sxs-lookup"><span data-stu-id="771c9-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="771c9-144">Requisitos de puerto de entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="771c9-145">Requisitos de puerto de salida</span><span class="sxs-lookup"><span data-stu-id="771c9-145">Outbound port requirements</span></span>

<span data-ttu-id="771c9-146">Existen siete requisitos de puerto de salida.</span><span class="sxs-lookup"><span data-stu-id="771c9-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="771c9-147">Si lo desea, todos los toohello de las conexiones salientes internet puede realizarse a través de un cliente auditoría el dispositivo local.</span><span class="sxs-lookup"><span data-stu-id="771c9-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="771c9-148">Tres de los puertos de hello enrutan puntos de conexión de tráfico tooAzure servicio almacenamiento de Azure y DNS de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="771c9-149">Hola restantes intervalos de puertos y para la comunicación interna de subred de Redis.</span><span class="sxs-lookup"><span data-stu-id="771c9-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="771c9-150">No es necesaria ninguna regla de NSG para las comunicaciones internas de la subred de Redis.</span><span class="sxs-lookup"><span data-stu-id="771c9-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="771c9-151">Puertos</span><span class="sxs-lookup"><span data-stu-id="771c9-151">Port(s)</span></span> | <span data-ttu-id="771c9-152">Dirección</span><span class="sxs-lookup"><span data-stu-id="771c9-152">Direction</span></span> | <span data-ttu-id="771c9-153">Protocolo de transporte</span><span class="sxs-lookup"><span data-stu-id="771c9-153">Transport Protocol</span></span> | <span data-ttu-id="771c9-154">Propósito</span><span class="sxs-lookup"><span data-stu-id="771c9-154">Purpose</span></span> | <span data-ttu-id="771c9-155">IP local</span><span class="sxs-lookup"><span data-stu-id="771c9-155">Local IP</span></span> | <span data-ttu-id="771c9-156">Dirección IP remota</span><span class="sxs-lookup"><span data-stu-id="771c9-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="771c9-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="771c9-157">80, 443</span></span> |<span data-ttu-id="771c9-158">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-158">Outbound</span></span> |<span data-ttu-id="771c9-159">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-159">TCP</span></span> |<span data-ttu-id="771c9-160">Dependencias de Redis en Almacenamiento de Azure/PKI (Internet)</span><span class="sxs-lookup"><span data-stu-id="771c9-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="771c9-161">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="771c9-162">53</span><span class="sxs-lookup"><span data-stu-id="771c9-162">53</span></span> |<span data-ttu-id="771c9-163">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-163">Outbound</span></span> |<span data-ttu-id="771c9-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="771c9-164">TCP/UDP</span></span> |<span data-ttu-id="771c9-165">Dependencias de Redis en DNS (Internet y red virtual)</span><span class="sxs-lookup"><span data-stu-id="771c9-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="771c9-166">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="771c9-167">8443</span><span class="sxs-lookup"><span data-stu-id="771c9-167">8443</span></span> |<span data-ttu-id="771c9-168">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-168">Outbound</span></span> |<span data-ttu-id="771c9-169">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-169">TCP</span></span> |<span data-ttu-id="771c9-170">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-170">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-171">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-171">(Redis subnet)</span></span> | <span data-ttu-id="771c9-172">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-172">(Redis subnet)</span></span> |
| <span data-ttu-id="771c9-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="771c9-173">10221-10231</span></span> |<span data-ttu-id="771c9-174">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-174">Outbound</span></span> |<span data-ttu-id="771c9-175">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-175">TCP</span></span> |<span data-ttu-id="771c9-176">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-176">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-177">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-177">(Redis subnet)</span></span> | <span data-ttu-id="771c9-178">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-178">(Redis subnet)</span></span> |
| <span data-ttu-id="771c9-179">20226</span><span class="sxs-lookup"><span data-stu-id="771c9-179">20226</span></span> |<span data-ttu-id="771c9-180">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-180">Outbound</span></span> |<span data-ttu-id="771c9-181">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-181">TCP</span></span> |<span data-ttu-id="771c9-182">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-182">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-183">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-183">(Redis subnet)</span></span> |<span data-ttu-id="771c9-184">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-184">(Redis subnet)</span></span> |
| <span data-ttu-id="771c9-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="771c9-185">13000-13999</span></span> |<span data-ttu-id="771c9-186">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-186">Outbound</span></span> |<span data-ttu-id="771c9-187">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-187">TCP</span></span> |<span data-ttu-id="771c9-188">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-188">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-189">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-189">(Redis subnet)</span></span> |<span data-ttu-id="771c9-190">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-190">(Redis subnet)</span></span> |
| <span data-ttu-id="771c9-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="771c9-191">15000-15999</span></span> |<span data-ttu-id="771c9-192">Salida</span><span class="sxs-lookup"><span data-stu-id="771c9-192">Outbound</span></span> |<span data-ttu-id="771c9-193">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-193">TCP</span></span> |<span data-ttu-id="771c9-194">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-194">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-195">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-195">(Redis subnet)</span></span> |<span data-ttu-id="771c9-196">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="771c9-197">Requisitos de puerto de entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-197">Inbound port requirements</span></span>

<span data-ttu-id="771c9-198">Existen ocho requisitos de intervalo de puertos de entrada.</span><span class="sxs-lookup"><span data-stu-id="771c9-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="771c9-199">Las solicitudes entrantes en estos intervalos son entrante desde otros servicios hospedados en hello misma red virtual o interna toohello las comunicaciones de subred de Redis.</span><span class="sxs-lookup"><span data-stu-id="771c9-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="771c9-200">Puertos</span><span class="sxs-lookup"><span data-stu-id="771c9-200">Port(s)</span></span> | <span data-ttu-id="771c9-201">Dirección</span><span class="sxs-lookup"><span data-stu-id="771c9-201">Direction</span></span> | <span data-ttu-id="771c9-202">Protocolo de transporte</span><span class="sxs-lookup"><span data-stu-id="771c9-202">Transport Protocol</span></span> | <span data-ttu-id="771c9-203">Propósito</span><span class="sxs-lookup"><span data-stu-id="771c9-203">Purpose</span></span> | <span data-ttu-id="771c9-204">IP local</span><span class="sxs-lookup"><span data-stu-id="771c9-204">Local IP</span></span> | <span data-ttu-id="771c9-205">Dirección IP remota</span><span class="sxs-lookup"><span data-stu-id="771c9-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="771c9-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="771c9-206">6379, 6380</span></span> |<span data-ttu-id="771c9-207">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-207">Inbound</span></span> |<span data-ttu-id="771c9-208">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-208">TCP</span></span> |<span data-ttu-id="771c9-209">TooRedis de comunicación de cliente, equilibrio de carga de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="771c9-210">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-210">(Redis subnet)</span></span> |<span data-ttu-id="771c9-211">Virtual Network, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="771c9-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="771c9-212">8443</span><span class="sxs-lookup"><span data-stu-id="771c9-212">8443</span></span> |<span data-ttu-id="771c9-213">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-213">Inbound</span></span> |<span data-ttu-id="771c9-214">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-214">TCP</span></span> |<span data-ttu-id="771c9-215">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-215">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-216">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-216">(Redis subnet)</span></span> |<span data-ttu-id="771c9-217">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-217">(Redis subnet)</span></span> |
| <span data-ttu-id="771c9-218">8500</span><span class="sxs-lookup"><span data-stu-id="771c9-218">8500</span></span> |<span data-ttu-id="771c9-219">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-219">Inbound</span></span> |<span data-ttu-id="771c9-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="771c9-220">TCP/UDP</span></span> |<span data-ttu-id="771c9-221">Equilibrio de carga de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-221">Azure load balancing</span></span> | <span data-ttu-id="771c9-222">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-222">(Redis subnet)</span></span> |<span data-ttu-id="771c9-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="771c9-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="771c9-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="771c9-224">10221-10231</span></span> |<span data-ttu-id="771c9-225">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-225">Inbound</span></span> |<span data-ttu-id="771c9-226">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-226">TCP</span></span> |<span data-ttu-id="771c9-227">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-227">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-228">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-228">(Redis subnet)</span></span> |<span data-ttu-id="771c9-229">(Subred de Redis), Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="771c9-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="771c9-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="771c9-230">13000-13999</span></span> |<span data-ttu-id="771c9-231">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-231">Inbound</span></span> |<span data-ttu-id="771c9-232">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-232">TCP</span></span> |<span data-ttu-id="771c9-233">TooRedis de comunicación de cliente clústeres de equilibrio de carga de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="771c9-234">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-234">(Redis subnet)</span></span> |<span data-ttu-id="771c9-235">Virtual Network, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="771c9-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="771c9-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="771c9-236">15000-15999</span></span> |<span data-ttu-id="771c9-237">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-237">Inbound</span></span> |<span data-ttu-id="771c9-238">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-238">TCP</span></span> |<span data-ttu-id="771c9-239">Equilibrio de carga de clústeres, Azure de tooRedis de comunicación de cliente</span><span class="sxs-lookup"><span data-stu-id="771c9-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="771c9-240">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-240">(Redis subnet)</span></span> |<span data-ttu-id="771c9-241">Virtual Network, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="771c9-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="771c9-242">16001</span><span class="sxs-lookup"><span data-stu-id="771c9-242">16001</span></span> |<span data-ttu-id="771c9-243">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-243">Inbound</span></span> |<span data-ttu-id="771c9-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="771c9-244">TCP/UDP</span></span> |<span data-ttu-id="771c9-245">Equilibrio de carga de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-245">Azure load balancing</span></span> | <span data-ttu-id="771c9-246">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-246">(Redis subnet)</span></span> |<span data-ttu-id="771c9-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="771c9-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="771c9-248">20226</span><span class="sxs-lookup"><span data-stu-id="771c9-248">20226</span></span> |<span data-ttu-id="771c9-249">Entrada</span><span class="sxs-lookup"><span data-stu-id="771c9-249">Inbound</span></span> |<span data-ttu-id="771c9-250">TCP</span><span class="sxs-lookup"><span data-stu-id="771c9-250">TCP</span></span> |<span data-ttu-id="771c9-251">Comunicaciones internas en Redis</span><span class="sxs-lookup"><span data-stu-id="771c9-251">Internal communications for Redis</span></span> | <span data-ttu-id="771c9-252">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-252">(Redis subnet)</span></span> |<span data-ttu-id="771c9-253">(Subred de Redis)</span><span class="sxs-lookup"><span data-stu-id="771c9-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="771c9-254">Requisitos adicionales de conectividad de red virtual</span><span class="sxs-lookup"><span data-stu-id="771c9-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="771c9-255">Existen requisitos de conectividad de red para entornos para una Caché en Redis de Azure que no pueden cumplirse inicialmente en una red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="771c9-256">Caché en Redis de Azure requiere que todos Hola después elementos toofunction correctamente cuando se utiliza en una red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="771c9-257">Red saliente conectividad tooAzure extremos de almacenamiento en todo el mundo.</span><span class="sxs-lookup"><span data-stu-id="771c9-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="771c9-258">Esto incluye los puntos de conexión que se encuentra en hello misma región que la instancia de caché en Redis de Azure de hello, así como los extremos de almacenamiento que se encuentra en **otros** regiones de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="771c9-259">Extremos de almacenamiento de Azure resolver en hello siguiendo los dominios DNS: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*y *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="771c9-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="771c9-260">Salida conectividad de red demasiado*ocsp.msocsp.com*, *mscrl.microsoft.com*, y *crl.microsoft.com*. Esta conectividad es la funcionalidad SSL toosupport necesarios.</span><span class="sxs-lookup"><span data-stu-id="771c9-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="771c9-261">configuración de DNS de Hola de red virtual de hello debe ser capaz de resolver todos los puntos de conexión de Hola y dominios que se menciona en Hola puntos anteriores.</span><span class="sxs-lookup"><span data-stu-id="771c9-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="771c9-262">Estos requisitos de DNS pueden cumplirse asegurándose de una infraestructura DNS válida se configuran y se mantienen para la red virtual de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="771c9-263">Toohello de conectividad de red saliente después de extremos de supervisión de Azure, que resolver en hello siguiendo los dominios DNS: shoebox2 black.shoebox2.metrics.nsatc.net, Norte-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, este-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="771c9-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="771c9-264">¿Cómo se puede comprobar que la memoria caché funciona una red virtual?</span><span class="sxs-lookup"><span data-stu-id="771c9-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="771c9-265">Cuando se conecta la instancia del servicio Azure Redis Cache tooan que se hospeda en una red virtual, la memoria caché los clientes deben estar en Hola misma red virtual, incluidas las aplicaciones de prueba o herramientas de diagnóstico de hacer ping.</span><span class="sxs-lookup"><span data-stu-id="771c9-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="771c9-266">Después de configuran los requisitos de puerto de hello tal y como se describe en la sección anterior de hello, puede comprobar que la memoria caché funciona mediante la realización de hello pasos.</span><span class="sxs-lookup"><span data-stu-id="771c9-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="771c9-267">[Reiniciar](cache-administration.md#reboot) todos Hola nodos de caché.</span><span class="sxs-lookup"><span data-stu-id="771c9-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="771c9-268">Si todos los de hello necesarios no se puede alcanzar las dependencias de caché (como se documenta en [requisitos del puerto de entrada](cache-how-to-premium-vnet.md#inbound-port-requirements) y [requisitos de puerto de salida](cache-how-to-premium-vnet.md#outbound-port-requirements)), caché hello no será capaz de toorestart correctamente.</span><span class="sxs-lookup"><span data-stu-id="771c9-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="771c9-269">Una vez que los nodos de la memoria caché de hello reiniciar (como indica el estado de la caché de Hola Hola portal de Azure), puede realizar Hola siguientes pruebas:</span><span class="sxs-lookup"><span data-stu-id="771c9-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="771c9-270">hacer ping Hola extremo de la caché (mediante el puerto 6380) desde un equipo que esté dentro de hello misma red virtual como hello en caché, con [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="771c9-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="771c9-271">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="771c9-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="771c9-272">Si hello `tcping` herramienta notifica que Hola puerto está abierto, Hola caché está disponible para la conexión de los clientes en hello red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="771c9-273">Tootest de otra manera es toocreate un cliente de caché de prueba (que podría ser una sencilla aplicación de consola mediante StackExchange.Redis) que se conecta toohello caché agrega y recupera algunos elementos de caché de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="771c9-274">Instalar la aplicación de cliente de ejemplo de Hola en una máquina virtual que se encuentra en Hola misma red virtual como memoria caché de Hola y ejecútelo en caché de tooverify conectividad toohello.</span><span class="sxs-lookup"><span data-stu-id="771c9-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="771c9-275">¿Se pueden usar redes virtuales con una memoria caché Basic o Estándar?</span><span class="sxs-lookup"><span data-stu-id="771c9-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="771c9-276">Las redes virtuales solo se pueden usar con memorias caché Premium.</span><span class="sxs-lookup"><span data-stu-id="771c9-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="771c9-277">¿Por qué se produce un error al crear una caché en Redis en algunas subredes, pero no en otras?</span><span class="sxs-lookup"><span data-stu-id="771c9-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="771c9-278">Si va a implementar un tooa de caché en Redis de Azure Resource Manager VNet, caché Hola debe estar en una subred dedicada que no contenga ningún otro tipo de recurso.</span><span class="sxs-lookup"><span data-stu-id="771c9-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="771c9-279">Si se realiza un intento de toodeploy se produce un error en una subred VNet el Administrador de recursos que contiene otros recursos, la implementación de Hola tooa de Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="771c9-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="771c9-280">Debe eliminar los recursos existentes dentro de la subred de Hola Hola antes de poder crear una nueva caché de Redis.</span><span class="sxs-lookup"><span data-stu-id="771c9-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="771c9-281">Puede implementar varios tipos de recursos tooa clásico red virtual siempre que tengan suficiente IP direcciones disponibles.</span><span class="sxs-lookup"><span data-stu-id="771c9-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="771c9-282">¿Cuáles son los requisitos de espacio de dirección de subred de hello?</span><span class="sxs-lookup"><span data-stu-id="771c9-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="771c9-283">Azure reserva algunas direcciones IP dentro de cada subred y estas direcciones no se pueden usar.</span><span class="sxs-lookup"><span data-stu-id="771c9-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="771c9-284">Hello primeros y últimas direcciones IP de subredes de hello están reservadas para la conformidad con el protocolo, junto con tres direcciones más utilizadas para los servicios de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="771c9-285">Para más información, consulte [¿Hay alguna restricción en el uso de direcciones IP dentro de estas subredes?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="771c9-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="771c9-286">En suma toohello direcciones IP que usa la infraestructura de red virtual de Azure hello, cada Redis instancia en la subred de direcciones IP hello usa dos por partición y una dirección IP adicional para el equilibrador de carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="771c9-287">Una memoria caché no clúster se considera toohave una partición.</span><span class="sxs-lookup"><span data-stu-id="771c9-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="771c9-288">¿Funcionarán todas las características al alojar una caché en una red virtual?</span><span class="sxs-lookup"><span data-stu-id="771c9-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="771c9-289">Cuando la memoria caché forma parte de una red virtual, solo los clientes de hello red virtual pueden tener acceso a memoria caché de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="771c9-290">Como resultado, hello siguientes características de administración de memoria caché no funcionan en este momento.</span><span class="sxs-lookup"><span data-stu-id="771c9-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="771c9-291">Consola de Redis: como consola de Redis se ejecuta en el explorador local, que se encuentra fuera de la red virtual de hello, no puede conectar tooyour caché.</span><span class="sxs-lookup"><span data-stu-id="771c9-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="771c9-292">Uso de ExpressRoute con Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="771c9-293">Los clientes pueden conectarse un [ExpressRoute de Azure](https://azure.microsoft.com/services/expressroute/) infraestructura de red virtual de circuito tootheir, lo que extender su tooAzure de red local.</span><span class="sxs-lookup"><span data-stu-id="771c9-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="771c9-294">De forma predeterminada, un circuito ExpressRoute recién creado no realiza la tunelización forzada (anuncio de una ruta predeterminada, 0.0.0.0/0) en una red virtual.</span><span class="sxs-lookup"><span data-stu-id="771c9-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="771c9-295">Como resultado, se permite conectividad saliente de Internet directamente desde la red virtual de Hola y las aplicaciones cliente son tooother tooconnect capaz de Azure extremos incluidos caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="771c9-296">Sin embargo, una configuración de cliente común es toouse tunelización forzada (anunciar una ruta predeterminada) lo que fuerza la salida Internet tráfico tooinstead flujo local.</span><span class="sxs-lookup"><span data-stu-id="771c9-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="771c9-297">Este flujo de tráfico de conectividad con caché en Redis de Azure interrumpe si el tráfico de salida de hello es, a continuación, bloquea local que hello instancia de caché en Redis de Azure no sea capaz de toocommunicate con sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="771c9-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="771c9-298">solución de Hello es toodefine uno (o más) definido por el usuario rutas (UDRs) en la subred Hola que contiene Hola caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="771c9-299">Un UDR define las rutas de subred específica que se respetará en lugar de la ruta predeterminada de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="771c9-300">Si es posible, se recomienda hello toouse siguiente configuración:</span><span class="sxs-lookup"><span data-stu-id="771c9-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="771c9-301">configuración de ExpressRoute de Hello anuncia 0.0.0.0/0 y de forma predeterminada force túneles todo el tráfico saliente en local.</span><span class="sxs-lookup"><span data-stu-id="771c9-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="771c9-302">Hello UDR aplica toohello subred que contiene Hola caché en Redis de Azure define 0.0.0.0/0 con una ruta de trabajo para toohello de tráfico de TCP/IP internet pública; Por ejemplo por establecer Hola del próximo salto too'Internet de tipo '.</span><span class="sxs-lookup"><span data-stu-id="771c9-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="771c9-303">Hola efecto combinado de estos pasos es que el nivel de subred de hello UDR tiene precedencia sobre hello ExpressRoute forzado túnel, lo que garantiza el acceso a Internet saliente desde Hola caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="771c9-304">Instancia de caché en Redis de Azure tooan conexión desde una aplicación local mediante ExpressRoute no es un escenario de uso típico debido a motivos de tooperformance (para obtener el mejor rendimiento de caché en Redis de Azure, los clientes deben estar en hello misma región que Hola caché en Redis de Azure).</span><span class="sxs-lookup"><span data-stu-id="771c9-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="771c9-305">Hola rutas definidas en un UDR **debe** ser lo suficientemente específica como tootake prioridad sobre las rutas anunciadas por la configuración de ExpressRoute de Hola.</span><span class="sxs-lookup"><span data-stu-id="771c9-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="771c9-306">Hello en el ejemplo siguiente se usa el intervalo de direcciones de hello amplia 0.0.0.0/0 y por lo tanto puede potencialmente accidentalmente reemplazarse por anuncios de rutas con intervalos de direcciones más específicos.</span><span class="sxs-lookup"><span data-stu-id="771c9-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="771c9-307">Caché en Redis de Azure no es compatible con configuraciones de ExpressRoute que **incorrectamente entre-anunciar rutas de hello pública emparejamiento toohello privada emparejamiento ruta de acceso**.</span><span class="sxs-lookup"><span data-stu-id="771c9-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="771c9-308">Las configuraciones de ExpressRoute con el emparejamiento público configurado reciben anuncios de ruta de Microsoft para un amplio conjunto de intervalos de direcciones IP de Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="771c9-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="771c9-309">Si estos intervalos de direcciones se publicita entre incorrectamente en la ruta de intercambio de tráfico privado hello, resultado de hello es que todos los paquetes de red saliente de la subred de la instancia de caché en Redis de Azure de hello red de local del cliente tooa incorrectamente un túnel forzado infraestructura.</span><span class="sxs-lookup"><span data-stu-id="771c9-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="771c9-310">Este flujo de red interrumpe Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="771c9-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="771c9-311">problema de Hello solución toothis es toostop rutas de entre anuncios de Hola pública emparejamiento toohello privada emparejamiento ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="771c9-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="771c9-312">Se puede encontrar información de contexto sobre las rutas definidas por el usuario en esta [información general](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="771c9-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="771c9-313">Para más información sobre ExpressRoute, consulte [Información técnica sobre ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="771c9-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="771c9-314">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="771c9-314">Next steps</span></span>
<span data-ttu-id="771c9-315">Obtenga información acerca de cómo toouse premium más características de caché.</span><span class="sxs-lookup"><span data-stu-id="771c9-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="771c9-316">Nivel de introducción toohello Premium de caché de Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="771c9-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

