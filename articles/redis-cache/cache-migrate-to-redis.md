---
title: "Migración de las aplicaciones de Managed Cache Service a Redis - Azure | Microsoft Docs"
description: "Obtenga información sobre cómo migrar las aplicaciones de Managed Cache Service y In-Role Cache Azure Redis Cache"
services: redis-cache
documentationcenter: na
author: steved0x
manager: douge
editor: tysonn
ms.assetid: 041f077b-8c8e-4d7c-a3fc-89d334ed70d6
ms.service: cache
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: cache-redis
ms.workload: tbd
ms.date: 05/30/2017
ms.author: sdanie
ms.openlocfilehash: 0fbfb945c66926794721f2ce8cc183dac51ecb27
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="migrate-from-managed-cache-service-to-azure-redis-cache"></a><span data-ttu-id="306d5-103">Migración desde el Servicio de caché administrado a Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="306d5-103">Migrate from Managed Cache Service to Azure Redis Cache</span></span>
<span data-ttu-id="306d5-104">La migración de aplicaciones que usan el Servicio de caché administrado de Azure a Caché en Redis de Azure se puede realizar con unos cambios mínimos en la aplicación, según las características del Servicio de caché administrado usadas por la aplicación de almacenamiento en caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-104">Migrating your applications that use Azure Managed Cache Service to Azure Redis Cache can be accomplished with minimal changes to your application, depending on the Managed Cache Service features used by your caching application.</span></span> <span data-ttu-id="306d5-105">Si bien las API no son exactamente iguales, son parecidas, y gran parte del código existente que usa el Servicio de caché administrado para tener acceso a una caché se puede reutilizar con cambios mínimos.</span><span class="sxs-lookup"><span data-stu-id="306d5-105">While the APIs are not exactly the same they are similar, and much of your existing code that uses Managed Cache Service to access a cache can be reused with minimal changes.</span></span> <span data-ttu-id="306d5-106">En este tema se muestra cómo realizar los cambios de aplicación y configuración necesarios para migrar las aplicaciones de Managed Cache Service y que utilicen Azure Redis Cache, y se indica cómo se pueden usar algunas de las características de Azure Redis Cache para implementar la funcionalidad de una caché de una memoria caché de Managed Cache Service.</span><span class="sxs-lookup"><span data-stu-id="306d5-106">This topic shows how to make the necessary configuration and application changes to migrate your Managed Cache Service applications to use Azure Redis Cache, and shows how some of the features of Azure Redis Cache can be used to implement the functionality of a Managed Cache Service cache.</span></span>

>[!NOTE]
><span data-ttu-id="306d5-107">Managed Cache Service e In-Role Cache se [retiraron](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/) el 30 de noviembre de 2016.</span><span class="sxs-lookup"><span data-stu-id="306d5-107">Managed Cache Service and In-Role Cache were [retired](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/) November 30, 2016.</span></span> <span data-ttu-id="306d5-108">Si desea migrar alguna implementación de In-Role Cache a Azure Redis Cache, puede seguir los pasos que se proporcionan en este artículo.</span><span class="sxs-lookup"><span data-stu-id="306d5-108">If you have any In-Role Cache deployments that you want to migrate to Azure Redis Cache, you can follow the steps in this article.</span></span>

## <a name="migration-steps"></a><span data-ttu-id="306d5-109">Pasos de migración</span><span class="sxs-lookup"><span data-stu-id="306d5-109">Migration Steps</span></span>
<span data-ttu-id="306d5-110">A continuación se describen los pasos necesarios para migrar una aplicación del Servicio de caché administrado para usar Caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="306d5-110">The following steps are required to migrate a Managed Cache Service application to use Azure Redis Cache.</span></span>

* <span data-ttu-id="306d5-111">Asignación de características del Servicio de caché administrado a Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="306d5-111">Map Managed Cache Service features to Azure Redis Cache</span></span>
* <span data-ttu-id="306d5-112">Elegir una oferta de caché</span><span class="sxs-lookup"><span data-stu-id="306d5-112">Choose a Cache Offering</span></span>
* <span data-ttu-id="306d5-113">Creación de una caché</span><span class="sxs-lookup"><span data-stu-id="306d5-113">Create a Cache</span></span>
* <span data-ttu-id="306d5-114">Configuración de los clientes de caché</span><span class="sxs-lookup"><span data-stu-id="306d5-114">Configure the Cache Clients</span></span>
  * <span data-ttu-id="306d5-115">Eliminación de la configuración del Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-115">Remove the Managed Cache Service Configuration</span></span>
  * <span data-ttu-id="306d5-116">Configuración de un cliente de caché mediante el paquete NuGet StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="306d5-116">Configure a cache client using the StackExchange.Redis NuGet Package</span></span>
* <span data-ttu-id="306d5-117">Migración del código del Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-117">Migrate Managed Cache Service code</span></span>
  * <span data-ttu-id="306d5-118">Conexión a la caché mediante la clase ConnectionMultiplexer</span><span class="sxs-lookup"><span data-stu-id="306d5-118">Connect to the cache using the ConnectionMultiplexer class</span></span>
  * <span data-ttu-id="306d5-119">Acceder a tipos de datos primitivos en la caché</span><span class="sxs-lookup"><span data-stu-id="306d5-119">Access primitive data types in the cache</span></span>
  * <span data-ttu-id="306d5-120">Trabajar con objetos .NET en la memoria caché</span><span class="sxs-lookup"><span data-stu-id="306d5-120">Work with .NET objects in the cache</span></span>
* <span data-ttu-id="306d5-121">Migrar el estado de sesión de ASP.NET y el almacenamiento en caché de resultados a Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="306d5-121">Migrate ASP.NET Session State and Output caching to Azure Redis Cache</span></span> 

## <a name="map-managed-cache-service-features-to-azure-redis-cache"></a><span data-ttu-id="306d5-122">Asignación de características del Servicio de caché administrado a Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="306d5-122">Map Managed Cache Service features to Azure Redis Cache</span></span>
<span data-ttu-id="306d5-123">El Servicio de caché administrado de Azure y Caché en Redis de Azure guardan ciertas semejanzas pero implementan algunas de sus características de formas diferentes.</span><span class="sxs-lookup"><span data-stu-id="306d5-123">Azure Managed Cache Service and Azure Redis Cache are similar but implement some of their features in different ways.</span></span> <span data-ttu-id="306d5-124">En esta sección se describen algunas de las diferencias y se proporcionan instrucciones para la implementación de las características del Servicio de caché administrado en Caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="306d5-124">This section describes some of the differences and provides guidance on implementing the features of Managed Cache Service in Azure Redis Cache.</span></span>

| <span data-ttu-id="306d5-125">Características del Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-125">Managed Cache Service feature</span></span> | <span data-ttu-id="306d5-126">Compatibilidad con el Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-126">Managed Cache Service support</span></span> | <span data-ttu-id="306d5-127">Compatibilidad con Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="306d5-127">Azure Redis Cache support</span></span> |
| --- | --- | --- |
| <span data-ttu-id="306d5-128">Cachés con nombre</span><span class="sxs-lookup"><span data-stu-id="306d5-128">Named caches</span></span> |<span data-ttu-id="306d5-129">Se configura una caché predeterminada y, en las ofertas de caché Estándar y Premium, se pueden configurar, si se desea, hasta nueve cachés con nombre adicionales.</span><span class="sxs-lookup"><span data-stu-id="306d5-129">A default cache is configured, and in the Standard and Premium cache offerings, up to nine additional named caches can be configured if desired.</span></span> |<span data-ttu-id="306d5-130">Las instancias de Caché en Redis de Azure tienen un número configurable de bases de datos (valor predeterminado: 16) que pueden utilizarse para implementar una funcionalidad similar a las memorias caché con nombre.</span><span class="sxs-lookup"><span data-stu-id="306d5-130">Azure Redis caches have a configurable number of databases (default of 16) that can be used to implement a similar functionality to named caches.</span></span> <span data-ttu-id="306d5-131">Para obtener más información, consulte [What are Redis databases?](cache-faq.md#what-are-redis-databases) (¿Qué son las bases de datos de Redis?) y [Configuración predeterminada del servidor Redis](cache-configure.md#default-redis-server-configuration).</span><span class="sxs-lookup"><span data-stu-id="306d5-131">For more information, see [What are Redis databases?](cache-faq.md#what-are-redis-databases) and [Default Redis server configuration](cache-configure.md#default-redis-server-configuration).</span></span> |
| <span data-ttu-id="306d5-132">Alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="306d5-132">High Availability</span></span> |<span data-ttu-id="306d5-133">Proporciona alta disponibilidad para los elementos de la caché en las ofertas de caché Estándar y Premium.</span><span class="sxs-lookup"><span data-stu-id="306d5-133">Provides high availability for items in the cache in the Standard and Premium cache offerings.</span></span> <span data-ttu-id="306d5-134">Si los elementos se pierden debido a un error, aún se puede acceder a las copias de seguridad de los elementos en la caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-134">If items are lost due to a failure, backup copies of the items in the cache are still available.</span></span> <span data-ttu-id="306d5-135">Las escrituras en la caché secundaria se realizan de manera sincrónica.</span><span class="sxs-lookup"><span data-stu-id="306d5-135">Writes to the secondary cache are made synchronously.</span></span> |<span data-ttu-id="306d5-136">Existe alta disponibilidad en las ofertas de caché Estándar y Premio, que tienen una configuración de réplica-principal de dos nodos (cada partición de una caché Premium tiene un par de réplica-principal).</span><span class="sxs-lookup"><span data-stu-id="306d5-136">High availability is available in the Standard and Premium cache offerings, which have a two node Primary/Replica configuration (each shard in a Premium cache has a primary/replica pair).</span></span> <span data-ttu-id="306d5-137">Las escrituras en la réplica se realizan de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="306d5-137">Writes to the replica are made asynchronously.</span></span> <span data-ttu-id="306d5-138">Para obtener más información, consulte [Precios de Caché en Redis de Azure](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="306d5-138">For more information, see [Azure Redis Cache pricing](https://azure.microsoft.com/pricing/details/cache/).</span></span> |
| <span data-ttu-id="306d5-139">Notificaciones</span><span class="sxs-lookup"><span data-stu-id="306d5-139">Notifications</span></span> |<span data-ttu-id="306d5-140">Permite a los clientes recibir notificaciones asincrónicas cuando se producen diversas operaciones de caché en una caché con nombre.</span><span class="sxs-lookup"><span data-stu-id="306d5-140">Allows clients to receive asynchronous notifications when a variety of cache operations occur on a named cache.</span></span> |<span data-ttu-id="306d5-141">Las aplicaciones cliente pueden usar pub/sub de Redis o [notificaciones de Keyspace](cache-configure.md#keyspace-notifications-advanced-settings) para lograr una funcionalidad similar a las notificaciones.</span><span class="sxs-lookup"><span data-stu-id="306d5-141">Client applications can use Redis pub/sub or [Keyspace notifications](cache-configure.md#keyspace-notifications-advanced-settings) to achieve a similar functionality to notifications.</span></span> |
| <span data-ttu-id="306d5-142">Caché local</span><span class="sxs-lookup"><span data-stu-id="306d5-142">Local cache</span></span> |<span data-ttu-id="306d5-143">Almacena una copia de los objetos en caché de forma local en el cliente para un acceso a un más rápido.</span><span class="sxs-lookup"><span data-stu-id="306d5-143">Stores a copy of cached objects locally on the client for extra-fast access.</span></span> |<span data-ttu-id="306d5-144">Las aplicaciones cliente deberán implementar esta funcionalidad mediante un diccionario o una estructura de datos parecida.</span><span class="sxs-lookup"><span data-stu-id="306d5-144">Client applications would need to implement this functionality using a dictionary or similar data structure.</span></span> |
| <span data-ttu-id="306d5-145">Directiva de expulsión</span><span class="sxs-lookup"><span data-stu-id="306d5-145">Eviction Policy</span></span> |<span data-ttu-id="306d5-146">Ninguna o LRU.</span><span class="sxs-lookup"><span data-stu-id="306d5-146">None or LRU.</span></span> <span data-ttu-id="306d5-147">La directiva predeterminada es LRU.</span><span class="sxs-lookup"><span data-stu-id="306d5-147">The default policy is LRU.</span></span> |<span data-ttu-id="306d5-148">Caché en Redis de Azure admite las siguientes directivas de expulsión: volatile-lru, allkeys-lru, volatile-random, allkeys-random, volatile-ttl, noeviction.</span><span class="sxs-lookup"><span data-stu-id="306d5-148">Azure Redis Cache supports the following eviction policies: volatile-lru, allkeys-lru, volatile-random, allkeys-random, volatile-ttl, noeviction.</span></span> <span data-ttu-id="306d5-149">La directiva predeterminada es volatile-lru.</span><span class="sxs-lookup"><span data-stu-id="306d5-149">The default policy is volatile-lru.</span></span> <span data-ttu-id="306d5-150">Para obtener más información, consulte [Configuración de servidor predeterminada en Redis](cache-configure.md#default-redis-server-configuration).</span><span class="sxs-lookup"><span data-stu-id="306d5-150">For more information, see [Default Redis server configuration](cache-configure.md#default-redis-server-configuration).</span></span> |
| <span data-ttu-id="306d5-151">Directiva de caducidad</span><span class="sxs-lookup"><span data-stu-id="306d5-151">Expiration Policy</span></span> |<span data-ttu-id="306d5-152">La directiva de caducidad predeterminada es Absoluta y el intervalo de caducidad predeterminado es de diez minutos.</span><span class="sxs-lookup"><span data-stu-id="306d5-152">The default expiration policy is Absolute and the default expiration interval is ten minutes.</span></span> <span data-ttu-id="306d5-153">También hay directivas variable y Nunca.</span><span class="sxs-lookup"><span data-stu-id="306d5-153">Sliding and Never policies are also available.</span></span> |<span data-ttu-id="306d5-154">De forma predeterminada, los elementos de la caché no caducan, pero se puede configurar una caducidad por escritura mediante el uso de sobrecargas de conjunto de caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-154">By default items in the cache do not expire, but an expiration can be configured on a per write basis using cache set overloads.</span></span> <span data-ttu-id="306d5-155">Para obtener más información, consulte [Incorporación y recuperación de objetos en la caché](cache-dotnet-how-to-use-azure-redis-cache.md#add-and-retrieve-objects-from-the-cache).</span><span class="sxs-lookup"><span data-stu-id="306d5-155">For more information, see [Add and retrieve objects from the cache](cache-dotnet-how-to-use-azure-redis-cache.md#add-and-retrieve-objects-from-the-cache).</span></span> |
| <span data-ttu-id="306d5-156">Regiones y etiquetado</span><span class="sxs-lookup"><span data-stu-id="306d5-156">Regions and Tagging</span></span> |<span data-ttu-id="306d5-157">Las regiones son subgrupos de elementos en caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-157">Regions are subgroups for cached items.</span></span> <span data-ttu-id="306d5-158">Las regiones también admiten la anotación de elementos en caché con cadenas descriptivas adicionales llamadas etiquetas.</span><span class="sxs-lookup"><span data-stu-id="306d5-158">Regions also support the annotation of cached items with additional descriptive strings called tags.</span></span> <span data-ttu-id="306d5-159">Además, ofrecen la posibilidad de realizar operaciones de búsqueda en elementos etiquetados en dicha región.</span><span class="sxs-lookup"><span data-stu-id="306d5-159">Regions support the ability to perform search operations on any tagged items in that region.</span></span> <span data-ttu-id="306d5-160">Todos los elementos de una región se encuentran en un único nodo del clúster de caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-160">All items within a region are located within a single node of the cache cluster.</span></span> |<span data-ttu-id="306d5-161">Una caché en Redis consta de un único nodo (a menos que el clúster Redis esté habilitado), por lo que no se aplica el concepto de regiones del Servicio de caché administrado.</span><span class="sxs-lookup"><span data-stu-id="306d5-161">A Redis cache consists of a single node (unless Redis cluster is enabled) so the concept of Managed Cache Service regions does not apply.</span></span> <span data-ttu-id="306d5-162">Redis admite búsqueda y operaciones con caracteres comodín al recuperar claves, de modo que se pueden insertar etiquetas descriptivas en los nombres de clave y usarlas más adelante para recuperar los elementos.</span><span class="sxs-lookup"><span data-stu-id="306d5-162">Redis supports searching and wildcard operations when retrieving keys so descriptive tags can be embedded within the key names and used to retrieve the items later.</span></span> <span data-ttu-id="306d5-163">Para ver un ejemplo de la implementación de una solución de etiquetado con Redis, consulte [Implementing cache tagging with Redis](http://stackify.com/implementing-cache-tagging-redis/)(Implementación del etiquetado de caché con Redis).</span><span class="sxs-lookup"><span data-stu-id="306d5-163">For an example of implementing a tagging solution using Redis, see [Implementing cache tagging with Redis](http://stackify.com/implementing-cache-tagging-redis/).</span></span> |
| <span data-ttu-id="306d5-164">Serialización</span><span class="sxs-lookup"><span data-stu-id="306d5-164">Serialization</span></span> |<span data-ttu-id="306d5-165">La caché administrada admite NetDataContractSerializer, BinaryFormatter y el uso de serializadores personalizados.</span><span class="sxs-lookup"><span data-stu-id="306d5-165">Managed Cache supports NetDataContractSerializer, BinaryFormatter, and the use of custom serializers.</span></span> <span data-ttu-id="306d5-166">El valor predeterminado es NetDataContractSerializer.</span><span class="sxs-lookup"><span data-stu-id="306d5-166">The default is NetDataContractSerializer.</span></span> |<span data-ttu-id="306d5-167">Es responsabilidad de la aplicación cliente serializar los objetos .NET antes de colocarlos en la caché y dejar en manos del desarrollador de la aplicación cliente la elección del serializador.</span><span class="sxs-lookup"><span data-stu-id="306d5-167">It is the responsibility of the client application to serialize .NET objects before placing them into the cache, with the choice of the serializer up to the client application developer.</span></span> <span data-ttu-id="306d5-168">Para obtener más información y ejemplos de código, consulte [Objetos .NET en la caché](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span><span class="sxs-lookup"><span data-stu-id="306d5-168">For more information and sample code, see [Work with .NET objects in the cache](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span></span> |
| <span data-ttu-id="306d5-169">Emulador de caché</span><span class="sxs-lookup"><span data-stu-id="306d5-169">Cache emulator</span></span> |<span data-ttu-id="306d5-170">El servicio de caché administrado ofrece un emulador de la memoria caché local.</span><span class="sxs-lookup"><span data-stu-id="306d5-170">Managed Cache provides a local cache emulator.</span></span> |<span data-ttu-id="306d5-171">Caché en Redis de Azure no tiene un emulador, pero puede [ejecutar la compilación MSOpenTech de server.exe redis localmente](cache-faq.md#cache-emulator) para proporcionar una experiencia de emulador.</span><span class="sxs-lookup"><span data-stu-id="306d5-171">Azure Redis Cache does not have an emulator, but you can [run the MSOpenTech build of redis-server.exe locally](cache-faq.md#cache-emulator) to provide an emulator experience.</span></span> |

## <a name="choose-a-cache-offering"></a><span data-ttu-id="306d5-172">Elegir una oferta de caché</span><span class="sxs-lookup"><span data-stu-id="306d5-172">Choose a Cache Offering</span></span>
<span data-ttu-id="306d5-173">Caché en Redis de Microsoft Azure está disponible en los siguientes niveles:</span><span class="sxs-lookup"><span data-stu-id="306d5-173">Microsoft Azure Redis Cache is available in the following tiers:</span></span>

* <span data-ttu-id="306d5-174">**Básico** – Nodo único.</span><span class="sxs-lookup"><span data-stu-id="306d5-174">**Basic** – Single node.</span></span> <span data-ttu-id="306d5-175">Varios tamaños de hasta 53 GB.</span><span class="sxs-lookup"><span data-stu-id="306d5-175">Multiple sizes up to 53 GB.</span></span>
* <span data-ttu-id="306d5-176">**Estándar**: principal/réplica de dos nodos.</span><span class="sxs-lookup"><span data-stu-id="306d5-176">**Standard** – Two-node Primary/Replica.</span></span> <span data-ttu-id="306d5-177">Varios tamaños de hasta 53 GB.</span><span class="sxs-lookup"><span data-stu-id="306d5-177">Multiple sizes up to 53 GB.</span></span> <span data-ttu-id="306d5-178">Contrato de nivel de servicio del 99,9 %.</span><span class="sxs-lookup"><span data-stu-id="306d5-178">99.9% SLA.</span></span>
* <span data-ttu-id="306d5-179">**Premium** : principal/réplica de dos nodos con hasta 10 particiones.</span><span class="sxs-lookup"><span data-stu-id="306d5-179">**Premium** – Two-node Primary/Replica with up to 10 shards.</span></span> <span data-ttu-id="306d5-180">Varios tamaños, de 6 GB a 530 GB.</span><span class="sxs-lookup"><span data-stu-id="306d5-180">Multiple sizes from 6 GB to 530 GB.</span></span> <span data-ttu-id="306d5-181">Todas las características del nivel Estándar y algunas otras características son compatibles con los [clústeres de Redis](cache-how-to-premium-clustering.md), la [persistencia de Redis](cache-how-to-premium-persistence.md) y [Azure Virtual Network](cache-how-to-premium-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="306d5-181">All Standard tier features and more including support for [Redis cluster](cache-how-to-premium-clustering.md), [Redis persistence](cache-how-to-premium-persistence.md), and [Azure Virtual Network](cache-how-to-premium-vnet.md).</span></span> <span data-ttu-id="306d5-182">Contrato de nivel de servicio del 99,9 %.</span><span class="sxs-lookup"><span data-stu-id="306d5-182">99.9% SLA.</span></span>

<span data-ttu-id="306d5-183">Estos niveles difieren en las características y el precio.</span><span class="sxs-lookup"><span data-stu-id="306d5-183">Each tier differs in terms of features and pricing.</span></span> <span data-ttu-id="306d5-184">Las características se tratan más adelante en esta guía; por otro lado, para obtener más información acerca de los precios consulte [Detalles de precios de caché](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="306d5-184">The features are covered later in this guide, and for more information on pricing, see [Cache Pricing Details](https://azure.microsoft.com/pricing/details/cache/).</span></span>

<span data-ttu-id="306d5-185">Un punto de partida para la migración es seleccionar el tamaño que coincida con el tamaño anterior de la caché del Servicio de caché administrado, y luego escalar o reducir verticalmente en función de los requisitos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="306d5-185">A starting point for migration is to pick the size that matches the size of your previous Managed Cache Service cache, and then scale up or down depending on the requirements of your application.</span></span> <span data-ttu-id="306d5-186">Para obtener instrucciones sobre cómo elegir la oferta correcta de Caché en Redis de Azure, consulte [¿Qué oferta y tamaño de Caché en Redis debo usar?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use).</span><span class="sxs-lookup"><span data-stu-id="306d5-186">For more guidance on choosing the right Azure Redis Cache offering, see [What Redis Cache offering and size should I use?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use).</span></span>

## <a name="create-a-cache"></a><span data-ttu-id="306d5-187">Creación de una caché</span><span class="sxs-lookup"><span data-stu-id="306d5-187">Create a Cache</span></span>
[!INCLUDE [redis-cache-create](../../includes/redis-cache-create.md)]

## <a name="configure-the-cache-clients"></a><span data-ttu-id="306d5-188">Configuración de los clientes de caché</span><span class="sxs-lookup"><span data-stu-id="306d5-188">Configure the Cache Clients</span></span>
<span data-ttu-id="306d5-189">Después de crear y configurar la caché, el siguiente paso consiste en eliminar la configuración del Servicio de caché administrado y agregar la configuración de Caché en Redis de Azure, junto con referencias para que los clientes de caché puedan acceder a ella.</span><span class="sxs-lookup"><span data-stu-id="306d5-189">Once the cache is created and configured, the next step is to remove the Managed Cache Service configuration, and add the add the Azure Redis Cache configuration and references so that cache clients can access the cache.</span></span>

* <span data-ttu-id="306d5-190">Eliminación de la configuración del Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-190">Remove the Managed Cache Service Configuration</span></span>
* <span data-ttu-id="306d5-191">Configuración de un cliente de caché mediante el paquete NuGet StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="306d5-191">Configure a cache client using the StackExchange.Redis NuGet Package</span></span>

### <a name="remove-the-managed-cache-service-configuration"></a><span data-ttu-id="306d5-192">Eliminación de la configuración del Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-192">Remove the Managed Cache Service Configuration</span></span>
<span data-ttu-id="306d5-193">Para que las aplicaciones cliente se puedan configurar para Caché en Redis de Azure, se debe eliminar la configuración y las referencias de ensamblado existentes del Servicio de caché administrado desinstalando el paquete NuGet del Servicio de caché administrado.</span><span class="sxs-lookup"><span data-stu-id="306d5-193">Before the client applications can be configured for Azure Redis Cache, the existing Managed Cache Service configuration and assembly references must be removed by uninstalling the Managed Cache Service NuGet package.</span></span>

<span data-ttu-id="306d5-194">Para desinstalar el paquete de NuGet de Managed Cache Service, haga clic con el botón derecho en el proyecto de cliente en el **Explorador de soluciones** y elija **Administrar paquetes de NuGet**.</span><span class="sxs-lookup"><span data-stu-id="306d5-194">To uninstall the Managed Cache Service NuGet package, right-click the client project in **Solution Explorer** and choose **Manage NuGet Packages**.</span></span> <span data-ttu-id="306d5-195">Seleccione el nodo **Paquetes instalados** y escriba **WindowsAzure.Caching** en el cuadro de búsqueda de paquetes instalados.</span><span class="sxs-lookup"><span data-stu-id="306d5-195">Select the **Installed packages** node, and type W**indowsAzure.Caching** into the Search installed packages box.</span></span> <span data-ttu-id="306d5-196">Seleccione **Windows** **Azure Cache** (o **Windows** **Servicio de almacenamiento en caché de Azure** según la versión del paquete NuGet), haga clic en **Desinstalar** y luego haga clic en **Cerrar**.</span><span class="sxs-lookup"><span data-stu-id="306d5-196">Select **Windows** **Azure Cache** (or **Windows** **Azure Caching** depending on the version of the NuGet package), click **Uninstall**, and then click **Close**.</span></span>

![Desinstalar paquetes NuGet de Azure Managed Cache Service](./media/cache-migrate-to-redis/IC757666.jpg)

<span data-ttu-id="306d5-198">Al desinstalar el paquete NuGet del Servicio de caché administrado se eliminan los ensamblados del Servicio de caché administrado y sus entradas en app.config o web.config de la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="306d5-198">Uninstalling the Managed Cache Service NuGet package removes the Managed Cache Service assemblies and the Managed Cache Service entries in the app.config or web.config of the client application.</span></span> <span data-ttu-id="306d5-199">Como no es posible eliminar algunos valores de configuración personalizados al desinstalar el paquete NuGet, abra web.config o app.config y asegúrese de que los siguientes elementos se han eliminado completamente.</span><span class="sxs-lookup"><span data-stu-id="306d5-199">Because some customized settings may not be removed when uninstalling the NuGet package, open web.config or app.config and ensure that the following elements are completely removed.</span></span>

<span data-ttu-id="306d5-200">Asegúrese de que la entrada `dataCacheClients` se ha eliminado del elemento `configSections`.</span><span class="sxs-lookup"><span data-stu-id="306d5-200">Ensure that the `dataCacheClients` entry is removed from the `configSections` element.</span></span> <span data-ttu-id="306d5-201">No quite el elemento `configSections` entero; solo la entrada `dataCacheClients`, si existe.</span><span class="sxs-lookup"><span data-stu-id="306d5-201">Do not remove the entire `configSections` element; just remove the `dataCacheClients` entry, if it is present.</span></span>

```xml
<configSections>
  <!-- Existing sections omitted for clarity. -->
  <section name="dataCacheClients"type="Microsoft.ApplicationServer.Caching.DataCacheClientsSection, Microsoft.ApplicationServer.Caching.Core" allowLocation="true" allowDefinition="Everywhere"/>
</configSections>
```

<span data-ttu-id="306d5-202">Asegúrese de que la sección `dataCacheClients` esté eliminada.</span><span class="sxs-lookup"><span data-stu-id="306d5-202">Ensure that the `dataCacheClients` section is removed.</span></span> <span data-ttu-id="306d5-203">La sección `dataCacheClients` se parecerá al ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="306d5-203">The `dataCacheClients` section will be similar to the following example.</span></span>

```xml
<dataCacheClients>
  <dataCacheClientname="default">
    <!--To use the in-role flavor of Azure Cache, set identifier to be the cache cluster role name -->
    <!--To use the Azure Managed Cache Service, set identifier to be the endpoint of the cache cluster -->
    <autoDiscoverisEnabled="true"identifier="[Cache role name or Service Endpoint]"/>

    <!--<localCache isEnabled="true" sync="TimeoutBased" objectCount="100000" ttlValue="300" />-->
    <!--Use this section to specify security settings for connecting to your cache. This section is not required if your cache is hosted on a role that is a part of your cloud service. -->
    <!--<securityProperties mode="Message" sslEnabled="true">
      <messageSecurity authorizationInfo="[Authentication Key]" />
    </securityProperties>-->
  </dataCacheClient>
</dataCacheClients>
```

<span data-ttu-id="306d5-204">Después de quitar la configuración del Servicio de caché administrado, puede configurar el cliente de caché como se describe en la siguiente sección.</span><span class="sxs-lookup"><span data-stu-id="306d5-204">Once the Managed Cache Service configuration is removed, you can configure the cache client as described in the following section.</span></span>

### <a name="configure-a-cache-client-using-the-stackexchangeredis-nuget-package"></a><span data-ttu-id="306d5-205">Configuración de un cliente de caché mediante el paquete NuGet StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="306d5-205">Configure a cache client using the StackExchange.Redis NuGet Package</span></span>
[!INCLUDE [redis-cache-configure](../../includes/redis-cache-configure-stackexchange-redis-nuget.md)]

## <a name="migrate-managed-cache-service-code"></a><span data-ttu-id="306d5-206">Migración del código del Servicio de caché administrado</span><span class="sxs-lookup"><span data-stu-id="306d5-206">Migrate Managed Cache Service code</span></span>
<span data-ttu-id="306d5-207">La API del cliente de caché StackExchange.Redis es parecida al Servicio de caché administrado.</span><span class="sxs-lookup"><span data-stu-id="306d5-207">The API for the StackExchange.Redis cache client is similar to the Managed Cache Service.</span></span> <span data-ttu-id="306d5-208">En esta sección se proporciona un resumen de las diferencias.</span><span class="sxs-lookup"><span data-stu-id="306d5-208">This section provides an overview of the differences.</span></span>

### <a name="connect-to-the-cache-using-the-connectionmultiplexer-class"></a><span data-ttu-id="306d5-209">Conexión a la caché mediante la clase ConnectionMultiplexer</span><span class="sxs-lookup"><span data-stu-id="306d5-209">Connect to the cache using the ConnectionMultiplexer class</span></span>
<span data-ttu-id="306d5-210">En el Servicio de caché administrado, las conexiones a la caché se controlan mediante las clases `DataCacheFactory` y `DataCache`.</span><span class="sxs-lookup"><span data-stu-id="306d5-210">In Managed Cache Service, connections to the cache were handled by the `DataCacheFactory` and `DataCache` classes.</span></span> <span data-ttu-id="306d5-211">En Caché en Redis de Azure, estas conexiones se administran con la clase `ConnectionMultiplexer` .</span><span class="sxs-lookup"><span data-stu-id="306d5-211">In Azure Redis Cache, these connections are managed by the `ConnectionMultiplexer` class.</span></span>

<span data-ttu-id="306d5-212">Agregue la siguiente instrucción using en la parte superior de cualquier archivo desde el que desea obtener acceso a la caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-212">Add the following using statement to the top of any file from which you want to access the cache.</span></span>

```c#
using StackExchange.Redis
```

<span data-ttu-id="306d5-213">Si no se resuelve este espacio de nombres, asegúrese de que ha agregado el paquete NuGet StackExchange.Redis, como se describe en [Configuración de los clientes de caché](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span><span class="sxs-lookup"><span data-stu-id="306d5-213">If this namespace doesn’t resolve, be sure that you have added the StackExchange.Redis NuGet package as described in [Configure the cache clients](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span></span>

> [!NOTE]
> <span data-ttu-id="306d5-214">Tenga en cuenta que el cliente StackExchange.Redis requiere .NET Framework 4 o superior.</span><span class="sxs-lookup"><span data-stu-id="306d5-214">Note that the StackExchange.Redis client requires .NET Framework 4 or higher.</span></span>
> 
> 

<span data-ttu-id="306d5-215">Para conectarse a una instancia de Caché en Redis de Azure, llame a método estático `ConnectionMultiplexer.Connect` y pase el punto de conexión y la clave.</span><span class="sxs-lookup"><span data-stu-id="306d5-215">To connect to an Azure Redis Cache instance, call the static `ConnectionMultiplexer.Connect` method and pass in the endpoint and key.</span></span> <span data-ttu-id="306d5-216">Un enfoque para compartir una instancia de `ConnectionMultiplexer` en su aplicación es tener una propiedad estática que devuelva una instancia conectada, como en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="306d5-216">One approach to sharing a `ConnectionMultiplexer` instance in your application is to have a static property that returns a connected instance, similar to the following example.</span></span> <span data-ttu-id="306d5-217">Con ello se proporciona una manera segura para subprocesos de inicializar solo una instancia de `ConnectionMultiplexer` conectada.</span><span class="sxs-lookup"><span data-stu-id="306d5-217">This provides a thread-safe way to initialize only a single connected `ConnectionMultiplexer` instance.</span></span> <span data-ttu-id="306d5-218">En este ejemplo, `abortConnect` se establece en false, lo que significa que la llamada se realizará correctamente incluso si no se establece una conexión a la caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-218">In this example `abortConnect` is set to false, which means that the call will succeed even if a connection to the cache is not established.</span></span> <span data-ttu-id="306d5-219">Una de las características principales de `ConnectionMultiplexer` es que restaura automáticamente la conectividad a la caché una vez que el problema de red u otras causas se resuelven.</span><span class="sxs-lookup"><span data-stu-id="306d5-219">One key feature of `ConnectionMultiplexer` is that it will automatically restore connectivity to the cache once the network issue or other causes are resolved.</span></span>

```c#
private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
{
    return ConnectionMultiplexer.Connect("contoso5.redis.cache.windows.net,abortConnect=false,ssl=true,password=...");
});

public static ConnectionMultiplexer Connection
{
    get
    {
        return lazyConnection.Value;
    }
}
```

<span data-ttu-id="306d5-220">El punto de conexión, las claves y los puertos de la caché se pueden obtener de la hoja **Caché en Redis** de su instancia de caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-220">The cache endpoint, keys, and ports can be obtained from the **Redis Cache** blade for your cache instance.</span></span> <span data-ttu-id="306d5-221">Para obtener más información, consulte [Propiedades de Caché en Redis](cache-configure.md#properties).</span><span class="sxs-lookup"><span data-stu-id="306d5-221">For more information, see [Redis Cache properties](cache-configure.md#properties).</span></span>

<span data-ttu-id="306d5-222">Después de establecer la conexión, devuelva una referencia a la base de datos de Caché en Redis llamando al método `ConnectionMultiplexer.GetDatabase` .</span><span class="sxs-lookup"><span data-stu-id="306d5-222">Once the connection is established, return a reference to the Redis cache database by calling the `ConnectionMultiplexer.GetDatabase` method.</span></span> <span data-ttu-id="306d5-223">El objeto devuelto desde el método `GetDatabase` es un objeto de paso a través ligero y no necesita almacenarse.</span><span class="sxs-lookup"><span data-stu-id="306d5-223">The object returned from the `GetDatabase` method is a lightweight pass-through object and does not need to be stored.</span></span>

```c#
IDatabase cache = Connection.GetDatabase();

// Perform cache operations using the cache object...
// Simple put of integral data types into the cache
cache.StringSet("key1", "value");
cache.StringSet("key2", 25);

// Simple get of data types from the cache
string key1 = cache.StringGet("key1");
int key2 = (int)cache.StringGet("key2");
```

<span data-ttu-id="306d5-224">El cliente StackExchange.Redis usa los tipos `RedisKey` y `RedisValue` para obtener acceso y almacenar elementos en la caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-224">The StackExchange.Redis client uses the `RedisKey` and `RedisValue` types for accessing and storing items in the cache.</span></span> <span data-ttu-id="306d5-225">Estos tipos se asignan a tipos de lenguajes más primitivos, como la cadena, y no suelen usarse directamente.</span><span class="sxs-lookup"><span data-stu-id="306d5-225">These types map onto most primitive language types, including string, and often are not used directly.</span></span> <span data-ttu-id="306d5-226">Las cadenas de Redis son el tipo más básico de valor de Redis y pueden contener muchos tipos de datos, como secuencias binarias serializadas. Aunque es posible que no use el tipo directamente, usará los métodos que contienen `String` en el nombre.</span><span class="sxs-lookup"><span data-stu-id="306d5-226">Redis Strings are the most basic kind of Redis value, and can contain many types of data, including serialized binary streams, and while you may not use the type directly, you will use methods that contain `String` in the name.</span></span> <span data-ttu-id="306d5-227">Para los tipos de datos más primitivos, los elementos se almacenan y recuperan de la caché mediante los métodos `StringSet` y `StringGet`, a menos que vaya a almacenar colecciones u otros tipos de datos de Redis en la caché.</span><span class="sxs-lookup"><span data-stu-id="306d5-227">For most primitive data types you store and retrieve items from the cache using the `StringSet` and `StringGet` methods, unless you are storing collections or other Redis data types in the cache.</span></span> 

<span data-ttu-id="306d5-228">`StringSet` y `StringGet` se parecen mucho a los métodos `Put` y `Get` del Servicio de caché administrado, siendo una de las diferencias principales que antes de establecer y obtener un objeto .NET en la caché se debe serializar primero.</span><span class="sxs-lookup"><span data-stu-id="306d5-228">`StringSet` and `StringGet` are very similar to the Managed Cache Service `Put` and `Get` methods, with one major difference being that before you set and get a .NET object into the cache you must serialize it first.</span></span> 

<span data-ttu-id="306d5-229">Cuando llame a `StringGet`, si el objeto existe, se devuelve y, si no existe, se devuelve null.</span><span class="sxs-lookup"><span data-stu-id="306d5-229">When calling `StringGet`, if the object exists, it is returned, and if it does not, null is returned.</span></span> <span data-ttu-id="306d5-230">En este caso, puede recuperar el valor desde el origen de datos que desee y almacenarlo en la memoria caché para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="306d5-230">In this case you can retrieve the value from the desired data source and store it in the cache for subsequent use.</span></span> <span data-ttu-id="306d5-231">Esto se conoce como patrón cache-aside.</span><span class="sxs-lookup"><span data-stu-id="306d5-231">This is known as the cache-aside pattern.</span></span>

<span data-ttu-id="306d5-232">Para especificar la expiración de un elemento en la memoria caché, use el parámetro `TimeSpan` de `StringSet`.</span><span class="sxs-lookup"><span data-stu-id="306d5-232">To specify the expiration of an item in the cache, use the `TimeSpan` parameter of `StringSet`.</span></span>

```c#
cache.StringSet("key1", "value1", TimeSpan.FromMinutes(90));
```

<span data-ttu-id="306d5-233">Caché en Redis de Azure puede trabajar con objetos .NET, así como con tipos de datos primitivos; sin embargo, antes de poder almacenar en caché un objeto .NET, se debe serializar.</span><span class="sxs-lookup"><span data-stu-id="306d5-233">Azure Redis Cache can work with .NET objects as well as primitive data types, but before a .NET object can be cached it must be serialized.</span></span> <span data-ttu-id="306d5-234">Esta tarea es responsabilidad del desarrollador de la aplicación, lo que le permite</span><span class="sxs-lookup"><span data-stu-id="306d5-234">This is the responsibility of the application developer.</span></span> <span data-ttu-id="306d5-235">tener la flexibilidad de elegir el serializador.</span><span class="sxs-lookup"><span data-stu-id="306d5-235">This gives the developer flexibility in the choice of the serializer.</span></span> <span data-ttu-id="306d5-236">Para obtener más información y ejemplos de código, consulte [Objetos .NET en la caché](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span><span class="sxs-lookup"><span data-stu-id="306d5-236">For more information and sample code, see [Work with .NET objects in the cache](cache-dotnet-how-to-use-azure-redis-cache.md#work-with-net-objects-in-the-cache).</span></span>

## <a name="migrate-aspnet-session-state-and-output-caching-to-azure-redis-cache"></a><span data-ttu-id="306d5-237">Migrar el estado de sesión de ASP.NET y el almacenamiento en caché de resultados a Caché en Redis de Azure</span><span class="sxs-lookup"><span data-stu-id="306d5-237">Migrate ASP.NET Session State and Output caching to Azure Redis Cache</span></span>
<span data-ttu-id="306d5-238">Caché en Redis de Azure cuenta con proveedores de estado de sesión ASP.NET y almacenamiento en caché de los resultados de las páginas.</span><span class="sxs-lookup"><span data-stu-id="306d5-238">Azure Redis Cache has providers for both ASP.NET Session State and Page Output caching.</span></span> <span data-ttu-id="306d5-239">Para migrar la aplicación que usa versiones de estos proveedores del Servicio de caché administrado, elimine primero las secciones existentes de web.config, y luego configure las versiones de los proveedores de Caché en Redis de Azure.</span><span class="sxs-lookup"><span data-stu-id="306d5-239">To migrate your application that uses the Managed Cache Service versions of these providers, first remove the existing sections from your web.config, and then configure the Azure Redis Cache versions of the providers.</span></span> <span data-ttu-id="306d5-240">Para obtener instrucciones sobre cómo usar los proveedores de ASP.NET de Azure Redis Cache, vea [Proveedor de estado de sesión de ASP.NET para Azure Redis Cache](cache-aspnet-session-state-provider.md) y [Proveedor de caché de resultados de ASP.NET para Azure Redis Cache](cache-aspnet-output-cache-provider.md).</span><span class="sxs-lookup"><span data-stu-id="306d5-240">For instructions on using the Azure Redis Cache ASP.NET providers, see [ASP.NET Session State Provider for Azure Redis Cache](cache-aspnet-session-state-provider.md) and [ASP.NET Output Cache Provider for Azure Redis Cache](cache-aspnet-output-cache-provider.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="306d5-241">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="306d5-241">Next steps</span></span>
<span data-ttu-id="306d5-242">Explore la [documentación de Caché en Redis de Azure](https://azure.microsoft.com/documentation/services/cache/) , encontrará tutoriales, ejemplos, vídeos y mucho más.</span><span class="sxs-lookup"><span data-stu-id="306d5-242">Explore the [Azure Redis Cache documentation](https://azure.microsoft.com/documentation/services/cache/) for tutorials, samples, videos, and more.</span></span>

