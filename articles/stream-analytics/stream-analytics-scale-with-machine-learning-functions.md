---
title: "aaaJob escalado con funciones de análisis de transmisiones de Azure y aprendizaje automático de Azure | Documentos de Microsoft"
description: "Obtenga información acerca de cómo tooproperly según la escala de trabajos de análisis de transmisiones (creación de particiones, SU cantidad y más) cuando se utilizan funciones de aprendizaje automático de Azure."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 3fbdfaf7e8e86896c56f1d18bbde3a10bd3dca04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="ebde0-103">Escalado del trabajo de Análisis de transmisiones con funciones de Aprendizaje automático de Azure</span><span class="sxs-lookup"><span data-stu-id="ebde0-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="ebde0-104">A menudo es bastante fácil tooset un trabajo de análisis de transmisiones y ejecutar algunos datos de ejemplo a través de él.</span><span class="sxs-lookup"><span data-stu-id="ebde0-104">It is often quite easy tooset up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="ebde0-105">¿Qué se debe hacer cuando necesitemos toorun Hola mismo trabajo con el mayor volumen de datos?</span><span class="sxs-lookup"><span data-stu-id="ebde0-105">What should we do when we need toorun hello same job with higher data volume?</span></span> <span data-ttu-id="ebde0-106">Requiere que nos toounderstand cómo tooconfigure Hola análisis de transmisiones de trabajo para que se escalará.</span><span class="sxs-lookup"><span data-stu-id="ebde0-106">It requires us toounderstand how tooconfigure hello Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="ebde0-107">En este documento, nos centraremos en aspectos especiales de Hola de análisis de transmisiones de escalado trabajos con funciones de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="ebde0-107">In this document, we will focus on hello special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="ebde0-108">Para obtener información sobre cómo tooscale trabajos de análisis de transmisiones, en general, vea el artículo de hello [escalado de trabajos](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="ebde0-108">For information on how tooscale Stream Analytics jobs in general see hello article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="ebde0-109">¿Qué es una función de Aprendizaje automático de Azure en Análisis de transmisiones?</span><span class="sxs-lookup"><span data-stu-id="ebde0-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="ebde0-110">Una función de aprendizaje automático en análisis de transmisiones puede utilizarse como una llamada de función normal en lenguaje de consulta de análisis de transmisiones de Hola.</span><span class="sxs-lookup"><span data-stu-id="ebde0-110">A Machine Learning function in Stream Analytics can be used like a regular function call in hello Stream Analytics query language.</span></span> <span data-ttu-id="ebde0-111">Sin embargo, detrás de la escena hello, llamadas a funciones hello son realmente las solicitudes de servicio de Web de aprendizaje de máquina de Azure.</span><span class="sxs-lookup"><span data-stu-id="ebde0-111">However, behind hello scene, hello function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="ebde0-112">Compatibilidad con "el procesamiento por lotes" varias filas, que se llama lote mínima de servicios web de aprendizaje de máquina, Hola mismo web llamada API del servicio, tooimprove el rendimiento global.</span><span class="sxs-lookup"><span data-stu-id="ebde0-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in hello same web service API call, tooimprove overall throughput.</span></span> <span data-ttu-id="ebde0-113">Vea Hola siguientes artículos para obtener más detalles; [Funciones de aprendizaje automático de azure en análisis de transmisiones](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) y [servicios Web de Azure Machine Learning](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="ebde0-113">Please see hello following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="ebde0-114">Configuración de un trabajo de Análisis de transmisiones con funciones de Aprendizaje automático</span><span class="sxs-lookup"><span data-stu-id="ebde0-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="ebde0-115">Al configurar una función de aprendizaje automático para el trabajo de análisis de transmisiones, hay dos parámetros tooconsider, tamaño de lote de Hola de llamadas de función de aprendizaje automático de Hola y Hola unidades (SUs) aprovisionados para el trabajo de análisis de transmisiones de Hola de streaming.</span><span class="sxs-lookup"><span data-stu-id="ebde0-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters tooconsider, hello batch size of hello Machine Learning function calls, and hello streaming units (SUs) provisioned for hello Stream Analytics job.</span></span> <span data-ttu-id="ebde0-116">toodetermine Hola los valores adecuados para ello, en primer lugar una decisión debe realizarse entre latencia y rendimiento, es decir, latencia de trabajo de análisis de transmisiones de Hola y el rendimiento de cada SU.</span><span class="sxs-lookup"><span data-stu-id="ebde0-116">toodetermine hello appropriate values for these, first a decision must be made between latency and throughput, that is, latency of hello Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="ebde0-117">SUs siempre se pueden agregar tooa el rendimiento de tooincrease de trabajo de una consulta de análisis de transmisiones bien dividido en particiones, aunque SUs adicionales aumenta el costo de Hola de trabajo en ejecución Hola.</span><span class="sxs-lookup"><span data-stu-id="ebde0-117">SUs may always be added tooa job tooincrease throughput of a well partitioned Stream Analytics query, although additional SUs increases hello cost of running hello job.</span></span>

<span data-ttu-id="ebde0-118">Por lo tanto, es importante toodetermine hello *tolerancia* de latencia en la ejecución de un trabajo de análisis de transmisiones.</span><span class="sxs-lookup"><span data-stu-id="ebde0-118">Therefore it is important toodetermine hello *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="ebde0-119">Naturalmente aumentará la latencia adicional de solicitudes de servicio de aprendizaje automático de Azure en ejecución con el tamaño del lote, que intensificarán latencia Hola de trabajo de análisis de transmisiones de Hola.</span><span class="sxs-lookup"><span data-stu-id="ebde0-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound hello latency of hello Stream Analytics job.</span></span> <span data-ttu-id="ebde0-120">Hola otra parte, si aumenta el tamaño de lote permite tooprocess de trabajo de análisis de transmisiones de Hola * más eventos con hello *tantos* de aprendizaje automático de solicitudes de servicio web.</span><span class="sxs-lookup"><span data-stu-id="ebde0-120">On hello other hand, increasing batch size allows hello Stream Analytics job tooprocess *more events with hello *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="ebde0-121">A menudo el Hola aumento de latencia de aprendizaje automático de servicio web es toohello Sub-lineal aumento del tamaño de lote por lo que es importante tooconsider hello más rentable tamaño de lote para un servicio web de aprendizaje automático en cualquier situación determinada.</span><span class="sxs-lookup"><span data-stu-id="ebde0-121">Often hello increase of Machine Learning web service latency is sub-linear toohello increase of batch size so it is important tooconsider hello most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="ebde0-122">tamaño de lote de Hello predeterminado para el servicio web de hello solicita es 1000 y puede modificarse mediante el uso de hello [API de REST de análisis de transmisiones](https://msdn.microsoft.com/library/mt653706.aspx "API de REST de análisis de transmisiones") o hello [cliente de PowerShell para el análisis de transmisiones](stream-analytics-monitor-and-manage-jobs-use-powershell.md "cliente de PowerShell para el análisis de transmisiones").</span><span class="sxs-lookup"><span data-stu-id="ebde0-122">hello default batch size for hello web service requests is 1000 and may be modified either by using hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or hello [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="ebde0-123">Una vez que se ha determinado un tamaño de lote, Hola cantidad de transmisión por secuencias unidades (SUs) pueden ser determinados, en función de número de Hola de eventos que la función hello necesita tooprocess por segundo.</span><span class="sxs-lookup"><span data-stu-id="ebde0-123">Once a batch size has been determined, hello amount of streaming units (SUs) can be determined, based on hello number of events that hello function needs tooprocess per second.</span></span> <span data-ttu-id="ebde0-124">Para más información sobre el ajuste de las unidades de streaming, consulte [Escalación de trabajos de Stream Analytics](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="ebde0-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="ebde0-125">En general, hay 20 conexiones simultáneas toohello servicio de web de aprendizaje automático para cada 6 SUs, salvo que los trabajos de SU 1 y 3 SU obtendrá 20 conexiones simultáneas también.</span><span class="sxs-lookup"><span data-stu-id="ebde0-125">In general, there are 20 concurrent connections toohello Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="ebde0-126">Por ejemplo, si es de velocidad de datos de entrada de Hola 200.000 eventos por segundo y se deja el tamaño del lote de hello toohello predeterminado de latencia de servicio web resultante de 1000 de hello con lotes de 1000 eventos mínima es de 200 milisegundos.</span><span class="sxs-lookup"><span data-stu-id="ebde0-126">For example, if hello input data rate is 200,000 events per second and hello batch size is left toohello default of 1000 hello resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="ebde0-127">Esto significa que cada conexión puede realizar servicio web de aprendizaje automático de toohello de 5 solicitudes en un segundo.</span><span class="sxs-lookup"><span data-stu-id="ebde0-127">This means every connection can make 5 requests toohello Machine Learning web service in a second.</span></span> <span data-ttu-id="ebde0-128">Con 20 conexiones, trabajo de análisis de transmisiones de hello puede procesar 20.000 eventos en 200ms y, por tanto, de 100.000 eventos en un segundo.</span><span class="sxs-lookup"><span data-stu-id="ebde0-128">With 20 connections, hello Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="ebde0-129">¿Tooprocess 200.000 eventos por segundo, trabajo de análisis de transmisiones de Hola que necesita 40 conexiones simultáneas, que se reciben SUs too12.</span><span class="sxs-lookup"><span data-stu-id="ebde0-129">So tooprocess 200,000 events per second, hello Stream Analytics job needs 40 concurrent connections, which comes out too12 SUs.</span></span> <span data-ttu-id="ebde0-130">Hola diagrama siguiente muestra las solicitudes de Hola de extremo de servicio web de hello análisis de transmisiones trabajo toohello aprendizaje automático: cada SUs de 6 tiene servicio de web de aprendizaje de tooMachine de 20 conexiones simultáneas como máximo.</span><span class="sxs-lookup"><span data-stu-id="ebde0-130">hello diagram below illustrates hello requests from hello Stream Analytics job toohello Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections tooMachine Learning web service at max.</span></span>

<span data-ttu-id="ebde0-131">![Ejemplo de escalado de trabajo de Stream Analytics con funciones de Machine Learning 2](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Ejemplo de escalado de trabajo de Stream Analytics con funciones de Machine Learning 2")</span><span class="sxs-lookup"><span data-stu-id="ebde0-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="ebde0-132">En general, ***B*** para el tamaño de lote, ***L*** de latencia de servicio de web hello en el tamaño del lote B en milisegundos, Hola el rendimiento de un trabajo de análisis de transmisiones con ***N*** SUs es:</span><span class="sxs-lookup"><span data-stu-id="ebde0-132">In general, ***B*** for batch size, ***L*** for hello web service latency at batch size B in milliseconds, hello throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="ebde0-133">![Fórmula de escalado de Stream Analytics con funciones de Machine Learning](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Fórmula de escalado de Stream Analytics con funciones de Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="ebde0-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="ebde0-134">Una consideración adicional puede ser hello 'máximo de llamadas concurrentes' en hello lado de servicio web de aprendizaje automático, se recomienda tooset este valor máximo de toohello (200 actualmente).</span><span class="sxs-lookup"><span data-stu-id="ebde0-134">An additional consideration may be hello 'max concurrent calls' on hello Machine Learning web service side, it’s recommended tooset this toohello maximum value (200 currently).</span></span>

<span data-ttu-id="ebde0-135">Para obtener más información sobre esta configuración, consulte hello [artículo de ajuste de escala para servicios Web de aprendizaje de máquina](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="ebde0-135">For more information on this setting please review hello [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="ebde0-136">Ejemplo: Análisis de opiniones</span><span class="sxs-lookup"><span data-stu-id="ebde0-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="ebde0-137">Hello en el ejemplo siguiente se incluye un trabajo de análisis de transmisiones con análisis de opiniones Hola función de aprendizaje automático, como se describe en hello [tutorial de integración de aprendizaje automático de análisis de transmisiones](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="ebde0-137">hello following example includes a Stream Analytics job with hello sentiment analysis Machine Learning function, as described in hello [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="ebde0-138">Hello consulta es una consulta de totalmente con particiones simple seguida de hello **opiniones** funcione, tal y como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="ebde0-138">hello query is a simple fully partitioned query followed by hello **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="ebde0-139">Considere la posibilidad de hello siguiendo escenario; con un rendimiento de 10.000 tweets por segundo un trabajo de análisis de transmisiones debe crearse tooperform análisis de opiniones de tweets de hello (eventos).</span><span class="sxs-lookup"><span data-stu-id="ebde0-139">Consider hello following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created tooperform sentiment analysis of hello tweets (events).</span></span> <span data-ttu-id="ebde0-140">¿Con 1 SU, este trabajo de análisis de transmisiones pudo toohandle capaz de tráfico de hello?</span><span class="sxs-lookup"><span data-stu-id="ebde0-140">Using 1 SU, could this Stream Analytics job be able toohandle hello traffic?</span></span> <span data-ttu-id="ebde0-141">Usando tamaño predeterminado del lote Hola de trabajo de hello 1000 debe ser tookeep capaz de seguridad con la Ayuda de Hola.</span><span class="sxs-lookup"><span data-stu-id="ebde0-141">Using hello default batch size of 1000 hello job should be able tookeep up with hello input.</span></span> <span data-ttu-id="ebde0-142">Hola más agrega la función de aprendizaje automático debe generar más de un segundo de latencia, que es la latencia de predeterminado general Hola de análisis de opiniones Hola servicio web de aprendizaje automático (con un tamaño de lote de predeterminado de 1000).</span><span class="sxs-lookup"><span data-stu-id="ebde0-142">Further hello added Machine Learning function should generate no more than a second of latency, which is hello general default latency of hello sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="ebde0-143">del trabajo de análisis de transmisiones de Hello **general** o latencia to-end normalmente sería de unos segundos.</span><span class="sxs-lookup"><span data-stu-id="ebde0-143">hello Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="ebde0-144">Eche un vistazo más detallado en este trabajo de análisis de transmisiones, *especialmente* Hola llamadas de función de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="ebde0-144">Take a more detailed look into this Stream Analytics job, *especially* hello Machine Learning function calls.</span></span> <span data-ttu-id="ebde0-145">Con el tamaño del lote de Hola de 1000, un rendimiento de 10.000 eventos tardará unos 10 solicitudes tooweb servicio.</span><span class="sxs-lookup"><span data-stu-id="ebde0-145">Having hello batch size as 1000, a throughput of 10,000 events will take about 10 requests tooweb service.</span></span> <span data-ttu-id="ebde0-146">Incluso con 1 SU, no hay suficientes conexiones simultáneas tooaccommodate este tráfico de entrada.</span><span class="sxs-lookup"><span data-stu-id="ebde0-146">Even with 1 SU, there are enough concurrent connections tooaccommodate this input traffic.</span></span>

<span data-ttu-id="ebde0-147">Pero ¿qué ocurre si aumenta la velocidad de los eventos de entrada Hola x 100 y ahora el trabajo de análisis de transmisiones de hello necesita tooprocess 1.000.000 tweets por segundo?</span><span class="sxs-lookup"><span data-stu-id="ebde0-147">But what if hello input event rate increases by 100x and now hello Stream Analytics job needs tooprocess 1,000,000 tweets per second?</span></span> <span data-ttu-id="ebde0-148">Hay dos opciones:</span><span class="sxs-lookup"><span data-stu-id="ebde0-148">There are two options:</span></span>

1. <span data-ttu-id="ebde0-149">Aumentar el tamaño del lote de hello, o</span><span class="sxs-lookup"><span data-stu-id="ebde0-149">Increase hello batch size, or</span></span>
2. <span data-ttu-id="ebde0-150">Tooprocess de flujo de entrada de partición Hola Hola eventos en paralelo</span><span class="sxs-lookup"><span data-stu-id="ebde0-150">Partition hello input stream tooprocess hello events in parallel</span></span>

<span data-ttu-id="ebde0-151">Con la primera opción hello, Hola trabajo **latencia** aumentará.</span><span class="sxs-lookup"><span data-stu-id="ebde0-151">With hello first option, hello job **latency** will increase.</span></span>

<span data-ttu-id="ebde0-152">Con la segunda opción hello, SUs más se necesita toobe aprovisionar y, por tanto, genere simultáneas más solicitudes de servicio web de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="ebde0-152">With hello second option, more SUs would need toobe provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="ebde0-153">Esto significa que el trabajo de hello **costo** aumentará.</span><span class="sxs-lookup"><span data-stu-id="ebde0-153">This means hello job **cost** will increase.</span></span>

<span data-ttu-id="ebde0-154">Suponga latencia Hola de análisis de opiniones Hola servicio web de aprendizaje automático es de 200 milisegundos para lotes de 1000 eventos o por debajo, 250ms en lotes de 5.000-event, 300 ms de lotes de 10.000 eventos o 500 ms para lotes de 25.000-event.</span><span class="sxs-lookup"><span data-stu-id="ebde0-154">Assume hello latency of hello sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="ebde0-155">Con la primera opción hello, (**no** SUs más de aprovisionamiento), podría aumentar el tamaño del lote de hello demasiado**25.000**.</span><span class="sxs-lookup"><span data-stu-id="ebde0-155">Using hello first option, (**not** provisioning more SUs), hello batch size could be increased too**25,000**.</span></span> <span data-ttu-id="ebde0-156">Esto a su vez le permitiría Hola trabajo tooprocess 1.000.000 eventos con 20 conexiones simultáneas toohello servicio web de aprendizaje automático (con una latencia de 500 ms por llamada).</span><span class="sxs-lookup"><span data-stu-id="ebde0-156">This in turn would allow hello job tooprocess 1,000,000 events with 20 concurrent connections toohello Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="ebde0-157">Por lo tanto Hola latencia adicional de trabajo de análisis de transmisiones de hello debido a las solicitudes de función de toohello opiniones contra Hola aprendizaje automático de solicitudes de servicio web se aumentará de **200ms** demasiado**500 ms**.</span><span class="sxs-lookup"><span data-stu-id="ebde0-157">So hello additional latency of hello Stream Analytics job due toohello sentiment function requests against hello Machine Learning web service requests would be increased from **200ms** too**500ms**.</span></span> <span data-ttu-id="ebde0-158">Sin embargo, tenga en cuenta que el tamaño por lotes **no** aumentarse infinitamente como servicios web de aprendizaje automático de hello requieren Hola de tamaño de carga de una solicitud de 4 MB o web menor tiempo de espera de las solicitudes de servicio después de 100 segundos de la operación.</span><span class="sxs-lookup"><span data-stu-id="ebde0-158">However, note that batch size **cannot** be increased infinitely as hello Machine Learning web services requires hello payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="ebde0-159">Con la segunda opción de hello, el tamaño del lote de Hola se deja como 1000, con una latencia de servicio web 200ms, todos los servicios web toohello 20 conexiones simultáneas sería capaz de tooprocess 1000 * 20 * 5 eventos = 100.000 por segundo.</span><span class="sxs-lookup"><span data-stu-id="ebde0-159">Using hello second option, hello batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections toohello web service would be able tooprocess 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="ebde0-160">Por lo que tooprocess 1.000.000 eventos por segundo, trabajo Hola necesitaría 60 SUs.</span><span class="sxs-lookup"><span data-stu-id="ebde0-160">So tooprocess 1,000,000 events per second, hello job would need 60 SUs.</span></span> <span data-ttu-id="ebde0-161">Primera opción toohello comparados, análisis de flujo de trabajo podría hacer más web las solicitudes de servicio por lotes, a su vez generando un aumento del costo.</span><span class="sxs-lookup"><span data-stu-id="ebde0-161">Compared toohello first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="ebde0-162">A continuación se muestra una tabla para el rendimiento del trabajo de análisis de transmisiones de Hola Hola para SUs diferentes y tamaños de lote (en número de eventos por segundo).</span><span class="sxs-lookup"><span data-stu-id="ebde0-162">Below is a table for hello throughput of hello Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="ebde0-163">Tamaño del lote (latencia de Aprendizaje automático)</span><span class="sxs-lookup"><span data-stu-id="ebde0-163">batch size (ML latency)</span></span> | <span data-ttu-id="ebde0-164">500 (200 ms)</span><span class="sxs-lookup"><span data-stu-id="ebde0-164">500 (200ms)</span></span> | <span data-ttu-id="ebde0-165">1000 (200 ms)</span><span class="sxs-lookup"><span data-stu-id="ebde0-165">1,000 (200ms)</span></span> | <span data-ttu-id="ebde0-166">5000 (250 ms)</span><span class="sxs-lookup"><span data-stu-id="ebde0-166">5,000 (250ms)</span></span> | <span data-ttu-id="ebde0-167">10 000 (300 ms)</span><span class="sxs-lookup"><span data-stu-id="ebde0-167">10,000 (300ms)</span></span> | <span data-ttu-id="ebde0-168">25 000 (500 ms)</span><span class="sxs-lookup"><span data-stu-id="ebde0-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="ebde0-169">**1 unidad de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-169">**1 SU**</span></span> |<span data-ttu-id="ebde0-170">2500</span><span class="sxs-lookup"><span data-stu-id="ebde0-170">2,500</span></span> |<span data-ttu-id="ebde0-171">5.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-171">5,000</span></span> |<span data-ttu-id="ebde0-172">20.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-172">20,000</span></span> |<span data-ttu-id="ebde0-173">30 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-173">30,000</span></span> |<span data-ttu-id="ebde0-174">50.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-174">50,000</span></span> |
| <span data-ttu-id="ebde0-175">**3 unidades de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-175">**3 SUs**</span></span> |<span data-ttu-id="ebde0-176">2500</span><span class="sxs-lookup"><span data-stu-id="ebde0-176">2,500</span></span> |<span data-ttu-id="ebde0-177">5.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-177">5,000</span></span> |<span data-ttu-id="ebde0-178">20.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-178">20,000</span></span> |<span data-ttu-id="ebde0-179">30 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-179">30,000</span></span> |<span data-ttu-id="ebde0-180">50.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-180">50,000</span></span> |
| <span data-ttu-id="ebde0-181">**6 unidades de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-181">**6 SUs**</span></span> |<span data-ttu-id="ebde0-182">2500</span><span class="sxs-lookup"><span data-stu-id="ebde0-182">2,500</span></span> |<span data-ttu-id="ebde0-183">5.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-183">5,000</span></span> |<span data-ttu-id="ebde0-184">20.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-184">20,000</span></span> |<span data-ttu-id="ebde0-185">30 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-185">30,000</span></span> |<span data-ttu-id="ebde0-186">50.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-186">50,000</span></span> |
| <span data-ttu-id="ebde0-187">**12 unidades de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-187">**12 SUs**</span></span> |<span data-ttu-id="ebde0-188">5.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-188">5,000</span></span> |<span data-ttu-id="ebde0-189">10.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-189">10,000</span></span> |<span data-ttu-id="ebde0-190">40.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-190">40,000</span></span> |<span data-ttu-id="ebde0-191">60 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-191">60,000</span></span> |<span data-ttu-id="ebde0-192">100 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-192">100,000</span></span> |
| <span data-ttu-id="ebde0-193">**18 unidades de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-193">**18 SUs**</span></span> |<span data-ttu-id="ebde0-194">7500</span><span class="sxs-lookup"><span data-stu-id="ebde0-194">7,500</span></span> |<span data-ttu-id="ebde0-195">15 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-195">15,000</span></span> |<span data-ttu-id="ebde0-196">60 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-196">60,000</span></span> |<span data-ttu-id="ebde0-197">90 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-197">90,000</span></span> |<span data-ttu-id="ebde0-198">150 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-198">150,000</span></span> |
| <span data-ttu-id="ebde0-199">**24 unidades de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-199">**24 SUs**</span></span> |<span data-ttu-id="ebde0-200">10.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-200">10,000</span></span> |<span data-ttu-id="ebde0-201">20.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-201">20,000</span></span> |<span data-ttu-id="ebde0-202">80 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-202">80,000</span></span> |<span data-ttu-id="ebde0-203">120 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-203">120,000</span></span> |<span data-ttu-id="ebde0-204">200 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-204">200,000</span></span> |
| <span data-ttu-id="ebde0-205">**…**</span><span class="sxs-lookup"><span data-stu-id="ebde0-205">**…**</span></span> |<span data-ttu-id="ebde0-206">…</span><span class="sxs-lookup"><span data-stu-id="ebde0-206">…</span></span> |<span data-ttu-id="ebde0-207">…</span><span class="sxs-lookup"><span data-stu-id="ebde0-207">…</span></span> |<span data-ttu-id="ebde0-208">…</span><span class="sxs-lookup"><span data-stu-id="ebde0-208">…</span></span> |<span data-ttu-id="ebde0-209">…</span><span class="sxs-lookup"><span data-stu-id="ebde0-209">…</span></span> |<span data-ttu-id="ebde0-210">…</span><span class="sxs-lookup"><span data-stu-id="ebde0-210">…</span></span> |
| <span data-ttu-id="ebde0-211">**60 unidades de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="ebde0-211">**60 SUs**</span></span> |<span data-ttu-id="ebde0-212">25 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-212">25,000</span></span> |<span data-ttu-id="ebde0-213">50.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-213">50,000</span></span> |<span data-ttu-id="ebde0-214">200 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-214">200,000</span></span> |<span data-ttu-id="ebde0-215">300 000</span><span class="sxs-lookup"><span data-stu-id="ebde0-215">300,000</span></span> |<span data-ttu-id="ebde0-216">500.000</span><span class="sxs-lookup"><span data-stu-id="ebde0-216">500,000</span></span> |

<span data-ttu-id="ebde0-217">En este momento, ya debe saber cómo funcionan las funciones de Aprendizaje automático en Análisis de transmisiones.</span><span class="sxs-lookup"><span data-stu-id="ebde0-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="ebde0-218">También es probable que entender que los trabajos de análisis de transmisiones "pull" datos de orígenes de datos y cada "pull" devuelven un lote de eventos de Hola tooprocess de trabajo de análisis de transmisiones.</span><span class="sxs-lookup"><span data-stu-id="ebde0-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for hello Stream Analytics job tooprocess.</span></span> <span data-ttu-id="ebde0-219">¿Cómo afecta este modelo de extracción a solicitudes de servicio de web de aprendizaje automático de hello?</span><span class="sxs-lookup"><span data-stu-id="ebde0-219">How does this pull model impact hello Machine Learning web service requests?</span></span>

<span data-ttu-id="ebde0-220">Normalmente, tamaño del lote Hola que establecemos para las funciones de aprendizaje automático exactamente no es divisible por número de Hola de eventos devueltos por cada trabajo de análisis de transmisiones "pull".</span><span class="sxs-lookup"><span data-stu-id="ebde0-220">Normally, hello batch size we set for Machine Learning functions won’t exactly be divisible by hello number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="ebde0-221">Cuando esto ocurre Hola servicio web de aprendizaje automático se llamará con lotes "parciales".</span><span class="sxs-lookup"><span data-stu-id="ebde0-221">When this occurs hello Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="ebde0-222">Esto se hace toonot producir una latencia de trabajos adicionales sobrecarga en los eventos de uso combinados de toopull de extracción.</span><span class="sxs-lookup"><span data-stu-id="ebde0-222">This is done toonot incur additional job latency overhead in coalescing events from pull toopull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="ebde0-223">Nuevas métricas de supervisión relacionadas con la función</span><span class="sxs-lookup"><span data-stu-id="ebde0-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="ebde0-224">En el área del Monitor de un trabajo de análisis de transmisiones de hello, se han agregado tres métricas adicionales relacionadas con la función.</span><span class="sxs-lookup"><span data-stu-id="ebde0-224">In hello Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="ebde0-225">Son las solicitudes de función, eventos de funciones y errores de solicitud de función, como se muestra en el gráfico de hello siguiente.</span><span class="sxs-lookup"><span data-stu-id="ebde0-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in hello graphic below.</span></span>

<span data-ttu-id="ebde0-226">![Métricas de escalado de Stream Analytics con funciones de Machine Learning](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Métricas de escalado de Stream Analytics con funciones de Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="ebde0-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="ebde0-227">Hola se definen como sigue:</span><span class="sxs-lookup"><span data-stu-id="ebde0-227">hello are defined as follows:</span></span>

<span data-ttu-id="ebde0-228">**Las solicitudes de la función**: Hola número de solicitudes de función.</span><span class="sxs-lookup"><span data-stu-id="ebde0-228">**FUNCTION REQUESTS**: hello number of function requests.</span></span>

<span data-ttu-id="ebde0-229">**EVENTOS de funciones**: número de eventos de Hola Hola función solicitudes.</span><span class="sxs-lookup"><span data-stu-id="ebde0-229">**FUNCTION EVENTS**: hello number events in hello function requests.</span></span>

<span data-ttu-id="ebde0-230">**ERRORES de solicitud de función**: Hola número de solicitudes de función con errores.</span><span class="sxs-lookup"><span data-stu-id="ebde0-230">**FAILED FUNCTION REQUESTS**: hello number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="ebde0-231">Puntos clave</span><span class="sxs-lookup"><span data-stu-id="ebde0-231">Key Takeaways</span></span>
<span data-ttu-id="ebde0-232">toosummarize puntos principales de hello, en orden tooscale un trabajo de análisis de transmisiones con funciones de aprendizaje automático, hello siguientes elementos deben tener en cuenta:</span><span class="sxs-lookup"><span data-stu-id="ebde0-232">toosummarize hello main points, in order tooscale an Stream Analytics job with Machine Learning functions, hello following items must be considered:</span></span>

1. <span data-ttu-id="ebde0-233">velocidad de los eventos de entrada Hola</span><span class="sxs-lookup"><span data-stu-id="ebde0-233">hello input event rate</span></span>
2. <span data-ttu-id="ebde0-234">Hola tolera latencia para ejecutar el trabajo de análisis de transmisiones de hello (y, por tanto, solicita el tamaño de lote de Hola de servicio web de aprendizaje automático de hello)</span><span class="sxs-lookup"><span data-stu-id="ebde0-234">hello tolerated latency for hello running Stream Analytics job (and thus hello batch size of hello Machine Learning web service requests)</span></span>
3. <span data-ttu-id="ebde0-235">Hola aprovisionado SUs análisis de secuencia y el número de Hola de solicitudes de servicio web de aprendizaje automático (Hola relacionados con la función costes adicionales)</span><span class="sxs-lookup"><span data-stu-id="ebde0-235">hello provisioned Stream Analytics SUs and hello number of Machine Learning web service requests (hello additional function-related costs)</span></span>

<span data-ttu-id="ebde0-236">Como ejemplo se ha utilizado una consulta de Análisis de transmisiones totalmente particionada.</span><span class="sxs-lookup"><span data-stu-id="ebde0-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="ebde0-237">Si se necesita una consulta más compleja hello [foro de análisis de transmisiones de Azure](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) es un excelente recurso para obtener ayuda adicional en el equipo de análisis de transmisiones de Hola.</span><span class="sxs-lookup"><span data-stu-id="ebde0-237">If a more complex query is needed hello [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from hello Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ebde0-238">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="ebde0-238">Next steps</span></span>
<span data-ttu-id="ebde0-239">toolearn más información sobre análisis de transmisiones, consulte:</span><span class="sxs-lookup"><span data-stu-id="ebde0-239">toolearn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="ebde0-240">Introducción al uso de Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="ebde0-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="ebde0-241">Escalación de trabajos de Análisis de transmisiones de Azure</span><span class="sxs-lookup"><span data-stu-id="ebde0-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="ebde0-242">Referencia del lenguaje de consulta de Análisis de transmisiones de Azure</span><span class="sxs-lookup"><span data-stu-id="ebde0-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="ebde0-243">Referencia de API de REST de administración de Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="ebde0-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
