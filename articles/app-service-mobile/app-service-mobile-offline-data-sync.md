---
title: "Sincronización de datos sin conexión en Azure Mobile Apps | Microsoft Docs"
description: "Referencia e información general conceptual de la característica de sincronización de datos sin conexión para Aplicaciones móviles de Azure"
documentationcenter: windows
author: ggailey777
manager: syntaxc4
editor: 
services: app-service\mobile
ms.assetid: 982fb683-8884-40da-96e6-77eeca2500e3
ms.service: app-service-mobile
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 10/30/2016
ms.author: glenga
ms.openlocfilehash: 8e2bd755d14319f8c66f7ae7ec64fbd10801b39d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/29/2017
---
# <a name="offline-data-sync-in-azure-mobile-apps"></a><span data-ttu-id="4160e-103">Sincronización de datos sin conexión en Aplicaciones móviles de Azure</span><span class="sxs-lookup"><span data-stu-id="4160e-103">Offline Data Sync in Azure Mobile Apps</span></span>
## <a name="what-is-offline-data-sync"></a><span data-ttu-id="4160e-104">¿Qué es la sincronización de datos sin conexión?</span><span class="sxs-lookup"><span data-stu-id="4160e-104">What is offline data sync?</span></span>
<span data-ttu-id="4160e-105">La sincronización de datos sin conexión es una característica de SDK de cliente y de servidor de Aplicaciones móviles de Azure que facilita a los desarrolladores la creación de aplicaciones que funcionen sin una conexión de red.</span><span class="sxs-lookup"><span data-stu-id="4160e-105">Offline data sync is a client and server SDK feature of Azure Mobile Apps that makes it easy for developers to create apps that are functional without a network connection.</span></span>

<span data-ttu-id="4160e-106">Cuando la aplicación está en modo sin conexión, aún se pueden crear y modificar datos, que se guardan en un almacén local.</span><span class="sxs-lookup"><span data-stu-id="4160e-106">When your app is in offline mode, you can still create and modify data, which are saved to a local store.</span></span> <span data-ttu-id="4160e-107">Cuando la aplicación se vuelve a conectar, esta puede sincronizar los cambios locales con el back-end de la aplicación de Azure.</span><span class="sxs-lookup"><span data-stu-id="4160e-107">When the app is back online, it can synchronize local changes with your Azure Mobile App backend.</span></span> <span data-ttu-id="4160e-108">La característica también admite la detección de conflictos cuando se cambia el mismo registro en el cliente y el back-end.</span><span class="sxs-lookup"><span data-stu-id="4160e-108">The feature also includes support for detecting conflicts when the same record is changed on both the client and the backend.</span></span> <span data-ttu-id="4160e-109">Luego, los conflictos se pueden manejar en el servidor o el cliente.</span><span class="sxs-lookup"><span data-stu-id="4160e-109">Conflicts can then be handled either on the server or the client.</span></span>

<span data-ttu-id="4160e-110">La sincronización sin conexión tiene varias ventajas:</span><span class="sxs-lookup"><span data-stu-id="4160e-110">Offline sync has several benefits:</span></span>

* <span data-ttu-id="4160e-111">Mejore la capacidad de respuesta de las aplicaciones almacenando en caché datos de servidor de forma local en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4160e-111">Improve app responsiveness by caching server data locally on the device</span></span>
* <span data-ttu-id="4160e-112">Creación de aplicaciones sólidas que sigan siendo útiles cuando hay problemas de red</span><span class="sxs-lookup"><span data-stu-id="4160e-112">Create robust apps that remain useful when there are network issues</span></span>
* <span data-ttu-id="4160e-113">Permitir a los usuarios finales crear y modificar datos incluso cuando no hay acceso de red, proporcionando escenarios con muy poca o ninguna conectividad.</span><span class="sxs-lookup"><span data-stu-id="4160e-113">Allow end users to create and modify data even when there is no network access, supporting scenarios with little or no connectivity</span></span>
* <span data-ttu-id="4160e-114">Sincronizar datos entre diferentes dispositivos y detectar conflictos cuando dos dispositivos modifican el mismo registro.</span><span class="sxs-lookup"><span data-stu-id="4160e-114">Sync data across multiple devices and detect conflicts when the same record is modified by two devices</span></span>
* <span data-ttu-id="4160e-115">Limitar el uso de las redes medidas o de alta latencia</span><span class="sxs-lookup"><span data-stu-id="4160e-115">Limit network use on high-latency or metered networks</span></span>

<span data-ttu-id="4160e-116">Los siguientes tutoriales muestran cómo incorporar la sincronización sin conexión a los clientes móviles con Aplicaciones móviles de Azure:</span><span class="sxs-lookup"><span data-stu-id="4160e-116">The following tutorials show how to add offline sync to your mobile clients using Azure Mobile Apps:</span></span>

* <span data-ttu-id="4160e-117">[Android: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-117">[Android: Enable offline sync]</span></span>
* [<span data-ttu-id="4160e-118">Apache Cordova: habilitación de la sincronización sin conexión</span><span class="sxs-lookup"><span data-stu-id="4160e-118">Apache Cordova: Enable offline sync</span></span>](app-service-mobile-cordova-get-started-offline-data.md)
* <span data-ttu-id="4160e-119">[iOS: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-119">[iOS: Enable offline sync]</span></span>
* <span data-ttu-id="4160e-120">[Xamarin iOS: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-120">[Xamarin iOS: Enable offline sync]</span></span>
* <span data-ttu-id="4160e-121">[Xamarin Android: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-121">[Xamarin Android: Enable offline sync]</span></span>
* [<span data-ttu-id="4160e-122">Xamarin.Forms: habilitar la sincronización sin conexión</span><span class="sxs-lookup"><span data-stu-id="4160e-122">Xamarin.Forms: Enable offline sync</span></span>](app-service-mobile-xamarin-forms-get-started-offline-data.md)
* <span data-ttu-id="4160e-123">[Plataforma universal de Windows: habilitación de la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-123">[Universal Windows Platform: Enable offline sync]</span></span>

## <a name="what-is-a-sync-table"></a><span data-ttu-id="4160e-124">¿Qué es una tabla de sincronización?</span><span class="sxs-lookup"><span data-stu-id="4160e-124">What is a sync table?</span></span>
<span data-ttu-id="4160e-125">Para tener acceso al extremo de "/tables", los SDK de cliente móvil de Azure proporcionan interfaces como `IMobileServiceTable` (SDK de cliente de .NET) o `MSTable` (cliente de iOS).</span><span class="sxs-lookup"><span data-stu-id="4160e-125">To access the "/tables" endpoint, the Azure Mobile client SDKs provide interfaces such as `IMobileServiceTable` (.NET client SDK) or `MSTable` (iOS client).</span></span> <span data-ttu-id="4160e-126">Estas API se conectan directamente al back-end de la aplicación móvil de Azure y generan errores si el dispositivo cliente no tiene una conexión de red.</span><span class="sxs-lookup"><span data-stu-id="4160e-126">These APIs connect directly to the Azure Mobile App backend and fail if the client device does not have a network connection.</span></span>

<span data-ttu-id="4160e-127">Para admitir el uso sin conexión, la aplicación debe usar las API de la *tabla de sincronización*, como `IMobileServiceSyncTable` (SDK de cliente de .NET) o `MSSyncTable` (cliente de iOS).</span><span class="sxs-lookup"><span data-stu-id="4160e-127">To support offline use, your app should instead use the *sync table* APIs, such as `IMobileServiceSyncTable` (.NET client SDK) or `MSSyncTable` (iOS client).</span></span> <span data-ttu-id="4160e-128">Las mismas operaciones CRUD (creación, lectura, actualización, eliminación) funcionan con las API de la tabla de sincronización, salvo que ahora leerán desde un *almacén local* o escribirán en él.</span><span class="sxs-lookup"><span data-stu-id="4160e-128">All the same CRUD operations (Create, Read, Update, Delete) work against sync table APIs, except now they read from or write to a *local store*.</span></span> <span data-ttu-id="4160e-129">Antes de poder realizar cualquier operación de la tabla de sincronización, se debe inicializar el almacén local.</span><span class="sxs-lookup"><span data-stu-id="4160e-129">Before any sync table operations can be performed, the local store must be initialized.</span></span>

## <a name="what-is-a-local-store"></a><span data-ttu-id="4160e-130">¿Qué es un almacén local?</span><span class="sxs-lookup"><span data-stu-id="4160e-130">What is a local store?</span></span>
<span data-ttu-id="4160e-131">Un almacén local es la capa de persistencia de datos del dispositivo cliente.</span><span class="sxs-lookup"><span data-stu-id="4160e-131">A local store is the data persistence layer on the client device.</span></span> <span data-ttu-id="4160e-132">Los SDK de cliente de Aplicaciones móviles de Azure proporcionan una implementación de almacén local predeterminada.</span><span class="sxs-lookup"><span data-stu-id="4160e-132">The Azure Mobile Apps client SDKs provide a default local store implementation.</span></span> <span data-ttu-id="4160e-133">En Windows, Xamarin y Android, se basa en SQLite.</span><span class="sxs-lookup"><span data-stu-id="4160e-133">On Windows, Xamarin and Android, it is based on SQLite.</span></span> <span data-ttu-id="4160e-134">En iOS, se basa en Core Data.</span><span class="sxs-lookup"><span data-stu-id="4160e-134">On iOS, it is based on Core Data.</span></span>

<span data-ttu-id="4160e-135">Para usar la implementación basada en SQLite en Windows Phone o Windows Store 8.1, debe instalar una extensión de SQLite.</span><span class="sxs-lookup"><span data-stu-id="4160e-135">To use the SQLite-based implementation on Windows Phone or Windows Store 8.1, you need to install a SQLite extension.</span></span> <span data-ttu-id="4160e-136">Para más información, consulte [Plataforma universal de Windows: habilitación de la sincronización sin conexión]. Android y iOS se distribuyen con una versión de SQLite en el sistema operativo del dispositivo, por lo que no es necesario hacer referencia a su propia versión de SQLite.</span><span class="sxs-lookup"><span data-stu-id="4160e-136">For more information, see [Universal Windows Platform: Enable offline sync]. Android and iOS ship with a version of SQLite in the device operating system itself, so it is not necessary to reference your own version of SQLite.</span></span>

<span data-ttu-id="4160e-137">Los desarrolladores también pueden implementar su propio almacén local.</span><span class="sxs-lookup"><span data-stu-id="4160e-137">Developers can also implement their own local store.</span></span> <span data-ttu-id="4160e-138">Por ejemplo, si desea almacenar los datos en un formato cifrado en el cliente móvil, puede definir un almacén local que use SQLCipher para el cifrado.</span><span class="sxs-lookup"><span data-stu-id="4160e-138">For instance, if you wish to store data in an encrypted format on the mobile client, you can define a local store that uses SQLCipher for encryption.</span></span>

## <a name="what-is-a-sync-context"></a><span data-ttu-id="4160e-139">¿Qué es un contexto de sincronización?</span><span class="sxs-lookup"><span data-stu-id="4160e-139">What is a sync context?</span></span>
<span data-ttu-id="4160e-140">Un *contexto de sincronización* está asociado a un objeto de cliente móvil (como `IMobileServiceClient` o `MSClient`) y realiza el seguimiento de los cambios que se realizan con las tablas de sincronización.</span><span class="sxs-lookup"><span data-stu-id="4160e-140">A *sync context* is associated with a mobile client object (such as `IMobileServiceClient` or `MSClient`) and tracks changes that are made with sync tables.</span></span> <span data-ttu-id="4160e-141">El contexto de sincronización mantiene una *cola de operaciones* que tiene una lista ordenada de operaciones CUD (creación, actualización, eliminación) que posteriormente se enviará al servidor.</span><span class="sxs-lookup"><span data-stu-id="4160e-141">The sync context maintains an *operation queue*, which keeps an ordered list of CUD operations (Create, Update, Delete) that is later be sent to the server.</span></span>

<span data-ttu-id="4160e-142">Un almacén local se asocia con el contexto de sincronización mediante un método de inicialización como `IMobileServicesSyncContext.InitializeAsync(localstore)` en el [SDK de cliente de .NET].</span><span class="sxs-lookup"><span data-stu-id="4160e-142">A local store is associated with the sync context using an initialize method such as `IMobileServicesSyncContext.InitializeAsync(localstore)` in the [.NET client SDK].</span></span>

## <span data-ttu-id="4160e-143"><a name="how-sync-works"></a>Funcionamiento de la sincronización sin conexión</span><span class="sxs-lookup"><span data-stu-id="4160e-143"><a name="how-sync-works"></a>How offline synchronization works</span></span>
<span data-ttu-id="4160e-144">Al usar tablas de sincronización, el código de cliente determina el momento en que se sincronizan los cambios locales con un back-end de Azure Mobile App.</span><span class="sxs-lookup"><span data-stu-id="4160e-144">When using sync tables, your client code controls when local changes are synchronized with an Azure Mobile App backend.</span></span> <span data-ttu-id="4160e-145">No se envía nada al back-end hasta que hay una llamada a los cambios locales de *inserción* .</span><span class="sxs-lookup"><span data-stu-id="4160e-145">Nothing is sent to the backend until there is a call to *push* local changes.</span></span> <span data-ttu-id="4160e-146">De forma similar, el almacén local se rellena con datos nuevos solo cuando hay una llamada a los datos de *extracción* .</span><span class="sxs-lookup"><span data-stu-id="4160e-146">Similarly, the local store is populated with new data only when there is a call to *pull* data.</span></span>

* <span data-ttu-id="4160e-147">**Inserción**: la inserción es una operación en el contexto de sincronización que envía todos los cambios CUD realizados desde la última inserción.</span><span class="sxs-lookup"><span data-stu-id="4160e-147">**Push**: Push is an operation on the sync context and sends all CUD changes since the last push.</span></span> <span data-ttu-id="4160e-148">Tenga en cuenta que no es posible enviar solo los cambios de una tabla individual porque las operaciones se podrían enviar desordenadas.</span><span class="sxs-lookup"><span data-stu-id="4160e-148">Note that it is not possible to send only an individual table's changes, because otherwise operations could be sent out of order.</span></span> <span data-ttu-id="4160e-149">La inserción ejecuta una serie de llamadas REST al back-end de Azure Mobile App, que a su vez, modifica la base de datos del servidor.</span><span class="sxs-lookup"><span data-stu-id="4160e-149">Push executes a series of REST calls to your Azure Mobile App backend, which in turn modifies your server database.</span></span>
* <span data-ttu-id="4160e-150">**Extracción**: la extracción se realiza tabla por tabla y se puede personalizar con una consulta para recuperar solo un subconjunto de los datos del servidor.</span><span class="sxs-lookup"><span data-stu-id="4160e-150">**Pull**: Pull is performed on a per-table basis and can be customized with a query to retrieve only a subset of the server data.</span></span> <span data-ttu-id="4160e-151">Luego, los SDK de cliente móvil de Azur insertan los datos que se obtienen en el almacén local.</span><span class="sxs-lookup"><span data-stu-id="4160e-151">The Azure Mobile client SDKs then insert the resulting data into the local store.</span></span>
* <span data-ttu-id="4160e-152">**Inserciones implícitas**: si se ejecuta una extracción en una tabla que tiene actualizaciones locales pendientes, la extracción ejecutará primero un elemento `push()` en el contexto de sincronización.</span><span class="sxs-lookup"><span data-stu-id="4160e-152">**Implicit Pushes**: If a pull is executed against a table that has pending local updates, the pull first executes a `push()` on the sync context.</span></span> <span data-ttu-id="4160e-153">Esta inserción ayuda a minimizar los conflictos entre los cambios que ya están en cola y los datos nuevos del servidor.</span><span class="sxs-lookup"><span data-stu-id="4160e-153">This push helps minimize conflicts between changes that are already queued and new data from the server.</span></span>
* <span data-ttu-id="4160e-154">**Sincronización incremental**: el primer parámetro de la operación de extracción es un *nombre de consulta* que solo se usa en el cliente.</span><span class="sxs-lookup"><span data-stu-id="4160e-154">**Incremental Sync**: the first parameter to the pull operation is a *query name* that is used only on the client.</span></span> <span data-ttu-id="4160e-155">Si usa un nombre de consulta no nulo, Azure Mobile SDK lleva a cabo una *sincronización incremental*. Cada vez que una operación de extracción devuelve un conjunto de resultados, la última marca de tiempo `updatedAt` de dicho conjunto se almacena en las tablas del sistema local del SDK.</span><span class="sxs-lookup"><span data-stu-id="4160e-155">If you use a non-null query name, the Azure Mobile SDK performs an *incremental sync*. Each time a pull operation returns a set of results, the latest `updatedAt` timestamp from that result set is stored in the SDK local system tables.</span></span> <span data-ttu-id="4160e-156">Las operaciones de extracción posteriores solo recuperarán registros después de esa marca de tiempo.</span><span class="sxs-lookup"><span data-stu-id="4160e-156">Subsequent pull operations retrieve only records after that timestamp.</span></span>

  <span data-ttu-id="4160e-157">Para usar la sincronización incremental, el servidor debe devolver valores `updatedAt` significativos y también admitir la ordenación mediante este campo.</span><span class="sxs-lookup"><span data-stu-id="4160e-157">To use incremental sync, your server must return meaningful `updatedAt` values and must also support sorting by this field.</span></span> <span data-ttu-id="4160e-158">Sin embargo, puesto que el SDK agrega su propio orden en el campo updatedAt, no puede usar una consulta de extracción que tenga su propia cláusula `orderBy` .</span><span class="sxs-lookup"><span data-stu-id="4160e-158">However, since the SDK adds its own sort on the updatedAt field, you cannot use a pull query that has its own `orderBy` clause.</span></span>

  <span data-ttu-id="4160e-159">El nombre de consulta puede ser cualquier cadena que elija, pero debe ser único para cada consulta lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4160e-159">The query name can be any string you choose, but it must be unique for each logical query in your app.</span></span>
  <span data-ttu-id="4160e-160">De lo contrario, diferentes operaciones de extracción podrían sobrescribir la misma marca de tiempo de sincronización incremental y las consultas podrían devolver resultados incorrectos.</span><span class="sxs-lookup"><span data-stu-id="4160e-160">Otherwise, different pull operations could overwrite the same incremental sync timestamp and your queries can return incorrect results.</span></span>

  <span data-ttu-id="4160e-161">Si la consulta tiene un parámetro, una forma de crear un nombre de consulta único es incorporar el valor del parámetro.</span><span class="sxs-lookup"><span data-stu-id="4160e-161">If the query has a parameter, one way to create a unique query name is to incorporate the parameter value.</span></span>
  <span data-ttu-id="4160e-162">Por ejemplo, si está filtrando por userid, el nombre de consulta podría ser el siguiente (en C#):</span><span class="sxs-lookup"><span data-stu-id="4160e-162">For instance, if you are filtering on userid, your query name could be as follows (in C#):</span></span>

        await todoTable.PullAsync("todoItems" + userid,
            syncTable.Where(u => u.UserId == userid));

  <span data-ttu-id="4160e-163">Si desea cancelar la sincronización incremental, pase `null` como identificador de consulta.</span><span class="sxs-lookup"><span data-stu-id="4160e-163">If you want to opt out of incremental sync, pass `null` as the query ID.</span></span> <span data-ttu-id="4160e-164">En este caso, se recuperan todos los registros en cada llamada a `PullAsync`, que es potencialmente ineficaz.</span><span class="sxs-lookup"><span data-stu-id="4160e-164">In this case, all records are retrieved on every call to `PullAsync`, which is potentially inefficient.</span></span>
* <span data-ttu-id="4160e-165">**Purga**: el contenido del almacén local se puede eliminar mediante `IMobileServiceSyncTable.PurgeAsync`.</span><span class="sxs-lookup"><span data-stu-id="4160e-165">**Purging**: You can clear the contents of the local store using `IMobileServiceSyncTable.PurgeAsync`.</span></span>
  <span data-ttu-id="4160e-166">La purga puede ser necesaria si tiene datos obsoletos en la base de datos cliente o si desea descartar todos los cambios pendientes.</span><span class="sxs-lookup"><span data-stu-id="4160e-166">Purging may be necessary if you have stale data in the client database, or if you wish to discard all pending changes.</span></span>

  <span data-ttu-id="4160e-167">Una purga borra una tabla del almacén local.</span><span class="sxs-lookup"><span data-stu-id="4160e-167">A purge clears a table from the local store.</span></span> <span data-ttu-id="4160e-168">Si hay operaciones a la espera de sincronizarse con la base de datos del servidor, la purga genera una excepción, a menos que esté establecido el parámetro *force purge*.</span><span class="sxs-lookup"><span data-stu-id="4160e-168">If there are operations awaiting synchronization with the server database, the purge throws an exception unless the *force purge* parameter is set.</span></span>

  <span data-ttu-id="4160e-169">Como un ejemplo de datos obsoletos en el cliente, supongamos que en el ejemplo "lista de tareas pendientes", Dispositivo1 extrae solo los elementos que no se han completado.</span><span class="sxs-lookup"><span data-stu-id="4160e-169">As an example of stale data on the client, suppose in the "todo list" example, Device1 only pulls items that are not completed.</span></span> <span data-ttu-id="4160e-170">Otro dispositivo marca una tarea pendiente "Comprar leche" como completada en el servidor.</span><span class="sxs-lookup"><span data-stu-id="4160e-170">A todoitem "Buy milk" is marked completed on the server by another device.</span></span> <span data-ttu-id="4160e-171">Sin embargo, Dispositivo1 seguirá teniendo la tarea pendiente "Comprar leche" en el almacén local porque solo está extrayendo los elementos que no están marcados como completados</span><span class="sxs-lookup"><span data-stu-id="4160e-171">However, Device1 still has the "Buy milk" todoitem in local store because it is only pulling items that are not marked complete.</span></span> <span data-ttu-id="4160e-172">Una purga borra este elemento obsoleto.</span><span class="sxs-lookup"><span data-stu-id="4160e-172">A purge clears this stale item.</span></span>

## <a name="next-steps"></a><span data-ttu-id="4160e-173">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="4160e-173">Next steps</span></span>
* <span data-ttu-id="4160e-174">[iOS: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-174">[iOS: Enable offline sync]</span></span>
* <span data-ttu-id="4160e-175">[Xamarin iOS: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-175">[Xamarin iOS: Enable offline sync]</span></span>
* <span data-ttu-id="4160e-176">[Xamarin Android: habilitar la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-176">[Xamarin Android: Enable offline sync]</span></span>
* <span data-ttu-id="4160e-177">[Plataforma universal de Windows: habilitación de la sincronización sin conexión]</span><span class="sxs-lookup"><span data-stu-id="4160e-177">[Universal Windows Platform: Enable offline sync]</span></span>

<!-- Links -->
[SDK de cliente de .NET]: app-service-mobile-dotnet-how-to-use-client-library.md
[Android: habilitar la sincronización sin conexión]: app-service-mobile-android-get-started-offline-data.md
[iOS: habilitar la sincronización sin conexión]: app-service-mobile-ios-get-started-offline-data.md
[Xamarin iOS: habilitar la sincronización sin conexión]: app-service-mobile-xamarin-ios-get-started-offline-data.md
[Xamarin Android: habilitar la sincronización sin conexión]: app-service-mobile-xamarin-android-get-started-offline-data.md
[Plataforma universal de Windows: habilitación de la sincronización sin conexión]: app-service-mobile-windows-store-dotnet-get-started-offline-data.md
