---
title: "Ejecución de scripts de aprendizaje automático de Python | Microsoft Docs"
description: "Describe los principios de diseño subyacentes a la compatibilidad con scripts de Python en Aprendizaje automático de Azure y los escenarios de uso básico, las funcionalidades y las limitaciones."
keywords: "aprendizaje automático de Python, pandas, pandas de python, scripts de python, ejecutar scripts de python"
services: machine-learning
documentationcenter: 
author: bradsev
manager: jhubbard
editor: cgronlun
ms.assetid: ee9eb764-0d3e-4104-a797-19fc29345d39
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: bradsev
ms.openlocfilehash: e8d6377bc939e6711a96e521b5f574fc8d060929
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="execute-python-machine-learning-scripts-in-azure-machine-learning-studio"></a><span data-ttu-id="2eafc-104">Ejecución de scripts de Python en Aprendizaje automático de Azure | Azure</span><span class="sxs-lookup"><span data-stu-id="2eafc-104">Execute Python machine learning scripts in Azure Machine Learning Studio</span></span>

<span data-ttu-id="2eafc-105">En este tema se describen los principios de diseño subyacentes a la compatibilidad actual con scripts de Python en Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-105">This topic describes the design principles underlying the current support for Python scripts in Azure Machine Learning.</span></span> <span data-ttu-id="2eafc-106">También se esbozan las principales funcionalidades que proporciona, que incluyen:</span><span class="sxs-lookup"><span data-stu-id="2eafc-106">The main capabilities provided are also outlined, including:</span></span>

- <span data-ttu-id="2eafc-107">ejecución de escenarios de uso básicos</span><span class="sxs-lookup"><span data-stu-id="2eafc-107">execute basic usage scenarios</span></span>
- <span data-ttu-id="2eafc-108">puntuación de un experimento en un servicio web</span><span class="sxs-lookup"><span data-stu-id="2eafc-108">score an experiment in a web service</span></span>
- <span data-ttu-id="2eafc-109">compatibilidad con la importación de código existente</span><span class="sxs-lookup"><span data-stu-id="2eafc-109">support for importing existing code</span></span>
- <span data-ttu-id="2eafc-110">exportación de visualizaciones</span><span class="sxs-lookup"><span data-stu-id="2eafc-110">export visualizations</span></span>
- <span data-ttu-id="2eafc-111">selección de características supervisada</span><span class="sxs-lookup"><span data-stu-id="2eafc-111">perform supervised feature selection</span></span>
- <span data-ttu-id="2eafc-112">comprensión de algunas limitaciones</span><span class="sxs-lookup"><span data-stu-id="2eafc-112">understand some limitations</span></span>

<span data-ttu-id="2eafc-113">[Python](https://www.python.org/) es una herramienta indispensable de la caja de herramientas de muchos científicos de datos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-113">[Python](https://www.python.org/) is an indispensable tool in the tool chest of many data scientists.</span></span> <span data-ttu-id="2eafc-114">Tiene:</span><span class="sxs-lookup"><span data-stu-id="2eafc-114">It has:</span></span>

* <span data-ttu-id="2eafc-115">una sintaxis elegante y concisa,</span><span class="sxs-lookup"><span data-stu-id="2eafc-115">an elegant and concise syntax,</span></span> 
* <span data-ttu-id="2eafc-116">asistencia multiplataforma,</span><span class="sxs-lookup"><span data-stu-id="2eafc-116">cross-platform support,</span></span> 
* <span data-ttu-id="2eafc-117">una amplia colección de bibliotecas eficaces y</span><span class="sxs-lookup"><span data-stu-id="2eafc-117">a vast collection of powerful libraries, and</span></span> 
* <span data-ttu-id="2eafc-118">herramientas de desarrollo perfeccionadas.</span><span class="sxs-lookup"><span data-stu-id="2eafc-118">mature development tools.</span></span> 

<span data-ttu-id="2eafc-119">Python se usa en todas las fases de un flujo de trabajo que normalmente se emplea en el modelado de aprendizaje automático:</span><span class="sxs-lookup"><span data-stu-id="2eafc-119">Python is being used in all phases of a workflow typically used in machine learning modeling:</span></span>

- <span data-ttu-id="2eafc-120">ingesta y procesamiento de datos</span><span class="sxs-lookup"><span data-stu-id="2eafc-120">data ingest and processing</span></span> 
- <span data-ttu-id="2eafc-121">construcción de características</span><span class="sxs-lookup"><span data-stu-id="2eafc-121">feature construction</span></span>
- <span data-ttu-id="2eafc-122">entrenamiento del modelo</span><span class="sxs-lookup"><span data-stu-id="2eafc-122">model training</span></span> 
- <span data-ttu-id="2eafc-123">validación del modelo</span><span class="sxs-lookup"><span data-stu-id="2eafc-123">model validation</span></span>
- <span data-ttu-id="2eafc-124">implementación de los modelos</span><span class="sxs-lookup"><span data-stu-id="2eafc-124">deployment of the models</span></span>

<span data-ttu-id="2eafc-125">Azure Machine Learning Studio admite la incrustación de scripts de Python en varias partes de un experimento de aprendizaje automático y, además, su publicación sin problemas como servicios web en Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="2eafc-125">Azure Machine Learning Studio supports embedding Python scripts into various parts of a machine learning experiment and also seamlessly publishing them as web services on Microsoft Azure.</span></span>

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]


## <a name="design-principles-of-python-scripts-in-machine-learning"></a><span data-ttu-id="2eafc-126">Principios de diseño de los scripts de Python en Aprendizaje automático</span><span class="sxs-lookup"><span data-stu-id="2eafc-126">Design principles of Python scripts in Machine Learning</span></span>

<span data-ttu-id="2eafc-127">La interfaz principal para Python en Azure Machine Learning Studio es mediante el módulo [Ejecutar script de Python][execute-python-script] que aparece en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="2eafc-127">The primary interface to Python in Azure Machine Learning Studio is via the [Execute Python Script][execute-python-script] module shown in Figure 1.</span></span>

![imagen1](./media/machine-learning-execute-python-scripts/execute-machine-learning-python-scripts-module.png)

![imagen2](./media/machine-learning-execute-python-scripts/embedded-machine-learning-python-script.png)

<span data-ttu-id="2eafc-130">Figura 1.</span><span class="sxs-lookup"><span data-stu-id="2eafc-130">Figure 1.</span></span> <span data-ttu-id="2eafc-131">El módulo **Ejecutar script de Python** .</span><span class="sxs-lookup"><span data-stu-id="2eafc-131">The **Execute Python Script** module.</span></span>

<span data-ttu-id="2eafc-132">El módulo [Ejecutar script de Python][execute-python-script] de Azure ML Studio acepta hasta tres entradas y genera hasta dos salidas (que se tratan en la siguiente sección), al igual que su análogo de R, el módulo [Ejecutar script R][execute-r-script].</span><span class="sxs-lookup"><span data-stu-id="2eafc-132">The [Execute Python Script][execute-python-script] module in Azure ML Studio accepts up to three inputs and produces up to two outputs (discussed in the following section), like its R analogue, the [Execute R Script][execute-r-script] module.</span></span> <span data-ttu-id="2eafc-133">El código Python que se ejecutará se escribe en el cuadro de parámetro como una función de punto de entrada especialmente denominada llamada `azureml_main`.</span><span class="sxs-lookup"><span data-stu-id="2eafc-133">The Python code to be executed is entered into the parameter box as a specially named entry-point function called `azureml_main`.</span></span> <span data-ttu-id="2eafc-134">Los siguientes son los principios de diseño clave que se usan para implementar este módulo:</span><span class="sxs-lookup"><span data-stu-id="2eafc-134">Here are the key design principles used to implement this module:</span></span>

1. <span data-ttu-id="2eafc-135">*Debe ser idiomático para los usuarios de Python.*</span><span class="sxs-lookup"><span data-stu-id="2eafc-135">*Must be idiomatic for Python users.*</span></span> <span data-ttu-id="2eafc-136">La mayoría de los usuarios de Python incluye su código como funciones dentro de módulos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-136">Most Python users factor their code as functions inside modules.</span></span> <span data-ttu-id="2eafc-137">Así, la colocación de muchas instrucciones ejecutables en un módulo de nivel superior es relativamente rara.</span><span class="sxs-lookup"><span data-stu-id="2eafc-137">So putting a lot of executable statements in a top-level module is relatively rare.</span></span> <span data-ttu-id="2eafc-138">Como resultado, el cuadro del script también asume una función de Python especialmente denominada, en contraposición a solo una secuencia de instrucciones.</span><span class="sxs-lookup"><span data-stu-id="2eafc-138">As a result, the script box also takes a specially named Python function as opposed to just a sequence of statements.</span></span> <span data-ttu-id="2eafc-139">Los objetos expuestos en la función son tipos de bibliotecas de Python estándar, como tramas de datos [Pandas](http://pandas.pydata.org/) y matrices [NumPy](http://www.numpy.org/).</span><span class="sxs-lookup"><span data-stu-id="2eafc-139">The objects exposed in the function are standard Python library types such as [Pandas](http://pandas.pydata.org/) data frames and [NumPy](http://www.numpy.org/) arrays.</span></span>
2. <span data-ttu-id="2eafc-140">*Debe contar con alta fidelidad entre las ejecuciones locales y las ejecuciones en la nube.*</span><span class="sxs-lookup"><span data-stu-id="2eafc-140">*Must have high-fidelity between local and cloud executions.*</span></span> <span data-ttu-id="2eafc-141">El back-end que se usa para ejecutar el código de Python se basa en [Anaconda](https://store.continuum.io/cshop/anaconda/), una distribución científica multiplataforma de Python ampliamente usada.</span><span class="sxs-lookup"><span data-stu-id="2eafc-141">The backend used to execute the Python code is based on [Anaconda](https://store.continuum.io/cshop/anaconda/), a widely used cross-platform scientific Python distribution.</span></span> <span data-ttu-id="2eafc-142">Incluye cerca de 200 de los paquetes más comunes de Python.</span><span class="sxs-lookup"><span data-stu-id="2eafc-142">It comes with close to 200 of the most common Python packages.</span></span> <span data-ttu-id="2eafc-143">Por lo tanto, los científicos de datos pueden depurar y calificar su código en su entorno Anaconda compatible con la instancia de Azure Machine Learning local.</span><span class="sxs-lookup"><span data-stu-id="2eafc-143">Therefore, data scientists can debug and qualify their code on their local Azure Machine Learning-compatible Anaconda environment.</span></span> <span data-ttu-id="2eafc-144">Luego usan un entorno de desarrollo existente, como [IPython](http://ipython.org/) Notebook o las [Herramientas de Python para Visual Studio](http://aka.ms/ptvs), para ejecutarlo como parte de un experimento de Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-144">Then use an existing development environment, such as [IPython](http://ipython.org/) notebook or [Python Tools for Visual Studio](http://aka.ms/ptvs), to run it as part of an Azure ML experiment.</span></span> <span data-ttu-id="2eafc-145">El punto de entrada `azureml_main` es una función vainilla de Python y por tanto ****se puede crear sin código específico de Azure Machine Learning ni el SDK instalado.</span><span class="sxs-lookup"><span data-stu-id="2eafc-145">The `azureml_main` entry point is a vanilla Python function and so ****can be authored without Azure ML-specific code or the SDK installed.</span></span>
3. <span data-ttu-id="2eafc-146">*Debe admitir composición sin problemas con otros módulos de Aprendizaje automático de Azure.*</span><span class="sxs-lookup"><span data-stu-id="2eafc-146">*Must be seamlessly composable with other Azure Machine Learning modules.*</span></span> <span data-ttu-id="2eafc-147">El módulo [Ejecutar script de Python][execute-python-script] acepta, como entradas y salidas, conjuntos de datos estándar de Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-147">The [Execute Python Script][execute-python-script] module accepts, as inputs and outputs, standard Azure Machine Learning datasets.</span></span> <span data-ttu-id="2eafc-148">El marco subyacente une los runtimes de Azure Machine Learning y Python de forma transparente y eficaz.</span><span class="sxs-lookup"><span data-stu-id="2eafc-148">The underlying framework transparently and efficiently bridges the Azure ML and Python runtimes.</span></span> <span data-ttu-id="2eafc-149">Por tanto, Python se puede usar con flujos de trabajo existentes de Azure Machine Learning, incluidos los que llaman a R y SQLite.</span><span class="sxs-lookup"><span data-stu-id="2eafc-149">So Python can be used in conjunction with existing Azure ML workflows, including those that call into R and SQLite.</span></span> <span data-ttu-id="2eafc-150">Como resultado, los científicos de datos pueden crear flujos de trabajo que:</span><span class="sxs-lookup"><span data-stu-id="2eafc-150">A  result, data scientist could compose workflows that:</span></span>
   * <span data-ttu-id="2eafc-151">usen Python y Pandas para el procesamiento previo y la limpieza de datos</span><span class="sxs-lookup"><span data-stu-id="2eafc-151">use Python and Pandas for data pre-processing and cleaning</span></span>
   * <span data-ttu-id="2eafc-152">transmitan los datos a una transformación de SQL que una varios conjuntos de datos para formar características</span><span class="sxs-lookup"><span data-stu-id="2eafc-152">feed the data to a SQL transformation, joining multiple datasets to form features</span></span>
   * <span data-ttu-id="2eafc-153">entrenen modelos mediante los algoritmos de Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="2eafc-153">train models using the algorithms in Azure Machine Learning</span></span> 
   * <span data-ttu-id="2eafc-154">evalúen y procesen posteriormente los resultados con R.</span><span class="sxs-lookup"><span data-stu-id="2eafc-154">evaluate and post-process the results using R.</span></span>


## <a name="basic-usage-scenarios-in-ml-for-python-scripts"></a><span data-ttu-id="2eafc-155">Escenarios de uso básicos de Aprendizaje automático para scripts de Python</span><span class="sxs-lookup"><span data-stu-id="2eafc-155">Basic usage scenarios in ML for Python scripts</span></span>

<span data-ttu-id="2eafc-156">En esta sección, analizaremos algunos de los usos básicos del módulo [Ejecutar script de Python][execute-python-script].</span><span class="sxs-lookup"><span data-stu-id="2eafc-156">In this section, we survey some of the basic uses of the [Execute Python Script][execute-python-script] module.</span></span> <span data-ttu-id="2eafc-157">Las entradas en el módulo Python se exponen como tramas de datos de Pandas.</span><span class="sxs-lookup"><span data-stu-id="2eafc-157">Inputs to the Python module are exposed as Pandas data frames.</span></span> <span data-ttu-id="2eafc-158">La función debe devolver una sola trama de datos de Pandas empaquetada dentro de una [secuencia](https://docs.python.org/2/c-api/sequence.html) de Python, como una tupla, una lista o una matriz de NumPy.</span><span class="sxs-lookup"><span data-stu-id="2eafc-158">The function must return a single Pandas data frame packaged inside of a Python [sequence](https://docs.python.org/2/c-api/sequence.html) such as a tuple, list, or NumPy array.</span></span> <span data-ttu-id="2eafc-159">Luego, el primer elemento de esta secuencia se devuelve en el primer puerto de salida del módulo.</span><span class="sxs-lookup"><span data-stu-id="2eafc-159">The first element of this sequence is then returned in the first output port of the module.</span></span> <span data-ttu-id="2eafc-160">Este esquema aparece en la figura 2.</span><span class="sxs-lookup"><span data-stu-id="2eafc-160">This scheme is shown in Figure 2.</span></span>

![imagen3](./media/machine-learning-execute-python-scripts/map-of-python-script-inputs-outputs.png)

<span data-ttu-id="2eafc-162">Ilustración 2.</span><span class="sxs-lookup"><span data-stu-id="2eafc-162">Figure 2.</span></span> <span data-ttu-id="2eafc-163">Asignación de puertos de entrada a parámetros y valor de devolución a puerto de salida.</span><span class="sxs-lookup"><span data-stu-id="2eafc-163">Mapping of input ports to parameters and return value to output port.</span></span>

<span data-ttu-id="2eafc-164">Puede ver una semántica más detallada de cómo se asignan los puertos de entrada a los parámetros de la `azureml_main` función en la tabla 1:</span><span class="sxs-lookup"><span data-stu-id="2eafc-164">More detailed semantics of how the input ports get mapped to parameters of the `azureml_main` function are shown in Table 1:</span></span>

![imagen1T](./media/machine-learning-execute-python-scripts/python-script-inputs-mapped-to-parameters.png)

<span data-ttu-id="2eafc-166">Tabla 1.</span><span class="sxs-lookup"><span data-stu-id="2eafc-166">Table 1.</span></span> <span data-ttu-id="2eafc-167">Asignación de puertos de entrada a parámetros de función.</span><span class="sxs-lookup"><span data-stu-id="2eafc-167">Mapping of input ports to function parameters.</span></span>

<span data-ttu-id="2eafc-168">La asignación entre los puertos de entrada y los parámetros de función es posicional:</span><span class="sxs-lookup"><span data-stu-id="2eafc-168">The mapping between input ports and function parameters is positional:</span></span>

- <span data-ttu-id="2eafc-169">El primer puerto de entrada conectado se asigna al primer parámetro de la función.</span><span class="sxs-lookup"><span data-stu-id="2eafc-169">The first connected input port is mapped to the first parameter of the function.</span></span> 
- <span data-ttu-id="2eafc-170">La segunda entrada (si está conectada) se asigna al segundo parámetro de la función.</span><span class="sxs-lookup"><span data-stu-id="2eafc-170">The second input (if connected) is mapped to the second parameter of the function.</span></span>

<span data-ttu-id="2eafc-171">Vea *Python for Data Analysis* (O'Reilly, 2012) de W. McKinney para más información sobre Python Pandas y sobre cómo se puede usar para manipular datos de manera eficaz y eficiente.</span><span class="sxs-lookup"><span data-stu-id="2eafc-171">See *Python for Data Analysis* (O'Reilly, 2012) by W. McKinney for more information on Python Pandas and on how it can be used to manipulate data effectively and efficiently.</span></span> 


## <a name="translation-of-input-and-output-types"></a><span data-ttu-id="2eafc-172">Traslación de tipos de entrada y salida</span><span class="sxs-lookup"><span data-stu-id="2eafc-172">Translation of input and output types</span></span> 
<span data-ttu-id="2eafc-173">Los conjuntos de datos de entrada de Azure Machine Learning se convierten en tramas de datos en Pandas.</span><span class="sxs-lookup"><span data-stu-id="2eafc-173">Input datasets in Azure ML are converted to data frames in Pandas.</span></span> <span data-ttu-id="2eafc-174">Las tramas de datos de salida se vuelven a convertir en conjuntos de datos de Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-174">Output data frames are converted back to Azure ML datasets.</span></span> <span data-ttu-id="2eafc-175">Se realizan las siguientes conversiones:</span><span class="sxs-lookup"><span data-stu-id="2eafc-175">The following conversions are performed:</span></span>

1. <span data-ttu-id="2eafc-176">Las columnas numéricas y de cadena se convierten tal cual y los valores que faltan en un conjunto de datos se convierten en valores "NA" en Pandas.</span><span class="sxs-lookup"><span data-stu-id="2eafc-176">String and numeric columns are converted as-is and missing values in a dataset are converted to ‘NA’ values in Pandas.</span></span> <span data-ttu-id="2eafc-177">Se produce la misma conversión a la inversa (los valores NA de Pandas se convierten en valores que faltan en Azure Machine Learning).</span><span class="sxs-lookup"><span data-stu-id="2eafc-177">The same conversion happens on the way back (NA values in Pandas are converted to missing values in Azure ML).</span></span>
2. <span data-ttu-id="2eafc-178">Los vectores de índice de Pandas no se admiten en Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-178">Index vectors in Pandas are not supported in Azure ML.</span></span> <span data-ttu-id="2eafc-179">Todas las tramas de datos de entrada de la función de Python siempre tienen un índice numérico de 64 bits entre 0 y el número de filas menos 1.</span><span class="sxs-lookup"><span data-stu-id="2eafc-179">All input data frames in the Python function always have a 64-bit numerical index from 0 to the number of rows minus 1.</span></span> 
3. <span data-ttu-id="2eafc-180">Los conjuntos de datos de Azure Machine Learning no pueden tener nombres de columnas duplicados ni nombres de columnas que no sean cadenas.</span><span class="sxs-lookup"><span data-stu-id="2eafc-180">Azure ML datasets cannot have duplicate column names and column names that are not strings.</span></span> <span data-ttu-id="2eafc-181">Si una trama de datos de salida contiene columnas no numéricas, el marco llama a `str` en los nombres de columna.</span><span class="sxs-lookup"><span data-stu-id="2eafc-181">If an output data frame contains non-numeric columns, the framework calls `str` on the column names.</span></span> <span data-ttu-id="2eafc-182">Del mismo modo, los nombres de columnas duplicados se alternan automáticamente para asegurarse de que los nombres sean únicos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-182">Likewise, any duplicate column names are automatically mangled to insure the names are unique.</span></span> <span data-ttu-id="2eafc-183">El sufijo (2) se agrega al primer duplicado, (3) al segundo duplicado, etc.</span><span class="sxs-lookup"><span data-stu-id="2eafc-183">The suffix (2) is added to the first duplicate, (3) to the second duplicate, and so on.</span></span>


## <a name="operationalizing-python-scripts"></a><span data-ttu-id="2eafc-184">Funcionamiento de los scripts de Python</span><span class="sxs-lookup"><span data-stu-id="2eafc-184">Operationalizing Python scripts</span></span>

<span data-ttu-id="2eafc-185">Cuando un experimento de puntuación se publica como servicio web, se llama a todos los módulos [Ejecutar script de Python][execute-python-script] usados en él.</span><span class="sxs-lookup"><span data-stu-id="2eafc-185">Any [Execute Python Script][execute-python-script] modules used in a scoring experiment are called when published as a web service.</span></span> <span data-ttu-id="2eafc-186">Por ejemplo, la figura 3 muestra un experimento de puntuación que contiene el código para evaluar una única expresión de Python.</span><span class="sxs-lookup"><span data-stu-id="2eafc-186">For example, Figure 3 shows a scoring experiment that contains the code to evaluate a single Python expression.</span></span> 

![imagen4](./media/machine-learning-execute-python-scripts/figure3a.png)

![imagen5](./media/machine-learning-execute-python-scripts/python-script-with-python-pandas.png)

<span data-ttu-id="2eafc-189">Figura 3.</span><span class="sxs-lookup"><span data-stu-id="2eafc-189">Figure 3.</span></span> <span data-ttu-id="2eafc-190">Servicio web para evaluar una expresión de Python.</span><span class="sxs-lookup"><span data-stu-id="2eafc-190">Web service for evaluating a Python expression.</span></span>

<span data-ttu-id="2eafc-191">Un servicio web creado a partir de este experimento:</span><span class="sxs-lookup"><span data-stu-id="2eafc-191">A web service created from this experiment:</span></span>

- <span data-ttu-id="2eafc-192">toma como entrada una expresión de Python (como una cadena)</span><span class="sxs-lookup"><span data-stu-id="2eafc-192">takes as input a Python expression (as a string)</span></span>
- <span data-ttu-id="2eafc-193">la envía al intérprete de Python</span><span class="sxs-lookup"><span data-stu-id="2eafc-193">sends it to the Python interpreter</span></span> 
- <span data-ttu-id="2eafc-194">devuelve una tabla que contiene la expresión y el resultado evaluado.</span><span class="sxs-lookup"><span data-stu-id="2eafc-194">returns a table containing both the expression and the evaluated result.</span></span>


## <a name="importing-existing-python-script-modules"></a><span data-ttu-id="2eafc-195">Importación de módulos existentes de scripts de Python</span><span class="sxs-lookup"><span data-stu-id="2eafc-195">Importing existing Python script modules</span></span>

<span data-ttu-id="2eafc-196">Un caso de uso común para muchos científicos de datos es incorporar scripts existentes de Python a experimentos de Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-196">A common use-case for many data scientists is to incorporate existing Python scripts into Azure ML experiments.</span></span> <span data-ttu-id="2eafc-197">En lugar de exigir que todo el código se concatene y se pegue en un solo cuadro de script, el módulo [Ejecutar script de Python][execute-python-script] acepta un archivo ZIP que contiene los módulos de Python en el tercer puerto de entrada.</span><span class="sxs-lookup"><span data-stu-id="2eafc-197">Instead of requiring that all code be concatenated and pasted into a single script box, the [Execute Python Script][execute-python-script] module accepts a zip file that contains Python modules at the third input port.</span></span> <span data-ttu-id="2eafc-198">El marco de ejecución descomprime el archivo en runtime y el contenido se agrega a la ruta de acceso de la biblioteca del intérprete de Python.</span><span class="sxs-lookup"><span data-stu-id="2eafc-198">The file is unzipped by the execution framework at runtime and the contents are added to the library path of the Python interpreter.</span></span> <span data-ttu-id="2eafc-199">La función de punto de entrada `azureml_main` luego puede importar directamente estos módulos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-199">The `azureml_main` entry point function can then import these modules directly.</span></span>

<span data-ttu-id="2eafc-200">Por ejemplo, considere el archivo Hello.py que contiene una función "Hello, World".</span><span class="sxs-lookup"><span data-stu-id="2eafc-200">As an example, consider the file Hello.py containing a simple “Hello, World” function.</span></span>

![imagen6](./media/machine-learning-execute-python-scripts/figure4.png)

<span data-ttu-id="2eafc-202">Figura 4.</span><span class="sxs-lookup"><span data-stu-id="2eafc-202">Figure 4.</span></span> <span data-ttu-id="2eafc-203">Función definida por el usuario en el archivo Hello.py.</span><span class="sxs-lookup"><span data-stu-id="2eafc-203">User-defined function in Hello.py file.</span></span>

<span data-ttu-id="2eafc-204">A continuación, creamos un archivo Hello.zip que contiene Hello.py:</span><span class="sxs-lookup"><span data-stu-id="2eafc-204">Next, we create a file Hello.zip that contains Hello.py:</span></span>

![imagen7](./media/machine-learning-execute-python-scripts/figure5.png)

<span data-ttu-id="2eafc-206">Figura 5.</span><span class="sxs-lookup"><span data-stu-id="2eafc-206">Figure 5.</span></span> <span data-ttu-id="2eafc-207">Archivo ZIP que contiene código Python definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="2eafc-207">Zip file containing user-defined Python code.</span></span>

<span data-ttu-id="2eafc-208">Cargue el archivo ZIP como un conjunto de datos en Azure Machine Learning Studio.</span><span class="sxs-lookup"><span data-stu-id="2eafc-208">Upload the zip file as a dataset into Azure Machine Learning Studio.</span></span> <span data-ttu-id="2eafc-209">Luego cree y ejecute un experimento que use el código de Python del archivo Hello.zip al asociarlo al tercer puerto de entrada del módulo **Ejecutar script de Python**, como se muestra en esta figura.</span><span class="sxs-lookup"><span data-stu-id="2eafc-209">Then create and run an experiment that uses the Python code in the Hello.zip file by attaching it to the third input port of the **Execute Python Script** module, as shown in this figure.</span></span>

![imagen8](./media/machine-learning-execute-python-scripts/figure6a.png)

![imagen9](./media/machine-learning-execute-python-scripts/figure6b.png)

<span data-ttu-id="2eafc-212">Figura 6.</span><span class="sxs-lookup"><span data-stu-id="2eafc-212">Figure 6.</span></span> <span data-ttu-id="2eafc-213">Experimento de ejemplo con código Python definido por el usuario cargado como archivo ZIP.</span><span class="sxs-lookup"><span data-stu-id="2eafc-213">Sample experiment with user-defined Python code uploaded as a zip file.</span></span>

<span data-ttu-id="2eafc-214">La salida del módulo muestra que el archivo ZIP se ha desempaquetado y que la función `print_hello` se ha ejecutado.</span><span class="sxs-lookup"><span data-stu-id="2eafc-214">The module output shows that the zip file has been unpackaged and that the function `print_hello` has been run.</span></span>
<span data-ttu-id="2eafc-215"> 
![image10](./media/machine-learning-execute-python-scripts/figure7.png)</span><span class="sxs-lookup"><span data-stu-id="2eafc-215"> 
![image10](./media/machine-learning-execute-python-scripts/figure7.png)</span></span>

<span data-ttu-id="2eafc-216">Figura 7.</span><span class="sxs-lookup"><span data-stu-id="2eafc-216">Figure 7.</span></span> <span data-ttu-id="2eafc-217">Función definida por el usuario en uso dentro del módulo [Ejecutar script de Python][execute-python-script].</span><span class="sxs-lookup"><span data-stu-id="2eafc-217">User-defined function in use inside the [Execute Python Script][execute-python-script] module.</span></span>


## <a name="working-with-visualizations"></a><span data-ttu-id="2eafc-218">Trabajo con visualizaciones</span><span class="sxs-lookup"><span data-stu-id="2eafc-218">Working with visualizations</span></span>

<span data-ttu-id="2eafc-219">El módulo [Ejecutar script de Python][execute-python-script] puede devolver los gráficos creados con MatplotLib que se pueden visualizar en el explorador.</span><span class="sxs-lookup"><span data-stu-id="2eafc-219">Plots created using MatplotLib that can be visualized on the browser can be returned by the [Execute Python Script][execute-python-script].</span></span> <span data-ttu-id="2eafc-220">Sin embargo, los gráficos no se redirigen automáticamente a imágenes como sucede cuando se usa R. Por lo tanto, el usuario debe guardar explícitamente todo gráfico como archivo PNG si se va a devolver a Aprendizaje automático de Azure.</span><span class="sxs-lookup"><span data-stu-id="2eafc-220">But the plots are not automatically redirected to images as they are when using R. So the user must explicitly save any plots to PNG files if they are to be returned back to Azure Machine Learning.</span></span> 

<span data-ttu-id="2eafc-221">Para generar imágenes desde MatplotLib, debe realizar el siguiente procedimiento:</span><span class="sxs-lookup"><span data-stu-id="2eafc-221">To generate images from MatplotLib, you must complete the following procedure:</span></span>

* <span data-ttu-id="2eafc-222">cambie el backend a "AGG" desde el representador basado en Qt predeterminado,</span><span class="sxs-lookup"><span data-stu-id="2eafc-222">switch the backend to “AGG” from the default Qt-based renderer</span></span> 
* <span data-ttu-id="2eafc-223">cree un nuevo objeto de figura,</span><span class="sxs-lookup"><span data-stu-id="2eafc-223">create a new figure object</span></span> 
* <span data-ttu-id="2eafc-224">obtenga el eje y genere todos los gráficos en él,</span><span class="sxs-lookup"><span data-stu-id="2eafc-224">get the axis and generate all plots into it</span></span> 
* <span data-ttu-id="2eafc-225">guarde la figura en un archivo PNG.</span><span class="sxs-lookup"><span data-stu-id="2eafc-225">save the figure to a PNG file</span></span> 

<span data-ttu-id="2eafc-226">Este proceso se muestra en la figura 8 que aparece a continuación, donde se crea una matriz de gráfico de dispersión con la función scatter_matrix de Pandas.</span><span class="sxs-lookup"><span data-stu-id="2eafc-226">This process is illustrated in the following Figure 8 that creates a scatter plot matrix using the scatter_matrix function in Pandas.</span></span>

![imagen1v](./media/machine-learning-execute-python-scripts/figure-v1-8.png)

<span data-ttu-id="2eafc-228">Figura 8.</span><span class="sxs-lookup"><span data-stu-id="2eafc-228">Figure 8.</span></span> <span data-ttu-id="2eafc-229">Código para guardar figuras de MatplotLib en imágenes.</span><span class="sxs-lookup"><span data-stu-id="2eafc-229">Code to save MatplotLib figures to images.</span></span>

<span data-ttu-id="2eafc-230">La figura 9 muestra un experimento que usa el script mostrado anteriormente para devolver gráficos a través del segundo puerto de salida.</span><span class="sxs-lookup"><span data-stu-id="2eafc-230">Figure 9 shows an experiment that uses the script shown previously to return plots via the second output port.</span></span>

![imagen2v](./media/machine-learning-execute-python-scripts/figure-v2-9a.png) 

![imagen2v](./media/machine-learning-execute-python-scripts/figure-v2-9b.png) 

<span data-ttu-id="2eafc-233">Figura 9.</span><span class="sxs-lookup"><span data-stu-id="2eafc-233">Figure 9.</span></span> <span data-ttu-id="2eafc-234">Visualización de los gráficos generados a partir del código Python.</span><span class="sxs-lookup"><span data-stu-id="2eafc-234">Visualizing plots generated from Python code.</span></span>

<span data-ttu-id="2eafc-235">Es posible devolver varias figuras si se guardan en distintas imágenes: el tiempo de ejecución de Azure Machine Learning selecciona todas las imágenes y las concatena para visualización.</span><span class="sxs-lookup"><span data-stu-id="2eafc-235">It is possible to return multiple figures by saving them into different images, the Azure Machine Learning runtime picks up all images and concatenates them for visualization.</span></span>


## <a name="advanced-examples"></a><span data-ttu-id="2eafc-236">Ejemplos avanzados</span><span class="sxs-lookup"><span data-stu-id="2eafc-236">Advanced examples</span></span>

<span data-ttu-id="2eafc-237">El entorno Anaconda instalado en Azure Machine Learning contiene paquetes comunes como NumPy, SciPy y Scikits-Learn.</span><span class="sxs-lookup"><span data-stu-id="2eafc-237">The Anaconda environment installed in Azure Machine Learning contains common packages such as NumPy, SciPy, and Scikits-Learn.</span></span> <span data-ttu-id="2eafc-238">Estos paquetes se pueden usar de forma efectiva para distintas tareas de procesamiento de datos en una canalización de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="2eafc-238">These packages can be effectively used for various data processing tasks in a machine learning pipeline.</span></span> <span data-ttu-id="2eafc-239">Como ejemplo, el siguiente experimento y script muestra el uso de sistemas aprendices de conjunto de Scikits-Learn para calcular las puntuaciones de importancia de características de un conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-239">As an example, the following experiment and script illustrate the use of ensemble learners in Scikits-Learn to compute feature importance scores for a dataset.</span></span> <span data-ttu-id="2eafc-240">Las puntuaciones se pueden usar para realizar una selección supervisada de características antes de transmitirlas a otro modelo de aprendizaje automático.</span><span class="sxs-lookup"><span data-stu-id="2eafc-240">The scores can be used to perform supervised feature selection before being fed into another ML model.</span></span>

<span data-ttu-id="2eafc-241">Aquí se muestra la función de Python usada para calcular las puntuaciones de importancia y ordenar las características según esas puntuaciones:</span><span class="sxs-lookup"><span data-stu-id="2eafc-241">Here is the Python function used to compute the importance scores and order the features based on the scores:</span></span>

![imagen11](./media/machine-learning-execute-python-scripts/figure8.png)

<span data-ttu-id="2eafc-243">Figura 10.</span><span class="sxs-lookup"><span data-stu-id="2eafc-243">Figure 10.</span></span> <span data-ttu-id="2eafc-244">Función para clasificar características por puntuaciones.</span><span class="sxs-lookup"><span data-stu-id="2eafc-244">Function to rank features by scores.</span></span>
<span data-ttu-id="2eafc-245">  El siguiente experimento calcula y devuelve las puntuaciones de importancia de características en el conjunto de datos "Diabetes en los indios Pima" en Azure Machine Learning:</span><span class="sxs-lookup"><span data-stu-id="2eafc-245">  The following experiment then computes and returns the importance scores of features in the “Pima Indian Diabetes” dataset in Azure Machine Learning:</span></span>

<span data-ttu-id="2eafc-246">![image12](./media/machine-learning-execute-python-scripts/figure9a.png)
![image13](./media/machine-learning-execute-python-scripts/figure9b.png)</span><span class="sxs-lookup"><span data-stu-id="2eafc-246">![image12](./media/machine-learning-execute-python-scripts/figure9a.png)
![image13](./media/machine-learning-execute-python-scripts/figure9b.png)</span></span>    

<span data-ttu-id="2eafc-247">Figura 11.</span><span class="sxs-lookup"><span data-stu-id="2eafc-247">Figure 11.</span></span> <span data-ttu-id="2eafc-248">Experimento para clasificar las características del conjunto de datos Diabetes en los indios Pima.</span><span class="sxs-lookup"><span data-stu-id="2eafc-248">Experiment to rank features in the Pima Indian Diabetes dataset.</span></span>

## <a name="limitations"></a><span data-ttu-id="2eafc-249">Limitaciones</span><span class="sxs-lookup"><span data-stu-id="2eafc-249">Limitations</span></span>
<span data-ttu-id="2eafc-250">[Ejecutar script de Python][execute-python-script] actualmente tiene las siguientes limitaciones:</span><span class="sxs-lookup"><span data-stu-id="2eafc-250">The [Execute Python Script][execute-python-script] currently has the following limitations:</span></span>

1. <span data-ttu-id="2eafc-251">*Ejecución en espacio aislado.*</span><span class="sxs-lookup"><span data-stu-id="2eafc-251">*Sandboxed execution.*</span></span> <span data-ttu-id="2eafc-252">El tiempo de ejecución de Python actualmente se realiza en espacio aislado y, como resultado, no permite el acceso a la red o al sistema de archivos local de manera persistente.</span><span class="sxs-lookup"><span data-stu-id="2eafc-252">The Python runtime is currently sandboxed and, as a result, does not allow access to the network or to the local file system in a persistent manner.</span></span> <span data-ttu-id="2eafc-253">Todos los archivos guardados localmente son aislados y eliminados una vez que se finaliza el módulo.</span><span class="sxs-lookup"><span data-stu-id="2eafc-253">All files saved locally are isolated and deleted once the module finishes.</span></span> <span data-ttu-id="2eafc-254">El código Python no puede tener acceso a la mayoría de los directorios de la máquina en que se ejecuta, con la excepción del directorio actual y sus subdirectorios.</span><span class="sxs-lookup"><span data-stu-id="2eafc-254">The Python code cannot access most directories on the machine it runs on, the exception being the current directory and its subdirectories.</span></span>
2. <span data-ttu-id="2eafc-255">*Falta de compatibilidad con la depuración y desarrollo sofisticado.*</span><span class="sxs-lookup"><span data-stu-id="2eafc-255">*Lack of sophisticated development and debugging support.*</span></span> <span data-ttu-id="2eafc-256">El módulo Python actualmente no es compatible con características de IDE, como IntelliSense y depuración.</span><span class="sxs-lookup"><span data-stu-id="2eafc-256">The Python module currently does not support IDE features such as intellisense and debugging.</span></span> <span data-ttu-id="2eafc-257">Además, si se produce un error en el módulo en runtime, el seguimiento de la pila completo de Python está disponible.</span><span class="sxs-lookup"><span data-stu-id="2eafc-257">Also, if the module fails at runtime, the full Python stack trace is available.</span></span> <span data-ttu-id="2eafc-258">Pero debe verse en el registro de salida del módulo.</span><span class="sxs-lookup"><span data-stu-id="2eafc-258">But it must be viewed in the output log for the module.</span></span> <span data-ttu-id="2eafc-259">De momento se recomienda que los usuarios desarrollen y depuren scripts de Python en un entorno como IPython y luego importen el código al módulo.</span><span class="sxs-lookup"><span data-stu-id="2eafc-259">We currently recommend that you develop and debug Python scripts in an environment such as IPython and then import the code into the module.</span></span>
3. <span data-ttu-id="2eafc-260">*Salida de una trama de datos.*</span><span class="sxs-lookup"><span data-stu-id="2eafc-260">*Single data frame output.*</span></span> <span data-ttu-id="2eafc-261">El punto de entrada de Python solo tiene permitido devolver una trama de datos como salida.</span><span class="sxs-lookup"><span data-stu-id="2eafc-261">The Python entry point is only permitted to return a single data frame as output.</span></span> <span data-ttu-id="2eafc-262">Actualmente no es posible devolver objetos arbitrarios de Python, como modelos entrenados, directamente de vuelta al tiempo de ejecución de Aprendizaje automático de Azure.</span><span class="sxs-lookup"><span data-stu-id="2eafc-262">It is not currently possible to return arbitrary Python objects such as trained models directly back to the Azure Machine Learning runtime.</span></span> <span data-ttu-id="2eafc-263">Al igual que [Ejecutar script R][execute-r-script], que tiene la misma limitación, en muchos casos es posible incluir objetos en una matriz de bytes y luego devolverla dentro de una trama de datos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-263">Like [Execute R Script][execute-r-script], which has the same limitation, it is possible in many cases to pickle objects into a byte array and then return that inside of a data frame.</span></span>
4. <span data-ttu-id="2eafc-264">*Incapacidad para personalizar la instalación de Python*.</span><span class="sxs-lookup"><span data-stu-id="2eafc-264">*Inability to customize Python installation*.</span></span> <span data-ttu-id="2eafc-265">Actualmente, la única manera de agregar módulos personalizados de Python es a través del mecanismo de archivo ZIP descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="2eafc-265">Currently, the only way to add custom Python modules is via the zip file mechanism described earlier.</span></span> <span data-ttu-id="2eafc-266">A pesar de que esto es viable cuando se trata de módulos pequeños, es complicado para módulos de gran tamaño (especialmente para los módulos con DLL nativas) o para un gran número de módulos.</span><span class="sxs-lookup"><span data-stu-id="2eafc-266">While this is feasible for small modules, it is cumbersome for large modules (especially those with native DLLs) or a large number of modules.</span></span> 

## <a name="conclusions"></a><span data-ttu-id="2eafc-267">Conclusiones</span><span class="sxs-lookup"><span data-stu-id="2eafc-267">Conclusions</span></span>
<span data-ttu-id="2eafc-268">El módulo [Ejecutar script de Python][execute-python-script] permite que un científico de datos incorpore código Python existente en flujos de trabajo de aprendizaje automático hospedados en la nube en Azure Machine Learning y hacerlos operativos como parte de un servicio web.</span><span class="sxs-lookup"><span data-stu-id="2eafc-268">The [Execute Python Script][execute-python-script] module allows a data scientist to incorporate existing Python code into cloud-hosted machine learning workflows in Azure Machine Learning and to seamlessly operationalize them as part of a web service.</span></span> <span data-ttu-id="2eafc-269">El módulo de script de Python interopera de forma natural con otros módulos de Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2eafc-269">The Python script module interoperates naturally with other modules in Azure Machine Learning.</span></span> <span data-ttu-id="2eafc-270">El módulo se puede usar para una variedad de tareas que abarcan desde la exploración de datos al procesamiento previo y la extracción de características y, luego, a la evaluación y el procesamiento posterior de los resultados.</span><span class="sxs-lookup"><span data-stu-id="2eafc-270">The module can be used for a range of tasks from data exploration to pre-processing and feature extraction, and then to evaluation and post-processing of the results.</span></span> <span data-ttu-id="2eafc-271">El tiempo de ejecución de backend que se usa para la ejecución se basa en Anaconda, una distribución de Python comprobada y ampliamente usada.</span><span class="sxs-lookup"><span data-stu-id="2eafc-271">The backend runtime used for execution is based on Anaconda, a well-tested and widely used Python distribution.</span></span> <span data-ttu-id="2eafc-272">Este back-end facilita que los usuarios incorporen recursos de código existentes a la nube.</span><span class="sxs-lookup"><span data-stu-id="2eafc-272">This backend makes it simple for you to on-board existing code assets into the cloud.</span></span>

<span data-ttu-id="2eafc-273">Esperamos proporcionar una funcionalidad adicional al módulo [Ejecutar script de Python][execute-python-script], como la capacidad de entrenar y hacer operativos los modelos en Python y de agregar una mejor compatibilidad para el desarrollo y código de depuración en Azure Machine Learning Studio.</span><span class="sxs-lookup"><span data-stu-id="2eafc-273">We expect to provide additional functionality to the [Execute Python Script][execute-python-script] module such as the ability to train and operationalize models in Python and to add better support for the development and debugging code in Azure Machine Learning Studio.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2eafc-274">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="2eafc-274">Next steps</span></span>
<span data-ttu-id="2eafc-275">Para más información, vea el [Centro para desarrolladores de Python](https://azure.microsoft.com/develop/python/).</span><span class="sxs-lookup"><span data-stu-id="2eafc-275">For more information, see the [Python Developer Center](https://azure.microsoft.com/develop/python/).</span></span>

<!-- Module References -->
[execute-python-script]: https://msdn.microsoft.com/library/azure/cdb56f95-7f4c-404d-bde7-5bb972e6f232/
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
