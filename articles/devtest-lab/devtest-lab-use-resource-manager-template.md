---
title: "Visualización y uso de una plantilla de Azure Resource Manager en una máquina virtual | Microsoft Docs"
description: "Aprenda a usar la plantilla de Azure Resource Manager desde una máquina virtual para crear otras máquinas virtuales"
services: devtest-lab,virtual-machines,visual-studio-online
documentationcenter: na
author: tomarcher
manager: douge
editor: 
ms.assetid: a759d9ce-655c-4ac6-8834-cb29dd7d30dd
ms.service: devtest-lab
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/05/2017
ms.author: tarcher
ms.openlocfilehash: 12cdb61667f77215c894800d5c439235e767a26b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="use-a-virtual-machines-azure-resource-manager-template"></a><span data-ttu-id="63e30-103">Uso de una plantilla de Azure Resource Manager con una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="63e30-103">Use a virtual machine's Azure Resource Manager template</span></span>

<span data-ttu-id="63e30-104">Al crear una máquina virtual (VM) en DevTest Labs a través de [Azure Portal](http://go.microsoft.com/fwlink/p/?LinkID=525040), puede ver la plantilla de Azure Resource Manager antes de guardar la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="63e30-104">When you are creating a virtual machine (VM) in DevTest Labs through the [Azure portal](http://go.microsoft.com/fwlink/p/?LinkID=525040), you can view the Azure Resource Manager template before you save the VM.</span></span> <span data-ttu-id="63e30-105">La plantilla, a continuación, se puede usar como punto de partida para crear más máquinas virtuales de laboratorio con la misma configuración.</span><span class="sxs-lookup"><span data-stu-id="63e30-105">The template can then be used as a basis to create more lab VMs with the same settings.</span></span>

<span data-ttu-id="63e30-106">Este artículo describe cómo ver la plantilla de Resource Manager al crear una máquina virtual y cómo implementarla posteriormente para automatizar la creación de la misma máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="63e30-106">This article describes how to view the Resource Manager template when creating a VM, and how to deploy it later to automate creation of the same VM.</span></span>

## <a name="multi-vm-vs-single-vm-resource-manager-templates"></a><span data-ttu-id="63e30-107">Plantillas de Resource Manager de una sola máquina virtual o de varias</span><span class="sxs-lookup"><span data-stu-id="63e30-107">Multi-VM vs. single-VM Resource Manager templates</span></span>
<span data-ttu-id="63e30-108">Hay dos maneras de crear máquinas virtuales en DevTest Labs mediante una plantilla de Resource Manager: aprovisionar el recurso Microsoft.DevTestLab/labs/virtualmachines o el recurso Microsoft.Commpute/virtualmachines.</span><span class="sxs-lookup"><span data-stu-id="63e30-108">There are two ways to create VMs in DevTest Labs using a Resource Manager template: provision the Microsoft.DevTestLab/labs/virtualmachines resource or provision the Microsoft.Commpute/virtualmachines resource.</span></span> <span data-ttu-id="63e30-109">Cada una se utiliza en escenarios diferentes y requiere permisos distintos.</span><span class="sxs-lookup"><span data-stu-id="63e30-109">Each is used in different scenarios and require different permissions.</span></span>

- <span data-ttu-id="63e30-110">Las plantillas de Resource Manager que usan un tipo de recurso Microsoft.DevTestLab/labs/virtualmachines (tal y como se declara en la propiedad "resource" en la plantilla) pueden aprovisionar máquinas virtuales de laboratorio individuales.</span><span class="sxs-lookup"><span data-stu-id="63e30-110">Resource Manager templates that use a Microsoft.DevTestLab/labs/virtualmachines resource type (as declared in the “resource” property in the template) can provision individual lab VMs.</span></span> <span data-ttu-id="63e30-111">Cada máquina virtual aparecerá entonces como un único elemento en la lista de máquinas virtuales de DevTest Labs:</span><span class="sxs-lookup"><span data-stu-id="63e30-111">Each VM then shows up as a single item in the DevTest Labs virtual machines list:</span></span>

   ![Enumeración de máquinas virtuales como elementos únicos en la lista de máquinas virtuales de DevTest Labs](./media/devtest-lab-use-arm-template/devtestlab-lab-vm-single-item.png)

   <span data-ttu-id="63e30-113">Este tipo de plantilla de Resource Manager se puede aprovisionar a través del comando de Azure PowerShell **New-AzureRmResourceGroupDeployment** o mediante el comando de la CLI de Azure **az group deployment create**.</span><span class="sxs-lookup"><span data-stu-id="63e30-113">This type of Resource Manager template can be provisioned through the Azure PowerShell command **New-AzureRmResourceGroupDeployment** or through the Azure CLI command **az group deployment create**.</span></span> <span data-ttu-id="63e30-114">Se necesitan permisos de administrador, por lo que los usuarios asignados a un rol de usuario de DevTest Labs no pueden realizar la implementación.</span><span class="sxs-lookup"><span data-stu-id="63e30-114">It requires administrator permissions, so users who are assigned with a DevTest Labs user role can’t perform the deployment.</span></span> 

- <span data-ttu-id="63e30-115">Las plantillas de Resource Manager que usan un tipo de recurso Microsoft.Compute/virtualmachines pueden aprovisionar varias máquinas virtuales como un único entorno en la lista de máquinas virtuales de DevTest Labs:</span><span class="sxs-lookup"><span data-stu-id="63e30-115">Resource Manager templates that use a Microsoft.Compute/virtualmachines resource type can provision multiple VMs as a single environment in the DevTest Labs virtual machines list:</span></span>

   ![Enumeración de máquinas virtuales como elementos únicos en la lista de máquinas virtuales de DevTest Labs](./media/devtest-lab-use-arm-template/devtestlab-lab-vm-single-environment.png)

   <span data-ttu-id="63e30-117">Las máquinas virtuales en el mismo entorno pueden administrarse conjuntamente y compartir el mismo ciclo de vida.</span><span class="sxs-lookup"><span data-stu-id="63e30-117">VMs in the same environment can be managed together and share the same lifecycle.</span></span> <span data-ttu-id="63e30-118">Los usuarios asignados a un rol de usuario de DevTest Labs pueden crear entornos con esas plantillas, siempre y cuando el administrador haya configurado el laboratorio de ese modo.</span><span class="sxs-lookup"><span data-stu-id="63e30-118">Users who are assigned with a DevTest Labs user role can create environments using those templates as long as the administrator has configured the lab that way.</span></span>

<span data-ttu-id="63e30-119">El resto de este artículo describe las plantillas de Resource Manager que utilizan Mirosoft.DevTestLab/labs/virtualmachines.</span><span class="sxs-lookup"><span data-stu-id="63e30-119">The remainder of this article discusses Resource Manager templates that use Mirosoft.DevTestLab/labs/virtualmachines.</span></span> <span data-ttu-id="63e30-120">Los administradores de DevTest Labs las usan para automatizar la creación de máquinas virtuales de laboratorio (por ejemplo, las VM reclamables) o la generación de imágenes maestras (por ejemplo, la factoría de imágenes).</span><span class="sxs-lookup"><span data-stu-id="63e30-120">These are used by lab admins to automate lab VM creation (for example, claimable VMs) or golden image generation (for example, image factory).</span></span>

<span data-ttu-id="63e30-121">En [Procedimientos recomendados para crear plantillas de Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices) se ofrecen muchas directrices y sugerencias para ayudarle a crear plantillas de Azure Resource Manager confiables y fáciles de usar.</span><span class="sxs-lookup"><span data-stu-id="63e30-121">[Best practices for creating Azure Resource Manager templates](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices) offers many guidelines and suggestions to help you create Azure Resource Manager templates that are reliable and easy to use.</span></span>

## <a name="view-and-save-a-virtual-machines-resource-manager-template"></a><span data-ttu-id="63e30-122">Visualización y guardado de una plantilla de Resource Manager de una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="63e30-122">View and save a virtual machine's Resource Manager template</span></span>
1. <span data-ttu-id="63e30-123">Siga los pasos de [Creación de su primera máquina virtual en un laboratorio](devtest-lab-create-first-vm.md) para empezar a crear una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="63e30-123">Follow the steps at [Create your first VM in a lab](devtest-lab-create-first-vm.md) to begin creating a virtual machine.</span></span>
1. <span data-ttu-id="63e30-124">Escriba la información necesaria para la máquina virtual y agréguele cualquier artefacto que desee.</span><span class="sxs-lookup"><span data-stu-id="63e30-124">Enter the required information for your virtual machine and add any artifacts you want for this VM.</span></span>
1. <span data-ttu-id="63e30-125">En la parte inferior de la ventana Parámetros de configuración, elija **View ARM template** (Ver plantilla ARM).</span><span class="sxs-lookup"><span data-stu-id="63e30-125">At the bottom of the Configure settings window, choose **View ARM template**.</span></span>

   ![Botón View ARM template (Ver plantilla ARM)](./media/devtest-lab-use-arm-template/devtestlab-lab-view-rm-template.png)
1. <span data-ttu-id="63e30-127">Copie y guarde la plantilla de Resource Manager para usarla más adelante para crear otra máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="63e30-127">Copy and save the Resource Manager template to use later to create another virtual machine.</span></span>

   ![Plantilla de Resource Manager que guardar para usarla más adelante](./media/devtest-lab-use-arm-template/devtestlab-lab-copy-rm-template.png)

<span data-ttu-id="63e30-129">Después de guardar la plantilla de Resource Manager, debe actualizar la sección de parámetros de la plantilla para poder utilizarla.</span><span class="sxs-lookup"><span data-stu-id="63e30-129">After you have saved the Resource Manager template, you must update the parameters section of the template before you can use it.</span></span> <span data-ttu-id="63e30-130">Puede crear un archivo parameter.json que personalice solamente los parámetros, fuera de la plantilla de Resource Manager real.</span><span class="sxs-lookup"><span data-stu-id="63e30-130">You can create a parameter.json that customizes just the parameters, outside of the actual Resource Manager template.</span></span> 

![Personalización de parámetros con un archivo JSON](./media/devtest-lab-use-arm-template/devtestlab-lab-custom-params.png)

## <a name="deploy-a-resource-manager-template-to-create-a-vm"></a><span data-ttu-id="63e30-132">Implementación de una plantilla de Resource Manager para crear una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="63e30-132">Deploy a Resource Manager template to create a VM</span></span>
<span data-ttu-id="63e30-133">Después de guardar una plantilla de Resource Manager y personalizarla según sus necesidades, puede utilizarla para automatizar la creación de una máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="63e30-133">After you have saved a Resource Manager template and customized it for your needs, you can use it to automate VM creation.</span></span> <span data-ttu-id="63e30-134">En [Implementación de recursos con plantillas de Resource Manager y Azure PowerShell](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy) se describe cómo usar PowerShell de Azure con plantillas de Resource Manager para implementar recursos en Azure.</span><span class="sxs-lookup"><span data-stu-id="63e30-134">[Deploy resources with Resource Manager templates and Azure PowerShell](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy) describes how to use Azure PowerShell with Resource Manager templates to deploy your resources to Azure.</span></span> <span data-ttu-id="63e30-135">En [Implementación de recursos con plantillas de Resource Manager y CLI de Azure](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy-cli) se describe cómo usar CLI de Azure con plantillas de Resource Manager para implementar recursos en Azure.</span><span class="sxs-lookup"><span data-stu-id="63e30-135">[Deploy resources with Resource Manager templates and Azure CLI](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-template-deploy-cli) describes how to use Azure CLI with Resource Manager templates to deploy your resources to Azure.</span></span>

> [!NOTE]
> <span data-ttu-id="63e30-136">Solo un usuario con permisos de propietario de laboratorio puede crear máquinas virtuales desde una plantilla de Resource Manager con Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="63e30-136">Only a user with lab owner permissions can create VMs from a Resource Manager template by using Azure PowerShell.</span></span> <span data-ttu-id="63e30-137">Si desea automatizar la creación de máquinas virtuales mediante una plantilla de Resource Manager y solo tiene permisos de usuario, puede usar el comando [ **az lab vm create** de la CLI ](https://docs.microsoft.com/cli/azure/lab/vm#create).</span><span class="sxs-lookup"><span data-stu-id="63e30-137">If you want to automate VM creation using a Resource Manager template and you only have user permissions, you can use the [**az lab vm create** command in the CLI](https://docs.microsoft.com/cli/azure/lab/vm#create).</span></span>

### <a name="next-steps"></a><span data-ttu-id="63e30-138">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="63e30-138">Next steps</span></span>
* <span data-ttu-id="63e30-139">Aprenda a [crear entornos de varias máquinas virtuales con plantillas de Resource Manager](devtest-lab-create-environment-from-arm.md).</span><span class="sxs-lookup"><span data-stu-id="63e30-139">Learn how to [Create multi-VM environments with Resource Manager templates](devtest-lab-create-environment-from-arm.md).</span></span>
* <span data-ttu-id="63e30-140">Explore más plantillas Resource Manager de inicio rápido para la automatización de DevTest Labs desde el [repositorio público de GitHub de DevTest Labs](https://github.com/Azure/azure-quickstart-templates).</span><span class="sxs-lookup"><span data-stu-id="63e30-140">Explore more quick-start Resource Manager templates for DevTest Labs automation from the [public DevTest Labs GitHub repo](https://github.com/Azure/azure-quickstart-templates).</span></span>
