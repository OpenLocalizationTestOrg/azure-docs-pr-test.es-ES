---
title: "Depuración de microservicios de Azure en Windows | Microsoft Docs"
description: "Aprenda a supervisar y diagnosticar sus servicios creados con Service Fabric de Microsoft Azure en una máquina de desarrollo local."
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: edcc0631-ed2d-45a3-851d-2c4fa0f4a326
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/24/2017
ms.author: dekapur
ms.openlocfilehash: 08998340afb2f242b9a268331607b0d1ddb9b0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="monitor-and-diagnose-services-in-a-local-machine-development-setup"></a><span data-ttu-id="5e198-103">Supervisión y diagnóstico de servicios en una configuración de desarrollo de máquina local</span><span class="sxs-lookup"><span data-stu-id="5e198-103">Monitor and diagnose services in a local machine development setup</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="5e198-104">Windows</span><span class="sxs-lookup"><span data-stu-id="5e198-104">Windows</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)
> * [<span data-ttu-id="5e198-105">Linux</span><span class="sxs-lookup"><span data-stu-id="5e198-105">Linux</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally-linux.md)
> 
> 

<span data-ttu-id="5e198-106">Acciones como supervisar, detectar, diagnosticar y solucionar problemas permiten a los servicios continuar con una interrupción mínima de la experiencia del usuario.</span><span class="sxs-lookup"><span data-stu-id="5e198-106">Monitoring, detecting, diagnosing, and troubleshooting allow for services to continue with minimal disruption to the user experience.</span></span> <span data-ttu-id="5e198-107">Aunque la supervisión y el diagnóstico resultan fundamentales en un entorno de producción implementado real, la eficiencia dependerá de la adopción de un modelo similar durante el desarrollo de servicios para garantizar que funciona cuando pasa a una configuración del mundo real.</span><span class="sxs-lookup"><span data-stu-id="5e198-107">While monitoring and diagnostics are critical in an actual deployed production environment, the efficiency will depend on adopting a similar model during development of services to ensure they work when you move to a real-world setup.</span></span> <span data-ttu-id="5e198-108">Service Fabric facilita a los desarrolladores de servicio la implementación de diagnósticos que puede funcionar sin problemas en configuraciones de desarrollo local de máquina única y en configuraciones de clúster de producción del mundo real.</span><span class="sxs-lookup"><span data-stu-id="5e198-108">Service Fabric makes it easy for service developers to implement diagnostics that can seamlessly work across both single-machine local development setups and real-world production cluster setups.</span></span>

## <a name="event-tracing-for-windows"></a><span data-ttu-id="5e198-109">Seguimiento de eventos para Windows</span><span class="sxs-lookup"><span data-stu-id="5e198-109">Event Tracing for Windows</span></span>
<span data-ttu-id="5e198-110">[Seguimiento de eventos para Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) es la tecnología recomendada para los mensajes de seguimiento en Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5e198-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) is the recommended technology for tracing messages in Service Fabric.</span></span> <span data-ttu-id="5e198-111">Algunas de las ventajas del uso de ETW son:</span><span class="sxs-lookup"><span data-stu-id="5e198-111">Some benefits of using ETW are:</span></span>

* <span data-ttu-id="5e198-112">**ETW es rápido.**</span><span class="sxs-lookup"><span data-stu-id="5e198-112">**ETW is fast.**</span></span> <span data-ttu-id="5e198-113">Se creó como una tecnología de seguimiento que tiene un impacto mínimo en los tiempos de ejecución de código.</span><span class="sxs-lookup"><span data-stu-id="5e198-113">It was built as a tracing technology that has minimal impact on code execution times.</span></span>
* <span data-ttu-id="5e198-114">**El seguimiento de ETW funciona sin problemas en entornos de desarrollo locales y también en las instalaciones de clúster del mundo real.**</span><span class="sxs-lookup"><span data-stu-id="5e198-114">**ETW tracing works seamlessly across local development environments and also real-world cluster setups.**</span></span> <span data-ttu-id="5e198-115">Esto significa que no tiene que volver a escribir el código de seguimiento cuando está listo para implementar su código en un clúster real.</span><span class="sxs-lookup"><span data-stu-id="5e198-115">This  means you don't have to rewrite your tracing code when you are ready to deploy your code to a real cluster.</span></span>
* <span data-ttu-id="5e198-116">**El código de tejido del sistema de Service Fabric también usa ETW para el seguimiento interno.**</span><span class="sxs-lookup"><span data-stu-id="5e198-116">**Service Fabric system code also uses ETW for internal tracing.**</span></span> <span data-ttu-id="5e198-117">Esto le permite ver los seguimientos de aplicación intercalados con seguimientos de sistema de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5e198-117">This allows you to view your application traces interleaved with Service Fabric system traces.</span></span> <span data-ttu-id="5e198-118">También puede ayudarle a comprender más fácilmente las secuencias y las relaciones mutuas entre sus eventos y el código de la aplicación en el sistema subyacente.</span><span class="sxs-lookup"><span data-stu-id="5e198-118">It also helps you to more easily understand the sequences and interrelationships between your application code and events in the underlying system.</span></span>
* <span data-ttu-id="5e198-119">**Hay compatibilidad integrada en las herramientas de Visual Studio de Service Fabric para ver los eventos ETW.**</span><span class="sxs-lookup"><span data-stu-id="5e198-119">**There is built-in support in Service Fabric Visual Studio tools to view ETW events.**</span></span> <span data-ttu-id="5e198-120">Los eventos ETW aparecen en la vista Eventos de diagnóstico de Visual Studio una vez que Visual Studio se ha configurado correctamente con Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5e198-120">ETW events appear in the Diagnostic Events view of Visual Studio once Visual Studio is correctly configured with Service Fabric.</span></span> 

## <a name="view-service-fabric-system-events-in-visual-studio"></a><span data-ttu-id="5e198-121">Ver eventos del sistema de Service Fabric en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5e198-121">View Service Fabric system events in Visual Studio</span></span>
<span data-ttu-id="5e198-122">Service Fabric emite los eventos ETW para ayudar a los desarrolladores de aplicaciones a comprender qué ocurre en la plataforma.</span><span class="sxs-lookup"><span data-stu-id="5e198-122">Service Fabric emits ETW events to help application developers understand what's happening in the platform.</span></span> <span data-ttu-id="5e198-123">Si aún no lo ha hecho, siga los pasos descritos en [Creación de la primera aplicación de Service Fabric en Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="5e198-123">If you haven't already done so, go ahead and follow the steps in [Creating your first application in Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span></span> <span data-ttu-id="5e198-124">Esta información le ayudará a poner en funcionamiento una aplicación con el Visor de eventos de diagnóstico que muestra los mensajes de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="5e198-124">This information will help you get an application up and running with the Diagnostics Events Viewer showing the trace messages.</span></span>

1. <span data-ttu-id="5e198-125">Si la ventana de eventos de diagnóstico no aparece automáticamente, vaya a la pestaña **Vista** de Visual Studio, elija **Other Windows** (Otras ventanas) y, después, **Visor de eventos de diagnóstico**.</span><span class="sxs-lookup"><span data-stu-id="5e198-125">If the diagnostics events window does not automatically show, Go to the **View** tab in Visual Studio, choose **Other Windows** and then **Diagnostic Events Viewer**.</span></span>
2. <span data-ttu-id="5e198-126">Cada evento tiene información de metadatos estándar que indica el nodo, la aplicación y el servicio del que procede el evento.</span><span class="sxs-lookup"><span data-stu-id="5e198-126">Each event has standard metadata information that tells you the node, application and service the event is coming from.</span></span> <span data-ttu-id="5e198-127">También puede filtrar la lista de eventos mediante el cuadro **Filtrar eventos** de la parte superior de la ventana de eventos.</span><span class="sxs-lookup"><span data-stu-id="5e198-127">You can also filter the list of events by using the **Filter events** box at the top of the events window.</span></span> <span data-ttu-id="5e198-128">Por ejemplo, puede filtrar por **Nombre del nodo** o **Nombre del servicio**.</span><span class="sxs-lookup"><span data-stu-id="5e198-128">For example, you can filter on **Node Name** or **Service Name.**</span></span> <span data-ttu-id="5e198-129">Y si se está fijando en los detalles del evento, también puede pausar utilizando el botón **Pausar** situado en la parte superior de la ventana de eventos y reanudar más adelante sin pérdida de eventos.</span><span class="sxs-lookup"><span data-stu-id="5e198-129">And when you're looking at event details, you can also pause by using the **Pause** button at the top of the events window and resume later without any loss of events.</span></span>
   
   ![Visor de eventos de diagnósticos de Visual Studio](./media/service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally/DiagEventsExamples2.png)

## <a name="add-your-own-custom-traces-to-the-application-code"></a><span data-ttu-id="5e198-131">Agregue sus propios seguimientos personalizados al código de aplicación</span><span class="sxs-lookup"><span data-stu-id="5e198-131">Add your own custom traces to the application code</span></span>
<span data-ttu-id="5e198-132">Las plantillas de proyecto de Visual Studio de Service Fabric contienen código de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="5e198-132">The Service Fabric Visual Studio project templates contain sample code.</span></span> <span data-ttu-id="5e198-133">El código muestra cómo agregar los seguimientos de ETW de código de aplicación personalizado que aparecerán en el visor de ETW de Visual Studio junto con los seguimientos del sistema de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5e198-133">The code shows how to add custom application code ETW traces that show up in the Visual Studio ETW viewer alongside system traces from Service Fabric.</span></span> <span data-ttu-id="5e198-134">La ventaja de este método es que los metadatos se agregan automáticamente a los seguimientos y el Visor de eventos de diagnóstico de Visual Studio ya está configurado para mostrarlos.</span><span class="sxs-lookup"><span data-stu-id="5e198-134">The advantage of this method is that metadata is automatically added to traces, and the Visual Studio Diagnostic Events Viewer is already configured to display them.</span></span>

<span data-ttu-id="5e198-135">Para los proyectos creados desde las **plantillas de servicio** (con o sin estado), solo tiene que buscar la implementación de `RunAsync`:</span><span class="sxs-lookup"><span data-stu-id="5e198-135">For projects created from the **service templates** (stateless or stateful) just search for the `RunAsync` implementation:</span></span>

1. <span data-ttu-id="5e198-136">La llamada a `ServiceEventSource.Current.ServiceMessage` in the `RunAsync` muestra un ejemplo de un seguimiento de ETW personalizado desde el código de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5e198-136">The call to `ServiceEventSource.Current.ServiceMessage` in the `RunAsync` method shows an example of a custom ETW trace from the application code.</span></span>
2. <span data-ttu-id="5e198-137">En el archivo **ServiceEventSource.cs** encontrará una sobrecarga para el método `ServiceEventSource.ServiceMessage` que se debe usar para eventos de alta frecuencia causados por razones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="5e198-137">In the **ServiceEventSource.cs** file, you will find an overload for the `ServiceEventSource.ServiceMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="5e198-138">Para los proyectos creados desde las **plantillas de acto** (con o sin estado):</span><span class="sxs-lookup"><span data-stu-id="5e198-138">For projects created from the **actor templates** (stateless or stateful):</span></span>

1. <span data-ttu-id="5e198-139">Abra el archivo **"NombreProyecto".cs** donde *NombreProyecto* es el nombre que eligió para su proyecto de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5e198-139">Open the **"ProjectName".cs** file where *ProjectName* is the name you chose for your Visual Studio project.</span></span>  
2. <span data-ttu-id="5e198-140">Busque el código `ActorEventSource.Current.ActorMessage(this, "Doing Work");` en el método *DoWorkAsync* .</span><span class="sxs-lookup"><span data-stu-id="5e198-140">Find the code `ActorEventSource.Current.ActorMessage(this, "Doing Work");` in the *DoWorkAsync* method.</span></span>  <span data-ttu-id="5e198-141">Esto es un ejemplo de un seguimiento ETW personalizado creado a partir del código de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5e198-141">This is an example of a custom ETW trace written from application code.</span></span>  
3. <span data-ttu-id="5e198-142">En el archivo **ActorEventSource.cs** encontrará una sobrecarga para el método `ActorEventSource.ActorMessage` que se debe usar para los eventos de alta frecuencia causados por razones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="5e198-142">In file **ActorEventSource.cs**, you will find an overload for the `ActorEventSource.ActorMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="5e198-143">Después de agregar seguimiento ETW personalizado al código del servicio, puede crear, implementar y ejecutar la aplicación de nuevo para ver sus eventos en el Visor de eventos de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="5e198-143">After adding custom ETW tracing to your service code, you can build, deploy, and run the application again to see your event(s) in the Diagnostic Events Viewer.</span></span> <span data-ttu-id="5e198-144">Si depura la aplicación con **F5**, el Visor de eventos de diagnóstico se abrirá automáticamente.</span><span class="sxs-lookup"><span data-stu-id="5e198-144">If you debug the application with **F5**, the Diagnostic Events Viewer will open automatically.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5e198-145">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="5e198-145">Next steps</span></span>
<span data-ttu-id="5e198-146">El mismo código de seguimiento que agregó a la aplicación anterior para diagnósticos locales funcionará con las herramientas que puede usar para ver estos eventos al ejecutar la aplicación en un clúster de Azure.</span><span class="sxs-lookup"><span data-stu-id="5e198-146">The same tracing code that you added to your application above for local diagnostics will work with tools that you can use to view these events when running your application on an Azure cluster.</span></span> <span data-ttu-id="5e198-147">Consulte estos artículos que tratan sobre las distintas opciones de las herramientas y describen cómo puede configurarlas.</span><span class="sxs-lookup"><span data-stu-id="5e198-147">Check out these articles that discuss the different options for the tools and describe how you can set them up.</span></span>

* [<span data-ttu-id="5e198-148">Recopilación de registros con Diagnósticos de Azure</span><span class="sxs-lookup"><span data-stu-id="5e198-148">How to collect logs with Azure Diagnostics</span></span>](service-fabric-diagnostics-how-to-setup-wad.md)
* [<span data-ttu-id="5e198-149">Recopilación y agregación de eventos con EventFlow</span><span class="sxs-lookup"><span data-stu-id="5e198-149">Event aggregation and collection using EventFlow</span></span>](service-fabric-diagnostics-event-aggregation-eventflow.md)

