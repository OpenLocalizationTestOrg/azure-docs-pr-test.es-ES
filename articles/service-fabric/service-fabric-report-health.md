---
title: informes de estado de Service Fabric personalizados aaaAdd | Documentos de Microsoft
description: "Describe cómo informa toosend personalizada del estado de entidades de mantenimiento de tooAzure Service Fabric. Proporciona recomendaciones para diseñar e implementar informes de estado de calidad."
services: service-fabric
documentationcenter: .net
author: oanapl
manager: timlt
editor: 
ms.assetid: 0a00a7d2-510e-47d0-8aa8-24c851ea847f
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/19/2017
ms.author: oanapl
ms.openlocfilehash: 12c9f664e2a457b4e1e8f340873ca60ebcefb097
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="add-custom-service-fabric-health-reports"></a><span data-ttu-id="4daf1-104">Incorporación de informes de mantenimiento de Service Fabric personalizados</span><span class="sxs-lookup"><span data-stu-id="4daf1-104">Add custom Service Fabric health reports</span></span>
<span data-ttu-id="4daf1-105">Azure Service Fabric presenta un [modelo de estado](service-fabric-health-introduction.md) diseñado tooflag clúster en mal estado y las condiciones de aplicación en entidades concretas.</span><span class="sxs-lookup"><span data-stu-id="4daf1-105">Azure Service Fabric introduces a [health model](service-fabric-health-introduction.md) designed tooflag unhealthy cluster and application conditions on specific entities.</span></span> <span data-ttu-id="4daf1-106">usa el modelo de estado de Hello **Informadores mantenimiento** (componentes del sistema y watchdogs).</span><span class="sxs-lookup"><span data-stu-id="4daf1-106">hello health model uses **health reporters** (system components and watchdogs).</span></span> <span data-ttu-id="4daf1-107">objetivo de Hello es fácil y rápido un diagnóstico más detallado y reparación.</span><span class="sxs-lookup"><span data-stu-id="4daf1-107">hello goal is easy and fast diagnosis and repair.</span></span> <span data-ttu-id="4daf1-108">Escritores del servicio necesitan toothink por adelantado sobre el estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-108">Service writers need toothink upfront about health.</span></span> <span data-ttu-id="4daf1-109">Cualquier condición que puede afectar el estado debería aparecer en, sobre todo si puede ayudar a problemas de marca cerrar toohello raíz.</span><span class="sxs-lookup"><span data-stu-id="4daf1-109">Any condition that can impact health should be reported on, especially if it can help flag problems close toohello root.</span></span> <span data-ttu-id="4daf1-110">información de estado de Hello puede ahorrar tiempo y esfuerzo de la depuración y la investigación.</span><span class="sxs-lookup"><span data-stu-id="4daf1-110">hello health information can save time and effort on debugging and investigation.</span></span> <span data-ttu-id="4daf1-111">Hello utilidad es especialmente claro una vez que el servicio Hola está en funcionamiento a escala en la nube de hello (privada o Azure).</span><span class="sxs-lookup"><span data-stu-id="4daf1-111">hello usefulness is especially clear once hello service is up and running at scale in hello cloud (private or Azure).</span></span>

<span data-ttu-id="4daf1-112">monitor de Informadores de Service Fabric Hola identifica las condiciones de interés.</span><span class="sxs-lookup"><span data-stu-id="4daf1-112">hello Service Fabric reporters monitor identified conditions of interest.</span></span> <span data-ttu-id="4daf1-113">Informan sobre esas condiciones en función de su vista local.</span><span class="sxs-lookup"><span data-stu-id="4daf1-113">They report on those conditions based on their local view.</span></span> <span data-ttu-id="4daf1-114">Hola [almacén de estado](service-fabric-health-introduction.md#health-store) agrega datos de estado enviados por todos los toodetermine Informadores si las entidades son globalmente correcto.</span><span class="sxs-lookup"><span data-stu-id="4daf1-114">hello [health store](service-fabric-health-introduction.md#health-store) aggregates health data sent by all reporters toodetermine whether entities are globally healthy.</span></span> <span data-ttu-id="4daf1-115">modelo de Hello es toouse enriquecido, flexible y fácil de toobe previsto.</span><span class="sxs-lookup"><span data-stu-id="4daf1-115">hello model is intended toobe rich, flexible, and easy toouse.</span></span> <span data-ttu-id="4daf1-116">calidad de Hola de informes de estado de hello determina la precisión de Hola de vista de estado de Hola de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-116">hello quality of hello health reports determines hello accuracy of hello health view of hello cluster.</span></span> <span data-ttu-id="4daf1-117">Los falsos positivos que muestran erróneamente problemas pueden afectar negativamente a las actualizaciones u otros servicios que usan datos de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="4daf1-117">False positives that wrongly show unhealthy issues can negatively impact upgrades or other services that use health data.</span></span> <span data-ttu-id="4daf1-118">Ejemplos de estos servicios son los servicios de reparación y los mecanismos de alerta.</span><span class="sxs-lookup"><span data-stu-id="4daf1-118">Examples of such services are repair services and alerting mechanisms.</span></span> <span data-ttu-id="4daf1-119">Por lo tanto, algunas consideraciones es informes tooprovide necesarios que capturan las condiciones de interés en hello mejor manera posible.</span><span class="sxs-lookup"><span data-stu-id="4daf1-119">Therefore, some thought is needed tooprovide reports that capture conditions of interest in hello best possible way.</span></span>

<span data-ttu-id="4daf1-120">deben toodesign e implementar componentes de informes, watchdogs y sistema de estado:</span><span class="sxs-lookup"><span data-stu-id="4daf1-120">toodesign and implement health reporting, watchdogs and system components must:</span></span>

* <span data-ttu-id="4daf1-121">Definir condición de Hola que le interesa, hello y modo de saludo que se está supervisando impacto en la funcionalidad de clúster o una aplicación Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-121">Define hello condition they are interested in, hello way it is monitored, and hello impact on hello cluster or application functionality.</span></span> <span data-ttu-id="4daf1-122">En función de esta información, decidir Hola estado de mantenimiento informe propiedad y el estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-122">Based on this information, decide on hello health report property and health state.</span></span>
* <span data-ttu-id="4daf1-123">Determinar hello [entidad](service-fabric-health-introduction.md#health-entities-and-hierarchy) que informe de Hola se aplica a.</span><span class="sxs-lookup"><span data-stu-id="4daf1-123">Determine hello [entity](service-fabric-health-introduction.md#health-entities-and-hierarchy) that hello report applies to.</span></span>
* <span data-ttu-id="4daf1-124">Determinar donde se realiza el reporting hello, desde Hola guardián de servicio o desde una interno o externo.</span><span class="sxs-lookup"><span data-stu-id="4daf1-124">Determine where hello reporting is done, from within hello service or from an internal or external watchdog.</span></span>
* <span data-ttu-id="4daf1-125">Definir un indicador de origen usa tooidentify Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-125">Define a source used tooidentify hello reporter.</span></span>
* <span data-ttu-id="4daf1-126">Elegir una estrategia de generación de informes, periódicamente o en las transiciones.</span><span class="sxs-lookup"><span data-stu-id="4daf1-126">Choose a reporting strategy, either periodically or on transitions.</span></span> <span data-ttu-id="4daf1-127">Hola recomienda forma periódicamente, tal y como requiere código más sencillo y menos propenso tooerrors.</span><span class="sxs-lookup"><span data-stu-id="4daf1-127">hello recommended way is periodically, as it requires simpler code and is less prone tooerrors.</span></span>
* <span data-ttu-id="4daf1-128">Determinar cuánto informe Hola para condiciones de mal estadas deben permanecer en el almacén de estado de Hola y cómo debe borrarse.</span><span class="sxs-lookup"><span data-stu-id="4daf1-128">Determine how long hello report for unhealthy conditions should stay in hello health store and how it should be cleared.</span></span> <span data-ttu-id="4daf1-129">Con esta información, decida el comportamiento de toolive y remove de expiración de tiempo del informe de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-129">Using this information, decide hello report's time toolive and remove-on-expiration behavior.</span></span>

<span data-ttu-id="4daf1-130">Tal y como se ha mencionado, la creación de informes puede realizarse desde:</span><span class="sxs-lookup"><span data-stu-id="4daf1-130">As mentioned, reporting can be done from:</span></span>

* <span data-ttu-id="4daf1-131">Hola supervisa réplicas del servicio de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4daf1-131">hello monitored Service Fabric service replica.</span></span>
* <span data-ttu-id="4daf1-132">Guardianes internos implementados como un servicio de Service Fabric (por ejemplo, un servicio sin estado de Service Fabric que supervisa las condiciones y los informes de problemas).</span><span class="sxs-lookup"><span data-stu-id="4daf1-132">Internal watchdogs deployed as a Service Fabric service (for example, a Service Fabric stateless service that monitors conditions and issues reports).</span></span> <span data-ttu-id="4daf1-133">pueden ser watchdogs Hola implementa un todos los nodos o puede ser servicio de afinidad toohello supervisado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-133">hello watchdogs can be deployed an all nodes or can be affinitized toohello monitored service.</span></span>
* <span data-ttu-id="4daf1-134">Watchdogs internos que se ejecutan en nodos de Service Fabric Hola pero son *no* implementados como servicios de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4daf1-134">Internal watchdogs that run on hello Service Fabric nodes but are *not* implemented as Service Fabric services.</span></span>
* <span data-ttu-id="4daf1-135">Externo watchdogs ese recurso Hola de sondeo de *fuera* clúster de Service Fabric hello (por ejemplo, servicio de supervisión como Gomez).</span><span class="sxs-lookup"><span data-stu-id="4daf1-135">External watchdogs that probe hello resource from *outside* hello Service Fabric cluster (for example, monitoring service like Gomez).</span></span>

> [!NOTE]
> <span data-ttu-id="4daf1-136">Desde el principio de hello, clúster de Hola se rellena con informes de estado enviados por componentes del sistema Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-136">Out of hello box, hello cluster is populated with health reports sent by hello system components.</span></span> <span data-ttu-id="4daf1-137">Lea más en [Uso de informes de mantenimiento del sistema para solucionar problemas](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span><span class="sxs-lookup"><span data-stu-id="4daf1-137">Read more at [Using system health reports for troubleshooting](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span></span> <span data-ttu-id="4daf1-138">Hello informes de usuario deben enviarse en [entidades de mantenimiento](service-fabric-health-introduction.md#health-entities-and-hierarchy) que ya se han creado por el sistema de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-138">hello user reports must be sent on [health entities](service-fabric-health-introduction.md#health-entities-and-hierarchy) that have already been created by hello system.</span></span>
> 
> 

<span data-ttu-id="4daf1-139">Una vez hello diseño informes de estado está desactivada, se pueden enviar fácilmente informes de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="4daf1-139">Once hello health reporting design is clear, health reports can be sent easily.</span></span> <span data-ttu-id="4daf1-140">Puede usar [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport estado si el clúster hello no está [segura](service-fabric-cluster-security.md) o si los clientes de fabric hello tiene privilegios de administrador.</span><span class="sxs-lookup"><span data-stu-id="4daf1-140">You can use [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport health if hello cluster is not [secure](service-fabric-cluster-security.md) or if hello fabric client has admin privileges.</span></span> <span data-ttu-id="4daf1-141">Reporting puede realizarse a través de hello API por mediante [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), a través de PowerShell o a través de REST.</span><span class="sxs-lookup"><span data-stu-id="4daf1-141">Reporting can be done through hello API by using [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), through PowerShell, or through REST.</span></span> <span data-ttu-id="4daf1-142">Los botones de configuración procesan los informes por lotes para un mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="4daf1-142">Configuration knobs batch reports for improved performance.</span></span>

> [!NOTE]
> <span data-ttu-id="4daf1-143">Informe de mantenimiento es sincrónico y representa solo Hola trabajo de validación en el lado del cliente de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-143">Report health is synchronous, and it represents only hello validation work on hello client side.</span></span> <span data-ttu-id="4daf1-144">hecho de que los informes de Hola Hola se acepta una por el cliente de mantenimiento de Hola o hello `Partition` o `CodePackageActivationContext` objetos no significa que se aplica en el almacén de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-144">hello fact that hello report is accepted by hello health client or hello `Partition` or `CodePackageActivationContext` objects doesn't mean that it is applied in hello store.</span></span> <span data-ttu-id="4daf1-145">Se envía de forma asincrónica y posiblemente por lotes con otros informes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-145">It is sent asynchronously and possibly batched with other reports.</span></span> <span data-ttu-id="4daf1-146">Hola está procesando en el servidor de hello todavía puede producir un error: número de secuencia de hello podría ser obsoleto, entidad hello en qué Hola debe aplicarse el informe se ha eliminado, etcetera.</span><span class="sxs-lookup"><span data-stu-id="4daf1-146">hello processing on hello server may still fail: hello sequence number could be stale, hello entity on which hello report must be applied has been deleted, etc.</span></span>
> 
> 

## <a name="health-client"></a><span data-ttu-id="4daf1-147">Cliente de mantenimiento</span><span class="sxs-lookup"><span data-stu-id="4daf1-147">Health client</span></span>
<span data-ttu-id="4daf1-148">se envían informes de estado de Hello toohello de almacén de estado a través de un cliente de mantenimiento, que se encuentra dentro de los clientes de fabric de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-148">hello health reports are sent toohello health store through a health client, which lives inside hello fabric client.</span></span> <span data-ttu-id="4daf1-149">cliente de mantenimiento de Hello puede configurarse con hello después de la configuración:</span><span class="sxs-lookup"><span data-stu-id="4daf1-149">hello health client can be configured with hello following settings:</span></span>

* <span data-ttu-id="4daf1-150">**HealthReportSendInterval**: retraso de hello entre informe Hola Hola es agregado toohello tiempo de hello y cliente que se envíe el almacén de estado de toohello.</span><span class="sxs-lookup"><span data-stu-id="4daf1-150">**HealthReportSendInterval**: hello delay between hello time hello report is added toohello client and hello time it is sent toohello health store.</span></span> <span data-ttu-id="4daf1-151">Informes de toobatch usado en un único mensaje, en lugar de enviar un mensaje para cada informe.</span><span class="sxs-lookup"><span data-stu-id="4daf1-151">Used toobatch reports into a single message, rather than sending one message for each report.</span></span> <span data-ttu-id="4daf1-152">Hola, procesamiento por lotes mejora el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="4daf1-152">hello batching improves performance.</span></span> <span data-ttu-id="4daf1-153">Valor predeterminado: 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-153">Default: 30 seconds.</span></span>
* <span data-ttu-id="4daf1-154">**HealthReportRetrySendInterval**: intervalo de saludo en qué Hola cliente de mantenimiento, vuelve a enviar estado acumulado informa de almacén de estado de toohello.</span><span class="sxs-lookup"><span data-stu-id="4daf1-154">**HealthReportRetrySendInterval**: hello interval at which hello health client resends accumulated health reports toohello health store.</span></span> <span data-ttu-id="4daf1-155">Valor predeterminado: 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-155">Default: 30 seconds.</span></span>
* <span data-ttu-id="4daf1-156">**HealthOperationTimeout**: tiempo de espera de Hola para un mensaje de informe enviado toohello almacén de estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-156">**HealthOperationTimeout**: hello timeout period for a report message sent toohello health store.</span></span> <span data-ttu-id="4daf1-157">Si un mensaje de tiempo de espera, cliente de mantenimiento de hello lo reintenta hasta que el almacén de estado de hello confirma que se ha procesado el informe de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-157">If a message times out, hello health client retries it until hello health store confirms that hello report has been processed.</span></span> <span data-ttu-id="4daf1-158">Valor predeterminado: dos minutos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-158">Default: two minutes.</span></span>

> [!NOTE]
> <span data-ttu-id="4daf1-159">Cuando se procesan por lotes informes Hola, cliente de tejido de hello debe se mantenga para al menos Hola tooensure HealthReportSendInterval que se envían.</span><span class="sxs-lookup"><span data-stu-id="4daf1-159">When hello reports are batched, hello fabric client must be kept alive for at least hello HealthReportSendInterval tooensure that they are sent.</span></span> <span data-ttu-id="4daf1-160">Si se pierde el mensaje de Hola o almacén de estado de hello no puede aplicar debido a errores de tootransient, clientes de fabric Hola deben mantenerse activo toogive más un tooretry de oportunidad.</span><span class="sxs-lookup"><span data-stu-id="4daf1-160">If hello message is lost or hello health store cannot apply them due tootransient errors, hello fabric client must be kept alive longer toogive it a chance tooretry.</span></span>
> 
> 

<span data-ttu-id="4daf1-161">Hola de almacenamiento en búfer en el cliente de hello toma unicidad Hola de informes de hello en consideración.</span><span class="sxs-lookup"><span data-stu-id="4daf1-161">hello buffering on hello client takes hello uniqueness of hello reports into consideration.</span></span> <span data-ttu-id="4daf1-162">Por ejemplo, si un determinado indicador incorrecto está informando de 100 informes por segundo en hello misma propiedad de hello misma entidad, Hola informes se reemplazan con la última versión de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-162">For example, if a particular bad reporter is reporting 100 reports per second on hello same property of hello same entity, hello reports are replaced with hello last version.</span></span> <span data-ttu-id="4daf1-163">A lo sumo una dicho informe existe en la cola del cliente Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-163">At most one such report exists in hello client queue.</span></span> <span data-ttu-id="4daf1-164">Si se configura el procesamiento por lotes, número Hola de informes envía toohello almacén de estado es simplemente una por intervalo de envío.</span><span class="sxs-lookup"><span data-stu-id="4daf1-164">If batching is configured, hello number of reports sent toohello health store is just one per send interval.</span></span> <span data-ttu-id="4daf1-165">Este informe es Hola último agregado, que reflejan el estado más reciente de Hola de entidad de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-165">This report is hello last added report, which reflects hello most current state of hello entity.</span></span>
<span data-ttu-id="4daf1-166">Especificar parámetros de configuración cuando `FabricClient` se crea pasando [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) con hello los valores deseados para las entradas relacionadas con el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="4daf1-166">Specify configuration parameters when `FabricClient` is created by passing [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) with hello desired values for health-related entries.</span></span>

<span data-ttu-id="4daf1-167">Hello en el ejemplo siguiente se crea a un cliente de tejido y especifica que se deberían enviar informes de hello cuando se agregan.</span><span class="sxs-lookup"><span data-stu-id="4daf1-167">hello following example creates a fabric client and specifies that hello reports should be sent when they are added.</span></span> <span data-ttu-id="4daf1-168">En tiempos de espera y errores que se pueden reintentar, los reintentos se producen cada 40 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-168">On timeouts and errors that can be retried, retries happen every 40 seconds.</span></span>

```csharp
var clientSettings = new FabricClientSettings()
{
    HealthOperationTimeout = TimeSpan.FromSeconds(120),
    HealthReportSendInterval = TimeSpan.FromSeconds(0),
    HealthReportRetrySendInterval = TimeSpan.FromSeconds(40),
};
var fabricClient = new FabricClient(clientSettings);
```

<span data-ttu-id="4daf1-169">Se recomienda mantener el tejido de Hola de forma predeterminada la configuración de cliente, que establece `HealthReportSendInterval` too30 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-169">We recommend keeping hello default fabric client settings, which set `HealthReportSendInterval` too30 seconds.</span></span> <span data-ttu-id="4daf1-170">Esta configuración garantiza un rendimiento óptimo toobatching due.</span><span class="sxs-lookup"><span data-stu-id="4daf1-170">This setting ensures optimal performance due toobatching.</span></span> <span data-ttu-id="4daf1-171">Para los informes importantes que se deban enviar tan pronto como sea posible, utilice `HealthReportSendOptions` con la marca Immediate establecida en `true` en la API [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth).</span><span class="sxs-lookup"><span data-stu-id="4daf1-171">For critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true` in [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span></span> <span data-ttu-id="4daf1-172">Informes inmediatos omiten Hola intervalo de procesamiento por lotes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-172">Immediate reports bypass hello batching interval.</span></span> <span data-ttu-id="4daf1-173">Utilice este indicador con cuidado; queremos tootake ventaja del cliente de mantenimiento de hello procesamiento por lotes siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="4daf1-173">Use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span> <span data-ttu-id="4daf1-174">Envío inmediato también es útil cuando se está cerrando el cliente de tejido de hello (por ejemplo, el proceso de hello ha determinado el estado no válido y debe tooshut hacia abajo de los efectos secundarios de tooprevent).</span><span class="sxs-lookup"><span data-stu-id="4daf1-174">Immediate send is also useful when hello fabric client is closing (for example, hello process has determined invalid state and needs tooshut down tooprevent side effects).</span></span> <span data-ttu-id="4daf1-175">Garantiza un envío de mejor esfuerzo de informes de hello acumulado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-175">It ensures a best-effort send of hello accumulated reports.</span></span> <span data-ttu-id="4daf1-176">Cuando se agrega un informe con la marca de inmediato, cliente de mantenimiento de hello lotes de todos los informes de hello acumulado desde el último envío.</span><span class="sxs-lookup"><span data-stu-id="4daf1-176">When one report is added with Immediate flag, hello health client batches all hello accumulated reports since last send.</span></span>

<span data-ttu-id="4daf1-177">Parámetros de la mismas pueden especificarse cuando se crea un clúster de tooa de conexión a través de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4daf1-177">Same parameters can be specified when a connection tooa cluster is created through PowerShell.</span></span> <span data-ttu-id="4daf1-178">Hola ejemplo siguiente inicia un clúster local de tooa de conexión:</span><span class="sxs-lookup"><span data-stu-id="4daf1-178">hello following example starts a connection tooa local cluster:</span></span>

```powershell
PS C:\> Connect-ServiceFabricCluster -HealthOperationTimeoutInSec 120 -HealthReportSendIntervalInSec 0 -HealthReportRetrySendIntervalInSec 40
True

ConnectionEndpoint   :
FabricClientSettings : {
                       ClientFriendlyName                   : PowerShell-1944858a-4c6d-465f-89c7-9021c12ac0bb
                       PartitionLocationCacheLimit          : 100000
                       PartitionLocationCacheBucketCount    : 1024
                       ServiceChangePollInterval            : 00:02:00
                       ConnectionInitializationTimeout      : 00:00:02
                       KeepAliveInterval                    : 00:00:20
                       HealthOperationTimeout               : 00:02:00
                       HealthReportSendInterval             : 00:00:00
                       HealthReportRetrySendInterval        : 00:00:40
                       NotificationGatewayConnectionTimeout : 00:00:00
                       NotificationCacheUpdateTimeout       : 00:00:00
                       }
GatewayInformation   : {
                       NodeAddress                          : localhost:19000
                       NodeId                               : 1880ec88a3187766a6da323399721f53
                       NodeInstanceId                       : 130729063464981219
                       NodeName                             : Node.1
                       }
```

<span data-ttu-id="4daf1-179">De igual forma tooAPI, los informes pueden enviarse mediante `-Immediate` cambiar toobe enviado inmediatamente, sin tener en cuenta hello `HealthReportSendInterval` valor.</span><span class="sxs-lookup"><span data-stu-id="4daf1-179">Similarly tooAPI, reports can be sent using `-Immediate` switch toobe sent immediately, regardless of hello `HealthReportSendInterval` value.</span></span>

<span data-ttu-id="4daf1-180">Para REST, Hola informes se envían toohello Service Fabric puerta de enlace, que tiene un cliente de fabric interno.</span><span class="sxs-lookup"><span data-stu-id="4daf1-180">For REST, hello reports are sent toohello Service Fabric gateway, which has an internal fabric client.</span></span> <span data-ttu-id="4daf1-181">De forma predeterminada, este cliente está informes toosend configurado por lotes cada 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-181">By default, this client is configured toosend reports batched every 30 seconds.</span></span> <span data-ttu-id="4daf1-182">Puede cambiar el intervalo de lote de saludo con la opción de configuración de clúster de hello `HttpGatewayHealthReportSendInterval` en `HttpGateway`.</span><span class="sxs-lookup"><span data-stu-id="4daf1-182">You can change hello batch interval with hello cluster configuration setting `HttpGatewayHealthReportSendInterval` on `HttpGateway`.</span></span> <span data-ttu-id="4daf1-183">Como se mencionó, la mejor opción es toosend Hola informes con `Immediate` es true.</span><span class="sxs-lookup"><span data-stu-id="4daf1-183">As mentioned, a better option is toosend hello reports with `Immediate` true.</span></span> 

> [!NOTE]
> <span data-ttu-id="4daf1-184">tooensure que los servicios desautorizados no podrá informar de mantenimiento con las entidades de hello en clúster de hello, configurar las solicitudes de hello server tooaccept solo desde clientes protegidos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-184">tooensure that unauthorized services can't report health against hello entities in hello cluster, configure hello server tooaccept requests only from secured clients.</span></span> <span data-ttu-id="4daf1-185">Hola `FabricClient` emplea para la notificación debe haber seguridad habilitado toobe toocommunicate pueda con clúster de hello (por ejemplo, con la autenticación Kerberos o certificados).</span><span class="sxs-lookup"><span data-stu-id="4daf1-185">hello `FabricClient` used for reporting must have security enabled toobe able toocommunicate with hello cluster (for example, with Kerberos or certificate authentication).</span></span> <span data-ttu-id="4daf1-186">Obtenga más información sobre la [seguridad del clúster](service-fabric-cluster-security.md).</span><span class="sxs-lookup"><span data-stu-id="4daf1-186">Read more about [cluster security](service-fabric-cluster-security.md).</span></span>
> 
> 

## <a name="report-from-within-low-privilege-services"></a><span data-ttu-id="4daf1-187">Informes desde servicios con pocos privilegios</span><span class="sxs-lookup"><span data-stu-id="4daf1-187">Report from within low privilege services</span></span>
<span data-ttu-id="4daf1-188">Si Servicios de Service Fabric no tiene clústeres de toohello de acceso de administrador, puede crear informes de mantenimiento en entidades de contexto actual de Hola a través de `Partition` o `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="4daf1-188">If Service Fabric services do not have admin access toohello cluster, you can report health on entities from hello current context through `Partition` or `CodePackageActivationContext`.</span></span>

* <span data-ttu-id="4daf1-189">Para los servicios sin estado, use [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport en la instancia de servicio actual de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-189">For stateless services, use [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport on hello current service instance.</span></span>
* <span data-ttu-id="4daf1-190">Para los servicios con estado, use [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport en la réplica actual.</span><span class="sxs-lookup"><span data-stu-id="4daf1-190">For stateful services, use [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport on current replica.</span></span>
* <span data-ttu-id="4daf1-191">Use [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport en la entidad de partición actual de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-191">Use [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport on hello current partition entity.</span></span>
* <span data-ttu-id="4daf1-192">Use [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport en la aplicación actual.</span><span class="sxs-lookup"><span data-stu-id="4daf1-192">Use [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport on current application.</span></span>
* <span data-ttu-id="4daf1-193">Use [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport en la aplicación actual Hola implementada en el nodo actual de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-193">Use [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport on hello current application deployed on hello current node.</span></span>
* <span data-ttu-id="4daf1-194">Use [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport en un paquete de servicios de aplicación Hola implementada en el nodo actual de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-194">Use [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport on a service package for hello application deployed on hello current node.</span></span>

> [!NOTE]
> <span data-ttu-id="4daf1-195">Internamente, Hola `Partition` hello y `CodePackageActivationContext` mantenga un cliente de mantenimiento configurado con la configuración predeterminada.</span><span class="sxs-lookup"><span data-stu-id="4daf1-195">Internally, hello `Partition` and hello `CodePackageActivationContext` hold a health client configured with default settings.</span></span> <span data-ttu-id="4daf1-196">Como se explica para hello [cliente mantenimiento](service-fabric-report-health.md#health-client), los informes son por lotes y se envía un temporizador.</span><span class="sxs-lookup"><span data-stu-id="4daf1-196">As explained for hello [health client](service-fabric-report-health.md#health-client), reports are batched and sent on a timer.</span></span> <span data-ttu-id="4daf1-197">Hola objetos deben ser mantiene activo toohave un informe de hello toosend de oportunidad.</span><span class="sxs-lookup"><span data-stu-id="4daf1-197">hello objects should be kept alive toohave a chance toosend hello report.</span></span>
> 
> 

<span data-ttu-id="4daf1-198">Puede especificar `HealthReportSendOptions` al enviar informes a través de las API de mantenimiento `Partition` y `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="4daf1-198">You can specify `HealthReportSendOptions` when sending reports through `Partition` and `CodePackageActivationContext` health APIs.</span></span> <span data-ttu-id="4daf1-199">Si tiene informes importantes que deben enviarse tan pronto como sea posible, use `HealthReportSendOptions` con la marca Inmediate establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="4daf1-199">If you have critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true`.</span></span> <span data-ttu-id="4daf1-200">Informes inmediatos omiten Hola intervalo de cliente de estado interno de Hola de procesamiento por lotes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-200">Immediate reports bypass hello batching interval of hello internal health client.</span></span> <span data-ttu-id="4daf1-201">Como se mencionó antes, utilice este indicador con cuidado; queremos tootake ventaja del cliente de mantenimiento de hello procesamiento por lotes siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="4daf1-201">As mentioned before, use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span>

## <a name="design-health-reporting"></a><span data-ttu-id="4daf1-202">Informes de estado del diseño</span><span class="sxs-lookup"><span data-stu-id="4daf1-202">Design health reporting</span></span>
<span data-ttu-id="4daf1-203">Hello primer paso para generar informes de alta calidad es identificar condiciones de Hola que pueden afectar Hola estado del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-203">hello first step in generating high-quality reports is identifying hello conditions that can impact hello health of hello service.</span></span> <span data-ttu-id="4daf1-204">Las condiciones que pueden ayudar a problemas de marca de servicio de Hola o clúster cuando se inicia, o incluso mejor, antes de que ocurra un problema, puede guardar miles de millones de dólares.</span><span class="sxs-lookup"><span data-stu-id="4daf1-204">Any condition that can help flag problems in hello service or cluster when it starts--or even better, before a problem happens--can potentially save billions of dollars.</span></span> <span data-ttu-id="4daf1-205">ventajas de Hello incluyen menor tiempo de inactividad, menos horas de noche dedicado a investigar y solucionar problemas y mayor satisfacción del cliente.</span><span class="sxs-lookup"><span data-stu-id="4daf1-205">hello benefits include less down time, fewer night hours spent investigating and repairing issues, and higher customer satisfaction.</span></span>

<span data-ttu-id="4daf1-206">Una vez que se identifican las condiciones de hello, escritores de guardián deben toofigure out toomonitor Hola de manera recomendada para equilibrar la carga y utilidad.</span><span class="sxs-lookup"><span data-stu-id="4daf1-206">Once hello conditions are identified, watchdog writers need toofigure out hello best way toomonitor them for balance between overhead and usefulness.</span></span> <span data-ttu-id="4daf1-207">Por ejemplo, considere un servicio que realiza cálculos complejos mediante el uso de algunos archivos temporales en un recurso compartido.</span><span class="sxs-lookup"><span data-stu-id="4daf1-207">For example, consider a service that does complex calculations that use some temporary files on a share.</span></span> <span data-ttu-id="4daf1-208">A continuación se proporciona puede supervisar tooensure de recurso compartido de Hola que hay suficiente espacio.</span><span class="sxs-lookup"><span data-stu-id="4daf1-208">A watchdog could monitor hello share tooensure that enough space is available.</span></span> <span data-ttu-id="4daf1-209">Podría escuchar las notificaciones de cambios en un archivo o un directorio.</span><span class="sxs-lookup"><span data-stu-id="4daf1-209">It could listen for notifications of file or directory changes.</span></span> <span data-ttu-id="4daf1-210">Podría presentar una advertencia si se alcanza un umbral por adelantado y notifica un error si el recurso compartido de hello está lleno.</span><span class="sxs-lookup"><span data-stu-id="4daf1-210">It could report a warning if an upfront threshold is reached, and report an error if hello share is full.</span></span> <span data-ttu-id="4daf1-211">Una advertencia, pudo iniciar un sistema de reparación limpiar archivos más antiguos en el recurso compartido de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-211">On a warning, a repair system could start cleaning up older files on hello share.</span></span> <span data-ttu-id="4daf1-212">Produce un error, un sistema de reparación podría mover nodo de hello servicio réplica tooanother.</span><span class="sxs-lookup"><span data-stu-id="4daf1-212">On an error, a repair system could move hello service replica tooanother node.</span></span> <span data-ttu-id="4daf1-213">Tenga en cuenta cómo se describen los Estados de la condición de hello en términos de mantenimiento: Hola estado de hello condición que se puede considerar correcto (correcto) o mal estado (advertencia o error).</span><span class="sxs-lookup"><span data-stu-id="4daf1-213">Note how hello condition states are described in terms of health: hello state of hello condition that can be considered healthy (ok) or unhealthy (warning or error).</span></span>

<span data-ttu-id="4daf1-214">Una vez que se establecen los detalles de supervisión de hello, un sistema de escritura de guardián debe toofigure out cómo tooimplement Hola guardián.</span><span class="sxs-lookup"><span data-stu-id="4daf1-214">Once hello monitoring details are set, a watchdog writer needs toofigure out how tooimplement hello watchdog.</span></span> <span data-ttu-id="4daf1-215">Si las condiciones de Hola se pueden determinar desde dentro de servicio de hello, guardián Hola puede formar parte del propio servicio de hello supervisado de.</span><span class="sxs-lookup"><span data-stu-id="4daf1-215">If hello conditions can be determined from within hello service, hello watchdog can be part of hello monitored service itself.</span></span> <span data-ttu-id="4daf1-216">Por ejemplo, el código del servicio de hello puede comprobar el uso del recurso compartido de Hola y de informes, a continuación, cada vez que intente toowrite un archivo.</span><span class="sxs-lookup"><span data-stu-id="4daf1-216">For example, hello service code can check hello share usage, and then report every time it tries toowrite a file.</span></span> <span data-ttu-id="4daf1-217">ventaja de Hola de este enfoque es que reporting es sencilla.</span><span class="sxs-lookup"><span data-stu-id="4daf1-217">hello advantage of this approach is that reporting is simple.</span></span> <span data-ttu-id="4daf1-218">Se deben tener cuidado tooprevent errores de guardián no afecten a la funcionalidad del servicio Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-218">Care must be taken tooprevent watchdog bugs from impacting hello service functionality.</span></span>

<span data-ttu-id="4daf1-219">Generación de informes en el servicio de hello supervisado no siempre es una opción.</span><span class="sxs-lookup"><span data-stu-id="4daf1-219">Reporting from within hello monitored service is not always an option.</span></span> <span data-ttu-id="4daf1-220">A continuación se proporciona en el servicio de hello puede no ser capaz de toodetect condiciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-220">A watchdog within hello service may not be able toodetect hello conditions.</span></span> <span data-ttu-id="4daf1-221">No puede tener determinación de Hola de toomake de datos o lógicas Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-221">It may not have hello logic or data toomake hello determination.</span></span> <span data-ttu-id="4daf1-222">sobrecarga de Hola de supervisan las condiciones de hello puede ser alto.</span><span class="sxs-lookup"><span data-stu-id="4daf1-222">hello overhead of monitoring hello conditions may be high.</span></span> <span data-ttu-id="4daf1-223">condiciones de Hello también pueden no ser servicio tooa específico, pero en su lugar, afectan a las interacciones entre los servicios.</span><span class="sxs-lookup"><span data-stu-id="4daf1-223">hello conditions also may not be specific tooa service, but instead affect interactions between services.</span></span> <span data-ttu-id="4daf1-224">Otra opción es toohave watchdogs en clúster de hello como procesos independientes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-224">Another option is toohave watchdogs in hello cluster as separate processes.</span></span> <span data-ttu-id="4daf1-225">watchdogs Hola supervisan las condiciones de Hola y el informe, sin que afecte a los servicios principales de Hola de ninguna manera.</span><span class="sxs-lookup"><span data-stu-id="4daf1-225">hello watchdogs monitor hello conditions and report, without affecting hello main services in any way.</span></span> <span data-ttu-id="4daf1-226">Por ejemplo, pudieron implementarse estos watchdogs como servicios sin estado en hello misma aplicación, implementada en todos los nodos u Hola mismos nodos como servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-226">For example, these watchdogs could be implemented as stateless services in hello same application, deployed on all nodes or on hello same nodes as hello service.</span></span>

<span data-ttu-id="4daf1-227">En ocasiones, un guardián que se ejecuta en el clúster de Hola tampoco es una opción.</span><span class="sxs-lookup"><span data-stu-id="4daf1-227">Sometimes, a watchdog running in hello cluster is not an option either.</span></span> <span data-ttu-id="4daf1-228">Si condición Hola supervisado es disponibilidad Hola o la funcionalidad del servicio de Hola que los usuarios verán, es mejor watchdogs de hello toohave Hola mismo lugar como clientes de usuario de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-228">If hello monitored condition is hello availability or functionality of hello service as users see it, it's best toohave hello watchdogs in hello same place as hello user clients.</span></span> <span data-ttu-id="4daf1-229">No existe, puede probar el funcionamiento de Hola Hola misma forma, los usuarios llamarlos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-229">There, they can test hello operations in hello same way users call them.</span></span> <span data-ttu-id="4daf1-230">Por ejemplo, puede tener un guardián que reside fuera de clúster de hello, emite las solicitudes de servicio de toohello y comprueba la latencia de Hola y la exactitud de los resultados de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-230">For example, you can have a watchdog that lives outside hello cluster, issues requests toohello service, and checks hello latency and correctness of hello result.</span></span> <span data-ttu-id="4daf1-231">(Para un servicio de calculadora, por ejemplo, ¿2 + 2 devuelve 4 en un período de tiempo razonable?)</span><span class="sxs-lookup"><span data-stu-id="4daf1-231">(For a calculator service, for example, does 2+2 return 4 in a reasonable amount of time?)</span></span>

<span data-ttu-id="4daf1-232">Una vez que los detalles de guardián Hola aún haya finalizado, debería decidir un Id. de origen que identifica de forma única.</span><span class="sxs-lookup"><span data-stu-id="4daf1-232">Once hello watchdog details have been finalized, you should decide on a source ID that uniquely identifies it.</span></span> <span data-ttu-id="4daf1-233">Si varios watchdogs del programa Hola a mismo tipo vivan en hello clúster, debe informar sobre entidades distintas, o, si le informan de Hola misma entidad, Id. de origen diferente de uso o propiedad.</span><span class="sxs-lookup"><span data-stu-id="4daf1-233">If multiple watchdogs of hello same type are living in hello cluster, they must report on different entities, or, if they report on hello same entity, use different source ID or property.</span></span> <span data-ttu-id="4daf1-234">De este modo, los informes podrán coexistir.</span><span class="sxs-lookup"><span data-stu-id="4daf1-234">This way, their reports can coexist.</span></span> <span data-ttu-id="4daf1-235">propiedad Hola de informe de mantenimiento de hello debe reflejar condición Hola supervisado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-235">hello property of hello health report should capture hello monitored condition.</span></span> <span data-ttu-id="4daf1-236">(Por ejemplo de Hola anterior, podría ser propiedad de hello **ShareSize**.) Si varios informes aplican toohello mismo condición, hello propiedad debe contener información dinámica que permite toocoexist de informes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-236">(For hello example above, hello property could be **ShareSize**.) If multiple reports apply toohello same condition, hello property should contain some dynamic information that allows reports toocoexist.</span></span> <span data-ttu-id="4daf1-237">Por ejemplo, si varios recursos compartidos de necesitan toobe supervisado, nombre de la propiedad de hello puede ser **ShareSize sharename**.</span><span class="sxs-lookup"><span data-stu-id="4daf1-237">For example, if multiple shares need toobe monitored, hello property name can be **ShareSize-sharename**.</span></span>

> [!NOTE]
> <span data-ttu-id="4daf1-238">Hacer *no* usar Hola almacén tookeep información de estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-238">Do *not* use hello health store tookeep status information.</span></span> <span data-ttu-id="4daf1-239">Solo la información relacionada con el mantenimiento debe notificarse como estado, como esta evaluación de mantenimiento de Hola de impactos de información de una entidad.</span><span class="sxs-lookup"><span data-stu-id="4daf1-239">Only health-related information should be reported as health, as this information impacts hello health evaluation of an entity.</span></span> <span data-ttu-id="4daf1-240">almacén de estado de Hello no se diseñó como un almacén de propósito general.</span><span class="sxs-lookup"><span data-stu-id="4daf1-240">hello health store was not designed as a general-purpose store.</span></span> <span data-ttu-id="4daf1-241">Utiliza tooaggregate de lógica de evaluación de estado todos los datos en estado de mantenimiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-241">It uses health evaluation logic tooaggregate all data into hello health state.</span></span> <span data-ttu-id="4daf1-242">Envío de información de toohealth no relacionada (como informes de estado con un estado de mantenimiento de Aceptar) no afecta a Hola agrega el estado, pero puede afectar negativamente al rendimiento de Hola de almacén de estado de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-242">Sending information unrelated toohealth (like reporting status with a health state of OK) doesn't impact hello aggregated health state, but it can negatively affect hello performance of hello health store.</span></span>
> 
> 

<span data-ttu-id="4daf1-243">Hola siguiente punto de decisión es que tooreport de entidad en.</span><span class="sxs-lookup"><span data-stu-id="4daf1-243">hello next decision point is which entity tooreport on.</span></span> <span data-ttu-id="4daf1-244">La mayoría de casos de hello, condición Hola claramente idetifies Hola entidad.</span><span class="sxs-lookup"><span data-stu-id="4daf1-244">Most of hello time, hello condition clearly idetifies hello entity.</span></span> <span data-ttu-id="4daf1-245">Elija la entidad de hello con mejor granularidad posible.</span><span class="sxs-lookup"><span data-stu-id="4daf1-245">Choose hello entity with best possible granularity.</span></span> <span data-ttu-id="4daf1-246">Si una condición afecta a todas las réplicas de una partición, un informe sobre la partición de hello, no en el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-246">If a condition impacts all replicas in a partition, report on hello partition, not on hello service.</span></span> <span data-ttu-id="4daf1-247">Hay casos excepcionales en los que es necesario dedicar más esfuerzo.</span><span class="sxs-lookup"><span data-stu-id="4daf1-247">There are corner cases where more thought is needed, though.</span></span> <span data-ttu-id="4daf1-248">Si la condición de hello afecta a una entidad, como una réplica, pero Hola deseo es toohave Hola condición marcado durante más de duración de hello del ciclo de vida de la réplica, a continuación, que se debe notificar en partición de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-248">If hello condition impacts an entity, such as a replica, but hello desire is toohave hello condition flagged for more than hello duration of replica life, then it should be reported on hello partition.</span></span> <span data-ttu-id="4daf1-249">En caso contrario, cuando se elimina la réplica de hello, almacén de estado de hello limpia todos sus informes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-249">Otherwise, when hello replica is deleted, hello health store cleans up all its reports.</span></span> <span data-ttu-id="4daf1-250">Escritores de guardián deben pensar en duraciones de Hola de entidad de Hola y Hola del informe.</span><span class="sxs-lookup"><span data-stu-id="4daf1-250">Watchdog writers must think about hello lifetimes of hello entity and hello report.</span></span> <span data-ttu-id="4daf1-251">Debe quedar claro cuándo se debe limpiar un informe de un almacén (por ejemplo, cuándo deja de aplicarse un error notificado en una entidad).</span><span class="sxs-lookup"><span data-stu-id="4daf1-251">It must be clear when a report should be cleaned up from a store (for example, when an error reported on an entity no longer applies).</span></span>

<span data-ttu-id="4daf1-252">Veamos un ejemplo que reúne describen los puntos de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-252">Let's look at an example that puts together hello points I described.</span></span> <span data-ttu-id="4daf1-253">Considere una aplicación de Service Fabric compuesta de un servicio persistente con estado maestro y varios servicios sin estado secundario implementados en todos los nodos (un tipo de servicio secundario para cada tipo de tarea).</span><span class="sxs-lookup"><span data-stu-id="4daf1-253">Consider a Service Fabric application composed of a master stateful persistent service and secondary stateless services deployed on all nodes (one secondary service type for each type of task).</span></span> <span data-ttu-id="4daf1-254">maestro de Hello tiene una cola de procesamiento que contiene toobe de comandos ejecutada por elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="4daf1-254">hello master has a processing queue that contains commands toobe executed by secondaries.</span></span> <span data-ttu-id="4daf1-255">elementos secundarios de Hola ejecutan hello las solicitudes entrantes y envían señales de espera de confirmación.</span><span class="sxs-lookup"><span data-stu-id="4daf1-255">hello secondaries execute hello incoming requests and send back acknowledgement signals.</span></span> <span data-ttu-id="4daf1-256">Una condición que se va a supervisar es la longitud de Hola de cola de procesamiento maestro Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-256">One condition that could be monitored is hello length of hello master processing queue.</span></span> <span data-ttu-id="4daf1-257">Si la longitud de la cola principal de hello alcanza un umbral, se emite una advertencia.</span><span class="sxs-lookup"><span data-stu-id="4daf1-257">If hello master queue length reaches a threshold, a warning is reported.</span></span> <span data-ttu-id="4daf1-258">Advertencia de Hello indica que secundarias hello no pueden atender la carga de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-258">hello warning indicates that hello secondaries can't handle hello load.</span></span> <span data-ttu-id="4daf1-259">Si la cola de hello alcanza la longitud máxima de Hola y se quitan los comandos, se notifica un error, como hello no se puede recuperar el servicio.</span><span class="sxs-lookup"><span data-stu-id="4daf1-259">If hello queue reaches hello maximum length and commands are dropped, an error is reported, as hello service can't recover.</span></span> <span data-ttu-id="4daf1-260">informes Hello pueden ser una propiedad de hello **QueueStatus**.</span><span class="sxs-lookup"><span data-stu-id="4daf1-260">hello reports can be on hello property **QueueStatus**.</span></span> <span data-ttu-id="4daf1-261">guardián Hola reside dentro de servicio de hello, y se envía de forma periódica en la réplica principal de hello maestro.</span><span class="sxs-lookup"><span data-stu-id="4daf1-261">hello watchdog lives inside hello service, and it's sent periodically on hello master primary replica.</span></span> <span data-ttu-id="4daf1-262">Hola tiempo toolive es dos minutos, y que se envíe periódicamente cada 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-262">hello time toolive is two minutes, and it's sent periodically every 30 seconds.</span></span> <span data-ttu-id="4daf1-263">Si Hola principal deja de funcionar, informe de Hola se limpia automáticamente de almacén.</span><span class="sxs-lookup"><span data-stu-id="4daf1-263">If hello primary goes down, hello report is cleaned up automatically from store.</span></span> <span data-ttu-id="4daf1-264">Si la réplica de servicio de hello está activo, pero se producirá un interbloqueo o tiene otros problemas, Hola informe expira en el almacén de estado de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-264">If hello service replica is up, but it is deadlocked or having other issues, hello report expires in hello health store.</span></span> <span data-ttu-id="4daf1-265">En este caso, la entidad de Hola se evalúa en error.</span><span class="sxs-lookup"><span data-stu-id="4daf1-265">In this case, hello entity is evaluated at error.</span></span>

<span data-ttu-id="4daf1-266">Otra condición que se pueden supervisar es el tiempo de ejecución de las tareas.</span><span class="sxs-lookup"><span data-stu-id="4daf1-266">Another condition that can be monitored is task execution time.</span></span> <span data-ttu-id="4daf1-267">Hello master distribuye las tareas secundarias toohello basándose en el tipo de tarea de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-267">hello master distributes tasks toohello secondaries based on hello task type.</span></span> <span data-ttu-id="4daf1-268">Según el diseño de hello, master Hola pudo sondear secundarias de hello para el estado de la tarea.</span><span class="sxs-lookup"><span data-stu-id="4daf1-268">Depending on hello design, hello master could poll hello secondaries for task status.</span></span> <span data-ttu-id="4daf1-269">También puede esperar a que señales de espera de confirmación de toosend secundarias cuando hayan terminado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-269">It could also wait for secondaries toosend back acknowledgement signals when they are done.</span></span> <span data-ttu-id="4daf1-270">En el segundo caso hello, se deben tener cuidado situaciones toodetect donde se pierdan mensajes o dado de elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="4daf1-270">In hello second case, care must be taken toodetect situations where secondaries die or messages are lost.</span></span> <span data-ttu-id="4daf1-271">Una opción es para hello maestro toosend un toohello de solicitud de ping mismo secundaria, que vuelve a enviar su estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-271">One option is for hello master toosend a ping request toohello same secondary, which sends back its status.</span></span> <span data-ttu-id="4daf1-272">Si no se recibe ningún estado, master Hola considera que un error y reprograma la tarea hello.</span><span class="sxs-lookup"><span data-stu-id="4daf1-272">If no status is received, hello master considers it a failure and reschedules hello task.</span></span> <span data-ttu-id="4daf1-273">Este comportamiento se da por supuesto que las tareas de hello son idempotentes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-273">This behavior assumes that hello tasks are idempotent.</span></span>

<span data-ttu-id="4daf1-274">se puede traducir condición Hola supervisado como una advertencia si no se realiza la tarea hello en un momento determinado (**t1**, por ejemplo, 10 minutos).</span><span class="sxs-lookup"><span data-stu-id="4daf1-274">hello monitored condition can be translated as a warning if hello task is not done in a certain time (**t1**, for example 10 minutes).</span></span> <span data-ttu-id="4daf1-275">Si no se realiza una tarea hello en el tiempo (**t2**, por ejemplo, 20 minutos), se puede traducir condición Hola supervisado como Error.</span><span class="sxs-lookup"><span data-stu-id="4daf1-275">If hello task is not completed in time (**t2**, for example 20 minutes), hello monitored condition can be translated as Error.</span></span> <span data-ttu-id="4daf1-276">Estos informes pueden realizarse de varias maneras:</span><span class="sxs-lookup"><span data-stu-id="4daf1-276">This reporting can be done in multiple ways:</span></span>

* <span data-ttu-id="4daf1-277">réplica principal de Hello maestro informa periódicamente por sí sola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-277">hello master primary replica reports on itself periodically.</span></span> <span data-ttu-id="4daf1-278">Puede tener una propiedad para todas las tareas pendientes en cola Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-278">You can have one property for all pending tasks in hello queue.</span></span> <span data-ttu-id="4daf1-279">Si al menos una tarea tarda más tiempo, Hola informar sobre el estado propiedad hello **PendingTasks** es una advertencia o error, según corresponda.</span><span class="sxs-lookup"><span data-stu-id="4daf1-279">If at least one task takes longer, hello report status on hello property **PendingTasks** is a warning or error, as appropriate.</span></span> <span data-ttu-id="4daf1-280">Si no hay ninguna tarea pendiente o todas las tareas inició la ejecución, informar del estado de hello es correcto.</span><span class="sxs-lookup"><span data-stu-id="4daf1-280">If there are no pending tasks or all tasks started execution, hello report status is OK.</span></span> <span data-ttu-id="4daf1-281">tareas de Hello son persistentes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-281">hello tasks are persistent.</span></span> <span data-ttu-id="4daf1-282">Si Hola principal deja de funcionar, principal Hola recién promovido puede continuar tooreport correctamente.</span><span class="sxs-lookup"><span data-stu-id="4daf1-282">If hello primary goes down, hello newly promoted primary can continue tooreport properly.</span></span>
* <span data-ttu-id="4daf1-283">Otro proceso de guardián (en la nube de Hola o externa) comprueba las tareas de hello (desde fuera, basado en resultados de la tarea de hello deseado) toosee si se completan.</span><span class="sxs-lookup"><span data-stu-id="4daf1-283">Another watchdog process (in hello cloud or external) checks hello tasks (from outside, based on hello desired task result) toosee if they are completed.</span></span> <span data-ttu-id="4daf1-284">Si no respetan los umbrales de Hola, se envía un informe en el servicio maestro Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-284">If they do not respect hello thresholds, a report is sent on hello master service.</span></span> <span data-ttu-id="4daf1-285">También se envía un informe en cada tarea que incluye el identificador de la tarea de hello, como **PendingTask + taskId**.</span><span class="sxs-lookup"><span data-stu-id="4daf1-285">A report is also sent on each task that includes hello task identifier, like **PendingTask+taskId**.</span></span> <span data-ttu-id="4daf1-286">Los informes solo se deben enviar con estados incorrectos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-286">Reports should be sent only on unhealthy states.</span></span> <span data-ttu-id="4daf1-287">Establecer tiempo toolive tooa unos minutos y marcar Hola informes toobe quitado cuando expiran tooensure limpieza.</span><span class="sxs-lookup"><span data-stu-id="4daf1-287">Set time toolive tooa few minutes, and mark hello reports toobe removed when they expire tooensure cleanup.</span></span>
* <span data-ttu-id="4daf1-288">Hola secundaria que se está ejecutando una tarea notifica si se tarda más tiempo que toorun esperado lo.</span><span class="sxs-lookup"><span data-stu-id="4daf1-288">hello secondary that is executing a task reports when it takes longer than expected toorun it.</span></span> <span data-ttu-id="4daf1-289">Informa sobre la instancia de servicio de hello en la propiedad de hello **PendingTasks**.</span><span class="sxs-lookup"><span data-stu-id="4daf1-289">It reports on hello service instance on hello property **PendingTasks**.</span></span> <span data-ttu-id="4daf1-290">informe de Hello localiza la instancia de servicio de Hola que tiene problemas, pero no captura el situación Hola donde muere instancia Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-290">hello report pinpoints hello service instance that has issues, but it doesn't capture hello situation where hello instance dies.</span></span> <span data-ttu-id="4daf1-291">informes de Hola se limpian, a continuación.</span><span class="sxs-lookup"><span data-stu-id="4daf1-291">hello reports are cleaned up then.</span></span> <span data-ttu-id="4daf1-292">Puede generar informes sobre el servicio secundario Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-292">It could report on hello secondary service.</span></span> <span data-ttu-id="4daf1-293">Si Hola secundaria complete la tarea de hello, instancia secundaria Hola borra informe Hola de almacén de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-293">If hello secondary completes hello task, hello secondary instance clears hello report from hello store.</span></span> <span data-ttu-id="4daf1-294">informe de Hola no captura la situación de Hola donde se pierde el mensaje de confirmación de Hola y Hola tarea no se terminó de punto de vista del patrón de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-294">hello report doesn't capture hello situation where hello acknowledgement message is lost and hello task is not finished from hello master's point of view.</span></span>

<span data-ttu-id="4daf1-295">Sin embargo, la notificación de Hola se realiza en los casos de Hola que se ha descrito anteriormente, se capturan Hola informes de estado de la aplicación cuando se evalúa el estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-295">However hello reporting is done in hello cases described above, hello reports are captured in application health when health is evaluated.</span></span>

## <a name="report-periodically-vs-on-transition"></a><span data-ttu-id="4daf1-296">Informar periódicamente frente a en transiciones</span><span class="sxs-lookup"><span data-stu-id="4daf1-296">Report periodically vs. on transition</span></span>
<span data-ttu-id="4daf1-297">Mediante el uso de informes de modelo de estado de hello, watchdogs puede enviar informes periódicamente o transiciones.</span><span class="sxs-lookup"><span data-stu-id="4daf1-297">By using hello health reporting model, watchdogs can send reports periodically or on transitions.</span></span> <span data-ttu-id="4daf1-298">Hola recomienda manera de guardián reporting es periódicamente, dado que el código de hello es mucho más sencillo y menos propenso tooerrors.</span><span class="sxs-lookup"><span data-stu-id="4daf1-298">hello recommended way for watchdog reporting is periodically, because hello code is much simpler and less prone tooerrors.</span></span> <span data-ttu-id="4daf1-299">watchdogs Hola deben procurar toobe tan simple como tooavoid posibles errores que desencadenan informes incorrectos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-299">hello watchdogs must strive toobe as simple as possible tooavoid bugs that trigger incorrect reports.</span></span> <span data-ttu-id="4daf1-300">Los informes de *mal estado* incorrectos afectarán a los escenarios y las evaluaciones de mantenimiento en función del estado, como las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="4daf1-300">Incorrect *unhealthy* reports impact health evaluations and scenarios based on health, including upgrades.</span></span> <span data-ttu-id="4daf1-301">Incorrecta *correcto* informes ocultar los problemas de clúster de hello, que no se desea.</span><span class="sxs-lookup"><span data-stu-id="4daf1-301">Incorrect *healthy* reports hide issues in hello cluster, which is not desired.</span></span>

<span data-ttu-id="4daf1-302">Para informes periódicos, guardián Hola puede implementarse con un temporizador.</span><span class="sxs-lookup"><span data-stu-id="4daf1-302">For periodic reporting, hello watchdog can be implemented with a timer.</span></span> <span data-ttu-id="4daf1-303">En una devolución de llamada de temporizador guardián de Hola puede comprobar el estado de Hola y enviar un informe basado en el estado actual de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-303">On a timer callback, hello watchdog can check hello state and send a report based on hello current state.</span></span> <span data-ttu-id="4daf1-304">No hay ningún toosee necesidad qué informes se envió anteriormente o realizar las optimizaciones en términos de mensajería.</span><span class="sxs-lookup"><span data-stu-id="4daf1-304">There is no need toosee which report was sent previously or make any optimizations in terms of messaging.</span></span> <span data-ttu-id="4daf1-305">cliente de mantenimiento de Hello tiene toohelp lógica con un rendimiento de procesamiento por lotes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-305">hello health client has batching logic toohelp with performance.</span></span> <span data-ttu-id="4daf1-306">Mientras el cliente de mantenimiento de Hola se mantiene activo, vuelve a intentar internamente hasta que informe de Hola se reconoce por el almacén de estado de Hola o guardián Hola genera un informe más reciente con hello misma entidad, property y origen.</span><span class="sxs-lookup"><span data-stu-id="4daf1-306">While hello health client is kept alive, it retries internally until hello report is acknowledged by hello health store or hello watchdog generates a newer report with hello same entity, property, and source.</span></span>

<span data-ttu-id="4daf1-307">Los informes en las transiciones requieren un tratamiento especial del estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-307">Reporting on transitions requires careful handling of state.</span></span> <span data-ttu-id="4daf1-308">guardián Hola supervisa algunas condiciones y emite solo cuando cambien las condiciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-308">hello watchdog monitors some conditions and reports only when hello conditions change.</span></span> <span data-ttu-id="4daf1-309">Hola al revés de este enfoque es que no se necesitan menos informes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-309">hello upside of this approach is that fewer reports are needed.</span></span> <span data-ttu-id="4daf1-310">inconveniente de Hello es que la lógica de Hola de guardián de hello es compleja.</span><span class="sxs-lookup"><span data-stu-id="4daf1-310">hello downside is that hello logic of hello watchdog is complex.</span></span> <span data-ttu-id="4daf1-311">guardián Hola debe mantener las condiciones de Hola o informes de hello, para que puedan ser inspeccionado toodetermine cambios de estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-311">hello watchdog must maintain hello conditions or hello reports, so that they can be inspected toodetermine state changes.</span></span> <span data-ttu-id="4daf1-312">En la conmutación por error, debe tener cuidado con los informes de agregado, pero aún no se ha enviado toohello almacén de estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-312">On failover, care must be taken with reports added, but not yet sent toohello health store.</span></span> <span data-ttu-id="4daf1-313">número de secuencia de Hello debe ser creciente.</span><span class="sxs-lookup"><span data-stu-id="4daf1-313">hello sequence number must be ever-increasing.</span></span> <span data-ttu-id="4daf1-314">De lo contrario, se rechazan los informes de hello como obsoleto.</span><span class="sxs-lookup"><span data-stu-id="4daf1-314">If not, hello reports are rejected as stale.</span></span> <span data-ttu-id="4daf1-315">En casos excepcionales de Hola donde se incurre en pérdida de datos, puede resultar necesario sincronización entre el estado de Hola de indicador de Hola y estado de hello del almacén de estado de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-315">In hello rare cases where data loss is incurred, synchronization may be needed between hello state of hello reporter and hello state of hello health store.</span></span>

<span data-ttu-id="4daf1-316">La creación de informes sobre las transiciones tiene sentido para los servicios que crean informes sobre sí mismos, mediante `Partition` o `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="4daf1-316">Reporting on transitions makes sense for services reporting on themselves, through `Partition` or `CodePackageActivationContext`.</span></span> <span data-ttu-id="4daf1-317">Hola al objeto local (réplica o un paquete de servicio implementado / implementado aplicación) es eliminado, se quitan también todas sus informes.</span><span class="sxs-lookup"><span data-stu-id="4daf1-317">When hello local object (replica or deployed service package / deployed application) is removed, all its reports are also removed.</span></span> <span data-ttu-id="4daf1-318">La limpieza automática reduce la necesidad de hello para la sincronización entre el indicador y el almacén de estado.</span><span class="sxs-lookup"><span data-stu-id="4daf1-318">This automatic cleanup relaxes hello need for synchronization between reporter and health store.</span></span> <span data-ttu-id="4daf1-319">Si informe de hello es para la partición primaria o la aplicación principal, se debe tener cuidado en conmutación por error tooavoid obsoletos informes del almacén de estado de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-319">If hello report is for parent partition or parent application, care must be taken on failover tooavoid stale reports in hello health store.</span></span> <span data-ttu-id="4daf1-320">Lógica debe agregarse un estado correcto toomaintain Hola y el informe de hello clara del almacén cuando ya no sea necesario.</span><span class="sxs-lookup"><span data-stu-id="4daf1-320">Logic must be added toomaintain hello correct state and clear hello report from store when not needed anymore.</span></span>

## <a name="implement-health-reporting"></a><span data-ttu-id="4daf1-321">Implementación de la generación de informes de estado</span><span class="sxs-lookup"><span data-stu-id="4daf1-321">Implement health reporting</span></span>
<span data-ttu-id="4daf1-322">Una vez hello detalles de la entidad y el informe no están activados, enviar informes de estado puede realizarse a través de la API de hello, PowerShell o REST.</span><span class="sxs-lookup"><span data-stu-id="4daf1-322">Once hello entity and report details are clear, sending health reports can be done through hello API, PowerShell, or REST.</span></span>

### <a name="api"></a><span data-ttu-id="4daf1-323">API</span><span class="sxs-lookup"><span data-stu-id="4daf1-323">API</span></span>
<span data-ttu-id="4daf1-324">tooreport a través de la API de hello, necesita un tipo de entidad toohello específico de informe de mantenimiento desean tooreport en toocreate.</span><span class="sxs-lookup"><span data-stu-id="4daf1-324">tooreport through hello API, you need toocreate a health report specific toohello entity type they want tooreport on.</span></span> <span data-ttu-id="4daf1-325">Asigne a Hola informe tooa mantenimiento cliente.</span><span class="sxs-lookup"><span data-stu-id="4daf1-325">Give hello report tooa health client.</span></span> <span data-ttu-id="4daf1-326">O bien, cree una información de estado y páselo toocorrect métodos de generación de informes en `Partition` o `CodePackageActivationContext` tooreport en entidades actuales.</span><span class="sxs-lookup"><span data-stu-id="4daf1-326">Alternatively, create a health information and pass it toocorrect reporting methods on `Partition` or `CodePackageActivationContext` tooreport on current entities.</span></span>

<span data-ttu-id="4daf1-327">Hello en el ejemplo siguiente se muestra periódico de informes desde un guardián en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-327">hello following example shows periodic reporting from a watchdog within hello cluster.</span></span> <span data-ttu-id="4daf1-328">guardián Hola comprueba si un recurso externo puede tener acceso desde dentro de un nodo.</span><span class="sxs-lookup"><span data-stu-id="4daf1-328">hello watchdog checks whether an external resource can be accessed from within a node.</span></span> <span data-ttu-id="4daf1-329">recursos de Hola se necesita un manifiesto de servicio dentro de la aplicación hello.</span><span class="sxs-lookup"><span data-stu-id="4daf1-329">hello resource is needed by a service manifest within hello application.</span></span> <span data-ttu-id="4daf1-330">Si no está disponible el recurso de hello, hello otros servicios dentro de la aplicación hello pueden funcionar correctamente.</span><span class="sxs-lookup"><span data-stu-id="4daf1-330">If hello resource is unavailable, hello other services within hello application can still function properly.</span></span> <span data-ttu-id="4daf1-331">Por lo tanto, el informe de Hola se envía en la entidad de paquete de servicio de hello implementado cada 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-331">Therefore, hello report is sent on hello deployed service package entity every 30 seconds.</span></span>

```csharp
private static Uri ApplicationName = new Uri("fabric:/WordCount");
private static string ServiceManifestName = "WordCount.Service";
private static string NodeName = FabricRuntime.GetNodeContext().NodeName;
private static Timer ReportTimer = new Timer(new TimerCallback(SendReport), null, 30 * 1000, 30 * 1000);
private static FabricClient Client = new FabricClient(new FabricClientSettings() { HealthReportSendInterval = TimeSpan.FromSeconds(0) });

public static void SendReport(object obj)
{
    // Test whether hello resource can be accessed from hello node
    HealthState healthState = this.TestConnectivityToExternalResource();

    // Send report on deployed service package, as hello connectivity is needed by hello specific service manifest
    // and can be different on different nodes
    var deployedServicePackageHealthReport = new DeployedServicePackageHealthReport(
        ApplicationName,
        ServiceManifestName,
        NodeName,
        new HealthInformation("ExternalSourceWatcher", "Connectivity", healthState));

    // TODO: handle exception. Code omitted for snippet brevity.
    // Possible exceptions: FabricException with error codes
    // FabricHealthStaleReport (non-retryable, hello report is already queued on hello health client),
    // FabricHealthMaxReportsReached (retryable; user should retry with exponential delay until hello report is accepted).
    Client.HealthManager.ReportHealth(deployedServicePackageHealthReport);
}
```

### <a name="powershell"></a><span data-ttu-id="4daf1-332">PowerShell</span><span class="sxs-lookup"><span data-stu-id="4daf1-332">PowerShell</span></span>
<span data-ttu-id="4daf1-333">Envíe informes de mantenimiento con **Send-ServiceFabric*EntityType*HealthReport**.</span><span class="sxs-lookup"><span data-stu-id="4daf1-333">Send health reports with **Send-ServiceFabric*EntityType*HealthReport**.</span></span>

<span data-ttu-id="4daf1-334">Hello en el ejemplo siguiente se muestra periódico de creación de informes sobre los valores de la CPU en un nodo.</span><span class="sxs-lookup"><span data-stu-id="4daf1-334">hello following example shows periodic reporting on CPU values on a node.</span></span> <span data-ttu-id="4daf1-335">se enviarán informes de Hello cada 30 segundos, y tienen un tiempo toolive de dos minutos.</span><span class="sxs-lookup"><span data-stu-id="4daf1-335">hello reports should be sent every 30 seconds, and they have a time toolive of two minutes.</span></span> <span data-ttu-id="4daf1-336">Si caducan, Informador de hello tiene problemas, por lo que se evalúa el nodo de hello en error.</span><span class="sxs-lookup"><span data-stu-id="4daf1-336">If they expire, hello reporter has issues, so hello node is evaluated at error.</span></span> <span data-ttu-id="4daf1-337">Cuando Hola CPU está por encima de un umbral, informe de hello tiene un estado de advertencia.</span><span class="sxs-lookup"><span data-stu-id="4daf1-337">When hello CPU is above a threshold, hello report has a health state of warning.</span></span> <span data-ttu-id="4daf1-338">Cuando Hola CPU se mantiene por encima de un umbral durante más tiempo Hola configurado, se notificará como un error.</span><span class="sxs-lookup"><span data-stu-id="4daf1-338">When hello CPU remains above a threshold for more than hello configured time, it's reported as an error.</span></span> <span data-ttu-id="4daf1-339">En caso contrario, el indicador de hello envía un estado de mantenimiento de Aceptar.</span><span class="sxs-lookup"><span data-stu-id="4daf1-339">Otherwise, hello reporter sends a health state of OK.</span></span>

```powershell
PS C:\> Send-ServiceFabricNodeHealthReport -NodeName Node.1 -HealthState Warning -SourceId PowershellWatcher -HealthProperty CPU -Description "CPU is above 80% threshold" -TimeToLiveSec 120

PS C:\> Get-ServiceFabricNodeHealth -NodeName Node.1
NodeName              : Node.1
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='CPU', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.FM
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 5
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Fabric node is up.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : CPU
                        HealthState           : Warning
                        SequenceNumber        : 130741236814913394
                        SentAt                : 4/21/2015 9:01:21 PM
                        ReceivedAt            : 4/21/2015 9:01:21 PM
                        TTL                   : 00:02:00
                        Description           : CPU is above 80% threshold
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:01:21 PM
```

<span data-ttu-id="4daf1-340">Hello en el ejemplo siguiente se notifica una advertencia transitoria en una réplica.</span><span class="sxs-lookup"><span data-stu-id="4daf1-340">hello following example reports a transient warning on a replica.</span></span> <span data-ttu-id="4daf1-341">Primero obtiene el Id. de partición de Hola y Hola, a continuación, Id. de réplica para servicio de Hola que le interesan.</span><span class="sxs-lookup"><span data-stu-id="4daf1-341">It first gets hello partition ID and then hello replica ID for hello service it is interested in.</span></span> <span data-ttu-id="4daf1-342">A continuación, envía un informe de **PowershellWatcher** en la propiedad de hello **ResourceDependency**.</span><span class="sxs-lookup"><span data-stu-id="4daf1-342">It then sends a report from **PowershellWatcher** on hello property **ResourceDependency**.</span></span> <span data-ttu-id="4daf1-343">informe de Hello es de interés para solo dos minutos, y se quita del almacén de hello automáticamente.</span><span class="sxs-lookup"><span data-stu-id="4daf1-343">hello report is of interest for only two minutes, and it is removed from hello store automatically.</span></span>

```powershell
PS C:\> $partitionId = (Get-ServiceFabricPartition -ServiceName fabric:/WordCount/WordCount.Service).PartitionId

PS C:\> $replicaId = (Get-ServiceFabricReplica -PartitionId $partitionId | where {$_.ReplicaRole -eq "Primary"}).ReplicaId

PS C:\> Send-ServiceFabricReplicaHealthReport -PartitionId $partitionId -ReplicaId $replicaId -HealthState Warning -SourceId PowershellWatcher -HealthProperty ResourceDependency -Description "hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes." -TimeToLiveSec 120 -RemoveWhenExpired

PS C:\> Get-ServiceFabricReplicaHealth  -PartitionId $partitionId -ReplicaOrInstanceId $replicaId


PartitionId           : 8f82daff-eb68-4fd9-b631-7a37629e08c0
ReplicaId             : 130740415594605869
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='ResourceDependency', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.RA
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 130740768777734943
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Replica has been created.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : ResourceDependency
                        HealthState           : Warning
                        SequenceNumber        : 130741243777723555
                        SentAt                : 4/21/2015 9:12:57 PM
                        ReceivedAt            : 4/21/2015 9:12:57 PM
                        TTL                   : 00:02:00
                        Description           : hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes.
                        RemoveWhenExpired     : True
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:12:32 PM
```

### <a name="rest"></a><span data-ttu-id="4daf1-344">REST</span><span class="sxs-lookup"><span data-stu-id="4daf1-344">REST</span></span>
<span data-ttu-id="4daf1-345">Enviar informes de mantenimiento con REST con las solicitudes POST que vaya entidad toohello deseado y tienen en la descripción del informe de estado de hello cuerpo Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-345">Send health reports using REST with POST requests that go toohello desired entity and have in hello body hello health report description.</span></span> <span data-ttu-id="4daf1-346">Por ejemplo, ver cómo se REST toosend [informes de mantenimiento del clúster](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) o [informes de mantenimiento del servicio](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span><span class="sxs-lookup"><span data-stu-id="4daf1-346">For example, see how toosend REST [cluster health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) or [service health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span></span> <span data-ttu-id="4daf1-347">Se admiten todas las entidades.</span><span class="sxs-lookup"><span data-stu-id="4daf1-347">All entities are supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="4daf1-348">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="4daf1-348">Next steps</span></span>
<span data-ttu-id="4daf1-349">En función de los datos de estado de hello, escritores del servicio y los administradores de aplicación/clúster pueden considerar información de maneras tooconsume Hola.</span><span class="sxs-lookup"><span data-stu-id="4daf1-349">Based on hello health data, service writers and cluster/application administrators can think of ways tooconsume hello information.</span></span> <span data-ttu-id="4daf1-350">Por ejemplo, puede configurar alertas basadas en toocatch graves problemas de estado de mantenimiento antes de que provocan que las interrupciones.</span><span class="sxs-lookup"><span data-stu-id="4daf1-350">For example, they can set up alerts based on health status toocatch severe issues before they provoke outages.</span></span> <span data-ttu-id="4daf1-351">Los administradores también pueden establecer automáticamente problemas de toofix de sistemas de reparación de la instalación.</span><span class="sxs-lookup"><span data-stu-id="4daf1-351">Administrators can also set up repair systems toofix issues automatically.</span></span>

[<span data-ttu-id="4daf1-352">Introducción tooService estado del tejido supervisión</span><span class="sxs-lookup"><span data-stu-id="4daf1-352">Introduction tooService Fabric health Monitoring</span></span>](service-fabric-health-introduction.md)

[<span data-ttu-id="4daf1-353">Vista de los informes de estado de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4daf1-353">View Service Fabric health reports</span></span>](service-fabric-view-entities-aggregated-health.md)

[<span data-ttu-id="4daf1-354">¿Cómo tooreport y comprobación de estado de servicio</span><span class="sxs-lookup"><span data-stu-id="4daf1-354">How tooreport and check service health</span></span>](service-fabric-diagnostics-how-to-report-and-check-service-health.md)

[<span data-ttu-id="4daf1-355">Uso de informes de mantenimiento del sistema para solucionar problemas</span><span class="sxs-lookup"><span data-stu-id="4daf1-355">Use system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)

[<span data-ttu-id="4daf1-356">Supervisión y diagnóstico de los servicios localmente</span><span class="sxs-lookup"><span data-stu-id="4daf1-356">Monitor and diagnose services locally</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[<span data-ttu-id="4daf1-357">Actualización de la aplicación de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4daf1-357">Service Fabric application upgrade</span></span>](service-fabric-application-upgrade.md)

