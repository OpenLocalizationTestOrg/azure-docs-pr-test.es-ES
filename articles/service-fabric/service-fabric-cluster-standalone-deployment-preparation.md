---
title: "Preparación de la implementación de un clúster independiente de Azure Service Fabric | Microsoft Docs"
description: "Documentación relacionada con la preparación del entorno y la creación de la configuración del clúster, que se debe tener en cuenta antes de implementar un clúster dirigido a administrar una carga de trabajo de producción."
services: service-fabric
documentationcenter: .net
author: maburlik
manager: timlt
editor: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 1/17/2017
ms.author: maburlik;chackdan
ms.openlocfilehash: f332193f9a53260173a1010b8bf9f08726bea427
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
<a id="preparemachines"></a>

## <a name="plan-and-prepare-your-service-fabric-standalone-cluster-deployment"></a><span data-ttu-id="50c82-103">Planeamiento y preparación del desarrollo de un clúster independiente de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="50c82-103">Plan and prepare your Service Fabric standalone cluster deployment</span></span>
<span data-ttu-id="50c82-104">Realice los pasos siguientes antes de crear el clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-104">Perform the following steps before you create your cluster.</span></span>

### <a name="step-1-plan-your-cluster-infrastructure"></a><span data-ttu-id="50c82-105">Paso 1: Planear la infraestructura de clúster</span><span class="sxs-lookup"><span data-stu-id="50c82-105">Step 1: Plan your cluster infrastructure</span></span>
<span data-ttu-id="50c82-106">Va a crear un clúster de Service Fabric en máquinas que posee, por lo que podrá decidir qué tipos de errores desea que resista el clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-106">You are about to create a Service Fabric cluster on machines you own, so you can decide what kinds of failures you want the cluster to survive.</span></span> <span data-ttu-id="50c82-107">Por ejemplo, ¿necesita separar redes eléctricas o conexiones a Internet que proporcionan estas máquinas?</span><span class="sxs-lookup"><span data-stu-id="50c82-107">For example, do you need separate power lines or Internet connections supplied to these machines?</span></span> <span data-ttu-id="50c82-108">Además, debe tener en cuenta la seguridad física de estas máquinas.</span><span class="sxs-lookup"><span data-stu-id="50c82-108">In addition, consider the physical security of these machines.</span></span> <span data-ttu-id="50c82-109">¿Donde se encuentran las máquinas y quién tiene acceso a ellas?</span><span class="sxs-lookup"><span data-stu-id="50c82-109">Where are the machines located and who needs access to them?</span></span> <span data-ttu-id="50c82-110">Una vez que haya tomado estas decisiones, asigne las máquinas de manera lógica a los distintos dominios de error (vea el paso 4).</span><span class="sxs-lookup"><span data-stu-id="50c82-110">After you make these decisions, you can logically map the machines to the various fault domains (see Step 4).</span></span> <span data-ttu-id="50c82-111">El planeamiento de la infraestructura para clústeres de producción es más complicado que el de los clústeres de prueba.</span><span class="sxs-lookup"><span data-stu-id="50c82-111">The infrastructure planning for production clusters is more involved than for test clusters.</span></span>

### <a name="step-2-prepare-the-machines-to-meet-the-prerequisites"></a><span data-ttu-id="50c82-112">Paso 2: Preparar las máquinas para cumplir los requisitos previos</span><span class="sxs-lookup"><span data-stu-id="50c82-112">Step 2: Prepare the machines to meet the prerequisites</span></span>
<span data-ttu-id="50c82-113">Requisitos previos para cada máquina que desee agregar al clúster:</span><span class="sxs-lookup"><span data-stu-id="50c82-113">Prerequisites for each machine that you want to add to the cluster:</span></span>

* <span data-ttu-id="50c82-114">Se recomiendan como mínimo 16 GB de RAM.</span><span class="sxs-lookup"><span data-stu-id="50c82-114">A minimum of 16 GB of RAM is recommended.</span></span>
* <span data-ttu-id="50c82-115">Se recomiendan 40 GB de espacio disponible en disco como mínimo.</span><span class="sxs-lookup"><span data-stu-id="50c82-115">A minimum of 40 of GB available disk space is recommended.</span></span>
* <span data-ttu-id="50c82-116">Se recomienda una CPU de cuatro núcleos o más.</span><span class="sxs-lookup"><span data-stu-id="50c82-116">A 4 core or greater CPU is recommended.</span></span>
* <span data-ttu-id="50c82-117">Conectividad a una o varias redes seguras para todas las máquinas.</span><span class="sxs-lookup"><span data-stu-id="50c82-117">Connectivity to a secure network or networks for all machines.</span></span>
* <span data-ttu-id="50c82-118">Windows Server 2012 R2 o Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="50c82-118">Windows Server 2012 R2 or Windows Server 2016.</span></span> 
* <span data-ttu-id="50c82-119">[.NET Framework 4.5.1 o posterior](https://www.microsoft.com/download/details.aspx?id=40773)(instalación completa).</span><span class="sxs-lookup"><span data-stu-id="50c82-119">[.NET Framework 4.5.1 or higher](https://www.microsoft.com/download/details.aspx?id=40773), full install.</span></span>
* <span data-ttu-id="50c82-120">[Windows PowerShell 3.0](https://msdn.microsoft.com/powershell/scripting/setup/installing-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="50c82-120">[Windows PowerShell 3.0](https://msdn.microsoft.com/powershell/scripting/setup/installing-windows-powershell).</span></span>
* <span data-ttu-id="50c82-121">El [servicio RemoteRegistry](https://technet.microsoft.com/library/cc754820) se debe estar ejecutando en todas las máquinas.</span><span class="sxs-lookup"><span data-stu-id="50c82-121">The [RemoteRegistry service](https://technet.microsoft.com/library/cc754820) should be running on all the machines.</span></span>

<span data-ttu-id="50c82-122">El administrador de clúster que implemente y configure el clúster debe tener [privilegios de administrador](https://social.technet.microsoft.com/wiki/contents/articles/13436.windows-server-2012-how-to-add-an-account-to-a-local-administrator-group.aspx) en cada una de las máquinas.</span><span class="sxs-lookup"><span data-stu-id="50c82-122">The cluster administrator deploying and configuring the cluster must have [administrator privileges](https://social.technet.microsoft.com/wiki/contents/articles/13436.windows-server-2012-how-to-add-an-account-to-a-local-administrator-group.aspx) on each of the machines.</span></span> <span data-ttu-id="50c82-123">No se puede instalar Service Fabric en un controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="50c82-123">You cannot install Service Fabric on a domain controller.</span></span>

### <a name="step-3-determine-the-initial-cluster-size"></a><span data-ttu-id="50c82-124">Paso 3: Determinar el tamaño inicial del clúster</span><span class="sxs-lookup"><span data-stu-id="50c82-124">Step 3: Determine the initial cluster size</span></span>
<span data-ttu-id="50c82-125">Cada nodo de un clúster de Service Fabric independiente tiene el sistema en tiempo de ejecución de Service Fabric implementado y es miembro del clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-125">Each node in a standalone Service Fabric cluster has the Service Fabric runtime deployed and is a member of the cluster.</span></span> <span data-ttu-id="50c82-126">En una implementación típica de producción, hay un nodo por cada instancia de sistema operativo (física o virtual).</span><span class="sxs-lookup"><span data-stu-id="50c82-126">In a typical production deployment, there is one node per OS instance (physical or virtual).</span></span> <span data-ttu-id="50c82-127">El tamaño del clúster depende de sus necesidades empresariales.</span><span class="sxs-lookup"><span data-stu-id="50c82-127">The cluster size is determined by your business needs.</span></span> <span data-ttu-id="50c82-128">Sin embargo, debe tener un tamaño mínimo de clúster de tres nodos (máquinas o máquinas virtuales).</span><span class="sxs-lookup"><span data-stu-id="50c82-128">However, you must have a minimum cluster size of three nodes (machines or virtual machines).</span></span>
<span data-ttu-id="50c82-129">Con fines de desarrollo, puede tener más de un nodo en una máquina determinada.</span><span class="sxs-lookup"><span data-stu-id="50c82-129">For development purposes, you can have more than one node on a given machine.</span></span> <span data-ttu-id="50c82-130">En un entorno de producción, Service Fabric solo admite un nodo por máquina virtual o física.</span><span class="sxs-lookup"><span data-stu-id="50c82-130">In a production environment, Service Fabric supports only one node per physical or virtual machine.</span></span>

### <a name="step-4-determine-the-number-of-fault-domains-and-upgrade-domains"></a><span data-ttu-id="50c82-131">Paso 4: Determinar el número de dominios de error y de actualización</span><span class="sxs-lookup"><span data-stu-id="50c82-131">Step 4: Determine the number of fault domains and upgrade domains</span></span>
<span data-ttu-id="50c82-132">Un *dominio de error* (FD) es una unidad física de error, y está directamente relacionado con la infraestructura física de los centros de datos.</span><span class="sxs-lookup"><span data-stu-id="50c82-132">A *fault domain* (FD) is a physical unit of failure and is directly related to the physical infrastructure in the data centers.</span></span> <span data-ttu-id="50c82-133">Un dominio de error consta de componentes de hardware (equipos, conmutadores, redes, etc.) que comparten un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="50c82-133">A fault domain consists of hardware components (computers, switches, networks, and more) that share a single point of failure.</span></span> <span data-ttu-id="50c82-134">Aunque no hay ninguna asignación 1:1 entre dominios de error y racks, en términos generales, cada bastidor puede considerarse un dominio de error.</span><span class="sxs-lookup"><span data-stu-id="50c82-134">Although there is no 1:1 mapping between fault domains and racks, loosely speaking, each rack can be considered a fault domain.</span></span> <span data-ttu-id="50c82-135">A la hora de valorar los nodos del clúster, se recomienda que los nodos se distribuyan entre tres dominios de error como mínimo.</span><span class="sxs-lookup"><span data-stu-id="50c82-135">When considering the nodes in your cluster, we strongly recommend that the nodes be distributed among at least three fault domains.</span></span>

<span data-ttu-id="50c82-136">Si especifica dominios de error en ClusterConfig.json, puede elegir el nombre de cada uno.</span><span class="sxs-lookup"><span data-stu-id="50c82-136">When you specify FDs in ClusterConfig.json, you can choose the name for each FD.</span></span> <span data-ttu-id="50c82-137">Service Fabric admite FD jerárquicos, así que puede reflejar la topología de infraestructura en ellos.</span><span class="sxs-lookup"><span data-stu-id="50c82-137">Service Fabric supports hierarchical FDs, so you can reflect your infrastructure topology in them.</span></span>  <span data-ttu-id="50c82-138">Por ejemplo, los siguientes FD son válidos:</span><span class="sxs-lookup"><span data-stu-id="50c82-138">For example, the following FDs are valid:</span></span>

* <span data-ttu-id="50c82-139">"faultDomain": "fd:/Room1/Rack1/Machine1"</span><span class="sxs-lookup"><span data-stu-id="50c82-139">"faultDomain": "fd:/Room1/Rack1/Machine1"</span></span>
* <span data-ttu-id="50c82-140">"faultDomain": "fd:/FD1"</span><span class="sxs-lookup"><span data-stu-id="50c82-140">"faultDomain": "fd:/FD1"</span></span>
* <span data-ttu-id="50c82-141">"faultDomain": "fd:/Room1/Rack1/PDU1/M1"</span><span class="sxs-lookup"><span data-stu-id="50c82-141">"faultDomain": "fd:/Room1/Rack1/PDU1/M1"</span></span>

<span data-ttu-id="50c82-142">Un *dominio de actualización* (UD) es una unidad lógica de nodos.</span><span class="sxs-lookup"><span data-stu-id="50c82-142">An *upgrade domain* (UD) is a logical unit of nodes.</span></span> <span data-ttu-id="50c82-143">Durante una actualización de Service Fabric organizada (una actualización de la aplicación o del clúster), todos los nodos de un UD se eliminan para llevar a cabo este proceso, mientras que los nodos de otros UD siguen estando disponibles para atender las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="50c82-143">During Service Fabric orchestrated upgrades (either an application upgrade or a cluster upgrade), all nodes in a UD are taken down to perform the upgrade while nodes in other UDs remain available to serve requests.</span></span> <span data-ttu-id="50c82-144">Las actualizaciones de firmware que realice en las máquinas no respetan los UD, así que debe realizar este proceso de forma individual.</span><span class="sxs-lookup"><span data-stu-id="50c82-144">The firmware upgrades you perform on your machines do not honor UDs, so you must do them one machine at a time.</span></span>

<span data-ttu-id="50c82-145">La manera más sencilla de pensar en estos conceptos es considerar los FD como la unidad de error no planeada, y los UD, como la unidad de mantenimiento planeado.</span><span class="sxs-lookup"><span data-stu-id="50c82-145">The simplest way to think about these concepts is to consider FDs as the unit of unplanned failure and UDs as the unit of planned maintenance.</span></span>

<span data-ttu-id="50c82-146">Si especifica dominios de actualización en ClusterConfig.json, puede elegir el nombre de cada uno.</span><span class="sxs-lookup"><span data-stu-id="50c82-146">When you specify UDs in ClusterConfig.json, you can choose the name for each UD.</span></span> <span data-ttu-id="50c82-147">Por ejemplo, los siguientes nombres son válidos:</span><span class="sxs-lookup"><span data-stu-id="50c82-147">For example, the following names are valid:</span></span>

* <span data-ttu-id="50c82-148">"upgradeDomain": "UD0"</span><span class="sxs-lookup"><span data-stu-id="50c82-148">"upgradeDomain": "UD0"</span></span>
* <span data-ttu-id="50c82-149">"upgradeDomain": "UD1A"</span><span class="sxs-lookup"><span data-stu-id="50c82-149">"upgradeDomain": "UD1A"</span></span>
* <span data-ttu-id="50c82-150">"upgradeDomain": "DomainRed"</span><span class="sxs-lookup"><span data-stu-id="50c82-150">"upgradeDomain": "DomainRed"</span></span>
* <span data-ttu-id="50c82-151">"upgradeDomain": "Blue"</span><span class="sxs-lookup"><span data-stu-id="50c82-151">"upgradeDomain": "Blue"</span></span>

<span data-ttu-id="50c82-152">Para más información sobre los dominios de actualización y los dominios de error, vea [Descripción de un clúster de Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md).</span><span class="sxs-lookup"><span data-stu-id="50c82-152">For more detailed information on upgrade domains and fault domains, see [Describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span></span>

### <a name="step-5-download-the-service-fabric-standalone-package-for-windows-server"></a><span data-ttu-id="50c82-153">Paso 5: Descarga del paquete independiente de Windows Server para Service Fabric</span><span class="sxs-lookup"><span data-stu-id="50c82-153">Step 5: Download the Service Fabric standalone package for Windows Server</span></span>
<span data-ttu-id="50c82-154">[Descargue el paquete independiente de Service Fabric para Windows Server](http://go.microsoft.com/fwlink/?LinkId=730690) y descomprímalo en una máquina de implementación que no forme parte del clúster, o bien en una de las máquinas que formarán parte del clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-154">[Download Link - Service Fabric Standalone Package - Windows Server](http://go.microsoft.com/fwlink/?LinkId=730690) and unzip the package, either to a deployment machine that is not part of the cluster, or to one of the machines that will be a part of your cluster.</span></span>

### <a name="step-6-modify-cluster-configuration"></a><span data-ttu-id="50c82-155">Paso 6: Modificación de la configuración del clúster</span><span class="sxs-lookup"><span data-stu-id="50c82-155">Step 6: Modify cluster configuration</span></span>
<span data-ttu-id="50c82-156">Para crear un clúster independiente, debe crear un archivo ClusterConfig.json de configuración del clúster independiente, que describa la especificación del clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-156">To create a standalone cluster you have to create a standalone cluster configuration ClusterConfig.json file, which describes the specification of the cluster.</span></span> <span data-ttu-id="50c82-157">Puede basar el archivo de configuración en las plantillas que se encuentran en el siguiente vínculo.</span><span class="sxs-lookup"><span data-stu-id="50c82-157">You can base the configuration file on the templates found at the below link.</span></span> <br><span data-ttu-id="50c82-158">
[Configuraciones de clúster independiente](https://github.com/Azure-Samples/service-fabric-dotnet-standalone-cluster-configuration/tree/master/Samples)</span><span class="sxs-lookup"><span data-stu-id="50c82-158">
[Standalone Cluster Configurations](https://github.com/Azure-Samples/service-fabric-dotnet-standalone-cluster-configuration/tree/master/Samples)</span></span>

<span data-ttu-id="50c82-159">Para ver detalles sobre las secciones de este archivo, vea [Opciones de configuración de clústeres de Windows independientes](service-fabric-cluster-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="50c82-159">For details on the sections in this file, see [Configuration settings for standalone Windows cluster](service-fabric-cluster-manifest.md).</span></span>

<span data-ttu-id="50c82-160">Abra uno de los archivos ClusterConfig.json del paquete descargado y modifique las siguientes opciones:</span><span class="sxs-lookup"><span data-stu-id="50c82-160">Open one of the ClusterConfig.json files from the package you downloaded and modify the following settings:</span></span>
| <span data-ttu-id="50c82-161">**Opciones de configuración.**</span><span class="sxs-lookup"><span data-stu-id="50c82-161">**Configuration Setting**</span></span> | <span data-ttu-id="50c82-162">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="50c82-162">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="50c82-163">**NodeTypes**</span><span class="sxs-lookup"><span data-stu-id="50c82-163">**NodeTypes**</span></span> |<span data-ttu-id="50c82-164">Los tipos de nodo permiten separar los nodos de clúster en grupos distintos.</span><span class="sxs-lookup"><span data-stu-id="50c82-164">Node types allow you to separate your cluster nodes into various groups.</span></span> <span data-ttu-id="50c82-165">Un clúster debe tener al menos un tipo NodeType.</span><span class="sxs-lookup"><span data-stu-id="50c82-165">A cluster must have at least one NodeType.</span></span> <span data-ttu-id="50c82-166">Todos los nodos de un grupo tienen las siguientes características comunes: </span><span class="sxs-lookup"><span data-stu-id="50c82-166">All nodes in a group have the following common characteristics:</span></span> <br> <span data-ttu-id="50c82-167">**nombre** : es el nombre del tipo de nodo.</span><span class="sxs-lookup"><span data-stu-id="50c82-167">**Name** - This is the node type name.</span></span> <br><span data-ttu-id="50c82-168">**Endpoint Ports** : diversos puntos de conexión (puertos) con nombre asociados a este tipo de nodo.</span><span class="sxs-lookup"><span data-stu-id="50c82-168">**Endpoint Ports** - These are various named end points (ports) that are associated with this node type.</span></span> <span data-ttu-id="50c82-169">Puede usar cualquier número de puerto que desee, siempre que no entren en conflicto con nada de este manifiesto y que no estén siendo usados por otra aplicación que se ejecute en el equipo o en la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="50c82-169">You can use any port number that you wish, as long as they do not conflict with anything else in this manifest and are not already in use by any other application running on the machine/VM.</span></span> <br> <span data-ttu-id="50c82-170">**Propiedades de ubicación**: Describen las propiedades de este tipo de nodo que se usan como restricciones de ubicación para los servicios del sistema o para sus servicios.</span><span class="sxs-lookup"><span data-stu-id="50c82-170">**Placement Properties** - These describe properties for this node type that you use as placement constraints for the system services or your services.</span></span> <span data-ttu-id="50c82-171">Estas propiedades son pares de clave y valor definidos por el usuario que proporcionan metadatos adicionales para un nodo determinado.</span><span class="sxs-lookup"><span data-stu-id="50c82-171">These properties are user-defined key/value pairs that provide extra meta data for a given node.</span></span> <span data-ttu-id="50c82-172">Algunos ejemplos de propiedades de nodo son si el nodo tiene una unidad de disco duro o una tarjeta gráfica, el número de ejes de la unidad de disco duro, los núcleos y otras propiedades físicas.</span><span class="sxs-lookup"><span data-stu-id="50c82-172">Examples of node properties would be whether the node has a hard drive or graphics card, the number of spindles in its hard drive, cores, and other physical properties.</span></span> <br> <span data-ttu-id="50c82-173">**Capacities** : las capacidades del nodo definen el nombre y la cantidad de un recurso concreto que un nodo tiene disponible para consumir.</span><span class="sxs-lookup"><span data-stu-id="50c82-173">**Capacities** - Node capacities define the name and amount of a particular resource that a particular node has available for consumption.</span></span> <span data-ttu-id="50c82-174">Por ejemplo, un nodo puede definir que tenga capacidad para una métrica llamada "MemoryInMb" y 2048 MB de memoria disponible de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="50c82-174">For example, a node may define that it has capacity for a metric called “MemoryInMb” and that it has 2048 MB available by default.</span></span> <span data-ttu-id="50c82-175">Estas funcionalidades se usan en tiempo de ejecución para garantizar que los servicios que requieren una cantidad determinada de recursos se coloquen en nodos donde esos recursos estén disponibles en la cantidad necesaria.</span><span class="sxs-lookup"><span data-stu-id="50c82-175">These capacities are used at runtime to ensure that services that require particular amounts of resources are placed on the nodes that have those resources available in the required amounts.</span></span><br><span data-ttu-id="50c82-176">**IsPrimary** : si hay varias opciones NodeType definidas, asegúrese de establecer solo una como principal con el valor *true*; es donde se ejecutan los servicios del sistema.</span><span class="sxs-lookup"><span data-stu-id="50c82-176">**IsPrimary** - If you have more than one NodeType defined ensure that only one is set to primary with the value *true*, which is where the system services run.</span></span> <span data-ttu-id="50c82-177">Todos los demás tipos de nodo se deben establecer en *false*</span><span class="sxs-lookup"><span data-stu-id="50c82-177">All other node types should be set to the value *false*</span></span> |
| <span data-ttu-id="50c82-178">**Nodos**</span><span class="sxs-lookup"><span data-stu-id="50c82-178">**Nodes**</span></span> |<span data-ttu-id="50c82-179">Se trata de los detalles de cada uno de los nodos que forman parte del clúster (tipo de nodo, nombre de nodo, dirección IP, dominio de error y dominio de actualización del nodo).</span><span class="sxs-lookup"><span data-stu-id="50c82-179">These are the details for each of the nodes that are part of the cluster (node type, node name, IP address, fault domain, and upgrade domain of the node).</span></span> <span data-ttu-id="50c82-180">Las máquinas en las que desee que se cree el clúster en función de las necesidades se mostrarán aquí con sus direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="50c82-180">The machines you want the cluster to be created on need to be listed here with their IP addresses.</span></span> <br> <span data-ttu-id="50c82-181">Si usa la misma dirección IP para todos los nodos, se crea un clúster one-box, que puede usar con fines de prueba.</span><span class="sxs-lookup"><span data-stu-id="50c82-181">If you use the same IP address for all the nodes, then a one-box cluster is created, which you can use for testing purposes.</span></span> <span data-ttu-id="50c82-182">No use clústeres one-box para implementar cargas de trabajo de producción.</span><span class="sxs-lookup"><span data-stu-id="50c82-182">Do not use One-box clusters for deploying production workloads.</span></span> |

<span data-ttu-id="50c82-183">Después de que se han realizado todas las configuraciones del clúster de acuerdo con el entorno, se puede probar en el entorno del clúster (paso 7).</span><span class="sxs-lookup"><span data-stu-id="50c82-183">After the cluster configuration has had all settings configured to the environment, it can be tested against the cluster environment (step 7).</span></span>

<a id="environmentsetup"></a>

### <a name="step-7-environment-setup"></a><span data-ttu-id="50c82-184">Paso 7.</span><span class="sxs-lookup"><span data-stu-id="50c82-184">Step 7.</span></span> <span data-ttu-id="50c82-185">Configuración del entorno</span><span class="sxs-lookup"><span data-stu-id="50c82-185">Environment setup</span></span>

<span data-ttu-id="50c82-186">Cuando un administrador de clústeres configura un clúster independiente de Service Fabric, es necesario configurar el entorno con los siguientes criterios:</span><span class="sxs-lookup"><span data-stu-id="50c82-186">When a cluster administrator configures a Service Fabric standalone cluster, the environment is needs to be set up with the following criteria:</span></span> <br>
1. <span data-ttu-id="50c82-187">El usuario que crea el clúster debe tener privilegios de seguridad de nivel de administrador en todas las máquinas que se enumeran como nodos en el archivo de configuración del clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-187">The user creating the cluster should have administrator-level security privileges to all machines that are listed as nodes in the cluster configuration file.</span></span>
2. <span data-ttu-id="50c82-188">La máquina desde la que se crea el clúster, así como la máquina de cada nodo del clúster debe cumplir estos requisitos:</span><span class="sxs-lookup"><span data-stu-id="50c82-188">Machine from which the cluster is created, as well as each cluster node machine must:</span></span>
* <span data-ttu-id="50c82-189">Tener desinstalado el SDK de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="50c82-189">Have Service Fabric SDK uninstalled</span></span>
* <span data-ttu-id="50c82-190">tener desinstalado el entorno de tiempo de ejecución de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="50c82-190">Have Service Fabric runtime uninstalled</span></span> 
* <span data-ttu-id="50c82-191">Tener habilitado el servicio Firewall de Windows (mpssvc)</span><span class="sxs-lookup"><span data-stu-id="50c82-191">Have the Windows Firewall service (mpssvc) enabled</span></span>
* <span data-ttu-id="50c82-192">Tener habilitado el servicio Registro remoto (remoteregistry)</span><span class="sxs-lookup"><span data-stu-id="50c82-192">Have the Remote Registry Service (remoteregistry) enabled</span></span>
* <span data-ttu-id="50c82-193">Tener habilitado el uso compartido de archivos (SMB)</span><span class="sxs-lookup"><span data-stu-id="50c82-193">Have file sharing (SMB) enabled</span></span>
* <span data-ttu-id="50c82-194">Tener abiertos los puertos necesarios, según los puertos de configuración del clúster</span><span class="sxs-lookup"><span data-stu-id="50c82-194">Have necessary ports opened, based on cluster configuration ports</span></span>
* <span data-ttu-id="50c82-195">Tener abiertos los puertos necesarios para Windows SMB y el servicio Registro remoto: 135, 137, 138, 139 y 445</span><span class="sxs-lookup"><span data-stu-id="50c82-195">Have necessary ports opened for Windows SMB and Remote Registry service: 135, 137, 138, 139, and 445</span></span>
* <span data-ttu-id="50c82-196">Tener conectividad de red con otra máquina</span><span class="sxs-lookup"><span data-stu-id="50c82-196">Have network connectivity to one another</span></span>
3. <span data-ttu-id="50c82-197">Ninguna de las máquinas de nodo del clúster debe ser un controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="50c82-197">None of the cluster node machines should be a Domain Controller.</span></span>
4. <span data-ttu-id="50c82-198">Si el clúster que se va a implementar es un clúster seguro, valide que los requisitos previos de seguridad necesarios estén implementados y que se ajusten a la configuración.</span><span class="sxs-lookup"><span data-stu-id="50c82-198">If the cluster to be deployed is a secure cluster, validate the necessary security prerequisites are in place, and are configured correctly against the configuration.</span></span>
5. <span data-ttu-id="50c82-199">Si las máquinas del clúster no son accesibles desde Internet, establezca lo siguiente en la configuración del clúster:</span><span class="sxs-lookup"><span data-stu-id="50c82-199">If the cluster machines are not internet-accessible, set the following in the cluster configuration:</span></span>
* <span data-ttu-id="50c82-200">Deshabilite la telemetría: en *Propiedades*, establezca *"enableTelemetry" en false*</span><span class="sxs-lookup"><span data-stu-id="50c82-200">Disable telemetry:   Under *properties* set   *"enableTelemetry": false*</span></span>
* <span data-ttu-id="50c82-201">Deshabilite la descarga de versiones de Fabric y las notificaciones automáticas de que la versión actual del clúster está próxima a finalizar el soporte técnico: en *properties*, establezca *"fabricClusterAutoupgradeEnabled" en false*</span><span class="sxs-lookup"><span data-stu-id="50c82-201">Disable automatic Fabric version downloading & notifications that the current cluster version is nearing end of support:   Under *properties* set   *"fabricClusterAutoupgradeEnabled": false*</span></span>
* <span data-ttu-id="50c82-202">Como alternativa, en el caso de que el acceso a Internet de red está limitado a los dominios de la lista blanca, tendrán que incluirse los dominios siguientes para la actualización automática: go.microsoft.com y download.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="50c82-202">Alternatively if network internet access is limited to white-listed domains, the domains below are required for automatic upgrade:   go.microsoft.com   download.microsoft.com</span></span>

6. <span data-ttu-id="50c82-203">Establezca las exclusiones adecuadas del antivirus de Service Fabric:</span><span class="sxs-lookup"><span data-stu-id="50c82-203">Set appropriate Service Fabric antivirus exclusions:</span></span>

| <span data-ttu-id="50c82-204">**Directorios excluidos del antivirus**</span><span class="sxs-lookup"><span data-stu-id="50c82-204">**Antivirus Excluded directories**</span></span> |
| --- |
| <span data-ttu-id="50c82-205">Archivos de programa\Microsoft Service Fabric</span><span class="sxs-lookup"><span data-stu-id="50c82-205">Program Files\Microsoft Service Fabric</span></span> |
| <span data-ttu-id="50c82-206">FabricDataRoot (de la configuración del clúster)</span><span class="sxs-lookup"><span data-stu-id="50c82-206">FabricDataRoot (from cluster configuration)</span></span> |
| <span data-ttu-id="50c82-207">FabricLogRoot (de la configuración del clúster)</span><span class="sxs-lookup"><span data-stu-id="50c82-207">FabricLogRoot (from cluster configuration)</span></span> |

| <span data-ttu-id="50c82-208">**Procesos excluidos del antivirus**</span><span class="sxs-lookup"><span data-stu-id="50c82-208">**Antivirus Excluded processes**</span></span> |
| --- |
| <span data-ttu-id="50c82-209">Fabric.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-209">Fabric.exe</span></span> |
| <span data-ttu-id="50c82-210">FabricHost.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-210">FabricHost.exe</span></span> |
| <span data-ttu-id="50c82-211">FabricInstallerService.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-211">FabricInstallerService.exe</span></span> |
| <span data-ttu-id="50c82-212">FabricSetup.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-212">FabricSetup.exe</span></span> |
| <span data-ttu-id="50c82-213">FabricDeployer.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-213">FabricDeployer.exe</span></span> |
| <span data-ttu-id="50c82-214">ImageBuilder.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-214">ImageBuilder.exe</span></span> |
| <span data-ttu-id="50c82-215">FabricGateway.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-215">FabricGateway.exe</span></span> |
| <span data-ttu-id="50c82-216">FabricDCA.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-216">FabricDCA.exe</span></span> |
| <span data-ttu-id="50c82-217">FabricFAS.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-217">FabricFAS.exe</span></span> |
| <span data-ttu-id="50c82-218">FabricUOS.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-218">FabricUOS.exe</span></span> |
| <span data-ttu-id="50c82-219">FabricRM.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-219">FabricRM.exe</span></span> |
| <span data-ttu-id="50c82-220">FileStoreService.exe</span><span class="sxs-lookup"><span data-stu-id="50c82-220">FileStoreService.exe</span></span> |

### <a name="step-8-validate-environment-using-testconfiguration-script"></a><span data-ttu-id="50c82-221">Paso 8.</span><span class="sxs-lookup"><span data-stu-id="50c82-221">Step 8.</span></span> <span data-ttu-id="50c82-222">Validación del entorno mediante el script TestConfiguration</span><span class="sxs-lookup"><span data-stu-id="50c82-222">Validate environment using TestConfiguration script</span></span>
<span data-ttu-id="50c82-223">El script TestConfiguration.ps1 se puede encontrar en el paquete independiente.</span><span class="sxs-lookup"><span data-stu-id="50c82-223">The TestConfiguration.ps1 script can be found in the standalone package.</span></span> <span data-ttu-id="50c82-224">Se usa como Analizador de procedimientos recomendados para validar algunos de los criterios anteriores y debe usarse como una comprobación de integridad para validar si un clúster puede implementarse en un entorno determinado.</span><span class="sxs-lookup"><span data-stu-id="50c82-224">It is used as a Best Practices Analyzer to validate some of the criteria above and should be used as a sanity check to validate whether a cluster can be deployed on a given environment.</span></span> <span data-ttu-id="50c82-225">Si se produce cualquier error, consulte la lista que aparece en [Configuración del entorno](service-fabric-cluster-standalone-deployment-preparation.md) para solucionar el problema.</span><span class="sxs-lookup"><span data-stu-id="50c82-225">If there is any failure, refer to the list under [Environment Setup](service-fabric-cluster-standalone-deployment-preparation.md) for troubleshooting.</span></span> 

<span data-ttu-id="50c82-226">Este script puede ejecutarse en cualquier máquina que tenga acceso de administrador a todas las máquinas que se muestran como nodos en el archivo de configuración del clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-226">This script can be run on any machine that has administrator access to all the machines that are listed as nodes in the cluster configuration file.</span></span> <span data-ttu-id="50c82-227">La máquina donde se ejecuta este script no tiene que formar parte del clúster.</span><span class="sxs-lookup"><span data-stu-id="50c82-227">The machine that this script is run on does not have to be part of the cluster.</span></span>

```powershell
PS C:\temp\Microsoft.Azure.ServiceFabric.WindowsServer> .\TestConfiguration.ps1 -ClusterConfigFilePath .\ClusterConfig.Unsecure.DevCluster.json
Trace folder already exists. Traces will be written to existing trace folder: C:\temp\Microsoft.Azure.ServiceFabric.WindowsServer\DeploymentTraces
Running Best Practices Analyzer...
Best Practices Analyzer completed successfully.


LocalAdminPrivilege        : True
IsJsonValid                : True
IsCabValid                 : True
RequiredPortsOpen          : True
RemoteRegistryAvailable    : True
FirewallAvailable          : True
RpcCheckPassed             : True
NoConflictingInstallations : True
FabricInstallable          : True
Passed                     : True
```

<span data-ttu-id="50c82-228">Actualmente, este módulo de prueba de configuración no valida la configuración de seguridad, así que se debe realizar de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="50c82-228">Currently this configuration testing module does not validate the security configuration so this has to be done independently.</span></span>  

> [!NOTE]
> <span data-ttu-id="50c82-229">Continuamente realizamos mejoras para conseguir que este módulo sea más robusto; por tanto, si cree que hay algún caso incorrecto o que falta que no está contemplado en TestConfiguration, comuníquenoslo a través de nuestros [canales de soporte técnico](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-support).</span><span class="sxs-lookup"><span data-stu-id="50c82-229">We are continually making improvements to make this module more robust, so if there is a faulty or missing case which you believe isn't currently caught by TestConfiguration, please let us know through our [support channels](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-support).</span></span>   
> 
> 

## <a name="next-steps"></a><span data-ttu-id="50c82-230">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="50c82-230">Next steps</span></span>
* [<span data-ttu-id="50c82-231">Creación de un clúster independiente con Windows Server</span><span class="sxs-lookup"><span data-stu-id="50c82-231">Create a standalone cluster running on Windows Server</span></span>](service-fabric-cluster-creation-for-windows-server.md)
