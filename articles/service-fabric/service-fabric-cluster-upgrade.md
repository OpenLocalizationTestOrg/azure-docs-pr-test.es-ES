---
title: "un clúster de Azure Service Fabric aaaUpgrade | Documentos de Microsoft"
description: "Actualizar código de hello Service Fabric o configuración que se ejecuta un clúster de Service Fabric, incluida la configuración de modo de actualización de clúster, actualizar certificados, agregar puertos de la aplicación, realizar revisiones del sistema operativo, y así sucesivamente. ¿Qué puede esperar cuando se realizan las actualizaciones de hello?"
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: 15190ace-31ed-491f-a54b-b5ff61e718db
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 8/10/2017
ms.author: chackdan
ms.openlocfilehash: 94ac3833ec0810f79de06ecb50f254028fa90408
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="upgrade-an-azure-service-fabric-cluster"></a><span data-ttu-id="7bcee-104">Actualización de un clúster de Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="7bcee-104">Upgrade an Azure Service Fabric cluster</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="7bcee-105">Clúster de Azure</span><span class="sxs-lookup"><span data-stu-id="7bcee-105">Azure Cluster</span></span>](service-fabric-cluster-upgrade.md)
> * [<span data-ttu-id="7bcee-106">Clúster independiente</span><span class="sxs-lookup"><span data-stu-id="7bcee-106">Standalone Cluster</span></span>](service-fabric-cluster-upgrade-windows-server.md)
> 
> 

<span data-ttu-id="7bcee-107">Para cualquier sistema moderna, diseño de la actualización es tooachieving clave éxito a largo plazo de su producto.</span><span class="sxs-lookup"><span data-stu-id="7bcee-107">For any modern system, designing for upgradability is key tooachieving long-term success of your product.</span></span> <span data-ttu-id="7bcee-108">Un clúster de Azure Service Fabric es un recurso de su propiedad que está parcialmente administrado por Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7bcee-108">An Azure Service Fabric cluster is a resource that you own, but is partly managed by Microsoft.</span></span> <span data-ttu-id="7bcee-109">En este artículo se describe lo que se administra automáticamente y lo que puede configurar usted mismo.</span><span class="sxs-lookup"><span data-stu-id="7bcee-109">This article describes what is managed automatically and what you can configure yourself.</span></span>

## <a name="controlling-hello-fabric-version-that-runs-on-your-cluster"></a><span data-ttu-id="7bcee-110">Controlar la versión de fabric de Hola que se ejecuta en el clúster</span><span class="sxs-lookup"><span data-stu-id="7bcee-110">Controlling hello fabric version that runs on your Cluster</span></span>
<span data-ttu-id="7bcee-111">Puede establecer a su tejido automática de clúster tooreceive actualizaciones tal y como se publican por Microsoft o puede seleccionar una versión de fabric compatible que desee su toobe de clúster en.</span><span class="sxs-lookup"><span data-stu-id="7bcee-111">You can set your cluster tooreceive automatic fabric upgrades as they are released by Microsoft or you can select a supported fabric version you want your cluster toobe on.</span></span>

<span data-ttu-id="7bcee-112">Para ello, la configuración de clúster de configuración Hola "upgradeMode" en el portal de Hola o con el Administrador de recursos en tiempo de presentación de la creación o posterior en un clúster en vivo</span><span class="sxs-lookup"><span data-stu-id="7bcee-112">You do this by setting hello "upgradeMode" cluster configuration on hello portal or using Resource Manager at hello time of creation or later on a live cluster</span></span> 

> [!NOTE]
> <span data-ttu-id="7bcee-113">Asegúrese de tookeep seguro el clúster que ejecuta una versión compatible de tejido siempre.</span><span class="sxs-lookup"><span data-stu-id="7bcee-113">Make sure tookeep your cluster running a supported fabric version always.</span></span> <span data-ttu-id="7bcee-114">Como y cuando se anunciar el lanzamiento de Hola de una nueva versión de fabric de servicio, versión anterior de hello está marcado para finalización del soporte después de un mínimo de 60 días a partir de esa fecha.</span><span class="sxs-lookup"><span data-stu-id="7bcee-114">As and when we announce hello release of a new version of service fabric, hello previous version is marked for end of support after a minimum of 60 days from that date.</span></span> <span data-ttu-id="7bcee-115">Hola Hola se anuncien nuevas versiones [en el blog del equipo de tejido de servicio de hello](https://blogs.msdn.microsoft.com/azureservicefabric/).</span><span class="sxs-lookup"><span data-stu-id="7bcee-115">hello  hello new releases are announced [on hello service fabric team blog](https://blogs.msdn.microsoft.com/azureservicefabric/).</span></span> <span data-ttu-id="7bcee-116">nueva versión de Hello es toochoose disponible.</span><span class="sxs-lookup"><span data-stu-id="7bcee-116">hello new release is available toochoose then.</span></span> 
> 
> 

<span data-ttu-id="7bcee-117">14 días anteriores toohello expiración de la versión de Hola el clúster se está ejecutando, se genera un evento de estado que coloca el clúster en un estado de mantenimiento de advertencia.</span><span class="sxs-lookup"><span data-stu-id="7bcee-117">14 days prior toohello expiry of hello release your cluster is running, a health event is generated that puts your cluster into a warning health state.</span></span> <span data-ttu-id="7bcee-118">clúster de Hello permanece en un estado de advertencia hasta que actualice la versión de fabric compatibles tooa.</span><span class="sxs-lookup"><span data-stu-id="7bcee-118">hello cluster remains in a warning state until you upgrade tooa supported fabric version.</span></span>

### <a name="setting-hello-upgrade-mode-via-portal"></a><span data-ttu-id="7bcee-119">Establecer el modo de actualización Hola a través del portal</span><span class="sxs-lookup"><span data-stu-id="7bcee-119">Setting hello upgrade mode via portal</span></span>
<span data-ttu-id="7bcee-120">Puede establecer tooautomatic de clúster de Hola o manual al crear el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-120">You can set hello cluster tooautomatic or manual when you are creating hello cluster.</span></span>

![Create_Manualmode][Create_Manualmode]

<span data-ttu-id="7bcee-122">Puede establecer tooautomatic de clúster de Hola o manual cuando está en un clúster activo, con hello administrar la experiencia.</span><span class="sxs-lookup"><span data-stu-id="7bcee-122">You can set hello cluster tooautomatic or manual when on a live cluster, using hello manage experience.</span></span> 

#### <a name="upgrading-tooa-new-version-on-a-cluster-that-is-set-toomanual-mode-via-portal"></a><span data-ttu-id="7bcee-123">Actualizar tooa nueva versión en un clúster que se establece el modo tooManual a través del portal.</span><span class="sxs-lookup"><span data-stu-id="7bcee-123">Upgrading tooa new version on a cluster that is set tooManual mode via portal.</span></span>
<span data-ttu-id="7bcee-124">tooupgrade tooa nueva versión, todo lo que necesita toodo es seleccionar versión disponible de hello en lista desplegable de Hola y guardar.</span><span class="sxs-lookup"><span data-stu-id="7bcee-124">tooupgrade tooa new version, all you need toodo is select hello available version from hello dropdown and save.</span></span> <span data-ttu-id="7bcee-125">actualización de Fabric Hola obtiene iniciada automáticamente.</span><span class="sxs-lookup"><span data-stu-id="7bcee-125">hello Fabric upgrade gets kicked off automatically.</span></span> <span data-ttu-id="7bcee-126">Hello las directivas de mantenimiento de clúster (una combinación del estado de nodo y de hello todas las aplicaciones que se ejecutan en el clúster de Hola de Hola) se respeten la actualización de hello tooduring.</span><span class="sxs-lookup"><span data-stu-id="7bcee-126">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="7bcee-127">Si no se cumplen las directivas de mantenimiento de clúster de hello, Hola actualización se ha revertido.</span><span class="sxs-lookup"><span data-stu-id="7bcee-127">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="7bcee-128">Desplácese hacia abajo en esta tooread documento más acerca de cómo tooset esas directivas personalizada del estado.</span><span class="sxs-lookup"><span data-stu-id="7bcee-128">Scroll down this document tooread more on how tooset those custom health policies.</span></span> 

<span data-ttu-id="7bcee-129">Una vez que se han corregido problemas de Hola que dan como resultado de reversión de hello, necesitará de nuevo, actualización de hello tooinitiate por siguiente Hola mismo pasos como antes.</span><span class="sxs-lookup"><span data-stu-id="7bcee-129">Once you have fixed hello issues that resulted in hello rollback, you need tooinitiate hello upgrade again, by following hello same steps as before.</span></span>

![Manage_Automaticmode][Manage_Automaticmode]

### <a name="setting-hello-upgrade-mode-via-a-resource-manager-template"></a><span data-ttu-id="7bcee-131">Establecer el modo de actualización Hola a través de una plantilla de administrador de recursos</span><span class="sxs-lookup"><span data-stu-id="7bcee-131">Setting hello upgrade mode via a Resource Manager template</span></span>
<span data-ttu-id="7bcee-132">Agregar Hola definición de recursos de "upgradeMode" configuración toohello Microsoft.ServiceFabric/clusters y conjunto Hola "clusterCodeVersion" tooone de hello admite versiones de tejido tal y como se muestra a continuación y, a continuación, implementar la plantilla de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-132">Add hello "upgradeMode" configuration toohello Microsoft.ServiceFabric/clusters resource definition and set hello "clusterCodeVersion" tooone of hello supported fabric versions as shown below and then deploy hello template.</span></span> <span data-ttu-id="7bcee-133">los valores válidos de Hola para "upgradeMode" son "Manual" o "Automático"</span><span class="sxs-lookup"><span data-stu-id="7bcee-133">hello valid values for "upgradeMode" are "Manual" or "Automatic"</span></span>

![ARMUpgradeMode][ARMUpgradeMode]

#### <a name="upgrading-tooa-new-version-on-a-cluster-that-is-set-toomanual-mode-via-a-resource-manager-template"></a><span data-ttu-id="7bcee-135">Actualizar tooa nueva versión en un clúster que se establece el modo de tooManual a través de una plantilla de administrador de recursos.</span><span class="sxs-lookup"><span data-stu-id="7bcee-135">Upgrading tooa new version on a cluster that is set tooManual mode via a Resource Manager template.</span></span>
<span data-ttu-id="7bcee-136">Al clúster de Hola se encuentra en modo Manual, tooupgrade tooa nueva versión, cambiar la versión admitida de tooa clusterCodeVersion"hello" y lo implementará.</span><span class="sxs-lookup"><span data-stu-id="7bcee-136">When hello cluster is in Manual mode, tooupgrade tooa new version, change hello "clusterCodeVersion" tooa supported version and deploy it.</span></span> <span data-ttu-id="7bcee-137">implementación de Hola de plantilla de hello, aparece de actualización de Fabric Hola obtiene iniciado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="7bcee-137">hello deployment of hello template, kicks of hello Fabric upgrade gets kicked off automatically.</span></span> <span data-ttu-id="7bcee-138">Hello las directivas de mantenimiento de clúster (una combinación del estado de nodo y de hello todas las aplicaciones que se ejecutan en el clúster de Hola de Hola) se respeten la actualización de hello tooduring.</span><span class="sxs-lookup"><span data-stu-id="7bcee-138">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="7bcee-139">Si no se cumplen las directivas de mantenimiento de clúster de hello, Hola actualización se ha revertido.</span><span class="sxs-lookup"><span data-stu-id="7bcee-139">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="7bcee-140">Desplácese hacia abajo en esta tooread documento más acerca de cómo tooset esas directivas personalizada del estado.</span><span class="sxs-lookup"><span data-stu-id="7bcee-140">Scroll down this document tooread more on how tooset those custom health policies.</span></span> 

<span data-ttu-id="7bcee-141">Una vez que se han corregido problemas de Hola que dan como resultado de reversión de hello, necesitará de nuevo, actualización de hello tooinitiate por siguiente Hola mismo pasos como antes.</span><span class="sxs-lookup"><span data-stu-id="7bcee-141">Once you have fixed hello issues that resulted in hello rollback, you need tooinitiate hello upgrade again, by following hello same steps as before.</span></span>

### <a name="get-list-of-all-available-version-for-all-environments-for-a-given-subscription"></a><span data-ttu-id="7bcee-142">Obtención de la lista de todas las versiones disponibles para todos los entornos de una suscripción determinada</span><span class="sxs-lookup"><span data-stu-id="7bcee-142">Get list of all available version for all environments for a given subscription</span></span>
<span data-ttu-id="7bcee-143">Ejecutar Hola el siguiente comando y debe obtener un toothis similar de salida.</span><span class="sxs-lookup"><span data-stu-id="7bcee-143">Run hello following command, and you should get an output similar toothis.</span></span>

<span data-ttu-id="7bcee-144">"supportExpiryUtc" le indica cuándo expira o ha expirado una determinada versión.</span><span class="sxs-lookup"><span data-stu-id="7bcee-144">"supportExpiryUtc" tells your when a given release is expiring or has expired.</span></span> <span data-ttu-id="7bcee-145">Hello versión más reciente no tiene una fecha válida, tiene un valor de "9999-12-31T23:59:59.9999999", que simplemente significa que no se estableció aún fecha de expiración de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-145">hello latest release does not have a valid date - it has a value of "9999-12-31T23:59:59.9999999", which just means that hello expiry date is not yet set.</span></span>

```REST
GET https://<endpoint>/subscriptions/{{subscriptionId}}/providers/Microsoft.ServiceFabric/locations/{{location}}/clusterVersions?api-version=2016-09-01

Example: https://management.azure.com/subscriptions/1857f442-3bce-4b96-ad95-627f76437a67/providers/Microsoft.ServiceFabric/locations/eastus/clusterVersions?api-version=2016-09-01

Output:
{
                  "value": [
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/5.0.1427.9490",
                      "name": "5.0.1427.9490",
                      "type": "Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "5.0.1427.9490",
                        "supportExpiryUtc": "2016-11-26T23:59:59.9999999",
                        "environment": "Windows"
                      }
                    },
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/4.0.1427.9490",
                      "name": "5.1.1427.9490",
                      "type": " Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "5.1.1427.9490",
                        "supportExpiryUtc": "9999-12-31T23:59:59.9999999",
                        "environment": "Windows"
                      }
                    },
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/4.4.1427.9490",
                      "name": "4.4.1427.9490",
                      "type": " Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "4.4.1427.9490",
                        "supportExpiryUtc": "9999-12-31T23:59:59.9999999",
                        "environment": "Linux"
                      }
                    }
                  ]
                }


```

## <a name="fabric-upgrade-behavior-when-hello-cluster-upgrade-mode-is-automatic"></a><span data-ttu-id="7bcee-146">Comportamiento de actualización de fabric al modo de actualización de clúster de hello es automático</span><span class="sxs-lookup"><span data-stu-id="7bcee-146">Fabric upgrade behavior when hello cluster Upgrade Mode is Automatic</span></span>
<span data-ttu-id="7bcee-147">Microsoft mantiene el código de fabric de Hola y la configuración que se ejecuta en un clúster de Azure.</span><span class="sxs-lookup"><span data-stu-id="7bcee-147">Microsoft maintains hello fabric code and configuration that runs in an Azure cluster.</span></span> <span data-ttu-id="7bcee-148">Llevamos a cabo software toohello de las actualizaciones automáticas de supervisado según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="7bcee-148">We perform automatic monitored upgrades toohello software on an as-needed basis.</span></span> <span data-ttu-id="7bcee-149">Estas actualizaciones podrían ser de código, de configuración o ambas.</span><span class="sxs-lookup"><span data-stu-id="7bcee-149">These upgrades could be code, configuration, or both.</span></span> <span data-ttu-id="7bcee-150">toomake seguro de que la aplicación no sufre ningún impacto o un impacto mínimo debido a las actualizaciones de toothese, llevamos a cabo las actualizaciones de Hola de hello siguientes fases:</span><span class="sxs-lookup"><span data-stu-id="7bcee-150">toomake sure that your application suffers no impact or minimal impact due toothese upgrades, we perform hello upgrades in hello following phases:</span></span>

### <a name="phase-1-an-upgrade-is-performed-by-using-all-cluster-health-policies"></a><span data-ttu-id="7bcee-151">Fase 1: La actualización se realiza con todas las directivas de mantenimiento de clústeres</span><span class="sxs-lookup"><span data-stu-id="7bcee-151">Phase 1: An upgrade is performed by using all cluster health policies</span></span>
<span data-ttu-id="7bcee-152">Durante esta fase, las actualizaciones de hello continuar un dominio de actualización a la vez y, las aplicaciones de Hola que se estaban ejecutando en el clúster de hello siguen toorun sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="7bcee-152">During this phase, hello upgrades proceed one upgrade domain at a time, and hello applications that were running in hello cluster continue toorun without any downtime.</span></span> <span data-ttu-id="7bcee-153">Hello las directivas de mantenimiento de clúster (una combinación del estado de nodo y de hello todas las aplicaciones que se ejecutan en el clúster de Hola de Hola) se respeten la actualización de hello tooduring.</span><span class="sxs-lookup"><span data-stu-id="7bcee-153">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="7bcee-154">Si no se cumplen las directivas de mantenimiento de clúster de hello, Hola actualización se ha revertido.</span><span class="sxs-lookup"><span data-stu-id="7bcee-154">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="7bcee-155">A continuación, se envía un correo electrónico toohello propietario de la suscripción de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-155">Then an email is sent toohello owner of hello subscription.</span></span> <span data-ttu-id="7bcee-156">correo electrónico de Hello contiene Hola siguiente información:</span><span class="sxs-lookup"><span data-stu-id="7bcee-156">hello email contains hello following information:</span></span>

* <span data-ttu-id="7bcee-157">Notificación de que ha surgido tooroll volver una actualización de clúster.</span><span class="sxs-lookup"><span data-stu-id="7bcee-157">Notification that we had tooroll back a cluster upgrade.</span></span>
* <span data-ttu-id="7bcee-158">Acciones correctoras sugeridas, si hay alguna.</span><span class="sxs-lookup"><span data-stu-id="7bcee-158">Suggested remedial actions, if any.</span></span>
* <span data-ttu-id="7bcee-159">número de Hola de días (n) hasta que se ejecute la fase 2.</span><span class="sxs-lookup"><span data-stu-id="7bcee-159">hello number of days (n) until we execute Phase 2.</span></span>

<span data-ttu-id="7bcee-160">Intentamos hello tooexecute que mismo actualizar varias veces en caso de error en las actualizaciones por razones de infraestructura.</span><span class="sxs-lookup"><span data-stu-id="7bcee-160">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="7bcee-161">Después de hello n días de correo electrónico de hello fecha Hola envió, avancemos tooPhase 2.</span><span class="sxs-lookup"><span data-stu-id="7bcee-161">After hello n days from hello date hello email was sent, we proceed tooPhase 2.</span></span>

<span data-ttu-id="7bcee-162">Si se cumplen las directivas de mantenimiento de clúster de hello, actualización de Hola se considera correcta y marcarse como completada.</span><span class="sxs-lookup"><span data-stu-id="7bcee-162">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="7bcee-163">Esto puede ocurrir durante la actualización inicial de Hola o cualquiera de las retransmisiones de actualización de hello en esta fase.</span><span class="sxs-lookup"><span data-stu-id="7bcee-163">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="7bcee-164">No hay ningún correo electrónico de confirmación de una ejecución correcta.</span><span class="sxs-lookup"><span data-stu-id="7bcee-164">There is no email confirmation of a successful run.</span></span> <span data-ttu-id="7bcee-165">Se trata de tooavoid enviar se demasiados correos electrónicos, recibir un correo electrónico deben considerarse como un toonormal de excepción.</span><span class="sxs-lookup"><span data-stu-id="7bcee-165">This is tooavoid sending you too many emails--receiving an email should be seen as an exception toonormal.</span></span> <span data-ttu-id="7bcee-166">Se espera que la mayoría de hello clúster actualizaciones toosucceed sin afectar a la disponibilidad de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="7bcee-166">We expect most of hello cluster upgrades toosucceed without impacting your application availability.</span></span>

### <a name="phase-2-an-upgrade-is-performed-by-using-default-health-policies-only"></a><span data-ttu-id="7bcee-167">Fase 2: La actualización se realiza solo con las directivas de mantenimiento predeterminadas</span><span class="sxs-lookup"><span data-stu-id="7bcee-167">Phase 2: An upgrade is performed by using default health policies only</span></span>
<span data-ttu-id="7bcee-168">las directivas de mantenimiento de Hello en esta fase se establecen de forma que número de Hola de las aplicaciones que estaban en buen estado en principio Hola de actualización de hello sigue siendo Hola mismo para hello duración del proceso de actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-168">hello health policies in this phase are set in such a way that hello number of applications that were healthy at hello beginning of hello upgrade remains hello same for hello duration of hello upgrade process.</span></span> <span data-ttu-id="7bcee-169">Como en la fase 1, las actualizaciones de hello fase 2 continuar un dominio de actualización a la vez y, las aplicaciones de Hola que se estaban ejecutando en el clúster de hello siguen toorun sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="7bcee-169">As in Phase 1, hello Phase 2 upgrades proceed one upgrade domain at a time, and hello applications that were running in hello cluster continue toorun without any downtime.</span></span> <span data-ttu-id="7bcee-170">las directivas de mantenimiento de clúster de Hello (una combinación del estado de nodo y de hello que todas las aplicaciones que se ejecutan en el clúster de Hola de Hola) son toofor pegada Hola duración de la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-170">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered toofor hello duration of hello upgrade.</span></span>

<span data-ttu-id="7bcee-171">Si las directivas de mantenimiento de clúster de hello no se cumplen en vigor, se revierte la actualización Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-171">If hello cluster health policies in effect are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="7bcee-172">A continuación, se envía un correo electrónico toohello propietario de la suscripción de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-172">Then an email is sent toohello owner of hello subscription.</span></span> <span data-ttu-id="7bcee-173">correo electrónico de Hello contiene Hola siguiente información:</span><span class="sxs-lookup"><span data-stu-id="7bcee-173">hello email contains hello following information:</span></span>

* <span data-ttu-id="7bcee-174">Notificación de que ha surgido tooroll volver una actualización de clúster.</span><span class="sxs-lookup"><span data-stu-id="7bcee-174">Notification that we had tooroll back a cluster upgrade.</span></span>
* <span data-ttu-id="7bcee-175">Acciones correctoras sugeridas, si hay alguna.</span><span class="sxs-lookup"><span data-stu-id="7bcee-175">Suggested remedial actions, if any.</span></span>
* <span data-ttu-id="7bcee-176">número de Hola de días (n) hasta que se ejecute la fase 3.</span><span class="sxs-lookup"><span data-stu-id="7bcee-176">hello number of days (n) until we execute Phase 3.</span></span>

<span data-ttu-id="7bcee-177">Intentamos hello tooexecute que mismo actualizar varias veces en caso de error en las actualizaciones por razones de infraestructura.</span><span class="sxs-lookup"><span data-stu-id="7bcee-177">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="7bcee-178">Se envía un recordatorio por correo electrónico un par de días antes de llegar a n días.</span><span class="sxs-lookup"><span data-stu-id="7bcee-178">A reminder email is sent a couple of days before n days are up.</span></span> <span data-ttu-id="7bcee-179">Después de hello n días de correo electrónico de hello fecha Hola envió, avancemos tooPhase 3.</span><span class="sxs-lookup"><span data-stu-id="7bcee-179">After hello n days from hello date hello email was sent, we proceed tooPhase 3.</span></span> <span data-ttu-id="7bcee-180">Hola mensajes de correo electrónico que se enviarán en la fase 2 deben tener cuidados en serio y acciones correctoras deben tener cuidadas.</span><span class="sxs-lookup"><span data-stu-id="7bcee-180">hello emails we send you in Phase 2 must be taken seriously and remedial actions must be taken.</span></span>

<span data-ttu-id="7bcee-181">Si se cumplen las directivas de mantenimiento de clúster de hello, actualización de Hola se considera correcta y marcarse como completada.</span><span class="sxs-lookup"><span data-stu-id="7bcee-181">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="7bcee-182">Esto puede ocurrir durante la actualización inicial de Hola o cualquiera de las retransmisiones de actualización de hello en esta fase.</span><span class="sxs-lookup"><span data-stu-id="7bcee-182">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="7bcee-183">No hay ningún correo electrónico de confirmación de una ejecución correcta.</span><span class="sxs-lookup"><span data-stu-id="7bcee-183">There is no email confirmation of a successful run.</span></span>

### <a name="phase-3-an-upgrade-is-performed-by-using-aggressive-health-policies"></a><span data-ttu-id="7bcee-184">Fase 3: La actualización se realiza con directivas de mantenimiento agresivas</span><span class="sxs-lookup"><span data-stu-id="7bcee-184">Phase 3: An upgrade is performed by using aggressive health policies</span></span>
<span data-ttu-id="7bcee-185">Estas directivas de mantenimiento en esta fase específicamente orientadas a la finalización de la actualización de hello en lugar de estado de Hola de aplicaciones de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-185">These health policies in this phase are geared towards completion of hello upgrade rather than hello health of hello applications.</span></span> <span data-ttu-id="7bcee-186">Muy pocas actualizaciones del clúster terminarán en esta fase.</span><span class="sxs-lookup"><span data-stu-id="7bcee-186">Very few cluster upgrades end up in this phase.</span></span> <span data-ttu-id="7bcee-187">Si el clúster obtiene toothis fase, hay una gran probabilidad de que la aplicación pasa a ser incorrecto o que pierda la disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="7bcee-187">If your cluster gets toothis phase, there is a good chance that your application becomes unhealthy and/or lose availability.</span></span>

<span data-ttu-id="7bcee-188">Toohello similar otros dos fases, las actualizaciones de la fase 3 continúe un dominio de actualización a la vez.</span><span class="sxs-lookup"><span data-stu-id="7bcee-188">Similar toohello other two phases, Phase 3 upgrades proceed one upgrade domain at a time.</span></span>

<span data-ttu-id="7bcee-189">Si no se cumplen las directivas de mantenimiento de clúster de hello, Hola actualización se ha revertido.</span><span class="sxs-lookup"><span data-stu-id="7bcee-189">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="7bcee-190">Intentamos hello tooexecute que mismo actualizar varias veces en caso de error en las actualizaciones por razones de infraestructura.</span><span class="sxs-lookup"><span data-stu-id="7bcee-190">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="7bcee-191">Después de eso, se ancla clúster hello, por lo que ya no recibirán soporte técnico o actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="7bcee-191">After that, hello cluster is pinned, so that it will no longer receive support and/or upgrades.</span></span>

<span data-ttu-id="7bcee-192">Propietario de la suscripción toohello, junto con las acciones correctoras de hello, se envía un correo con esta información.</span><span class="sxs-lookup"><span data-stu-id="7bcee-192">An email with this information is sent toohello subscription owner, along with hello remedial actions.</span></span> <span data-ttu-id="7bcee-193">No esperamos que cualquier tooget de clústeres en un estado que ha fallado la fase 3.</span><span class="sxs-lookup"><span data-stu-id="7bcee-193">We do not expect any clusters tooget into a state where Phase 3 has failed.</span></span>

<span data-ttu-id="7bcee-194">Si se cumplen las directivas de mantenimiento de clúster de hello, actualización de Hola se considera correcta y marcarse como completada.</span><span class="sxs-lookup"><span data-stu-id="7bcee-194">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="7bcee-195">Esto puede ocurrir durante la actualización inicial de Hola o cualquiera de las retransmisiones de actualización de hello en esta fase.</span><span class="sxs-lookup"><span data-stu-id="7bcee-195">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="7bcee-196">No hay ningún correo electrónico de confirmación de una ejecución correcta.</span><span class="sxs-lookup"><span data-stu-id="7bcee-196">There is no email confirmation of a successful run.</span></span>

## <a name="cluster-configurations-that-you-control"></a><span data-ttu-id="7bcee-197">Opciones de configuración de clúster controladas por el usuario</span><span class="sxs-lookup"><span data-stu-id="7bcee-197">Cluster configurations that you control</span></span>
<span data-ttu-id="7bcee-198">Además actualizar el modo de clúster de toohello capacidad tooset hello, estas son las configuraciones de Hola que puede cambiar en un clúster activo.</span><span class="sxs-lookup"><span data-stu-id="7bcee-198">In addition toohello ability tooset hello cluster upgrade mode, Here are hello configurations that you can change on a live cluster.</span></span>

### <a name="certificates"></a><span data-ttu-id="7bcee-199">Certificados</span><span class="sxs-lookup"><span data-stu-id="7bcee-199">Certificates</span></span>
<span data-ttu-id="7bcee-200">Puede agregar nuevos o eliminar certificados para el clúster de Hola y de cliente a través del portal de hello fácilmente.</span><span class="sxs-lookup"><span data-stu-id="7bcee-200">You can add new or delete certificates for hello cluster and client via hello portal easily.</span></span> <span data-ttu-id="7bcee-201">Consulte demasiado[este documento para obtener instrucciones detalladas](service-fabric-cluster-security-update-certs-azure.md)</span><span class="sxs-lookup"><span data-stu-id="7bcee-201">Refer too[this document for detailed instructions](service-fabric-cluster-security-update-certs-azure.md)</span></span>

![Captura de pantalla que muestra las huellas digitales de certificado en hello portal de Azure.][CertificateUpgrade]

### <a name="application-ports"></a><span data-ttu-id="7bcee-203">Puertos de aplicación</span><span class="sxs-lookup"><span data-stu-id="7bcee-203">Application ports</span></span>
<span data-ttu-id="7bcee-204">Puede cambiar los puertos de la aplicación cambiando las propiedades de recurso de equilibrador de carga de Hola que están asociados con el tipo de nodo de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-204">You can change application ports by changing hello Load Balancer resource properties that are associated with hello node type.</span></span> <span data-ttu-id="7bcee-205">Puede usar el portal de hello, o puede usar el Administrador de recursos PowerShell directamente.</span><span class="sxs-lookup"><span data-stu-id="7bcee-205">You can use hello portal, or you can use Resource Manager PowerShell directly.</span></span>

<span data-ttu-id="7bcee-206">Hola tooopen un nuevo puerto en todas las máquinas virtuales en un tipo de nodo siguientes:</span><span class="sxs-lookup"><span data-stu-id="7bcee-206">tooopen a new port on all VMs in a node type, do hello following:</span></span>

1. <span data-ttu-id="7bcee-207">Agregar un nuevo equilibrador de carga adecuado de toohello de sondeo.</span><span class="sxs-lookup"><span data-stu-id="7bcee-207">Add a new probe toohello appropriate load balancer.</span></span>
   
    <span data-ttu-id="7bcee-208">Si ha implementado el clúster mediante el portal de hello, equilibradores de carga de Hola se denominan "LB-nombre de grupo de recursos de hello-NodeTypename", uno para cada tipo de nodo.</span><span class="sxs-lookup"><span data-stu-id="7bcee-208">If you deployed your cluster by using hello portal, hello load balancers are named "LB-name of hello Resource group-NodeTypename", one for each node type.</span></span> <span data-ttu-id="7bcee-209">Puesto que los nombres de equilibrador de carga de hello son únicos solo dentro de un grupo de recursos, es mejor que una búsqueda en un grupo de recursos específico.</span><span class="sxs-lookup"><span data-stu-id="7bcee-209">Since hello load balancer names are unique only within a resource group, it is best if you search for them under a specific resource group.</span></span>
   
    ![Captura de pantalla que muestra cómo agregar un sondeo tooa equilibrador de carga de portal de Hola.][AddingProbes]
2. <span data-ttu-id="7bcee-211">Agregar un nuevo equilibrador de carga de toohello de regla.</span><span class="sxs-lookup"><span data-stu-id="7bcee-211">Add a new rule toohello load balancer.</span></span>
   
    <span data-ttu-id="7bcee-212">Agregar un nuevo toohello de regla mismo equilibrador de carga mediante el uso de sondeo de Hola que creó en el paso anterior de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-212">Add a new rule toohello same load balancer by using hello probe that you created in hello previous step.</span></span>
   
    ![Agregar un nuevo equilibrador de carga de tooa de regla en el portal de Hola.][AddingLBRules]

### <a name="placement-properties"></a><span data-ttu-id="7bcee-214">Propiedades de colocación</span><span class="sxs-lookup"><span data-stu-id="7bcee-214">Placement properties</span></span>
<span data-ttu-id="7bcee-215">Para cada uno de los tipos de nodos de hello, puede agregar propiedades de selección de ubicación personalizada que desee toouse en sus aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="7bcee-215">For each of hello node types, you can add custom placement properties that you want toouse in your applications.</span></span> <span data-ttu-id="7bcee-216">NodeType es una propiedad predeterminada que se puede usar sin agregarla explícitamente.</span><span class="sxs-lookup"><span data-stu-id="7bcee-216">NodeType is a default property that you can use without adding it explicitly.</span></span>

> [!NOTE]
> <span data-ttu-id="7bcee-217">Para obtener más información sobre el uso de Hola de restricciones de posición, propiedades de nodo, y cómo toodefine, consulte toohello sección "Propiedades del nodo y las restricciones de colocación" Hola documento de servicio Administrador de recursos del clúster de tejido en [que describe el clúster ](service-fabric-cluster-resource-manager-cluster-description.md).</span><span class="sxs-lookup"><span data-stu-id="7bcee-217">For details on hello use of placement constraints, node properties, and how toodefine them, refer toohello section "Placement Constraints and Node Properties" in hello Service Fabric Cluster Resource Manager Document on [Describing Your Cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span></span>
> 
> 

### <a name="capacity-metrics"></a><span data-ttu-id="7bcee-218">Métricas de capacidad</span><span class="sxs-lookup"><span data-stu-id="7bcee-218">Capacity metrics</span></span>
<span data-ttu-id="7bcee-219">Para cada uno de los tipos de nodos de hello, puede agregar las métricas de capacidad personalizado que desea que toouse en su carga de tooreport de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="7bcee-219">For each of hello node types, you can add custom capacity metrics that you want toouse in your applications tooreport load.</span></span> <span data-ttu-id="7bcee-220">Para obtener detalles sobre el uso de Hola de carga de tooreport de las métricas de capacidad, consulte toohello documentos de servicio Administrador de recursos del clúster de tejido en [que describe su clúster](service-fabric-cluster-resource-manager-cluster-description.md) y [métricas y carga](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="7bcee-220">For details on hello use of capacity metrics tooreport load, refer toohello Service Fabric Cluster Resource Manager Documents on [Describing Your Cluster](service-fabric-cluster-resource-manager-cluster-description.md) and [Metrics and Load](service-fabric-cluster-resource-manager-metrics.md).</span></span>

### <a name="fabric-upgrade-settings---health-polices"></a><span data-ttu-id="7bcee-221">Configuración de la actualización de Service Fabric: directivas de mantenimiento</span><span class="sxs-lookup"><span data-stu-id="7bcee-221">Fabric upgrade settings - Health polices</span></span>
<span data-ttu-id="7bcee-222">Puede especificar directivas de mantenimiento personalizado para la actualización de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="7bcee-222">You can specify custom health polices for fabric upgrade.</span></span> <span data-ttu-id="7bcee-223">Si ha configurado el clúster tooAutomatic actualizaciones de tejido, estas directivas obtener aplicada toohello fase 1 de las actualizaciones de tejido automática Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-223">If you have set your cluster tooAutomatic fabric upgrades, then these policies get applied toohello Phase-1 of hello automatic fabric upgrades.</span></span>
<span data-ttu-id="7bcee-224">Si se han establecido el tejido Manual del clúster de las actualizaciones, a continuación, estas directivas se aplican cada vez que seleccione una nueva versión desencadenar Hola sistema tookick desactivar actualización de fabric de hello en el clúster.</span><span class="sxs-lookup"><span data-stu-id="7bcee-224">If you have set your cluster for Manual fabric upgrades, then these policies get applied each time you select a new version triggering hello system tookick off hello fabric upgrade in your cluster.</span></span> <span data-ttu-id="7bcee-225">Si no reemplaza las directivas de hello, se usan los valores predeterminados de Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-225">If you do not override hello policies, hello defaults are used.</span></span>

<span data-ttu-id="7bcee-226">Puede especificar las directivas de mantenimiento personalizado de Hola o revisar la configuración actual de hello en la hoja de "actualización de fabric" Hola, mediante la selección Hola actualización configuración avanzada.</span><span class="sxs-lookup"><span data-stu-id="7bcee-226">You can specify hello custom health policies or review hello current settings under hello "fabric upgrade" blade, by selecting hello advanced upgrade settings.</span></span> <span data-ttu-id="7bcee-227">Revise Hola siguiente sobre cómo.</span><span class="sxs-lookup"><span data-stu-id="7bcee-227">Review hello following picture on how to.</span></span> 

![Administración de las directivas de mantenimiento personalizado][HealthPolices]

### <a name="customize-fabric-settings-for-your-cluster"></a><span data-ttu-id="7bcee-229">Personalización de la configuración de Service Fabric para el clúster</span><span class="sxs-lookup"><span data-stu-id="7bcee-229">Customize Fabric settings for your cluster</span></span>
<span data-ttu-id="7bcee-230">Consulte demasiado[configuración de tejido de clúster de tejido del servicio](service-fabric-cluster-fabric-settings.md) qué y cómo se puede personalizar.</span><span class="sxs-lookup"><span data-stu-id="7bcee-230">Refer too[service fabric cluster fabric settings](service-fabric-cluster-fabric-settings.md) on what and how you can customize them.</span></span>

### <a name="os-patches-on-hello-vms-that-make-up-hello-cluster"></a><span data-ttu-id="7bcee-231">Revisiones del sistema operativo en las máquinas virtuales que forman el clúster de Hola Hola</span><span class="sxs-lookup"><span data-stu-id="7bcee-231">OS patches on hello VMs that make up hello cluster</span></span>
<span data-ttu-id="7bcee-232">Consulte demasiado[revisión orquestación aplicación](service-fabric-patch-orchestration-application.md) que se pueden implementar en las revisiones de tooinstall de clúster de Windows Update de una manera de orquestaciones, mantener los servicios de hello disponibles todo el tiempo Hola.</span><span class="sxs-lookup"><span data-stu-id="7bcee-232">Refer too[Patch Orchestration Application](service-fabric-patch-orchestration-application.md) which can be deployed on your cluster tooinstall patches from Windows Update in an orchestrated manner, keeping hello services available all hello time.</span></span> 

### <a name="os-upgrades-on-hello-vms-that-make-up-hello-cluster"></a><span data-ttu-id="7bcee-233">Actualizaciones de sistema operativo en las máquinas virtuales que forman el clúster de Hola Hola</span><span class="sxs-lookup"><span data-stu-id="7bcee-233">OS upgrades on hello VMs that make up hello cluster</span></span>
<span data-ttu-id="7bcee-234">Si debe actualizar la imagen del sistema operativo hello en las máquinas virtuales del clúster de Hola Hola, se debe hacer una máquina virtual a la vez.</span><span class="sxs-lookup"><span data-stu-id="7bcee-234">If you must upgrade hello OS image on hello virtual machines of hello cluster, you must do it one VM at a time.</span></span> <span data-ttu-id="7bcee-235">Usted es responsable de esta actualización: todavía no se ha automatizado esta tarea.</span><span class="sxs-lookup"><span data-stu-id="7bcee-235">You are responsible for this upgrade--there is currently no automation for this.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7bcee-236">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="7bcee-236">Next steps</span></span>
* <span data-ttu-id="7bcee-237">Obtenga información acerca de cómo toocustomize algunos hello [configuración de tejido de clúster de tejido de servicio](service-fabric-cluster-fabric-settings.md)</span><span class="sxs-lookup"><span data-stu-id="7bcee-237">Learn how toocustomize some of hello [service fabric cluster fabric settings](service-fabric-cluster-fabric-settings.md)</span></span>
* <span data-ttu-id="7bcee-238">Obtenga información acerca de cómo demasiado[escalar el clúster de entrada y salida](service-fabric-cluster-scale-up-down.md)</span><span class="sxs-lookup"><span data-stu-id="7bcee-238">Learn how too[scale your cluster in and out](service-fabric-cluster-scale-up-down.md)</span></span>
* <span data-ttu-id="7bcee-239">Obtenga información sobre [actualizaciones de aplicaciones](service-fabric-application-upgrade.md)</span><span class="sxs-lookup"><span data-stu-id="7bcee-239">Learn about [application upgrades](service-fabric-application-upgrade.md)</span></span>

<!--Image references-->
[CertificateUpgrade]: ./media/service-fabric-cluster-upgrade/CertificateUpgrade2.png
[AddingProbes]: ./media/service-fabric-cluster-upgrade/addingProbes2.PNG
[AddingLBRules]: ./media/service-fabric-cluster-upgrade/addingLBRules.png
[HealthPolices]: ./media/service-fabric-cluster-upgrade/Manage_AutomodeWadvSettings.PNG
[ARMUpgradeMode]: ./media/service-fabric-cluster-upgrade/ARMUpgradeMode.PNG
[Create_Manualmode]: ./media/service-fabric-cluster-upgrade/Create_Manualmode.PNG
[Manage_Automaticmode]: ./media/service-fabric-cluster-upgrade/Manage_Automaticmode.PNG
