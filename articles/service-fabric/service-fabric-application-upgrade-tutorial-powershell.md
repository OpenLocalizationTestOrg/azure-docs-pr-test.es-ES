---
title: "Actualización de aplicaciones de Service Fabric con PowerShell| Microsoft Docs"
description: "Este artículo le guía a través de la experiencia de implementación de una aplicación de Service Fabric, la modificación del código y la aplicación de actualizaciones con PowerShell."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 9bc75748-96b0-49ca-8d8a-41fe08398f25
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 3591ced970887d4eb5a33cec8f6951b5476d04f8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade-using-powershell"></a><span data-ttu-id="55af4-103">Actualización de aplicaciones de Service Fabric con PowerShell</span><span class="sxs-lookup"><span data-stu-id="55af4-103">Service Fabric application upgrade using PowerShell</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="55af4-104">PowerShell</span><span class="sxs-lookup"><span data-stu-id="55af4-104">PowerShell</span></span>](service-fabric-application-upgrade-tutorial-powershell.md)
> * [<span data-ttu-id="55af4-105">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="55af4-105">Visual Studio</span></span>](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="55af4-106">El enfoque de actualización recomendado y usado con mayor frecuencia es la actualización gradual supervisada.</span><span class="sxs-lookup"><span data-stu-id="55af4-106">The most frequently used and recommended upgrade approach is the monitored rolling upgrade.</span></span>  <span data-ttu-id="55af4-107">Azure Service Fabric supervisa el estado de la aplicación que se está actualizando en función de un conjunto de directivas de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="55af4-107">Azure Service Fabric monitors the health of the application being upgraded based on a set of health policies.</span></span> <span data-ttu-id="55af4-108">Después de actualizar un dominio de actualización (UD), Service Fabric evalúa el estado de la aplicación y, o bien continúa con el siguiente dominio de actualización, o no realiza la actualización, según las directivas de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="55af4-108">Once an update domain (UD) is upgraded, Service Fabric evaluates the application health and either proceeds to the next update domain or fails the upgrade depending on the health policies.</span></span>

<span data-ttu-id="55af4-109">Se puede realizar una actualización de la aplicación supervisada mediante las API nativas o administradas, PowerShell o REST.</span><span class="sxs-lookup"><span data-stu-id="55af4-109">A monitored application upgrade can be performed using the managed or native APIs, PowerShell, or REST.</span></span> <span data-ttu-id="55af4-110">Para obtener instrucciones sobre cómo realizar una actualización con Visual Studio, consulte [Actualización de la aplicación con Visual Studio](service-fabric-application-upgrade-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-110">For instructions on performing an upgrade using Visual Studio, see [Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md).</span></span>

<span data-ttu-id="55af4-111">Con la actualización gradual supervisada de Service Fabric, el Administrador de aplicaciones puede configurar la directiva de evaluación de estado que Service Fabric usa para determinar que la aplicación es correcta.</span><span class="sxs-lookup"><span data-stu-id="55af4-111">With Service Fabric monitored rolling upgrades, the application administrator can configure the health evaluation policy that Service Fabric uses to determine if the application is healthy.</span></span> <span data-ttu-id="55af4-112">Además, el Administrador puede configurar la acción que se realizará cuando la evaluación de estado encuentre errores (por ejemplo, realizar una reversión automática). En esta sección se ofrece orientación sobre una actualización supervisada para uno de los ejemplos del SDK que PowerShell utiliza.</span><span class="sxs-lookup"><span data-stu-id="55af4-112">In addition, the administrator can configure the action to be taken when the health evaluation fails (for example, doing an automatic rollback.) This section walks through a monitored upgrade for one of the SDK samples that uses PowerShell.</span></span> <span data-ttu-id="55af4-113">El siguiente Microsoft Virtual Academy vídeo también le guía a través de una actualización de la aplicación: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span><span class="sxs-lookup"><span data-stu-id="55af4-113">The following Microsoft Virtual Academy video also walks you through an app upgrade: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span></span>

## <a name="step-1-build-and-deploy-the-visual-objects-sample"></a><span data-ttu-id="55af4-114">Paso 1: Crear e implementar el ejemplo de objetos visuales</span><span class="sxs-lookup"><span data-stu-id="55af4-114">Step 1: Build and deploy the Visual Objects sample</span></span>
<span data-ttu-id="55af4-115">Para compilar y publicar la aplicación, haga clic con el botón derecho en el proyecto de aplicación, **VisualObjectsApplication,** y seleccione el comando **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="55af4-115">Build and publish the application by right-clicking on the application project, **VisualObjectsApplication,** and selecting the **Publish** command.</span></span>  <span data-ttu-id="55af4-116">Para más información, consulte el [tutorial sobre la actualización de aplicaciones de Service Fabric](service-fabric-application-upgrade-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-116">For more information, see [Service Fabric application upgrade tutorial](service-fabric-application-upgrade-tutorial.md).</span></span>  <span data-ttu-id="55af4-117">También puede usar PowerShell para implementar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="55af4-117">Alternatively, you can use PowerShell to deploy your application.</span></span>

> [!NOTE]
> <span data-ttu-id="55af4-118">Antes de que se pueda usar cualquiera de los comandos de Service Fabric en PowerShell, hay que conectarse primero al clúster mediante el cmdlet `Connect-ServiceFabricCluster`.</span><span class="sxs-lookup"><span data-stu-id="55af4-118">Before any of the Service Fabric commands may be used in PowerShell, you first need to connect to the cluster by using the `Connect-ServiceFabricCluster` cmdlet.</span></span> <span data-ttu-id="55af4-119">Del mismo modo, se supone que el clúster ya se ha configurado en la máquina local.</span><span class="sxs-lookup"><span data-stu-id="55af4-119">Similarly, it is assumed that the Cluster has already been set up on your local machine.</span></span> <span data-ttu-id="55af4-120">Vea el artículo sobre [configuración del entorno de desarrollo de Service Fabric](service-fabric-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-120">See the article on [setting up your Service Fabric development environment](service-fabric-get-started.md).</span></span>
> 
> 

<span data-ttu-id="55af4-121">Después de compilar el proyecto en Visual Studio, puede utilizar el comando de PowerShell [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) para copiar el paquete de aplicación en ImageStore.</span><span class="sxs-lookup"><span data-stu-id="55af4-121">After building the project in Visual Studio, you can use the PowerShell command [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) to copy the application package to the ImageStore.</span></span> <span data-ttu-id="55af4-122">Si quiere comprobar el paquete de la aplicación de forma local, use el cmdlet [ServiceFabricApplicationPackage prueba](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage).</span><span class="sxs-lookup"><span data-stu-id="55af4-122">If you want to verify the app package locally, use the [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span> <span data-ttu-id="55af4-123">El siguiente paso es registrar la aplicación en el entorno de tiempo de ejecución de Service Fabric mediante el cmdlet [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) .</span><span class="sxs-lookup"><span data-stu-id="55af4-123">The next step is to register the application to the Service Fabric runtime using the [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) cmdlet.</span></span> <span data-ttu-id="55af4-124">El último paso es iniciar una instancia de la aplicación mediante el cmdlet [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) .</span><span class="sxs-lookup"><span data-stu-id="55af4-124">The final step is to start an instance of the application by using the [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span>  <span data-ttu-id="55af4-125">Estos tres pasos son análogos al uso del elemento de menú **Implementar** en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="55af4-125">These three steps are analogous to using the **Deploy** menu item in Visual Studio.</span></span>

<span data-ttu-id="55af4-126">Ahora, puede usar el [explorador de Service Fabric para ver el clúster y la aplicación](service-fabric-visualizing-your-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-126">Now, you can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="55af4-127">La aplicación tiene un servicio web hasta el que se puede navegar en Internet Explorer; para ello, escriba [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) en la barra de direcciones.</span><span class="sxs-lookup"><span data-stu-id="55af4-127">The application has a web service that can be navigated to in Internet Explorer by typing [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) in the address bar.</span></span>  <span data-ttu-id="55af4-128">Debería ver algunos objetos visuales flotantes desplazándose por la pantalla.</span><span class="sxs-lookup"><span data-stu-id="55af4-128">You should see some floating visual objects moving around in the screen.</span></span>  <span data-ttu-id="55af4-129">Además, se puede usar [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) para comprobar el estado de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="55af4-129">Additionally, you can use [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) to check the application status.</span></span>

## <a name="step-2-update-the-visual-objects-sample"></a><span data-ttu-id="55af4-130">Paso 2: Actualizar el ejemplo de objetos visuales</span><span class="sxs-lookup"><span data-stu-id="55af4-130">Step 2: Update the Visual Objects sample</span></span>
<span data-ttu-id="55af4-131">Puede que observe que con la versión que se implementó en el Paso 1, los objetos visuales no giran.</span><span class="sxs-lookup"><span data-stu-id="55af4-131">You might notice that with the version that was deployed in Step 1, the visual objects do not rotate.</span></span> <span data-ttu-id="55af4-132">Vamos a actualizar esta aplicación a una donde los objetos visuales giren.</span><span class="sxs-lookup"><span data-stu-id="55af4-132">Let's upgrade this application to one where the visual objects also rotate.</span></span>

<span data-ttu-id="55af4-133">Elija el proyecto VisualObjects.ActorService dentro de la solución VisualObjects y abra el archivo StatefulVisualObjectActor.cs.</span><span class="sxs-lookup"><span data-stu-id="55af4-133">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the StatefulVisualObjectActor.cs file.</span></span> <span data-ttu-id="55af4-134">Dentro de ese archivo, vaya al método `MoveObject`, comente `this.State.Move()` y quite la marca de comentario de `this.State.Move(true)`.</span><span class="sxs-lookup"><span data-stu-id="55af4-134">Within that file, navigate to the method `MoveObject`, comment out `this.State.Move()`, and uncomment `this.State.Move(true)`.</span></span> <span data-ttu-id="55af4-135">Este cambio gira los objetos después de que se actualiza el servicio.</span><span class="sxs-lookup"><span data-stu-id="55af4-135">This change rotates the objects after the service is upgraded.</span></span>

<span data-ttu-id="55af4-136">También necesitamos actualizar el archivo *ServiceManifest.xml* (debajo de PackageRoot) del proyecto **VisualObjects.ActorService**.</span><span class="sxs-lookup"><span data-stu-id="55af4-136">We also need to update the *ServiceManifest.xml* file (under PackageRoot) of the project **VisualObjects.ActorService**.</span></span> <span data-ttu-id="55af4-137">Actualice el *CodePackage* y la versión del servicio a 2.0 y las líneas correspondientes del archivo *ServiceManifest.xml*.</span><span class="sxs-lookup"><span data-stu-id="55af4-137">Update the *CodePackage* and the service version to 2.0, and the corresponding lines in the *ServiceManifest.xml* file.</span></span>
<span data-ttu-id="55af4-138">Puede utilizar la opción *Edit Manifest Files* (Editar archivos de manifiesto) de Visual Studio después de hacer clic con el botón derecho en la solución para realizar los cambios del archivo de manifiesto.</span><span class="sxs-lookup"><span data-stu-id="55af4-138">You can use the Visual Studio *Edit Manifest Files* option after you right-click on the solution to make the manifest file changes.</span></span>

<span data-ttu-id="55af4-139">Una vez realizados los cambios, el manifiesto debe ser similar al siguiente (las partes resaltadas muestran los cambios):</span><span class="sxs-lookup"><span data-stu-id="55af4-139">After the changes are made, the manifest should look like the following (highlighted portions show the changes):</span></span>

```xml
<ServiceManifestName="VisualObjects.ActorService" Version="2.0" xmlns="http://schemas.microsoft.com/2011/01/fabric" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

<CodePackageName="Code" Version="2.0">
```

<span data-ttu-id="55af4-140">Ahora el archivo *ApplicationManifest.xml* (que se encuentra en el proyecto **VisualObjects** en la solución **VisualObjects**) se actualiza a la versión 2.0 del proyecto **VisualObjects.ActorService**.</span><span class="sxs-lookup"><span data-stu-id="55af4-140">Now the *ApplicationManifest.xml* file (found under the **VisualObjects** project under the **VisualObjects** solution) is updated to version 2.0 of the **VisualObjects.ActorService** project.</span></span> <span data-ttu-id="55af4-141">Además, la versión de la aplicación se actualiza a la 2.0.0.0 desde la 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="55af4-141">In addition, the Application version is updated to 2.0.0.0 from 1.0.0.0.</span></span> <span data-ttu-id="55af4-142">El archivo *ApplicationManifest.xml* debe parecerse a este fragmento de código:</span><span class="sxs-lookup"><span data-stu-id="55af4-142">The *ApplicationManifest.xml* should look like the following snippet:</span></span>

```xml
<ApplicationManifestxmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ApplicationTypeName="VisualObjects" ApplicationTypeVersion="2.0.0.0" xmlns="http://schemas.microsoft.com/2011/01/fabric">

 <ServiceManifestRefServiceManifestName="VisualObjects.ActorService" ServiceManifestVersion="2.0" />
```


<span data-ttu-id="55af4-143">Ahora, compile el proyecto; para ello, seleccione solamente el proyecto **ActorService** y luego haga clic con el botón derecho y seleccione la opción **Compilar** en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="55af4-143">Now, build the project by selecting just the **ActorService** project, and then right-clicking and selecting the **Build** option in Visual Studio.</span></span> <span data-ttu-id="55af4-144">Si selecciona **Volver a generar todo**, debe actualizar las versiones de todos los proyectos, ya que el código habrá cambiado.</span><span class="sxs-lookup"><span data-stu-id="55af4-144">If you select **Rebuild all**, you should update the versions for all projects, since the code would have changed.</span></span> <span data-ttu-id="55af4-145">A continuación, vamos a empaquetar la aplicación actualizada; para ello, haga clic con el botón derecho en ***VisualObjectsApplication***, seleccione el menú de Service Fabric y elija **Paquete**.</span><span class="sxs-lookup"><span data-stu-id="55af4-145">Next, let's package the updated application by right-clicking on ***VisualObjectsApplication***, selecting the Service Fabric Menu, and choosing **Package**.</span></span> <span data-ttu-id="55af4-146">Esta acción crea un paquete de aplicación que se puede implementar.</span><span class="sxs-lookup"><span data-stu-id="55af4-146">This action creates an application package that can be deployed.</span></span>  <span data-ttu-id="55af4-147">La aplicación actualizada está lista para implementarse.</span><span class="sxs-lookup"><span data-stu-id="55af4-147">Your updated application is ready to be deployed.</span></span>

## <a name="step-3--decide-on-health-policies-and-upgrade-parameters"></a><span data-ttu-id="55af4-148">Paso 3: Decidir sobre las directivas de mantenimiento y los parámetros de actualización</span><span class="sxs-lookup"><span data-stu-id="55af4-148">Step 3:  Decide on health policies and upgrade parameters</span></span>
<span data-ttu-id="55af4-149">Familiarícese con los [parámetros de actualización de la aplicación](service-fabric-application-upgrade-parameters.md) y el [proceso de actualización](service-fabric-application-upgrade.md) para obtener una buena comprensión de los distintos parámetros de actualización, los tiempos de espera y el criterio de estado aplicados.</span><span class="sxs-lookup"><span data-stu-id="55af4-149">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion applied.</span></span> <span data-ttu-id="55af4-150">En este tutorial, el criterio de evaluación de estado del servicio se establecerá en los valores predeterminados (y recomendados), lo que significa que todos los servicios e instancias deben ser *correctos* tras la actualización.</span><span class="sxs-lookup"><span data-stu-id="55af4-150">For this walkthrough, the service health evaluation criterion is set to the default (and recommended) values, which means that all services and instances should be *healthy* after the upgrade.</span></span>  

<span data-ttu-id="55af4-151">Sin embargo, vamos a aumentar *HealthCheckStableDuration* en 60 segundos (de modo que los servicios sean correctos durante al menos 20 segundos antes de que la actualización continúe con el siguiente dominio de actualización).</span><span class="sxs-lookup"><span data-stu-id="55af4-151">However, let's increase the *HealthCheckStableDuration* to 60 seconds (so that the services are healthy for at least 20 seconds before the upgrade proceeds to the next update domain).</span></span>  <span data-ttu-id="55af4-152">Vamos a configurar también *UpgradeDomainTimeout* para que sea 1200 segundos y *UpgradeTimeout* para que sea 3000 segundos.</span><span class="sxs-lookup"><span data-stu-id="55af4-152">Let's also set the *UpgradeDomainTimeout* to be 1200 seconds and the *UpgradeTimeout* to be 3000 seconds.</span></span>

<span data-ttu-id="55af4-153">Por último, vamos a establecer también el valor de *UpgradeFailureAction* en reversión.</span><span class="sxs-lookup"><span data-stu-id="55af4-153">Finally, let's also set the *UpgradeFailureAction* to rollback.</span></span> <span data-ttu-id="55af4-154">Esta opción requiere Service Fabric revierta la aplicación a la versión anterior si encuentra algún problema durante la actualización.</span><span class="sxs-lookup"><span data-stu-id="55af4-154">This option requires Service Fabric to roll back the application to the previous version if it encounters any issues during the upgrade.</span></span> <span data-ttu-id="55af4-155">Por lo tanto, al iniciar la actualización (en el paso 4), se especifican los parámetros siguientes:</span><span class="sxs-lookup"><span data-stu-id="55af4-155">Thus, when starting the upgrade (in Step 4), the following parameters are specified:</span></span>

<span data-ttu-id="55af4-156">FailureAction = Rollback</span><span class="sxs-lookup"><span data-stu-id="55af4-156">FailureAction = Rollback</span></span>

<span data-ttu-id="55af4-157">HealthCheckStableDurationSec = 60</span><span class="sxs-lookup"><span data-stu-id="55af4-157">HealthCheckStableDurationSec = 60</span></span>

<span data-ttu-id="55af4-158">UpgradeDomainTimeoutSec = 1200</span><span class="sxs-lookup"><span data-stu-id="55af4-158">UpgradeDomainTimeoutSec = 1200</span></span>

<span data-ttu-id="55af4-159">UpgradeTimeout = 3000</span><span class="sxs-lookup"><span data-stu-id="55af4-159">UpgradeTimeout = 3000</span></span>

## <a name="step-4-prepare-application-for-upgrade"></a><span data-ttu-id="55af4-160">Paso 4: Preparar la aplicación para la actualización</span><span class="sxs-lookup"><span data-stu-id="55af4-160">Step 4: Prepare application for upgrade</span></span>
<span data-ttu-id="55af4-161">Ahora, la aplicación se ha creado y está lista para actualizarse.</span><span class="sxs-lookup"><span data-stu-id="55af4-161">Now the application is built and ready to be upgraded.</span></span> <span data-ttu-id="55af4-162">Si abre una ventana de PowerShell como administrador y escribe [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), debe indicarle que la aplicación que se ha implementado es el tipo de aplicación 1.0.0.0 de **VisualObjects**.</span><span class="sxs-lookup"><span data-stu-id="55af4-162">If you open up a PowerShell window as an administrator and type [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), it should let you know that it is application type 1.0.0.0 of **VisualObjects** that's been deployed.</span></span>  

<span data-ttu-id="55af4-163">El paquete de aplicación se almacena en la siguiente ruta de acceso relativa donde descomprimió el SDK de Service Fabric: *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span><span class="sxs-lookup"><span data-stu-id="55af4-163">The application package is stored under the following relative path where you uncompressed the Service Fabric SDK - *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span></span> <span data-ttu-id="55af4-164">Debería encontrará una carpeta "Paquete" en ese directorio, que es donde se almacena el paquete de aplicación.</span><span class="sxs-lookup"><span data-stu-id="55af4-164">You should find a "Package" folder in that directory, where the application package is stored.</span></span> <span data-ttu-id="55af4-165">Compruebe las marcas de tiempo para asegurarse de que es la última compilación (puede que necesite además modificar las rutas de acceso adecuadamente).</span><span class="sxs-lookup"><span data-stu-id="55af4-165">Check the timestamps to ensure that it is the latest build (you may need to modify the paths appropriately as well).</span></span>

<span data-ttu-id="55af4-166">Ahora vamos a copiar el paquete de la aplicación actualizada a la ImageStore de Service Fabric (donde se almacenan los paquetes de la aplicación por Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="55af4-166">Now let's copy the updated application package to the Service Fabric ImageStore (where the application packages are stored by Service Fabric).</span></span> <span data-ttu-id="55af4-167">El parámetro *ApplicationPackagePathInImageStore* informa a Service Fabric sobre dónde puede encontrar el paquete de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="55af4-167">The parameter *ApplicationPackagePathInImageStore* informs Service Fabric where it can find the application package.</span></span> <span data-ttu-id="55af4-168">Hemos colocado la aplicación actualizada en "VisualObjects\_V2" con el siguiente comando (puede que tenga que modificar rutas de acceso de nuevo de manera adecuada).</span><span class="sxs-lookup"><span data-stu-id="55af4-168">We have put the updated application in "VisualObjects\_V2" with the following command (you may need to modify paths again appropriately).</span></span>

```powershell
Copy-ServiceFabricApplicationPackage  -ApplicationPackagePath .\Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug\Package
-ImageStoreConnectionString fabric:ImageStore   -ApplicationPackagePathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="55af4-169">El siguiente paso es registrar esta aplicación con Service Fabric, que se puede realizar con el comando [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="55af4-169">The next step is to register this application with Service Fabric, which can be performed using the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) command:</span></span>

```powershell
Register-ServiceFabricApplicationType -ApplicationPathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="55af4-170">Si el comando anterior no es correcto, es probable que necesite una recompilación de todos los servicios.</span><span class="sxs-lookup"><span data-stu-id="55af4-170">If the preceding command doesn't succeed, it is likely that you need a rebuild of all services.</span></span> <span data-ttu-id="55af4-171">Como se mencionó en el Paso 2, puede que tenga que actualizar además la versión de WebService.</span><span class="sxs-lookup"><span data-stu-id="55af4-171">As mentioned in Step 2, you may have to update your WebService version as well.</span></span>

## <a name="step-5-start-the-application-upgrade"></a><span data-ttu-id="55af4-172">Paso 5: Iniciar la actualización de la aplicación</span><span class="sxs-lookup"><span data-stu-id="55af4-172">Step 5: Start the application upgrade</span></span>
<span data-ttu-id="55af4-173">Ahora ya se puede iniciar la actualización de la aplicación con el comando [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="55af4-173">Now, we're all set to start the application upgrade by using the [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) command:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/VisualObjects -ApplicationTypeVersion 2.0.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000   -FailureAction Rollback -Monitored
```


<span data-ttu-id="55af4-174">Tenga en cuenta que el nombre de aplicación es el mismo que se ha descrito en el archivo *ApplicationManifest.xml* .</span><span class="sxs-lookup"><span data-stu-id="55af4-174">The application name is the same as it was described in the *ApplicationManifest.xml* file.</span></span> <span data-ttu-id="55af4-175">Service Fabric usa este nombre para identificar qué aplicación se está actualizando.</span><span class="sxs-lookup"><span data-stu-id="55af4-175">Service Fabric uses this name to identify which application is getting upgraded.</span></span> <span data-ttu-id="55af4-176">Si establece los tiempos de expiración para que sean demasiado breves, puede que reciba un mensaje de error que indique el problema.</span><span class="sxs-lookup"><span data-stu-id="55af4-176">If you set the time-outs to be too short, you may encounter a failure message that states the problem.</span></span> <span data-ttu-id="55af4-177">Consulte la sección de solución de problemas o aumente los tiempos de expiración.</span><span class="sxs-lookup"><span data-stu-id="55af4-177">Refer to the troubleshooting section, or increase the time-outs.</span></span>

<span data-ttu-id="55af4-178">Ahora, a medida que continúa la actualización de la aplicación, puede supervisarla mediante Service Fabric Explorer o con el comando de PowerShell [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="55af4-178">Now, as the application upgrade proceeds, you can monitor it using Service Fabric Explorer, or by using the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) PowerShell command:</span></span> 

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/VisualObjects
```

<span data-ttu-id="55af4-179">En unos minutos, el estado obtenido con el comando de PowerShell anterior debe indicar que todos los dominios de actualización se han actualizado (completados).</span><span class="sxs-lookup"><span data-stu-id="55af4-179">In a few minutes, the status that you got by using the preceding PowerShell command, should state that all update domains were upgraded (completed).</span></span> <span data-ttu-id="55af4-180">Y debería advertir que los objetos visuales de la ventana del explorador ahora han empezado a girar.</span><span class="sxs-lookup"><span data-stu-id="55af4-180">And you should find that the visual objects in your browser window have started rotating!</span></span>

<span data-ttu-id="55af4-181">Como ejercicio, puede intentar actualizar de la versión 2 a la versión 3 o de la versión 2 a la versión 1.</span><span class="sxs-lookup"><span data-stu-id="55af4-181">You can try upgrading from version 2 to version 3, or from version 2 to version 1 as an exercise.</span></span> <span data-ttu-id="55af4-182">El cambio de la versión 2 a la versión 1 también se considera una actualización.</span><span class="sxs-lookup"><span data-stu-id="55af4-182">Moving from version 2 to version 1 is also considered an upgrade.</span></span> <span data-ttu-id="55af4-183">Juegue con los tiempos de espera y las directivas de mantenimiento para familiarizarse.</span><span class="sxs-lookup"><span data-stu-id="55af4-183">Play with time-outs and health policies to make yourself familiar with them.</span></span> <span data-ttu-id="55af4-184">Cuando se va a implementar en un clúster de Azure, los parámetros se deben establecer de forma adecuada.</span><span class="sxs-lookup"><span data-stu-id="55af4-184">When you are deploying to an Azure cluster, the parameters need to be set appropriately.</span></span> <span data-ttu-id="55af4-185">Es una buena idea establecer los tiempos de espera de manera conservadora.</span><span class="sxs-lookup"><span data-stu-id="55af4-185">It is good to set the time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="55af4-186">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="55af4-186">Next steps</span></span>
<span data-ttu-id="55af4-187">[Actualización de la aplicación con Visual Studio](service-fabric-application-upgrade-tutorial.md) ofrece información para actualizar una aplicación mediante Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="55af4-187">[Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="55af4-188">Puede controlar cómo se actualiza una aplicación usando [parámetros de actualización](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-188">Control how your application upgrades by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="55af4-189">Consiga que sus actualizaciones de aplicaciones sean compatibles aprendiendo a usar la [serialización de datos](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-189">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="55af4-190">Aprenda a usar funcionalidades avanzadas para actualizar una aplicación. Para ello, consulte los [temas avanzados](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-190">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="55af4-191">Solucione problemas habituales en las actualizaciones de aplicaciones consultando los pasos que figuran en [Solución de problemas de las actualizaciones de aplicaciones](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="55af4-191">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

