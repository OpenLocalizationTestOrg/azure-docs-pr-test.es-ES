---
title: "Configuración de microservicios de Azure confiables | Microsoft Docs"
description: "Obtenga información sobre cómo configurar Reliable Services con estado en Service Fabric."
services: Service-Fabric
documentationcenter: .net
author: sumukhs
manager: timlt
editor: vturecek
ms.assetid: 9f72373d-31dd-41e3-8504-6e0320a11f0e
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 6/29/2017
ms.author: sumukhs
ms.openlocfilehash: fa77eaf44f4d90d1a78f5de69e36432a53d80ecd
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/03/2017
---
# <a name="configure-stateful-reliable-services"></a><span data-ttu-id="f7aab-103">Configurar Reliable Services con estado</span><span class="sxs-lookup"><span data-stu-id="f7aab-103">Configure stateful reliable services</span></span>
<span data-ttu-id="f7aab-104">Hay dos conjuntos de valores de configuración para los servicios de confianza.</span><span class="sxs-lookup"><span data-stu-id="f7aab-104">There are two sets of configuration settings for reliable services.</span></span> <span data-ttu-id="f7aab-105">Un conjunto es global para todos los servicios de confianza del clúster, mientras que el otro conjunto es específico para un servicio de confianza determinado.</span><span class="sxs-lookup"><span data-stu-id="f7aab-105">One set is global for all reliable services in the cluster while the other set is specific to a particular reliable service.</span></span>

## <a name="global-configuration"></a><span data-ttu-id="f7aab-106">Configuración global</span><span class="sxs-lookup"><span data-stu-id="f7aab-106">Global Configuration</span></span>
<span data-ttu-id="f7aab-107">La configuración global de los servicios de confianza se especifica en el manifiesto de clúster para el clúster de la sección KtlLogger.</span><span class="sxs-lookup"><span data-stu-id="f7aab-107">The global reliable service configuration is specified in the cluster manifest for the cluster under the KtlLogger section.</span></span> <span data-ttu-id="f7aab-108">Permite configurar el tamaño y la ubicación del registro compartido, así como los límites de memoria global que usa el registrador.</span><span class="sxs-lookup"><span data-stu-id="f7aab-108">It allows configuration of the shared log location and size plus the global memory limits used by the logger.</span></span> <span data-ttu-id="f7aab-109">El manifiesto de clúster es un único archivo XML que contiene los valores y las configuraciones que se aplican a todos los nodos y servicios del clúster.</span><span class="sxs-lookup"><span data-stu-id="f7aab-109">The cluster manifest is a single XML file that holds settings and configurations that apply to all nodes and services in the cluster.</span></span> <span data-ttu-id="f7aab-110">El archivo suele llamarse ClusterManifest.xml.</span><span class="sxs-lookup"><span data-stu-id="f7aab-110">The file is typically called ClusterManifest.xml.</span></span> <span data-ttu-id="f7aab-111">Puede ver el manifiesto de clúster para su clúster usando el comando de PowerShell Get-ServiceFabricClusterManifest.</span><span class="sxs-lookup"><span data-stu-id="f7aab-111">You can see the cluster manifest for your cluster using the Get-ServiceFabricClusterManifest powershell command.</span></span>

### <a name="configuration-names"></a><span data-ttu-id="f7aab-112">Nombres de configuración</span><span class="sxs-lookup"><span data-stu-id="f7aab-112">Configuration names</span></span>
| <span data-ttu-id="f7aab-113">Nombre</span><span class="sxs-lookup"><span data-stu-id="f7aab-113">Name</span></span> | <span data-ttu-id="f7aab-114">Unidad</span><span class="sxs-lookup"><span data-stu-id="f7aab-114">Unit</span></span> | <span data-ttu-id="f7aab-115">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="f7aab-115">Default value</span></span> | <span data-ttu-id="f7aab-116">Comentarios</span><span class="sxs-lookup"><span data-stu-id="f7aab-116">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="f7aab-117">WriteBufferMemoryPoolMinimumInKB</span><span class="sxs-lookup"><span data-stu-id="f7aab-117">WriteBufferMemoryPoolMinimumInKB</span></span> |<span data-ttu-id="f7aab-118">Kilobytes</span><span class="sxs-lookup"><span data-stu-id="f7aab-118">Kilobytes</span></span> |<span data-ttu-id="f7aab-119">8388608</span><span class="sxs-lookup"><span data-stu-id="f7aab-119">8388608</span></span> |<span data-ttu-id="f7aab-120">Número mínimo de KB que se van a asignar en modo kernel al grupo de memoria del búfer de escritura del registrador.</span><span class="sxs-lookup"><span data-stu-id="f7aab-120">Minimum number of KB to allocate in kernel mode for the logger write buffer memory pool.</span></span> <span data-ttu-id="f7aab-121">Este grupo de memoria se usa para almacenar en caché la información de estado antes de escribir en el disco.</span><span class="sxs-lookup"><span data-stu-id="f7aab-121">This memory pool is used for caching state information before writing to disk.</span></span> |
| <span data-ttu-id="f7aab-122">WriteBufferMemoryPoolMaximumInKB</span><span class="sxs-lookup"><span data-stu-id="f7aab-122">WriteBufferMemoryPoolMaximumInKB</span></span> |<span data-ttu-id="f7aab-123">Kilobytes</span><span class="sxs-lookup"><span data-stu-id="f7aab-123">Kilobytes</span></span> |<span data-ttu-id="f7aab-124">Ilimitado</span><span class="sxs-lookup"><span data-stu-id="f7aab-124">No Limit</span></span> |<span data-ttu-id="f7aab-125">Tamaño máximo al que puede aumentar el grupo de memoria del búfer de escritura del registrador.</span><span class="sxs-lookup"><span data-stu-id="f7aab-125">Maximum size to which the logger write buffer memory pool can grow.</span></span> |
| <span data-ttu-id="f7aab-126">SharedLogId</span><span class="sxs-lookup"><span data-stu-id="f7aab-126">SharedLogId</span></span> |<span data-ttu-id="f7aab-127">GUID</span><span class="sxs-lookup"><span data-stu-id="f7aab-127">GUID</span></span> |<span data-ttu-id="f7aab-128">""</span><span class="sxs-lookup"><span data-stu-id="f7aab-128">""</span></span> |<span data-ttu-id="f7aab-129">Especifica un GUID único que se usará para identificar el archivo de registro compartido predeterminado que usan todos los servicios de confianza en todos los nodos del clúster que no especifican SharedLogId en su configuración específica del servicio.</span><span class="sxs-lookup"><span data-stu-id="f7aab-129">Specifies a unique GUID to use for identifying the default shared log file used by all reliable services on all nodes in the cluster that do not specify the SharedLogId in their service specific configuration.</span></span> <span data-ttu-id="f7aab-130">Si se especifica SharedLogId, también se debe especificar SharedLogPath.</span><span class="sxs-lookup"><span data-stu-id="f7aab-130">If SharedLogId is specified, then SharedLogPath must also be specified.</span></span> |
| <span data-ttu-id="f7aab-131">SharedLogPath</span><span class="sxs-lookup"><span data-stu-id="f7aab-131">SharedLogPath</span></span> |<span data-ttu-id="f7aab-132">Nombre de ruta de acceso completo</span><span class="sxs-lookup"><span data-stu-id="f7aab-132">Fully qualified path name</span></span> |<span data-ttu-id="f7aab-133">""</span><span class="sxs-lookup"><span data-stu-id="f7aab-133">""</span></span> |<span data-ttu-id="f7aab-134">Especifica la ruta de acceso completa donde se encuentra el archivo de registro compartido que usan todos los servicios de confianza en todos los nodos del clúster que no especifican SharedLogPath en su configuración específica del servicio.</span><span class="sxs-lookup"><span data-stu-id="f7aab-134">Specifies the fully qualified path where the shared log file used by all reliable services on all nodes in the cluster that do not specify the SharedLogPath in their service specific configuration.</span></span> <span data-ttu-id="f7aab-135">Sin embargo, si se especifica SharedLogPath, también se debe especificar SharedLogId.</span><span class="sxs-lookup"><span data-stu-id="f7aab-135">However, if SharedLogPath is specified, then SharedLogId must also be specified.</span></span> |
| <span data-ttu-id="f7aab-136">SharedLogSizeInMB</span><span class="sxs-lookup"><span data-stu-id="f7aab-136">SharedLogSizeInMB</span></span> |<span data-ttu-id="f7aab-137">Megabytes</span><span class="sxs-lookup"><span data-stu-id="f7aab-137">Megabytes</span></span> |<span data-ttu-id="f7aab-138">8192</span><span class="sxs-lookup"><span data-stu-id="f7aab-138">8192</span></span> |<span data-ttu-id="f7aab-139">Especifica el número de MB de espacio en disco que se va a asignar estáticamente para el registro compartido.</span><span class="sxs-lookup"><span data-stu-id="f7aab-139">Specifies the number of MB of disk space to statically allocate for the shared log.</span></span> <span data-ttu-id="f7aab-140">El valor deber ser 2048 o superior.</span><span class="sxs-lookup"><span data-stu-id="f7aab-140">The value must be 2048 or larger.</span></span> |

<span data-ttu-id="f7aab-141">En una plantilla de JSON o Azure ARM local, el ejemplo siguiente muestra cómo cambiar el registro de transacciones compartido que se crea para realizar copias de cualquier colección confiable de servicios con estado.</span><span class="sxs-lookup"><span data-stu-id="f7aab-141">In Azure ARM or on-premises JSON template, the example below shows how to change the the shared transaction log that gets created to back any reliable collections for stateful services.</span></span>

    "fabricSettings": [{
        "name": "KtlLogger",
        "parameters": [{
            "name": "SharedLogSizeInMB",
            "value": "4096"
        }]
    }]

### <a name="sample-local-developer-cluster-manifest-section"></a><span data-ttu-id="f7aab-142">Sección de manifiesto de clúster del desarrollador local de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7aab-142">Sample local developer cluster manifest section</span></span>
<span data-ttu-id="f7aab-143">Si desea cambiar este valor en su entorno de desarrollo local, debe editar el archivo clustermanifest.xml local.</span><span class="sxs-lookup"><span data-stu-id="f7aab-143">If you want to change this on your local development environment, you need to edit the local clustermanifest.xml file.</span></span>

```xml
   <Section Name="KtlLogger">
     <Parameter Name="SharedLogSizeInMB" Value="4096"/>
     <Parameter Name="WriteBufferMemoryPoolMinimumInKB" Value="8192" />
     <Parameter Name="WriteBufferMemoryPoolMaximumInKB" Value="8192" />
     <Parameter Name="SharedLogId" Value="{7668BB54-FE9C-48ed-81AC-FF89E60ED2EF}"/>
     <Parameter Name="SharedLogPath" Value="f:\SharedLog.Log"/>
   </Section>
```

### <a name="remarks"></a><span data-ttu-id="f7aab-144">Comentarios</span><span class="sxs-lookup"><span data-stu-id="f7aab-144">Remarks</span></span>
<span data-ttu-id="f7aab-145">El registrador tiene un grupo global de memoria asignado desde la memoria del kernel no paginada que está disponible para todos los servicios de confianza en un nodo para almacenar en caché los datos de estado antes de que se escriban en el registro específico asociado con la réplica del servicio de confianza.</span><span class="sxs-lookup"><span data-stu-id="f7aab-145">The logger has a global pool of memory allocated from non paged kernel memory that is available to all reliable services on a node for caching state data before being written to the dedicated log associated with the reliable service replica.</span></span> <span data-ttu-id="f7aab-146">El tamaño del grupo se controla mediante las opciones WriteBufferMemoryPoolMinimumInKB y WriteBufferMemoryPoolMaximumInKB.</span><span class="sxs-lookup"><span data-stu-id="f7aab-146">The pool size is controlled by the WriteBufferMemoryPoolMinimumInKB and WriteBufferMemoryPoolMaximumInKB settings.</span></span> <span data-ttu-id="f7aab-147">WriteBufferMemoryPoolMinimumInKB especifica el tamaño inicial de este grupo de memoria y el tamaño mínimo al que se puede reducir el grupo de memoria.</span><span class="sxs-lookup"><span data-stu-id="f7aab-147">WriteBufferMemoryPoolMinimumInKB specifies both the initial size of this memory pool and the lowest size to which the memory pool may shrink.</span></span> <span data-ttu-id="f7aab-148">WriteBufferMemoryPoolMaximumInKB es el tamaño máximo que puede alcanzar el grupo de memoria.</span><span class="sxs-lookup"><span data-stu-id="f7aab-148">WriteBufferMemoryPoolMaximumInKB is the highest size to which the memory pool may grow.</span></span> <span data-ttu-id="f7aab-149">Cada réplica de un servicio de confianza que está abierta puede aumentar el tamaño del grupo de memoria en una cantidad que determina el sistema hasta WriteBufferMemoryPoolMaximumInKB.</span><span class="sxs-lookup"><span data-stu-id="f7aab-149">Each reliable service replica that is opened may increase the size of the memory pool by a system determined amount up to WriteBufferMemoryPoolMaximumInKB.</span></span> <span data-ttu-id="f7aab-150">Si el grupo de memoria demanda más memoria de la que hay disponible, las solicitudes de memoria se retrasarán hasta que haya memoria disponible.</span><span class="sxs-lookup"><span data-stu-id="f7aab-150">If there is more demand for memory from the memory pool than is available, requests for memory will be delayed until memory is available.</span></span> <span data-ttu-id="f7aab-151">Por lo tanto, si el grupo de memoria del búfer de escritura es demasiado pequeño para una configuración concreta, el rendimiento se puede ver afectado.</span><span class="sxs-lookup"><span data-stu-id="f7aab-151">Therefore if the write buffer memory pool is too small for a particular configuration then performance may suffer.</span></span>

<span data-ttu-id="f7aab-152">Los parámetros SharedLogId y SharedLogPath siempre se usan juntos para definir el GUID y la ubicación del registro compartido predeterminado de todos los nodos del clúster.</span><span class="sxs-lookup"><span data-stu-id="f7aab-152">The SharedLogId and SharedLogPath settings are always used together to define the GUID and location for the default shared log for all nodes in the cluster.</span></span> <span data-ttu-id="f7aab-153">El registro compartido predeterminado se usa para todos los servicios de confianza que no especifican los valores de configuración en el archivo settings.xml para el servicio específico.</span><span class="sxs-lookup"><span data-stu-id="f7aab-153">The default shared log is used for all reliable services that do not specify the settings in the settings.xml for the specific service.</span></span> <span data-ttu-id="f7aab-154">Para obtener un mejor rendimiento, los archivos de registro compartidos deben colocarse en discos que se usen únicamente para el archivo de registro compartido, de modo que se reduzca la contención.</span><span class="sxs-lookup"><span data-stu-id="f7aab-154">For best performance, shared log files should be placed on disks that are used solely for the shared log file to reduce contention.</span></span>

<span data-ttu-id="f7aab-155">SharedLogSizeInMB especifica la cantidad de espacio en disco que se va a preasignar para el registro compartido predeterminado en todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="f7aab-155">SharedLogSizeInMB specifies the amount of disk space to preallocate for the default shared log on all nodes.</span></span>  <span data-ttu-id="f7aab-156">No es necesario especificar SharedLogId y SharedLogPath para poder especificar SharedLogSizeInMB.</span><span class="sxs-lookup"><span data-stu-id="f7aab-156">SharedLogId and SharedLogPath do not need to be specified in order for SharedLogSizeInMB to be specified.</span></span>

## <a name="service-specific-configuration"></a><span data-ttu-id="f7aab-157">Configuración específica por servicio</span><span class="sxs-lookup"><span data-stu-id="f7aab-157">Service Specific Configuration</span></span>
<span data-ttu-id="f7aab-158">Puede modificar la configuración predeterminada de Reliable Services con estado mediante el paquete de configuración (Config) o la implementación del servicio (código).</span><span class="sxs-lookup"><span data-stu-id="f7aab-158">You can modify stateful Reliable Services' default configurations by using the configuration package (Config) or the service implementation (code).</span></span>

* <span data-ttu-id="f7aab-159">**Config** : la configuración mediante el paquete de configuración se realiza cambiando el archivo Settings.xml generado en la raíz del paquete de Visual Studio, en la carpeta Config de cada servicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7aab-159">**Config** - Configuration via the config package is accomplished by changing the Settings.xml file that is generated in the Microsoft Visual Studio package root under the Config folder for each service in the application.</span></span>
* <span data-ttu-id="f7aab-160">**Código** : la configuración a través del código se consigue creando una clase ReliableStateManager con un objeto ReliableStateManagerConfiguration con el conjunto de opciones adecuado.</span><span class="sxs-lookup"><span data-stu-id="f7aab-160">**Code**   - Configuration via code is accomplished by creating a ReliableStateManager using a  ReliableStateManagerConfiguration object with the appropriate options set.</span></span>

<span data-ttu-id="f7aab-161">De forma predeterminada, el tiempo de ejecución de Azure Service Fabric busca los nombres de sección predefinidos en el archivo Settings.xml y usa los valores de configuración mientras crea los componentes en tiempo de ejecución subyacentes.</span><span class="sxs-lookup"><span data-stu-id="f7aab-161">By default, the Azure Service Fabric runtime looks for predefined section names in the Settings.xml file and consumes the configuration values while creating the underlying runtime components.</span></span>

> [!NOTE]
> <span data-ttu-id="f7aab-162">**No** elimine los nombres de sección de las siguientes configuraciones en el archivo Settings.xml que se genera en la solución de Visual Studio a menos que planee configurar el servicio mediante código.</span><span class="sxs-lookup"><span data-stu-id="f7aab-162">Do **not** delete the section names of the following configurations in the Settings.xml file that is generated in the Visual Studio solution unless you plan to configure your service via code.</span></span>
> <span data-ttu-id="f7aab-163">Cambiar los nombres del paquete de configuración o la sección requiere un cambio de código al configurar ReliableStateManager.</span><span class="sxs-lookup"><span data-stu-id="f7aab-163">Renaming the config package or section names will require a code change when configuring the ReliableStateManager.</span></span>
> 
> 

### <a name="replicator-security-configuration"></a><span data-ttu-id="f7aab-164">Configuración de seguridad del replicador</span><span class="sxs-lookup"><span data-stu-id="f7aab-164">Replicator security configuration</span></span>
<span data-ttu-id="f7aab-165">Las configuraciones de seguridad del replicador se usan para proteger el canal de comunicación que se usa durante la replicación.</span><span class="sxs-lookup"><span data-stu-id="f7aab-165">Replicator security configurations are used to secure the communication channel that is used during replication.</span></span> <span data-ttu-id="f7aab-166">Esto significa que los servicios no podrán ver el tráfico de replicación del otro, lo que garantiza que los datos de alta disponibilidad también están seguros.</span><span class="sxs-lookup"><span data-stu-id="f7aab-166">This means that services will not be able to see each other's replication traffic, ensuring that the data that is made highly available is also secure.</span></span> <span data-ttu-id="f7aab-167">De forma predeterminada, una sección de configuración de seguridad vacía impide la seguridad de la replicación.</span><span class="sxs-lookup"><span data-stu-id="f7aab-167">By default, an empty security configuration section prevents replication security.</span></span>

### <a name="default-section-name"></a><span data-ttu-id="f7aab-168">Nombre de sección predeterminado</span><span class="sxs-lookup"><span data-stu-id="f7aab-168">Default section name</span></span>
<span data-ttu-id="f7aab-169">ReplicatorSecurityConfig</span><span class="sxs-lookup"><span data-stu-id="f7aab-169">ReplicatorSecurityConfig</span></span>

> [!NOTE]
> <span data-ttu-id="f7aab-170">Para cambiar este nombre de sección, reemplace el parámetro replicatorSecuritySectionName por el constructor ReliableStateManagerConfiguration al crear el ReliableStateManager para este servicio.</span><span class="sxs-lookup"><span data-stu-id="f7aab-170">To change this section name, override the replicatorSecuritySectionName parameter to the ReliableStateManagerConfiguration constructor when creating the ReliableStateManager for this service.</span></span>
> 
> 

### <a name="replicator-configuration"></a><span data-ttu-id="f7aab-171">Configuración de replicador</span><span class="sxs-lookup"><span data-stu-id="f7aab-171">Replicator configuration</span></span>
<span data-ttu-id="f7aab-172">Las configuraciones de replicador configuran el replicador responsable de hacer que el estado de Reliable Service con estado sea muy confiable replicando y conservando el estado localmente.</span><span class="sxs-lookup"><span data-stu-id="f7aab-172">Replicator configurations configure the replicator that is responsible for making the stateful Reliable Service's state highly reliable by replicating and persisting the state locally.</span></span>
<span data-ttu-id="f7aab-173">La configuración predeterminada es generada por la plantilla de Visual Studio y debe ser suficiente.</span><span class="sxs-lookup"><span data-stu-id="f7aab-173">The default configuration is generated by the Visual Studio template and should suffice.</span></span> <span data-ttu-id="f7aab-174">En esta sección se habla sobre las configuraciones adicionales que están disponibles para optimizar el replicador.</span><span class="sxs-lookup"><span data-stu-id="f7aab-174">This section talks about additional configurations that are available to tune the replicator.</span></span>

### <a name="default-section-name"></a><span data-ttu-id="f7aab-175">Nombre de sección predeterminado</span><span class="sxs-lookup"><span data-stu-id="f7aab-175">Default section name</span></span>
<span data-ttu-id="f7aab-176">ReplicatorConfig</span><span class="sxs-lookup"><span data-stu-id="f7aab-176">ReplicatorConfig</span></span>

> [!NOTE]
> <span data-ttu-id="f7aab-177">Para cambiar este nombre de sección, reemplace el parámetro replicatorSettingsSectionName por el constructor ReliableStateManagerConfiguration al crear el ReliableStateManager para este servicio.</span><span class="sxs-lookup"><span data-stu-id="f7aab-177">To change this section name, override the replicatorSettingsSectionName parameter to the ReliableStateManagerConfiguration constructor when creating the ReliableStateManager for this service.</span></span>
> 
> 

### <a name="configuration-names"></a><span data-ttu-id="f7aab-178">Nombres de configuración</span><span class="sxs-lookup"><span data-stu-id="f7aab-178">Configuration names</span></span>
| <span data-ttu-id="f7aab-179">Nombre</span><span class="sxs-lookup"><span data-stu-id="f7aab-179">Name</span></span> | <span data-ttu-id="f7aab-180">Unidad</span><span class="sxs-lookup"><span data-stu-id="f7aab-180">Unit</span></span> | <span data-ttu-id="f7aab-181">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="f7aab-181">Default value</span></span> | <span data-ttu-id="f7aab-182">Comentarios</span><span class="sxs-lookup"><span data-stu-id="f7aab-182">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="f7aab-183">BatchAcknowledgementInterval</span><span class="sxs-lookup"><span data-stu-id="f7aab-183">BatchAcknowledgementInterval</span></span> |<span data-ttu-id="f7aab-184">Segundos</span><span class="sxs-lookup"><span data-stu-id="f7aab-184">Seconds</span></span> |<span data-ttu-id="f7aab-185">0.015</span><span class="sxs-lookup"><span data-stu-id="f7aab-185">0.015</span></span> |<span data-ttu-id="f7aab-186">Período de tiempo durante el que el replicador del secundario espera después de recibir una operación antes de enviar una confirmación al principal.</span><span class="sxs-lookup"><span data-stu-id="f7aab-186">Time period for which the replicator at the secondary waits after receiving an operation before sending back an acknowledgement to the primary.</span></span> <span data-ttu-id="f7aab-187">El resto de confirmaciones que se enviarán para las operaciones que se procesan dentro de este intervalo se envían como una respuesta.</span><span class="sxs-lookup"><span data-stu-id="f7aab-187">Any other acknowledgements to be sent for operations processed within this interval are sent as one response.</span></span> |
| <span data-ttu-id="f7aab-188">ReplicatorEndpoint</span><span class="sxs-lookup"><span data-stu-id="f7aab-188">ReplicatorEndpoint</span></span> |<span data-ttu-id="f7aab-189">N/D</span><span class="sxs-lookup"><span data-stu-id="f7aab-189">N/A</span></span> |<span data-ttu-id="f7aab-190">Ningún valor predeterminado: parámetro obligatorio</span><span class="sxs-lookup"><span data-stu-id="f7aab-190">No default--required parameter</span></span> |<span data-ttu-id="f7aab-191">Dirección IP y puerto que usará el replicador principal y secundario para comunicarse con otros replicadores del conjunto de réplicas.</span><span class="sxs-lookup"><span data-stu-id="f7aab-191">IP address and port that the primary/secondary replicator will use to communicate with other replicators in the replica set.</span></span> <span data-ttu-id="f7aab-192">Esto debe hacer referencia a un punto de conexión de recursos de TCP en el manifiesto de servicio.</span><span class="sxs-lookup"><span data-stu-id="f7aab-192">This should reference a TCP resource endpoint in the service manifest.</span></span> <span data-ttu-id="f7aab-193">Consulte [Especificación de los recursos en un manifiesto de servicio](service-fabric-service-manifest-resources.md) para obtener más información sobre cómo definir los recursos de punto de conexión en un manifiesto de servicio.</span><span class="sxs-lookup"><span data-stu-id="f7aab-193">Refer to [Service manifest resources](service-fabric-service-manifest-resources.md) to read more about defining endpoint resources in a service manifest.</span></span> |
| <span data-ttu-id="f7aab-194">MaxPrimaryReplicationQueueSize</span><span class="sxs-lookup"><span data-stu-id="f7aab-194">MaxPrimaryReplicationQueueSize</span></span> |<span data-ttu-id="f7aab-195">Número de operaciones</span><span class="sxs-lookup"><span data-stu-id="f7aab-195">Number of operations</span></span> |<span data-ttu-id="f7aab-196">8192</span><span class="sxs-lookup"><span data-stu-id="f7aab-196">8192</span></span> |<span data-ttu-id="f7aab-197">Número máximo de operaciones de la cola principal.</span><span class="sxs-lookup"><span data-stu-id="f7aab-197">Maximum number of operations in the primary queue.</span></span> <span data-ttu-id="f7aab-198">Una operación se libera después de que el replicador principal reciba una confirmación de todos los replicadores secundarios.</span><span class="sxs-lookup"><span data-stu-id="f7aab-198">An operation is freed up after the primary replicator receives an acknowledgement from all the secondary replicators.</span></span> <span data-ttu-id="f7aab-199">Este valor debe ser mayor que 64 y una potencia de 2.</span><span class="sxs-lookup"><span data-stu-id="f7aab-199">This value must be greater than 64 and a power of 2.</span></span> |
| <span data-ttu-id="f7aab-200">MaxSecondaryReplicationQueueSize</span><span class="sxs-lookup"><span data-stu-id="f7aab-200">MaxSecondaryReplicationQueueSize</span></span> |<span data-ttu-id="f7aab-201">Número de operaciones</span><span class="sxs-lookup"><span data-stu-id="f7aab-201">Number of operations</span></span> |<span data-ttu-id="f7aab-202">16384</span><span class="sxs-lookup"><span data-stu-id="f7aab-202">16384</span></span> |<span data-ttu-id="f7aab-203">Número máximo de operaciones de la cola secundaria.</span><span class="sxs-lookup"><span data-stu-id="f7aab-203">Maximum number of operations in the secondary queue.</span></span> <span data-ttu-id="f7aab-204">Una operación se libera después de que su estado pase a ser de alta disponibilidad mediante persistencia.</span><span class="sxs-lookup"><span data-stu-id="f7aab-204">An operation is freed up after making its state highly available through persistence.</span></span> <span data-ttu-id="f7aab-205">Este valor debe ser mayor que 64 y una potencia de 2.</span><span class="sxs-lookup"><span data-stu-id="f7aab-205">This value must be greater than 64 and a power of 2.</span></span> |
| <span data-ttu-id="f7aab-206">CheckpointThresholdInMB</span><span class="sxs-lookup"><span data-stu-id="f7aab-206">CheckpointThresholdInMB</span></span> |<span data-ttu-id="f7aab-207">MB</span><span class="sxs-lookup"><span data-stu-id="f7aab-207">MB</span></span> |<span data-ttu-id="f7aab-208">50</span><span class="sxs-lookup"><span data-stu-id="f7aab-208">50</span></span> |<span data-ttu-id="f7aab-209">Cantidad del espacio del archivo de registro después de que se compruebe el estado.</span><span class="sxs-lookup"><span data-stu-id="f7aab-209">Amount of log file space after which the state is checkpointed.</span></span> |
| <span data-ttu-id="f7aab-210">MaxRecordSizeInKB</span><span class="sxs-lookup"><span data-stu-id="f7aab-210">MaxRecordSizeInKB</span></span> |<span data-ttu-id="f7aab-211">KB</span><span class="sxs-lookup"><span data-stu-id="f7aab-211">KB</span></span> |<span data-ttu-id="f7aab-212">1024</span><span class="sxs-lookup"><span data-stu-id="f7aab-212">1024</span></span> |<span data-ttu-id="f7aab-213">Tamaño del registro de mayor tamaño el replicador que puede escribir en el registro.</span><span class="sxs-lookup"><span data-stu-id="f7aab-213">Largest record size that the replicator may write in the log.</span></span> <span data-ttu-id="f7aab-214">Este valor debe ser un múltiplo de 4 y superior a 16.</span><span class="sxs-lookup"><span data-stu-id="f7aab-214">This value must be a multiple of 4 and greater than 16.</span></span> |
| <span data-ttu-id="f7aab-215">MinLogSizeInMB</span><span class="sxs-lookup"><span data-stu-id="f7aab-215">MinLogSizeInMB</span></span> |<span data-ttu-id="f7aab-216">MB</span><span class="sxs-lookup"><span data-stu-id="f7aab-216">MB</span></span> |<span data-ttu-id="f7aab-217">0 (sistema determinado)</span><span class="sxs-lookup"><span data-stu-id="f7aab-217">0 (system determined)</span></span> |<span data-ttu-id="f7aab-218">Tamaño mínimo del registro transaccional.</span><span class="sxs-lookup"><span data-stu-id="f7aab-218">Minimum size of the transactional log.</span></span> <span data-ttu-id="f7aab-219">El registro no podrá truncarse a un tamaño inferior a este valor.</span><span class="sxs-lookup"><span data-stu-id="f7aab-219">The log will not be allowed to truncate to a size below this setting.</span></span> <span data-ttu-id="f7aab-220">0 indica que el replicador determinará el tamaño mínimo del registro.</span><span class="sxs-lookup"><span data-stu-id="f7aab-220">0 indicates that the replicator will determine the minimum log size.</span></span> <span data-ttu-id="f7aab-221">Al aumentar este valor, incrementa la posibilidad de hacer copias parciales y copias de seguridad incrementales, ya que se reducen las posibilidades de que se trunquen registros pertinentes.</span><span class="sxs-lookup"><span data-stu-id="f7aab-221">Increasing this value increases the possibility of doing partial copies and incremental backups since chances of relevant log records being truncated is lowered.</span></span> |
| <span data-ttu-id="f7aab-222">TruncationThresholdFactor</span><span class="sxs-lookup"><span data-stu-id="f7aab-222">TruncationThresholdFactor</span></span> |<span data-ttu-id="f7aab-223">Factor</span><span class="sxs-lookup"><span data-stu-id="f7aab-223">Factor</span></span> |<span data-ttu-id="f7aab-224">2</span><span class="sxs-lookup"><span data-stu-id="f7aab-224">2</span></span> |<span data-ttu-id="f7aab-225">Determina a qué tamaño del registro se activará el truncamiento.</span><span class="sxs-lookup"><span data-stu-id="f7aab-225">Determines at what size of the log, truncation will be triggered.</span></span> <span data-ttu-id="f7aab-226">El umbral de truncamiento se determina multiplicando el valor de MinLogSizeInMB por TruncationThresholdFactor.</span><span class="sxs-lookup"><span data-stu-id="f7aab-226">Truncation threshold is determined by MinLogSizeInMB multiplied by TruncationThresholdFactor.</span></span> <span data-ttu-id="f7aab-227">El valor de TruncationThresholdFactor debe ser mayor que 1.</span><span class="sxs-lookup"><span data-stu-id="f7aab-227">TruncationThresholdFactor must be greater than 1.</span></span> <span data-ttu-id="f7aab-228">El valor de MinLogSizeInMB * TruncationThresholdFactor debe ser menor que MaxStreamSizeInMB.</span><span class="sxs-lookup"><span data-stu-id="f7aab-228">MinLogSizeInMB * TruncationThresholdFactor must be less than MaxStreamSizeInMB.</span></span> |
| <span data-ttu-id="f7aab-229">ThrottlingThresholdFactor</span><span class="sxs-lookup"><span data-stu-id="f7aab-229">ThrottlingThresholdFactor</span></span> |<span data-ttu-id="f7aab-230">Factor</span><span class="sxs-lookup"><span data-stu-id="f7aab-230">Factor</span></span> |<span data-ttu-id="f7aab-231">4</span><span class="sxs-lookup"><span data-stu-id="f7aab-231">4</span></span> |<span data-ttu-id="f7aab-232">Determina a qué tamaño del registro se empezará a limitar la réplica.</span><span class="sxs-lookup"><span data-stu-id="f7aab-232">Determines at what size of the log, the replica will start being throttled.</span></span> <span data-ttu-id="f7aab-233">El umbral de limitación (en MB) se determina mediante Max((MinLogSizeInMB ThrottlingThresholdFactor),(CheckpointThresholdInMB ThrottlingThresholdFactor)).</span><span class="sxs-lookup"><span data-stu-id="f7aab-233">Throttling threshold (in MB) is determined by Max((MinLogSizeInMB * ThrottlingThresholdFactor),(CheckpointThresholdInMB * ThrottlingThresholdFactor)).</span></span> <span data-ttu-id="f7aab-234">El valor del umbral de limitación (en MB) debe ser mayor que el de truncamiento (en MB).</span><span class="sxs-lookup"><span data-stu-id="f7aab-234">Throttling threshold (in MB) must be greater than truncation threshold (in MB).</span></span> <span data-ttu-id="f7aab-235">El valor del umbral de truncamiento (en MB) debe ser menor que el de MaxStreamSizeInMB.</span><span class="sxs-lookup"><span data-stu-id="f7aab-235">Truncation threshold (in MB) must be less than MaxStreamSizeInMB.</span></span> |
| <span data-ttu-id="f7aab-236">MaxAccumulatedBackupLogSizeInMB</span><span class="sxs-lookup"><span data-stu-id="f7aab-236">MaxAccumulatedBackupLogSizeInMB</span></span> |<span data-ttu-id="f7aab-237">MB</span><span class="sxs-lookup"><span data-stu-id="f7aab-237">MB</span></span> |<span data-ttu-id="f7aab-238">800</span><span class="sxs-lookup"><span data-stu-id="f7aab-238">800</span></span> |<span data-ttu-id="f7aab-239">El tamaño máximo acumulado (en MB) de los registros de copia de seguridad de una cadena de registros de copia de seguridad determinada.</span><span class="sxs-lookup"><span data-stu-id="f7aab-239">Max accumulated size (in MB) of backup logs in a given backup log chain.</span></span> <span data-ttu-id="f7aab-240">Las solicitudes de copia de seguridad incremental no se realizarán correctamente si esta genera un registro de copia de seguridad que provoque la acumulación de este tipo de elemento, ya que la copia de seguridad completa tendrá un tamaño superior.</span><span class="sxs-lookup"><span data-stu-id="f7aab-240">An incremental backup requests will fail if the incremental backup would generate a backup log that would cause the accumulated backup logs since the relevant full backup to be larger than this size.</span></span> <span data-ttu-id="f7aab-241">En tales casos, el usuario tiene que realizar una copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="f7aab-241">In such cases, user is required to take a full backup.</span></span> |
| <span data-ttu-id="f7aab-242">SharedLogId</span><span class="sxs-lookup"><span data-stu-id="f7aab-242">SharedLogId</span></span> |<span data-ttu-id="f7aab-243">GUID</span><span class="sxs-lookup"><span data-stu-id="f7aab-243">GUID</span></span> |<span data-ttu-id="f7aab-244">""</span><span class="sxs-lookup"><span data-stu-id="f7aab-244">""</span></span> |<span data-ttu-id="f7aab-245">Especifica un GUID único que debe usarse para identificar el archivo de registro compartido que se usa con esta réplica.</span><span class="sxs-lookup"><span data-stu-id="f7aab-245">Specifies a unique GUID to use for identifying the shared log file used with this replica.</span></span> <span data-ttu-id="f7aab-246">Normalmente, los servicios no deben usar esta opción de configuración.</span><span class="sxs-lookup"><span data-stu-id="f7aab-246">Typically, services should not use this setting.</span></span> <span data-ttu-id="f7aab-247">Sin embargo, si se especifica SharedLogId, también se debe especificar SharedLogPath.</span><span class="sxs-lookup"><span data-stu-id="f7aab-247">However, if SharedLogId is specified, then SharedLogPath must also be specified.</span></span> |
| <span data-ttu-id="f7aab-248">SharedLogPath</span><span class="sxs-lookup"><span data-stu-id="f7aab-248">SharedLogPath</span></span> |<span data-ttu-id="f7aab-249">Nombre de ruta de acceso completo</span><span class="sxs-lookup"><span data-stu-id="f7aab-249">Fully qualified path name</span></span> |<span data-ttu-id="f7aab-250">""</span><span class="sxs-lookup"><span data-stu-id="f7aab-250">""</span></span> |<span data-ttu-id="f7aab-251">Especifica la ruta de acceso completa donde se creará el archivo de registro compartido para esta réplica.</span><span class="sxs-lookup"><span data-stu-id="f7aab-251">Specifies the fully qualified path where the shared log file for this replica will be created.</span></span> <span data-ttu-id="f7aab-252">Normalmente, los servicios no deben usar esta opción de configuración.</span><span class="sxs-lookup"><span data-stu-id="f7aab-252">Typically, services should not use this setting.</span></span> <span data-ttu-id="f7aab-253">Sin embargo, si se especifica SharedLogPath, también se debe especificar SharedLogId.</span><span class="sxs-lookup"><span data-stu-id="f7aab-253">However, if SharedLogPath is specified, then SharedLogId must also be specified.</span></span> |
| <span data-ttu-id="f7aab-254">SlowApiMonitoringDuration</span><span class="sxs-lookup"><span data-stu-id="f7aab-254">SlowApiMonitoringDuration</span></span> |<span data-ttu-id="f7aab-255">Segundos</span><span class="sxs-lookup"><span data-stu-id="f7aab-255">Seconds</span></span> |<span data-ttu-id="f7aab-256">300</span><span class="sxs-lookup"><span data-stu-id="f7aab-256">300</span></span> |<span data-ttu-id="f7aab-257">Establece el intervalo de supervisión para las llamadas API administradas.</span><span class="sxs-lookup"><span data-stu-id="f7aab-257">Sets the monitoring interval for managed API calls.</span></span> <span data-ttu-id="f7aab-258">Ejemplo: función de devolución de llamada de copia de seguridad proporcionada por el usuario.</span><span class="sxs-lookup"><span data-stu-id="f7aab-258">Example: user provided backup callback function.</span></span> <span data-ttu-id="f7aab-259">Una vez transcurrido el intervalo, se enviará un informe de mantenimiento de advertencias a Health Manager.</span><span class="sxs-lookup"><span data-stu-id="f7aab-259">After the interval has passed, a warning health report will be sent to the Health Manager.</span></span> |

### <a name="sample-configuration-via-code"></a><span data-ttu-id="f7aab-260">Ejemplo de configuración mediante código</span><span class="sxs-lookup"><span data-stu-id="f7aab-260">Sample configuration via code</span></span>
```csharp
class Program
{
    /// <summary>
    /// This is the entry point of the service host process.
    /// </summary>
    static void Main()
    {
        ServiceRuntime.RegisterServiceAsync("HelloWorldStatefulType",
            context => new HelloWorldStateful(context, 
                new ReliableStateManager(context, 
        new ReliableStateManagerConfiguration(
                        new ReliableStateManagerReplicatorSettings()
            {
                RetryInterval = TimeSpan.FromSeconds(3)
                        }
            )))).GetAwaiter().GetResult();
    }
}    
```
```csharp
class MyStatefulService : StatefulService
{
    public MyStatefulService(StatefulServiceContext context, IReliableStateManagerReplica stateManager)
        : base(context, stateManager)
    { }
    ...
}
```


### <a name="sample-configuration-file"></a><span data-ttu-id="f7aab-261">Archivo de configuración de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7aab-261">Sample configuration file</span></span>
```xml
<?xml version="1.0" encoding="utf-8"?>
<Settings xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/2011/01/fabric">
   <Section Name="ReplicatorConfig">
      <Parameter Name="ReplicatorEndpoint" Value="ReplicatorEndpoint" />
      <Parameter Name="BatchAcknowledgementInterval" Value="0.05"/>
      <Parameter Name="CheckpointThresholdInMB" Value="512" />
   </Section>
   <Section Name="ReplicatorSecurityConfig">
      <Parameter Name="CredentialType" Value="X509" />
      <Parameter Name="FindType" Value="FindByThumbprint" />
      <Parameter Name="FindValue" Value="9d c9 06 b1 69 dc 4f af fd 16 97 ac 78 1e 80 67 90 74 9d 2f" />
      <Parameter Name="StoreLocation" Value="LocalMachine" />
      <Parameter Name="StoreName" Value="My" />
      <Parameter Name="ProtectionLevel" Value="EncryptAndSign" />
      <Parameter Name="AllowedCommonNames" Value="My-Test-SAN1-Alice,My-Test-SAN1-Bob" />
   </Section>
</Settings>
```


### <a name="remarks"></a><span data-ttu-id="f7aab-262">Comentarios</span><span class="sxs-lookup"><span data-stu-id="f7aab-262">Remarks</span></span>
<span data-ttu-id="f7aab-263">BatchAcknowledgementInterval controla la latencia de replicación.</span><span class="sxs-lookup"><span data-stu-id="f7aab-263">BatchAcknowledgementInterval controls replication latency.</span></span> <span data-ttu-id="f7aab-264">Un valor de "0" ofrecerá la menor latencia posible, a costa del rendimiento (como deben enviarse y procesarse más mensajes de confirmación, cada uno con menos confirmaciones).</span><span class="sxs-lookup"><span data-stu-id="f7aab-264">A value of '0' results in the lowest possible latency, at the cost of throughput (as more acknowledgement messages must be sent and processed, each containing fewer acknowledgements).</span></span>
<span data-ttu-id="f7aab-265">Cuanto mayor sea el valor de BatchAcknowledgementInterval, mayor será el rendimiento general de la replicación a costa de una mayor latencia de la operación.</span><span class="sxs-lookup"><span data-stu-id="f7aab-265">The larger the value for BatchAcknowledgementInterval, the higher the overall replication throughput, at the cost of higher operation latency.</span></span> <span data-ttu-id="f7aab-266">Esto se traduce directamente en la latencia de transacciones confirmadas.</span><span class="sxs-lookup"><span data-stu-id="f7aab-266">This directly translates to the latency of transaction commits.</span></span>

<span data-ttu-id="f7aab-267">El valor de CheckpointThresholdInMB controla la cantidad de espacio en disco que el replicador puede usar para almacenar información de estado en el archivo de registro específico de la réplica.</span><span class="sxs-lookup"><span data-stu-id="f7aab-267">The value for CheckpointThresholdInMB controls the amount of disk space that the replicator can use to store state information in the replica's dedicated log file.</span></span> <span data-ttu-id="f7aab-268">Aumentar este valor a un valor mayor que el predeterminado puede acelerar los tiempos de reconfiguración cuando se agrega una nueva réplica al conjunto.</span><span class="sxs-lookup"><span data-stu-id="f7aab-268">Increasing this to a higher value than the default could result in faster reconfiguration times when a new replica is added to the set.</span></span> <span data-ttu-id="f7aab-269">Esto se debe a la transferencia de estado parcial que tiene lugar debido a la disponibilidad de mayor cantidad de historial de operaciones en el registro.</span><span class="sxs-lookup"><span data-stu-id="f7aab-269">This is due to the partial state transfer that takes place due to the availability of more history of operations in the log.</span></span> <span data-ttu-id="f7aab-270">Esto podría aumentar el tiempo de recuperación de una réplica después de un error.</span><span class="sxs-lookup"><span data-stu-id="f7aab-270">This can potentially increase the recovery time of a replica after a crash.</span></span>

<span data-ttu-id="f7aab-271">El parámetro MaxRecordSizeInKB define el tamaño máximo de un registro que el replicador puede escribir en el archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="f7aab-271">The MaxRecordSizeInKB setting defines the maximum size of a record that can be written by the replicator into the log file.</span></span> <span data-ttu-id="f7aab-272">En la mayoría de los casos, el tamaño predeterminado de 1024 KB del registro es óptimo.</span><span class="sxs-lookup"><span data-stu-id="f7aab-272">In most cases, the default 1024-KB record size is optimal.</span></span> <span data-ttu-id="f7aab-273">Sin embargo, si el servicio hace que elementos de datos de mayor tamaño formen parte de la información de estado, es posible que este valor se tenga que aumentar.</span><span class="sxs-lookup"><span data-stu-id="f7aab-273">However, if the service is causing larger data items to be part of the state information, then this value might need to be increased.</span></span> <span data-ttu-id="f7aab-274">Cambiar MaxRecordSizeInKB para que tenga un tamaño inferior a 1024 presenta pocas ventajas, ya que los registros más pequeños solamente usan el espacio necesario para el registro más pequeño.</span><span class="sxs-lookup"><span data-stu-id="f7aab-274">There is little benefit in making MaxRecordSizeInKB smaller than 1024, as smaller records use only the space needed for the smaller record.</span></span> <span data-ttu-id="f7aab-275">Se espera que este valor solo tenga que cambiarse en raras ocasiones.</span><span class="sxs-lookup"><span data-stu-id="f7aab-275">We expect that this value would need to be changed in only rare cases.</span></span>

<span data-ttu-id="f7aab-276">Los parámetros SharedLogId y SharedLogPath siempre se usan en conjunto para obligar a un servicio a usar un registro compartido independiente del registro compartido predeterminado del nodo.</span><span class="sxs-lookup"><span data-stu-id="f7aab-276">The SharedLogId and SharedLogPath settings are always used together to make a service use a separate shared log from the default shared log for the node.</span></span> <span data-ttu-id="f7aab-277">Para obtener una mayor eficacia, todos los servicios posibles deben especificar el mismo registro compartido.</span><span class="sxs-lookup"><span data-stu-id="f7aab-277">For best efficiency, as many services as possible should specify the same shared log.</span></span> <span data-ttu-id="f7aab-278">Para reducir la contención del movimiento de encabezados, los archivos de registro compartidos deben colocarse en discos que se usen únicamente para el archivo de registro compartido.</span><span class="sxs-lookup"><span data-stu-id="f7aab-278">Shared log files should be placed on disks that are used solely for the shared log file to reduce head movement contention.</span></span> <span data-ttu-id="f7aab-279">Se espera que este valor solo tenga que cambiarse en raras ocasiones.</span><span class="sxs-lookup"><span data-stu-id="f7aab-279">We expect that this value would need to be changed in only rare cases.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f7aab-280">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="f7aab-280">Next steps</span></span>
* [<span data-ttu-id="f7aab-281">Depuración de la aplicación del Service Fabric en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="f7aab-281">Debug your Service Fabric application in Visual Studio</span></span>](service-fabric-debugging-your-application.md)
* [<span data-ttu-id="f7aab-282">Referencia para desarrolladores de servicios confiables</span><span class="sxs-lookup"><span data-stu-id="f7aab-282">Developer reference for Reliable Services</span></span>](https://msdn.microsoft.com/library/azure/dn706529.aspx)

