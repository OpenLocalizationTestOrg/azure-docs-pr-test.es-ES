---
title: "Actualización de la aplicación: serialización de datos| Microsoft Docs"
description: "Prácticas recomendadas para la serialización de datos y cómo afectan a las sucesivas actualizaciones de la aplicación."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 6aa3ac7842df4657fca7f6b4264e1c6fe52dc0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="ce2c0-103">Información sobre cómo la serialización afecta a una actualización de aplicación</span><span class="sxs-lookup"><span data-stu-id="ce2c0-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="ce2c0-104">En una [actualización de la aplicación gradual](service-fabric-application-upgrade.md), la actualización se aplica a un subconjunto de nodos, un dominio de actualización a la vez.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), the upgrade is applied to a subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="ce2c0-105">Durante este proceso, algunos dominios de actualización se incluyen en la versión más reciente de su aplicación, mientras que otros están en la versión anterior.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-105">During this process, some upgrade domains are on the newer version of your application, and some upgrade domains are on the older version of your application.</span></span> <span data-ttu-id="ce2c0-106">Durante el lanzamiento, la nueva versión de la aplicación debe poder leer la versión anterior de sus datos, mientras que la versión anterior debe poder leer la nueva versión.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-106">During the rollout, the new version of your application must be able to read the old version of your data, and the old version of your application must be able to read the new version of your data.</span></span> <span data-ttu-id="ce2c0-107">Si el formato de datos no es compatible con las versiones anteriores y nuevas, es posible que se produzca un error en la actualización, o lo que es peor, que se pierdan o dañen datos.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-107">If the data format is not forward and backward compatible, the upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="ce2c0-108">En este artículo se analiza qué constituye su formato de datos y ofrece prácticas recomendadas para garantizar que sus datos sean compatibles con las versiones anteriores y nuevas.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="ce2c0-109">¿Qué conforma su formato de datos?</span><span class="sxs-lookup"><span data-stu-id="ce2c0-109">What makes up your data format?</span></span>
<span data-ttu-id="ce2c0-110">En Service Fabric de Azure, los datos que se conservan y replican proceden de sus clases de C#.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-110">In Azure Service Fabric, the data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="ce2c0-111">Para las aplicaciones que usan [Colecciones fiables](service-fabric-reliable-services-reliable-collections.md), esos datos son los objetos de los diccionarios y colas fiables.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is the objects in the reliable dictionaries and queues.</span></span> <span data-ttu-id="ce2c0-112">Para las aplicaciones que usan el modelo de [Reliable Actors](service-fabric-reliable-actors-introduction.md), se trata del estado de respaldo del actor.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is the backing state for the actor.</span></span> <span data-ttu-id="ce2c0-113">Estas clases de C# deben ser serializables para conservarse y replicarse.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-113">These C# classes must be serializable to be persisted and replicated.</span></span> <span data-ttu-id="ce2c0-114">Por lo tanto, el formato de datos se define por medio de los campos y propiedades que se serializan y de cómo se produce esto.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-114">Therefore, the data format is defined by the fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="ce2c0-115">Por ejemplo, en `IReliableDictionary<int, MyClass>`, los datos son `int` y `MyClass` serializados.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-115">For example, in an `IReliableDictionary<int, MyClass>` the data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="ce2c0-116">Cambios de código que dan como resultado un cambio de formato de datos</span><span class="sxs-lookup"><span data-stu-id="ce2c0-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="ce2c0-117">Como las clases de C# determinan el formato de datos, los cambios en las clases pueden producir un cambio del formato de datos.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-117">Since the data format is determined by C# classes, changes to the classes may cause a data format change.</span></span> <span data-ttu-id="ce2c0-118">Hay que actuar con cautela para garantizar que una actualización gradual pueda controlar el cambio del formato de datos.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-118">Care must be taken to ensure that a rolling upgrade can handle the data format change.</span></span> <span data-ttu-id="ce2c0-119">Ejemplos que pueden provocar cambios del formato de datos:</span><span class="sxs-lookup"><span data-stu-id="ce2c0-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="ce2c0-120">Adición o eliminación de campos o propiedades</span><span class="sxs-lookup"><span data-stu-id="ce2c0-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="ce2c0-121">Cambio de nombre de campos o propiedades</span><span class="sxs-lookup"><span data-stu-id="ce2c0-121">Renaming fields or properties</span></span>
* <span data-ttu-id="ce2c0-122">Cambio de los tipos de campos o propiedades</span><span class="sxs-lookup"><span data-stu-id="ce2c0-122">Changing the types of fields or properties</span></span>
* <span data-ttu-id="ce2c0-123">Cambio del nombre de clase o espacio de nombres</span><span class="sxs-lookup"><span data-stu-id="ce2c0-123">Changing the class name or namespace</span></span>

### <a name="data-contract-as-the-default-serializer"></a><span data-ttu-id="ce2c0-124">Contrato de datos como el serializador predeterminado</span><span class="sxs-lookup"><span data-stu-id="ce2c0-124">Data Contract as the default serializer</span></span>
<span data-ttu-id="ce2c0-125">El serializador suele ser responsable de la lectura de los datos y de su deserialización en la versión actual, incluso si los datos están en una versión anterior o *más reciente* .</span><span class="sxs-lookup"><span data-stu-id="ce2c0-125">The serializer is generally responsible for reading the data and deserializing it into the current version, even if the data is in an older or *newer* version.</span></span> <span data-ttu-id="ce2c0-126">El serializador predeterminado es el [serializador de contratos de datos](https://msdn.microsoft.com/library/ms733127.aspx), que tiene reglas de versiones bien definidas.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-126">The default serializer is the [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="ce2c0-127">Las Colecciones fiables permiten el reemplazo del serializador, pero los Reliable Actors no lo permiten.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-127">Reliable Collections allow the serializer to be overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="ce2c0-128">El serializador de datos tiene un rol importante en la habilitación de actualizaciones graduales.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-128">The data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="ce2c0-129">El serializador de contratos de datos es el serializador que se recomienda para las aplicaciones de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-129">The Data Contract serializer is the serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-the-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="ce2c0-130">Cómo afecta el formato de datos a la actualización gradual</span><span class="sxs-lookup"><span data-stu-id="ce2c0-130">How the data format affects a rolling upgrade</span></span>
<span data-ttu-id="ce2c0-131">Durante una actualización gradual, hay dos escenarios principales donde el serializador puede encontrar una versión anterior o *más reciente* de sus datos:</span><span class="sxs-lookup"><span data-stu-id="ce2c0-131">During a rolling upgrade, there are two main scenarios where the serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="ce2c0-132">Una vez que un nodo se actualice y empiece a crear copias de seguridad, el nuevo serializador cargará los datos que la versión anterior conservó en el disco.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-132">After a node is upgraded and starts back up, the new serializer will load the data that was persisted to disk by the old version.</span></span>
2. <span data-ttu-id="ce2c0-133">Durante la actualización gradual, el clúster puede contener una mezcla de las versiones anteriores y nuevas de su código.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-133">During the rolling upgrade, the cluster will contain a mix of the old and new versions of your code.</span></span> <span data-ttu-id="ce2c0-134">Como las réplicas se pueden incluir en distintos dominios de actualización y las réplicas envían datos entre sí, la versión nueva como la anterior de los datos se pueden encontrar en la versión nueva o la anterior del serializador.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-134">Since replicas may be placed in different upgrade domains, and replicas send data to each other, the new and/or old version of your data may be encountered by the new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="ce2c0-135">La "nueva versión" y "versión anterior" aquí hacen referencia a la versión de su código en ejecución.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-135">The "new version" and "old version" here refer to the version of your code that is running.</span></span> <span data-ttu-id="ce2c0-136">El "nuevo serializador" hace referencia al código del serializador que se ejecuta en la nueva versión de su aplicación.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-136">The "new serializer" refers to the serializer code that is executing in the new version of your application.</span></span> <span data-ttu-id="ce2c0-137">Los "nuevos datos" hacen referencia a la clase de C# serializada de la nueva versión de su aplicación.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-137">The "new data" refers to the serialized C# class from the new version of your application.</span></span>
> 
> 

<span data-ttu-id="ce2c0-138">Las dos versiones del formato de código y datos deben ser compatibles con las versiones anteriores y nuevas.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-138">The two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="ce2c0-139">Si no son compatibles, es posible que se produzca un error en la actualización o se pierdan datos.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-139">If they are not compatible, the rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="ce2c0-140">Es posible que se produzca un error en la actualización porque el código o serializador puede producir excepciones o un error cuando encuentra la otra versión.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-140">The rolling upgrade may fail because the code or serializer may throw exceptions or a fault when it encounters the other version.</span></span> <span data-ttu-id="ce2c0-141">Es posible que se pierdan datos si, por ejemplo, se agregó una nueva propiedad, pero el serializador anterior la descarta durante la deserialización.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-141">Data may be lost if, for example, a new property was added but the old serializer discards it during deserialization.</span></span>

<span data-ttu-id="ce2c0-142">El contrato de datos es la solución recomendada para garantizar que sus datos sean compatibles.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-142">Data Contract is the recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="ce2c0-143">Tiene reglas de versiones bien definidas para agregar, quitar y cambiar campos.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="ce2c0-144">También tiene compatibilidad para tratar con campos desconocidos, enlazar con el proceso de serialización y deserialización, y para tratar con la herencia de clases.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-144">It also has support for dealing with unknown fields, hooking into the serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="ce2c0-145">Para obtener más información, consulte [Uso de contrato de datos](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="ce2c0-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ce2c0-146">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="ce2c0-146">Next steps</span></span>
<span data-ttu-id="ce2c0-147">[actualización de aplicaciones usando Visual Studio](service-fabric-application-upgrade-tutorial.md) ofrece información para actualizar una aplicación mediante Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="ce2c0-148">[actualización de aplicaciones mediante PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) se explica en detalle lo que tiene que hacer para actualizar una aplicación mediante PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ce2c0-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="ce2c0-149">Puede controlar cómo se actualiza una aplicación usando [parámetros de actualización](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="ce2c0-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="ce2c0-150">Aprenda a usar funcionalidades avanzadas para actualizar una aplicación. Para ello, consulte los [temas avanzados](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="ce2c0-150">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="ce2c0-151">Solucione problemas habituales en las actualizaciones de aplicaciones consultando los pasos que figuran en [Solución de problemas de las actualizaciones de aplicaciones ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="ce2c0-151">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

