---
title: "Supervisión y diagnóstico de contenedores de Azure Service Fabric | Microsoft Docs"
description: Aprenda a supervisar y diagnosticar contenedores organizados en Microsoft Azure Service Fabric con soluciones Containers de OMS.
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/10/2017
ms.author: dekapur
ms.openlocfilehash: 874c1a5c4b399ff2254072b7282f05d83a005cc3
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="monitoring-windows-server-containers-with-oms"></a><span data-ttu-id="9eb27-103">Supervisión de contenedores de Windows Server con OMS</span><span class="sxs-lookup"><span data-stu-id="9eb27-103">Monitoring Windows Server containers with OMS</span></span>

## <a name="oms-containers-solution"></a><span data-ttu-id="9eb27-104">Solución Containers de OMS</span><span class="sxs-lookup"><span data-stu-id="9eb27-104">OMS Containers Solution</span></span>

<span data-ttu-id="9eb27-105">El equipo de Operations Management Suite (OMS) ha publicado una solución Containers para el diagnóstico y la supervisión de contenedores.</span><span class="sxs-lookup"><span data-stu-id="9eb27-105">The Operations Management Suite (OMS) team has published a Containers solution for diagnostics and monitoring for containers.</span></span> <span data-ttu-id="9eb27-106">Junto con su solución de Service Fabric, esta solución es una herramienta excelente para supervisar las implementaciones de contenedores que se organizan en Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9eb27-106">Alongside their Service Fabric solution, this solution is a great tool to monitor container deployments orchestrated on Service Fabric.</span></span> <span data-ttu-id="9eb27-107">Este es un ejemplo sencillo de aspecto del panel de la solución:</span><span class="sxs-lookup"><span data-stu-id="9eb27-107">Here's a simple example of what the dashboard in the solution looks like:</span></span>

![Panel de OMS básico](./media/service-fabric-diagnostics-containers-windowsserver/oms-containers-dashboard.png)

<span data-ttu-id="9eb27-109">También recopila diferentes tipos de registros que se pueden consultar en la herramienta Log Analytics de OMS y se puede usarse para visualizar las métricas o eventos que se generan.</span><span class="sxs-lookup"><span data-stu-id="9eb27-109">It also collects different kinds of logs that can be queried in the OMS Log Analytics tool, and can be used to visualize any metrics or events being generated.</span></span> <span data-ttu-id="9eb27-110">Los tipos de registro que se recopilan son:</span><span class="sxs-lookup"><span data-stu-id="9eb27-110">The log types that are collected are:</span></span>

1. <span data-ttu-id="9eb27-111">ContainerInventory: muestra información acerca de la ubicación, nombre e imágenes del contenedor</span><span class="sxs-lookup"><span data-stu-id="9eb27-111">ContainerInventory: shows information about container location, name, and images</span></span>
2. <span data-ttu-id="9eb27-112">ContainerImageInventory: información acerca de las imágenes implementadas, lo que incluye sus identificadores o tamaños</span><span class="sxs-lookup"><span data-stu-id="9eb27-112">ContainerImageInventory: information about deployed images, including IDs or sizes</span></span>
3. <span data-ttu-id="9eb27-113">ContainerLog: registros de error concretos, registros de docker (stdout, etc.) y otras entradas</span><span class="sxs-lookup"><span data-stu-id="9eb27-113">ContainerLog: specific error logs, docker logs (stdout, etc.), and other entries</span></span>
4. <span data-ttu-id="9eb27-114">ContainerServiceLog: comandos de demonio de docker que se han ejecutado</span><span class="sxs-lookup"><span data-stu-id="9eb27-114">ContainerServiceLog: docker daemon commands that have been run</span></span>
5. <span data-ttu-id="9eb27-115">Perf: contadores de rendimiento, entre los que se incluyen la cpu del contenedor, la memoria, el tráfico de red, la e/s de disco y métricas personalizadas de los equipos host</span><span class="sxs-lookup"><span data-stu-id="9eb27-115">Perf: performance counters including container cpu, memory, network traffic, disk i/o, and custom metrics from the host machines</span></span>

<span data-ttu-id="9eb27-116">En este artículo se tratan los pasos necesarios para configurar la supervisión del contenedor para el clúster.</span><span class="sxs-lookup"><span data-stu-id="9eb27-116">This article covers the steps required to set up container monitoring for your cluster.</span></span> <span data-ttu-id="9eb27-117">Para más información acerca de la solución Containers de OMS, consulte su [documentación](../log-analytics/log-analytics-containers.md).</span><span class="sxs-lookup"><span data-stu-id="9eb27-117">To learn more about OMS's Containers solution, check out their [documentation](../log-analytics/log-analytics-containers.md).</span></span>

## <a name="1-set-up-a-service-fabric-cluster"></a><span data-ttu-id="9eb27-118">1. Configuración de un clúster de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="9eb27-118">1. Set up a Service Fabric cluster</span></span>

<span data-ttu-id="9eb27-119">Cree un clúster de Service Fabric mediante la plantilla de Azure Resource Manager que encontrará [aquí](https://github.com/dkkapur/Service-Fabric/tree/master/ARM%20Templates/SF%20OMS%20Sample).</span><span class="sxs-lookup"><span data-stu-id="9eb27-119">Create a cluster using the Azure Resource Manager template found [here](https://github.com/dkkapur/Service-Fabric/tree/master/ARM%20Templates/SF%20OMS%20Sample).</span></span> <span data-ttu-id="9eb27-120">Asegúrese de agregar un nombre de área de trabajo de OMS único.</span><span class="sxs-lookup"><span data-stu-id="9eb27-120">Make sure to add a unique OMS workspace name.</span></span> <span data-ttu-id="9eb27-121">Esta plantilla también tiene como valor predeterminado la implementación de un clúster en la versión preliminar de Service Fabric (v255.255), lo que significa que no se puede usar en producción y no se puede actualizar a otra versión de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9eb27-121">This template also defaults to deploying a cluster in the preview build of Service Fabric (v255.255), which means that it cannot be used in production, and cannot be upgraded to a different Service Fabric version.</span></span> <span data-ttu-id="9eb27-122">Si decide usar esta plantilla para el uso de producción o a largo plazo, cambie la versión a un número de versión estable.</span><span class="sxs-lookup"><span data-stu-id="9eb27-122">If you decide to use this template for long-term or production use, change the version to a stable version number.</span></span>

<span data-ttu-id="9eb27-123">Una vez que se ha configurado el clúster, confirme que ha instalado el certificado adecuado y asegúrese de que puede conectarse al clúster.</span><span class="sxs-lookup"><span data-stu-id="9eb27-123">Once the cluster is set up, confirm that you have installed the appropriate certificate, and make sure you are able to connect to the cluster.</span></span>

<span data-ttu-id="9eb27-124">Confirme que el grupo de recursos se ha configurado correctamente, para lo que debe dirigirse a [Azure Portal](https://portal.azure.com/) y buscar la implementación.</span><span class="sxs-lookup"><span data-stu-id="9eb27-124">Confirm that your Resource Group is set up correctly by heading to the [Azure portal](https://portal.azure.com/) and finding the deployment.</span></span> <span data-ttu-id="9eb27-125">El grupo de recursos debe contener todos los recursos de Service Fabric y también tener una solución de Log Analytics, así como una solución de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9eb27-125">The resource group should contain all the Service Fabric resources, and also have a Log Analytics solution as well as a Service Fabric solution.</span></span>

<span data-ttu-id="9eb27-126">Para modificar un clúster de Service Fabric existente:</span><span class="sxs-lookup"><span data-stu-id="9eb27-126">For modifying an existing Service Fabric cluster:</span></span>
* <span data-ttu-id="9eb27-127">Confirme que Diagnostics esté habilitado (si no lo está, habilítelo mediante la [actualización del conjunto de escalado de máquinas virtuales](/rest/api/virtualmachinescalesets/create-or-update-a-set))</span><span class="sxs-lookup"><span data-stu-id="9eb27-127">Confirm that Diagnostics is enabled (if not, enable it via [updating the virtual machine scale set](/rest/api/virtualmachinescalesets/create-or-update-a-set))</span></span>
* <span data-ttu-id="9eb27-128">Agregue un área de trabajo de OMS mediante la creación de una solución "Service Fabric Analytics" a través de Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="9eb27-128">Add an OMS Workspace by creating a "Service Fabric Analytics" solution via the Azure Marketplace</span></span>
* <span data-ttu-id="9eb27-129">Edite los orígenes de datos de la solución Service Fabric para recoger datos de las tablas de Azure Storage adecuadas (configuradas por WAD) en el grupo de recursos en el que se encuentra el clúster</span><span class="sxs-lookup"><span data-stu-id="9eb27-129">Edit the data sources of the Service Fabric solution to pick up data from the appropriate Azure Storage tables (set up by WAD) in the Resource Group that the cluster is in</span></span>
* <span data-ttu-id="9eb27-130">Agregue el agente como [extensión al conjunto de escalado de máquinas virtuales](/powershell/module/azurerm.compute/add-azurermvmssextension) a través de PowerShell o mediante la actualización del conjunto de escalado de máquinas virtuales (el mismo vínculo que antes, para modificar la plantilla de Resource Manager)</span><span class="sxs-lookup"><span data-stu-id="9eb27-130">Add the agent as an [extension to the virtual machine scale set](/powershell/module/azurerm.compute/add-azurermvmssextension) via PowerShell or through updating the virtual machine scale set (same link as above, to modify the Resource Manager template)</span></span>

## <a name="2-deploy-a-container"></a><span data-ttu-id="9eb27-131">2. Implementación de un contenedor</span><span class="sxs-lookup"><span data-stu-id="9eb27-131">2. Deploy a container</span></span>

<span data-ttu-id="9eb27-132">Una vez que el clúster esté listo y que ha confirmado que puede acceder a él, implemente un contenedor en él.</span><span class="sxs-lookup"><span data-stu-id="9eb27-132">Once the cluster is ready and you have confirmed that you can access it, deploy a container to it.</span></span> <span data-ttu-id="9eb27-133">Si ha elegido usar la versión preliminar que establece la plantilla, también puede explorar la nueva funcionalidad de Docker Compose de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9eb27-133">If you chose to use the preview version as set by the template, you can also explore Service Fabric's new docker compose functionality.</span></span> <span data-ttu-id="9eb27-134">Tenga en cuenta que la primera vez que una imagen del contenedor se implementa en un clúster, se tardan varios minutos en descargar la imagen según su tamaño.</span><span class="sxs-lookup"><span data-stu-id="9eb27-134">Bear in mind that the first time a container image is deployed to a cluster, it takes several minutes to download the image depending on its size.</span></span>

## <a name="3-add-the-containers-solution"></a><span data-ttu-id="9eb27-135">3. Incorporación de la solución Containers</span><span class="sxs-lookup"><span data-stu-id="9eb27-135">3. Add the Containers solution</span></span>

<span data-ttu-id="9eb27-136">En Azure Portal, cree un recurso de Containers (en la categoría Supervisión y administración) a través de Azure Marketplace.</span><span class="sxs-lookup"><span data-stu-id="9eb27-136">In the Azure portal, create a Containers resource (under the Monitoring + Management category) through Azure Marketplace.</span></span> 

![Adición de la solución Containers](./media/service-fabric-diagnostics-containers-windowsserver/containers-solution.png)

<span data-ttu-id="9eb27-138">En el paso de creación, solicita un área de trabajo de OMS.</span><span class="sxs-lookup"><span data-stu-id="9eb27-138">In the creation step, it requests an OMS workspace.</span></span> <span data-ttu-id="9eb27-139">Seleccione el que se creó con la implementación anterior.</span><span class="sxs-lookup"><span data-stu-id="9eb27-139">Select the one that was created with the deployment above.</span></span> <span data-ttu-id="9eb27-140">Este paso agrega una solución Containers al área de trabajo de OMS y la detecta automáticamente el agente de OMS implementado por la plantilla.</span><span class="sxs-lookup"><span data-stu-id="9eb27-140">This step adds a Containers solution within your OMS workspace, and is automatically detected by the OMS agent deployed by the template.</span></span> <span data-ttu-id="9eb27-141">El agente empezará a recopilar datos sobre los procesos de contenedores del clúster y, en aproximadamente 10-15 minutos, debería ver que aparecen los datos, como se muestra en la imagen del panel anterior.</span><span class="sxs-lookup"><span data-stu-id="9eb27-141">The agent will start gathering data on the containers processes in the cluster, and in about 10-15 minutes, you should see the solution light up with data as in the image of the dashboard above.</span></span>

## <a name="4-next-steps"></a><span data-ttu-id="9eb27-142">4. Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="9eb27-142">4. Next steps</span></span>

<span data-ttu-id="9eb27-143">OMS ofrece en el área de trabajo varias herramientas que hacen que sea más útil para el usuario.</span><span class="sxs-lookup"><span data-stu-id="9eb27-143">OMS offers various tools in the workspace to make if more useful for you.</span></span> <span data-ttu-id="9eb27-144">Explore las siguientes opciones para personalizar la solución para ajustarla a sus necesidades:</span><span class="sxs-lookup"><span data-stu-id="9eb27-144">Explore the following options to customize the solution to your needs:</span></span>
- <span data-ttu-id="9eb27-145">Familiarícese con las funciones de [búsqueda de registros y consulta](../log-analytics/log-analytics-log-searches.md) que se ofrecen como parte de Log Analytics</span><span class="sxs-lookup"><span data-stu-id="9eb27-145">Get familiarized with the [log search and querying](../log-analytics/log-analytics-log-searches.md) features offered as part of Log Analytics</span></span>
- <span data-ttu-id="9eb27-146">Configure el agente de OMS para que recoja contadores de rendimiento concretos (vaya a la página principal del área de trabajo > Configuración > Datos >Contadores de rendimiento de Windows)</span><span class="sxs-lookup"><span data-stu-id="9eb27-146">Configure the OMS agent to pick up specific performance counters (go to the workspace Home > Settings > Data > Windows Performance Counters)</span></span>
- <span data-ttu-id="9eb27-147">Configure OMS para establecer reglas de [alertas automáticas](../log-analytics/log-analytics-alerts.md) que ayuden en la detección y diagnóstico</span><span class="sxs-lookup"><span data-stu-id="9eb27-147">Configure OMS to set up [automated alerting](../log-analytics/log-analytics-alerts.md) rules to aid in detecting and diagnostics</span></span>