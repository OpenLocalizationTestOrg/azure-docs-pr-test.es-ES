---
title: "Automatización de la administración de aplicaciones de Azure Service Fabric | Microsoft Docs"
description: "Implementación, actualización, prueba y eliminación de aplicaciones de Service Fabric con PowerShell."
services: service-fabric
documentationcenter: .net
author: rwike77
manager: timlt
editor: 
ms.assetid: f03f4294-571d-4262-8a77-cc8b481b959d
ms.service: service-fabric
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/16/2017
ms.author: ryanwi
redirect_url: /azure/service-fabric/service-fabric-deploy-remove-applications
ms.openlocfilehash: fb3c2a77ea887289eebf343e223c190781d0e4c2
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/11/2017
---
# <a name="automate-the-application-lifecycle-using-powershell"></a><span data-ttu-id="09d10-103">Automatización del ciclo de vida de las aplicaciones con PowerShell</span><span class="sxs-lookup"><span data-stu-id="09d10-103">Automate the application lifecycle using PowerShell</span></span>
<span data-ttu-id="09d10-104">Muchos aspectos del [ciclo de vida de la aplicación de Service Fabric](service-fabric-application-lifecycle.md) pueden automatizarse.</span><span class="sxs-lookup"><span data-stu-id="09d10-104">Many aspects of the [Service Fabric application lifecycle](service-fabric-application-lifecycle.md) can be automated.</span></span>  <span data-ttu-id="09d10-105">En este artículo se muestra cómo usar PowerShell para automatizar las tareas comunes para implementar, actualizar, quitar y probar aplicaciones de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="09d10-105">This article shows how to use PowerShell to automate common tasks for deploying, upgrading, removing, and testing Azure Service Fabric applications.</span></span>  <span data-ttu-id="09d10-106">También cuenta con API HTTP y administradas para la administración de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="09d10-106">Managed and HTTP APIs for app management are also available.</span></span> <span data-ttu-id="09d10-107">Consulte el [ciclo de vida de las aplicaciones](service-fabric-application-lifecycle.md) para más información.</span><span class="sxs-lookup"><span data-stu-id="09d10-107">See [app lifecycle](service-fabric-application-lifecycle.md) for more information.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="09d10-108">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="09d10-108">Prerequisites</span></span>
<span data-ttu-id="09d10-109">Antes de empezar con las tareas del artículo, no olvide de hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="09d10-109">Before you move on to the tasks in the article, be sure to:</span></span>

* <span data-ttu-id="09d10-110">Familiarícese con los conceptos de Service Fabric descritos en [Introducción técnica a Service Fabric](service-fabric-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="09d10-110">Get familiar with the Service Fabric concepts described in [Technical overview of Service Fabric](service-fabric-technical-overview.md).</span></span>
* <span data-ttu-id="09d10-111">[Instale el motor en tiempo de ejecución, el SDK y las herramientas](service-fabric-get-started.md), lo que también instala el módulo PowerShell de **ServiceFabric** .</span><span class="sxs-lookup"><span data-stu-id="09d10-111">[Install the runtime, SDK, and tools](service-fabric-get-started.md), which also installs the **ServiceFabric** PowerShell module.</span></span>
* <span data-ttu-id="09d10-112">[Habilite la ejecución del script de PowerShell](service-fabric-get-started.md#enable-powershell-script-execution).</span><span class="sxs-lookup"><span data-stu-id="09d10-112">[Enable PowerShell script execution](service-fabric-get-started.md#enable-powershell-script-execution).</span></span>
* <span data-ttu-id="09d10-113">Inicie un clúster local.</span><span class="sxs-lookup"><span data-stu-id="09d10-113">Start a local cluster.</span></span>  <span data-ttu-id="09d10-114">Abra una nueva ventana de PowerShell como administrador y después ejecute el script de configuración de clúster desde la carpeta del SDK: `& "$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1"`</span><span class="sxs-lookup"><span data-stu-id="09d10-114">Launch a new PowerShell window as an administrator and then run the cluster setup script from the SDK folder: `& "$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1"`</span></span>
* <span data-ttu-id="09d10-115">Antes de ejecutar los comandos de PowerShell en este artículo, conéctese al clúster de Service Fabric local mediante [Connect-ServiceFabricCluster](/powershell/module/servicefabric/connect-servicefabriccluster?view=azureservicefabricps): `Connect-ServiceFabricCluster localhost:19000`</span><span class="sxs-lookup"><span data-stu-id="09d10-115">Before you run any PowerShell commands in this article, first connect to the local Service Fabric cluster by using [Connect-ServiceFabricCluster](/powershell/module/servicefabric/connect-servicefabriccluster?view=azureservicefabricps): `Connect-ServiceFabricCluster localhost:19000`</span></span>
* <span data-ttu-id="09d10-116">Las tareas siguientes requieren un paquete de aplicación v1 para la implementación y uno v2 para la actualización.</span><span class="sxs-lookup"><span data-stu-id="09d10-116">The following tasks require a v1 application package to deploy and a v2 application package for upgrade.</span></span> <span data-ttu-id="09d10-117">Descargue la aplicación de ejemplo [**WordCount**](http://aka.ms/servicefabricsamples) (que se encuentra en los ejemplos de introducción).</span><span class="sxs-lookup"><span data-stu-id="09d10-117">Download the [**WordCount** sample application](http://aka.ms/servicefabricsamples) (located in the Getting Started samples).</span></span> <span data-ttu-id="09d10-118">Compile y empaquete la aplicación en Visual Studio (haga clic con el botón derecho en **WordCount** en el Explorador de soluciones y seleccione **Paquete**).</span><span class="sxs-lookup"><span data-stu-id="09d10-118">Build and package the application in Visual Studio (right-click on **WordCount** in Solution Explorer and select **Package**).</span></span> <span data-ttu-id="09d10-119">Copie el paquete v1 de `C:\ServiceFabricSamples\Services\WordCount\WordCount\pkg\Debug` a `C:\Temp\WordCount`.</span><span class="sxs-lookup"><span data-stu-id="09d10-119">Copy the v1 package in `C:\ServiceFabricSamples\Services\WordCount\WordCount\pkg\Debug` to `C:\Temp\WordCount`.</span></span> <span data-ttu-id="09d10-120">Copie `C:\Temp\WordCount` a `C:\Temp\WordCountV2`, lo que crea el paquete de aplicación v2 para la actualización.</span><span class="sxs-lookup"><span data-stu-id="09d10-120">Copy `C:\Temp\WordCount` to `C:\Temp\WordCountV2`, creating the v2 application package for upgrade.</span></span> <span data-ttu-id="09d10-121">Abra `C:\Temp\WordCountV2\ApplicationManifest.xml` en un editor de texto.</span><span class="sxs-lookup"><span data-stu-id="09d10-121">Open `C:\Temp\WordCountV2\ApplicationManifest.xml` in a text editor.</span></span> <span data-ttu-id="09d10-122">En el elemento **ApplicationManifest**, cambie el atributo **ApplicationTypeVersion** de "1.0.0" a "2.0.0" para actualizar el número de versión de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-122">In the **ApplicationManifest** element, change the **ApplicationTypeVersion** attribute from "1.0.0" to "2.0.0" to update the app version number.</span></span> <span data-ttu-id="09d10-123">Guarde el archivo ApplicationManifest.xml modificado.</span><span class="sxs-lookup"><span data-stu-id="09d10-123">Save the changed ApplicationManifest.xml file.</span></span>

## <a name="task-deploy-a-service-fabric-application"></a><span data-ttu-id="09d10-124">Tarea: Implementar una aplicación de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="09d10-124">Task: Deploy a Service Fabric application</span></span>
<span data-ttu-id="09d10-125">Una vez que compile y empaquete la aplicación (o descargue el paquete de aplicación), puede implementar esta aplicación en un clúster de Service Fabric local.</span><span class="sxs-lookup"><span data-stu-id="09d10-125">After you've built and packaged the application (or downloaded the application package), you can deploy the application into a local Service Fabric cluster.</span></span> <span data-ttu-id="09d10-126">La implementación significa cargar el paquete de aplicación, registrar el tipo de aplicación y crear la instancia de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-126">Deployment involves uploading the application package, registering the application type, and creating the application instance.</span></span> <span data-ttu-id="09d10-127">Use las instrucciones que aparecen en esta sección para implementar una aplicación nueva en un clúster.</span><span class="sxs-lookup"><span data-stu-id="09d10-127">Use the instructions in this section to deploy a new application to a cluster.</span></span>

### <a name="step-1-upload-the-application-package"></a><span data-ttu-id="09d10-128">Paso 1: cargar el paquete de aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-128">Step 1: Upload the application package</span></span>
<span data-ttu-id="09d10-129">Cargar el paquete de aplicación en el almacén de imágenes lo pone en una ubicación a la que pueden tener acceso los componentes internos de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="09d10-129">Uploading the application package to the image store puts it in a location accessible to internal Service Fabric components.</span></span>  <span data-ttu-id="09d10-130">El paquete de aplicación contiene el manifiesto de aplicación, los manifiestos de servicio y los paquetes de código, configuración y datos necesarios para crear las instancias de servicio y aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-130">The application package contains the necessary application manifest, service manifests, and code, configuration, and data package(s) to create the application and service instances.</span></span> <span data-ttu-id="09d10-131">Si quiere comprobar el paquete de la aplicación de forma local, use el cmdlet [ServiceFabricApplicationPackage prueba](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage).</span><span class="sxs-lookup"><span data-stu-id="09d10-131">If you want to verify the app package locally, use the [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span>  <span data-ttu-id="09d10-132">El comando [Copy-ServiceFabricApplicationPackage](/powershell/module/servicefabric/copy-servicefabricapplicationpackage?view=azureservicefabricps) carga el paquete.</span><span class="sxs-lookup"><span data-stu-id="09d10-132">The [Copy-ServiceFabricApplicationPackage](/powershell/module/servicefabric/copy-servicefabricapplicationpackage?view=azureservicefabricps) command uploads the package.</span></span> <span data-ttu-id="09d10-133">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="09d10-133">For example:</span></span>

```powershell
Copy-ServiceFabricApplicationPackage C:\Temp\WordCount\ -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCount
```

### <a name="step-2-register-the-application-type"></a><span data-ttu-id="09d10-134">Paso 2: registrar el tipo de aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-134">Step 2: Register the application type</span></span>
<span data-ttu-id="09d10-135">El registro del paquete de aplicación hace que la versión y el tipo de la aplicación declarados en el manifiesto de aplicación esté disponible para su uso.</span><span class="sxs-lookup"><span data-stu-id="09d10-135">Registering the application package makes the application type and version declared in the application manifest available for use.</span></span> <span data-ttu-id="09d10-136">El sistema lee el paquete cargado en el paso 1, lo comprueba (lo que equivale a ejecutar [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) localmente), procesa su contenido y copia el paquete procesado en una ubicación interna del sistema.</span><span class="sxs-lookup"><span data-stu-id="09d10-136">The system reads the package uploaded in the step 1, verify the package (equivalent to running [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) locally), process the package contents, and copy the processed package to an internal system location.</span></span>  <span data-ttu-id="09d10-137">Ejecute el cmdlet [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="09d10-137">Run the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Register-ServiceFabricApplicationType WordCount
```
<span data-ttu-id="09d10-138">Para ver todos los tipos de aplicación registrados en el clúster, ejecute el cmdlet [Get-ServiceFabricApplicationType](/powershell/module/servicefabric/get-servicefabricapplicationtype?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="09d10-138">To see all the application types registered in the cluster, run the [Get-ServiceFabricApplicationType](/powershell/module/servicefabric/get-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Get-ServiceFabricApplicationType
```

### <a name="step-3-create-the-application-instance"></a><span data-ttu-id="09d10-139">Paso 3: crear la instancia de aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-139">Step 3: Create the application instance</span></span>
<span data-ttu-id="09d10-140">Se pueden crear instancias de una aplicación mediante cualquier versión del tipo de aplicación que se ha registrado correctamente mediante el comando [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps).</span><span class="sxs-lookup"><span data-stu-id="09d10-140">An application can be instantiated by using any application type version that has been registered successfully by using the [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) command.</span></span> <span data-ttu-id="09d10-141">El nombre de cada aplicación se declara en el momento de la implementación; debe empezar con el esquema **fabric:** y ser único para cada instancia de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-141">The name of each application is declared at deploy time and must start with the **fabric:** scheme and be unique for each application instance.</span></span> <span data-ttu-id="09d10-142">El nombre y la versión del tipo de aplicación se declaran en el archivo **ApplicationManifest.xml** del paquete de aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-142">The application type name and application type version are declared in the **ApplicationManifest.xml** file of the application package.</span></span> <span data-ttu-id="09d10-143">Si se definieron servicios predeterminados en el manifiesto de aplicación del tipo de aplicación de destino, también se crean en este momento.</span><span class="sxs-lookup"><span data-stu-id="09d10-143">If any default services were defined in the application manifest of the target application type, then those are created at this time.</span></span>

```powershell
New-ServiceFabricApplication fabric:/WordCount WordCount 1.0.0
```

<span data-ttu-id="09d10-144">El comando [Get-ServiceFabricApplication](/powershell/servicefabric/vlatest/get-servicefabricapplication) enumera todas las instancias de aplicación que se crearon correctamente junto con su estado general.</span><span class="sxs-lookup"><span data-stu-id="09d10-144">The [Get-ServiceFabricApplication](/powershell/servicefabric/vlatest/get-servicefabricapplication) command lists all application instances that were successfully created, along with their overall status.</span></span> <span data-ttu-id="09d10-145">El comando [Get-ServiceFabricService](/powershell/module/servicefabric/get-servicefabricservice?view=azureservicefabricps) enumera todas las instancias de servicio que se crearon correctamente dentro de una instancia de aplicación determinada.</span><span class="sxs-lookup"><span data-stu-id="09d10-145">The [Get-ServiceFabricService](/powershell/module/servicefabric/get-servicefabricservice?view=azureservicefabricps) command lists all of the service instances that were successfully created within a given application instance.</span></span> <span data-ttu-id="09d10-146">Se enumeran los servicios predeterminados (en caso de haberlos).</span><span class="sxs-lookup"><span data-stu-id="09d10-146">Default services (if any) are listed.</span></span>

```powershell
Get-ServiceFabricApplication

Get-ServiceFabricApplication | Get-ServiceFabricService
```

## <a name="task-upgrade-a-service-fabric-application"></a><span data-ttu-id="09d10-147">Tarea: Actualizar una aplicación de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="09d10-147">Task: Upgrade a Service Fabric application</span></span>
<span data-ttu-id="09d10-148">Puede actualizar una aplicación de Service Fabric ya implementada con un paquete de aplicación actualizado.</span><span class="sxs-lookup"><span data-stu-id="09d10-148">You can upgrade a previously deployed Service Fabric application with an updated application package.</span></span> <span data-ttu-id="09d10-149">Esta tarea actualiza la aplicación WordCount que se implementó en "Tarea: Implementar una aplicación de Service Fabric".</span><span class="sxs-lookup"><span data-stu-id="09d10-149">This task upgrades the WordCount application that was deployed in "Task: Deploy a Service Fabric application."</span></span> <span data-ttu-id="09d10-150">Lea el [Tutorial de actualización de aplicación de Service Fabric](service-fabric-application-upgrade.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="09d10-150">Read through [Service Fabric application upgrade](service-fabric-application-upgrade.md) for more information.</span></span>

<span data-ttu-id="09d10-151">Para simplificar este ejemplo, solo se actualizó el número de versión de aplicación en el paquete de aplicación WordCountV2 creado en los requisitos previos.</span><span class="sxs-lookup"><span data-stu-id="09d10-151">To keep things simple for this example, only the application version number was updated in the WordCountV2 application package created in the prerequisites.</span></span> <span data-ttu-id="09d10-152">En un escenario más realista, se actualizarían los archivos de código, configuración o datos del servicio y después se volvería a generar y se empaquetaría la aplicación con los números de la versión actualizada.</span><span class="sxs-lookup"><span data-stu-id="09d10-152">A more realistic scenario would involve updating your service code, configuration, or data files and then rebuilding and packaging the application with updated version numbers.</span></span>  

### <a name="step-1-upload-the-updated-application-package"></a><span data-ttu-id="09d10-153">Paso 1: Carga del paquete de aplicación actualizado</span><span class="sxs-lookup"><span data-stu-id="09d10-153">Step 1: Upload the updated application package</span></span>
<span data-ttu-id="09d10-154">La aplicación WordCount v1 está lista para actualizarse.</span><span class="sxs-lookup"><span data-stu-id="09d10-154">The WordCount v1 application is ready to be upgraded.</span></span> <span data-ttu-id="09d10-155">Si abre una ventana de PowerShell como administrador y escribe [**Get-ServiceFabricApplication**](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), verá que está implementando la versión 1.0.0 del tipo de aplicación de WordCount.</span><span class="sxs-lookup"><span data-stu-id="09d10-155">If you open up a PowerShell window as administrator and type [**Get-ServiceFabricApplication**](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), you see that version 1.0.0 of the WordCount application type is deployed.</span></span>  

<span data-ttu-id="09d10-156">Ahora, copie el paquete de aplicación actualizada en el almacén de imágenes de Service Fabric (donde Service Fabric almacena los paquetes de aplicación).</span><span class="sxs-lookup"><span data-stu-id="09d10-156">Now copy the updated application package to the Service Fabric image store (where the application packages are stored by Service Fabric).</span></span> <span data-ttu-id="09d10-157">El parámetro **ApplicationPackagePathInImageStore** informa a Service Fabric sobre dónde puede encontrar el paquete de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-157">The parameter **ApplicationPackagePathInImageStore** informs Service Fabric where it can find the application package.</span></span> <span data-ttu-id="09d10-158">El siguiente comando copiará el paquete de aplicación en **WordCountV2** en el almacén de imágenes:</span><span class="sxs-lookup"><span data-stu-id="09d10-158">The following command copies the application package to **WordCountV2** in the image store:</span></span>  

```powershell
Copy-ServiceFabricApplicationPackage C:\Temp\WordCountV2\ -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCountV2

```
### <a name="step-2-register-the-updated-application-type"></a><span data-ttu-id="09d10-159">Paso 2: Registro del tipo de aplicación actualizado</span><span class="sxs-lookup"><span data-stu-id="09d10-159">Step 2: Register the updated application type</span></span>
<span data-ttu-id="09d10-160">El siguiente paso es registrar la versión nueva de la aplicación con Service Fabric, que se puede realizar con el cmdlet [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="09d10-160">The next step is to register the new version of the application with Service Fabric, which can be performed by using the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Register-ServiceFabricApplicationType WordCountV2
```

### <a name="step-3-start-the-upgrade"></a><span data-ttu-id="09d10-161">Paso 3: inicie la actualización</span><span class="sxs-lookup"><span data-stu-id="09d10-161">Step 3: Start the upgrade</span></span>
<span data-ttu-id="09d10-162">Varios parámetros de actualización, tiempos de expiración y los criterios de estado se pueden aplicar a las actualizaciones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-162">Various upgrade parameters, timeouts, and health criteria can be applied to application upgrades.</span></span> <span data-ttu-id="09d10-163">Consulte los [parámetros de actualización de la aplicación](service-fabric-application-upgrade-parameters.md) y los documentos del [proceso de actualización](service-fabric-application-upgrade.md) para más información.</span><span class="sxs-lookup"><span data-stu-id="09d10-163">Read through the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and [upgrade process](service-fabric-application-upgrade.md) documents to learn more.</span></span> <span data-ttu-id="09d10-164">El estado de todos los servicios y las instancias debe ser *correcto* después de la actualización.</span><span class="sxs-lookup"><span data-stu-id="09d10-164">All services and instances should be *healthy* after the upgrade.</span></span>  <span data-ttu-id="09d10-165">Establezca el valor de **HealthCheckStableDuration** en 60 segundos (para que los servicios conserven el estado correcto al menos 20 segundos antes de que la actualización pase al siguiente dominio de actualización).</span><span class="sxs-lookup"><span data-stu-id="09d10-165">Set the **HealthCheckStableDuration** to 60 seconds (so that the services are healthy for at least 20 seconds before the upgrade proceeds to the next upgrade domain).</span></span>  <span data-ttu-id="09d10-166">Establezca también **UpgradeDomainTimeout** en 1200 segundos y **UpgradeTimeout** en 3000 segundos.</span><span class="sxs-lookup"><span data-stu-id="09d10-166">Also set the **UpgradeDomainTimeout** to 1200 seconds and the **UpgradeTimeout** to 3000 seconds.</span></span> <span data-ttu-id="09d10-167">Por último, establezca **UpgradeFailureAction** en **revertir**, que solicita a Service Fabric revertir a aplicación a la versión anterior si se encuentran errores durante la actualización.</span><span class="sxs-lookup"><span data-stu-id="09d10-167">Finally, set the **UpgradeFailureAction** to **rollback**, which requests that Service Fabric rolls back the application to the previous version if failures are encountered during upgrade.</span></span>

<span data-ttu-id="09d10-168">Ahora puede iniciar la actualización de la aplicación con el cmdlet [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="09d10-168">You can now start the application upgrade by using the [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/WordCount -ApplicationTypeVersion 2.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000  -FailureAction Rollback -Monitored
```

<span data-ttu-id="09d10-169">Tenga en cuenta que el nombre de la aplicación es el mismo nombre de la aplicación v1.0.0 implementada anteriormente (fabric:/WordCount).</span><span class="sxs-lookup"><span data-stu-id="09d10-169">Note that the application name is the same as the previously deployed v1.0.0 application name (fabric:/WordCount).</span></span> <span data-ttu-id="09d10-170">Service Fabric usa este nombre para identificar qué aplicación se está actualizando.</span><span class="sxs-lookup"><span data-stu-id="09d10-170">Service Fabric uses this name to identify which application is getting upgraded.</span></span> <span data-ttu-id="09d10-171">Si los tiempos de espera que estableció son demasiado breves, es probable que reciba un mensaje de error de tiempo de espera que indica el problema.</span><span class="sxs-lookup"><span data-stu-id="09d10-171">If you set the time-outs to be too short, you might encounter a time-out failure message that states the problem.</span></span> <span data-ttu-id="09d10-172">Consulte [Solución de problemas de actualizaciones de aplicaciones](service-fabric-application-upgrade-troubleshooting.md)o aumente los tiempos de expiración.</span><span class="sxs-lookup"><span data-stu-id="09d10-172">Refer to [Troubleshoot application upgrades](service-fabric-application-upgrade-troubleshooting.md), or increase the time-outs.</span></span>

### <a name="step-4-check-upgrade-progress"></a><span data-ttu-id="09d10-173">Paso 4: Comprobación del progreso de la actualización</span><span class="sxs-lookup"><span data-stu-id="09d10-173">Step 4: Check upgrade progress</span></span>
<span data-ttu-id="09d10-174">Puede supervisar el progreso de la actualización de la aplicación mediante [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md) o con el cmdlet [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="09d10-174">You can monitor application upgrade progress by using [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md), or by using the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/WordCount
```

<span data-ttu-id="09d10-175">En unos minutos, el cmdlet [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) muestra que se actualizaron (completaron) todos los dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="09d10-175">In a few minutes, the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet shows that all upgrade domains were upgraded (completed).</span></span>

## <a name="task-test-a-service-fabric-application"></a><span data-ttu-id="09d10-176">Tarea: Probar una aplicación de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="09d10-176">Task: Test a Service Fabric application</span></span>
<span data-ttu-id="09d10-177">Para poder escribir servicios de alta calidad, los desarrolladores deben poder inducir errores en infraestructuras no confiables para probar la estabilidad de los servicios.</span><span class="sxs-lookup"><span data-stu-id="09d10-177">To write high-quality services, developers need to be able to induce unreliable infrastructure faults to test the stability of their services.</span></span> <span data-ttu-id="09d10-178">Service Fabric brinda a los desarrolladores la capacidad de inducir acciones de error y probar los servicios en caso de errores mediante el uso de escenarios de prueba en caso de caos y conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="09d10-178">Service Fabric gives developers the ability to induce fault actions and test services in the presence of failures by using the chaos and failover test scenarios.</span></span>  <span data-ttu-id="09d10-179">Consulte [Introducción al servicio de análisis de errores](service-fabric-testability-overview.md) para más información.</span><span class="sxs-lookup"><span data-stu-id="09d10-179">Read through [Introduction to the Fault Analysis Service](service-fabric-testability-overview.md) for additional information.</span></span>

### <a name="step-1-run-the-chaos-test-scenario"></a><span data-ttu-id="09d10-180">Paso 1: ejecute el escenario de prueba de caos</span><span class="sxs-lookup"><span data-stu-id="09d10-180">Step 1: Run the chaos test scenario</span></span>
<span data-ttu-id="09d10-181">El escenario de caos genera errores en todo el clúster de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="09d10-181">The chaos test scenario generates faults across the entire Service Fabric cluster.</span></span> <span data-ttu-id="09d10-182">El escenario comprime los errores que se ven por lo general durante meses o años en unas pocas horas.</span><span class="sxs-lookup"><span data-stu-id="09d10-182">The scenario compresses faults generally seen over months or years to a few hours.</span></span> <span data-ttu-id="09d10-183">Esta combinación de errores intercalados con una elevada tasa de errores encuentra casos excepcionales que de otra manera pasan desapercibidos.</span><span class="sxs-lookup"><span data-stu-id="09d10-183">The combination of interleaved faults with a high fault rate finds corner cases that would otherwise be missed.</span></span> <span data-ttu-id="09d10-184">El ejemplo siguiente ejecuta el escenario de prueba de caos durante 60 segundos.</span><span class="sxs-lookup"><span data-stu-id="09d10-184">The following example runs the chaos test scenario for 60 minutes.</span></span>

```powershell
$timeToRun = 60
$maxStabilizationTimeSecs = 180
$concurrentFaults = 3
$waitTimeBetweenIterationsSec = 60

Invoke-ServiceFabricChaosTestScenario -TimeToRunMinute $timeToRun -MaxClusterStabilizationTimeoutSec $maxStabilizationTimeSecs -MaxConcurrentFaults $concurrentFaults -EnableMoveReplicaFaults -WaitTimeBetweenIterationsSec $waitTimeBetweenIterationsSec
```

### <a name="step-2-run-the-failover-test-scenario"></a><span data-ttu-id="09d10-185">Paso 2: ejecute el escenario de prueba de conmutación por error</span><span class="sxs-lookup"><span data-stu-id="09d10-185">Step 2: Run the failover test scenario</span></span>
<span data-ttu-id="09d10-186">El escenario de prueba de conmutación por error tiene como destino una partición específica del servicio, en lugar de todo el clúster, y no afecta los demás servicios.</span><span class="sxs-lookup"><span data-stu-id="09d10-186">The failover test scenario targets a specific service partition instead of the entire cluster, and it leaves other services unaffected.</span></span> <span data-ttu-id="09d10-187">El escenario se itera por una secuencia de errores simulados en la validación de servicios mientras se ejecuta la lógica de negocios.</span><span class="sxs-lookup"><span data-stu-id="09d10-187">The scenario iterates through a sequence of simulated faults in service validation while your business logic runs.</span></span> <span data-ttu-id="09d10-188">Un error en la validación de servicio indica un problema que necesita más investigación.</span><span class="sxs-lookup"><span data-stu-id="09d10-188">A failure in service validation indicates an issue that needs further investigation.</span></span> <span data-ttu-id="09d10-189">La prueba de conmutación por error solo induce un error a la vez, en oposición a lo que ocurre con el escenario de prueba de caos, el que puede inducir varios errores.</span><span class="sxs-lookup"><span data-stu-id="09d10-189">The failover test induces only one fault at a time, as opposed to the chaos test scenario, which can induce multiple faults.</span></span> <span data-ttu-id="09d10-190">En el ejemplo siguiente se ejecuta la prueba de conmutación por error durante 60 minutos en el servicio fabric:/WordCount/WordCountService.</span><span class="sxs-lookup"><span data-stu-id="09d10-190">The following example runs the failover test for 60 minutes against the fabric:/WordCount/WordCountService service.</span></span>

```powershell
$timeToRun = 60
$maxStabilizationTimeSecs = 180
$waitTimeBetweenFaultsSec = 10
$serviceName = "fabric:/WordCount/WordCountService"

Invoke-ServiceFabricFailoverTestScenario -TimeToRunMinute $timeToRun -MaxServiceStabilizationTimeoutSec $maxStabilizationTimeSecs -WaitTimeBetweenFaultsSec $waitTimeBetweenFaultsSec -ServiceName $serviceName -PartitionKindUniformInt64 -PartitionKey 1
```

## <a name="task-remove-a-service-fabric-application"></a><span data-ttu-id="09d10-191">Tarea: Quitar una aplicación de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="09d10-191">Task: Remove a Service Fabric application</span></span>
<span data-ttu-id="09d10-192">Puede eliminar una instancia de una aplicación implementada, quitar el tipo de aplicación aprovisionada del clúster y quitar el paquete de aplicación del almacén de imágenes.</span><span class="sxs-lookup"><span data-stu-id="09d10-192">You can delete an instance of a deployed application, remove the provisioned application type from the cluster, and remove the application package from the ImageStore.</span></span>

### <a name="step-1-remove-an-application-instance"></a><span data-ttu-id="09d10-193">Paso 1: quite una instancia de aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-193">Step 1: Remove an application instance</span></span>
<span data-ttu-id="09d10-194">Cuando ya no se necesite una instancia de aplicación, use el cmdlet [Remove-ServiceFabricApplication](/powershell/module/servicefabric/remove-servicefabricapplication?view=azureservicefabricps) para quitarla de manera permanente.</span><span class="sxs-lookup"><span data-stu-id="09d10-194">When an application instance is no longer needed, you can permanently remove it by using the [Remove-ServiceFabricApplication](/powershell/module/servicefabric/remove-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span> <span data-ttu-id="09d10-195">De esta manera también se quitarán automáticamente todos los servicios que pertenecen a la aplicación, eliminando de forma permanente todos los estados de servicio.</span><span class="sxs-lookup"><span data-stu-id="09d10-195">This also automatically removes all services belonging to the application, permanently removing all service state.</span></span> <span data-ttu-id="09d10-196">No se puede deshacer esta operación y no se puede recuperar el estado de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="09d10-196">This operation cannot be reversed and application state cannot be recovered.</span></span>

```powershell
Remove-ServiceFabricApplication fabric:/WordCount
```

### <a name="step-2-unregister-the-application-type"></a><span data-ttu-id="09d10-197">Paso 2: anule el registro del tipo de aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-197">Step 2: Unregister the application type</span></span>
<span data-ttu-id="09d10-198">Cuando ya no se necesite una versión determinada de un tipo de aplicación, use el cmdlet [Unregister-ServiceFabricApplicationType](/powershell/module/servicefabric/unregister-servicefabricapplicationtype?view=azureservicefabricps) para anular el registro.</span><span class="sxs-lookup"><span data-stu-id="09d10-198">When you no longer need a particular version of an application type, unregister it by using the [Unregister-ServiceFabricApplicationType](/powershell/module/servicefabric/unregister-servicefabricapplicationtype?view=azureservicefabricps) cmdlet.</span></span> <span data-ttu-id="09d10-199">Anular el registro de tipos no usados libera espacio de almacenamiento que usa el paquete de aplicación en el almacén de imágenes.</span><span class="sxs-lookup"><span data-stu-id="09d10-199">Unregistering unused types releases storage space used by the application package in the image store.</span></span> <span data-ttu-id="09d10-200">No se puede anular el registro de un tipo de aplicación ya que no hay ninguna aplicación con instancias con él o hay actualizaciones de aplicaciones pendientes que hacen referencia a él.</span><span class="sxs-lookup"><span data-stu-id="09d10-200">An application type can be unregistered as long as there are no applications instantiated against it or pending application upgrades referencing it.</span></span>

```powershell
Unregister-ServiceFabricApplicationType WordCount 1.0.0
```

### <a name="step-3-remove-the-application-package"></a><span data-ttu-id="09d10-201">Paso 3: quite el paquete de aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-201">Step 3: Remove the application package</span></span>
<span data-ttu-id="09d10-202">Una vez que se anula el registro del tipo de aplicación, es posible utilizar el cmdlet [Remove-ServiceFabricApplicationPackage](/powershell/module/servicefabric/remove-servicefabricapplicationpackage?view=azureservicefabricps) para quitar el paquete de aplicación del almacén de imágenes.</span><span class="sxs-lookup"><span data-stu-id="09d10-202">After the application type is unregistered, the application package can be removed from the image store by using the [Remove-ServiceFabricApplicationPackage](/powershell/module/servicefabric/remove-servicefabricapplicationpackage?view=azureservicefabricps) cmdlet.</span></span>

```powershell
Remove-ServiceFabricApplicationPackage -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCount
```

## <a name="next-steps"></a><span data-ttu-id="09d10-203">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="09d10-203">Next steps</span></span>
[<span data-ttu-id="09d10-204">Ciclo de vida de la aplicación de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="09d10-204">Service Fabric application lifecycle</span></span>](service-fabric-application-lifecycle.md)

[<span data-ttu-id="09d10-205">Implementar una aplicación</span><span class="sxs-lookup"><span data-stu-id="09d10-205">Deploy an application</span></span>](service-fabric-deploy-remove-applications.md)

[<span data-ttu-id="09d10-206">Actualización de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="09d10-206">Application upgrade</span></span>](service-fabric-application-upgrade.md)

[<span data-ttu-id="09d10-207">Cmdlets de Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="09d10-207">Azure Service Fabric cmdlets</span></span>](/powershell/azure/overview?view=azureservicefabricps)

