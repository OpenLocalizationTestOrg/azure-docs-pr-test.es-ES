---
title: aaaOverview del ciclo de vida de hello Service Fabric confiable de servicios de Azure | Documentos de Microsoft
description: "Obtenga información acerca de los eventos de ciclo de vida distinto de hello en servicios de Service Fabric confiables"
services: Service-Fabric
documentationcenter: java
author: PavanKunapareddyMSFT
manager: timlt
ms.assetid: 
ms.service: Service-Fabric
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/30/2017
ms.author: pakunapa;
ms.openlocfilehash: 6d48c217d12bc5248c2da57b544aac747cecd872
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="reliable-services-lifecycle-overview"></a><span data-ttu-id="04762-103">Información general del ciclo de vida de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="04762-103">Reliable services lifecycle overview</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="04762-104">C# en Windows</span><span class="sxs-lookup"><span data-stu-id="04762-104">C# on Windows</span></span>](service-fabric-reliable-services-lifecycle.md)
> * [<span data-ttu-id="04762-105">Java en Linux</span><span class="sxs-lookup"><span data-stu-id="04762-105">Java on Linux</span></span>](service-fabric-reliable-services-lifecycle-java.md)
>
>

<span data-ttu-id="04762-106">Al pensar en los ciclos de vida de hello de servicios de confianza, conceptos básicos de hello del ciclo de vida de hello son hello más importante.</span><span class="sxs-lookup"><span data-stu-id="04762-106">When thinking about hello lifecycles of Reliable Services, hello basics of hello lifecycle are hello most important.</span></span> <span data-ttu-id="04762-107">En general:</span><span class="sxs-lookup"><span data-stu-id="04762-107">In general:</span></span>

* <span data-ttu-id="04762-108">Durante el inicio:</span><span class="sxs-lookup"><span data-stu-id="04762-108">During Startup</span></span>
  * <span data-ttu-id="04762-109">se construyen los servicios,</span><span class="sxs-lookup"><span data-stu-id="04762-109">Services are constructed</span></span>
  * <span data-ttu-id="04762-110">Tienen un tooconstruct oportunidad y devolver cero o más agentes de escucha</span><span class="sxs-lookup"><span data-stu-id="04762-110">They have an opportunity tooconstruct and return zero or more listeners</span></span>
  * <span data-ttu-id="04762-111">Se abre cualquier agente de escucha devuelta, que permita la comunicación con el servicio de Hola</span><span class="sxs-lookup"><span data-stu-id="04762-111">Any returned listeners are opened, allowing communication with hello service</span></span>
  * <span data-ttu-id="04762-112">se denomina método de Coredispatcher del servicio de Hello, permitiendo Hola toodo de servicio de larga ejecución o trabajo en segundo plano</span><span class="sxs-lookup"><span data-stu-id="04762-112">hello Service's runAsync method is called, allowing hello service toodo long running or background work</span></span>
* <span data-ttu-id="04762-113">Durante el cierre:</span><span class="sxs-lookup"><span data-stu-id="04762-113">During shutdown</span></span>
  * <span data-ttu-id="04762-114">toorunAsync pasado token Hola de cancelación se cancela y se cierran los agentes de escucha de Hola</span><span class="sxs-lookup"><span data-stu-id="04762-114">hello cancellation token passed toorunAsync is canceled, and hello listeners are closed</span></span>
  * <span data-ttu-id="04762-115">Una vez completado, se destruye propio objeto de servicio Hola</span><span class="sxs-lookup"><span data-stu-id="04762-115">Once that is complete, hello service object itself is destructed</span></span>

<span data-ttu-id="04762-116">No hay información alrededor de hello exacto de orden de estos eventos.</span><span class="sxs-lookup"><span data-stu-id="04762-116">There are details around hello exact ordering of these events.</span></span> <span data-ttu-id="04762-117">En concreto, orden de Hola de eventos puede cambiar ligeramente dependiendo de si Hola servicio confiable es Stateless o con estado.</span><span class="sxs-lookup"><span data-stu-id="04762-117">In particular, hello order of events may change slightly depending on whether hello Reliable Service is Stateless or Stateful.</span></span> <span data-ttu-id="04762-118">Además, los servicios con estado, tenemos toodeal con el escenario de intercambio principal Hola.</span><span class="sxs-lookup"><span data-stu-id="04762-118">In addition, for stateful services, we have toodeal with hello Primary swap scenario.</span></span> <span data-ttu-id="04762-119">Durante esta secuencia, rol de Hola de principal es tooanother transfieren réplica (o vuelve a estar) sin el servicio de Hola que se va a cerrar.</span><span class="sxs-lookup"><span data-stu-id="04762-119">During this sequence, hello role of Primary is transferred tooanother replica (or comes back) without hello service shutting down.</span></span> <span data-ttu-id="04762-120">Por último, tenemos toothink acerca de las condiciones de error o un error.</span><span class="sxs-lookup"><span data-stu-id="04762-120">Finally, we have toothink about error or failure conditions.</span></span>

## <a name="stateless-service-startup"></a><span data-ttu-id="04762-121">Inicio de un servicio sin estado</span><span class="sxs-lookup"><span data-stu-id="04762-121">Stateless service startup</span></span>
<span data-ttu-id="04762-122">ciclo de vida de Hola de un servicio sin estado es bastante sencilla.</span><span class="sxs-lookup"><span data-stu-id="04762-122">hello lifecycle of a stateless service is fairly straightforward.</span></span> <span data-ttu-id="04762-123">Este es el orden Hola de eventos:</span><span class="sxs-lookup"><span data-stu-id="04762-123">Here's hello order of events:</span></span>

1. <span data-ttu-id="04762-124">Hola se construye servicio</span><span class="sxs-lookup"><span data-stu-id="04762-124">hello Service is constructed</span></span>
2. <span data-ttu-id="04762-125">A continuación, suceden dos cosas simultáneamente:</span><span class="sxs-lookup"><span data-stu-id="04762-125">Then, in parallel two things happen:</span></span>
    - <span data-ttu-id="04762-126">Se invoca `StatelessService.createServiceInstanceListeners()` y se abren los agentes de escucha devueltos (se llama a `CommunicationListener.openAsync()` en cada agente de escucha).</span><span class="sxs-lookup"><span data-stu-id="04762-126">`StatelessService.createServiceInstanceListeners()` is invoked and any returned listeners are Opened (`CommunicationListener.openAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="04762-127">Hola Coredispatcher método servicio (`StatelessService.runAsync()`) se llama</span><span class="sxs-lookup"><span data-stu-id="04762-127">hello service's runAsync method (`StatelessService.runAsync()`) is called</span></span>
3. <span data-ttu-id="04762-128">Si está presente, se llama el método onOpenAsync de hello del servicio (en concreto, `StatelessService.onOpenAsync()` se llama.</span><span class="sxs-lookup"><span data-stu-id="04762-128">If present, hello service's own onOpenAsync method is called (Specifically, `StatelessService.onOpenAsync()` is called.</span></span> <span data-ttu-id="04762-129">Se trata de una invalidación poco habitual, pero está disponible).</span><span class="sxs-lookup"><span data-stu-id="04762-129">This is an uncommon override but it is available).</span></span>

<span data-ttu-id="04762-130">Es importante toonote que no hay ningún orden entre Hola llamadas toocreate y agentes de escucha de hello abierto y Coredispatcher.</span><span class="sxs-lookup"><span data-stu-id="04762-130">It is important toonote that there is no ordering between hello calls toocreate and open hello listeners and runAsync.</span></span> <span data-ttu-id="04762-131">pueden abrir los agentes de escucha de Hola antes de inicia la Coredispatcher.</span><span class="sxs-lookup"><span data-stu-id="04762-131">hello listeners may open before runAsync is started.</span></span> <span data-ttu-id="04762-132">De forma similar, Coredispatcher terminen invoca antes de que los agentes de escucha de comunicación de hello están abiertos o incluso construidos.</span><span class="sxs-lookup"><span data-stu-id="04762-132">Similarly, runAsync may end up invoked before hello communication listeners are open or have even been constructed.</span></span> <span data-ttu-id="04762-133">Si no se necesita ninguna sincronización, se deja como ejercicio toohello implementador.</span><span class="sxs-lookup"><span data-stu-id="04762-133">If any synchronization is required, it is left as an exercise toohello implementer.</span></span> <span data-ttu-id="04762-134">Soluciones comunes:</span><span class="sxs-lookup"><span data-stu-id="04762-134">Common solutions:</span></span>

* <span data-ttu-id="04762-135">En ocasiones, los agentes de escucha no pueden funcionar hasta que se crea otra información o se realiza un trabajo.</span><span class="sxs-lookup"><span data-stu-id="04762-135">Sometimes listeners can't function until some other information is created or work done.</span></span> <span data-ttu-id="04762-136">Para los servicios sin estado que trabajo normalmente se puede realizar en el constructor del servicio de hello, durante hello `createServiceInstanceListeners()` llamar a, o como parte de la construcción de Hola de hello propio agente de escucha.</span><span class="sxs-lookup"><span data-stu-id="04762-136">For stateless services that work can usually be done in hello service's constructor, during hello `createServiceInstanceListeners()` call, or as a part of hello construction of hello listener itself.</span></span>
* <span data-ttu-id="04762-137">A veces hello código en Coredispatcher no quiere toostart hasta que los agentes de escucha de hello están abiertos.</span><span class="sxs-lookup"><span data-stu-id="04762-137">Sometimes hello code in runAsync does not want toostart until hello listeners are open.</span></span> <span data-ttu-id="04762-138">En este caso, hace falta coordinación adicional.</span><span class="sxs-lookup"><span data-stu-id="04762-138">In this case additional coordination is necessary.</span></span> <span data-ttu-id="04762-139">Una solución habitual es algunos marca dentro de los agentes de escucha hello, que indica cuándo ha completado, que se comprueba en Coredispatcher antes de continuar el trabajo de tooactual.</span><span class="sxs-lookup"><span data-stu-id="04762-139">One common solution is some flag within hello listeners indicating when they have completed, which is checked in runAsync before continuing tooactual work.</span></span>

## <a name="stateless-service-shutdown"></a><span data-ttu-id="04762-140">Cierre de un servicio sin estado</span><span class="sxs-lookup"><span data-stu-id="04762-140">Stateless service shutdown</span></span>
<span data-ttu-id="04762-141">Cuando se va a cerrar un servicio sin estado, Hola se sigue el mismo patrón, solo en orden inverso:</span><span class="sxs-lookup"><span data-stu-id="04762-141">When shutting down a stateless service, hello same pattern is followed, just in reverse:</span></span>

1. <span data-ttu-id="04762-142">En paralelo</span><span class="sxs-lookup"><span data-stu-id="04762-142">In parallel</span></span>
    - <span data-ttu-id="04762-143">Se cierran todos los agentes de escucha abiertos (se llama a `CommunicationListener.closeAsync()` en cada agente de escucha)</span><span class="sxs-lookup"><span data-stu-id="04762-143">Any open listeners are Closed (`CommunicationListener.closeAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="04762-144">token de cancelación de Hello pasa demasiado`runAsync()` se cancela (comprobación del token de cancelación de hello `isCancelled` propiedad devuelve true y si se llama del token de hello `throwIfCancellationRequested` método inicie una excepción un `CancellationException`)</span><span class="sxs-lookup"><span data-stu-id="04762-144">hello cancellation token passed too`runAsync()` is canceled (checking hello cancellation token's `isCancelled` property returns true, and if called hello token's `throwIfCancellationRequested` method throws a `CancellationException`)</span></span>
2. <span data-ttu-id="04762-145">Una vez `closeAsync()` completa en cada agente de escucha y `runAsync()` también completa, del servicio de hello `StatelessService.onCloseAsync()` se llama el método, si está presente (nuevo es una invalidación raro).</span><span class="sxs-lookup"><span data-stu-id="04762-145">Once `closeAsync()` completes on each listener and `runAsync()` also completes, hello service's `StatelessService.onCloseAsync()` method is called, if present (again this is an uncommon override).</span></span>
3. <span data-ttu-id="04762-146">Después de `StatelessService.onCloseAsync()` completa, se destruye el objeto de servicio de Hola</span><span class="sxs-lookup"><span data-stu-id="04762-146">After `StatelessService.onCloseAsync()` completes, hello service object is destructed</span></span>

## <a name="notes-on-service-lifecycle"></a><span data-ttu-id="04762-147">Notas sobre el ciclo de vida del servicio</span><span class="sxs-lookup"><span data-stu-id="04762-147">Notes on service lifecycle</span></span>
* <span data-ttu-id="04762-148">Ambos hello `runAsync()` hello y método `createServiceInstanceListeners` llamadas son opcionales.</span><span class="sxs-lookup"><span data-stu-id="04762-148">Both hello `runAsync()` method and hello `createServiceInstanceListeners` calls are optional.</span></span> <span data-ttu-id="04762-149">Un servicio puede tener uno, ambos o ninguno.</span><span class="sxs-lookup"><span data-stu-id="04762-149">A service may have one of them, both, or neither.</span></span> <span data-ttu-id="04762-150">Por ejemplo, si servicio Hola hace todo el trabajo en las llamadas de toouser de respuesta, no es necesario para el mismo tooimplement `runAsync()`.</span><span class="sxs-lookup"><span data-stu-id="04762-150">For example, if hello service does all its work in response toouser calls, there is no need for it tooimplement `runAsync()`.</span></span> <span data-ttu-id="04762-151">Es necesario solo escuchas de comunicación de Hola y su código asociado.</span><span class="sxs-lookup"><span data-stu-id="04762-151">Only hello communication listeners and their associated code are necessary.</span></span> <span data-ttu-id="04762-152">Del mismo modo, crear y devolver los agentes de escucha de comunicación es opcional, como servicio de hello puede tener solo fondo toodo de trabajo y por lo que solo necesita tooimplement`runAsync()`</span><span class="sxs-lookup"><span data-stu-id="04762-152">Similarly, creating and returning communication listeners is optional, as hello service may have only background work toodo, and so only needs tooimplement `runAsync()`</span></span>
* <span data-ttu-id="04762-153">Es válido para un servicio toocomplete `runAsync()` correctamente y vuelva a partir de él.</span><span class="sxs-lookup"><span data-stu-id="04762-153">It is valid for a service toocomplete `runAsync()` successfully and return from it.</span></span> <span data-ttu-id="04762-154">Esto no se considera una condición de error y representaría el trabajo en segundo plano de la realización de servicio de Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="04762-154">This is not considered a failure condition and would represent hello background work of hello service completing.</span></span> <span data-ttu-id="04762-155">Para los servicios de confianza con estado `runAsync()` se denominaría nuevo si servicio de Hola se degrada de principal y, a continuación, promocionar tooprimary atrás.</span><span class="sxs-lookup"><span data-stu-id="04762-155">For stateful reliable services `runAsync()` would be called again if hello service were demoted from primary and then promoted back tooprimary.</span></span>
* <span data-ttu-id="04762-156">Si sale de un servicio de `runAsync()` iniciando una excepción inesperada, se trata de un error y se cierra el objeto de servicio de Hola y notifica un error de estado.</span><span class="sxs-lookup"><span data-stu-id="04762-156">If a service exits from `runAsync()` by throwing some unexpected exception, this is a failure and hello service object is shut down and a health error reported.</span></span>
* <span data-ttu-id="04762-157">Aunque no hay ningún límite de tiempo en la devolución de estos métodos, se pierde inmediatamente toowrite de capacidad de hello y, por tanto, no se puede completar cualquier trabajo real.</span><span class="sxs-lookup"><span data-stu-id="04762-157">While there is no time limit on returning from these methods, you immediately lose hello ability toowrite and therefore cannot complete any real work.</span></span> <span data-ttu-id="04762-158">Se recomienda que vuelva tan pronto como sea posible tras la recepción de solicitud de cancelación de Hola.</span><span class="sxs-lookup"><span data-stu-id="04762-158">It is recommended that you return as quickly as possible upon receiving hello cancellation request.</span></span> <span data-ttu-id="04762-159">Si el servicio no responde toothese API llamadas en un período razonable de tiempo que Service Fabric forzosamente puede finalizar su servicio.</span><span class="sxs-lookup"><span data-stu-id="04762-159">If your service does not respond toothese API calls in a reasonable amount of time Service Fabric may forcibly terminate your service.</span></span> <span data-ttu-id="04762-160">Esto solo suele pasar durante las actualizaciones de aplicación o cuando se elimina un servicio.</span><span class="sxs-lookup"><span data-stu-id="04762-160">Usually this only happens during application upgrades or when a service is being deleted.</span></span> <span data-ttu-id="04762-161">Este tiempo de espera es de 15 minutos de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="04762-161">This timeout is 15 minutes by default.</span></span>
* <span data-ttu-id="04762-162">Errores en hello `onCloseAsync()` resultado de la ruta de acceso en `onAbort()` que se la llame que es una oportunidad de mejor esfuerzo de última oportunidad para hello servicio tooclean seguridad y liberar cualquier recurso que ha solicitado.</span><span class="sxs-lookup"><span data-stu-id="04762-162">Failures in hello `onCloseAsync()` path result in `onAbort()` being called which is a last-chance best-effort opportunity for hello service tooclean up and release any resources that they have claimed.</span></span>

> [!NOTE]
> <span data-ttu-id="04762-163">Las instancias con estado de Reliable Services aún no se admiten en Java.</span><span class="sxs-lookup"><span data-stu-id="04762-163">Stateful reliable services are not supported in java yet.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="04762-164">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="04762-164">Next steps</span></span>
* [<span data-ttu-id="04762-165">Servicios de tooReliable de introducción</span><span class="sxs-lookup"><span data-stu-id="04762-165">Introduction tooReliable Services</span></span>](service-fabric-reliable-services-introduction.md)
* [<span data-ttu-id="04762-166">Introducción a Reliable Services de Service Fabric de Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="04762-166">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
* [<span data-ttu-id="04762-167">Uso avanzado de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="04762-167">Reliable Services advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)
