---
title: "carga de Azure microservicio aaaManage con métricas | Documentos de Microsoft"
description: "Obtenga información acerca de cómo las métricas de tooconfigure y el uso de Service Fabric toomanage el consumo de recursos del servicio."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 0d622ea6-a7c7-4bef-886b-06e6b85a97fb
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 592dc749ce30683a1e439a702b7d0dc0a638276f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="managing-resource-consumption-and-load-in-service-fabric-with-metrics"></a><span data-ttu-id="1c9ac-103">Administración de consumo y carga de recursos en Service Fabric con métricas</span><span class="sxs-lookup"><span data-stu-id="1c9ac-103">Managing resource consumption and load in Service Fabric with metrics</span></span>
<span data-ttu-id="1c9ac-104">*Las métricas* son recursos de Hola que su ocuparse de servicios y que se proporcionan con nodos de hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-104">*Metrics* are hello resources that your services care about and which are provided by hello nodes in hello cluster.</span></span> <span data-ttu-id="1c9ac-105">Una métrica es todo lo que desea que toomanage en rendimiento de Hola de orden tooimprove o el monitor de los servicios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-105">A metric is anything that you want toomanage in order tooimprove or monitor hello performance of your services.</span></span> <span data-ttu-id="1c9ac-106">Por ejemplo, podría observar tooknow de consumo de memoria si el servicio está sobrecargado.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-106">For example, you might watch memory consumption tooknow if your service is overloaded.</span></span> <span data-ttu-id="1c9ac-107">Otro uso es toofigure out podría mover servicio hello en otro lugar que la memoria es que menos restringida a un mejor rendimiento de orden tooget.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-107">Another use is toofigure out whether hello service could move elsewhere where memory is less constrained in order tooget better performance.</span></span>

<span data-ttu-id="1c9ac-108">Las métricas son, por ejemplo, memoria, disco y uso de CPU.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-108">Things like Memory, Disk, and CPU usage are examples of metrics.</span></span> <span data-ttu-id="1c9ac-109">Estas métricas son métricas físicas, recursos que corresponden toophysical recursos en el nodo de Hola que necesitan toobe administrado.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-109">These metrics are physical metrics, resources that correspond toophysical resources on hello node that need toobe managed.</span></span> <span data-ttu-id="1c9ac-110">Las métricas también pueden ser (y normalmente son) métricas lógicas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-110">Metrics can also be (and commonly are) logical metrics.</span></span> <span data-ttu-id="1c9ac-111">Las métricas lógicas son, por ejemplo, "MyWorkQueueDepth", "MessagesToProcess" o "TotalRecords".</span><span class="sxs-lookup"><span data-stu-id="1c9ac-111">Logical metrics are things like “MyWorkQueueDepth” or "MessagesToProcess" or "TotalRecords".</span></span> <span data-ttu-id="1c9ac-112">Métricas lógicas son definidos por la aplicación e indirectamente corresponden toosome el consumo de recursos físicos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-112">Logical metrics are application-defined and indirectly correspond toosome physical resource consumption.</span></span> <span data-ttu-id="1c9ac-113">Las métricas lógicas son comunes porque puede ser toomeasure de disco duro y de informes la utilización de recursos físicos por servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-113">Logical metrics are common because it can be hard toomeasure and report consumption of physical resources on a per-service basis.</span></span> <span data-ttu-id="1c9ac-114">complejidad de Hola de valorar e informar sobre sus propias métricas físicos también es ¿por qué Service Fabric proporciona algunas métricas de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-114">hello complexity of measuring and reporting your own physical metrics is also why Service Fabric provides some default metrics.</span></span>

## <a name="default-metrics"></a><span data-ttu-id="1c9ac-115">Métricas predeterminadas</span><span class="sxs-lookup"><span data-stu-id="1c9ac-115">Default metrics</span></span>
<span data-ttu-id="1c9ac-116">Supongamos que desea tooget iniciado escribir e implementar su servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-116">Let’s say that you want tooget started writing and deploying your service.</span></span> <span data-ttu-id="1c9ac-117">En este momento no sabe qué recursos físicos o lógicos consume.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-117">At this point you don’t know what physical or logical resources it consumes.</span></span> <span data-ttu-id="1c9ac-118">¡Eso está bien!</span><span class="sxs-lookup"><span data-stu-id="1c9ac-118">That’s fine!</span></span> <span data-ttu-id="1c9ac-119">Hola, Administrador de recursos de clúster de tejido de servicio utiliza algunas métricas de forma predeterminada cuando no se especifican ningún otras métricas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-119">hello Service Fabric Cluster Resource Manager uses some default metrics when no other metrics are specified.</span></span> <span data-ttu-id="1c9ac-120">Son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-120">They are:</span></span>

  - <span data-ttu-id="1c9ac-121">PrimaryCount - recuento de las réplicas principales en el nodo de Hola</span><span class="sxs-lookup"><span data-stu-id="1c9ac-121">PrimaryCount - count of Primary replicas on hello node</span></span> 
  - <span data-ttu-id="1c9ac-122">ReplicaCount - número de réplicas con estado total en el nodo de Hola</span><span class="sxs-lookup"><span data-stu-id="1c9ac-122">ReplicaCount - count of total stateful replicas on hello node</span></span>
  - <span data-ttu-id="1c9ac-123">Recuento: recuento de todos los objetos de servicio (con y sin estado) en el nodo de Hola</span><span class="sxs-lookup"><span data-stu-id="1c9ac-123">Count - count of all service objects (stateless and stateful) on hello node</span></span>

| <span data-ttu-id="1c9ac-124">Métrica</span><span class="sxs-lookup"><span data-stu-id="1c9ac-124">Metric</span></span> | <span data-ttu-id="1c9ac-125">Carga de instancia sin estado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-125">Stateless Instance Load</span></span> | <span data-ttu-id="1c9ac-126">Carga secundaria con estado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-126">Stateful Secondary Load</span></span> | <span data-ttu-id="1c9ac-127">Carga principal con estado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-127">Stateful Primary Load</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="1c9ac-128">PrimaryCount</span><span class="sxs-lookup"><span data-stu-id="1c9ac-128">PrimaryCount</span></span> |<span data-ttu-id="1c9ac-129">0</span><span class="sxs-lookup"><span data-stu-id="1c9ac-129">0</span></span> |<span data-ttu-id="1c9ac-130">0</span><span class="sxs-lookup"><span data-stu-id="1c9ac-130">0</span></span> |<span data-ttu-id="1c9ac-131">1</span><span class="sxs-lookup"><span data-stu-id="1c9ac-131">1</span></span> |
| <span data-ttu-id="1c9ac-132">ReplicaCount</span><span class="sxs-lookup"><span data-stu-id="1c9ac-132">ReplicaCount</span></span> |<span data-ttu-id="1c9ac-133">0</span><span class="sxs-lookup"><span data-stu-id="1c9ac-133">0</span></span> |<span data-ttu-id="1c9ac-134">1</span><span class="sxs-lookup"><span data-stu-id="1c9ac-134">1</span></span> |<span data-ttu-id="1c9ac-135">1</span><span class="sxs-lookup"><span data-stu-id="1c9ac-135">1</span></span> |
| <span data-ttu-id="1c9ac-136">Recuento</span><span class="sxs-lookup"><span data-stu-id="1c9ac-136">Count</span></span> |<span data-ttu-id="1c9ac-137">1</span><span class="sxs-lookup"><span data-stu-id="1c9ac-137">1</span></span> |<span data-ttu-id="1c9ac-138">1</span><span class="sxs-lookup"><span data-stu-id="1c9ac-138">1</span></span> |<span data-ttu-id="1c9ac-139">1</span><span class="sxs-lookup"><span data-stu-id="1c9ac-139">1</span></span> |

<span data-ttu-id="1c9ac-140">Para las cargas de trabajo básicos, Hola predeterminado que proporcionan una distribución decente de trabajo en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-140">For basic workloads, hello default metrics provide a decent distribution of work in hello cluster.</span></span> <span data-ttu-id="1c9ac-141">En el siguiente ejemplo de Hola, veamos qué sucede cuando se crea dos servicios y se basan en las métricas de predeterminado de hello para el equilibrio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-141">In hello following example, let’s see what happens when we create two services and rely on hello default metrics for balancing.</span></span> <span data-ttu-id="1c9ac-142">Hola primer servicio es un servicio con estado con tres particiones y una réplica de destino establece tamaño de tres.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-142">hello first service is a stateful service with three partitions and a target replica set size of three.</span></span> <span data-ttu-id="1c9ac-143">segundo servicio de Hello es un servicio sin estado con una partición y un recuento de instancias de tres.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-143">hello second service is a stateless service with one partition and an instance count of three.</span></span>

<span data-ttu-id="1c9ac-144">Esto es lo que obtiene:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-144">Here's what you get:</span></span>

<span data-ttu-id="1c9ac-145"><center>
![Diseño de clúster con métricas predeterminadas][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="1c9ac-145"><center>
![Cluster Layout with Default Metrics][Image1]
</center></span></span>

<span data-ttu-id="1c9ac-146">Algunos toonote cosas:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-146">Some things toonote:</span></span>
  - <span data-ttu-id="1c9ac-147">Las réplicas principales de servicio con estado Hola se distribuyen entre varios nodos</span><span class="sxs-lookup"><span data-stu-id="1c9ac-147">Primary replicas for hello stateful service are distributed across several nodes</span></span>
  - <span data-ttu-id="1c9ac-148">Réplicas de la misma partición que se encuentran en distintos nodos de Hola</span><span class="sxs-lookup"><span data-stu-id="1c9ac-148">Replicas for hello same partition are on different nodes</span></span>
  - <span data-ttu-id="1c9ac-149">número total de Hola de entidades principales y secundarias se distribuye en clúster de Hola</span><span class="sxs-lookup"><span data-stu-id="1c9ac-149">hello total number of primaries and secondaries is distributed in hello cluster</span></span>
  - <span data-ttu-id="1c9ac-150">número total de Hola de objetos de servicio se asigna uniformemente en cada nodo</span><span class="sxs-lookup"><span data-stu-id="1c9ac-150">hello total number of service objects are evenly allocated on each node</span></span>

<span data-ttu-id="1c9ac-151">¡Bien!</span><span class="sxs-lookup"><span data-stu-id="1c9ac-151">Good!</span></span>

<span data-ttu-id="1c9ac-152">las métricas de Hello predeterminada funcionan correctamente como un tutorial de inicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-152">hello default metrics work great as a start.</span></span> <span data-ttu-id="1c9ac-153">Sin embargo, las métricas de hello predeterminada sólo transmitirá se hasta ahora.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-153">However, hello default metrics will only carry you so far.</span></span> <span data-ttu-id="1c9ac-154">Por ejemplo: ¿qué es la probabilidad de Hola Hola particiones esquema que se ha seleccionado resultados perfectamente incluso uso de todas las particiones?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-154">For example: What's hello likelihood that hello partitioning scheme you picked results in perfectly even utilization by all partitions?</span></span> <span data-ttu-id="1c9ac-155">¿Qué es la posibilidad de Hola que Hola carga para un servicio determinado es constante con el tiempo, o incluso simplemente Hola igual en varias particiones ahora?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-155">What’s hello chance that hello load for a given service is constant over time, or even just hello same across multiple partitions right now?</span></span>

<span data-ttu-id="1c9ac-156">Puede ejecutar con solo las métricas de Hola de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-156">You could run with just hello default metrics.</span></span> <span data-ttu-id="1c9ac-157">De todas forma, si lo hace, normalmente significa que la utilización del clúster será inferior y más desigual de lo deseable.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-157">However, doing so usually means that your cluster utilization is lower and more uneven than you’d like.</span></span> <span data-ttu-id="1c9ac-158">Esto es porque las métricas de Hola predeterminado no están adaptables y suponen que todo lo que es equivalente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-158">This is because hello default metrics aren't adaptive and presume everything is equivalent.</span></span> <span data-ttu-id="1c9ac-159">Por ejemplo, un elemento principal que está ocupado y otra que no es both contribuyen "1" toohello PrimaryCount métrica.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-159">For example, a Primary that is busy and one that is not both contribute "1" toohello PrimaryCount metric.</span></span> <span data-ttu-id="1c9ac-160">En hello peor de los casos, también puede producir usar solo las métricas de hello predeterminado en nodos overscheduled lo que da lugar a problemas de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-160">In hello worst case, using only hello default metrics can also result in overscheduled nodes resulting in performance issues.</span></span> <span data-ttu-id="1c9ac-161">Si está interesado en obtener Hola mayoría fuera de su clúster y evitar problemas de rendimiento, debe toouse de métricas personalizadas y los informes de carga dinámica.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-161">If you're interested in getting hello most out of your cluster and avoiding performance issues, you need toouse custom metrics and dynamic load reporting.</span></span>

## <a name="custom-metrics"></a><span data-ttu-id="1c9ac-162">Métricas personalizadas</span><span class="sxs-lookup"><span data-stu-id="1c9ac-162">Custom metrics</span></span>
<span data-ttu-id="1c9ac-163">Las métricas se configuran en por-denominado-service-instancia al crear el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-163">Metrics are configured on a per-named-service-instance basis when you’re creating hello service.</span></span>

<span data-ttu-id="1c9ac-164">Todas las métricas tienen algunas propiedades que las describen: un nombre, un peso y una carga predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-164">Any metric has some properties that describe it: a name, a weight, and a default load.</span></span>

* <span data-ttu-id="1c9ac-165">: Métrica Hola nombre de métrica de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-165">Metric Name: hello name of hello metric.</span></span> <span data-ttu-id="1c9ac-166">nombre de la métrica Hello es un identificador único para la métrica de hello en clúster de Hola desde la perspectiva del Administrador de recursos de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-166">hello metric name is a unique identifier for hello metric within hello cluster from hello Resource Manager’s perspective.</span></span>
* <span data-ttu-id="1c9ac-167">Peso: Peso métrico define la importancia relativa toohello esta medida es otras métricas para este servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-167">Weight: Metric weight defines how important this metric is relative toohello other metrics for this service.</span></span>
* <span data-ttu-id="1c9ac-168">Carga de forma predeterminada: carga de forma predeterminada de hello representado de forma diferente dependiendo de si el servicio de hello es con o sin estado.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-168">Default Load: hello default load is represented differently depending on whether hello service is stateless or stateful.</span></span>
  * <span data-ttu-id="1c9ac-169">Para los servicios sin estado, cada métrica tiene una propiedad única llamada DefaultLoad.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-169">For stateless services, each metric has a single property named DefaultLoad</span></span>
  * <span data-ttu-id="1c9ac-170">Para servicios con estado, se define lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-170">For stateful services you define:</span></span>
    * <span data-ttu-id="1c9ac-171">PrimaryDefaultLoad: cantidad Hola predeterminada de esta métrica que este servicio se utiliza cuando es un elemento principal</span><span class="sxs-lookup"><span data-stu-id="1c9ac-171">PrimaryDefaultLoad: hello default amount of this metric this service consumes when it is a Primary</span></span>
    * <span data-ttu-id="1c9ac-172">SecondaryDefaultLoad: cantidad Hola predeterminada de esta métrica que este servicio se utiliza cuando es un elemento secundario</span><span class="sxs-lookup"><span data-stu-id="1c9ac-172">SecondaryDefaultLoad: hello default amount of this metric this service consumes when it is a Secondary</span></span>

> [!NOTE]
> <span data-ttu-id="1c9ac-173">Si definir métricas personalizadas y desea que las métricas de too_also_ uso Hola predeterminado, deberá too_explicitly_ agregar métricas predeterminadas de hello hacer copia y definen pesos y los valores para ellos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-173">If you define custom metrics and you want too_also_ use hello default metrics, you need too_explicitly_ add hello default metrics back and define weights and values for them.</span></span> <span data-ttu-id="1c9ac-174">Esto es porque debe definir relación Hola entre las métricas de forma predeterminada de Hola y de la métrica personalizada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-174">This is because you must define hello relationship between hello default metrics and your custom metrics.</span></span> <span data-ttu-id="1c9ac-175">Por ejemplo, puede que le preocupen más las métricas ConnectionCount o WorkQueueDepth que las de distribución principal.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-175">For example, maybe you care about ConnectionCount or WorkQueueDepth more than Primary distribution.</span></span> <span data-ttu-id="1c9ac-176">Peso de saludo predeterminado de hello PrimaryCount métrica es alta, por lo que desee tooreduce se tooMedium al agregar los otro tooensure métricas tienen prioridad.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-176">By default hello weight of hello PrimaryCount metric is High, so you want tooreduce it tooMedium when you add your other metrics tooensure they take precedence.</span></span>
>

### <a name="defining-metrics-for-your-service---an-example"></a><span data-ttu-id="1c9ac-177">Definición de las métricas del servicio: ejemplo</span><span class="sxs-lookup"><span data-stu-id="1c9ac-177">Defining metrics for your service - an example</span></span>
<span data-ttu-id="1c9ac-178">Supongamos que desea Hola siguiente configuración:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-178">Let’s say you want hello following configuration:</span></span>

  - <span data-ttu-id="1c9ac-179">El servicio notifica una métrica denominada "ConnectionCount"</span><span class="sxs-lookup"><span data-stu-id="1c9ac-179">Your service reports a metric named "ConnectionCount”</span></span>
  - <span data-ttu-id="1c9ac-180">También puede métricas de toouse Hola predeterminadas</span><span class="sxs-lookup"><span data-stu-id="1c9ac-180">You also want toouse hello default metrics</span></span> 
  - <span data-ttu-id="1c9ac-181">Ha realizado algunas mediciones y sabe que, normalmente, una réplica principal de ese servicio ocupa hasta 20 unidades de "ConnectionCount"</span><span class="sxs-lookup"><span data-stu-id="1c9ac-181">You’ve done some measurements and know that normally a Primary replica of that service takes up 20 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="1c9ac-182">Por su parte las secundarias usan 5 unidades de "ConnectionCount"</span><span class="sxs-lookup"><span data-stu-id="1c9ac-182">Secondaries use 5 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="1c9ac-183">Sepa que "Recuento de conexión" es la métrica más importante de hello en cuanto a la administración del rendimiento de Hola de este servicio en particular</span><span class="sxs-lookup"><span data-stu-id="1c9ac-183">You know that "ConnectionCount" is hello most important metric in terms of managing hello performance of this particular service</span></span>
  - <span data-ttu-id="1c9ac-184">Pero también desea que las réplicas principales estén equilibradas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-184">You still want Primary replicas balanced.</span></span> <span data-ttu-id="1c9ac-185">Mantener el equilibrio de las réplicas principales suele ser siempre una buena idea.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-185">Balancing primary replicas is generally a good idea no matter what.</span></span> <span data-ttu-id="1c9ac-186">Esto ayuda a evitar la pérdida de Hola de algún nodo o error de dominio no afecten a la mayoría de las réplicas principales junto con ella.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-186">This helps prevent hello loss of some node or fault domain from impacting a majority of primary replicas along with it.</span></span> 
  - <span data-ttu-id="1c9ac-187">De lo contrario, son válidas las métricas de saludo predeterminado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-187">Otherwise, hello default metrics are fine</span></span>

<span data-ttu-id="1c9ac-188">Aquí es que habría que escribir toocreate un servicio con el que la configuración de métrica de código de hello:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-188">Here’s hello code that you would write toocreate a service with that metric configuration:</span></span>

<span data-ttu-id="1c9ac-189">Código:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-189">Code:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
StatefulServiceLoadMetricDescription connectionMetric = new StatefulServiceLoadMetricDescription();
connectionMetric.Name = "ConnectionCount";
connectionMetric.PrimaryDefaultLoad = 20;
connectionMetric.SecondaryDefaultLoad = 5;
connectionMetric.Weight = ServiceLoadMetricWeight.High;

StatefulServiceLoadMetricDescription primaryCountMetric = new StatefulServiceLoadMetricDescription();
primaryCountMetric.Name = "PrimaryCount";
primaryCountMetric.PrimaryDefaultLoad = 1;
primaryCountMetric.SecondaryDefaultLoad = 0;
primaryCountMetric.Weight = ServiceLoadMetricWeight.Medium;

StatefulServiceLoadMetricDescription replicaCountMetric = new StatefulServiceLoadMetricDescription();
replicaCountMetric.Name = "ReplicaCount";
replicaCountMetric.PrimaryDefaultLoad = 1;
replicaCountMetric.SecondaryDefaultLoad = 1;
replicaCountMetric.Weight = ServiceLoadMetricWeight.Low;

StatefulServiceLoadMetricDescription totalCountMetric = new StatefulServiceLoadMetricDescription();
totalCountMetric.Name = "Count";
totalCountMetric.PrimaryDefaultLoad = 1;
totalCountMetric.SecondaryDefaultLoad = 1;
totalCountMetric.Weight = ServiceLoadMetricWeight.Low;

serviceDescription.Metrics.Add(connectionMetric);
serviceDescription.Metrics.Add(primaryCountMetric);
serviceDescription.Metrics.Add(replicaCountMetric);
serviceDescription.Metrics.Add(totalCountMetric);

await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="1c9ac-190">Powershell:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-190">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ConnectionCount,High,20,5”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

> [!NOTE]
> <span data-ttu-id="1c9ac-191">Hola por encima de los ejemplos y hello resto de este documento se describen las métricas de administración de forma por con el nombre de servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-191">hello above examples and hello rest of this document describe managing metrics on a per-named-service basis.</span></span> <span data-ttu-id="1c9ac-192">También es posible toodefine métricas para los servicios en el servicio de hello _tipo_ nivel.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-192">It is also possible toodefine metrics for your services at hello service _type_ level.</span></span> <span data-ttu-id="1c9ac-193">Esto se consigue especificándolos en los manifiestos de servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-193">This is accomplished by specifying them in your service manifests.</span></span> <span data-ttu-id="1c9ac-194">No se recomienda definir las métricas de nivel de tipo por varias razones.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-194">Defining type level metrics is not recommended for several reasons.</span></span> <span data-ttu-id="1c9ac-195">primer motivo de Hola es que los nombres de métrica son con frecuencia específica del entorno.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-195">hello first reason is that metric names are frequently environment-specific.</span></span> <span data-ttu-id="1c9ac-196">A menos que haya un contrato firme en su lugar, no puede ser seguro que esa métrica Hola "Núcleos" en un entorno no es "MiliCores" o "Núcleos" en otros.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-196">Unless there is a firm contract in place, you cannot be sure that hello metric "Cores" in one environment isn't "MiliCores" or "CoReS" in others.</span></span> <span data-ttu-id="1c9ac-197">Si las métricas se definen en el manifiesto debe toocreate nuevos manifiestos por cada entorno.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-197">If your metrics are defined in your manifest you need toocreate new manifests per environment.</span></span> <span data-ttu-id="1c9ac-198">Normalmente, esto lleva tooa proliferación de manifiestos diferentes con sólo pequeñas diferencias, lo que pueden provocar problemas de toomanagement.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-198">This usually leads tooa proliferation of different manifests with only minor differences, which can lead toomanagement difficulties.</span></span>  
>
> <span data-ttu-id="1c9ac-199">Las cargas de métricas normalmente se asignan en base a cada instancia de servicio denominado.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-199">Metric loads are commonly assigned on a per-named-service-instance basis.</span></span> <span data-ttu-id="1c9ac-200">Por ejemplo, supongamos que se crea una instancia de hello atenderla para clientea que planes toouse apenas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-200">For example, let's say you create one instance of hello service for CustomerA who plans toouse it only lightly.</span></span> <span data-ttu-id="1c9ac-201">Supongamos también que crea otra instancia para el ClienteB que tiene una mayor carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-201">Let's also say you create another for CustomerB who has a larger workload.</span></span> <span data-ttu-id="1c9ac-202">En este caso, seguramente desearía incluir predeterminado de hello tootweak carga para esos servicios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-202">In this case, you'd probably want tootweak hello default loads for those services.</span></span> <span data-ttu-id="1c9ac-203">Si dispone de las métricas y cargas definidas a través de los manifiestos y desea toosupport este escenario, requiere diferentes aplicaciones y tipos de servicio para cada cliente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-203">If you have metrics and loads defined via manifests and you want toosupport this scenario, it requires different application and service types for each customer.</span></span> <span data-ttu-id="1c9ac-204">valores de Hello definidos en el momento de creación de servicio reemplazan a las definidas en el manifiesto de hello, por lo que podría utilizar esa tooset Hola determinados valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-204">hello values defined at service creation time override those defined in hello manifest, so you could use that tooset hello specific defaults.</span></span> <span data-ttu-id="1c9ac-205">Sin embargo, haciendo produce valores de hello declarados en coincidencia de hello manifiestos toonot con que esos Hola realmente se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-205">However, doing that causes hello values declared in hello manifests toonot match those hello service actually runs with.</span></span> <span data-ttu-id="1c9ac-206">Esto puede provocar tooconfusion.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-206">This can lead tooconfusion.</span></span> 
>

<span data-ttu-id="1c9ac-207">Como recordatorio: si desea que las métricas de toouse Hola de forma predeterminada, no necesita la colección de métricas de hello tootouch en absoluto o hacer nada especial al crear el servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-207">As a reminder: if you just want toouse hello default metrics, you don’t need tootouch hello metrics collection at all or do anything special when creating your service.</span></span> <span data-ttu-id="1c9ac-208">métricas de Hello predeterminadas hacía automáticamente cuando no hay otras se definen.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-208">hello default metrics get used automatically when no others are defined.</span></span> 

<span data-ttu-id="1c9ac-209">Ahora, vamos a analizar cada uno de estos valores con más detalle y hablar acerca del comportamiento de Hola que influye en.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-209">Now, let's go through each of these settings in more detail and talk about hello behavior that it influences.</span></span>

## <a name="load"></a><span data-ttu-id="1c9ac-210">Carga</span><span class="sxs-lookup"><span data-stu-id="1c9ac-210">Load</span></span>
<span data-ttu-id="1c9ac-211">Hola todo punto de definición de métricas es toorepresent cierta carga.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-211">hello whole point of defining metrics is toorepresent some load.</span></span> <span data-ttu-id="1c9ac-212">*Carga* es la cantidad de una determinada métrica que alguna instancia del servicio o réplica consume en un nodo específico.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-212">*Load* is how much of a given metric is consumed by some service instance or replica on a given node.</span></span> <span data-ttu-id="1c9ac-213">El valor Carga puede configurarse prácticamente en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-213">Load can be configured at almost any point.</span></span> <span data-ttu-id="1c9ac-214">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-214">For example:</span></span>

  - <span data-ttu-id="1c9ac-215">Carga se puede definir cuando se crea un servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-215">Load can be defined when a service is created.</span></span> <span data-ttu-id="1c9ac-216">Esto se denomina _carga predeterminada_.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-216">This is called _default load_.</span></span>
  - <span data-ttu-id="1c9ac-217">carga información de métrica de Hello, incluido de forma predeterminada, para un servicio puede actualizar después de crear el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-217">hello metric information, including default loads, for a service can updated after hello service is created.</span></span> <span data-ttu-id="1c9ac-218">Esto se denomina _actualizar un servicio_.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-218">This is called _updating a service_.</span></span> 
  - <span data-ttu-id="1c9ac-219">Hola cargas para una partición determinada pueden ser valores de predeterminado toohello de restablecimiento para ese servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-219">hello loads for a given partition can be reset toohello default values for that service.</span></span> <span data-ttu-id="1c9ac-220">Esto se llama _restablecer la carga de partición_.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-220">This is called _resetting partition load_.</span></span>
  - <span data-ttu-id="1c9ac-221">La carga se puede notificar en base a cada objeto de servicio de forma dinámica durante el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-221">Load can be reported on a per service object basis dynamically during runtime.</span></span> <span data-ttu-id="1c9ac-222">Esto se denomina _notificar la carga_.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-222">This is called _reporting load_.</span></span> 
  
<span data-ttu-id="1c9ac-223">Todas estas estrategias pueden usarse en hello mismo servicios a través de su duración.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-223">All of these strategies can be used within hello same service over its lifetime.</span></span> 

## <a name="default-load"></a><span data-ttu-id="1c9ac-224">Carga predeterminada</span><span class="sxs-lookup"><span data-stu-id="1c9ac-224">Default load</span></span>
<span data-ttu-id="1c9ac-225">*Carga predeterminada* es la cantidad de métrica de hello consume cada objeto de servicio (instancia sin estado o réplica con estado) de este servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-225">*Default load* is how much of hello metric each service object (stateless instance or stateful replica) of this service consumes.</span></span> <span data-ttu-id="1c9ac-226">Hola, Administrador de recursos del clúster utiliza este número para la carga de Hola Hola de objeto de servicio hasta que recibe otra información, como un informe dinámico de carga.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-226">hello Cluster Resource Manager uses this number for hello load of hello service object until it receives other information, such as a dynamic load report.</span></span> <span data-ttu-id="1c9ac-227">Para los servicios más sencillos, carga predeterminada de hello es una definición estática.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-227">For simpler services, hello default load is a static definition.</span></span> <span data-ttu-id="1c9ac-228">carga de forma predeterminada de Hello nunca se actualiza y se utiliza para vida Hola Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-228">hello default load is never updated and is used for hello lifetime of hello service.</span></span> <span data-ttu-id="1c9ac-229">Valor predeterminado carga funciona bien para planear escenarios donde determinadas cantidades de recursos son cargas de trabajo de toodifferent dedicado y no cambian la capacidad simple.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-229">Default loads works great for simple capacity planning scenarios where certain amounts of resources are dedicated toodifferent workloads and do not change.</span></span>

> [!NOTE]
> <span data-ttu-id="1c9ac-230">Para obtener más información sobre la administración de capacidad y definir las capacidades para nodos de hello en el clúster, vea [este artículo](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span><span class="sxs-lookup"><span data-stu-id="1c9ac-230">For more information on capacity management and defining capacities for hello nodes in your cluster, please see [this article](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span></span>
> 

<span data-ttu-id="1c9ac-231">Hola, Administrador de recursos de clúster permite toospecify de servicios con estado una carga predeterminados diferentes para sus entidades principales y secundarias.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-231">hello Cluster Resource Manager allows stateful services toospecify a different default load for their Primaries and Secondaries.</span></span> <span data-ttu-id="1c9ac-232">Servicios sin estado solo pueden especificar un valor que se aplica a instancias de tooall.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-232">Stateless services can only specify one value that applies tooall instances.</span></span> <span data-ttu-id="1c9ac-233">Para los servicios con estado, carga de hello predeterminado para las réplicas principal y secundaria son normalmente diferentes dado que las réplicas realizar diferentes tipos de trabajo en cada rol.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-233">For stateful services, hello default load for Primary and Secondary replicas are typically different since replicas do different kinds of work in each role.</span></span> <span data-ttu-id="1c9ac-234">Por ejemplo, los elementos normalmente servir lecturas y escrituras y satisfacer la mayoría de carga de cálculo de hello, pero no elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-234">For example, Primaries usually serve both reads and writes, and handle most of hello computational burden, while secondaries do not.</span></span> <span data-ttu-id="1c9ac-235">Carga de hello predeterminado para una réplica principal suele ser mayor que la carga de hello predeterminado para las réplicas secundarias.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-235">Usually hello default load for a primary replica is higher than hello default load for secondary replicas.</span></span> <span data-ttu-id="1c9ac-236">números reales de Hello debe depender de sus propias medidas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-236">hello real numbers should depend on your own measurements.</span></span>

## <a name="dynamic-load"></a><span data-ttu-id="1c9ac-237">Carga dinámica</span><span class="sxs-lookup"><span data-stu-id="1c9ac-237">Dynamic load</span></span>
<span data-ttu-id="1c9ac-238">Supongamos que lleva un tiempo ejecutando el servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-238">Let’s say that you’ve been running your service for a while.</span></span> <span data-ttu-id="1c9ac-239">Con cierta supervisión, habrá observado lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-239">With some monitoring, you’ve noticed that:</span></span>

1. <span data-ttu-id="1c9ac-240">Algunas particiones o instancias de un servicio determinado consumen más recursos que otras.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-240">Some partitions or instances of a given service consume more resources than others</span></span>
2. <span data-ttu-id="1c9ac-241">Algunos servicios tienen cargas que varían con el tiempo.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-241">Some services have load that varies over time.</span></span>

<span data-ttu-id="1c9ac-242">Hay una gran cantidad de cosas que podrían causar estos tipos de fluctuaciones de la carga.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-242">There's lots of things that could cause these types of load fluctuations.</span></span> <span data-ttu-id="1c9ac-243">Por ejemplo, diferentes servicios o particiones están asociadas con diferentes clientes con requisitos diferentes.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-243">For example, different services or partitions are associated with different customers with different requirements.</span></span> <span data-ttu-id="1c9ac-244">También podría cambiar la carga porque cantidad de hello del servicio de trabajo Hola varía con el transcurso de Hola de día de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-244">Load could also change because hello amount of work hello service does varies over hello course of hello day.</span></span> <span data-ttu-id="1c9ac-245">Independientemente del motivo de hello, no suele haber ningún número único que puede usar de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-245">Regardless of hello reason, there’s usually no single number that you can use for default.</span></span> <span data-ttu-id="1c9ac-246">Esto es especialmente cierto si desea tooget Hola mayoría uso fuera del clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-246">This is especially true if you want tooget hello most utilization out of hello cluster.</span></span> <span data-ttu-id="1c9ac-247">Cualquier valor que se toma para carga de forma predeterminada es incorrecto algunos de tiempo de presentación.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-247">Any value you pick for default load is wrong some of hello time.</span></span> <span data-ttu-id="1c9ac-248">Predeterminada incorrecta carga resultados Hola Administrador de recursos de clúster superior o inferior a asignación de recursos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-248">Incorrect default loads result in hello Cluster Resource Manager either over or under allocating resources.</span></span> <span data-ttu-id="1c9ac-249">Como resultado, tiene nodos superior o inferior a su capacidad aunque Hola, Administrador de recursos del clúster se considera clúster Hola está equilibrada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-249">As a result, you have nodes that are over or under utilized even though hello Cluster Resource Manager thinks hello cluster is balanced.</span></span> <span data-ttu-id="1c9ac-250">Las cargas predeterminadas siguen siendo buenas porque proporcionan cierta información para la ubicación inicial, pero no cuentan la historia completa de las cargas de trabajo reales.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-250">Default loads are still good since they provide some information for initial placement, but they're not a complete story for real workloads.</span></span> <span data-ttu-id="1c9ac-251">captura de tooaccurately cambiantes requerimientos de recursos, Hola, Administrador de recursos del clúster permite a cada tooupdate de objeto de servicio su propia carga en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-251">tooaccurately capture changing resource requirements, hello Cluster Resource Manager allows each service object tooupdate its own load during runtime.</span></span> <span data-ttu-id="1c9ac-252">Esto se llama informes de carga dinámica.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-252">This is called dynamic load reporting.</span></span>

<span data-ttu-id="1c9ac-253">Los informes de dinámico de carga permiten tooadjust réplicas o instancias de su carga de las métricas de asignación/notifica largo de su vida.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-253">Dynamic load reports allow replicas or instances tooadjust their allocation/reported load of metrics over their lifetime.</span></span> <span data-ttu-id="1c9ac-254">Normalmente, una instancia o una réplica del servicio que estaba inactiva y sin realizar ningún trabajo informará de que usó poca cantidad de una métrica determinada.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-254">A service replica or instance that was cold and not doing any work would usually report that it was using low amounts of a given metric.</span></span> <span data-ttu-id="1c9ac-255">Una réplica o instancia ocupadas indicarían que están usando más.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-255">A busy replica or instance would report that they are using more.</span></span>

<span data-ttu-id="1c9ac-256">Reporting cargar por instancia o la réplica permite hello tooreorganize del Administrador de recursos del clúster de objetos de servicio individuales de Hola Hola clúster.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-256">Reporting load per replica or instance allows hello Cluster Resource Manager tooreorganize hello individual service objects in hello cluster.</span></span> <span data-ttu-id="1c9ac-257">La reorganización de los servicios de hello le ayuda a asegurarse de que obtienen los recursos de Hola que requieran.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-257">Reorganizing hello services helps ensure that they get hello resources they require.</span></span> <span data-ttu-id="1c9ac-258">Servicios ocupados eficazmente obtener demasiado "reclamar" los recursos de otras réplicas o las instancias que están actualmente frío o menos trabajando.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-258">Busy services effectively get too"reclaim" resources from other replicas or instances that are currently cold or doing less work.</span></span>

<span data-ttu-id="1c9ac-259">Dentro de los servicios de confianza, carga de tooreport de código de hello dinámicamente este aspecto:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-259">Within Reliable Services, hello code tooreport load dynamically looks like this:</span></span>

<span data-ttu-id="1c9ac-260">Código:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-260">Code:</span></span>

```csharp
this.Partition.ReportLoad(new List<LoadMetric> { new LoadMetric("CurrentConnectionCount", 1234), new LoadMetric("metric1", 42) });
```

<span data-ttu-id="1c9ac-261">Un servicio puede informar sobre cualquiera de las métricas de hello definidas para él en tiempo de creación.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-261">A service can report on any of hello metrics defined for it at creation time.</span></span> <span data-ttu-id="1c9ac-262">Si una carga de informes de servicio para una medida que no está configurado toouse, Service Fabric omite ese informe.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-262">If a service reports load for a metric that it is not configured toouse, Service Fabric ignores that report.</span></span> <span data-ttu-id="1c9ac-263">Si hay otras métricas notifican en hello igual que son válidos, se aceptan los informes.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-263">If there are other metrics reported at hello same time that are valid, those reports are accepted.</span></span> <span data-ttu-id="1c9ac-264">Código de servicio puede medir e informar todos Hola métricas que sepa cómo, y los operadores pueden especificar toouse de configuración de métrica de hello sin necesidad de código del servicio toochange Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-264">Service code can measure and report all hello metrics it knows how to, and operators can specify hello metric configuration toouse without having toochange hello service code.</span></span> 

### <a name="updating-a-services-metric-configuration"></a><span data-ttu-id="1c9ac-265">Actualización de la configuración de métrica de un servicio</span><span class="sxs-lookup"><span data-stu-id="1c9ac-265">Updating a service's metric configuration</span></span>
<span data-ttu-id="1c9ac-266">asociada la lista de Hola de métricas con el servicio de Hola y Hola propiedades de esas métricas se pueden actualizar dinámicamente mientras el servicio de hello está activo.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-266">hello list of metrics associated with hello service, and hello properties of those metrics can be updated dynamically while hello service is live.</span></span> <span data-ttu-id="1c9ac-267">Esto permite experimentación y flexibilidad.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-267">This allows for experimentation and flexibility.</span></span> <span data-ttu-id="1c9ac-268">Algunos ejemplos de cuándo esto resulta útil son:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-268">Some examples of when this is useful are:</span></span>

  - <span data-ttu-id="1c9ac-269">deshabilitación de una métrica con un informe con errores para un servicio determinado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-269">disabling a metric with a buggy report for a particular service</span></span>
  - <span data-ttu-id="1c9ac-270">volver a configurar pesos Hola de métricas adicionales basadas en el comportamiento deseado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-270">reconfiguring hello weights of metrics based on desired behavior</span></span>
  - <span data-ttu-id="1c9ac-271">Si se habilita una nueva métrica solo código de hello ya se hayan implementado y se ha validado a través de otros mecanismos de</span><span class="sxs-lookup"><span data-stu-id="1c9ac-271">enabling a new metric only after hello code has already been deployed and validated via other mechanisms</span></span>
  - <span data-ttu-id="1c9ac-272">cambiar la carga de hello predeterminado para un servicio basado en el consumo y el comportamiento observado</span><span class="sxs-lookup"><span data-stu-id="1c9ac-272">changing hello default load for a service based on observed behavior and consumption</span></span>

<span data-ttu-id="1c9ac-273">Hello principales API para cambiar la configuración de métrica son `FabricClient.ServiceManagementClient.UpdateServiceAsync` en C# y `Update-ServiceFabricService` en PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-273">hello main APIs for changing metric configuration are `FabricClient.ServiceManagementClient.UpdateServiceAsync` in C# and `Update-ServiceFabricService` in PowerShell.</span></span> <span data-ttu-id="1c9ac-274">Cualquier información que se especifique con estas API reemplaza información existente de métrica hello para el servicio de hello inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-274">Whatever information you specify with these APIs replaces hello existing metric information for hello service immediately.</span></span> 

## <a name="mixing-default-load-values-and-dynamic-load-reports"></a><span data-ttu-id="1c9ac-275">Combinación de valores de carga predeterminados e informes de carga dinámica</span><span class="sxs-lookup"><span data-stu-id="1c9ac-275">Mixing default load values and dynamic load reports</span></span>
<span data-ttu-id="1c9ac-276">Carga de forma predeterminada y carga dinámica puede utilizarse para hello mismo servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-276">Default load and dynamic loads can be used for hello same service.</span></span> <span data-ttu-id="1c9ac-277">Cuando un servicio utiliza los informes tanto de carga predeterminada como de carga dinámica, la carga predeterminada actúa como una estimación hasta que aparecen los informes dinámicos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-277">When a service utilizes both default load and dynamic load reports, default load serves as an estimate until dynamic reports show up.</span></span> <span data-ttu-id="1c9ac-278">Carga de forma predeterminada es bueno, porque proporciona Hola, Administrador de recursos del clúster algo toowork con.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-278">Default load is good because it gives hello Cluster Resource Manager something toowork with.</span></span> <span data-ttu-id="1c9ac-279">Hola de carga de predeterminado permite hello tooplace del Administrador de recursos del clúster de objetos de servicio de hello en ubicaciones buena cuando se crean.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-279">hello default load allows hello Cluster Resource Manager tooplace hello service objects in good locations when they are created.</span></span> <span data-ttu-id="1c9ac-280">Si no se proporciona ninguna información de carga predeterminada, la ubicación de los servicios es aleatoria.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-280">If no default load information is provided, placement of services is effectively random.</span></span> <span data-ttu-id="1c9ac-281">Cuando llegan los informes de carga más adelante una colocación aleatoria inicial Hola a menudo es incorrecta y Hola, Administrador de recursos del clúster tiene servicios de toomove.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-281">When load reports arrive later hello initial random placement is often wrong and hello Cluster Resource Manager has toomove services.</span></span>

<span data-ttu-id="1c9ac-282">Vamos a tomar nuestro ejemplo anterior y vemos qué sucede cuando se agregan algunas métricas personalizadas e informes de carga dinámicos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-282">Let’s take our previous example and see what happens when we add some custom metrics and dynamic load reporting.</span></span> <span data-ttu-id="1c9ac-283">En este ejemplo, utilizamos "MemoryInMb" como una métrica de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-283">In this example, we use “MemoryInMb” as an example metric.</span></span>

> [!NOTE]
> <span data-ttu-id="1c9ac-284">Memoria es una de las métricas del sistema Hola que puede Service Fabric [recursos rigen](service-fabric-resource-governance.md), y notificar que suele ser difícil.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-284">Memory is one of hello system metrics that Service Fabric can [resource govern](service-fabric-resource-governance.md), and reporting it yourself is typically difficult.</span></span> <span data-ttu-id="1c9ac-285">No realmente esperamos se tooreport consumo de memoria; La memoria se utiliza aquí como un toolearning ayuda acerca de las capacidades de Hola Hola, Administrador de recursos del clúster.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-285">We don't actually expect you tooreport on Memory consumption; Memory is used here as an aid toolearning about hello capabilities of hello Cluster Resource Manager.</span></span>
>

<span data-ttu-id="1c9ac-286">Vamos a suponer que se creó inicialmente servicio con estado Hola con hello siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-286">Let’s presume that we initially created hello stateful service with hello following command:</span></span>

<span data-ttu-id="1c9ac-287">Powershell:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-287">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("MemoryInMb,High,21,11”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

<span data-ttu-id="1c9ac-288">Como recordatorio, esta sintaxis es ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span><span class="sxs-lookup"><span data-stu-id="1c9ac-288">As a reminder, this syntax is ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span></span>

<span data-ttu-id="1c9ac-289">El aspecto de un diseño del clúster podría ser similar a este:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-289">Let's see what one possible cluster layout could look like:</span></span>

<span data-ttu-id="1c9ac-290"><center>
![Clúster equilibrado con métricas predeterminadas y personalizadas][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="1c9ac-290"><center>
![Cluster Balanced with both Default and Custom metrics][Image2]
</center></span></span>

<span data-ttu-id="1c9ac-291">Algunas cosas que debe tener en cuenta:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-291">Some things that are worth noting:</span></span>

* <span data-ttu-id="1c9ac-292">Las réplicas secundarias dentro de una partición pueden tener su propia carga cada una</span><span class="sxs-lookup"><span data-stu-id="1c9ac-292">Secondary replicas within a partition can each have their own load</span></span>
* <span data-ttu-id="1c9ac-293">En general las métricas de hello buscar equilibradas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-293">Overall hello metrics look balanced.</span></span> <span data-ttu-id="1c9ac-294">Para la memoria, Hola proporción entre Hola máximo y mínimo carga es 1,75 (nodo Hola con hello carga mayoría es N3, hello es menos N2 y 28/16 = 1,75).</span><span class="sxs-lookup"><span data-stu-id="1c9ac-294">For Memory, hello ratio between hello maximum and minimum load is 1.75 (hello node with hello most load is N3, hello least is N2, and 28/16 = 1.75).</span></span>

<span data-ttu-id="1c9ac-295">Hay algunas cosas que todavía necesitamos tooexplain:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-295">There are some things that we still need tooexplain:</span></span>

* <span data-ttu-id="1c9ac-296">¿Qué determinó si una relación de 1,75 era razonable o no?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-296">What determined whether a ratio of 1.75 was reasonable or not?</span></span> <span data-ttu-id="1c9ac-297">¿Cómo sabe Hola, Administrador de recursos del clúster si es suficientemente bueno, o si no hay más toodo de trabajo?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-297">How does hello Cluster Resource Manager know if that’s good enough or if there is more work toodo?</span></span>
* <span data-ttu-id="1c9ac-298">¿Cuándo se produce el equilibrio?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-298">When does balancing happen?</span></span>
* <span data-ttu-id="1c9ac-299">¿Qué significa que la ponderación de Memoria es alta?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-299">What does it mean that Memory was weighted “High”?</span></span>

## <a name="metric-weights"></a><span data-ttu-id="1c9ac-300">Pesos de métrica</span><span class="sxs-lookup"><span data-stu-id="1c9ac-300">Metric weights</span></span>
<span data-ttu-id="1c9ac-301">Seguimiento Hola mismo las métricas entre servicios diferentes son importante.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-301">Tracking hello same metrics across different services is important.</span></span> <span data-ttu-id="1c9ac-302">Que la vista global es lo que permite Hola consumo de tootrack de administrador de recursos de clúster en el clúster de hello, equilibrar el consumo en todos los nodos y asegurarse de que los nodos no abuse de capacidad.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-302">That global view is what allows hello Cluster Resource Manager tootrack consumption in hello cluster, balance consumption across nodes, and ensure that nodes don’t go over capacity.</span></span> <span data-ttu-id="1c9ac-303">Sin embargo, los servicios pueden tener vistas diferentes como toohello importancia de hello misma métrica.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-303">However, services may have different views as toohello importance of hello same metric.</span></span> <span data-ttu-id="1c9ac-304">Además, en un clúster con muchas métricas y una gran cantidad de servicios, puede que no existan soluciones perfectamente equilibradas para todas las métricas.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-304">Also, in a cluster with many metrics and lots of services, perfectly balanced solutions may not exist for all metrics.</span></span> <span data-ttu-id="1c9ac-305">¿Cómo debe controlar estas situaciones Hola, Administrador de recursos del clúster?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-305">How should hello Cluster Resource Manager handle these situations?</span></span>

<span data-ttu-id="1c9ac-306">Pesos de métricos permiten hello toodecide de administrador de recursos del clúster cómo toobalance Hola clúster cuando no hay ninguna respuesta perfecta.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-306">Metric weights allow hello Cluster Resource Manager toodecide how toobalance hello cluster when there’s no perfect answer.</span></span> <span data-ttu-id="1c9ac-307">Pesos métricos también permiten hello toobalance del Administrador de recursos del clúster de servicios específicos diferente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-307">Metric weights also allow hello Cluster Resource Manager toobalance specific services differently.</span></span> <span data-ttu-id="1c9ac-308">Las métricas pueden tener cuatro niveles diferentes de ponderación: cero, baja, media o alta.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-308">Metrics can have four different weight levels: Zero, Low, Medium, and High.</span></span> <span data-ttu-id="1c9ac-309">Una métrica con un peso de cero no aporta nada a la hora de considerar si todo está equilibrado o no.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-309">A metric with a weight of Zero contributes nothing when considering whether things are balanced or not.</span></span> <span data-ttu-id="1c9ac-310">Sin embargo, su carga aún contribuyen toocapacity administración.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-310">However, its load does still contribute toocapacity management.</span></span> <span data-ttu-id="1c9ac-311">Las métricas con un peso cero siguen siendo útiles y se utilizan con frecuencia como parte la supervisión del comportamiento y el rendimiento del servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-311">Metrics with Zero weight are still useful and are frequently used as a part of service behavior and performance monitoring.</span></span> <span data-ttu-id="1c9ac-312">[En este artículo](service-fabric-diagnostics-event-generation-infra.md) proporciona más información sobre el uso de Hola de métricas de supervisión y diagnóstico de los servicios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-312">[This article](service-fabric-diagnostics-event-generation-infra.md) provides more information on hello use of metrics for monitoring and diagnostics of your services.</span></span> 

<span data-ttu-id="1c9ac-313">impacto de Hola de diferentes pesos métricos en el clúster de hello es que ese Hola, Administrador de recursos del clúster genera diferentes soluciones.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-313">hello real impact of different metric weights in hello cluster is that hello Cluster Resource Manager generates different solutions.</span></span> <span data-ttu-id="1c9ac-314">Pesos métricos indican Hola, Administrador de recursos del clúster que ciertas métricas son más importantes que otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-314">Metric weights tell hello Cluster Resource Manager that certain metrics are more important than others.</span></span> <span data-ttu-id="1c9ac-315">Cuando no hay ningún Hola solución perfecta Administrador de recursos del clúster puede preferir soluciones que equilibrar Hola superior ponderada las métricas mejor.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-315">When there's no perfect solution hello Cluster Resource Manager can prefer solutions which balance hello higher weighted metrics better.</span></span> <span data-ttu-id="1c9ac-316">Si un servicio considera que una métrica no es importante, puede encontrar que su uso de esa métrica está desequilibrado.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-316">If a service thinks a particular metric is unimportant, it may find their use of that metric imbalanced.</span></span> <span data-ttu-id="1c9ac-317">Esto permite que una distribución uniforme de algunos métrica que es importante tooit tooget de otro servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-317">This allows another service tooget an even distribution of some metric that is important tooit.</span></span>

<span data-ttu-id="1c9ac-318">Echemos un vistazo a un ejemplo de algunos informes de carga y la métrica diferente Pondere los resultados de las diferentes asignaciones de clúster Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-318">Let’s look at an example of some load reports and how different metric weights results in different allocations in hello cluster.</span></span> <span data-ttu-id="1c9ac-319">En este ejemplo, vemos que intercambiar peso relativo de Hola de métricas de hello, hello toocreate del Administrador de recursos del clúster diferentes organizaciones de servicios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-319">In this example, we see that switching hello relative weight of hello metrics causes hello Cluster Resource Manager toocreate different arrangements of services.</span></span>

<span data-ttu-id="1c9ac-320"><center>
![Ejemplo de ponderación de métricas y su impacto en soluciones de equilibrio][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="1c9ac-320"><center>
![Metric Weight Example and Its Impact on Balancing Solutions][Image3]
</center></span></span>

<span data-ttu-id="1c9ac-321">En este ejemplo, hay cuatro servicios diferentes, todos informando sobre valores diferentes para dos métricas diferentes, MetricA y MetricB.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-321">In this example, there are four different services, all reporting different values for two different metrics, MetricA and MetricB.</span></span> <span data-ttu-id="1c9ac-322">En un caso, todos los servicios de hello definen MetricA es más importante de hello (peso = alta) y MetricB como no importantes (peso = bajos).</span><span class="sxs-lookup"><span data-stu-id="1c9ac-322">In one case, all hello services define MetricA is hello most important one (Weight = High) and MetricB as unimportant (Weight = Low).</span></span> <span data-ttu-id="1c9ac-323">Como resultado, vemos que Administrador de recursos del clúster de Hola coloca servicios Hola para que MetricA es más equilibrada que MetricB.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-323">As a result, we see that hello Cluster Resource Manager places hello services so that MetricA is better balanced than MetricB.</span></span> <span data-ttu-id="1c9ac-324">"Mejor equilibrada" significa que MetricA tiene una desviación estándar menor que MetricB.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-324">"Better balanced" means that MetricA has a lower has a lower standard deviation than MetricB.</span></span> <span data-ttu-id="1c9ac-325">En segundo caso hello, se invierte la dirección pesos de métrica de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-325">In hello second case, we reverse hello metric weights.</span></span> <span data-ttu-id="1c9ac-326">Como resultado, Hola, Administrador de recursos del clúster intercambia servicios A y B toocome seguridad con una asignación donde MetricB mejor es equilibrada que MetricA.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-326">As a result, hello Cluster Resource Manager swaps services A and B toocome up with an allocation where MetricB is better balanced than MetricA.</span></span>

> [!NOTE]
> <span data-ttu-id="1c9ac-327">Pesos métricos determinan cómo debe equilibrar Hola, Administrador de recursos del clúster, pero no cuando equilibrio debería ocurrir.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-327">Metric weights determine how hello Cluster Resource Manager should balance, but not when balancing should happen.</span></span> <span data-ttu-id="1c9ac-328">Para más información sobre el equilibrio, consulte [este artículo](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="1c9ac-328">For more information on balancing, check out [this article](service-fabric-cluster-resource-manager-balancing.md)</span></span>
>

### <a name="global-metric-weights"></a><span data-ttu-id="1c9ac-329">Ponderaciones de métricas globales</span><span class="sxs-lookup"><span data-stu-id="1c9ac-329">Global metric weights</span></span>
<span data-ttu-id="1c9ac-330">Supongamos que Services como define MetricA como alta de peso y ServiceB establece el peso de Hola para MetricA tooLow o cero.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-330">Let's say ServiceA defines MetricA as weight High, and ServiceB sets hello weight for MetricA tooLow or Zero.</span></span> <span data-ttu-id="1c9ac-331">¿Qué es el peso real Hola que terminan acostumbrarse?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-331">What’s hello actual weight that ends up getting used?</span></span>

<span data-ttu-id="1c9ac-332">En realidad, para cada métrica se realiza el seguimiento con varios pesos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-332">There are multiple weights that are tracked for every metric.</span></span> <span data-ttu-id="1c9ac-333">primer grosor de Hello es hello uno definido para la métrica de hello cuando se crea el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-333">hello first weight is hello one defined for hello metric when hello service is created.</span></span> <span data-ttu-id="1c9ac-334">Hola otro peso es un peso global, que se calcula automáticamente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-334">hello other weight is a global weight, which is computed automatically.</span></span> <span data-ttu-id="1c9ac-335">Hola, Administrador de recursos del clúster utiliza ambos estos pesos cuando realice la puntuación soluciones.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-335">hello Cluster Resource Manager uses both these weights when scoring solutions.</span></span> <span data-ttu-id="1c9ac-336">Es importante tener ambos pesos en cuenta.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-336">Taking both weights into account is important.</span></span> <span data-ttu-id="1c9ac-337">Esto permite hello toobalance del Administrador de recursos del clúster de cada servicio tooits correspondiente posee las prioridades y asegúrese también de ese clúster Hola como un todo se asignó correctamente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-337">This allows hello Cluster Resource Manager toobalance each service according tooits own priorities, and also ensure that hello cluster as a whole is allocated correctly.</span></span>

<span data-ttu-id="1c9ac-338">¿Qué ocurriría si Hola, Administrador de recursos del clúster no se preocupa de saldo global y local?</span><span class="sxs-lookup"><span data-stu-id="1c9ac-338">What would happen if hello Cluster Resource Manager didn’t care about both global and local balance?</span></span> <span data-ttu-id="1c9ac-339">Bueno, es fácil tooconstruct soluciones que están equilibrados global, pero lo que ocasionará saldo deficiente de los recursos para los servicios individuales.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-339">Well, it’s easy tooconstruct solutions that are globally balanced, but which result in poor resource balance for individual services.</span></span> <span data-ttu-id="1c9ac-340">En el siguiente ejemplo de Hola, veamos un servicio configurado con solo las métricas de Hola de forma predeterminada y vea Qué sucede cuando se considera solo global saldo:</span><span class="sxs-lookup"><span data-stu-id="1c9ac-340">In hello following example, let’s look at a service configured with just hello default metrics, and see what happens when only global balance is considered:</span></span>

<span data-ttu-id="1c9ac-341"><center>
![Hola impacto de una solución solo Global][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="1c9ac-341"><center>
![hello Impact of a Global Only Solution][Image4]
</center></span></span>

<span data-ttu-id="1c9ac-342">En hello ejemplo superior basándose sólo en equilibrio global, realmente está equilibrada clúster Hola como un todo.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-342">In hello top example based only on global balance, hello cluster as a whole is indeed balanced.</span></span> <span data-ttu-id="1c9ac-343">Todos los nodos tienen Hola mismo recuento de los elementos y Hola mismo número de réplicas totales.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-343">All nodes have hello same count of primaries and hello same number total replicas.</span></span> <span data-ttu-id="1c9ac-344">Sin embargo, si observa impacto real de Hola de esta asignación no es tan buena: pérdida de Hola de cualquier nodo afecta a una carga de trabajo determinada desproporcionadamente, porque toma todos sus elementos.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-344">However, if you look at hello actual impact of this allocation it’s not so good: hello loss of any node impacts a particular workload disproportionately, because it takes out all of its primaries.</span></span> <span data-ttu-id="1c9ac-345">Por ejemplo, si se produce un error en primer nodo de hello tres primarios Hola para las diferentes particiones de tres de Hola de hello servicio círculo todos no se pierde.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-345">For example, if hello first node fails hello three primaries for hello three different partitions of hello Circle service would all be lost.</span></span> <span data-ttu-id="1c9ac-346">Por el contrario, el Hola triángulo y servicios de hexágonos tienen sus particiones pierde una réplica.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-346">Conversely, hello Triangle and Hexagon services have their partitions lose a replica.</span></span> <span data-ttu-id="1c9ac-347">Esto no hace que interrupción, que no sea de tener hello toorecover hacia abajo de la réplica.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-347">This causes no disruption, other than having toorecover hello down replica.</span></span>

<span data-ttu-id="1c9ac-348">En el ejemplo de la parte inferior de hello, Hola, Administrador de recursos del clúster distribuyó réplicas Hola basándose en ambos equilibrio hello, globales y por servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-348">In hello bottom example, hello Cluster Resource Manager has distributed hello replicas based on both hello global and per-service balance.</span></span> <span data-ttu-id="1c9ac-349">Al calcular la puntuación de Hola de solución de hello ofrece la mayoría de solución global de hello peso toohello y un servicio de tooindividual parte (configurable).</span><span class="sxs-lookup"><span data-stu-id="1c9ac-349">When calculating hello score of hello solution it gives most of hello weight toohello global solution, and a (configurable) portion tooindividual services.</span></span> <span data-ttu-id="1c9ac-350">Equilibrar global para una métrica se calcula según promedio de Hola de pesos de métrica de Hola de cada servicio.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-350">Global balance for a metric is calculated based on hello average of hello metric weights from each service.</span></span> <span data-ttu-id="1c9ac-351">Cada servicio se equilibra tooits de pesos métrica definida propio correspondiente.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-351">Each service is balanced according tooits own defined metric weights.</span></span> <span data-ttu-id="1c9ac-352">Esto garantiza que los servicios de Hola están equilibrados entre ellas según tootheir propias necesidades.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-352">This ensures that hello services are balanced within themselves according tootheir own needs.</span></span> <span data-ttu-id="1c9ac-353">Como resultado, si hello mismo primer nodo tiene un error error Hola se distribuye entre todas las particiones de todos los servicios.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-353">As a result, if hello same first node fails hello failure is distributed across all partitions of all services.</span></span> <span data-ttu-id="1c9ac-354">Hola impacto tooeach es Hola igual.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-354">hello impact tooeach is hello same.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1c9ac-355">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="1c9ac-355">Next steps</span></span>
- <span data-ttu-id="1c9ac-356">Para más información acerca de cómo configurar servicios, [lea sobre la configuración de servicios](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span><span class="sxs-lookup"><span data-stu-id="1c9ac-356">For more information on configuring services, [Learn about configuring Services](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span></span>
- <span data-ttu-id="1c9ac-357">Definir métricas de desfragmentación es tooconsolidate una manera de carga en los nodos en lugar de propagarse. toolearn cómo tooconfigure la desfragmentación, consulte demasiado[este artículo](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="1c9ac-357">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
- <span data-ttu-id="1c9ac-358">toofind out acerca de cómo Hola, Administrador de recursos del clúster administra y equilibra la carga en el clúster de hello, desproteger artículo hello en [equilibrio de carga](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="1c9ac-358">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="1c9ac-359">Desde el principio de Hola y [obtener un servicio Administrador de recursos del clúster de tejido de toohello de introducción](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="1c9ac-359">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
- <span data-ttu-id="1c9ac-360">Coste del movimiento es una manera de señalización toohello Administrador de recursos del clúster que determinados servicios estén toomove más cara que otras.</span><span class="sxs-lookup"><span data-stu-id="1c9ac-360">Movement Cost is one way of signaling toohello Cluster Resource Manager that certain services are more expensive toomove than others.</span></span> <span data-ttu-id="1c9ac-361">toolearn más información acerca del coste del movimiento, consulte demasiado[este artículo](service-fabric-cluster-resource-manager-movement-cost.md)</span><span class="sxs-lookup"><span data-stu-id="1c9ac-361">toolearn more about movement cost, refer too[this article](service-fabric-cluster-resource-manager-movement-cost.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-cluster-layout-with-default-metrics.png
[Image2]:./media/service-fabric-cluster-resource-manager-metrics/Service-Fabric-Resource-Manager-Dynamic-Load-Reports.png
[Image3]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-metric-weights-impact.png
[Image4]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-global-vs-local-balancing.png
