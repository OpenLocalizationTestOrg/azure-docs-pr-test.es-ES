---
title: "Descripción de clúster del Administrador de recursos aaaCluster | Documentos de Microsoft"
description: "Que describe un clúster de Service Fabric mediante la especificación de dominios de error, dominios de actualización, propiedades de nodo y las capacidades de nodo para Hola, Administrador de recursos del clúster."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 55f8ab37-9399-4c9a-9e6c-d2d859de6766
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f2822075976bd54402af5ad56991b5b360dfb1d8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/06/2017
---
# <a name="describing-a-service-fabric-cluster"></a><span data-ttu-id="70dc2-103">Descripción de un clúster de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="70dc2-103">Describing a service fabric cluster</span></span>
<span data-ttu-id="70dc2-104">Hola, Administrador de recursos de clúster de tejido de servicio proporciona varios mecanismos para la descripción de un clúster.</span><span class="sxs-lookup"><span data-stu-id="70dc2-104">hello Service Fabric Cluster Resource Manager provides several mechanisms for describing a cluster.</span></span> <span data-ttu-id="70dc2-105">En tiempo de ejecución, Hola, Administrador de recursos del clúster utiliza esta información tooensure servicios de alta disponibilidad Hola ejecutando en el clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-105">During runtime, hello Cluster Resource Manager uses this information tooensure high availability of hello services running in hello cluster.</span></span> <span data-ttu-id="70dc2-106">Al aplicar estas reglas importantes, también intenta toooptimize consumo de recursos de hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-106">While enforcing these important rules, it also attempts toooptimize hello resource consumption within hello cluster.</span></span>

## <a name="key-concepts"></a><span data-ttu-id="70dc2-107">Conceptos clave</span><span class="sxs-lookup"><span data-stu-id="70dc2-107">Key concepts</span></span>
<span data-ttu-id="70dc2-108">Hola, Administrador de recursos del clúster es compatible con varias características que describen un clúster:</span><span class="sxs-lookup"><span data-stu-id="70dc2-108">hello Cluster Resource Manager supports several features that describe a cluster:</span></span>

* <span data-ttu-id="70dc2-109">Dominios de error</span><span class="sxs-lookup"><span data-stu-id="70dc2-109">Fault Domains</span></span>
* <span data-ttu-id="70dc2-110">Dominios de actualización</span><span class="sxs-lookup"><span data-stu-id="70dc2-110">Upgrade Domains</span></span>
* <span data-ttu-id="70dc2-111">Propiedades del nodo</span><span class="sxs-lookup"><span data-stu-id="70dc2-111">Node Properties</span></span>
* <span data-ttu-id="70dc2-112">Capacidades de nodo</span><span class="sxs-lookup"><span data-stu-id="70dc2-112">Node Capacities</span></span>

## <a name="fault-domains"></a><span data-ttu-id="70dc2-113">Dominios de error</span><span class="sxs-lookup"><span data-stu-id="70dc2-113">Fault domains</span></span>
<span data-ttu-id="70dc2-114">Un dominio de error es cualquier área de error coordinado.</span><span class="sxs-lookup"><span data-stu-id="70dc2-114">A Fault Domain is any area of coordinated failure.</span></span> <span data-ttu-id="70dc2-115">Una única máquina es un dominio de error (ya que se puede producir un error en sus propio para diversas razones, de firmware de alimentación de alimentación errores toodrive errores toobad NIC).</span><span class="sxs-lookup"><span data-stu-id="70dc2-115">A single machine is a Fault Domain (since it can fail on its own for various reasons, from power supply failures toodrive failures toobad NIC firmware).</span></span> <span data-ttu-id="70dc2-116">Las máquinas conectada toohello son el mismo conmutador Ethernet en Hola mismo dominio de error, como son equipos que comparten un único origen de energía o en una sola ubicación.</span><span class="sxs-lookup"><span data-stu-id="70dc2-116">Machines connected toohello same Ethernet switch are in hello same Fault Domain, as are machines sharing a single source of power or in a single location.</span></span> <span data-ttu-id="70dc2-117">Puesto que es natural que toooverlap de errores de hardware, dominios de error son inherentemente jerárquicos y se representan como URI de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="70dc2-117">Since it's natural for hardware faults toooverlap, Fault Domains are inherently hierarchal and are represented as URIs in Service Fabric.</span></span>

<span data-ttu-id="70dc2-118">Es importante que los dominios de error se configuran correctamente porque Service Fabric usa los servicios de contexto de toosafely de esta información.</span><span class="sxs-lookup"><span data-stu-id="70dc2-118">It is important that Fault Domains are set up correctly since Service Fabric uses this information toosafely place services.</span></span> <span data-ttu-id="70dc2-119">Service Fabric no le interese tooplace de servicios de modo que la pérdida de Hola de un dominio de error (causado por error de Hola de algún componente) hace que un servicio toogo hacia abajo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-119">Service Fabric doesn't want tooplace services such that hello loss of a Fault Domain (caused by hello failure of some component) causes a service toogo down.</span></span> <span data-ttu-id="70dc2-120">Hola entorno Azure Service Fabric utiliza información de dominio de error de hello proporcionada por hello entorno toocorrectly configurar los nodos de hello en clúster de hello en su nombre.</span><span class="sxs-lookup"><span data-stu-id="70dc2-120">In hello Azure environment Service Fabric uses hello Fault Domain information provided by hello environment toocorrectly configure hello nodes in hello cluster on your behalf.</span></span> <span data-ttu-id="70dc2-121">Para Service Fabric independientes, dominios de error están definidos en el momento de hello ese clúster Hola está configurado</span><span class="sxs-lookup"><span data-stu-id="70dc2-121">For Service Fabric Standalone, Fault Domains are defined at hello time that hello cluster is set up</span></span> 

> [!WARNING]
> <span data-ttu-id="70dc2-122">Es importante que Hola información de dominio de error proporcionado tooService tejido es precisa.</span><span class="sxs-lookup"><span data-stu-id="70dc2-122">It is important that hello Fault Domain information provided tooService Fabric is accurate.</span></span> <span data-ttu-id="70dc2-123">Por ejemplo, supongamos que los nodos del clúster de Service Fabric se ejecutan dentro de 10 máquinas virtuales, en cinco hosts físicos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-123">For example, let's say that your Service Fabric cluster's nodes are running inside 10 virtual machines, running on five physical hosts.</span></span> <span data-ttu-id="70dc2-124">En este caso, a pesar de que hay 10 máquinas virtuales, hay solo 5 dominios de error (nivel superior) diferentes.</span><span class="sxs-lookup"><span data-stu-id="70dc2-124">In this case, even though there are 10 virtual machines, there's only 5 different (top level) fault domains.</span></span> <span data-ttu-id="70dc2-125">Uso compartido de hello hace del mismo host físico tooshare de máquinas virtuales Hola mismo dominio raíz del error, puesto que Hola experiencia de las máquinas virtuales coordinada error si se produce un error en su host físico.</span><span class="sxs-lookup"><span data-stu-id="70dc2-125">Sharing hello same physical host causes VMs tooshare hello same root fault domain, since hello VMs experience coordinated failure if their physical host fails.</span></span>  
>
> <span data-ttu-id="70dc2-126">Puesto que espera Service Fabric Hola dominio de error de un nodo no toochange.</span><span class="sxs-lookup"><span data-stu-id="70dc2-126">Since Service Fabric expects hello Fault Domain of a node not toochange.</span></span> <span data-ttu-id="70dc2-127">Otros mecanismos de garantizar la alta disponibilidad de hello las máquinas virtuales, como [máquinas virtuales de alta disponibilidad](https://technet.microsoft.com/en-us/library/cc967323.aspx), usar la migración transparente de las máquinas virtuales de un host tooanother.</span><span class="sxs-lookup"><span data-stu-id="70dc2-127">Other mechanisms of ensuring high availability of hello VMs, such as [HA-VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use transparent migration of VMs from one host tooanother.</span></span> <span data-ttu-id="70dc2-128">Estos mecanismos no volver a configurar o notificar Hola ejecutan código dentro de hello máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="70dc2-128">These mechanisms do not reconfigure or notify hello running code inside hello VM.</span></span> <span data-ttu-id="70dc2-129">Por lo tanto, **no se admiten** como entornos para ejecutar clústeres de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="70dc2-129">As such, they are **not supported** as environments for running Service Fabric clusters.</span></span> <span data-ttu-id="70dc2-130">Service Fabric deben ser la tecnología de alta disponibilidad solo de hello empleada.</span><span class="sxs-lookup"><span data-stu-id="70dc2-130">Service Fabric should be hello only high-availability technology employed.</span></span> <span data-ttu-id="70dc2-131">Los mecanismos como la migración en vivo de VM, SAN u otros no son necesarios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-131">Mechanisms like live VM migration, SANs, or others are not necessary.</span></span> <span data-ttu-id="70dc2-132">Si se usa junto con Service Fabric, estos mecanismos _reducen_ la confiabilidad y la disponibilidad de las aplicaciones, ya que agregan una complejidad adicional, añaden orígenes centralizados de errores y utilizan estrategias de confiabilidad y disponibilidad que entran en conflicto con las de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="70dc2-132">If used in conjunction with Service Fabric, these mechanisms _reduce_ application availability and reliability because they introduce additional complexity, add centralized sources of failure, and utilize reliability and availability strategies that conflict with those in Service Fabric.</span></span> 
>
>

<span data-ttu-id="70dc2-133">En el siguiente gráfico de Hola se colores todas las entidades de Hola que contribuyen tooFault dominios y lista de que todos los diferentes dominios de error que son el resultado de hello.</span><span class="sxs-lookup"><span data-stu-id="70dc2-133">In hello graphic below we color all hello entities that contribute tooFault Domains and list all hello different Fault Domains that result.</span></span> <span data-ttu-id="70dc2-134">En este ejemplo, tenemos centros de datos (DC), bastidores (R) y servidores blade (B).</span><span class="sxs-lookup"><span data-stu-id="70dc2-134">In this example, we have datacenters ("DC"), racks ("R"), and blades ("B").</span></span> <span data-ttu-id="70dc2-135">Es posible que, si cada hoja contiene más de una máquina virtual, podría haber otra capa Hola jerarquía de dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-135">Conceivably, if each blade holds more than one virtual machine, there could be another layer in hello Fault Domain hierarchy.</span></span>

<span data-ttu-id="70dc2-136"><center>
![Nodos organizados a través de dominios de error][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-136"><center>
![Nodes organized via Fault Domains][Image1]
</center></span></span>

<span data-ttu-id="70dc2-137">En tiempo de ejecución, Hola, Administrador de recursos de clúster de Service Fabric considera que los dominios de error de hello en clúster de Hola y planes de diseños.</span><span class="sxs-lookup"><span data-stu-id="70dc2-137">During runtime, hello Service Fabric Cluster Resource Manager considers hello Fault Domains in hello cluster and plans layouts.</span></span> <span data-ttu-id="70dc2-138">Hola réplicas con estado o instancias sin estado para un servicio determinado se distribuyen por lo que están en distintos dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-138">hello stateful replicas or stateless instances for a given service are distributed so they are in separate Fault Domains.</span></span> <span data-ttu-id="70dc2-139">Distribuir servicio Hola entre dominios de error garantiza la disponibilidad de hello del servicio de hello no se vean comprometida cuando se produce un error en un dominio de error en cualquier nivel de jerarquía de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-139">Distributing hello service across fault domains ensures hello availability of hello service is not compromised when a Fault Domain fails at any level of hello hierarchy.</span></span>

<span data-ttu-id="70dc2-140">Administrador de recursos de clúster del servicio de Fabric no le importa cuántos niveles hay Hola jerarquía de dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-140">Service Fabric’s Cluster Resource Manager doesn’t care how many layers there are in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="70dc2-141">Sin embargo, lo intenta con tooensure que pérdida de Hola de cualquier una parte de la jerarquía de hello no afecta a servicios que se ejecutan en él.</span><span class="sxs-lookup"><span data-stu-id="70dc2-141">However, it tries tooensure that hello loss of any one portion of hello hierarchy doesn’t impact services running in it.</span></span> 

<span data-ttu-id="70dc2-142">Es mejor si hay Hola el mismo número de nodos en cada nivel de profundidad en hello jerarquía de dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-142">It is best if there are hello same number of nodes at each level of depth in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="70dc2-143">Si no está equilibrada en el clúster Hola "árbol" de dominios de error, dificulta que hello toofigure de administrador de recursos del clúster out mejor asignación de hello de servicios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-143">If hello “tree” of Fault Domains is unbalanced in your cluster, it makes it harder for hello Cluster Resource Manager toofigure out hello best allocation of services.</span></span> <span data-ttu-id="70dc2-144">Desequilibrado diseños de dominios de error significan pérdida Hola de algunos dominios de disponibilidad de Hola de impacto de los servicios más de otros dominios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-144">Imbalanced Fault Domains layouts mean that hello loss of some domains impact hello availability of services more than other domains.</span></span> <span data-ttu-id="70dc2-145">Como resultado, se anula Hola, Administrador de recursos de clúster entre dos objetivos: desea toouse máquinas de hello en ese dominio "intensa" mediante la colocación de servicios en ellos, y lo servicios tooplace en otros dominios para que la pérdida de Hola de un dominio no causa problemas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-145">As a result, hello Cluster Resource Manager is torn between two goals: It wants toouse hello machines in that “heavy” domain by placing services on them, and it wants tooplace services in other domains so that hello loss of a domain doesn’t cause problems.</span></span> 

<span data-ttu-id="70dc2-146">¿Qué aspecto tienen los dominios desequilibrados?</span><span class="sxs-lookup"><span data-stu-id="70dc2-146">What do imbalanced domains look like?</span></span> <span data-ttu-id="70dc2-147">En el diagrama de hello siguiente, se muestran dos distintos diseños de clúster.</span><span class="sxs-lookup"><span data-stu-id="70dc2-147">In hello diagram below, we show two different cluster layouts.</span></span> <span data-ttu-id="70dc2-148">En el primer ejemplo de Hola, los nodos de Hola se distribuyen uniformemente en hello dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-148">In hello first example, hello nodes are distributed evenly across hello Fault Domains.</span></span> <span data-ttu-id="70dc2-149">En el segundo ejemplo de Hola, un dominio de error tiene muchos más nodos de hello otros dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-149">In hello second example, one Fault Domain has many more nodes than hello other Fault Domains.</span></span> 

<span data-ttu-id="70dc2-150"><center>
![Dos diseños de clúster distintos][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-150"><center>
![Two different cluster layouts][Image2]
</center></span></span>

<span data-ttu-id="70dc2-151">En Azure, de los cuales el dominio de error contiene un nodo de elección de Hola se administra automáticamente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-151">In Azure, hello choice of which Fault Domain contains a node is managed for you.</span></span> <span data-ttu-id="70dc2-152">Sin embargo, según el número de Hola de nodos que se aprovisiona puede seguir terminará con dominios de error con más nodos en ellos que otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-152">However, depending on hello number of nodes that you provision you can still end up with Fault Domains with more nodes in them than others.</span></span> <span data-ttu-id="70dc2-153">Por ejemplo, supongamos que tiene cinco dominios de error en el clúster de hello pero aprovisionar siete nodos para un determinado valor de NodeType.</span><span class="sxs-lookup"><span data-stu-id="70dc2-153">For example, say you have five Fault Domains in hello cluster but provision seven nodes for a given NodeType.</span></span> <span data-ttu-id="70dc2-154">En este caso, hello primero dos dominios de error acabar con varios nodos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-154">In this case, hello first two Fault Domains end up with more nodes.</span></span> <span data-ttu-id="70dc2-155">Si sigues toodeploy más NodeTypes con sólo algunas instancias, Hola problema empeora.</span><span class="sxs-lookup"><span data-stu-id="70dc2-155">If you continue toodeploy more NodeTypes with only a couple instances, hello problem gets worse.</span></span> <span data-ttu-id="70dc2-156">Por este motivo, recomienda que Hola número de nodos de cada tipo de nodo es un múltiplo del número de Hola de dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-156">For this reason it's recommended that hello number of nodes in each node type is a multiple of hello number of Fault Domains.</span></span>

## <a name="upgrade-domains"></a><span data-ttu-id="70dc2-157">Dominios de actualización</span><span class="sxs-lookup"><span data-stu-id="70dc2-157">Upgrade domains</span></span>
<span data-ttu-id="70dc2-158">Dominios de actualización son otra característica que ayuda a Hola servicio Administrador de recursos del clúster de tejido entender Hola diseño del clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-158">Upgrade Domains are another feature that helps hello Service Fabric Cluster Resource Manager understand hello layout of hello cluster.</span></span> <span data-ttu-id="70dc2-159">Dominios de actualización definen conjuntos de nodos que se actualizan al Hola mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-159">Upgrade Domains define sets of nodes that are upgraded at hello same time.</span></span> <span data-ttu-id="70dc2-160">Dominios Hola de Ayuda de administrador de recursos del clúster de entender y coordinar las operaciones de administración como las actualizaciones de la actualización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-160">Upgrade Domains help hello Cluster Resource Manager understand and orchestrate management operations like upgrades.</span></span>

<span data-ttu-id="70dc2-161">Los dominios de actualización son muy similares a los dominios de error, pero con algunas diferencias clave.</span><span class="sxs-lookup"><span data-stu-id="70dc2-161">Upgrade Domains are a lot like Fault Domains, but with a couple key differences.</span></span> <span data-ttu-id="70dc2-162">En primer lugar, las áreas de los errores de hardware coordinados definen los dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-162">First, areas of coordinated hardware failures define Fault Domains.</span></span> <span data-ttu-id="70dc2-163">Dominios de actualización, en Hola otra parte, se definen por la directiva.</span><span class="sxs-lookup"><span data-stu-id="70dc2-163">Upgrade Domains, on hello other hand, are defined by policy.</span></span> <span data-ttu-id="70dc2-164">Obtener toodecide cuántas desea, en lugar de que se dicte entorno Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-164">You get toodecide how many you want, rather than it being dictated by hello environment.</span></span> <span data-ttu-id="70dc2-165">Puede tener tantos dominios de actualización como ocurre con los nodos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-165">You could have as many Upgrade Domains as you do nodes.</span></span> <span data-ttu-id="70dc2-166">Otra diferencia entre los dominios de error y los dominios de actualización es que los dominios de actualización no son jerárquicos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-166">Another difference between Fault Domains and Upgrade Domains is that Upgrade Domains are not hierarchical.</span></span> <span data-ttu-id="70dc2-167">En su lugar, son más parecidos a una etiqueta sencilla.</span><span class="sxs-lookup"><span data-stu-id="70dc2-167">Instead, they are more like a simple tag.</span></span> 

<span data-ttu-id="70dc2-168">Hello siguiente diagrama muestra tres que dominios de actualización se dividen en tres dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-168">hello following diagram shows three Upgrade Domains are striped across three Fault Domains.</span></span> <span data-ttu-id="70dc2-169">También se muestra una posible selección de ubicación de tres réplicas diferentes de un servicio con estado, donde cada una de ellas terminan con diferentes dominios de error y de actualización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-169">It also shows one possible placement for three different replicas of a stateful service, where each ends up in different Fault and Upgrade Domains.</span></span> <span data-ttu-id="70dc2-170">Esta ubicación permite pérdida de Hola de un dominio de error mientras se encuentra en medio de Hola de una actualización de servicio y seguir teniendo una copia del código de hello y los datos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-170">This placement allows hello loss of a Fault Domain while in hello middle of a service upgrade and still have one copy of hello code and data.</span></span>  

<span data-ttu-id="70dc2-171"><center>
![Selección de ubicación con dominios de error y de actualización][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-171"><center>
![Placement With Fault and Upgrade Domains][Image3]
</center></span></span>

<span data-ttu-id="70dc2-172">Hay ventajas y desventajas toohaving gran número de dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-172">There are pros and cons toohaving large numbers of Upgrade Domains.</span></span> <span data-ttu-id="70dc2-173">Más dominios de actualización significa que cada paso de actualización de hello es más detallado y, por tanto, afecta a un número menor de nodos o servicios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-173">More Upgrade Domains means each step of hello upgrade is more granular and therefore affects a smaller number of nodes or services.</span></span> <span data-ttu-id="70dc2-174">Como resultado, servicios menos tienen toomove a la vez, la introducción de menos actividad en sistema Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-174">As a result, fewer services have toomove at a time, introducing less churn into hello system.</span></span> <span data-ttu-id="70dc2-175">Esto suele tooimprove confiabilidad, ya que menos del servicio de Hola se ve afectado por cualquier problema introducido durante la actualización de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-175">This tends tooimprove reliability, since less of hello service is impacted by any issue introduced during hello upgrade.</span></span> <span data-ttu-id="70dc2-176">Dominios de actualización más también significa que necesita menos búfer disponible en impacto nodos toohandle Hola de hello actualizar.</span><span class="sxs-lookup"><span data-stu-id="70dc2-176">More Upgrade Domains also means that you need less available buffer on other nodes toohandle hello impact of hello upgrade.</span></span> <span data-ttu-id="70dc2-177">Por ejemplo, si tiene cinco dominios de actualización, nodos de hello en cada uno están controlando aproximadamente 20% del tráfico.</span><span class="sxs-lookup"><span data-stu-id="70dc2-177">For example, if you have five Upgrade Domains, hello nodes in each are handling roughly 20% of your traffic.</span></span> <span data-ttu-id="70dc2-178">Si necesita tootake hacia abajo de ese dominio de actualización para realizar una actualización, que carga normalmente no es necesaria en algún lugar toogo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-178">If you need tootake down that Upgrade Domain for an upgrade, that load usually needs toogo somewhere.</span></span> <span data-ttu-id="70dc2-179">Puesto que tiene cuatro dominios de actualización restante, cada uno debe tener espacio aproximadamente el 5% del tráfico total de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-179">Since you have four remaining Upgrade Domains, each must have room for about 5% of hello total traffic.</span></span> <span data-ttu-id="70dc2-180">Dominios de actualización más significa que necesita menos búfer en nodos de hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-180">More Upgrade Domains means you need less buffer on hello nodes in hello cluster.</span></span> <span data-ttu-id="70dc2-181">Por ejemplo, considere si había 10 dominios de actualización en su lugar.</span><span class="sxs-lookup"><span data-stu-id="70dc2-181">For example, consider if you had 10 Upgrade Domains instead.</span></span> <span data-ttu-id="70dc2-182">En ese caso, cada UD solo puede controlar aproximadamente el 10% del tráfico total de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-182">In that case, each UD would only be handling about 10% of hello total traffic.</span></span> <span data-ttu-id="70dc2-183">Cuando una actualización recorre clúster hello, cada dominio solo tendría sala toohave aproximadamente 1.1% del total de tráfico que Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-183">When an upgrade steps through hello cluster, each domain would only need toohave room for about 1.1% of hello total traffic.</span></span> <span data-ttu-id="70dc2-184">Dominios de actualización más general permiten toorun los nodos en una mayor utilización, puesto que necesita capacidad reservada menor.</span><span class="sxs-lookup"><span data-stu-id="70dc2-184">More Upgrade Domains generally allow you toorun your nodes at higher utilization, since you need less reserved capacity.</span></span> <span data-ttu-id="70dc2-185">Hello mismo puede decirse de dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-185">hello same is true for Fault Domains.</span></span>  

<span data-ttu-id="70dc2-186">inconveniente de Hola de disponer de varios dominios de actualización es que las actualizaciones suelen tootake más.</span><span class="sxs-lookup"><span data-stu-id="70dc2-186">hello downside of having many Upgrade Domains is that upgrades tend tootake longer.</span></span> <span data-ttu-id="70dc2-187">Tejido de servicio espera un breve período de tiempo después de un dominio de actualización se ha completado y realiza comprobaciones antes de iniciar tooupgrade Hola siguiente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-187">Service Fabric waits a short period of time after an Upgrade Domain is completed and performs checks before starting tooupgrade hello next one.</span></span> <span data-ttu-id="70dc2-188">Estos retrasos permiten detectar problemas introducidos por la actualización de Hola para poder continuar con la actualización Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-188">These delays enable detecting issues introduced by hello upgrade before hello upgrade proceeds.</span></span> <span data-ttu-id="70dc2-189">contrapartida de Hello es aceptable porque evita cambios incorrectos afecte a un exceso de servicio de Hola a la vez.</span><span class="sxs-lookup"><span data-stu-id="70dc2-189">hello tradeoff is acceptable because it prevents bad changes from affecting too much of hello service at a time.</span></span>

<span data-ttu-id="70dc2-190">Usar demasiado pocos dominios de actualización también tiene muchos efectos secundarios: mientras que cada dominio de actualización esté inactivo y actualizándose, una gran parte de la capacidad general no estará disponible.</span><span class="sxs-lookup"><span data-stu-id="70dc2-190">Too few Upgrade Domains has many negative side effects – while each individual Upgrade Domain is down and being upgraded a large portion of your overall capacity is unavailable.</span></span> <span data-ttu-id="70dc2-191">Por ejemplo, si solo dispone de tres dominios de actualización, estará inactiva un tercio de la capacidad general del servicio o del clúster al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-191">For example, if you only have three Upgrade Domains you are taking down about 1/3 of your overall service or cluster capacity at a time.</span></span> <span data-ttu-id="70dc2-192">Tener gran parte de su servicio hacia abajo al mismo tiempo no es deseable ya que tiene suficiente capacidad de toohave en el resto de saludo de la carga de trabajo de clúster toohandle Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-192">Having so much of your service down at once isn’t desirable since you have toohave enough capacity in hello rest of your cluster toohandle hello workload.</span></span> <span data-ttu-id="70dc2-193">Mantener el búfer implica que durante el funcionamiento normal, los nodos se carguen menos de lo que deberían.</span><span class="sxs-lookup"><span data-stu-id="70dc2-193">Maintaining that buffer means that during normal operation those nodes are less loaded than they would be otherwise.</span></span> <span data-ttu-id="70dc2-194">Esto aumenta el costo de Hola de su servicio en ejecución.</span><span class="sxs-lookup"><span data-stu-id="70dc2-194">This increases hello cost of running your service.</span></span>

<span data-ttu-id="70dc2-195">No hay ningún límite real toohello total de errores o dominios de actualización en un entorno o restricciones en la manera en se superponen.</span><span class="sxs-lookup"><span data-stu-id="70dc2-195">There’s no real limit toohello total number of fault or Upgrade Domains in an environment, or constraints on how they overlap.</span></span> <span data-ttu-id="70dc2-196">Es decir, hay varios patrones comunes:</span><span class="sxs-lookup"><span data-stu-id="70dc2-196">That said, there are several common patterns:</span></span>

- <span data-ttu-id="70dc2-197">Asignación 1:1 de dominios de error y de actualización</span><span class="sxs-lookup"><span data-stu-id="70dc2-197">Fault Domains and Upgrade Domains mapped 1:1</span></span>
- <span data-ttu-id="70dc2-198">Un dominio de actualización por nodo (instancia del sistema operativo física o virtual)</span><span class="sxs-lookup"><span data-stu-id="70dc2-198">One Upgrade Domain per Node (physical or virtual OS instance)</span></span>
- <span data-ttu-id="70dc2-199">Un modelo de "seccionado" o "matriz" donde hello dominios de error y dominios de actualización forman una matriz con máquinas que se ejecutan normalmente hacia abajo diagonales Hola</span><span class="sxs-lookup"><span data-stu-id="70dc2-199">A “striped” or “matrix” model where hello Fault Domains and Upgrade Domains form a matrix with machines usually running down hello diagonals</span></span>

<span data-ttu-id="70dc2-200"><center>
![Diseños de dominio de error y de actualización][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-200"><center>
![Fault and Upgrade Domain Layouts][Image4]
</center></span></span>

<span data-ttu-id="70dc2-201">No hay que ningún mejor responder qué toochoose de diseño, cada uno tiene algunas ventajas y desventajas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-201">There’s no best answer which layout toochoose, each has some pros and cons.</span></span> <span data-ttu-id="70dc2-202">Por ejemplo, modelo de hello 1FD:1UD depende de tooset simple.</span><span class="sxs-lookup"><span data-stu-id="70dc2-202">For example, hello 1FD:1UD model is simple tooset up.</span></span> <span data-ttu-id="70dc2-203">Hello 1 dominio de actualización por modelo de nodo es más se asemeje a qué usuarios se utilizan para.</span><span class="sxs-lookup"><span data-stu-id="70dc2-203">hello 1 Upgrade Domain per Node model is most like what people are used to.</span></span> <span data-ttu-id="70dc2-204">Durante las actualizaciones, cada nodo se actualiza de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-204">During upgrades each node is updated independently.</span></span> <span data-ttu-id="70dc2-205">Esto es similar toohow conjuntos pequeños de máquinas se actualizaron manualmente en hello anterior.</span><span class="sxs-lookup"><span data-stu-id="70dc2-205">This is similar toohow small sets of machines were upgraded manually in hello past.</span></span> 

<span data-ttu-id="70dc2-206">modelo más común de Hello es matriz de FD/UD hello, donde hello FD y ud forma una tabla y se colocan nodos empezando a lo largo de hello diagonal.</span><span class="sxs-lookup"><span data-stu-id="70dc2-206">hello most common model is hello FD/UD matrix, where hello FDs and UDs form a table and nodes are placed starting along hello diagonal.</span></span> <span data-ttu-id="70dc2-207">Se trata de modelo de hello utilizada de forma predeterminada en clústeres de Service Fabric en Azure.</span><span class="sxs-lookup"><span data-stu-id="70dc2-207">This is hello model used by default in Service Fabric clusters in Azure.</span></span> <span data-ttu-id="70dc2-208">Para los clústeres con muchos nodos todo termina sería similar al modelo de matriz densa de hello anterior.</span><span class="sxs-lookup"><span data-stu-id="70dc2-208">For clusters with many nodes everything ends up looking like hello dense matrix pattern above.</span></span>

## <a name="fault-and-upgrade-domain-constraints-and-resulting-behavior"></a><span data-ttu-id="70dc2-209">Restricciones de dominio de error y de actualización y el comportamiento resultante</span><span class="sxs-lookup"><span data-stu-id="70dc2-209">Fault and Upgrade Domain constraints and resulting behavior</span></span>
<span data-ttu-id="70dc2-210">Hola, Administrador de recursos del clúster trata el deseo de hello tookeep un servicio están equilibrados en los dominios de error y actualización como una restricción.</span><span class="sxs-lookup"><span data-stu-id="70dc2-210">hello Cluster Resource Manager treats hello desire tookeep a service balanced across fault and Upgrade Domains as a constraint.</span></span> <span data-ttu-id="70dc2-211">Para más información sobre las restricciones, vea [este artículo](service-fabric-cluster-resource-manager-management-integration.md).</span><span class="sxs-lookup"><span data-stu-id="70dc2-211">You can find out more about constraints in [this article](service-fabric-cluster-resource-manager-management-integration.md).</span></span> <span data-ttu-id="70dc2-212">Hola error y actualización del dominio de estado de restricciones: "para una partición de servicio determinado nunca habrá una diferencia *mayor que uno* en número de Hola de objetos de servicio (instancias de servicio sin estado o réplicas de servicio con estado) entre dos dominios."</span><span class="sxs-lookup"><span data-stu-id="70dc2-212">hello Fault and Upgrade Domain constraints state: "For a given service partition there should never be a difference *greater than one* in hello number of service objects (stateless service instances or stateful service replicas) between two domains."</span></span> <span data-ttu-id="70dc2-213">Esto evita determinados movimientos o disposiciones que infringen esta restricción.</span><span class="sxs-lookup"><span data-stu-id="70dc2-213">This prevents certain moves or arrangements that violate this constraint.</span></span>

<span data-ttu-id="70dc2-214">Veamos un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-214">Let's look at one example.</span></span> <span data-ttu-id="70dc2-215">Supongamos que tenemos un clúster con 6 nodos, configurado con 5 dominios de error y 5 dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-215">Let's say that we have a cluster with six nodes, configured with five Fault Domains and five Upgrade Domains.</span></span>

|  | <span data-ttu-id="70dc2-216">FD0</span><span class="sxs-lookup"><span data-stu-id="70dc2-216">FD0</span></span> | <span data-ttu-id="70dc2-217">FD1</span><span class="sxs-lookup"><span data-stu-id="70dc2-217">FD1</span></span> | <span data-ttu-id="70dc2-218">FD2</span><span class="sxs-lookup"><span data-stu-id="70dc2-218">FD2</span></span> | <span data-ttu-id="70dc2-219">FD3</span><span class="sxs-lookup"><span data-stu-id="70dc2-219">FD3</span></span> | <span data-ttu-id="70dc2-220">FD4</span><span class="sxs-lookup"><span data-stu-id="70dc2-220">FD4</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="70dc2-221">**UD0**</span><span class="sxs-lookup"><span data-stu-id="70dc2-221">**UD0**</span></span> |<span data-ttu-id="70dc2-222">N1</span><span class="sxs-lookup"><span data-stu-id="70dc2-222">N1</span></span> | | | | |
| <span data-ttu-id="70dc2-223">**UD1**</span><span class="sxs-lookup"><span data-stu-id="70dc2-223">**UD1**</span></span> |<span data-ttu-id="70dc2-224">N6</span><span class="sxs-lookup"><span data-stu-id="70dc2-224">N6</span></span> |<span data-ttu-id="70dc2-225">N2</span><span class="sxs-lookup"><span data-stu-id="70dc2-225">N2</span></span> | | | |
| <span data-ttu-id="70dc2-226">**UD2**</span><span class="sxs-lookup"><span data-stu-id="70dc2-226">**UD2**</span></span> | | |<span data-ttu-id="70dc2-227">N3</span><span class="sxs-lookup"><span data-stu-id="70dc2-227">N3</span></span> | | |
| <span data-ttu-id="70dc2-228">**UD3**</span><span class="sxs-lookup"><span data-stu-id="70dc2-228">**UD3**</span></span> | | | |<span data-ttu-id="70dc2-229">N4</span><span class="sxs-lookup"><span data-stu-id="70dc2-229">N4</span></span> | |
| <span data-ttu-id="70dc2-230">**UD4**</span><span class="sxs-lookup"><span data-stu-id="70dc2-230">**UD4**</span></span> | | | | |<span data-ttu-id="70dc2-231">N5</span><span class="sxs-lookup"><span data-stu-id="70dc2-231">N5</span></span> |

<span data-ttu-id="70dc2-232">Ahora supongamos que creamos un servicio con un TargetReplicaSetSize (o, para un servicio sin estado un InstanceCount) de cinco.</span><span class="sxs-lookup"><span data-stu-id="70dc2-232">Now let's say that we create a service with a TargetReplicaSetSize (or, for a stateless service an InstanceCount) of five.</span></span> <span data-ttu-id="70dc2-233">réplicas de Hello llegará a N1 N5.</span><span class="sxs-lookup"><span data-stu-id="70dc2-233">hello replicas land on N1-N5.</span></span> <span data-ttu-id="70dc2-234">De hecho, nunca se usará N6, independientemente del número de servicios como este que cree.</span><span class="sxs-lookup"><span data-stu-id="70dc2-234">In fact, N6 is never used no matter how many services like this you create.</span></span> <span data-ttu-id="70dc2-235">Pero ¿por qué?</span><span class="sxs-lookup"><span data-stu-id="70dc2-235">But why?</span></span> <span data-ttu-id="70dc2-236">Echemos un vistazo a diferencia de hello entre el diseño actual de Hola y lo que sucedería si se elige N6.</span><span class="sxs-lookup"><span data-stu-id="70dc2-236">Let's look at hello difference between hello current layout and what would happen if N6 is chosen.</span></span>

<span data-ttu-id="70dc2-237">Este es el diseño de Hola se obtuvo y Hola número total de réplicas por error y actualización del dominio:</span><span class="sxs-lookup"><span data-stu-id="70dc2-237">Here's hello layout we got and hello total number of replicas per Fault and Upgrade Domain:</span></span>

|  | <span data-ttu-id="70dc2-238">FD0</span><span class="sxs-lookup"><span data-stu-id="70dc2-238">FD0</span></span> | <span data-ttu-id="70dc2-239">FD1</span><span class="sxs-lookup"><span data-stu-id="70dc2-239">FD1</span></span> | <span data-ttu-id="70dc2-240">FD2</span><span class="sxs-lookup"><span data-stu-id="70dc2-240">FD2</span></span> | <span data-ttu-id="70dc2-241">FD3</span><span class="sxs-lookup"><span data-stu-id="70dc2-241">FD3</span></span> | <span data-ttu-id="70dc2-242">FD4</span><span class="sxs-lookup"><span data-stu-id="70dc2-242">FD4</span></span> | <span data-ttu-id="70dc2-243">UDTotal</span><span class="sxs-lookup"><span data-stu-id="70dc2-243">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="70dc2-244">**UD0**</span><span class="sxs-lookup"><span data-stu-id="70dc2-244">**UD0**</span></span> |<span data-ttu-id="70dc2-245">R1</span><span class="sxs-lookup"><span data-stu-id="70dc2-245">R1</span></span> | | | | |<span data-ttu-id="70dc2-246">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-246">1</span></span> |
| <span data-ttu-id="70dc2-247">**UD1**</span><span class="sxs-lookup"><span data-stu-id="70dc2-247">**UD1**</span></span> | |<span data-ttu-id="70dc2-248">R2</span><span class="sxs-lookup"><span data-stu-id="70dc2-248">R2</span></span> | | | |<span data-ttu-id="70dc2-249">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-249">1</span></span> |
| <span data-ttu-id="70dc2-250">**UD2**</span><span class="sxs-lookup"><span data-stu-id="70dc2-250">**UD2**</span></span> | | |<span data-ttu-id="70dc2-251">R3</span><span class="sxs-lookup"><span data-stu-id="70dc2-251">R3</span></span> | | |<span data-ttu-id="70dc2-252">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-252">1</span></span> |
| <span data-ttu-id="70dc2-253">**UD3**</span><span class="sxs-lookup"><span data-stu-id="70dc2-253">**UD3**</span></span> | | | |<span data-ttu-id="70dc2-254">R4</span><span class="sxs-lookup"><span data-stu-id="70dc2-254">R4</span></span> | |<span data-ttu-id="70dc2-255">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-255">1</span></span> |
| <span data-ttu-id="70dc2-256">**UD4**</span><span class="sxs-lookup"><span data-stu-id="70dc2-256">**UD4**</span></span> | | | | |<span data-ttu-id="70dc2-257">R5</span><span class="sxs-lookup"><span data-stu-id="70dc2-257">R5</span></span> |<span data-ttu-id="70dc2-258">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-258">1</span></span> |
| <span data-ttu-id="70dc2-259">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="70dc2-259">**FDTotal**</span></span> |<span data-ttu-id="70dc2-260">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-260">1</span></span> |<span data-ttu-id="70dc2-261">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-261">1</span></span> |<span data-ttu-id="70dc2-262">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-262">1</span></span> |<span data-ttu-id="70dc2-263">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-263">1</span></span> |<span data-ttu-id="70dc2-264">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-264">1</span></span> |- |

<span data-ttu-id="70dc2-265">Este diseño se equilibra en términos de nodos por dominio de error y de actualización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-265">This layout is balanced in terms of nodes per Fault Domain and Upgrade Domain.</span></span> <span data-ttu-id="70dc2-266">También lo está equilibrada en cuanto al número de Hola de réplicas por error y actualización del dominio.</span><span class="sxs-lookup"><span data-stu-id="70dc2-266">It is also balanced in terms of hello number of replicas per Fault and Upgrade Domain.</span></span> <span data-ttu-id="70dc2-267">Cada dominio tiene Hola el mismo número de nodos y Hola el mismo número de réplicas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-267">Each domain has hello same number of nodes and hello same number of replicas.</span></span>

<span data-ttu-id="70dc2-268">Ahora, echemos un vistazo a lo que sucedería si hubiéramos utilizado N6 en lugar de N2.</span><span class="sxs-lookup"><span data-stu-id="70dc2-268">Now, let's look at what would happen if we'd used N6 instead of N2.</span></span> <span data-ttu-id="70dc2-269">¿Cómo réplicas Hola se distribuyen a continuación?</span><span class="sxs-lookup"><span data-stu-id="70dc2-269">How would hello replicas be distributed then?</span></span>

|  | <span data-ttu-id="70dc2-270">FD0</span><span class="sxs-lookup"><span data-stu-id="70dc2-270">FD0</span></span> | <span data-ttu-id="70dc2-271">FD1</span><span class="sxs-lookup"><span data-stu-id="70dc2-271">FD1</span></span> | <span data-ttu-id="70dc2-272">FD2</span><span class="sxs-lookup"><span data-stu-id="70dc2-272">FD2</span></span> | <span data-ttu-id="70dc2-273">FD3</span><span class="sxs-lookup"><span data-stu-id="70dc2-273">FD3</span></span> | <span data-ttu-id="70dc2-274">FD4</span><span class="sxs-lookup"><span data-stu-id="70dc2-274">FD4</span></span> | <span data-ttu-id="70dc2-275">UDTotal</span><span class="sxs-lookup"><span data-stu-id="70dc2-275">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="70dc2-276">**UD0**</span><span class="sxs-lookup"><span data-stu-id="70dc2-276">**UD0**</span></span> |<span data-ttu-id="70dc2-277">R1</span><span class="sxs-lookup"><span data-stu-id="70dc2-277">R1</span></span> | | | | |<span data-ttu-id="70dc2-278">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-278">1</span></span> |
| <span data-ttu-id="70dc2-279">**UD1**</span><span class="sxs-lookup"><span data-stu-id="70dc2-279">**UD1**</span></span> |<span data-ttu-id="70dc2-280">R5</span><span class="sxs-lookup"><span data-stu-id="70dc2-280">R5</span></span> | | | | |<span data-ttu-id="70dc2-281">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-281">1</span></span> |
| <span data-ttu-id="70dc2-282">**UD2**</span><span class="sxs-lookup"><span data-stu-id="70dc2-282">**UD2**</span></span> | | |<span data-ttu-id="70dc2-283">R2</span><span class="sxs-lookup"><span data-stu-id="70dc2-283">R2</span></span> | | |<span data-ttu-id="70dc2-284">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-284">1</span></span> |
| <span data-ttu-id="70dc2-285">**UD3**</span><span class="sxs-lookup"><span data-stu-id="70dc2-285">**UD3**</span></span> | | | |<span data-ttu-id="70dc2-286">R3</span><span class="sxs-lookup"><span data-stu-id="70dc2-286">R3</span></span> | |<span data-ttu-id="70dc2-287">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-287">1</span></span> |
| <span data-ttu-id="70dc2-288">**UD4**</span><span class="sxs-lookup"><span data-stu-id="70dc2-288">**UD4**</span></span> | | | | |<span data-ttu-id="70dc2-289">R4</span><span class="sxs-lookup"><span data-stu-id="70dc2-289">R4</span></span> |<span data-ttu-id="70dc2-290">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-290">1</span></span> |
| <span data-ttu-id="70dc2-291">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="70dc2-291">**FDTotal**</span></span> |<span data-ttu-id="70dc2-292">2</span><span class="sxs-lookup"><span data-stu-id="70dc2-292">2</span></span> |<span data-ttu-id="70dc2-293">0</span><span class="sxs-lookup"><span data-stu-id="70dc2-293">0</span></span> |<span data-ttu-id="70dc2-294">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-294">1</span></span> |<span data-ttu-id="70dc2-295">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-295">1</span></span> |<span data-ttu-id="70dc2-296">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-296">1</span></span> |- |

<span data-ttu-id="70dc2-297">Este diseño infringe la definición de hello restricciones de dominio de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-297">This layout violates our definition for hello Fault Domain constraint.</span></span> <span data-ttu-id="70dc2-298">FD0 tiene dos réplicas, mientras que FD1 tiene cero, hacer diferencia Hola entre FD0 y FD1 un total de dos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-298">FD0 has two replicas, while FD1 has zero, making hello difference between FD0 and FD1 a total of two.</span></span> <span data-ttu-id="70dc2-299">Hola, Administrador de recursos del clúster no permite este tipo de organización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-299">hello Cluster Resource Manager does not allow this arrangement.</span></span> <span data-ttu-id="70dc2-300">De forma similar, si se ha seleccionado N2 y N6 (en lugar de N1 y N2), obtendríamos lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="70dc2-300">Similarly if we picked N2 and N6 (instead of N1 and N2) we'd get:</span></span>

|  | <span data-ttu-id="70dc2-301">FD0</span><span class="sxs-lookup"><span data-stu-id="70dc2-301">FD0</span></span> | <span data-ttu-id="70dc2-302">FD1</span><span class="sxs-lookup"><span data-stu-id="70dc2-302">FD1</span></span> | <span data-ttu-id="70dc2-303">FD2</span><span class="sxs-lookup"><span data-stu-id="70dc2-303">FD2</span></span> | <span data-ttu-id="70dc2-304">FD3</span><span class="sxs-lookup"><span data-stu-id="70dc2-304">FD3</span></span> | <span data-ttu-id="70dc2-305">FD4</span><span class="sxs-lookup"><span data-stu-id="70dc2-305">FD4</span></span> | <span data-ttu-id="70dc2-306">UDTotal</span><span class="sxs-lookup"><span data-stu-id="70dc2-306">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="70dc2-307">**UD0**</span><span class="sxs-lookup"><span data-stu-id="70dc2-307">**UD0**</span></span> | | | | | |<span data-ttu-id="70dc2-308">0</span><span class="sxs-lookup"><span data-stu-id="70dc2-308">0</span></span> |
| <span data-ttu-id="70dc2-309">**UD1**</span><span class="sxs-lookup"><span data-stu-id="70dc2-309">**UD1**</span></span> |<span data-ttu-id="70dc2-310">R5</span><span class="sxs-lookup"><span data-stu-id="70dc2-310">R5</span></span> |<span data-ttu-id="70dc2-311">R1</span><span class="sxs-lookup"><span data-stu-id="70dc2-311">R1</span></span> | | | |<span data-ttu-id="70dc2-312">2</span><span class="sxs-lookup"><span data-stu-id="70dc2-312">2</span></span> |
| <span data-ttu-id="70dc2-313">**UD2**</span><span class="sxs-lookup"><span data-stu-id="70dc2-313">**UD2**</span></span> | | |<span data-ttu-id="70dc2-314">R2</span><span class="sxs-lookup"><span data-stu-id="70dc2-314">R2</span></span> | | |<span data-ttu-id="70dc2-315">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-315">1</span></span> |
| <span data-ttu-id="70dc2-316">**UD3**</span><span class="sxs-lookup"><span data-stu-id="70dc2-316">**UD3**</span></span> | | | |<span data-ttu-id="70dc2-317">R3</span><span class="sxs-lookup"><span data-stu-id="70dc2-317">R3</span></span> | |<span data-ttu-id="70dc2-318">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-318">1</span></span> |
| <span data-ttu-id="70dc2-319">**UD4**</span><span class="sxs-lookup"><span data-stu-id="70dc2-319">**UD4**</span></span> | | | | |<span data-ttu-id="70dc2-320">R4</span><span class="sxs-lookup"><span data-stu-id="70dc2-320">R4</span></span> |<span data-ttu-id="70dc2-321">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-321">1</span></span> |
| <span data-ttu-id="70dc2-322">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="70dc2-322">**FDTotal**</span></span> |<span data-ttu-id="70dc2-323">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-323">1</span></span> |<span data-ttu-id="70dc2-324">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-324">1</span></span> |<span data-ttu-id="70dc2-325">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-325">1</span></span> |<span data-ttu-id="70dc2-326">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-326">1</span></span> |<span data-ttu-id="70dc2-327">1</span><span class="sxs-lookup"><span data-stu-id="70dc2-327">1</span></span> |- |

<span data-ttu-id="70dc2-328">Este diseño se equilibra en cuanto a dominios de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-328">This layout is balanced in terms of Fault Domains.</span></span> <span data-ttu-id="70dc2-329">Sin embargo, ahora está infracción de restricción de la actualización del dominio de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-329">However, now it's violating hello Upgrade Domain constraint.</span></span> <span data-ttu-id="70dc2-330">Esto es porque UD0 tiene cero réplicas, mientras que UD1 tiene dos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-330">This is because UD0 has zero replicas while UD1 has two.</span></span> <span data-ttu-id="70dc2-331">Por lo tanto, este diseño también es válido y no pueden seleccionar por Hola, Administrador de recursos del clúster.</span><span class="sxs-lookup"><span data-stu-id="70dc2-331">Therefore, this layout is also invalid and won't be picked by hello Cluster Resource Manager.</span></span> 

## <a name="configuring-fault-and-upgrade-domains"></a><span data-ttu-id="70dc2-332">Configuración de dominios de error y de actualización</span><span class="sxs-lookup"><span data-stu-id="70dc2-332">Configuring fault and Upgrade Domains</span></span>
<span data-ttu-id="70dc2-333">La definición de dominios de error y de actualización se realiza automáticamente en las implementaciones de Service Fabric hospedadas en Azure.</span><span class="sxs-lookup"><span data-stu-id="70dc2-333">Defining Fault Domains and Upgrade Domains is done automatically in Azure hosted Service Fabric deployments.</span></span> <span data-ttu-id="70dc2-334">Service Fabric recoge y usa información del entorno Hola de Azure.</span><span class="sxs-lookup"><span data-stu-id="70dc2-334">Service Fabric picks up and uses hello environment information from Azure.</span></span>

<span data-ttu-id="70dc2-335">Si va a crear su propio clúster (o quiere toorun una determinada topología en desarrollo), puede proporcionar información de dominio de error y actualización del dominio de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-335">If you’re creating your own cluster (or want toorun a particular topology in development), you can provide hello Fault Domain and Upgrade Domain information yourself.</span></span> <span data-ttu-id="70dc2-336">En este ejemplo, definimos un clúster de desarrollo local de nueve nodos que abarca tres centros de datos (cada uno con tres bastidores).</span><span class="sxs-lookup"><span data-stu-id="70dc2-336">In this example, we define a nine node local development cluster that spans three “datacenters” (each with three racks).</span></span> <span data-ttu-id="70dc2-337">Este clúster también tiene tres dominios de actualización seccionados en esos tres centros de datos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-337">This cluster also has three Upgrade Domains striped across those three datacenters.</span></span> <span data-ttu-id="70dc2-338">Es un ejemplo de configuración de Hola a continuación:</span><span class="sxs-lookup"><span data-stu-id="70dc2-338">An example of hello configuration is below:</span></span> 

<span data-ttu-id="70dc2-339">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="70dc2-339">ClusterManifest.xml</span></span>

```xml
  <Infrastructure>
    <!-- IsScaleMin indicates that this cluster runs on one-box /one single server -->
    <WindowsServer IsScaleMin="true">
      <NodeList>
        <Node NodeName="Node01" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType01" FaultDomain="fd:/DC01/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node02" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType02" FaultDomain="fd:/DC01/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node03" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType03" FaultDomain="fd:/DC01/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node04" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType04" FaultDomain="fd:/DC02/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node05" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType05" FaultDomain="fd:/DC02/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node06" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType06" FaultDomain="fd:/DC02/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node07" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType07" FaultDomain="fd:/DC03/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node08" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType08" FaultDomain="fd:/DC03/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node09" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType09" FaultDomain="fd:/DC03/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
      </NodeList>
    </WindowsServer>
  </Infrastructure>
```

<span data-ttu-id="70dc2-340">a través de ClusterConfig.json para las implementaciones independientes</span><span class="sxs-lookup"><span data-stu-id="70dc2-340">via ClusterConfig.json for Standalone deployments</span></span>

```json
"nodes": [
  {
    "nodeName": "vm1",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm2",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm3",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm4",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm5",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm6",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm7",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm8",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm9",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD3"
  }
],
```

> [!NOTE]
> <span data-ttu-id="70dc2-341">Al definir los clústeres a través de Azure Resource Manager, Azure asigna dominios de error y dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="70dc2-341">When defining clusters via Azure Resource Manager, Fault Domains and Upgrade Domains are assigned by Azure.</span></span> <span data-ttu-id="70dc2-342">Por lo tanto, la definición de Hola de los tipos de nodos y conjuntos de escalas de máquina Virtual en la plantilla de administrador de recursos de Azure no incluye información de actualización del dominio o dominio de error.</span><span class="sxs-lookup"><span data-stu-id="70dc2-342">Therefore, hello definition of your Node Types and Virtual Machine Scale Sets in your Azure Resource Manager template does not include Fault Domain or Upgrade Domain information.</span></span>
>

## <a name="node-properties-and-placement-constraints"></a><span data-ttu-id="70dc2-343">Restricciones de ubicación y propiedades de nodo</span><span class="sxs-lookup"><span data-stu-id="70dc2-343">Node properties and placement constraints</span></span>
<span data-ttu-id="70dc2-344">A veces (de hecho, la mayoría de las veces de Hola) que vaya tooensure toowant que ciertas cargas de trabajo se ejecutan únicamente de determinados tipos de nodos de clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-344">Sometimes (in fact, most of hello time) you’re going toowant tooensure that certain workloads run only on certain types of nodes in hello cluster.</span></span> <span data-ttu-id="70dc2-345">Por ejemplo, algunas cargas de trabajo pueden requerir GPU o SSD, al contrario que otras.</span><span class="sxs-lookup"><span data-stu-id="70dc2-345">For example, some workload may require GPUs or SSDs while others may not.</span></span> <span data-ttu-id="70dc2-346">Un buen ejemplo de destinar las cargas de trabajo tooparticular de hardware está disponible casi cada arquitectura de n niveles.</span><span class="sxs-lookup"><span data-stu-id="70dc2-346">A great example of targeting hardware tooparticular workloads is almost every n-tier architecture out there.</span></span> <span data-ttu-id="70dc2-347">Determinadas máquinas sirven como Hola front-end o API que sirve al lado de la aplicación hello y son clientes toohello expuesto u Hola internet.</span><span class="sxs-lookup"><span data-stu-id="70dc2-347">Certain machines serve as hello front end or API serving side of hello application and are exposed toohello clients or hello internet.</span></span> <span data-ttu-id="70dc2-348">Equipos diferentes, a menudo con recursos de hardware diferente, controlan trabajo Hola de capas de compute o almacenamiento de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-348">Different machines, often with different hardware resources, handle hello work of hello compute or storage layers.</span></span> <span data-ttu-id="70dc2-349">Estos suelen ser _no_ directamente expuestos tooclients u Hola internet.</span><span class="sxs-lookup"><span data-stu-id="70dc2-349">These are usually _not_ directly exposed tooclients or hello internet.</span></span> <span data-ttu-id="70dc2-350">Tejido de servicio espera que hay casos en que las cargas de trabajo concretas tenga toorun en las configuraciones de hardware determinado.</span><span class="sxs-lookup"><span data-stu-id="70dc2-350">Service Fabric expects that there are cases where particular workloads need toorun on particular hardware configurations.</span></span> <span data-ttu-id="70dc2-351">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="70dc2-351">For example:</span></span>

* <span data-ttu-id="70dc2-352">una aplicación de n niveles existente se ha transferido "tal cual" a un entorno de Service Fabric;</span><span class="sxs-lookup"><span data-stu-id="70dc2-352">an existing n-tier application has been “lifted and shifted” into a Service Fabric environment</span></span>
* <span data-ttu-id="70dc2-353">una carga de trabajo desea toorun en hardware específico por motivos de aislamiento de seguridad, de escala o de rendimiento</span><span class="sxs-lookup"><span data-stu-id="70dc2-353">a workload wants toorun on specific hardware for performance, scale, or security isolation reasons</span></span>
* <span data-ttu-id="70dc2-354">una carga de trabajo debe estar aislada de otras por una directiva o a causa del consumo de recursos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-354">A workload should be isolated from other workloads for policy or resource consumption reasons</span></span>

<span data-ttu-id="70dc2-355">Servicio de estos tipos de configuraciones, toosupport tejido tiene una noción de primera clase de etiquetas que pueden ser toonodes aplicada.</span><span class="sxs-lookup"><span data-stu-id="70dc2-355">toosupport these sorts of configurations, Service Fabric has a first class notion of tags that can be applied toonodes.</span></span> <span data-ttu-id="70dc2-356">Estas etiquetas se denominan **propiedades del nodo**.</span><span class="sxs-lookup"><span data-stu-id="70dc2-356">These tags are called **node properties**.</span></span> <span data-ttu-id="70dc2-357">**Las restricciones de posición** son instrucciones de hello adjuntos tooindividual servicios que seleccione para una o más propiedades de nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-357">**Placement constraints** are hello statements attached tooindividual services that select for one or more node properties.</span></span> <span data-ttu-id="70dc2-358">Las restricciones de posición definen dónde deben ejecutarse los servicios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-358">Placement constraints define where services should run.</span></span> <span data-ttu-id="70dc2-359">Hola conjunto de restricciones es extensible; puede trabajar cualquier par de clave/valor.</span><span class="sxs-lookup"><span data-stu-id="70dc2-359">hello set of constraints is extensible - any key/value pair can work.</span></span> 

<span data-ttu-id="70dc2-360"><center>
![Diferentes cargas de trabajo por diseño de clúster][Image5]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-360"><center>
![Cluster Layout Different Workloads][Image5]
</center></span></span>

### <a name="built-in-node-properties"></a><span data-ttu-id="70dc2-361">Propiedades del nodo integradas</span><span class="sxs-lookup"><span data-stu-id="70dc2-361">Built in node properties</span></span>
<span data-ttu-id="70dc2-362">Service Fabric define algunas propiedades de nodo predeterminado que se pueden usar automáticamente sin que tenga toodefine de usuario de hello ellos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-362">Service Fabric defines some default node properties that can be used automatically without hello user having toodefine them.</span></span> <span data-ttu-id="70dc2-363">propiedades predeterminadas de Hello definidas en cada nodo son hello **NodeType** hello y **NodeName**.</span><span class="sxs-lookup"><span data-stu-id="70dc2-363">hello default properties defined at each node are hello **NodeType** and hello **NodeName**.</span></span> <span data-ttu-id="70dc2-364">Por ejemplo, podría escribir una restricción de selección de ubicación como `"(NodeType == NodeType03)"`.</span><span class="sxs-lookup"><span data-stu-id="70dc2-364">So for example you could write a placement constraint as `"(NodeType == NodeType03)"`.</span></span> <span data-ttu-id="70dc2-365">Por lo general encontramos NodeType toobe una de las propiedades de hello más frecuente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-365">Generally we have found NodeType toobe one of hello most commonly used properties.</span></span> <span data-ttu-id="70dc2-366">Es útil, ya que corresponde a 1:1 con un tipo de una máquina.</span><span class="sxs-lookup"><span data-stu-id="70dc2-366">It is useful since it corresponds 1:1 with a type of a machine.</span></span> <span data-ttu-id="70dc2-367">Cada tipo de máquina corresponde tooa tipo de carga de trabajo en una aplicación de n niveles tradicional.</span><span class="sxs-lookup"><span data-stu-id="70dc2-367">Each type of machine corresponds tooa type of workload in a traditional n-tier application.</span></span>

<span data-ttu-id="70dc2-368"><center>
![Restricciones de selección de ubicación y propiedades de nodo][Image6]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-368"><center>
![Placement Constraints and Node Properties][Image6]
</center></span></span>

## <a name="placement-constraint-and-node-property-syntax"></a><span data-ttu-id="70dc2-369">Restricciones de colocación y sintaxis de propiedades de nodo</span><span class="sxs-lookup"><span data-stu-id="70dc2-369">Placement Constraint and Node Property Syntax</span></span> 
<span data-ttu-id="70dc2-370">valor de Hello especificado en la propiedad de nodo de hello puede ser una cadena, bool, o long con signo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-370">hello value specified in hello node property can be a string, bool, or signed long.</span></span> <span data-ttu-id="70dc2-371">declaración de Hello en el servicio de Hola se denomina una colocación *restricción* puesto que restringe donde puede ejecutar el servicio hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-371">hello statement at hello service is called a placement *constraint* since it constrains where hello service can run in hello cluster.</span></span> <span data-ttu-id="70dc2-372">restricción de Hello puede ser cualquier instrucción booleano que opera en las propiedades de otro nodo de hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-372">hello constraint can be any Boolean statement that operates on hello different node properties in hello cluster.</span></span> <span data-ttu-id="70dc2-373">selectores válido de Hello en estas instrucciones booleanos son:</span><span class="sxs-lookup"><span data-stu-id="70dc2-373">hello valid selectors in these boolean statements are:</span></span>

1) <span data-ttu-id="70dc2-374">comprobaciones condicionales para crear instrucciones concretas</span><span class="sxs-lookup"><span data-stu-id="70dc2-374">conditional checks for creating particular statements</span></span>

| <span data-ttu-id="70dc2-375">Instrucción</span><span class="sxs-lookup"><span data-stu-id="70dc2-375">Statement</span></span> | <span data-ttu-id="70dc2-376">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="70dc2-376">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="70dc2-377">"equal to"</span><span class="sxs-lookup"><span data-stu-id="70dc2-377">"equal to"</span></span> | <span data-ttu-id="70dc2-378">"=="</span><span class="sxs-lookup"><span data-stu-id="70dc2-378">"=="</span></span> |
| <span data-ttu-id="70dc2-379">"not equal to"</span><span class="sxs-lookup"><span data-stu-id="70dc2-379">"not equal to"</span></span> | <span data-ttu-id="70dc2-380">"!="</span><span class="sxs-lookup"><span data-stu-id="70dc2-380">"!="</span></span> |
| <span data-ttu-id="70dc2-381">"greater than"</span><span class="sxs-lookup"><span data-stu-id="70dc2-381">"greater than"</span></span> | <span data-ttu-id="70dc2-382">">"</span><span class="sxs-lookup"><span data-stu-id="70dc2-382">">"</span></span> |
| <span data-ttu-id="70dc2-383">"greater than or equal to"</span><span class="sxs-lookup"><span data-stu-id="70dc2-383">"greater than or equal to"</span></span> | <span data-ttu-id="70dc2-384">">="</span><span class="sxs-lookup"><span data-stu-id="70dc2-384">">="</span></span> |
| <span data-ttu-id="70dc2-385">"less than"</span><span class="sxs-lookup"><span data-stu-id="70dc2-385">"less than"</span></span> | <span data-ttu-id="70dc2-386">"<"</span><span class="sxs-lookup"><span data-stu-id="70dc2-386">"<"</span></span> |
| <span data-ttu-id="70dc2-387">"less than or equal to"</span><span class="sxs-lookup"><span data-stu-id="70dc2-387">"less than or equal to"</span></span> | <span data-ttu-id="70dc2-388">"<="</span><span class="sxs-lookup"><span data-stu-id="70dc2-388">"<="</span></span> |

2) <span data-ttu-id="70dc2-389">Instrucciones booleanas para operaciones lógicas y de agrupación</span><span class="sxs-lookup"><span data-stu-id="70dc2-389">boolean statements for grouping and logical operations</span></span>

| <span data-ttu-id="70dc2-390">Instrucción</span><span class="sxs-lookup"><span data-stu-id="70dc2-390">Statement</span></span> | <span data-ttu-id="70dc2-391">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="70dc2-391">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="70dc2-392">"and"</span><span class="sxs-lookup"><span data-stu-id="70dc2-392">"and"</span></span> | <span data-ttu-id="70dc2-393">"&&"</span><span class="sxs-lookup"><span data-stu-id="70dc2-393">"&&"</span></span> |
| <span data-ttu-id="70dc2-394">"or"</span><span class="sxs-lookup"><span data-stu-id="70dc2-394">"or"</span></span> | <span data-ttu-id="70dc2-395">"&#124;&#124;"</span><span class="sxs-lookup"><span data-stu-id="70dc2-395">"&#124;&#124;"</span></span> |
| <span data-ttu-id="70dc2-396">"not"</span><span class="sxs-lookup"><span data-stu-id="70dc2-396">"not"</span></span> | <span data-ttu-id="70dc2-397">"!"</span><span class="sxs-lookup"><span data-stu-id="70dc2-397">"!"</span></span> |
| <span data-ttu-id="70dc2-398">"group as single statement"</span><span class="sxs-lookup"><span data-stu-id="70dc2-398">"group as single statement"</span></span> | <span data-ttu-id="70dc2-399">"()"</span><span class="sxs-lookup"><span data-stu-id="70dc2-399">"()"</span></span> |

<span data-ttu-id="70dc2-400">Estos son algunos ejemplos de instrucciones de restricción básicas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-400">Here are some examples of basic constraint statements.</span></span>

  * `"Value >= 5"`
  * `"NodeColor != green"`
  * `"((OneProperty < 100) || ((AnotherProperty == false) && (OneProperty >= 100)))"`

<span data-ttu-id="70dc2-401">Sólo los nodos donde hello general colocación restricción instrucción da como resultado demasiado "True" pueden tener servicio Hola colocado en él.</span><span class="sxs-lookup"><span data-stu-id="70dc2-401">Only nodes where hello overall placement constraint statement evaluates too“True” can have hello service placed on it.</span></span> <span data-ttu-id="70dc2-402">Los nodos que no tengan definida ninguna propiedad no coinciden con ninguna restricción de selección de ubicación que contenga esa propiedad.</span><span class="sxs-lookup"><span data-stu-id="70dc2-402">Nodes that do not have a property defined do not match any placement constraint containing that property.</span></span>

<span data-ttu-id="70dc2-403">Supongamos que Hola siguiente nodo propiedades se definen para un tipo de nodo determinado:</span><span class="sxs-lookup"><span data-stu-id="70dc2-403">Let’s say that hello following node properties were defined for a given node type:</span></span>

<span data-ttu-id="70dc2-404">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="70dc2-404">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType01">
      <PlacementProperties>
        <Property Name="HasSSD" Value="true"/>
        <Property Name="NodeColor" Value="green"/>
        <Property Name="SomeProperty" Value="5"/>
      </PlacementProperties>
    </NodeType>
```

<span data-ttu-id="70dc2-405">a través de ClusterConfig.json para las implementaciones independientes o Template.json para los clústeres hospedados en Azure.</span><span class="sxs-lookup"><span data-stu-id="70dc2-405">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

> [!NOTE]
> <span data-ttu-id="70dc2-406">En el nodo de Azure Resource Manager plantilla Hola tipo normalmente tiene parámetros.</span><span class="sxs-lookup"><span data-stu-id="70dc2-406">In your Azure Resource Manager template hello node type is usually parameterized.</span></span> <span data-ttu-id="70dc2-407">Tendría el siguiente aspecto "[parameters('vmNodeType1Name')]", en lugar de "NodeType01".</span><span class="sxs-lookup"><span data-stu-id="70dc2-407">It would look like "[parameters('vmNodeType1Name')]" rather than "NodeType01".</span></span>
>

```json
"nodeTypes": [
    {
        "name": "NodeType01",
        "placementProperties": {
            "HasSSD": "true",
            "NodeColor": "green",
            "SomeProperty": "5"
        },
    }
],
```

<span data-ttu-id="70dc2-408">Puede crear *restricciones* de selección de ubicación para un servicio de forma parecida a esta:</span><span class="sxs-lookup"><span data-stu-id="70dc2-408">You can create service placement *constraints* for a service like as follows:</span></span>

<span data-ttu-id="70dc2-409">C#</span><span class="sxs-lookup"><span data-stu-id="70dc2-409">C#</span></span>

```csharp
FabricClient fabricClient = new FabricClient();
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
serviceDescription.PlacementConstraints = "(HasSSD == true && SomeProperty >= 4)";
// add other required servicedescription fields
//...
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="70dc2-410">Powershell:</span><span class="sxs-lookup"><span data-stu-id="70dc2-410">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceType -Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton -PlacementConstraint "HasSSD == true && SomeProperty >= 4"
```

<span data-ttu-id="70dc2-411">Si todos los nodos de NodeType01 son válidos, también puede seleccionar ese tipo de nodo con la restricción de hello "(NodeType == NodeType01)".</span><span class="sxs-lookup"><span data-stu-id="70dc2-411">If all nodes of NodeType01 are valid, you can also select that node type with hello constraint "(NodeType == NodeType01)".</span></span>

<span data-ttu-id="70dc2-412">Una de hello cosas interesantes sobre las restricciones de posición de un servicio es que se puede actualizar dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="70dc2-412">One of hello cool things about a service’s placement constraints is that they can be updated dynamically during runtime.</span></span> <span data-ttu-id="70dc2-413">Por lo que si necesita, puede moverse un servicio en clúster de hello, agregar y quitar los requisitos, etcetera. Tejido de servicio se encarga de asegurarse de que servicio Hola mantiene la seguridad y disponibles incluso cuando se realizan estos tipos de cambios.</span><span class="sxs-lookup"><span data-stu-id="70dc2-413">So if you need to, you can move a service around in hello cluster, add and remove requirements, etc. Service Fabric takes care of ensuring that hello service stays up and available even when these types of changes are made.</span></span>

<span data-ttu-id="70dc2-414">C#:</span><span class="sxs-lookup"><span data-stu-id="70dc2-414">C#:</span></span>

```csharp
StatefulServiceUpdateDescription updateDescription = new StatefulServiceUpdateDescription();
updateDescription.PlacementConstraints = "NodeType == NodeType01";
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="70dc2-415">Powershell:</span><span class="sxs-lookup"><span data-stu-id="70dc2-415">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateful -ServiceName $serviceName -PlacementConstraints "NodeType == NodeType01"
```

<span data-ttu-id="70dc2-416">Las restricciones de colocación se especifican para cada instancia de servicio con nombre diferente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-416">Placement constraints are specified for every different named service instance.</span></span> <span data-ttu-id="70dc2-417">Siempre producirán actualizaciones Hola de (sobrescribir) lo que especificó previamente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-417">Updates always take hello place of (overwrite) what was previously specified.</span></span>

<span data-ttu-id="70dc2-418">definición del clúster Hola define propiedades de hello en un nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-418">hello cluster definition defines hello properties on a node.</span></span> <span data-ttu-id="70dc2-419">Cambiar las propiedades de un nodo requiere una actualización de la configuración del clúster.</span><span class="sxs-lookup"><span data-stu-id="70dc2-419">Changing a node's properties requires a cluster configuration upgrade.</span></span> <span data-ttu-id="70dc2-420">Actualizar propiedades de un nodo requiere cada tooreport de toorestart nodo afectado sus nuevas propiedades.</span><span class="sxs-lookup"><span data-stu-id="70dc2-420">Upgrading a node's properties requires each affected node toorestart tooreport its new properties.</span></span> <span data-ttu-id="70dc2-421">Service Fabric administra estas actualizaciones sucesivas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-421">These rolling upgrades are managed by Service Fabric.</span></span>

## <a name="describing-and-managing-cluster-resources"></a><span data-ttu-id="70dc2-422">Descripción y administración de recursos de clúster</span><span class="sxs-lookup"><span data-stu-id="70dc2-422">Describing and Managing Cluster Resources</span></span>
<span data-ttu-id="70dc2-423">Uno de los más importantes de trabajos de cualquier orchestrator es toohelp Hola administrar el consumo de recursos en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-423">One of hello most important jobs of any orchestrator is toohelp manage resource consumption in hello cluster.</span></span> <span data-ttu-id="70dc2-424">La administración de recursos de clúster puede significar un par de cosas diferentes.</span><span class="sxs-lookup"><span data-stu-id="70dc2-424">Managing cluster resources can mean a couple of different things.</span></span> <span data-ttu-id="70dc2-425">En primer lugar, hay es asegurarse de que las máquinas no estén sobrecargadas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-425">First, there's ensuring that machines are not overloaded.</span></span> <span data-ttu-id="70dc2-426">Esto significa asegurarse de que las máquinas no estén ejecutando más servicios de los que puede administrar.</span><span class="sxs-lookup"><span data-stu-id="70dc2-426">This means making sure that machines aren't running more services than they can handle.</span></span> <span data-ttu-id="70dc2-427">En segundo lugar, no hay equilibrio y la optimización que es crítica toorunning servicios eficazmente.</span><span class="sxs-lookup"><span data-stu-id="70dc2-427">Second, there's balancing and optimization which is critical toorunning services efficiently.</span></span> <span data-ttu-id="70dc2-428">Ofertas de servicio con información confidencial eficaces o rendimiento costos no permiten algunos toobe nodos activa mientras que otros están inactivos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-428">Cost effective or performance sensitive service offerings can't allow some nodes toobe hot while others are cold.</span></span> <span data-ttu-id="70dc2-429">Los nodos activos provocar contención tooresource y un rendimiento bajo y nodos inactivos representan desaprovechado recursos y aumentar los costos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-429">Hot nodes lead tooresource contention and poor performance, and cold nodes represent wasted resources and increased costs.</span></span> 

<span data-ttu-id="70dc2-430">Service Fabric representa los recursos como `Metrics`.</span><span class="sxs-lookup"><span data-stu-id="70dc2-430">Service Fabric represents resources as `Metrics`.</span></span> <span data-ttu-id="70dc2-431">Las métricas son cualquier recurso físico o lógico que desea toodescribe tooService tejido.</span><span class="sxs-lookup"><span data-stu-id="70dc2-431">Metrics are any logical or physical resource that you want toodescribe tooService Fabric.</span></span> <span data-ttu-id="70dc2-432">Algunos ejemplos de métricas son elementos como "WorkQueueDepth" o "MemoryInMb".</span><span class="sxs-lookup"><span data-stu-id="70dc2-432">Examples of metrics are things like “WorkQueueDepth” or “MemoryInMb”.</span></span> <span data-ttu-id="70dc2-433">Para obtener información acerca de los recursos físicos de Hola que puede administrar el tejido de servicio en los nodos, consulte [regulador de recursos](service-fabric-resource-governance.md).</span><span class="sxs-lookup"><span data-stu-id="70dc2-433">For information about hello physical resources that Service Fabric can govern on nodes, see [resource governance](service-fabric-resource-governance.md).</span></span> <span data-ttu-id="70dc2-434">Para obtener información sobre la configuración de métricas personalizadas y sus usos, vea [este artículo](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="70dc2-434">For information on configuring custom metrics and their uses, see [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

<span data-ttu-id="70dc2-435">Las métricas se diferencian de las restricciones de selección ubicación y de las propiedades de nodo</span><span class="sxs-lookup"><span data-stu-id="70dc2-435">Metrics are different from placements constraints and node properties.</span></span> <span data-ttu-id="70dc2-436">Propiedades de nodo son estáticos descriptores de nodos de Hola por sí mismos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-436">Node properties are static descriptors of hello nodes themselves.</span></span> <span data-ttu-id="70dc2-437">Las métricas describen recursos que tienen nodos y que los servicios usan cuando se ejecutan en un nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-437">Metrics describe resources that nodes have and that services consume when they are run on a node.</span></span> <span data-ttu-id="70dc2-438">Una propiedad de nodo podría ser "HasSSD" y puede establecerse tootrue o false.</span><span class="sxs-lookup"><span data-stu-id="70dc2-438">A node property could be "HasSSD" and could be set tootrue or false.</span></span> <span data-ttu-id="70dc2-439">cantidad de Hola de espacio disponible en ese SSD y cuánto se consume Services sería una métrica como "DriveSpaceInMb".</span><span class="sxs-lookup"><span data-stu-id="70dc2-439">hello amount of space available on that SSD and how much is consumed by services would be a metric like “DriveSpaceInMb”.</span></span> 

<span data-ttu-id="70dc2-440">Es importante toonote que al igual que para las restricciones de posición y las propiedades de nodo, Hola, Administrador de recursos de clúster de servicio de Fabric no comprende qué nombres Hola de Media de las métricas de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-440">It is important toonote that just like for placement constraints and node properties, hello Service Fabric Cluster Resource Manager doesn't understand what hello names of hello metrics mean.</span></span> <span data-ttu-id="70dc2-441">ya que son simplemente cadenas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-441">Metric names are just strings.</span></span> <span data-ttu-id="70dc2-442">Es un unidades de toodeclare recomendable como parte de los nombres de métrica de Hola que crea al pueden ser ambigua.</span><span class="sxs-lookup"><span data-stu-id="70dc2-442">It is a good practice toodeclare units as a part of hello metric names that you create when it could be ambiguous.</span></span>

## <a name="capacity"></a><span data-ttu-id="70dc2-443">Capacity</span><span class="sxs-lookup"><span data-stu-id="70dc2-443">Capacity</span></span>
<span data-ttu-id="70dc2-444">Si desactivó todo el *equilibrio*de recursos, la utilidad Cluster Resource Manager de Service Fabric aún podría asegurarse de que ningún nodo terminara superando su capacidad.</span><span class="sxs-lookup"><span data-stu-id="70dc2-444">If you turned off all resource *balancing*, Service Fabric’s Cluster Resource Manager would still ensure that no node ended up over its capacity.</span></span> <span data-ttu-id="70dc2-445">Es posible administrar saturaciones de capacidad a menos que el clúster de hello está demasiado lleno o cargas de trabajo de hello es mayor que cualquier nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-445">Managing capacity overruns is possible unless hello cluster is too full or hello workload is larger than any node.</span></span> <span data-ttu-id="70dc2-446">La capacidad es otro *restricción* ese administrador de recursos del clúster de hello usa toounderstand la cantidad de un recurso de un nodo tiene.</span><span class="sxs-lookup"><span data-stu-id="70dc2-446">Capacity is another *constraint* that hello Cluster Resource Manager uses toounderstand how much of a resource a node has.</span></span> <span data-ttu-id="70dc2-447">Capacidad restante es también realiza un seguimiento para clúster Hola como un todo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-447">Remaining capacity is also tracked for hello cluster as a whole.</span></span> <span data-ttu-id="70dc2-448">Capacidad de Hola y el consumo de hello en el nivel del servicio de Hola se expresan en términos de métricas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-448">Both hello capacity and hello consumption at hello service level are expressed in terms of metrics.</span></span> <span data-ttu-id="70dc2-449">Por ejemplo, métrica Hola podría ser "ClientConnections" y un nodo determinado puede tener una capacidad de "ClientConnections" de 32768.</span><span class="sxs-lookup"><span data-stu-id="70dc2-449">So for example, hello metric might be "ClientConnections" and a given Node may have a capacity for "ClientConnections" of 32768.</span></span> <span data-ttu-id="70dc2-450">Otros nodos pueden tener otros límites algún servicio que se ejecuta en ese nodo puede decir está actualmente consumiendo 32256 de métrica de Hola "ClientConnections".</span><span class="sxs-lookup"><span data-stu-id="70dc2-450">Other nodes can have other limits Some service running on that node can say it is currently consuming 32256 of hello metric "ClientConnections".</span></span>

<span data-ttu-id="70dc2-451">En tiempo de ejecución, Hola, Administrador de recursos del clúster realiza un seguimiento de capacidad restante en el clúster de Hola y en los nodos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-451">During runtime, hello Cluster Resource Manager tracks remaining capacity in hello cluster and on nodes.</span></span> <span data-ttu-id="70dc2-452">En orden tootrack Hola capacidad Administrador de recursos del clúster resta el uso de cada servicio en la capacidad del nodo donde se ejecuta el servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-452">In order tootrack capacity hello Cluster Resource Manager subtracts each service's usage from node's capacity where hello service runs.</span></span> <span data-ttu-id="70dc2-453">Con esta información, Hola, Administrador de recursos de clúster de tejido de servicio puede averiguar dónde tooplace o mover las réplicas para que los nodos no pasan por la capacidad.</span><span class="sxs-lookup"><span data-stu-id="70dc2-453">With this information, hello Service Fabric Cluster Resource Manager can figure out where tooplace or move replicas so that nodes don’t go over capacity.</span></span>

<span data-ttu-id="70dc2-454"><center>
![Nodos del clúster y capacidad][Image7]
</center></span><span class="sxs-lookup"><span data-stu-id="70dc2-454"><center>
![Cluster nodes and capacity][Image7]
</center></span></span>

<span data-ttu-id="70dc2-455">C#:</span><span class="sxs-lookup"><span data-stu-id="70dc2-455">C#:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
ServiceLoadMetricDescription metric = new ServiceLoadMetricDescription();
metric.Name = "ClientConnections";
metric.PrimaryDefaultLoad = 1024;
metric.SecondaryDefaultLoad = 0;
metric.Weight = ServiceLoadMetricWeight.High;
serviceDescription.Metrics.Add(metric);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="70dc2-456">Powershell:</span><span class="sxs-lookup"><span data-stu-id="70dc2-456">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ClientConnections,High,1024,0)
```

<span data-ttu-id="70dc2-457">Puede ver las capacidades definidas en el manifiesto de clúster de hello:</span><span class="sxs-lookup"><span data-stu-id="70dc2-457">You can see capacities defined in hello cluster manifest:</span></span>

<span data-ttu-id="70dc2-458">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="70dc2-458">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType03">
      <Capacities>
        <Capacity Name="ClientConnections" Value="65536"/>
      </Capacities>
    </NodeType>
```

<span data-ttu-id="70dc2-459">a través de ClusterConfig.json para las implementaciones independientes o Template.json para los clústeres hospedados en Azure.</span><span class="sxs-lookup"><span data-stu-id="70dc2-459">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

```json
"nodeTypes": [
    {
        "name": "NodeType03",
        "capacities": {
            "ClientConnections": "65536",
        }
    }
],
```

<span data-ttu-id="70dc2-460">Normalmente, una carga de un servicio cambia de forma dinámica.</span><span class="sxs-lookup"><span data-stu-id="70dc2-460">Commonly a service’s load changes dynamically.</span></span> <span data-ttu-id="70dc2-461">Supongamos que carga la réplica de "ClientConnections" cambia de 1024 too2048, pero aparece un nodo de Hola se estaba ejecutando en, a continuación, solo pudiera guiarse por 512 capacidad restante para esa métrica.</span><span class="sxs-lookup"><span data-stu-id="70dc2-461">Say that a replica's load of "ClientConnections" changed from 1024 too2048, but hello node it was running on then only had 512 capacity remaining for that metric.</span></span> <span data-ttu-id="70dc2-462">Ahora, esa selección de ubicación de la instancia o réplica no es válida porque no hay suficiente espacio en ese nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-462">Now that replica or instance's placement is invalid, since there's not enough room on that node.</span></span> <span data-ttu-id="70dc2-463">Hola, Administrador de recursos del clúster tiene tookick y obtenga Hola nodo bajo su capacidad.</span><span class="sxs-lookup"><span data-stu-id="70dc2-463">hello Cluster Resource Manager has tookick in and get hello node back below capacity.</span></span> <span data-ttu-id="70dc2-464">Reduce la carga en el nodo de Hola que está por encima de la capacidad moviendo una o varias de las réplicas de Hola o instancias de ese nodo tooother nodos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-464">It reduces load on hello node that is over capacity by moving one or more of hello replicas or instances from that node tooother nodes.</span></span> <span data-ttu-id="70dc2-465">Al mover las réplicas, Hola, Administrador de recursos del clúster intenta costo de hello toominimize los movimientos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-465">When moving replicas, hello Cluster Resource Manager tries toominimize hello cost of those movements.</span></span> <span data-ttu-id="70dc2-466">Coste del movimiento se explica en [este artículo](service-fabric-cluster-resource-manager-movement-cost.md) y más sobre Hola Administrador de recursos del clúster de nuevo equilibrio estrategias y reglas se describen [aquí](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="70dc2-466">Movement cost is discussed in [this article](service-fabric-cluster-resource-manager-movement-cost.md) and more about hello Cluster Resource Manager's rebalancing strategies and rules is described [here](service-fabric-cluster-resource-manager-metrics.md).</span></span>

## <a name="cluster-capacity"></a><span data-ttu-id="70dc2-467">Capacidad del clúster</span><span class="sxs-lookup"><span data-stu-id="70dc2-467">Cluster capacity</span></span>
<span data-ttu-id="70dc2-468">Entonces, ¿cómo hello general de administrador de recursos de clúster de tejido de servicio tenga Hola de clúster está demasiado llena?</span><span class="sxs-lookup"><span data-stu-id="70dc2-468">So how does hello Service Fabric Cluster Resource Manager keep hello overall cluster from being too full?</span></span> <span data-ttu-id="70dc2-469">Con la carga dinámica no hay mucho que pueda hacer.</span><span class="sxs-lookup"><span data-stu-id="70dc2-469">Well, with dynamic load there’s not a lot it can do.</span></span> <span data-ttu-id="70dc2-470">Servicios pueden tener su pico de carga independientemente de las acciones realizadas por Hola, Administrador de recursos del clúster.</span><span class="sxs-lookup"><span data-stu-id="70dc2-470">Services can have their load spike independently of actions taken by hello Cluster Resource Manager.</span></span> <span data-ttu-id="70dc2-471">Como resultado, un clúster con espacio de sobra hoy puede quedarse corto cuando se haga famoso mañana,</span><span class="sxs-lookup"><span data-stu-id="70dc2-471">As a result, your cluster with plenty of headroom today may be underpowered when you become famous tomorrow.</span></span> <span data-ttu-id="70dc2-472">Dicho esto, hay algunos controles que se incorporen un concepto de tooprevent problemas.</span><span class="sxs-lookup"><span data-stu-id="70dc2-472">That said, there are some controls that are baked in tooprevent problems.</span></span> <span data-ttu-id="70dc2-473">Hola primera cosa que podemos hacer es impedir la creación de hello de nuevas cargas de trabajo que provocaría Hola clúster toobecome completa.</span><span class="sxs-lookup"><span data-stu-id="70dc2-473">hello first thing we can do is prevent hello creation of new workloads that would cause hello cluster toobecome full.</span></span>

<span data-ttu-id="70dc2-474">Supongamos que crea un servicio sin estado y tiene cierta carga asociado a él, y que</span><span class="sxs-lookup"><span data-stu-id="70dc2-474">Say that you create a stateless service and it has some load associated with it.</span></span> <span data-ttu-id="70dc2-475">Supongamos que se ocupa de servicio Hola acerca de la métrica de Hola "DiskSpaceInMb".</span><span class="sxs-lookup"><span data-stu-id="70dc2-475">Let’s say that hello service cares about hello "DiskSpaceInMb" metric.</span></span> <span data-ttu-id="70dc2-476">Supongamos también que es continuo tooconsume cinco unidades de "DiskSpaceInMb" para cada instancia del servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-476">Let's also say that it is going tooconsume five units of "DiskSpaceInMb" for every instance of hello service.</span></span> <span data-ttu-id="70dc2-477">Desea toocreate tres instancias de servicio de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-477">You want toocreate three instances of hello service.</span></span> <span data-ttu-id="70dc2-478">Estupendo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-478">Great!</span></span> <span data-ttu-id="70dc2-479">Por lo que significa que se necesitan 15 unidades de "DiskSpaceInMb" toobe presenta clúster hello en orden para que podamos tooeven ser capaz de toocreate estas instancias de servicio.</span><span class="sxs-lookup"><span data-stu-id="70dc2-479">So that means that we need 15 units of "DiskSpaceInMb" toobe present in hello cluster in order for us tooeven be able toocreate these service instances.</span></span> <span data-ttu-id="70dc2-480">Hola, Administrador de recursos del clúster calcula continuamente capacidad de Hola y el consumo de cada métrica para que pueda determinar la capacidad restante de hello en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-480">hello Cluster Resource Manager continually calculates hello capacity and consumption of each metric so it can determine hello remaining capacity in hello cluster.</span></span> <span data-ttu-id="70dc2-481">Si no hay suficiente espacio, Hola Hola de rechazos de administrador de recursos de clúster crear llamadas de servicio.</span><span class="sxs-lookup"><span data-stu-id="70dc2-481">If there isn't enough space, hello Cluster Resource Manager rejects hello create service call.</span></span>

<span data-ttu-id="70dc2-482">Puesto que el requisito de hello está solo podrá 15 unidades, podría asignarse a este espacio de muchas maneras diferentes.</span><span class="sxs-lookup"><span data-stu-id="70dc2-482">Since hello requirement is only that there be 15 units available, this space could be allocated many different ways.</span></span> <span data-ttu-id="70dc2-483">por ejemplo, podría ser una unidad de capacidad restante en 15 nodos diferentes o las tres unidades de capacidad que quedan en 5 nodos diferentes.</span><span class="sxs-lookup"><span data-stu-id="70dc2-483">For example, there could be one remaining unit of capacity on 15 different nodes, or three remaining units of capacity on five different nodes.</span></span> <span data-ttu-id="70dc2-484">Si Hola, Administrador de recursos del clúster puede reorganizar cosas así que no hay cinco unidades en tres nodos, coloca servicio Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-484">If hello Cluster Resource Manager can rearrange things so there's five units available on three nodes, it places hello service.</span></span> <span data-ttu-id="70dc2-485">La reorganización clúster Hola normalmente es posible a menos que el clúster de hello está casi lleno o no se pueden consolidar los servicios existentes Hola por algún motivo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-485">Rearranging hello cluster is usually possible unless hello cluster is almost full or hello existing services can't be consolidated for some reason.</span></span>

## <a name="buffered-capacity"></a><span data-ttu-id="70dc2-486">Capacidad de búfer</span><span class="sxs-lookup"><span data-stu-id="70dc2-486">Buffered Capacity</span></span>
<span data-ttu-id="70dc2-487">Capacidad almacenado en búfer es otra característica del programa Hola a Administrador de recursos del clúster.</span><span class="sxs-lookup"><span data-stu-id="70dc2-487">Buffered capacity is another feature of hello Cluster Resource Manager.</span></span> <span data-ttu-id="70dc2-488">Permite una reserva de alguna parte del programa Hola capacidad total de nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-488">It allows reservation of some portion of hello overall node capacity.</span></span> <span data-ttu-id="70dc2-489">Este búfer de capacidad es servicios solo tooplace usado durante las actualizaciones y los errores de nodo.</span><span class="sxs-lookup"><span data-stu-id="70dc2-489">This capacity buffer is only used tooplace services during upgrades and node failures.</span></span> <span data-ttu-id="70dc2-490">Capacidad de búfer se especifica globalmente por métrica para todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="70dc2-490">Buffered Capacity is specified globally per metric for all nodes.</span></span> <span data-ttu-id="70dc2-491">valor de Hello que elegir para la capacidad de hello reservado es una función del número de Hola de error y dominios de actualización tiene en clúster de Hola.</span><span class="sxs-lookup"><span data-stu-id="70dc2-491">hello value you pick for hello reserved capacity is a function of hello number of Fault and Upgrade Domains you have in hello cluster.</span></span> <span data-ttu-id="70dc2-492">Más dominios de error y de actualización significa que puede elegir un número menor para la capacidad de búfer.</span><span class="sxs-lookup"><span data-stu-id="70dc2-492">More Fault and Upgrade Domains means that you can pick a lower number for your buffered capacity.</span></span> <span data-ttu-id="70dc2-493">Si tiene varios dominios, puede esperar pequeñas cantidades de su toobe de clúster no está disponible durante las actualizaciones y los errores.</span><span class="sxs-lookup"><span data-stu-id="70dc2-493">If you have more domains, you can expect smaller amounts of your cluster toobe unavailable during upgrades and failures.</span></span> <span data-ttu-id="70dc2-494">Capacidad de almacenamiento en búfer solo tiene sentido especificar si también tiene capacidad de nodos de hello especificado para una métrica.</span><span class="sxs-lookup"><span data-stu-id="70dc2-494">Specifying Buffered Capacity only makes sense if you have also specified hello node capacity for a metric.</span></span>

<span data-ttu-id="70dc2-495">Este es un ejemplo de cómo toospecify almacenado en búfer capacidad:</span><span class="sxs-lookup"><span data-stu-id="70dc2-495">Here's an example of how toospecify buffered capacity:</span></span>

<span data-ttu-id="70dc2-496">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="70dc2-496">ClusterManifest.xml</span></span>

```xml
        <Section Name="NodeBufferPercentage">
            <Parameter Name="SomeMetric" Value="0.15" />
            <Parameter Name="SomeOtherMetric" Value="0.20" />
        </Section>
```

<span data-ttu-id="70dc2-497">a través de ClusterConfig.json para las implementaciones independientes o Template.json para los clústeres hospedados en Azure:</span><span class="sxs-lookup"><span data-stu-id="70dc2-497">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "NodeBufferPercentage",
    "parameters": [
      {
          "name": "SomeMetric",
          "value": "0.15"
      },
      {
          "name": "SomeOtherMetric",
          "value": "0.20"
      }
    ]
  }
]
```

<span data-ttu-id="70dc2-498">Error al crear el Hola de nuevos servicios una vez clúster Hola sin capacidad de almacenado en búfer para una métrica.</span><span class="sxs-lookup"><span data-stu-id="70dc2-498">hello creation of new services fails when hello cluster is out of buffered capacity for a metric.</span></span> <span data-ttu-id="70dc2-499">Evitar la creación de Hola de nuevo búfer de hello toopreserve de servicios garantiza que las actualizaciones y los errores no provocan nodos toogo sobre capacidad.</span><span class="sxs-lookup"><span data-stu-id="70dc2-499">Preventing hello creation of new services toopreserve hello buffer ensures that upgrades and failures don’t cause nodes toogo over capacity.</span></span> <span data-ttu-id="70dc2-500">La capacidad de búfer es opcional, pero se recomienda en los clústeres que definen una capacidad de una métrica.</span><span class="sxs-lookup"><span data-stu-id="70dc2-500">Buffered capacity is optional but is recommended in any cluster that defines a capacity for a metric.</span></span>

<span data-ttu-id="70dc2-501">Hola, Administrador de recursos del clúster expone esta información de carga.</span><span class="sxs-lookup"><span data-stu-id="70dc2-501">hello Cluster Resource Manager exposes this load information.</span></span> <span data-ttu-id="70dc2-502">Para cada métrica, esta información incluye:</span><span class="sxs-lookup"><span data-stu-id="70dc2-502">For each metric, this information includes:</span></span> 
  - <span data-ttu-id="70dc2-503">Hola almacenado en búfer la configuración de capacidad</span><span class="sxs-lookup"><span data-stu-id="70dc2-503">hello buffered capacity settings</span></span>
  - <span data-ttu-id="70dc2-504">capacidad total de Hola</span><span class="sxs-lookup"><span data-stu-id="70dc2-504">hello total capacity</span></span>
  - <span data-ttu-id="70dc2-505">consumo actual de Hola</span><span class="sxs-lookup"><span data-stu-id="70dc2-505">hello current consumption</span></span>
  - <span data-ttu-id="70dc2-506">si cada métrica se considera equilibrada o no</span><span class="sxs-lookup"><span data-stu-id="70dc2-506">whether each metric is considered balanced or not</span></span>
  - <span data-ttu-id="70dc2-507">estadísticas acerca de la desviación estándar de Hola</span><span class="sxs-lookup"><span data-stu-id="70dc2-507">statistics about hello standard deviation</span></span>
  - <span data-ttu-id="70dc2-508">nodos de Hola que tienen Hola mayoría y menos carga</span><span class="sxs-lookup"><span data-stu-id="70dc2-508">hello nodes which have hello most and least load</span></span>  
  
<span data-ttu-id="70dc2-509">A continuación podemos ver un ejemplo del resultado:</span><span class="sxs-lookup"><span data-stu-id="70dc2-509">Below we see an example of that output:</span></span>

```posh
PS C:\Users\user> Get-ServiceFabricClusterLoadInformation
LastBalancingStartTimeUtc : 9/1/2016 12:54:59 AM
LastBalancingEndTimeUtc   : 9/1/2016 12:54:59 AM
LoadMetricInformation     :
                            LoadMetricName        : Metric1
                            IsBalancedBefore      : False
                            IsBalancedAfter       : False
                            DeviationBefore       : 0.192450089729875
                            DeviationAfter        : 0.192450089729875
                            BalancingThreshold    : 1
                            Action                : NoActionNeeded
                            ActivityThreshold     : 0
                            ClusterCapacity       : 189
                            ClusterLoad           : 45
                            ClusterRemainingCapacity : 144
                            NodeBufferPercentage  : 10
                            ClusterBufferedCapacity : 170
                            ClusterRemainingBufferedCapacity : 125
                            ClusterCapacityViolation : False
                            MinNodeLoadValue      : 0
                            MinNodeLoadNodeId     : 3ea71e8e01f4b0999b121abcbf27d74d
                            MaxNodeLoadValue      : 15
                            MaxNodeLoadNodeId     : 2cc648b6770be1bc9824fa995d5b68b1
```

## <a name="next-steps"></a><span data-ttu-id="70dc2-510">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="70dc2-510">Next steps</span></span>
* <span data-ttu-id="70dc2-511">Para obtener información sobre el flujo de información y arquitectura de hello en hello Administrador de recursos del clúster, visite [este artículo](service-fabric-cluster-resource-manager-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="70dc2-511">For information on hello architecture and information flow within hello Cluster Resource Manager, check out [this article ](service-fabric-cluster-resource-manager-architecture.md)</span></span>
* <span data-ttu-id="70dc2-512">Definir métricas de desfragmentación es tooconsolidate una manera de carga en los nodos en lugar de propagarse. toolearn cómo tooconfigure la desfragmentación, consulte demasiado[este artículo](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="70dc2-512">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
* <span data-ttu-id="70dc2-513">Desde el principio de Hola y [obtener un servicio Administrador de recursos del clúster de tejido de toohello de introducción](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="70dc2-513">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
* <span data-ttu-id="70dc2-514">toofind out acerca de cómo Hola, Administrador de recursos del clúster administra y equilibra la carga en el clúster de hello, desproteger artículo hello en [equilibrio de carga](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="70dc2-514">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-domains.png
[Image2]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-uneven-fault-domain-layout.png
[Image3]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domains-with-placement.png
[Image4]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domain-layout-strategies.png
[Image5]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-layout-different-workloads.png
[Image6]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-placement-constraints-node-properties.png
[Image7]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-nodes-and-capacity.png
